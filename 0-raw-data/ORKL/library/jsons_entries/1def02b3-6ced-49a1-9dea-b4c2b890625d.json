{
    "id": "1def02b3-6ced-49a1-9dea-b4c2b890625d",
    "created_at": "2023-01-12T15:00:15.919738Z",
    "updated_at": "2025-03-27T02:16:25.761219Z",
    "deleted_at": null,
    "sha1_hash": "7b33e102301ca73a112bb8e4eaacf68a51162316",
    "title": "2016-11-28 - A New All-in-One Botnet- Proteus",
    "authors": "",
    "file_creation_date": "2022-05-01T14:12:08Z",
    "file_modification_date": "2022-05-01T14:12:08Z",
    "file_size": 168702,
    "plain_text": "# Linux.Cephei: a Nim virus\n\n**guitmz.com/linux-cephei-a-nim-virus**\n\nGuilherme Thomazi August 31, 2017\n\n[Nim is a systems and applications programming language. It has nice features such](https://nim-lang.org/)\nas producing dependency-free binaries, running on a huge list of operating systems and\narchitectures and compiling to C, C++ or JavaScript. I’ve been messing with it for a while and\nI am very pleased with it. To be honest, Nim and Go have been my choices when I need to\nstart a new project (goodbye Python, at least for now).\n\n[Despite being very fast, awesome for writing CLI tools, having a decent documentation](https://nim-lang.org/blog/2017/05/25/faster-command-line-tools-in-nim.html)\n(much can be improved there, but it’s ok) and playing nice with Docker, there are also\n[some good game libraries are available for Nim, such as Frag.](http://fragworks.io/)\n\nBut enough about the language, let’s talk about the virus itself. `Linux.Cephei is an ELF`\nprepender, which scans on the current directory for files to infect. It’s not destructive by any\nmeans, samples were already sent to major AntiVirus companies such as ESET, Avira, Avast\nand it doesn’t implement any fancy techniques such as EPO or memory injection (yet. I am\nworking on newer projects in a few languages to play around with those techniques, I will\nwrite about it when I have something to show). Anyway, I wrote this infector to have another\nentry at SPTH’s (hxxp://spth.virii.lu/LIP.html) (replace hxxp with http, this website is\nwrongly classified as malicious for some security tools).\n\nThe prepender code is far from being perfect and it should be optimised (like addind error\nhandling for example) when I improve my skills on this language and the repository should\nbe updated accordingly. It uses a simple `XOR encryption/decryption of the host data, I know`\nits weak but it’s just a demonstration. This time, the virus includes a harmless payload that\nhas a 25% change of being triggered and displaying a message when running on a infected\nhost.\n\nHere you can see the `XOR function:`\n```\nproc xorEncDec(input: openArray[int8], key: string): seq[int8] =\n  var output = newSeq[int8](input.len)\n  for x in 0..input.len:\n    output[x] = input[x] xor int8(key[x mod key.len])\n  return output\n\n```\nNim also makes it very easy (and flexible) to work with arrays and binary data. Detecting a\nELF file signature is as simple as:\n\n\n-----\n\n```\nproc isELF(path: string): bool \n  var fs = newFileStream(path, fmRead)\n  defer: fs.close()\n  let e_ident = fs.peekInt32()\n  fs.setPosition(0x10)\n  let e_type = fs.peekInt8()\n  if e_ident == ELF_MAGIC_NUMBER and e_type == ELF_EXECUTABLE_FLAG:\n    return true\n\n```\nSimple. You can get the whole code and further instructions on how to build it on the project\n[repository here.](https://github.com/guitmz/nim-cephei)\n\nA little payload message is included too. It’s printed to `stdout then the infected program`\ntakes over and runs normally as it should:\n```\nDid you know that VV Cephei, also known as HD 208816, is an eclipsing binary star\nsystem located in the constellation Cepheus, approximately 5,000 light years from\nEarth? It is both a B[e] star and shell star. Awesome!\nhttps://en.wikipedia.org/wiki/VV_Cephei\" l\nThe more you know... :)\n\n```\n[A binary (static) sample is also available here.](https://www.guitmz.com/linux.cephei)\n```\n$ file linux.cephei\nELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, not\nstripped\n\n```\nDemo\n\n\n-----\n\nWriting code in Nim is easy and fun, the syntax is natural like Python and yet you have the\npower of C. The language still has much to achieve (we still don’t have native modules for\nPE/ELF/Mach files for example) but I am very impressed so far with it and recommend you\nto give it a try!\n\nTschüss!\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Linux/Infection/ELF Infection in Nim - Cephei virus.pdf"
    ],
    "report_names": [
        "ELF Infection in Nim - Cephei virus.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535615,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1651414328,
    "ts_modification_date": 1651414328,
    "files": {
        "pdf": "https://archive.orkl.eu/7b33e102301ca73a112bb8e4eaacf68a51162316.pdf",
        "text": "https://archive.orkl.eu/7b33e102301ca73a112bb8e4eaacf68a51162316.txt",
        "img": "https://archive.orkl.eu/7b33e102301ca73a112bb8e4eaacf68a51162316.jpg"
    }
}