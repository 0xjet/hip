{
    "id": "d7f6c421-ae2e-40b0-af8d-5b49980b3aee",
    "created_at": "2023-01-12T15:05:22.597818Z",
    "updated_at": "2025-03-27T02:16:26.341648Z",
    "deleted_at": null,
    "sha1_hash": "67afa948201e5f20cb1b2d1885f9bff63728e5d5",
    "title": "2022-09-08 - Crimeware Trends - Ransomware Developers Turn to Intermittent Encryption to Evade Detection",
    "authors": "",
    "file_creation_date": "2022-09-12T12:04:21Z",
    "file_modification_date": "2022-09-12T12:04:21Z",
    "file_size": 1213477,
    "plain_text": "# Crimeware Trends | Ransomware Developers Turn to Intermittent Encryption to Evade Detection\n\n**[sentinelone.com/labs/crimeware-trends-ransomware-developers-turn-to-intermittent-encryption-to-evade-detection/](https://www.sentinelone.com/labs/crimeware-trends-ransomware-developers-turn-to-intermittent-encryption-to-evade-detection/)**\n\nAleksandar Milenkoski\n\n**By Aleksandar Milenkoski & Jim Walter**\n\nWe observe a new trend on the ransomware scene – intermittent encryption, or partial\nencryption of victims’ files. This encryption method helps ransomware operators to evade\ndetection systems and encrypt victims’ files faster. We observe that ransomware developers\nare increasingly adopting the feature and intensively advertising intermittent encryption to\nattract buyers or affiliates.\n\nIntermittent encryption is important to ransomware operators from two perspectives:\n\n**Speed: Encryption can be a time-intensive process and time is crucial to ransomware**\noperators – the faster they encrypt the victims’ files, the less likely they are to be\ndetected and stopped in the process. Intermittent encryption does irretrievable damage\nin a very short time frame.\n\n\n-----\n\n**Evasion: Ransomware detection systems may use statistical analysis to detect**\nransomware operation. Such an analysis may evaluate the intensity of file IO\noperations or the similarity between a known version of a file, which has not been\naffected by ransomware, and a suspected modified, encrypted version of the file. In\ncontrast to full encryption, intermittent encryption helps to evade such analyses by\nexhibiting a significantly lower intensity of file IO operations and much higher similarity\nbetween non-encrypted and encrypted versions of a given file.\n\n[In mid-2021, the LockFile ransomware was one of the first major ransomware families to use](https://news.sophos.com/en-us/2021/08/27/lockfile-ransomwares-box-of-tricks-intermittent-encryption-and-evasion/)\nintermittent encryption for evading detection mechanisms, encrypting every other 16 bytes of\na file. Since then an increasing number of ransomware operations have joined the trend.\n\nIn this post, we review several recent ransomware families that feature intermittent\nencryption in an attempt to evade detection and prevention: Qyick, Agenda, BlackCat\n(ALPHV), PLAY, and Black Basta.\n\n## Qyick Ransomware\n\nAt the end of August 2022, we observed a user named lucrostm advertising a new\ncommercial ransomware called Qyick in a popular TOR-based crime forum. We track the\nsame user as an established vendor of other malicious tools including remote access tools\nand malware loaders.\n\nThe Qyick ransomware offering is a one-time purchase, as opposed to the more common\nsubscription model. The price ranges from .2 BTC to approximately 1.5 BTC, depending on\nthe level of customization the buyer requires. The buyer receives a compiled executable with\na guarantee: if the ransomware is detected by security software within 6 months of purchase,\nthe author will provide a new sample with a discount between 60% and 80% of the original\nprice.\n\nQyick is written in Go and features intermittent encryption. lucrostm claims the apparent\nspeed of the Qyick ransomware is achieved through the use of intermittent encryption and\nthe ransomware’s implementation in Go, hinting at the current trend of intermittent encryption\nin the ransomware threat scene.\n\n_“Notably Qyick features intermittent encryption which is what the cool kids are using as you_\n_read this. Combined with the fact that is written in go, the speed is unmatched.”_\n\n\n-----\n\nQyick ransomware advertisement\nThe exact manner in which Qyick conducts intermittent encryption is open to investigation as\nsamples become available.\n\nThe current version of Qyick does not have data exfiltration capabilities. However, lucrostm\nhas announced that future versions will feature execution of arbitrary executable code,\nmeant primarily for the execution of data exfiltration capabilities.\n\n## Agenda Ransomware\n\n[Agenda ransomware, first spotted in August 2022, is written in Go and has been used](https://www.trendmicro.com/en_us/research/22/h/new-golang-ransomware-agenda-customizes-attacks.html)\nprimarily to target healthcare and education organizations in Africa and Asia. The\nransomware has some customization options, which include changing the filename\nextensions of encrypted files and the list of processes and services to terminate.\n\nAgenda ransomware supports several encryption modes that the ransomware operator can\nconfigure through the encryption setting. The ‘help’ screen displays the different encryption\nmodes available: `skip-step,` `percent, and` `fast .`\n\n\n-----\n\nAgenda ‘Help’ screen, showing the available encryption modes\nOur analysis of Agenda revealed the following information about each mode.\n\n**Encryption mode** **Description**\n\n\nskip-step [skip: N,\nstep: Y]\n\n\nEncrypt every Y MB of the file, skipping N MB.\n\n\nfast [f: N] Encrypt the first N MB of the file.\n\npercent [n: N; p:P] Encrypt every N MB of the file, skipping P MB, where P equals P%\nof the total file size.\n\n## BlackCat (ALPHV), the First Rust Ransomware-As-A-Service\n\nThe [BlackCat (or ALPHV) ransomware came to prominence in late 2021 and is the first](https://www.sentinelone.com/labs/blackcat-ransomware-highly-configurable-rust-driven-raas-on-the-prowl-for-victims/)\nknown ransomware to be written in the Rust programming language. The developers behind\n[BlackCat were first spotted advertising its services in early December 2021 on a Russian](https://securelist.com/a-bad-luck-blackcat/106254/)\nunderground forum.\n\n\n-----\n\nThe original ALPHV/BlackCat forum post\nThe ALPHV threat group runs a ransomware-as-a-service (RaaS) program and shares\nransom payments with affiliates. ALPHV uses [bulletproof hosting to host their web sites and](https://www.sentinelone.com/cybersecurity-101/bulletproof-hosting/)\na Bitcoin mixer to anonymize transactions.\n\nThe ALPHV threat group is an early adopter of extortion schemes such as threatening\n[victims with DDoS attacks, leaking exfiltrated data online as well as intimidating employees](https://www.techtarget.com/searchsecurity/news/252521596/Alphv-ransomware-gang-ups-pressure-with-new-extortion-scheme)\nand customers of victim organizations should they not pay ransom. Major organizations and\nbusinesses have been the target of the BlackCat ransomware globally. For example, in\n[September 2022, the BlackCat ransomware targeted Italy’s state-owned energy services firm](https://www.reuters.com/technology/ransomware-group-blackcat-behind-italys-gse-hacking-researchers-say-2022-09-02/)\nGSE.\n\n\n-----\n\nALPHV Collections: A searchable database of exfiltrated victims’ data\n[SentinelLabs researcher Aleksandar Milenkoski has reverse-engineered BlackCat](https://www.sentinelone.com/blog/author/aleksmil/)\n[ransomware samples and outlined the different encryption modes that BlackCat supports,](https://www.virusbulletin.com/conference/vb2022/abstracts/encryption-time-flies-when-youre-having-fun-case-exotic-blackcat-ransomware/)\nthe majority of which implement intermittent encryption. The table below lists these\nencryption modes.\n\n**Encryption mode** **Description**\n\nFull Encrypt all file content.\n\nHeadOnly [N] Encrypt the first N bytes of the file.\n\nDotPattern [N,Y] Encrypt every N bytes of the file with a step of Y bytes.\n\nSmartPattern [N,P] Encrypt the first N bytes of the file. BlackCat divides the rest of\nthe file into equal-sized blocks, such that each block is 10% of\nthe rest of the file in size. BlackCat encrypts P% of the bytes of\neach block.\n\n\n-----\n\nAdvancedSmartPattern\n\n[N,P,B]\n\n\nEncrypt the first N bytes of the file. BlackCat divides the rest of\nthe file into B equal-sized blocks. BlackCat encrypts P% of the\nbytes of each block.\n\n\nAuto Combinatory file encryption mode. Encrypt the content of the file\naccording to one of the file encryption modes `Full,`\n```\n              DotPattern [N,Y], and AdvancedSmartPattern [N,P,B].\n\n```\nBlackCat selects and parametrizes a file encryption mode based\non the filename extension and the size of the file.\n\n[An evaluation study subjecting files of varying sizes (50 MB, 500 MB, 5 GB, and 50 GB) to](https://www.virusbulletin.com/conference/vb2022/abstracts/encryption-time-flies-when-youre-having-fun-case-exotic-blackcat-ransomware/)\nthe BlackCat ransomware revealed that using intermittent encryption can be of significant\nbenefit to threat actors. For example, in contrast to full encryption, encrypting files using the\n```\nAuto file encryption mode resulted in noticeably reduced wallclock processing time starting\n\n```\nat 5 GB file size (8.65 seconds) and a maximum reduction in wallclock processing time of\n1.95 minutes at 50 GB file size. Wallclock processing time is the total wallclock time (in\nseconds) that the ransomware spends on processing a file, which includes reading,\nencrypting, and writing file content. The full results of this study will be presented at the\n[VirusBulletin Conference 2022.](https://www.virusbulletin.com/conference/vb2022/)\n\nWe also note that BlackCat includes some internal logic for maximizing encryption speed.\nThe ransomware encrypts files using the Advanced Encryption Standard (AES) encryption\nalgorithm if the victim’s platform implements AES hardware acceleration. If not, the\nransomware falls back to the ChaCha20 algorithm that is fully implemented in software.\n\n## PLAY Ransomware\n\n[PLAY ransomware is a new entrant in the ransomware scene and was first spotted at the](https://www.bleepingcomputer.com/forums/t/773651/play-ransomware-play-support-topic/)\nend of June 2022. The ransomware has recently victimized high profile targets, such as the\n[Court of Córdoba in Argentina in August 2022. PLAY’s ransom note consists of a single word](https://www.bleepingcomputer.com/news/security/argentinas-judiciary-of-c-rdoba-hit-by-play-ransomware-attack/)\n– PLAY – and a contact email address.\n\nA PLAY ransomware ransom note\n\nIn contrast to Agenda and BlackCat, PLAY ransomware does not feature encryption modes\nthat can be configured by the operator. PLAY orchestrates intermittent encryption based on\nthe size of the file under encryption, encrypting chunks (file portions) of 0x100000 bytes. For\nexample, [previous research states that under certain conditions, the PLAY ransomware](https://chuongdong.com//reverse%20engineering/2022/09/03/PLAYRansomware/#child-thread-encryption)\nencrypts:\n\n2 chunks, if the file size is less than or equal to 0x3fffffff bytes;\n3 chunks, if the file size is less than or equal to 0x27fffffff bytes;\n5 chunks, if the file size is greater than 0x280000000 bytes.\n\n\n-----\n\nIn our analysis, we observed that a sample encrypted every other 0x100000 byte chunk until\nthe end of the file. The file consisted only of null characters, which effectively makes the\nencrypted and non-encrypted chunks visually distinguishable.\n\nPartial content of a file encrypted by PLAY\n\n## Black Basta Ransomware\n\n[Black Basta is a RaaS program that](https://www.youtube.com/watch?v=Pq8XRvsTmlY) [emerged in April 2022 with ransomware samples dating](https://unit42.paloaltonetworks.com/threat-assessment-black-basta-ransomware/)\nback to February 2022. Current intelligence indicates that Black Basta emerged from the\n[crumbled ashes of the Conti operation. The ransomware is written in the C++ programming](https://www.sentinelone.com/labs/conti-unpacked-understanding-ransomware-development-as-a-response-to-detection/)\n\n\n-----\n\nlanguage and supports Windows and Linux operating systems. Black Basta operators use\nthe double extortion scheme threatening victim organizations with leaking exfiltrated data on\nthe threat group’s TOR-based web site Basta News should the victims not pay ransom.\n\nBlack Basta is rapidly gaining ground on the ransomware scene and targets major\norganizations globally – the ransomware operation reported more than 20 victim\norganizations on Basta News within the first two weeks of its existence. Targeting, especially\nearly on, was primarily focused on utilities, technology, financial, and manufacturing\n[industries. For example, the major German building materials manufacturer Knauf suffered](https://www.bleepingcomputer.com/news/security/building-materials-giant-knauf-hit-by-black-basta-ransomware-gang/)\nan attack conducted by Black Basta affiliates at the end of June 2022.\n\nThe Basta News web site\nLike PLAY ransomware, Black Basta does not feature encryption modes that can be\nconfigured by the ransomware operator, but [orchestrates intermittent encryption based on](https://securityscorecard.com/research/a-deep-dive-into-black-basta-ransomware)\nthe size of the file under encryption. Black Basta encrypts:\n\nall file content, if the file size is less than 704 bytes;\nevery 64 bytes, starting from the beginning of the file, skipping 192 bytes, if the file size\nis less than 4 KB;\nevery 64 bytes, starting from the beginning of the file, skipping 128 bytes, if the file size\nis greater than 4 KB.\n\nOur analysis showed that for a file with a size greater than 4 KB, the Black Basta\nransomware encrypted 64 byte portions with an interval of 128 bytes between each, until the\nend of the file. In similar fashion to PLAY ransomware, the file consisted only of null\ncharacters, making the encrypted and non-encrypted chunks visually distinguishable.\n\n\n-----\n\nPartial content of a file encrypted by Black Basta\n\n## Conclusion\n\nIntermittent encryption is a very useful tool to ransomware operators. This encryption method\nhelps to evade some ransomware detection mechanisms and encrypt victims’ files faster.\nGiven the significant benefits to threat actors while also being practical to implement, we\nestimate that intermittent encryption will continue to be adopted by more ransomware\nfamilies.\n\n[SentinelOne Singularity fully detects these ransomware samples.](https://www.sentinelone.com/platform/)\n\n## Ransomware Samples\n\n**Family** **SHA1**\n\nAgenda 5f99214d68883e91f586e85d8db96deda5ca54af\n\nBlackCat 8917af3878fa49fe4ec930230b881ff0ae8d19c9\n\nPLAY 14177730443c70aefeeda3162b324fdedf9cf9e0\n\n\n-----\n\nBlack Basta a996ccd0d58125bf299e89f4c03ff37afdab33fc\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-09-08 - Crimeware Trends - Ransomware Developers Turn to Intermittent Encryption to Evade Detection.pdf"
    ],
    "report_names": [
        "2022-09-08 - Crimeware Trends - Ransomware Developers Turn to Intermittent Encryption to Evade Detection.pdf"
    ],
    "threat_actors": [
        {
            "id": "86ab9be8-ce67-4866-9f66-1df471e9d251",
            "created_at": "2024-05-29T02:00:03.942487Z",
            "updated_at": "2025-03-27T02:00:03.372165Z",
            "deleted_at": null,
            "main_name": "Alpha Spider",
            "aliases": [
                "ALPHV Ransomware Group"
            ],
            "source_name": "MISPGALAXY:Alpha Spider",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6e23ce43-e1ab-46e3-9f80-76fccf77682b",
            "created_at": "2022-10-25T16:07:23.303713Z",
            "updated_at": "2025-03-27T02:02:09.727245Z",
            "deleted_at": null,
            "main_name": "ALPHV",
            "aliases": [
                "ALPHV",
                "ALPHVM",
                "BlackCat Gang",
                "UNC4466"
            ],
            "source_name": "ETDA:ALPHV",
            "tools": [
                "ALPHV",
                "ALPHVM",
                "BlackCat",
                "GO Simple Tunnel",
                "GOST",
                "Impacket",
                "LaZagne",
                "MEGAsync",
                "Mimikatz",
                "Munchkin",
                "Noberus",
                "PsExec",
                "Remcom",
                "RemoteCommandExecution",
                "WebBrowserPassView"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535922,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1662984261,
    "ts_modification_date": 1662984261,
    "files": {
        "pdf": "https://archive.orkl.eu/67afa948201e5f20cb1b2d1885f9bff63728e5d5.pdf",
        "text": "https://archive.orkl.eu/67afa948201e5f20cb1b2d1885f9bff63728e5d5.txt",
        "img": "https://archive.orkl.eu/67afa948201e5f20cb1b2d1885f9bff63728e5d5.jpg"
    }
}