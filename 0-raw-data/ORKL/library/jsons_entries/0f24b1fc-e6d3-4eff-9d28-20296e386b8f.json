{
    "id": "0f24b1fc-e6d3-4eff-9d28-20296e386b8f",
    "created_at": "2022-10-25T16:48:13.174346Z",
    "updated_at": "2025-03-27T02:11:49.458175Z",
    "deleted_at": null,
    "sha1_hash": "eefffff049213f895e81e03bcd27d0d7be2c8b1e",
    "title": "Pat Bear (APT-C-37)",
    "authors": "Qihoo 360",
    "file_creation_date": "2019-09-18T15:55:30Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 155235,
    "plain_text": "# Pat Bear (APT-C-37): Continued Exposure to an Armed Organization's Attacks\n\n**blogs.360.cn/post/analysis-of-apt-c-37.html**\n\nMarch 25, 2019\n\n# Pat Bear (APT-C-37): Continued to expose attacks on an armed organization\n\n## I. Overview\n\nSince October 2015, the Pat Bear Organization (APT-C-37) has launched an organized,\nplanned, and targeted long-term uninterrupted attack against an armed organization. Its\nattack platform is Windows and Android. Up to now, 360 Beaconlab has captured 32\nAndroid platform attack samples, 13 Windows platform attack samples, and 7 C&C domain\nnames.\n\nDue to its own political and religious issues, an armed organization has become the target\nof many hackers and countries. In March 2017, an armed group, the Amaq Media Channel,\nissued a warning message reminding visitors that the site has been infiltrated, and anyone\nwho visits the site will be asked to download a virus file that pretends to be a Flash installer.\nFrom the news, we determined that an armed organization is the target of the action, and\nits load delivery method includes at least a puddle attack.\n\nThrough analysis, we found that a major C&C used by the racquet bear organization is\nlocated in a certain country in the Middle East, and the C&C used by the golden rat\norganization [1] of the same period belongs to the same network segment. Further analysis\nand comparison, the two organizations have strong correlation, and both contain their own\nunique RAT.\n\nSince the target of the patted bear organization is aimed at an armed organization that\nsupports dual-platform attacks, there has been only one unique animal in the Middle East\nwith a soldier certificate in history, combining some other characteristics of the organization\nand 360 pairs of APT. The organization's naming rules, we named the organization a role\nname in the DOTA game - pat the bear.\n\n\n-----\n\nFigure 1.1 Key time event points related to patted bear attacks\n\n## Second, the load delivery\n\nThe way of patted bear tissue load delivery is mainly puddle attack.\n\n**Puddle attack**\n\nAl Swarm News Agency website (see Figure 2.1) is a media website belonging to an armed\norganization. For the same reason, it has also suffered various attacks from all over the\nworld. It has changed several domain names and the website has been offline. In addition\nto the puddle attack on the Amaq media website mentioned above, we found that Al Swarm\nNews Agency was also used by the organization for puddle attacks.\n\n\n-----\n\nFigure 2.1 Al Swarm News Agency website (Note: Obtained by archive)\n\nThe puddle attack mode is to replace the normal APP of the Al Swarm station with a\nmalicious APP inserted into the RAT. The RAT specific download link and the link\ncorresponding file MD5 are shown in Table 1.\n\n**Malicious download link** **[https://sawarim.net/apps/Sawarim.apk](https://sawarim.net/apps/Sawarim.apk)**\n\nDomain name status Invalid\n\nDownload APK file MD5 Bb2d1238c8418cde13128e91f1a77ae7\n\nTable 1 Android RAT program specific download link and link corresponding file MD5\n\nIn addition to the above two puddle attacks against an armed organization's news media\nwebsite, we also found that some other historical puddle attacks used by the organization\nare shown in Table 2, including the specific download links and links for Android and\nWindows RAT programs. Corresponding file MD5.\n\n**Malicious**\n**download link** **[http://androids-app.com/downloads/Youtube_v3_4.apk](http://androids-app.com/downloads/Youtube_v3_4.apk)**\n\n\nDomain name\nstatus\n\nDownload APK file\nMD5\n\nMalicious\ndownload link\n\n\nInvalid\n\nDc1ede8e2d3206b04cb95b6ae62f43e0\n\n[http://androids-app.com/SystemUI.exe](http://androids-app.com/SystemUI.exe)\n\n\n-----\n\n**Malicious**\n**download link** **http://androids-app.com/downloads/Youtube_v3_4.apk**\n\n\nDomain name\nstatus\n\nDownload PE file\nMD5\n\nMalicious\ndownload link\n\nDomain name\nstatus\n\nDownload PE file\nMD5\n\nMalicious\ndownload link\n\nDomain name\nstatus\n\nDownload PE file\nMD5\n\n\nInvalid\n\nD2c40e2183cf18855c36ddd14f8e966f\n\nhttp://snapcard.argia.co.id/woocommerce/wpcontent/plugins/Adobe_FlashPlayerX86_64.exe\n\nInvalid\n\n8c49833f76b17fdaafe5130f249312ca\n\nhttp://snapcard.argia.co.id/woocommerce/wpcontent/plugins/Adobe_FlashPlayer_installX86.exe\n\nInvalid\n\nE6e676df8250a7b930b2d016458225e2\n\n\nTable 2 RAT program specific download link and link corresponding file MD5\n\n## Third, the way of induction\n\nThe patted bear organization mainly uses the following two induction methods in this\noperation:\n\n**Camouflage with normal APP function**\n\nIn order to be better evasive, in addition to camouflage the file icon, the RAT is also inserted\ninto the normal APP, such as an app called \"اﻟﺮﺳﻮل زوﺟﺎت\", which displays the normal\ninterface after running. However, when the specified broadcast is received, espionage\noccurs in the background.\n\n\n-----\n\nFigure 3.1 Camouflage APP \"اﻟﺮﺳﻮل زوﺟﺎت\" with two RATs\n\n**File icon camouflage**\n\nFigure 3.2 Disguised application software icon\n\n## Fourth, RAT attack sample analysis\n\nUp to now, the bat shooting organization has used several different RATs for Android and\nWindows.\n\n**Android**\n\nThere are three RATs used in the Android side. Two of them (DroidJack and SpyNote) are\nmore frequently used commercial RATs. They have been spread on multiple hacking forums\n\n\n-----\n\nand have been detected and exposed by many security companies. And we think that it was\ndeveloped specifically for this attack, we are named SSLove, which only appeared in the\nevent and has been updated in several versions.\n\n_DroidJack_\n\nDroidjack is an extremely popular RAT with its own official website, powerful and convenient\nmanagement tools. The organization uses Droidjack in addition to direct use; it will also be\ninserted into the normal APP to hide, interestingly, SSLove will also be inserted into the app,\nwhich means that the app will have two RATs at the same time.\n\nFigure 4.1 Droidjack management tool interface diagram\n\n_SpyNote_\n\nSpyNote is similar to Droidjack. Although the Snap Bear organization uses SpyNote, the RAT\nhas been used for a limited number of times in this attack.\n\n\n-----\n\nFigure 4.2 SpyNote management tool interface diagram\n\n_SSLove_\n\nThis is a RAT that was not previously exposed. According to the special character\n\"runmylove\" contained in the RAT, combined with it is the first RAT found to use SqlServer\nto implement instruction interaction, we named SSLove. The latest version of SSLove has\nfeatures such as stealing text messages, contacts, WhatsApp and Telegram data, and\nuploading files using FTP.\n\nThe organization uses SSLove in the same way as the Droidjack, one of which is used\ndirectly, in which the Al Swarm website mentioned above is used by the camouflage APP\nused by the bear organization for puddle attacks; the other is the insertion. Hide it in the\nnormal app.\n\n\n-----\n\nFigure 4.3 SSLove command function related data table\n\n**Windows**\n\nThere are three RATs used on the Windows side, all of which have been popular in the\nMiddle East for several years. Two of them (njRAT and H-worm) have been exposed multiple\ntimes, but they are still active.\n\n_NjRAT_\n\nNjRAT[2], also known as Bladeabindi, can control the registry, processes, files, etc. of the\ncontrolled terminal through the control terminal, and can also record the keyboard of the\ncontrolled terminal. At the same time, njRAT uses a plug-in mechanism to extend the\nfunctionality of njRAT through different plug-ins.\n\nThe organization is mostly not directly used when using njRAT, but is sub-encapsulated on\nthe basis of njRAT, using C# to add a shell to njRAT, and a lot of confusion about the shell\ncode. The role of the shell is to load njRAT in memory to prevent njRAT from being detected\nby anti-virus software. This is the case when the Amaq website mentioned above is used by\nthe organization to masquerade as an Adobe Flash Player.\n\n\n-----\n\nFigure 4.4 njRAT extracted from malicious samples disguised in Amaq puddle activity\n\n_H-Worm_\n\nH-Worm is a VBS (Visual Basic Script) based RAT. For information on the RAT, refer to\nFireEye's previous detailed report \"Now You See Me - H-worm by Houdini\" [3]. The attack\nused the H-Worm version after the confusion, and after the confusion was removed, we\nfound that the list of instructions did not change.\n\nFigure 4.5 Confused H-Worm code snippet\n\n**instruction** **Features**\n\nExcecute Execute server command\n\nUpdate Update load\n\nUninstall Uninstall yourself\n\nSend download file\n\nSite-send Specify website download file\n\nRecv upload data\n\nEnum-driver Enumeration driver\n\nEnum-faf Enumerate files in the specified directory\n\n\n-----\n\n**instruction** **Features**\n\nEnum-process Enumeration process\n\nCmd-shell Execution shell\n\nDelete Delete Files\n\nExit-process end process\n\nSleep Set script sleep time\n\nTable 3 H-Worm sample instruction and function correspondence\n\n_Fkn0wned_\n\nFkn0wned is a RAT written in VB.NET. This attack uses an earlier version. It only receives the\n\"DOWNLOAD\" command. The DDoS function code does not work. The RAT is actually a\ndownloader.\n\nFigure 4.4 fkn0wned configuration information and command response code map\n\n**C&C, IP and partial sample correspondence**\n\n\n-----\n\nFigure 4.5 C&C, IP and partial sample correspondence\n\n## V. Distribution of the attacked area\n\nUp to now, 360 Campfire Lab found that there were 11 countries affected by the attack on\nthe bear organization attack. Through inquiry, it can be known that there are some armed\norganizations in these countries. Obviously, the cause of this distribution is caused by\nseveral targeted puddle attacks used by the organization.\n\n\n-----\n\nFigure 5.1 Distribution of the attacked area\n\n## Sixth, traceability and relevance\n\n360 bonfire laboratory through the analysis of the bat bat attack activity, combined with the\nprevious analysis of the gold rat organization, we found that the two organizations removed\nthe attack target and their respective exclusive RAT, the two have very Strong relevance.\n\nThey are all familiar with Arabic and have been working on Android and Windows\nplatforms for several years. They are good at puddle attacks.\nA variety of RATs are used, most of which are used by both parties.\nBoth organizations used C&C on the same network segment for two time periods.\n\n## Seven, summary\n\nWith the geopolitical conflicts and other issues, the parties tried to take the lead through\nnetwork intelligence and cyberattack activities, further causing the cyberspace conflict to\nintensify. The racquet bear organization is another spy intelligence activity organization\nbased on this. Without the peace factor, the attack cannot be stopped. Recent reports claim\nthat an armed group in a certain country in the Middle East has been attacked and declared\ndead. This may mean that the attack on the racquet bear organization will change, and\nfinally hope that peace will last long!\n\n## Appendix A: Sample MD5\n\n\n-----\n\n**Android attack sample MD5** **Windows attack sample MD5**\n\n12100da4635765f8d69d684f742a47bd 085e195c9b14ef099171805c44ff4914\n\n1d5e36be4b94289f214447964ede688d 1a655affc8d5fffa48915a934f31f95e\n\n1daf7e38d8d918e8e087ad590b299218 291c3f5b9b53381283a044e337899c84\n\n1eb8e8667ed7d2a07076e3d240207613 6d6961ced0e77c28f881db579301a927\n\n249aad5d2722b69aac7ed27c9e669c79 8bb342a3e770717bd8f39ac12a687b54\n\n2706be45411ed22ce456b8fe8273b285 8c49833f76b17fdaafe5130f249312ca\n\n31aad6045f403fcd397e19cad4f80d1f Ba1249123e808e744aeb96753bc119d4\n\n3751db0d511305b39601e09959491d8e Bfaf6389cb9fba695daa8552f697d40b\n\n430a0b26cc53f7d39b8192d0b3f79837 D2c40e2183cf18855c36ddd14f8e966f\n\n4333a9e5d6de6e12b368f5a943a30a0e D52f57b6597e55c40c21b0f8c763cd69\n\n484d74ebd0e3586e2ff694017dcaa9e3 D9153bdf30e0a3ab31601e43d85c9949\n\n51f7d6fec2be62fc29cfb94f52803428 Daf7f053cf78690ff0c6ec0384d85bf2\n\n523845736fc92ea80e9880641b768dc1 E6e676df8250a7b930b2d016458225e2\n\n71d0cea1bee13d1e36b5a53788001b85\n\n7d50a9bd474a7c5878ac8e0e4a183a8b\n\n80382a7f2eb4f292a28554bc95b57938\n\n98d584d4d575e31f9f4f70c9be05166f\n\nA31f1ce49662a60daa46180d02ab6218\n\nA41c5f227ac2816355ce4cf650993749\n\nA95d57eaaf7847a07e62c6ea0fecbfb7\n\nB7d12ab736b41d503e93a0bd6125cf62\n\nB87f516b2ee0e6df09510f75b16c25ef\n\nBb2d1238c8418cde13128e91f1a77ae7\n\nBef2dddd8892a4985879971cf437d79b\n\n\n-----\n\n**Android attack sample MD5** **Windows attack sample MD5**\n\nC9e434e780b5bed397c543bb3264deea\n\nD195511307a2c5ac52bebf8a98b9dfae\n\nD207a876369681ed476f650d808a25a8\n\nDc1ede8e2d3206b04cb95b6ae62f43e0\n\nE92651bb3ad8c5c3acf38dedb2abc2ca\n\nEa6e187934fc1459d3b04b0898496b2c\n\nEb3310f19720abddc34c4602983e4f3c\n\nF66d99406819ca96b47d7ff0881a0a1a\n\n## Appendix B: C&C\n\n66.85.157.86\n\n82.137.255.0\n\nDa3da3.duckdns.org\n\nSamd1.duckdns.org\n\nSamd2.duckdns.org\n\nSorry.duckdns.org\n\nBtcaes2.duckdns.org\n\n## Appendix C: Reference Links\n\n[[1] https://ti.360.net/blog/articles/analysis-of-apt-c-27/](https://ti.360.net/blog/articles/analysis-of-apt-c-27/)\n\n[[2] https://en.wikipedia.org/wiki/Njrat](https://en.wikipedia.org/wiki/Njrat)\n\n[3] https://www.fireeye.com/blog/threat-research/2013/09/now-you-see-me-h-worm-byhoudini.html\n\n[This article links: http://blogs.360.cn/post/analysis-of-apt-c-37.html](http://blogs.360.cn/post/analysis-of-apt-c-37.html)\n\n-- EOF -\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/gv5ug3d8shq5d6uuj6vb8nfgemtpznil"
    ],
    "report_names": [
        "Qihoo360_PatBear-APT-C-37-Armed-Organizations-Attacks(03-25-2019)"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c2cc9aa5-1853-4de1-8849-cb3f28c7728e",
            "created_at": "2022-10-25T16:07:24.256045Z",
            "updated_at": "2025-03-27T02:02:10.15213Z",
            "deleted_at": null,
            "main_name": "Goldmouse",
            "aliases": [
                "APT-C-27",
                "ATK 80",
                "Golden Rat",
                "Goldmouse"
            ],
            "source_name": "ETDA:Goldmouse",
            "tools": [
                "Bladabindi",
                "GoldenRAT",
                "Jorik",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "0769c188-62ce-44ee-8e9d-1067f3d3c083",
            "created_at": "2022-10-25T16:07:24.259063Z",
            "updated_at": "2025-03-27T02:02:10.152956Z",
            "deleted_at": null,
            "main_name": "Pat Bear",
            "aliases": [
                "APT-C-37",
                "Pat Bear",
                "Racquet Bear"
            ],
            "source_name": "ETDA:Pat Bear",
            "tools": [
                "Bladabindi",
                "CypherRat",
                "DroidJack",
                "H-Worm",
                "H-Worm RAT",
                "Houdini",
                "Houdini RAT",
                "Hworm",
                "Iniduoh",
                "Jenxcus",
                "Jorik",
                "Kognito",
                "Njw0rm",
                "SSLove RAT",
                "SpyNote",
                "SpyNote RAT",
                "WSHRAT",
                "dinihou",
                "dunihi",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "2c385a7d-0217-46d8-a451-29ac6fe58aaf",
            "created_at": "2023-01-06T13:46:38.937468Z",
            "updated_at": "2025-03-27T02:00:02.956722Z",
            "deleted_at": null,
            "main_name": "APT-C-27",
            "aliases": [
                "GoldMouse",
                "Golden RAT",
                "ATK80"
            ],
            "source_name": "MISPGALAXY:APT-C-27",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716493,
    "ts_updated_at": 1743041509,
    "ts_creation_date": 1568822130,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/eefffff049213f895e81e03bcd27d0d7be2c8b1e.pdf",
        "text": "https://archive.orkl.eu/eefffff049213f895e81e03bcd27d0d7be2c8b1e.txt",
        "img": "https://archive.orkl.eu/eefffff049213f895e81e03bcd27d0d7be2c8b1e.jpg"
    }
}