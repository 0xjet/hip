{
    "id": "78e9ccd1-c13f-4848-a66c-ab4faf4abe65",
    "created_at": "2022-10-25T16:48:22.391047Z",
    "updated_at": "2025-03-27T02:16:39.991611Z",
    "deleted_at": null,
    "sha1_hash": "036b1154d4cc2de08dc647eb743c6b4c9d860902",
    "title": "Intruder File Report- Sneakernet Trojan",
    "authors": "Fidelis",
    "file_creation_date": "2014-01-31T17:13:55Z",
    "file_modification_date": "2014-01-31T17:13:55Z",
    "file_size": 468385,
    "plain_text": "### www.fidelissecurity.com\n www.threatgeek.com\n @FidSecSys +1800.652.4020\n```\n     Follow-Up #1 Fidelis Threat Advisory #1011\n    Intruder File Report- Sneakernet Trojan\n             January 31, 2014\n              Document Status: FINAL\n               Last Revised: 2014-01-31\nExecutive Summary\n\n```\nPrevious General Dynamics Fidelis Cybersecurity Services (Fidelis) reporting, ref: Fidelis Threat\nAdvisory (FTA) #1011 dated 15 Jan 2014, introduced a malware system comprised of multiple\nfiles that provided a means for intruders to discover and retrieve data from disparate computer\nsystems via removable storage devices. The malware system consists of at least two Portable\nExecutable (PE) files, one acting as a headquarters component and one acting as field unit or\nagent component. The headquarters component infects drives connected to its host system with\nthe field unit component and retrieves data from the field unit on the infected drive’s return to the\nheadquarters host system. The field unit conducts reconnaissance and data collection in\naccordance with particular commands.\n\nContinuing analysis solidified the headquarters component’s Command and Control (C2) scheme.\nThe malware receives commands from a locally stored encrypted file.\n\nThis report describes select malware functionality with some granularity, provides extended detail\nregarding the headquarters component’s C2 functionality, provides additional means of defensive\ndetection of this malware and describes some interesting aspects of the malware as a whole.\n\nThe Fidelis team updated Fidelis XPS[TM] advanced threat defense system with additional rules to\nreflect current analysis findings associated with this malware.\n```\nForensic Analysis Findings\n\n```\n**Basic Functionality**\n\nPrevious reporting, ref: Fidelis Threat Advisory (FTA) #1011 dated 15 Jan 2014, introduced a\nmalware system comprised of multiple files that reflected a means for intruders to discover and\nretrieve data from disparate computer systems via removable storage devices. Analysis of the\nsystem relied on the availability of two files named netsat.exe and netui3.dll. Netsat.exe\nfunctioned as a master application affording intruders the ability, in a selective and controlled\nmanner, to infest removable devices with an agent application in the form of netui3.dll, aka\n\nUsers are granted permission to copy and/or distribute this document in its original electronic form and print copies for personal use. This\ndocument cannot be modified or converted to any other electronic or machine-readable form in whole or in part without prior written\napproval of General Dynamics Fidelis Cybersecurity Solutions Inc.\n\nWhile we have done our best to ensure that the material found in this document is accurate, General Dynamics Fidelis Cybersecurity\nSolutions makes no guarantee that the information contained herein is error free.\n\nCopyright © 2014 General Dynamics Fidelis Cybersecurity Solutions Rev 2014-01-31\n\n\n-----\n\n### www.fidelissecurity.com\n www.threatgeek.com\n @FidSecSys +1800.652.4020\n\nsetup35.exe, aka update.exe. Previous reporting likened netsat.exe as a headquarters application\nand netui3.dll as a field unit with the following basic functionality:\n\nHeadquarters (netsat.exe)\n\n    - Running on a possibly compromised system\n\n    - Logging some activity and errors to a file\n\n    - Receiving commands via an encrypted file on the local system (possible C2)\n\n    - Listening for drive connections\n\n    - Infecting connected drives with netui3.dll/winmgt.dll (setup35.exe + Autorun.inf)\n\n    - Collecting data gathered by any infected drives, ostensibly upon their return from\nbeing connected to other systems\n\nField Unit (netui3.dll)\n\n    - Collecting information about systems it comes into contact with through connection to\nthe targeted systems with the drive whereon the malware resides\n\n    - Collecting file listings from local and share connected drives\n\n    - Discovering and connecting to shared drives visible to the local targeted system\n\n    - Copying and writing files to/from drives visible to the local targeted system\n\nThe following graphic serves to illustrate a possible basic theory of operation given available\ndata:\n\nCopyright © 2014 General Dynamics Fidelis Cybersecurity Solutions Rev 2014-01-31\n\n\n-----\n\n### www.fidelissecurity.com\n www.threatgeek.com\n @FidSecSys +1800.652.4020\n\n Field \r Unit \r (netui3.dll/setup35.exe/update.exe) \r Functionality \r \n\nFile Name: netui3.dll\n\nFile Size: 39424 bytes\n\nMD5:    68aed7b1f171b928913780d5b21f7617\n\nContinued analysis disclosed details regarding the field unit/agent application. The following\nreflects observations during field unit execution from an infected external drive:\n\n    - The malware attempts to ensure errors are suppressed and not observed by a user\n\n    - The malware performs specific environment checking to adapt to Windows versions\nfrom at least Windows 2000 to Windows7/Server 2008 and up\n\n    - The malware terminates if it detects another iteration of itself via the Mutex\n“Mtx_Sp_on_PC_1_2_8”\n\n    - The malware terminates if any Gateway IPs associated with the resident system are\nin the 10.x.x.x range\n\n    - The malware copies itself to\n<CSIDL_LOCAL_APPDATA>\\Microsoft\\Windows\\Help\\update.exe\n\n    - The malware runs update.exe with the parameters “-wu external drive letter”, e.g., z:,\nwith the temporary directory specified for the working directory\n\n    - The malware copies a file named ~disk.ini from the infected drive to\n<CSIDL_LOCAL_APPDATA>\\Microsoft\\Windows\\Help\\intr\n\n    - The malware checks the system date against 31 May 2013; if on or after, the\nmalware terminates\n\n    - The malware copies <CSIDL_LOCAL_APPDATA>\\Microsoft\\Windows\\Help\\intr to\n<CSIDL_LOCAL_APPDATA>\\Microsoft\\Windows\\Chars\\intr\n\n### Headquarters \r (netsat.exe) \r Functionality \r – \r C2 \r Mechanism \r \n\nFile Name: netsat.exe\n\nFile Size: 43520 bytes\n\nMD5:    eb8399483b55f416e48a320d68597d72\n\nPrevious analysis results indicated netsat.exe retrieved commands from an encrypted file named\nnetwn.drv resident in the CSIDL_WINDOWS\\msagent\\ directory. The encryption was a Tiny\nEncryption Algorithm (TEA) implementation that used a key that was modified during encryption\nand decryption operations.\n\nCopyright © 2014 General Dynamics Fidelis Cybersecurity Solutions Rev 2014-01-31\n\n\n-----\n\n### www.fidelissecurity.com\n www.threatgeek.com\n @FidSecSys +1800.652.4020\n\nThe following command file hex editor excerpt illustrates the command file’s obfuscation in a\ncontrived instance:\n\nOffset   0 1 2 3 4 5 6 7  8 9 10 11 12 13 14 15\n\n00000000  AA AA AA **BE BA FE CA EF BE AD DE 0D F0 AD 0B ED** **ªªª¾ºþÊï¾­Þ ð­ í**\n\n00000016  FE DE C0 **10 00** _BB 6D E4 40 60 34 CC 6A 0A B7 2A_ **þÞÀ** _»mä@`4Ìj ·*_\n\n00000032  AA 43 C5 86 C6 10 00 FD 5B ED CE BE 6C D8 42 B4 _ªCÅ†Æ ý[íÎ¾lØB´_\n\n00000048  90 AE 36 31 5D 40 A3 10 00 C0 5E 8A 4C 0F 0C 72 _®61]@£ À^ŠL r_\n\n00000064  2E AA A2 28 20 16 20 0E 7A _.ª¢(  z_\n\n_Note: 1[st] Three Bytes = Unknown utility, Next 16 bytes = Encryption Key, Bytes 20 and 21 =_\n_Command Data Size, Bytes 22-37 = encrypted command data_\n\nCommand Data Before Encryption/After Decryption\n\n_@@ d81596a9_\n\n_ferry 0_\n\n_dir 5_\n\nAnalysis efforts did not have access to ‘command’ files retrieved from the victim systems for\neither the headquarters or the field unit applications. However, using the malware’s behavior and\ndetermining the command file’s format via reverse engineering afforded the ability to test\nnumerous assumptions about the malware’s intended use. Analysis determined the command\nformat was: drive identification followed by one or more command and parameter strings. The\nfollowing table reflects testing and theoretical contents of command files driving netsat.exe\noperation:\n\nCopyright © 2014 General Dynamics Fidelis Cybersecurity Solutions Rev 2014-01-31\n\n\n-----\n\n### www.fidelissecurity.com\n www.threatgeek.com\n @FidSecSys +1800.652.4020\n\n One -­‐ Infection Attempt and Retrieval of Data Collection From a Remote System\n\n Description Outcome\n\n designates a volume serial number\n\n infect the just listed identified drive fails because notmyser does not match an\n\n designates a volume serial number this S/N is from actually attached drive\n\n success \r  copies \r data \r from \r ext.drv\\RECYCLED\\RECYCLED\\SYS \r  to \r <CSIDL_NETHOOD>\\Microsoft\\Intel \r  (Note: \r before \r copy \r checks \r if \r file \r exists \r in \r \\Intel \r and \r  determines \r file \r size \r -­‐ \r the \r implication \r is \r the \r possibility \r of \r \n collect data harvested from a targeted system updating previously retrieved files)\n\n designates any connected drive 00 acts a wildcard for volume serial number\n\n did \r not \r execute \r because \r a \r volume \r serial \r number \r \n retrieve a directory listing (d81596a9) was previously found\n\n Two -­‐ Retrieve Directory Listing From Any Connected Drive and Attempt Data Collection\n\n Description Outcome\n\n designates any connected drive\n\n retrieve a directory listing directory listing obtained from next connected\n\n designates a volume serial number this S/N is from actually attached drive\n\n collect data harvested from a targeted system did not execute\n\nCopyright © 2014 General Dynamics Fidelis Cybersecurity Solutions Rev 2014-01-31\n\n|Test Commands One -­‐ Infection Attempt and Retrieval of Data Collection From a Remote System|Col2|Col3|\n|---|---|---|\n|Command|Description|Outcome|\n|@@ notmyser|designates a volume serial number||\n|ferry 1|infect the just listed identified drive|fails because notmyser does not match an attached drive|\n|@@ d81596a9|designates a volume serial number|this S/N is from actually attached drive|\n|getres|collect data harvested from a targeted system|success copies data from ext.drv\\RECYCLED\\RECYCLED\\SYS to <CSIDL_NETHOOD>\\Microsoft\\Intel (Note: before copy checks if file exists in \\Intel and determines file size -­‐ the implication is the possibility of updating previously retrieved files)|\n|@@ 00|designates any connected drive|00 acts a wildcard for volume serial number|\n|dir 5|retrieve a directory listing|did not execute because a volume serial number (d81596a9) was previously found|\n|Test Commands Two -­‐ Retrieve Directory Listing From Any Connected Drive and Attempt Data Collection Retrieval|||\n|Command|Description|Outcome|\n|@@ 00|designates any connected drive||\n|dir 5|retrieve a directory listing|directory listing obtained from next connected drive|\n|@@ d81596a9|designates a volume serial number|this S/N is from actually attached drive|\n|getres|collect data harvested from a targeted system|did not execute|\n\n\n-----\n\n### www.fidelissecurity.com\n www.threatgeek.com\n @FidSecSys +1800.652.4020\n\n Following Are Hypothetical Scenarios Designed to Illustrate Possible Employment Options\n\n Possible \r Commands \r One \r -­‐ \r Targeting \r Specific \r Devices \r (Known \r to \r Intruder \r From \r Previous \r netsat/netui3 \r \n\n Description\n\n sernum1 designates a volume serial number\n\n collect data harvested from a targeted system\n\n sernum2 designates a volume serial number\n\n infect this particular drive\n\n designates any connected volume not listed above\n\n retrieve a directory listing from the just connected drive, re: 00\n\n Commands Two -­‐ Maximizing Propagation (Theoretical)\n\n Description\n\n sernum1 designates a particular volume serial number\n\n particular command\n\n particular command\n\n sernum2 designates a particular volume serial number\n\n particular command\n\n particular command\n\n particular command\n\n designates any connected volume not listed above\n\n infect the just connected drive, re: 00\n\n retrieve a directory listing from the just connected drive, re: 00\n\n Headquarters \r (netsat.exe) \r Functionality \r – \r Log \r File \r \n\n The headquarters component (netsat.exe) logs certain events in a file located at CSIDL_MYPICTURES\\wins. Analysis indicates the log file is probably stored in the clear, i.e., the contents are not obfuscated. Example log file contents are presented as follows:\n\n St 01/18/13 12:03:30\n\n into\n\n d81596a9 ar 01/18/13 12:03:44\n\n Total:30532M, Free:30387M\n\nCopyright © 2014 General Dynamics Fidelis Cybersecurity Solutions Rev 2014-01-31\n\n|The Following Are Hypothetical Scenarios Designed to Illustrate Possible Employment Options|Col2|\n|---|---|\n|Possible Commands One -­‐ Targeting Specific Devices (Known to Intruder From Previous netsat/netui3 Activity)||\n|Command|Description|\n|@@ sernum1|designates a volume serial number|\n|getres|collect data harvested from a targeted system|\n|@@ sernum2|designates a volume serial number|\n|ferry 1|infect this particular drive|\n|@@ 00|designates any connected volume not listed above|\n|dir 4|retrieve a directory listing from the just connected drive, re: 00|\n|Possible Commands Two -­‐ Maximizing Propagation (Theoretical)||\n|Command|Description|\n|@@ sernum1|designates a particular volume serial number|\n|cmd1|particular command|\n|cmd2|particular command|\n|@@ sernum2|designates a particular volume serial number|\n|cmd3|particular command|\n|cmd4|particular command|\n|cmd5|particular command|\n|@@ 00|designates any connected volume not listed above|\n|ferry 0|infect the just connected drive, re: 00|\n|dir 5|retrieve a directory listing from the just connected drive, re: 00|\n\n\n-----\n\n### www.fidelissecurity.com\n www.threatgeek.com\n @FidSecSys +1800.652.4020\n End copy : E:\\RECYCLED\\RECYCLED\\SYS\\file1.txt\n\n End copy : E:\\RECYCLED\\RECYCLED\\SYS\\interesting.txt\n\n Re on Fin\n\n The following strings, which are not all inclusive or exclusive, could be used to find log files, fragments or contents on devices and on a network:\n\n Format String Example/Explanation\n\n \"Total:%I64dM, Free:%I64dM\" Total:30532M, Free:30387M\n\n \"!Get disk space\"\n\n \"error = %d\" error = 3\n\n \"!add drive, n = \" \"!add drive, n = 5\" (5 represents E drive)\n\n \"!u ser\"\n\n \"%08x ar %s %s\" <8 hex digits> ar <date> <time>\n\n \"Can't open file %s, error = %d\"\n\n \"ERROR Register notification\"\n\n \"!Up\"\n\n \"!ad dri, nD=%d\" \"!ad dri, nD=5\"\n\n \"!Cr Des\\n\" Indicates failure to open desktop.ini for writing\n\n \"!Cr De.i. err=%d\\n\" Specifies error code for failure to open desktop.ini for writing\n\n \"!up %s \\n e:%d\\n\" Indicates failure to create the RECYLCED/RECYCLER directory. Example: \"!up E: <newline> e:3\"\n\n \"Get Dir_c1 error!\" Indicates failure to retrieve that CSIDL_WINDOWS path for building of the netwi.drv path during ferry command\n\nCopyright © 2014 General Dynamics Fidelis Cybersecurity Solutions Rev 2014-01-31\n\n|Format String|Example/Explanation|\n|---|---|\n|\"Total:%I64dM, Free:%I64dM\"|Total:30532M, Free:30387M|\n|\"!Get disk space\"||\n|\"error = %d\"|error = 3|\n|\"!add drive, n = \"|\"!add drive, n = 5\" (5 represents E drive)|\n|\"!u ser\"||\n|\"%08x ar %s %s\"|<8 hex digits> ar <date> <time>|\n|\"Can't open file %s, error = %d\"||\n|\"ERROR Register notification\"||\n|\"!Up\"||\n|\"!ad dri, nD=%d\"|\"!ad dri, nD=5\"|\n|\"!Cr Des\\n\"|Indicates failure to open desktop.ini for writing|\n|\"!Cr De.i. err=%d\\n\"|Specifies error code for failure to open desktop.ini for writing|\n|\"!up %s \\n e:%d\\n\"|Indicates failure to create the RECYLCED/RECYCLER directory. Example: \"!up E: <newline> e:3\"|\n|\"Get Dir_c1 error!\"|Indicates failure to retrieve that CSIDL_WINDOWS path for building of the netwi.drv path during ferry command|\n\n\n-----\n\n### www.fidelissecurity.com\n www.threatgeek.com\n @FidSecSys +1800.652.4020\n\n Format String Example/Explanation\n\n \"!cp cf e:%d\" Indicates error copying netwi.drv to ~disk.ini. \n\n \"!c r\\n\" Indicates error copying setup35.exe\n\n \"!c tr\\n\"\n\n \"!c .inf, e:%d\"\" Indicates error opening AutoRun.inf for binary write\n\n \"!C c\\n\"\n\n \"!c .inf\" Indicates could not create AutoRun.inf\n\n \"!c ser\" Indicates could not copy netu3.dll/setup35.exe\n\n \"!Get volume path = %s\"\n\n \"!Get disk memory\"\n\n Interesting \r Artifacts \r and \r Observations \r \n\n Previous and continuing analysis results indicated some interesting and/or relevant aspects of this malware:\n\n • The malware tries to be quiet - error handling\n • There was robust implementation intention across Windows versions\n • The malware employs robust environment checking; frustrating inadvertent execution and analysis\n • The malware prevents multiple iterations of itself on individual systems\n • The malware does not run on systems using Gateways assigned a particular internal net range (10.x.x.x)\n • The malware’s execution has an expiration date\n • The malware purposely obfuscates and complicates C2\n • The malware injects complexity into C2 encryption operations; obfuscating execution and frustrating/delaying analysis\n • The malware uses obscure file system paths\n • The malware author, ironically or purposely, named a collected data storage folder ‘Intel’\n\nCopyright © 2014 General Dynamics Fidelis Cybersecurity Solutions Rev 2014-01-31\n\n|Format String|Example/Explanation|\n|---|---|\n|\"!cp cf e:%d\"|Indicates error copying netwi.drv to ~disk.ini.|\n|\"!c r\\n\"|Indicates error copying setup35.exe|\n|\"!c tr\\n\"||\n|\"!c .inf, e:%d\"\"|Indicates error opening AutoRun.inf for binary write|\n|\"!C c\\n\"||\n|\"!c .inf\"|Indicates could not create AutoRun.inf|\n|\"!c ser\"|Indicates could not copy netu3.dll/setup35.exe|\n|\"!Get volume path = %s\"||\n|\"!Get disk memory\"||\n\n\n-----\n\n### www.fidelissecurity.com\n www.threatgeek.com\n @FidSecSys +1800.652.4020\n The following interesting questions/assumptions emerged from previous cursory analysis of this malware:\n\n • C2 appears to be accomplished via providing commands in an encrypted file stored on the local ‘master’ system (re: netsat.exe). This C2 scheme would seem to dictate:\n o Intruder remote access to the ‘master’ system o Intruder local access to the ‘master’ system o a C2 delivery/retrieval component, such as another piece of code that\n downloads a C2 file\n • Available information precludes determination of the means of exfiltration. Netsat.exe’s data collection functionality suggested data destined for exfiltration might be collected by the ‘master’ system. This possibility suggests:\n o Intruder remote access to the ‘master’ system o Intruder local access to the ‘master’ system o An exfiltration mechanism in the form of another piece of code\n\n Further analysis confirms the malware’s use of an encrypted file stored on the system whereon the malware is executing without an apparent means of automatic generation. This continues to suggest that intruders either have local or remote access to headquarters systems running netsat.exe or access to another application that automates remote C2 data/file retrieval. Intruders’ apparent ability to distinguish between particular field unit vehicles (infected drives), ref: Possible \r Commands \r One \r -­‐ \r Targeting \r Specific \r \n\nDevices \r (Known \r to \r Intruder \r From \r Previous \r netsat/netui3 \r Activity) \r from \r Hypothetical \r command \r table,\n### suggests active engagement with the malware and targets.\n\n Conclusion \r \n\n This report is based on information extracted from reverse engineering and analysis of two PE files. There are other components and artifacts of this malware that are currently inaccessible to Fidelis analysts. Therefore, analysts extrapolated some of the behavior presented here. While analysts are confident about behaviors described to date, there could certainly be additional behaviors and nuances heretofore unseen.\n\n Analysis of this malware continues to suggest that a sophisticated effort was behind its creation and employment. Actors went to great lengths to make the malware efficient and effective while building in obfuscation and complexity. Interesting artifacts and observations continue to be discovered and made, such as the malware’s apparent expiration, the interesting naming convention for a directory to hold collected data, and the actors’ apparent intention to avoid certain networks or network addressing schemes.\n\nCopyright © 2014 General Dynamics Fidelis Cybersecurity Solutions Rev 2014-01-31\n\n\n-----\n\n### www.fidelissecurity.com\n www.threatgeek.com\n @FidSecSys +1800.652.4020\n\n Analysis continues and any relevant additional information will be reported as soon as practicable.\n```\nAppendix 1 Commands (for reference purposes)\n\n The following commands and their descriptions, listed by executable file, illustrate the submitted malware’s functionality:\n\n```\nnetsat.exe\n\n**Command** **Description**\n\ncpd copies directories and contents\n\ncpr copies files with size checking\n\nder deletes files and records activity in log\n\ndir obtains a directory listing\n\nwrites \r malicious \r files \r to \r a \r hidden \r RECYCLED \r or \r RECYCLER \r directory\nFiles: \r setup35.exe \r (renamed \r netui3.dll), \r Autorun.inf, \r ~disk.ini\n\nferry (renamed netwi.drv), act.te\n\niteratively \r copies \r files \r from \r RECYCLED/RECYCLER \r directory \r on \r target\ndrive, \r deletes \r from \r source \r after \r copy \r -­‐ \r source \r is \r assumed \r to \r be\n\ngetres drive used to collect data from one or more systems\n\nnetui3.dll \r (setup35.exe)\n\n**Command** **Description**\n\ncp copies files from one location to another\n\ncpu copies files from one location to another setting copied files as hidden\n\ncptur creates a directory and copies file to that directory\n\nsilently \r deletes \r directory \r (performs \r an \r FO_DELETE \r shell \r file \r operation \r on \r a\ndirectory \r with \r the \r FOF_NOERRORUI, \r FOF_NOCONFIRMATION, \r and \r FOF_SILENT\n\nddr flags set)\n\ndel deletes a file\n\ndelu deletes a file after setting attributes to normal\n\ngd recursively writes and reads encoded data to/from a directory\n\nprints \r directory \r listings \r to \r ~FF323D.tmp; \r data \r gets \r encoded; \r original\n\ngdir ~FF323D.tmp file is deleted\n\ngf writes and reads encoded data to/from a file\n\nCopyright © 2014 General Dynamics Fidelis Cybersecurity Solutions Rev 2014-01-31\n\n|netsat.exe Command Description|Col2|\n|---|---|\n|cpd|copies directories and contents|\n|cpr|copies files with size checking|\n|der|deletes files and records activity in log|\n|dir|obtains a directory listing|\n|ferry|writes malicious files to a hidden RECYCLED or RECYCLER directory Files: setup35.exe (renamed netui3.dll), Autorun.inf, ~disk.ini (renamed netwi.drv), act.te|\n|getres|iteratively copies files from RECYCLED/RECYCLER directory on target drive, deletes from source after copy -­‐ source is assumed to be drive used to collect data from one or more systems|\n\n|netui3.dll (setup35.exe) Command Description|Col2|\n|---|---|\n|cp|copies files from one location to another|\n|cpu|copies files from one location to another setting copied files as hidden|\n|cptur|creates a directory and copies file to that directory|\n|ddr|silently deletes directory (performs an FO_DELETE shell file operation on a directory with the FOF_NOERRORUI, FOF_NOCONFIRMATION, and FOF_SILENT flags set)|\n|del|deletes a file|\n|delu|deletes a file after setting attributes to normal|\n|gd|recursively writes and reads encoded data to/from a directory|\n|gdir|prints directory listings to ~FF323D.tmp; data gets encoded; original ~FF323D.tmp file is deleted|\n|gf|writes and reads encoded data to/from a file|\n\n\n-----\n\n### www.fidelissecurity.com\n www.threatgeek.com\n @FidSecSys +1800.652.4020\n\nnetui3.dll \r (setup35.exe)\n\n**Command** **Description**\n\ndetermines \r if \r it \r has \r access \r to \r a \r file; \r may \r be \r a \r temp \r file \r creation/rename\n\ngfover involved\n\ncollects \r system \r related \r and \r possibly \r network \r related \r information\n\ngi such as, domains, system information\n\nndr creates a directory\n\nnewend closes a file that was opened for writing\n\nsets \r normal \r attributes \r on \r a \r targeted \r file, \r deletes \r the \r file, \r opens \r the \r same \r file\n\nnewstar name as a binary file\n\nwr writes a string to a new file opened by the newstar command.\n\ntry \r to \r run \r a \r targeted \r executable \r and \r then \r checks \r for \r the \r existence \r of \r that \r file\n\nrunb every second for the next 15 minutes as long as it exists\n\nrune try to run a targeted executable one time\n\ngenerates \r a \r targeted \r file \r listing, \r e.g., \r dir, \r then \r copies \r the \r files \r in \r the \r list \r one\n\nslf by one\n\nsrf copies files in a list one by one\n\nuses \r NetUseAdd \r to \r connect \r to \r ipc$ \r share \r of \r a \r target \r host, \r creates \r a \r listing \r of\nfiles \r in \r the \r c$ \r -­‐ \r z$ \r shares \r of \r the \r target \r host,\ncopies \r the \r files \r to \r a \r new \r location, \r deletes \r the \r share \r connection \r added \r using\n\nsrmf NetuseAdd\n\nNote: rows highlighted in grey denote a best guess on functionality; more analysis needed\n\nCopyright © 2014 General Dynamics Fidelis Cybersecurity Solutions Rev 2014-01-31\n\n|netui3.dll (setup35.exe) Command Description|Col2|\n|---|---|\n|gfover|determines if it has access to a file; may be a temp file creation/rename involved|\n|gi|collects system related and possibly network related information such as, domains, system information|\n|ndr|creates a directory|\n|newend|closes a file that was opened for writing|\n|newstar|sets normal attributes on a targeted file, deletes the file, opens the same file name as a binary file|\n|wr|writes a string to a new file opened by the newstar command.|\n|runb|try to run a targeted executable and then checks for the existence of that file every second for the next 15 minutes as long as it exists|\n|rune|try to run a targeted executable one time|\n|slf|generates a targeted file listing, e.g., dir, then copies the files in the list one by one|\n|srf|copies files in a list one by one|\n|srmf|uses NetUseAdd to connect to ipc$ share of a target host, creates a listing of files in the c$ -­‐ z$ shares of the target host, copies the files to a new location, deletes the share connection added using NetuseAdd|\n|Note: rows highlighted in grey denote a best guess on functionality; more analysis needed||\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/yvbehxsn3tknzogt74z9ryn7r7elwpmf",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2014/2014.01.31.Sneakernet_Trojan/FTA%201011%20Follow%20UP.pdf"
    ],
    "report_names": [
        "FTA 1011 Follow UP"
    ],
    "threat_actors": [
        {
            "id": "2864e40a-f233-4618-ac61-b03760a41cbb",
            "created_at": "2023-12-01T02:02:34.272108Z",
            "updated_at": "2025-03-27T02:02:10.209072Z",
            "deleted_at": null,
            "main_name": "WildCard",
            "aliases": [],
            "source_name": "ETDA:WildCard",
            "tools": [
                "RustDown",
                "SysJoker"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "256a6a2d-e8a2-4497-b399-628a7fad4b3e",
            "created_at": "2023-11-30T02:00:07.299845Z",
            "updated_at": "2025-03-27T02:00:03.257794Z",
            "deleted_at": null,
            "main_name": "WildCard",
            "aliases": [],
            "source_name": "MISPGALAXY:WildCard",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716502,
    "ts_updated_at": 1743041799,
    "ts_creation_date": 1391188435,
    "ts_modification_date": 1391188435,
    "files": {
        "pdf": "https://archive.orkl.eu/036b1154d4cc2de08dc647eb743c6b4c9d860902.pdf",
        "text": "https://archive.orkl.eu/036b1154d4cc2de08dc647eb743c6b4c9d860902.txt",
        "img": "https://archive.orkl.eu/036b1154d4cc2de08dc647eb743c6b4c9d860902.jpg"
    }
}