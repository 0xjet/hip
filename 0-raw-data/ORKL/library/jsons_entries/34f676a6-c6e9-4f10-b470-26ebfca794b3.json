{
    "id": "34f676a6-c6e9-4f10-b470-26ebfca794b3",
    "created_at": "2023-01-12T15:08:27.744827Z",
    "updated_at": "2025-03-27T02:13:29.409416Z",
    "deleted_at": null,
    "sha1_hash": "2bd657db277f4f8487d34d8e94e1eaa87ebaac2c",
    "title": "2020-06-30 - Detection Rules by Elastic",
    "authors": "",
    "file_creation_date": "2022-05-28T00:26:03Z",
    "file_modification_date": "2022-05-28T00:26:03Z",
    "file_size": 128612,
    "plain_text": "# Detection Rules\n\n**github.com/elastic/detection-rules**\n\nelastic\n\n[pythonpython 3.8+3.8+](https://www.python.org/downloads/) [Unit TestsUnit Tests](https://github.com/elastic/detection-rules/actions) passingpassing [chatchat #security-detection-rules#security-detection-rules](https://ela.st/slack) [ATT&CKATT&CK NavigatorNavigator](https://ela.st/detection-rules-navigator)\n\nDetection Rules is the home for rules used by Elastic Security. This repository is used for the\ndevelopment, maintenance, testing, validation, and release of rules for Elastic Security’s\nDetection Engine.\n\n\n[ATT&CKATT&CK NavigatorNavigator](https://ela.st/detection-rules-navigator)\n\n\n[Unit TestsUnit Tests](https://github.com/elastic/detection-rules/actions)\n\n\n-----\n\nThis repository was first announced on Elastic s blog post, Elastic Security opens public\ndetection rules repo. For additional content, see the accompanying webinar, Elastic Security:\nIntroducing the public repository for detection rules.\n\n## Table of Contents\n\n Overview of this repository\n\nDetection Rules contains more than just static rule files. This repository also contains code\nfor unit testing in Python and integrating with the Detection Engine in Kibana.\n\n**folder** **description**\n\n`detection_rules/` Python module for rule parsing, validating and packaging\n\n`detection_rules/etc/` Miscellaneous files, such as ECS and Beats schemas\n\n`kibana/` Python library for handling the API calls to Kibana and the\nDetection Engine\n\n`kql/` Python library for parsing and validating Kibana Query\nLanguage\n\n`rta/` Red Team Automation code used to emulate attacker\ntechniques, used for rule testing\n\n`rules/` Root directory where rules are stored\n\n`tests/` Python code for unit testing rules\n\n## Getting started\n\nAlthough rules can be added by manually creating `.toml files, we don't recommend it. This`\nrepository also consists of a python module that aids rule creation and unit testing. Assuming\nyou have Python 3.8+, run the below command to install the dependencies:\n```\n$ pip install -r requirements.txt\nCollecting jsl==0.2.4\n Downloading jsl-0.2.4.tar.gz (21 kB)\nCollecting jsonschema==3.2.0\n Downloading jsonschema-3.2.0-py2.py3-none-any.whl (56 kB)\n   |████████████████████████████████| 56 kB 318 kB/s\nCollecting requests==2.22.0\n Downloading requests-2.22.0-py2.py3-none-any.whl (57 kB)\n   |████████████████████████████████| 57 kB 1.2 MB/s\nCollecting Click==7.0\n Downloading Click-7.0-py2.py3-none-any.whl (81 kB)\n   |████████████████████████████████| 81 kB 2.6 MB/s\n...\n\n```\n\n-----\n\nTo confirm that everything was properly installed, run with the `--help flag`\n```\n$ python -m detection_rules --help\nUsage: detection_rules [OPTIONS] COMMAND [ARGS]...\n Commands for detection-rules repository.\nOptions:\n -d, --debug / -n, --no-debug Print full exception stacktrace on errors\n -h, --help          Show this message and exit.\nCommands:\n create-rule   Create a detection rule.\n dev       Commands for development and management by internal...\n es       Commands for integrating with Elasticsearch.\n import-rules  Import rules from json, toml, or Kibana exported rule...\n kibana     Commands for integrating with Kibana.\n mass-update   Update multiple rules based on eql results.\n normalize-data Normalize Elasticsearch data timestamps and sort.\n rule-search   Use KQL or EQL to find matching rules.\n test      Run unit tests over all of the rules.\n toml-lint    Cleanup files with some simple toml formatting.\n validate-all  Check if all rules validates against a schema.\n validate-rule  Check if a rule staged in rules dir validates against a...\n view-rule    View an internal rule or specified rule file.\n\n```\nThe [contribution guide describes how to use the](https://github.com/elastic/detection-rules/blob/main/CONTRIBUTING.md) `create-rule and` `test commands to`\ncreate and test a new rule when contributing to Detection Rules.\n\n[For more advanced command line interface (CLI) usage, refer to the CLI guide.](https://github.com/elastic/detection-rules/blob/main/CLI.md)\n\n## How to contribute\n\nWe welcome your contributions to Detection Rules! Before contributing, please familiarize\nyourself with this repository, its directory structure, and our [philosophy about rule creation.](https://github.com/elastic/detection-rules/blob/main/PHILOSOPHY.md)\n[When you're ready to contribute, read the contribution guide to learn how we turn detection](https://github.com/elastic/detection-rules/blob/main/CONTRIBUTING.md)\nideas into production rules and validate with testing.\n\n## Licensing\n\nEverything in this repository — rules, code, RTA, etc. — is licensed under the Elastic License\nv2. These rules are designed to be used in the context of the Detection Engine within the\n[Elastic Security application. If you’re using our Elastic Cloud managed service or the default](https://www.elastic.co/cloud/)\n[distribution of the Elastic Stack software that includes the full set of free features, you’ll get](https://www.elastic.co/subscriptions)\nthe latest rules the first time you navigate to the detection engine.\n\n\n-----\n\nOccasionally, we may want to import rules from another repository that already have a\nlicense, such as MIT or Apache 2.0. This is welcome, as long as the license permits\nsublicensing under the Elastic License v2. We keep those license notices in `NOTICE.txt`\nand sublicense as the Elastic License v2 with all other rules. We also require contributors to\n[sign a Contributor License Agreement before contributing code to any Elastic repositories.](https://www.elastic.co/contributor-agreement)\n\n## Questions? Problems? Suggestions?\n\n[Want to know more about the Detection Engine? Check out the overview in Kibana.](https://www.elastic.co/guide/en/siem/guide/current/detection-engine-overview.html)\nThis repository includes new and updated rules that have not been released yet. To\n[see the latest set of rules released with the stack, see the Prebuilt rule reference.](https://www.elastic.co/guide/en/security/current/prebuilt-rules-changelog.html)\nIf you’d like to report a false positive or other type of bug, please create a GitHub issue\nand check if there's an existing one first.\nNeed help with Detection Rules? Post an issue or ask away in our Security Discuss\n[Forum or the #security-detection-rules channel within Slack workspace.](https://www.elastic.co/blog/join-our-elastic-stack-workspace-on-slack)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-06-30 - Detection Rules by Elastic.pdf"
    ],
    "report_names": [
        "2020-06-30 - Detection Rules by Elastic.pdf"
    ],
    "threat_actors": [
        {
            "id": "f4f16213-7a22-4527-aecb-b964c64c2c46",
            "created_at": "2024-06-19T02:03:08.090932Z",
            "updated_at": "2025-03-27T02:05:17.387119Z",
            "deleted_at": null,
            "main_name": "GOLD NIAGARA",
            "aliases": [
                "Carbanak",
                "Carbon Spider ",
                "FIN7 ",
                "Navigator ",
                "Sangria Tempest ",
                "TelePort Crew ",
                "Calcium "
            ],
            "source_name": "Secureworks:GOLD NIAGARA",
            "tools": [
                " Carbanak",
                " Cobalt Strike",
                " DICELOADER",
                " DRIFTPIN",
                " GGLDR",
                " GRIFFON",
                " JSSLoader",
                " Meterpreter",
                " OFFTRACK",
                " PILLOWMINT",
                " POWERTRASH",
                " SUPERSOFT",
                " TAKEOUT",
                " TinyMet",
                "Bateleur"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673536107,
    "ts_updated_at": 1743041609,
    "ts_creation_date": 1653697563,
    "ts_modification_date": 1653697563,
    "files": {
        "pdf": "https://archive.orkl.eu/2bd657db277f4f8487d34d8e94e1eaa87ebaac2c.pdf",
        "text": "https://archive.orkl.eu/2bd657db277f4f8487d34d8e94e1eaa87ebaac2c.txt",
        "img": "https://archive.orkl.eu/2bd657db277f4f8487d34d8e94e1eaa87ebaac2c.jpg"
    }
}