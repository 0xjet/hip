{
    "id": "9e312824-b63f-4ceb-85b5-79086cb63d68",
    "created_at": "2022-10-25T16:48:18.474739Z",
    "updated_at": "2025-03-27T02:06:05.444098Z",
    "deleted_at": null,
    "sha1_hash": "efdcd716cde10b6f13d76b51e2f0c5a13b078047",
    "title": "Duqu 2.0: Reemergence of an aggressive cyberespionage threat",
    "authors": "Symantec",
    "file_creation_date": "2018-08-09T18:23:56Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 272761,
    "plain_text": "# Duqu 2.0: Reemergence of an aggressive cyberespionage threat\n\n**[symantec.com/connect/blogs/duqu-20-reemergence-aggressive-cyberespionage-threat](https://www.symantec.com/connect/blogs/duqu-20-reemergence-aggressive-cyberespionage-threat)**\n\nJune 9, 2015\n\nSymantec Official Blog\n\nAttackers use new version of Duqu worm in ambitious attacks against telecoms, electronics\nand even information security sectors.\n\n[By: Symantec Security ResponseSymantec Employee](https://www.symantec.com/connect/user/symantec-security-response)\n\nCreated 10 Jun 2015\n: [日本語,](https://www.symantec.com/connect/ja/blogs/duqu-20) [한국어](https://www.symantec.com/connect/blogs/duqu-20-0)\n\n0\n0\n\nDuqu 2.0, the cyberespionage tool that was used to compromise security firm Kaspersky Lab,\nhas also been used in a number of other attack campaigns against a range of targets,\nincluding several telecoms firms. Analysis by Symantec concurs with Kaspersky’s assessment\n[today that Duqu 2.0 (detected by Symantec as W32.Duqu.B) is an evolution of the older Duqu](http://www.symantec.com/security_response/writeup.jsp?docid=2015-061011-4334-99)\nworm, which was used in a number of intelligence-gathering attacks against a range of\nindustrial targets before it was exposed in 2011. Although their functionalities were different,\n[the original Duqu worm had many similarities with the Stuxnet worm used to sabotage the](http://www.symantec.com/connect/w32_duqu_precursor_next_stuxnet)\nIranian nuclear development program.\n\n|Symantec Security Response|Symantec Employee|\n|---|---|\n\n\n-----\n\nSymantec has found evidence that Duqu has been used in a number of different attack\ncampaigns against a small number of selected targets. Among the organizations targeted were\na European telecoms operator, a North African telecoms operator, and a South East Asian\nelectronic equipment manufacturer. Infections were also found on computers located in the\nUS, UK, Sweden, India, and Hong Kong.\n\nIn addition to the attack against itself, Kaspersky believes Duqu was used to target countries\ninvolved in international negotiations surrounding Iran’s nuclear program. Given the diversity of\ntargets, Symantec believes that the Duqu attackers have been involved in multiple\ncyberespionage campaigns. Some organizations may not be the ultimate targets of the group’s\noperations, but rather stepping stones towards the final target. The group’s interest in telecoms\noperators could be related to attempts to monitor communications by individuals using their\nnetworks.\n\nSymantec has found no evidence to suggest that it has been affected by attacks using this\nmalware.\n\n**Duqu 2.0 in operation**\nThis new version of Duqu is stealthy and resides solely in the computer’s memory, with no files\nwritten to disk. It comes in two variants. The first is a basic back door that appears to be used\nto gain a persistent foothold inside the targeted entity by infecting multiple computers.\n\nThe second variant is more complex. It has the same structure as the first, but contains several\nmodules that provide a range of functionality to the malware, such as gathering information on\nthe infected computer, stealing data, network discovery, network infection, and communication\nwith command-and-control (C&C) servers. This variant appears to be deployed to computers\ndeemed to be targets of interest by the attackers.\n\n**Common code and code flow**\nDuqu and Duqu 2.0 share large amounts of code, in addition to similarities in how that code is\norganized. The shared code includes a number of helper functions. For example, as shown in\nFigure 1, there is a “gen_random” function (as labelled by an engineer) that is shared between\nDuqu and Duqu 2.0.\n\nNot only is that gen_random code shared, but the code that calls that function is also\norganized almost identically. Such similarities in how code is called is repeated in several other\nlocations throughout Duqu 2.0, including in how C&C IP addresses are formatted, how\nnetwork messages are generated, and how files are encrypted and decrypted.\n\n\n-----\n\n_Figure 1. Duqu vs Duqu 2.0 code flow_\n\nWhen a program needs to store data, the program author will design structures to store that\ndata in a logical and easily accessible manner. Duqu and Duqu 2.0 share a number of these\ndata structures.\n\n**Network communications**\nAnother shared feature between the two variants, as shown in Figure 1, is the use of a cookie\nheader with a hardcoded string and a random string when sending messages to a C&C server.\nFor example:\n\nDuqu: Cookie: PHPSESSID=<random_str_0x1A_size>\nDuqu 2.0: Cookie: COUNTRY=<random_str_0x1A_size>\n\nA second shared feature in the network communications code is to connect to a number of\nMicrosoft URLs to retrieve a proxy address, as shown in Figure 2.\n\n\n-----\n\n_Figure 2. Duqu vs Duqu 2.0 network code_\n\nThe list of Microsoft URLs connected to, by both variants, is identical.\n\nFinally, for network communications, when Duqu uses HTTP, it will use image names in the\n“Content-Disposition” header. For Duqu, the value “DSC00001.jpg” was used, whereas for\nDuqu 2.0, the value “%05d.gif” is used.\n\n**Conclusion**\nBased on our analysis, Symantec believes that Duqu 2.0 is an evolution of the original threat,\ncreated by the same group of attackers. Duqu 2.0 is a fully featured information-stealing tool\nthat is designed to maintain a long term, low profile presence on the target’s network. Its\ncreators have likely used it as one of their main tools in multiple intelligence gathering\ncampaigns.\n\nGiven that activity surrounding the original version of Duqu dropped off following its discovery,\nit is likely that the group may now retreat before re-emerging with new malware.\n\n**Protection**\nSymantec and Norton products detect this threat as:\n\n[W32.Duqu.B](http://www.symantec.com/security_response/writeup.jsp?docid=2015-061011-4334-99)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/amixilnvbz29s9122fe9hfg00srndw70"
    ],
    "report_names": [
        "Symantec_Duqu2-Reemergence-aggressive-cyberespionage-threat(06-10-2015)"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716498,
    "ts_updated_at": 1743041165,
    "ts_creation_date": 1533839036,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/efdcd716cde10b6f13d76b51e2f0c5a13b078047.pdf",
        "text": "https://archive.orkl.eu/efdcd716cde10b6f13d76b51e2f0c5a13b078047.txt",
        "img": "https://archive.orkl.eu/efdcd716cde10b6f13d76b51e2f0c5a13b078047.jpg"
    }
}