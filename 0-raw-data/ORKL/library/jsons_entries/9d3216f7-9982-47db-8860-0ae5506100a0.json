{
    "id": "9d3216f7-9982-47db-8860-0ae5506100a0",
    "created_at": "2023-01-12T15:05:23.938936Z",
    "updated_at": "2025-03-27T02:13:16.620795Z",
    "deleted_at": null,
    "sha1_hash": "f83a8ec5e64bdefa090f5d3ddeb4cfc56b846497",
    "title": "2021-11-01 - Diving into double extortion campaigns",
    "authors": "",
    "file_creation_date": "2022-05-28T05:10:36Z",
    "file_modification_date": "2022-05-28T05:10:36Z",
    "file_size": 616713,
    "plain_text": "# Diving into double extortion campaigns\n\n**[accenture.com/us-en/blogs/cyber-defense/double-extortion-campaigns](https://www.accenture.com/us-en/blogs/cyber-defense/double-extortion-campaigns)**\n\nBy Heather Larrieu, Curt Wilson, Katrina Hill\n\nPrevious [Accenture Security blogs have provided insight into ongoing “Big-Game” extortion](https://www.accenture.com/us-en/blogs/security/ransomware-hades)\ncampaigns conducted by a threat group recently leveraging Hades, Phoenix Cryptolocker,\n[and now Macaw Locker ransomware variants. Multiple intelligence sources are now linking](https://www.cyberscoop.com/sinclair-broadcast-group-russia-ransomware-evil-corp-macaw/)\nthe campaign to the Evil Corp threat group, which Accenture Security assesses to be true\nwith moderate confidence.\n\nThis blog is part 1 of a 2-part series and will walk through an example attack timeline,\naddress the critical events, and count down the days leading to ransomware deployment, as\nshown in Figure 1. Part 2 will highlight additional technical details of the intrusion clusters,\nassociated attacker TTPs, and provide potential opportunities for detection that can be used\nto address these and similar “hands-on-keyboard” threat groups to support defenders in the\nfield.\n\nThe information in this blog is based on data collected from CIFR incident response\nengagements. All intrusion data, analysis, and derived conclusions are based on Accenture’s\ndistinct collection sources and available forensic artifacts.\n\n<<< Start >>>\n\n\n-----\n\n**Caption: Figure 1 - Key Events Leading to Ransomware Deployment. Copyright © 2021**\n_Accenture. All rights reserved_\n\n<<< End >>>\n\n**Initial Access:**\n\nThe threat group has been seen using two different methods for initial access into the victim\nnetworks. The first is using previously acquired legitimate credentials that are not configured\nfor multi-factor authentication (MFA) to access Internet-facing systems via exposed Remote\nDesktop Protocol (RDP) or using enterprise Virtual Private Network (VPN) services. The\nsecond utilized the foothold established by the SocGholish malware that was delivered to\nclient systems via a fake browser update page. The fake update page, in this instance\nGoogle Chrome, is served from a compromised website with a message that indicates the\nclient Chrome browser is out of date as shown by the example Figure 1.\n\n<<< Start >>>\n\n\n-----\n\n**Caption: Figure 2 - Fake Google Chrome Update Page – Source: Accenture CTI IntelGraph**\n\n<<< End >>>\n\nDepending on the configuration, a fake instance of Google Chrome is downloaded to the\nmachine automatically or in response to the user clicking on the update button.\n\nThe SocGholish JavaScript code is encoded and has multiple stages of obfuscation to\nbypass security controls and evade detection. On execution, JavaScript will first profile the\nmachine and exfiltrate detailed information system information such as:\n\nComputer name\nUsername\nOperating system\nDomain\nAnti-malware products installed\nProcess lists\nHardware information\n\nIf the machine meets criteria specified by threat groups, then the next stage of compromise\ncommences as additional malware such as the post-exploit tool Cobalt Strike is downloaded\nto the machine. Figure 2 shows a generalized activity flow from variants of SocGholish from\nMarch and August of 2021:\n\n\n-----\n\n<<< Start >>>\n\n**Caption: Figure 3 – SocGholish Activity Flow – Source: Accenture CTI IntelGraph**\n\n<<< End >>>\n\nSocGholish has been associated with the EvilCorp threat group as well as the threat group\nnamed UNC2602 by Mandiant.\n\n<<< Start >>>\n\n[Ransomware response and recovery](https://www.accenture.com/us-en/insights/security/ransomware-response-recovery)\n\n[READ MORE](https://www.accenture.com/us-en/insights/security/ransomware-response-recovery)\n\n<<< End >>>\n\nAround 266 days before ransomware deployment:\n\nThe threat group dropped Cobalt Strike Beacon, an implant commonly used in ransomware1\ncampaigns, on 6 endpoints to further their foothold and maintain persistence within the\nvictim’s environment. Shortly after execution, the Cobalt Strike Beacon connected out to the\nthreat group’s Command and Control (C2) server, newschools[.]info.\n\nThe Cobalt Strike Beacon implant was found in the C:\\ProgramData directory which served\nas a primary staging area for the threat actors. Accenture Security noted that the group\noperated out of this staging directory across multiple systems with several tools and\n\n\n-----\n\nexecutables tied to the intrusion set consistently stored and executed from this path.\n\nThe extracted configuration file associated with the Cobalt Strike Beacon implant was used\nby Accenture Security to confirm that the implant was configured to check-in to its C2 server\nat two defined domains (currentteach[.]com or newschools[.]info) for pending tasks and then\nproceed to sleep for 45000 seconds with a 37% jitter percentage. What this means is that the\nbeacon will sleep for a random time between 28350s to 45000s before the next check-in,\nmaking it difficult to predict the beacon pattern using common network detection techniques.\nThe configuration also highlights other settings used by the threat actor to make detection\nmore difficult by using junk data and customizable protocol headers.\n\nThe Cobalt Strike Beacon watermark for this particular implant is 305419896 which should\nordinarily map to a unique Cobalt Strike license. In this case, however, this watermark has\nbeen reported associated with leaked or stolen Cobalt Strike instances and has been\npreviously associated with ransomware affiliated operators at least as early as June 2020.2\n\n**Around 265 days before ransomware deployment:**\n\nThe threat group had a successful login using a valid account from a non-standard hostname\npaired with an IP address from the victim network VPN range. Inspection of the hostname\ncollected from Windows Security Logs events showed the workstation names used by the\nthreat actor were not consistent with internal naming convention and, in fact, the names were\namong defaults assigned to publicly available VM images intended for testing.\n\n**Around 180 days before ransomware deployment:**\n\nThe threat group enumerated around 1,200 network shares. Adversaries enumerate network\nshares to gain knowledge about the environment or to look for sensitive information that can\nbe later used for collection and exfiltration. During this phase of network share enumeration,\nthe threat group viewed the following items:\n\nIT Security operation documentation\nInfrastructure diagrams\nOneDrive documents\nStored password safes\nBackup operational documentation\nHR documents\nLegal documents\nFinancial documents\n\nThese documents provided key pivot points for the threat group to leverage.\n\n**Around 60 days before ransomware deployment:**\n\n\n-----\n\nThe threat group continued to login to the environment using a valid account from a nonstandard hostname paired with an IP address from the clients known VPN range. In addition,\nthe threat group leveraged RDP to move laterally throughout the environment.\n\n**Around 13 days before ransomware deployment:**\n\nFrom the threat actor’s staging directory, C:\\ProgramData, the threat group executed\nMimikatz, a well-known tool used for credential dumping and privilege escalation, along with\nAdvanced Port Scanner, a network scanning tool. Reviewing the filesystem, as shown below,\nthe threat group made no attempt to conceal the name or obfuscate the tools beyond having\nthem in an unusual staging directory.\n\n<<< Start >>>\n\n<<< End >>>\n\n**Around 9 days before ransomware deployment:**\n\nThe threat group enumerated C:\\ProgramData shares on around 230 systems. Accenture\nSecurity theorizes that the threat group was verifying access before staging the ransomware\nin C:\\ProgramData.\n\n**Around 7 days before ransomware deployment:**\n\nUtilizing network shares, the threat group copied Google Chrome executables to different\nendpoints. From the Google Chrome browser executing on the targeted endpoints, the threat\ngroup would access a variety of critical web portals using legitimate user credentials\nacquired from earlier credential dumping with Mimikatz. Targeted sites included high value\ninformation repositories such as IT and Security team mailboxes and documentation and\nsystem architecture sites.\n\nAdditionally, the environment was configured to federate access to the AWS environment via\nSAML using Microsoft Azure Active Directory as described by AWS Security Blog “How to\nautomate SAML federation to multiple AWS accounts from Microsoft Azure Active Directory.”\nWith this configuration, the threat group was able to login to the “Microsoft MyApps” portal\nwith the valid stolen Azure AD user credential and access the AWS environments without\nany MFA prompt. This allowed console access to several AWS resources:\n\nAWS Backup\nAWS Management Console\nAWS Storage Gateway\nS3 Management Console\n\n\n-----\n\n**About 2 days before ransomware deployment:**\n\nThe threat group executed PuTTY, a SSH client, and Advanced Port Scanner. Shortly after,\nthere is evidence of Advanced Port Scanner being quarantined by AV and then it being\nremoved from quarantine. This behavior is evidence of the threat group having sufficient\nprivileged access such that they were able to disable or modify security tools to avoid their\ntools being detected or contained. Reviewing the filesystem showed that the threat group\nagain made no attempt to conceal the nature of the tools.\n\n**1 day before ransomware deployment:**\n\nThe threat group invoked a reverse SOCKS proxy for an additional layer of persistence. A\nreverse SOCKS proxy allows a persistent network connection between the attacker’s\ninfrastructure and the clients environment.\n\nBelow is an example of a PowerShell command invoking a reverse SOCKS proxy.\n\n<<< Start >>>\n\n**Caption: Figure 4 - Reverse SOCKS proxy command**\n\n<<< End >>>\n\n**RANSOM DAY**\n\nThe access and knowledge of the client environment gained by the threat actors over the\npast activities is employed to destroy the client’s ability to do business, hamper recovery, and\ncollect sensitive data for increased leverage in potential ransom negotiations. Tempo and\nspecific operations suggest at least two distinct sets-of-hands on keyboard operators.\n\n**About 6 hours before ransomware deployment:**\n\nThe day of ransomware deployment, evidence shows the threat group utilizing Google\nChrome to Google Search questions to help achieve their next steps such as how to disable\nsecurity tools and retrieve credentials.\n\nBelow are the search history results:\n\n“How to uninstall [antivirus tool]”\n“Uninstall [antivirus tool] without password”\n“aws cli get credentials path”\n“[antivirus tool] get credentials path”\n\n\n-----\n\n[antivirus tool] bulk uninstall agent\n\"putty download”\n\nDuring this time, the threat group is also seen accessing the following websites:\n\nAWS Backup\nAWS Command Line Interface\nAWS Management Console\nDownload PuTTY: Latest release (0.74)\n\nShortly after, there is evidence of the threat group downloading a credential file, AWS CLI\nversion 2, and PuTTY.\n\n**About 4 hours before ransomware deployment:**\n\nThe threat group utilized 7zip to archive data that was then staged and exfiltrated to an\nattacker-controlled server hosted in Mega.nz cloud infrastructure, leveraging the MEGAsync\nutility. MEGA is an encrypted cloud storage tool often leveraged in ransomware incidents.\nAfter the data was exfiltrated, the threat group attempted to cover their tracks by moving all\n7zip files to the recycle bin. Once again, evidence shows that the threat actor did not attempt\nto conceal 7zip and MEGAsync as shown below.\n\n<<< Start >>>\n\n<<< End >>>\n\n**About 4 hours before ransomware deployment:**\n\nWhile preparing for ransomware deployment, the threat group deleted snapshots of critical\nbusiness data from network attached storage (NAS) device that had no functional backup.\nFigure 5 shows the threat group deleting the NAS snapshots.\n\n<<< Start >>>\n\n**Caption: Figure 5 - NAS logs**\n<<< End >>>\n\n\n-----\n\nThe threat group used Microsoft MyApps portal to get into AWS console and from there\ndeleted all the S3 buckets containing the \"backup” within in the name.\n\nThen, a batch script, shown in Figure 8, that leveraged wevtutil.exe to clear event logs was\nused on affected hosts.\n\n<<< Start >>>\n\n**Caption: Figure 6 - Batch script used to clear event logs**\n\n<<< End >>>\n\n**Ransomware deployment:**\n\nIn preparation of the ransomware deployment, the threat group leveraged PowerShell to\ndisable security tools such as Windows Defender. Figure 7 was the PowerShell command\nused to shut down Windows Defender.\n\n<<< Start >>>\n\n**Caption: Figure 7 - PowerShell command to disable Windows Defender**\n\n<<< End >>>\n\nFrom a domain controller, the threat group used PSEXEC to make connections to 1,200\nsystems to push out a batch script to shutdown security services running on a 30 second\nsleep loop as shown in Figure 8.\n\n<<< Start >>>\n\n\n-----\n\n**Caption: Figure 8 - Batch script to shutdown security services**\n\n<<< End >>>\n\nAfter the security services were shutdown, the threat group pushed ransomware across the\nenvironment.\n\n**After ransomware deployment:**\n\nAt this point, the threat actor leaves the network in shambles. The organization is left to\nrecover their environment the best they can and contemplate paying the ransom.\n\nPart 2 of this blog series will dive deeper into detection and hunting opportunities to be\nleveraged by network defenders.\n\nIf you have an incident or need additional information on ways to detect and respond to\ncyberthreats, contact a member of our CIFR team 24/7/365 by phone 888-RISK-411 or email\nCIFR.hotline@accenture.com\n\n**Accenture Security is a leading provider of end-to-end cybersecurity services, including**\nadvanced cyber defense, applied cybersecurity solutions and managed security operations.\nWe bring security innovation, coupled with global scale and a worldwide delivery capability\nthrough our network of Advanced Technology and Intelligent Operations centers. Helped by\nour team of highly skilled professionals, we enable clients to innovate safely, build cyber\nresilience and grow with confidence. Follow us @AccentureSecure on Twitter or visit us at\n[www.accenture.com/security.](http://www.accenture.com/security)\n\nAccenture, the Accenture logo, and other trademarks, service marks, and designs are\nregistered or unregistered trademarks of Accenture and its subsidiaries in the United States\nand in foreign countries. All trademarks are properties of their respective owners. All\nmaterials are intended for the original recipient only. The reproduction and distribution of this\nmaterial is forbidden without express written permission from Accenture. The opinions,\n\n\n-----\n\nstatements, and assessments in this report are solely those of the individual author(s) and do\nnot constitute legal advice, nor do they necessarily reflect the views of Accenture, its\nsubsidiaries, or affiliates. Given the inherent nature of threat intelligence, the content\ncontained in this article is based on information gathered and understood at the time of its\ncreation. It is subject to change. Accenture provides the information on an “as-is” basis\nwithout representation or warranty and accepts no liability for any action or failure to act\ntaken in response to the information contained or referenced in this report.\n\nThis document makes descriptive reference to trademarks that may be owned by others. The\nuse of such trademarks herein is not an assertion of ownership of such trademarks by\nAccenture and is not intended to represent or imply the existence of an association between\nAccenture and the lawful owners of such trademarks.\n\nCopyright © 2021 Accenture. All rights reserved.\n\n**References**\n\n[1 https://attack.mitre.org/software/S0154/](https://attack.mitre.org/software/S0154/)\n\n\n2 https://www.sentinelone.com/labs/enter-the-maze-demystifying-an-affiliate-involved-in\nmaze-snow/\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-11-01 - Diving into double extortion campaigns.pdf"
    ],
    "report_names": [
        "2021-11-01 - Diving into double extortion campaigns.pdf"
    ],
    "threat_actors": [
        {
            "id": "8670f370-1865-4264-9a1b-0dfe7617c329",
            "created_at": "2022-10-25T16:07:23.69953Z",
            "updated_at": "2025-03-27T02:02:09.929725Z",
            "deleted_at": null,
            "main_name": "Hades",
            "aliases": [
                "Operation TrickyMouse"
            ],
            "source_name": "ETDA:Hades",
            "tools": [
                "Brave Prince",
                "Gold Dragon",
                "GoldDragon",
                "Lovexxx",
                "Olympic Destroyer",
                "Running RAT",
                "RunningRAT",
                "SOURGRAPE",
                "running_rat"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "6c4f98b3-fe14-42d6-beaa-866395455e52",
            "created_at": "2023-01-06T13:46:39.169554Z",
            "updated_at": "2025-03-27T02:00:03.011739Z",
            "deleted_at": null,
            "main_name": "Evil Corp",
            "aliases": [
                "GOLD DRAKE"
            ],
            "source_name": "MISPGALAXY:Evil Corp",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "50068c14-343c-4491-b568-df41dd59551c",
            "created_at": "2022-10-25T15:50:23.253218Z",
            "updated_at": "2025-03-27T02:00:55.408128Z",
            "deleted_at": null,
            "main_name": "Indrik Spider",
            "aliases": [
                "Indrik Spider",
                "Evil Corp",
                "Manatee Tempest",
                "DEV-0243",
                "UNC2165"
            ],
            "source_name": "MITRE:Indrik Spider",
            "tools": [
                "Mimikatz",
                "PsExec",
                "Dridex",
                "WastedLocker",
                "BitPaymer",
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "9806f226-935f-48eb-b138-6616c9bb9d69",
            "created_at": "2022-10-25T16:07:23.73153Z",
            "updated_at": "2025-03-27T02:02:09.950784Z",
            "deleted_at": null,
            "main_name": "Indrik Spider",
            "aliases": [
                "Blue Lelantos",
                "DEV-0243",
                "Evil Corp",
                "Gold Drake",
                "Gold Winter",
                "Manatee Tempest",
                "UNC2165"
            ],
            "source_name": "ETDA:Indrik Spider",
            "tools": [
                "Advanced Port Scanner",
                "Agentemis",
                "Babuk",
                "Babuk Locker",
                "Babyk",
                "BitPaymer",
                "Bugat",
                "Bugat v5",
                "Cobalt Strike",
                "CobaltStrike",
                "Cridex",
                "Dridex",
                "EmPyre",
                "EmpireProject",
                "FAKEUPDATES",
                "FakeUpdate",
                "Feodo",
                "FriedEx",
                "Hades",
                "IEncrypt",
                "LINK_MSIEXEC",
                "MEGAsync",
                "Macaw Locker",
                "Metasploit",
                "Mimikatz",
                "PayloadBIN",
                "Phoenix Locker",
                "PowerShell Empire",
                "PowerSploit",
                "PsExec",
                "QNAP-Worm",
                "Raspberry Robin",
                "RaspberryRobin",
                "SocGholish",
                "Vasa Locker",
                "WastedLoader",
                "WastedLocker",
                "cobeacon",
                "wp_encrypt"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b296f34c-c424-41da-98bf-90312a5df8ef",
            "created_at": "2024-06-19T02:03:08.027585Z",
            "updated_at": "2025-03-27T02:05:17.350153Z",
            "deleted_at": null,
            "main_name": "GOLD DRAKE",
            "aliases": [
                "Indrik Spider ",
                "Evil Corp"
            ],
            "source_name": "Secureworks:GOLD DRAKE",
            "tools": [
                " Cobalt Strike",
                " Covenant",
                " Donut",
                " Dridex",
                " Hades",
                " Koadic",
                " LockBit",
                " Macaw Locker",
                " Mimikatz",
                " Payload.Bin",
                " Phoenix CryptoLocker",
                " PowerSploit",
                " Powershell Empire",
                " SocGholish",
                " WastedLocker",
                "BitPaymer"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535923,
    "ts_updated_at": 1743041596,
    "ts_creation_date": 1653714636,
    "ts_modification_date": 1653714636,
    "files": {
        "pdf": "https://archive.orkl.eu/f83a8ec5e64bdefa090f5d3ddeb4cfc56b846497.pdf",
        "text": "https://archive.orkl.eu/f83a8ec5e64bdefa090f5d3ddeb4cfc56b846497.txt",
        "img": "https://archive.orkl.eu/f83a8ec5e64bdefa090f5d3ddeb4cfc56b846497.jpg"
    }
}