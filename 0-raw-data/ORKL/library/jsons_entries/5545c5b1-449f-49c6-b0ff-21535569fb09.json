{
    "id": "5545c5b1-449f-49c6-b0ff-21535569fb09",
    "created_at": "2023-05-06T02:08:42.184441Z",
    "updated_at": "2025-03-27T02:17:23.279732Z",
    "deleted_at": null,
    "sha1_hash": "96b5aa71d8f21dffce6f978bdc6a20f602a1e2e9",
    "title": "2023-04-03 - Not just an infostealer- Gopuram backdoor deployed through 3CX supply chain attack",
    "authors": "",
    "file_creation_date": "2023-05-05T01:50:42Z",
    "file_modification_date": "2023-05-05T01:50:42Z",
    "file_size": 534716,
    "plain_text": "# Not just an infostealer: Gopuram backdoor deployed through 3CX supply chain attack\n\n**[securelist.com/gopuram-backdoor-deployed-through-3cx-supply-chain-attack/109344](https://securelist.com/gopuram-backdoor-deployed-through-3cx-supply-chain-attack/109344)**\n\nAuthors\n\n[Georgy Kucherin](https://securelist.com/author/georgykucherin/)\n\n[Vasily Berdnikov](https://securelist.com/author/vasilyberdnikov/)\n\nVilen Kamalov\n\nOn March 29, Crowdstrike published a report about a supply chain attack conducted via\n3CXDesktopApp, a popular VoIP program. Since then, the security community has started\nanalyzing the attack and sharing their findings. The following has been discovered so far:\n\n\n-----\n\nThe infection is spread via 3CXDesktopApp MSI installers. An installer for macOS has\nalso been trojanized.\nThe malicious installation package contains an infected dll library that decrypts a\nshellcode from the d3dcompiler_47.dll library’s overlay and executes it.\nThe decrypted payload extracts C2 server URLs from icons stored in a GitHub\nrepository (the repository is removed).\nThe payload connects to one of the C2 servers, downloads an infostealer and starts it.\nThe infostealer collects system information and browser history, then sends it to the C2\nserver.\n\nAs we reviewed available reports on the 3CX attack, we began wondering if the compromise\nconcluded with the infostealer or further implants followed. To answer that question, we\ndecided to review the telemetry we had on the campaign. On one of the machines, we\nobserved a DLL named guard64.dll, which was loaded into the infected 3CXDesktopApp.exe\nprocess. Interestingly enough, we opened an investigation into a case linked to that DLL on\nMarch 21, about a week before the supply chain attack was discovered. A DLL with that\nname was used in recent deployments of a backdoor that we dubbed “Gopuram” and had\nbeen tracking internally since 2020. Three years ago, we were investigating an infection of a\ncryptocurrency company located in Southeast Asia. During the investigation, we found that\n[Gopuram coexisted on victim machines with AppleJeus, a backdoor attributed to the Korean-](https://securelist.com/operation-applejeus-sequel/95596/)\n[speaking threat actor Lazarus.](https://securelist.com/tag/lazarus/)\n\nOver the years, we observed few victims compromised with Gopuram, but the number of\ninfections began to increase in March 2023. As it turned out, the increase was directly\nrelated to the 3CX supply chain attack. We found out that the threat actor specifically\ntargeted cryptocurrency companies, dropping the following files on infected machines:\n\nC:\\Windows\\system32\\wlbsctrl.dll, a malicious library (MD5:\n9f85a07d4b4abff82ca18d990f062a84);\nC:\\Windows\\System32\\config\\TxR\\<machine hardware profile GUID>.TxR.0.regtransms, an encrypted shellcode payload.\n\nOnce dropped, wlbsctrl.dll becomes loaded on every startup by the IKEEXT service via DLL\nhijacking. We further saw DLLs with the names ualapi.dll and ncobjapi.dll being sideloaded\ninto spoolsv.exe and svchost.exe, respectively.\n\nThe wlbsctrl.dll library is responsible for decrypting and executing the shellcode stored in the\nC:\\Windows\\System32\\config\\TxR directory. The decryption is notably performed through the\nCryptUnprotectData API function that uses a different encryption key internally on every\nmachine. This makes it difficult for researchers to decrypt the payload from the file without\nphysical access to the victim machines.\n\n\n-----\n\n**_Snippet of the loading function using CryptUnprotectData_**\n\nThe component loaded by the library is Gopuram’s main module. As mentioned above, its\nname in the export directory is guard64.dll. The job of the main module is to connect to a C2\nserver and request commands. The backdoor implements commands that allow the\nattackers to interact with the victim’s file system and create processes on the infected\nmachine. Gopuram was additionally observed to launch in-memory modules. Just like the\nimplants used in the 3CX campaign, Gopuram’s modules are DLL files that include an export\nfunction named DllGetClassObject. We have observed nine modules so far:\n\n\n**Module**\n**name**\n\n\n**Description**\n\n\nPing Pings a host specified in the argument.\n\nConnect Connects to a given host via a socket and waits for the server to send data.\n\nRegistry Manipulates registry (lists, adds, deletes and exports keys).\n\nService Manipulates (creates, lists, starts, stops and deletes) services.\n\nTimestomp Performs [timestomping on files.](https://attack.mitre.org/techniques/T1070/006/)\n\nInject Performs payload injections through syscalls via mapping a shellcode to a\nremote process and creating a remote thread.\n\n\n-----\n\nKDU [Kernel Driver Utility that allows an attacker to bypass driver signature](https://github.com/hfiref0x/KDU)\nenforcement. The utility is used to load an unsigned driver (MD5:\nF684E10FF1FFCDD32C62E73A11382896). The driver collects information\nabout installed AV filters and writes it to the\nC:\\Windows\\System32\\catroot2\\edb.chk.log file.\n\nUpdate Encrypts a provided payload and writes it to the\nC:\\Windows\\System32\\config\\TxR\\<machine hardware profile\nGUID>.TxR.0.regtrans-ms file.\n\nNet Partially implements features of the net command: management of users,\ngroups, sessions and network shares.\n\nThe discovery of the new Gopuram infections allowed us to attribute the 3CX campaign to\nthe Lazarus threat actor with medium to high confidence. Our attribution is based on the\nfollowing facts:\n\nWhile investigating an attack on a Southeast Asian cryptocurrency company in 2020,\nwe found Gopuram coexisting on the same machine with the AppleJeus backdoor,\nwhich is attributed to Lazarus.\n\nThe Gopuram backdoor has been observed in attacks on cryptocurrency companies,\nwhich is aligned with the interests of the Lazarus threat actor.\n\n\n-----\n\nWhile looking for additional implants that used the same loader shellcode as the 3CX\nimplants, we discovered a sample on a multiscanner service (MD5:\n[933508a9832da1150fcfdbc1ca9bc84c) loading a payload that uses the wirexpro[.]com](https://opentip.kaspersky.com/933508a9832da1150fcfdbc1ca9bc84c/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\nC2 server. The same server is [listed as an IoC for an AppleJeus campaign by](https://www.malwarebytes.com/blog/news/2022/12/lazarus-group-uses-fake-cryptocurrency-apps-to-plant-applejeus-malware)\nMalwarebytes.\n\n**_First bytes of the loader shellcode used in 3CX and AppleJeus_**\n\nNote, though, that the shellcode is based on open-source code that has been used by\nother threat actors, for example, SilentBreak. Still, the use of that shellcode along with\nthe 0xF558F4DA constant (which is the ROR13 hash for the string DllGetClassObject)\nis a more unique pattern.\n\n[While investigating a malicious MSI file (MD5: ec3f99dd7d9dbce8d704d407b086e84f)](https://opentip.kaspersky.com/ec3f99dd7d9dbce8d704d407b086e84f/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\nthat has been uploaded to a multiscanner service, we observed the following two\nevents:\n\nThe dll library dropped from the MSI was observed to launch an in-memory\npayload that contacts the oilycargo[.]com domain. This domain name has\npreviously been attributed to Lazarus by multiple researchers.\n\nIn our telemetry, we observed AvBugReport.exe, the executable hosting dll, to\ncontain Gopuram’s main module payload, guard64.dll.\n\n\n-----\n\nThese four facts allow us to conclude that Lazarus is likely the threat actor deploying the\nGopuram backdoor.\n\nAs for the victims in our telemetry, installations of the infected 3CX software are located all\nover the world, with the highest infection figures observed in Brazil, Germany, Italy and\nFrance.\n\nAs the Gopuram backdoor has been deployed to less than ten infected machines, it indicates\nthat attackers used Gopuram with surgical precision. We additionally observed that the\nattackers have a specific interest in cryptocurrency companies.\n\nAs it turns out, the infostealer is not the only malicious payload deployed during the 3CX\nsupply chain attack. The threat actor behind Gopuram additionally infects target machines\nwith the full-fledged modular Gopuram backdoor. We believe that Gopuram is the main\nimplant and the final payload in the attack chain. Our investigation of the 3CX campaign is\nstill far from complete. We will continue analyzing the deployed implants to find out more\ndetails about the toolset used in the supply chain attack.\n\n## Gopuram indicators of compromise\n\n**MD5 hashes**\n\n9f85a07d4b4abff82ca18d990f062a84\n\n96d3bbf4d2cf6bc452b53c67b3f2516a\n\n**File paths**\n\nC:\\Windows\\System32\\config\\TxR\\<machine hardware profile GUID>.TxR.0.regtrans-ms\n\nC:\\Windows\\system32\\catroot2\\edb.chk.log\n\nMore indicators of compromise and YARA rules for detecting Gopuram components are\n[available for TIP subscribers. Contact intelreports@kaspersky.com for more details.](mailto:intelreports@kaspersky.com)\n\n[APT](https://securelist.com/tag/apt/)\n[Backdoor](https://securelist.com/tag/backdoor/)\n[Data theft](https://securelist.com/tag/data-theft/)\n[Lazarus](https://securelist.com/tag/lazarus/)\n[Malware Descriptions](https://securelist.com/tag/malware-descriptions/)\n[Supply-chain attack](https://securelist.com/tag/supply-chain-attack/)\n[Targeted attacks](https://securelist.com/tag/targeted-attacks/)\n\nAuthors\n\n[Georgy Kucherin](https://securelist.com/author/georgykucherin/)\n\n\n-----\n\n[Vasily Berdnikov](https://securelist.com/author/vasilyberdnikov/)\n\nVilen Kamalov\n\nNot just an infostealer: Gopuram backdoor deployed through 3CX supply chain attack\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-04-03 - Not just an infostealer- Gopuram backdoor deployed through 3CX supply chain attack.pdf"
    ],
    "report_names": [
        "2023-04-03 - Not just an infostealer- Gopuram backdoor deployed through 3CX supply chain attack.pdf"
    ],
    "threat_actors": [
        {
            "id": "32a223a8-3c79-4146-87c5-8557d38662ae",
            "created_at": "2022-10-25T15:50:23.703698Z",
            "updated_at": "2025-03-27T02:00:55.528031Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Lazarus Group",
                "Labyrinth Chollima",
                "HIDDEN COBRA",
                "Guardians of Peace",
                "NICKEL ACADEMY",
                "Diamond Sleet"
            ],
            "source_name": "MITRE:Lazarus Group",
            "tools": [
                "RawDisk",
                "Proxysvc",
                "BADCALL",
                "FALLCHILL",
                "WannaCry",
                "HOPLIGHT",
                "TYPEFRAME",
                "Dtrack",
                "HotCroissant",
                "HARDRAIN",
                "Dacls",
                "KEYMARBLE",
                "TAINTEDSCRIBE",
                "AuditCred",
                "netsh",
                "ECCENTRICBANDWAGON",
                "AppleJeus",
                "BLINDINGCAN",
                "ThreatNeedle",
                "Volgmer",
                "Cryptoistic",
                "RATANKBA",
                "Bankshot",
                "Torisma",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f32df445-9fb4-4234-99e0-3561f6498e4e",
            "created_at": "2022-10-25T16:07:23.756373Z",
            "updated_at": "2025-03-27T02:02:09.966155Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "APT-C-26",
                "ATK 3",
                "Appleworm",
                "Citrine Sleet",
                "DEV-0139",
                "Diamond Sleet",
                "Gleaming Pisces",
                "Gods Apostles",
                "Gods Disciples",
                "Group 77",
                "Guardians of Peace",
                "Hastati Group",
                "Hidden Cobra",
                "ITG03",
                "Jade Sleet",
                "Labyrinth Chollima",
                "Lazarus Group",
                "NewRomanic Cyber Army Team",
                "Operation 99",
                "Operation AppleJeus",
                "Operation AppleJeus sequel",
                "Operation Blockbuster: Breach of Sony Pictures Entertainment",
                "Operation CryptoCore",
                "Operation Dream Job",
                "Operation Dream Magic",
                "Operation Flame",
                "Operation GhostSecret",
                "Operation In(ter)caption",
                "Operation LolZarus",
                "Operation Marstech Mayhem",
                "Operation No Pineapple!",
                "Operation North Star",
                "Operation Phantom Circuit",
                "Operation Sharpshooter",
                "Operation Ten Days of Rain / DarkSeoul",
                "Operation Troy",
                "SectorA01",
                "Slow Pisces",
                "TA404",
                "TraderTraitor",
                "UNC2970",
                "UNC4034",
                "UNC4736",
                "UNC4899",
                "UNC577",
                "Whois Hacking Team"
            ],
            "source_name": "ETDA:Lazarus Group",
            "tools": [
                "3CX Backdoor",
                "3Rat Client",
                "3proxy",
                "AIRDRY",
                "ARTFULPIE",
                "ATMDtrack",
                "AlphaNC",
                "Alreay",
                "Andaratm",
                "AngryRebel",
                "AppleJeus",
                "Aryan",
                "AuditCred",
                "BADCALL",
                "BISTROMATH",
                "BLINDINGCAN",
                "BTC Changer",
                "BUFFETLINE",
                "BanSwift",
                "Bankshot",
                "Bitrep",
                "Bitsran",
                "BlindToad",
                "Bookcode",
                "BootWreck",
                "BottomLoader",
                "Brambul",
                "BravoNC",
                "Breut",
                "COLDCAT",
                "COPPERHEDGE",
                "CROWDEDFLOUNDER",
                "Castov",
                "CheeseTray",
                "CleanToad",
                "ClientTraficForwarder",
                "CollectionRAT",
                "Concealment Troy",
                "Contopee",
                "CookieTime",
                "Cyruslish",
                "DAVESHELL",
                "DBLL Dropper",
                "DLRAT",
                "DRATzarus",
                "DRATzarus RAT",
                "Dacls",
                "Dacls RAT",
                "DarkComet",
                "DarkKomet",
                "DeltaCharlie",
                "DeltaNC",
                "Dembr",
                "Destover",
                "DoublePulsar",
                "Dozer",
                "Dtrack",
                "Duuzer",
                "DyePack",
                "ECCENTRICBANDWAGON",
                "ELECTRICFISH",
                "Escad",
                "EternalBlue",
                "FALLCHILL",
                "FYNLOS",
                "FallChill RAT",
                "Farfli",
                "Fimlis",
                "FoggyBrass",
                "FudModule",
                "Fynloski",
                "Gh0st RAT",
                "Ghost RAT",
                "Gopuram",
                "HARDRAIN",
                "HIDDEN COBRA RAT/Worm",
                "HLOADER",
                "HOOKSHOT",
                "HOPLIGHT",
                "HOTCROISSANT",
                "HOTWAX",
                "HTTP Troy",
                "Hawup",
                "Hawup RAT",
                "Hermes",
                "HotCroissant",
                "HotelAlfa",
                "Hotwax",
                "HtDnDownLoader",
                "Http Dr0pper",
                "ICONICSTEALER",
                "Joanap",
                "Jokra",
                "KANDYKORN",
                "KEYMARBLE",
                "Kaos",
                "KillDisk",
                "KillMBR",
                "Koredos",
                "Krademok",
                "LIGHTSHIFT",
                "LIGHTSHOW",
                "LOLBAS",
                "LOLBins",
                "Lazarus",
                "LightlessCan",
                "Living off the Land",
                "MATA",
                "MBRkiller",
                "MagicRAT",
                "Manuscrypt",
                "Mimail",
                "Mimikatz",
                "Moudour",
                "Mydoom",
                "Mydoor",
                "Mytob",
                "NACHOCHEESE",
                "NachoCheese",
                "NestEgg",
                "NickelLoader",
                "NineRAT",
                "Novarg",
                "NukeSped",
                "OpBlockBuster",
                "PCRat",
                "PEBBLEDASH",
                "PLANKWALK",
                "POOLRAT",
                "PSLogger",
                "PhanDoor",
                "Plink",
                "PondRAT",
                "PowerBrace",
                "PowerRatankba",
                "PowerShell RAT",
                "PowerSpritz",
                "PowerTask",
                "Preft",
                "ProcDump",
                "Proxysvc",
                "PuTTY Link",
                "QUICKRIDE",
                "QUICKRIDE.POWER",
                "Quickcafe",
                "QuiteRAT",
                "R-C1",
                "ROptimizer",
                "Ratabanka",
                "RatabankaPOS",
                "Ratankba",
                "RatankbaPOS",
                "RawDisk",
                "RedShawl",
                "Rifdoor",
                "Rising Sun",
                "Romeo-CoreOne",
                "RomeoAlfa",
                "RomeoBravo",
                "RomeoCharlie",
                "RomeoCore",
                "RomeoDelta",
                "RomeoEcho",
                "RomeoFoxtrot",
                "RomeoGolf",
                "RomeoHotel",
                "RomeoMike",
                "RomeoNovember",
                "RomeoWhiskey",
                "Romeos",
                "RustBucket",
                "SHADYCAT",
                "SHARPKNOT",
                "SIGFLIP",
                "SIMPLESEA",
                "SLICKSHOES",
                "SORRYBRUTE",
                "SUDDENICON",
                "SUGARLOADER",
                "SheepRAT",
                "SierraAlfa",
                "SierraBravo",
                "SierraCharlie",
                "SierraJuliett-MikeOne",
                "SierraJuliett-MikeTwo",
                "SimpleTea",
                "SimplexTea",
                "SmallTiger",
                "Stunnel",
                "TAINTEDSCRIBE",
                "TAXHAUL",
                "TFlower",
                "TOUCHKEY",
                "TOUCHMOVE",
                "TOUCHSHIFT",
                "TOUCHSHOT",
                "TWOPENCE",
                "TYPEFRAME",
                "Tdrop",
                "Tdrop2",
                "ThreatNeedle",
                "Tiger RAT",
                "TigerRAT",
                "Trojan Manuscript",
                "Troy",
                "TroyRAT",
                "VEILEDSIGNAL",
                "VHD",
                "VHD Ransomware",
                "VIVACIOUSGIFT",
                "VSingle",
                "ValeforBeta",
                "Volgmer",
                "Vyveva",
                "W1_RAT",
                "Wana Decrypt0r",
                "WanaCry",
                "WanaCrypt",
                "WanaCrypt0r",
                "WannaCry",
                "WannaCrypt",
                "WannaCryptor",
                "WbBot",
                "Wcry",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "WinorDLL64",
                "Winsec",
                "WolfRAT",
                "Wormhole",
                "YamaBot",
                "Yort",
                "ZetaNile",
                "concealment_troy",
                "http_troy",
                "httpdr0pper",
                "httpdropper",
                "klovbot",
                "sRDI"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1683338922,
    "ts_updated_at": 1743041843,
    "ts_creation_date": 1683251442,
    "ts_modification_date": 1683251442,
    "files": {
        "pdf": "https://archive.orkl.eu/96b5aa71d8f21dffce6f978bdc6a20f602a1e2e9.pdf",
        "text": "https://archive.orkl.eu/96b5aa71d8f21dffce6f978bdc6a20f602a1e2e9.txt",
        "img": "https://archive.orkl.eu/96b5aa71d8f21dffce6f978bdc6a20f602a1e2e9.jpg"
    }
}