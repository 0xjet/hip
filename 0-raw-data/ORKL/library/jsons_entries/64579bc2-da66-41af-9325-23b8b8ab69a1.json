{
    "id": "64579bc2-da66-41af-9325-23b8b8ab69a1",
    "created_at": "2022-10-25T16:48:12.781111Z",
    "updated_at": "2025-03-27T02:15:18.832383Z",
    "deleted_at": null,
    "sha1_hash": "3e337d629d17d73fd95d44b7e09777c4e59a5e4d",
    "title": "APT Group UPS Targets US Government with Hacking Team Flash Exploit - Palo Alto Networks BlogPalo Alto Networks Blog",
    "authors": "",
    "file_creation_date": "2015-10-31T12:03:02Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 258600,
    "plain_text": "## 5\n\n\n**exposed from this month’s Hacking Team data breach.**\n\n**The spear-phishing attack used a link to a Flash exploit hosted on two subdomains of a**\n\n**legitimate website, perrydale[.]com; rpt.perrydale[.]com and report.perrydale[.]com. Both**\n\n**domains resolve to the same Ukraine-based IP 194.44.130.179.**\n\n**There are no indications at this time that the actual website has been compromised, rather, this**\n\n**is more likely a case of DNS hijacking. The Flash exploits, specifically located at**\n\n**rpt.perrydale[.]com/en/show.swf and report.perrydale[.]com/ema/show.swf leverage one of the**\n\n**newly disclosed vulnerabilities from the Hacking Team data breach, CVE-2015-5119. Successful**\n\n**exploitation leads to the affected host retrieving a secondary payload, b.gif, also located at the**\n\n**same two subdomains as the Flash exploit.**\n\n**[This attack shares similarities with a previous targeted attack, also using a Flash exploit,](https://www.fireeye.com/blog/threat-research/2015/06/operation-clandestine-wolf-adobe-flash-zero-day.html)**\n\n**leveraging what was at the time a zero-day vulnerability in CVE-2015-3113. Analysis of both**\n\n**malicious Flash files indicates both these attacks are attributed to the APT group known as UPS**\n\n**or APT3.**\n\n**The malicious Flash file named “show.gif” contains ActionScript that attempts to exploit a**\n\n**vulnerability and execute shellcode to ultimately install a payload. Show.swf is composed of the**\n\n**following ActionScript classes:**\n\n**MainClass.as**\n\n**MyClass.as**\n\n**MyClass1.as**\n\n**MyClass2.as**\n\n**MyUtils.as**\n\n**ShellWin32.as**\n\n**Preliminary analysis of class names revealed overlap with one of the two Flash zero-day**\n\n**[exploits disclosed following the Hacking Team breach. When comparing the classes above with](http://blog.trendmicro.com/trendlabs-security-intelligence/unpatched-flash-player-flaws-more-pocs-found-in-hacking-team-leak/)**\n\n**those associated with Hacking Team’s Flash zero-days, we found that MyClass.as,**\n\n**MyClass1.as, MyClass2.as, MyUtils.as and ShellWin32.as were shared within show.swf and**\n\n**Hacking Team’s Flash exploit. In addition, there are several log messages as well as multiple**\n\n**function and variable names that exist in the ActionScript classes in both the UPS and the**\n\n**Hacking Team’s Flash files. The most important overlap occurs in the “TryExpl” function within**\n\n**MyClass.as, where the same functions and variables are used to create the use-after-free**\n\n**condition caused during the exploitation of the CVE-2015-5119 vulnerability. Figure 1 shows the**\n\n**code in the “TryExpl” function that causes the use-after-free vulnerability found in both the UPS**\n\n**and the Hacking Team’s Flash exploits. Also, the error message “can’t cause UaF” is found in**\n\n**both exploits.**\n\n**Figure 1. ActionScript Causing the Use-After-Free Vulnerability**\n\n**While analyzing the MainClass portion of show.swf, we also observed shared functions with a**\n\n**previous attack attributed to UPS that was designed to exploit an earlier Flash zero-day, CVE-**\n\n**2015-3113. The CVE-2015-3113 ActionScript is publically available and can be obtained from**\n\n|Col1|POSTED BY: Bryan Lee and Robert Falcone on July 10, 2015 11:36 AM|\n|---|---|\n|78||\n|LLiikkee|FILED IN: Malware, Threat Prevention, Unit 42 TAGGED: ActionScript, Adobe Flash, AutoFocus, Hacking Team On July 8, 2015, Unit 42 used the AutoFocus Threat Intelligence service to locate and investigate activity consistent with a spear-phishing attack targeting the US Government. The attack exploited an Adobe Flash vulnerability that stems from the zero-day vulnerabilities|\n|Tweet||\n|5||\n\n\n## Cyber Threat Alliance Reflects on� the Current State of Cybersecurity at the Churchill Club\n\n**[posted by Chad Berndtson on October 30, 2015](http://researchcenter.paloaltonetworks.com/author/cberndston/)**\n\n## Channel Scoop – October 30, 2015\n\n**[posted by Lang Tibbils on October 30, 2015](http://researchcenter.paloaltonetworks.com/author/lang-tibbils/)**\n\n## People of Palo Alto Networks: Get in on the Ground Floor\n\n**[posted by Justin Hall on October 29, 2015](http://researchcenter.paloaltonetworks.com/author/justin-hall/)**\n\n## CryptoWall 3, the Cyber Threat Alliance and the Future of Information Sharing\n\n**[posted by Rick Howard on October 29, 2015](http://researchcenter.paloaltonetworks.com/author/rick/)**\n\n## Understanding and Preventing Point of Sale Attacks\n\n**[posted by Josh Grunzweig on October 28, 2015](http://researchcenter.paloaltonetworks.com/author/josh-grunzweig/)**\n\n**[MORE →](http://researchcenter.paloaltonetworks.com/archives/)**\n\n\n**Select a Category**\n\n**Select a Month**\n\n**[MORE →](http://researchcenter.paloaltonetworks.com/archives/)**\n\n\n### 78\n\n\n-----\n\n**The shared function names, seen below, include several functions used for data type**\n\n**manipulation, logging, and decrypting the shellcode executed in the event of successful**\n\n**exploitation:**\n\n**decode**\n\n**hexToIntArray**\n\n**logMsg**\n\n**func_prepare**\n\n**hexToBin**\n\n**The most obvious overlap between the two ActionScripts involves the shared variable name**\n\n**“m_scKey”, which is a variable that stores the RC4 key that the ActionScript will use to decrypt**\n\n**the shellcode.**\n\n**When the Flash vulnerability is successfully exploited, shellcode executes which then extracts**\n\n**and decrypts a payload embedded in an animated GIF image. During analysis, Unit 42 was**\n\n**unable to obtain the payload; the “b.gif” file received was not weaponized as it does not contain**\n\n**an encrypted payload. There are two likely reasons for this – UPS is known for both only serving**\n\n**malicious payloads within very limited windows of time during an attack, and even then only**\n\n**serving those payloads to victims that fit their desired profile.**\n\n**The technique of extracting and decrypting a payload from within an animated GIF image was**\n\n**also used by UPS in the attacks exploiting CVE-2015-3113. Using Zynamic’s binDiff tool to**\n\n**compare, we discovered 99% similarity with 99% confidence between the 5119 shellcode and**\n\n**the 3113 shellcode. By manually comparing the code, we confirmed the high similarity and**\n\n**confidence rates as calculated by binDiff.**\n\n**The technique of locating the payload embedded in the animated GIF is the same within both**\n\n**the 5119 and the 3113 shellcodes. Additionally, both shellcodes use the exact same algorithm**\n\n**and key values to decrypt the payload from ciphertext to cleartext, specifically using an XOR,**\n\n**subtraction and a second XOR instruction using key values 0x12, 0x11 and 0x85, respectively.**\n\n**In fact, we compared the two shellcodes side-by-side and found that there is only one instruction**\n\n**added to the 5119 shellcode as seen highlighted in red in the image below.**\n\n**These attacks highlight how sophisticated APT groups such as UPS can quickly leverage new**\n\n**[vulnerabilities in their attacks. A patch is available for this vulnerability, but was only released on](https://helpx.adobe.com/security/products/flash-player/apsb15-14.html)**\n\n**the same day of weaponization, which leaves very little time for any organization to patch**\n\n**effectively. Due to the highly targeted nature of this type of attack, traditional detection methods**\n\n**via known IOCs can be challenging. Deployment of automated, behavioral preventative**\n\n**[measures such as Palo Alto Networks Traps can significantly reduce organizational risk to these](http://researchcenter.paloaltonetworks.com/2015/07/palo-alto-networks-traps-protects-from-latest-flash-zero-day-vulnerability-cve-2015-5119/  )**\n\n**types of attacks.**\n\n**SHA256**\n\n**a2fe113cc13acac2bb79a375f692b8ba5cc2fa880272adc7ab0d01f839e877ff**\n\n**Domains**\n\n**rpt.perrydale[.]com**\n\n**report.perrydale[.]com**\n\n**IPs**\n\n**194.44.130.179**\n\n\n-----\n\n**report.perrydale[.]com /ema/show.swf**\n\n**rpt.perrydale[.]com /en/b.gif**\n\n**report.perrydale[.]com /ema/b,gif**\n\n**July 15, 2015 4:40 PM**\n## ste williams – 4 Lasting Impacts Of The Hacking Team Leaks\n\n**July 15, 2015 8:43 PM**\n## 4 Lasting Impacts Of The Hacking Team Leaks | TechDiem.com\n\n**July 21, 2015 6:24 PM**\n## All Recent Unit 42 Threat Intelligence – Right at the Top of Your Inbox | Philip Hung Cao\n\n**July 28, 2015 3:53 AM**\n## UPS: Observations on CVE-2015-3113, Prior Zero-Days and the Pirpi Payload | Philip Hung Cao\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2015/2015.07.10.APT_Group_UPS_Targets_US_Government/apt.group.ups.pdf"
    ],
    "report_names": [
        "apt.group.ups"
    ],
    "threat_actors": [
        {
            "id": "a3687241-9876-477b-aa13-a7c368ffda58",
            "created_at": "2022-10-25T16:07:24.496902Z",
            "updated_at": "2025-03-27T02:02:10.256629Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "ETDA:Hacking Team",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "61c4ddc4-156b-4828-8570-0979da81f3d0",
            "created_at": "2022-10-25T16:47:55.593828Z",
            "updated_at": "2025-03-27T02:05:17.275161Z",
            "deleted_at": null,
            "main_name": "BRONZE MAYFAIR",
            "aliases": [
                "Gothic Panda ",
                "TG-0110 ",
                "APT3 "
            ],
            "source_name": "Secureworks:BRONZE MAYFAIR",
            "tools": [
                " HUC Proxy Malware (Htran)",
                " Pirpi",
                " SplitVPN",
                " ctt",
                " ctx",
                "Cookiecutter"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e90c06e4-e3e0-4f46-a3b5-17b84b31da62",
            "created_at": "2023-01-06T13:46:39.018236Z",
            "updated_at": "2025-03-27T02:00:02.978356Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "MISPGALAXY:Hacking Team",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "761d1fb2-60e3-46f0-9f1c-c8a9715967d4",
            "created_at": "2023-01-06T13:46:38.269054Z",
            "updated_at": "2025-03-27T02:00:02.789278Z",
            "deleted_at": null,
            "main_name": "APT3",
            "aliases": [
                "TG-0110",
                "Group 6",
                "Buckeye",
                "Boyusec",
                "BORON",
                "BRONZE MAYFAIR",
                "Red Sylvan",
                "GOTHIC PANDA"
            ],
            "source_name": "MISPGALAXY:APT3",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "13354d3f-3f40-44ec-b42a-3cda18809005",
            "created_at": "2022-10-25T15:50:23.275272Z",
            "updated_at": "2025-03-27T02:00:55.418075Z",
            "deleted_at": null,
            "main_name": "APT3",
            "aliases": [
                "APT3",
                "Gothic Panda",
                "Pirpi",
                "UPS Team",
                "Buckeye",
                "Threat Group-0110",
                "TG-0110"
            ],
            "source_name": "MITRE:APT3",
            "tools": [
                "OSInfo",
                "schtasks",
                "PlugX",
                "LaZagne",
                "SHOTPUT",
                "RemoteCMD"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "06f622cb-3a78-49cf-9a4c-a6007a69325f",
            "created_at": "2022-10-25T16:07:23.315239Z",
            "updated_at": "2025-03-27T02:02:09.733197Z",
            "deleted_at": null,
            "main_name": "APT 3",
            "aliases": [
                "APT 3",
                "Bronze Mayfair",
                "Buckeye",
                "Gothic Panda",
                "Group 6",
                "Operation Clandestine Fox",
                "Operation Clandestine Fox, Part Deux",
                "Operation Clandestine Wolf",
                "Operation Double Tap",
                "Red Sylvan",
                "TG-0110",
                "UPS Team"
            ],
            "source_name": "ETDA:APT 3",
            "tools": [
                "APT3 Keylogger",
                "Agent.dhwf",
                "BKDR_HUPIGON",
                "Backdoor.APT.CookieCutter",
                "Badey",
                "Bemstour",
                "CookieCutter",
                "Destroy RAT",
                "DestroyRAT",
                "DoublePulsar",
                "EXL",
                "EternalBlue",
                "HTran",
                "HUC Packet Transmit Tool",
                "Hupigon",
                "Hupigon RAT",
                "Kaba",
                "Korplug",
                "LaZagne",
                "MFC Huner",
                "OSInfo",
                "Pirpi",
                "PlugX",
                "RedDelta",
                "RemoteCMD",
                "SHOTPUT",
                "Sogu",
                "TIGERPLUG",
                "TTCalc",
                "TVT",
                "Thoper",
                "Xamtrav",
                "remotecmd",
                "shareip",
                "w32times"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716492,
    "ts_updated_at": 1743041718,
    "ts_creation_date": 1446292982,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/3e337d629d17d73fd95d44b7e09777c4e59a5e4d.pdf",
        "text": "https://archive.orkl.eu/3e337d629d17d73fd95d44b7e09777c4e59a5e4d.txt",
        "img": "https://archive.orkl.eu/3e337d629d17d73fd95d44b7e09777c4e59a5e4d.jpg"
    }
}