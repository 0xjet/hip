{
    "id": "8596e663-11a5-42a8-8c6e-f7246c598c2d",
    "created_at": "2022-10-25T16:48:11.160406Z",
    "updated_at": "2025-03-27T02:09:15.379132Z",
    "deleted_at": null,
    "sha1_hash": "c7a8c2597269ab369b4f0527056f9bb13c65a2a6",
    "title": "",
    "authors": "",
    "file_creation_date": "2019-08-06T05:15:48Z",
    "file_modification_date": "2019-08-06T05:15:48Z",
    "file_size": 670146,
    "plain_text": "# Sharpening the Machete\n\n**[welivesecurity.com/2019/08/05/sharpening-machete-cyberespionage](https://www.welivesecurity.com/2019/08/05/sharpening-machete-cyberespionage/)**\n\nAugust 5, 2019\n\nLatin America is often overlooked when it comes to persistent threats and groups with politically\nmotivated targets. There is, however, an ongoing case of cyberespionage against high-profile\norganizations that has managed to stay under the radar. The group behind these attacks has\nstolen gigabytes of confidential documents, mostly from military organizations. It is still very active\nat the time of this publication, regularly introducing changes to its malware, infrastructure and\nspearphishing campaigns.\n\nESET has been tracking a new version of Machete (the group’s Python-based toolset) that was\nfirst seen in April 2018. While the main functionality of the backdoor remains the same as in\nprevious versions, it has been extended with new features over the course of a year.\n\n# Targets\n\nFrom the end of March up until the end of May 2019, ESET researchers observed that there were\nmore than 50 victimized computers actively communicating with the C&C server. This amounts to\ngigabytes of data being uploaded every week. More than half of the compromised computers\nwere in the Venezuelan military forces, whereas the others were related to education, police, and\nforeign affairs sectors. This extends to other countries in Latin America, with the Ecuadorean\nmilitary being another organization highly targeted with the Machete malware. The distribution of\nthis malware in these countries is shown in Figure 1.\n\n\n-----\n\n_Figure 1. Countries with Machete victims in 2019_\n\n\n# Malware operators\n\nMachete’s operators use effective spearphishing techniques. Their long run of attacks, focused on\nLatin American countries, has allowed them to collect intelligence and refine their tactics over the\nyears. They know their targets, how to blend into regular communications, and which documents\nare of the most value to steal. Not only does Machete exfiltrate common office suite documents,\nbut also specialized file types used by geographic information systems (GIS) software. The group\nis interested in files that describe navigation routes and positioning using military grids.\n\nThe Machete group sends very specific emails directly to its victims, and these change from\ntarget to target. These emails contain either a link to, or an attachment of, a compressed selfextracting archive that runs the malware and opens a document that serves as a decoy.\n\nFigure 2 is a typical PDF file displayed to a potential victim during compromise. To trick\nunsuspecting targets, Machete operators use real documents they have previously stolen; Figure\n2 is a classified military document that is dated May 21, 2019, the same day the related .zip filest\nwas first sent to targets. ESET has seen more cases like this where stolen documents dated on\none particular day were bundled with malware and used on the same day as lures to compromise\nnew victims.\n\n\n-----\n\n_Figure 2. Decoy (PDF file) in one of the Machete downloaders (blurred)_\n\n\nThe kind of documents used as decoys are sent and received legitimately several times a day by\nthe group’s targets. For example, Radiogramas are documents used for communication in the\nVenezuelan military forces. Attackers take advantage of that, along with their knowledge of\nmilitary jargon and etiquette, to craft very convincing phishing emails.\n\n# Main characteristics\n\nThe Machete group is very active and has introduced several changes to its malware since a new\n[version was released in April 2018. Previous versions were described by Kaspersky in 2014 and](https://securelist.com/el-machete/66108/)\n[Cylance in 2017. In Figure 3 we show the components for the new version of the Machete](https://threatvector.cylance.com/en_us/home/el-machete-malware-attacks-cut-through-latam.html)\nmalware.\n\n\n_Figure 3. Components of Machete_\n\n\nThe first part of the attack consists of a downloader that comes as a self-extracting archive, made\n[with 7z SFX Builder. Once the archive is unpacked by the self-extraction code, the extractor](https://sourceforge.net/projects/s-zipsfxbuilder/)\nopens a PDF or Microsoft Office file that serves as a decoy, and then runs the downloader\nexecutable from the archive. That executable is another self-extracting file that contains the actual\n[downloader binary (a py2exe component) and a configuration file with the downloader’s target](http://www.py2exe.org/)\nURL as an encrypted string.\n\n\n-----\n\nThe py2exe binaries can be decompiled to obtain Python code. All of the components –\n[downloaders and backdoors – are obfuscated with pyobfuscate. This has been used in previous](https://github.com/astrand/pyobfuscate)\nversions of the malware as well. Figure 4 shows part of one of these obfuscated scripts.\n\n\n_Figure 4. Script obfuscated with pyobfuscate_\n\n\nSince August 2018, the Machete components have been delivered with an extra layer of\nobfuscation. The scripts now contain a block of zlib-compressed, base64-encoded text which,\nafter being decoded, produces a script like the one in Figure 4. This first layer of obfuscation is\n[produced using pyminifier with the -gzip parameter.](https://github.com/liftoff/pyminifier)\n\n# Backdoor components\n\nMachete’s dropper is a RAR SFX executable. Three py2exe components are dropped:\nGoogleCrash.exe, Chrome.exe and GoogleUpdate.exe. A single configuration file, jer.dll, is\ndropped, and it contains base64‑encoded text that corresponds to AES‑encrypted strings. A\nschema summarizing the components is shown in Figure 5.\n\n\n-----\n\n_Figure 5. Backdoor py2exe components of Machete_\n\n\nGoogleCrash.exe is the main component of the malware. It schedules execution of the other two\ncomponents and creates Windows Task Scheduler tasks to achieve persistence.\n\nThe Chrome.exe component is responsible for collection of data from the victimized computer. It\ncan:\n\nTake screenshots\nLog keystrokes\nAccess the clipboard\nAES-encrypt and exfiltrate documents\nDetect newly inserted drives and copy files\nExecute other binaries downloaded from the C&C server\nRetrieve specific files from the system\nRetrieve user profile data from several browsers\nCollect geolocation of victims and information about nearby Wi-Fi networks\nPerform physical exfiltration to removable drives\n\nThe Machete operators are interested in obtaining specific file types from their targets. Apart from\nMicrosoft Office documents, drives are searched for:\n\nBackup files\nDatabase files\nCryptographic keys (PGP)\nOpenOffice documents\nVector images\nFiles for geographic information systems (topographic maps, navigation routes, etc.)\n\nRegarding the geolocation of victims, Chrome.exe collects data about nearby Wi-Fi networks and\n[sends it to the Mozilla Location Service API. In short, this application provides geolocation](https://location.services.mozilla.com/)\ncoordinates when it’s given other sources of data such as Bluetooth beacons, cell towers or Wi-Fi\naccess points. Then the malware takes latitude and longitude coordinates to build a Google Maps\nURL Part of the code is shown in Figure 6\n\n\n-----\n\n_Figure 6. Code for geolocation_\n\n\nThe advantage of using Mozilla Location Service is that it permits geolocation without an actual\nGPS and can be more accurate than other methods. For example, an IP address can be used to\nobtain an approximate location, but it is not so accurate. On the other hand, if there is available\ndata for the area, Mozilla Location Service can provide information such as in which building the\ntarget is located.\n\nThe GoogleUpdate.exe component is responsible for communicating with the remote C&C server.\nThe configuration to set the connection is read from the jer.dll file: domain name, username and\npassword. The principal means of communication for Machete is via FTP, although HTTP\ncommunication was implemented as a fallback in 2019.\n\nThis component uploads encrypted files to different subdirectories on the C&C server, but it also\nretrieves specific files that have been put on the server by the Machete operators. This way, the\nmalware can have its configuration, malicious binaries and file listings updated, but can also\ndownload and execute other binaries.\n\n# In conclusion\n\nThe Machete group is operating more strongly than ever, even after researchers have published\ntechnical descriptions and indicators of compromise for this malware. ESET has been tracking\nthis threat for months and has observed several changes, sometimes within weeks.\n\nAt the time of this publication, the latest change introduced six backdoor components, which are\nno longer py2exe executables. Python scripts for malicious components, an original executable\nfor Python 2.7, and all libraries used are packed into a self-extracting file.\n\nVarious artifacts that we have seen in Machete’s code and the underlying infrastructure lead us to\nthink that this is a Spanish-speaking group. The presence of code to exfiltrate data to removable\ndrives when there is physical access to a compromised computer may indicate that Machete\noperators could have a presence in one of the targeted countries, although we cannot be certain.\n\nA full and comprehensive list of Indicators of Compromise (IoCs) can be found in the full white\n[paper and on GitHub. ESET detects this threat as a variant of Python/Machete.](https://github.com/eset/malware-ioc/tree/master/machete)\n\nFor a detailed analysis of the backdoor, refer to our white paper Machete just got sharper:\nVenezuelan military under attack.\n\n\n-----\n\n[ESET Research 5 Aug 2019 - 11:31AM](https://www.welivesecurity.com/author/esetresearch/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2019/2019.08.05.Sharpening_the_Machete/blog_Sharpening%20the%20Machete.pdf"
    ],
    "report_names": [
        "blog_Sharpening the Machete"
    ],
    "threat_actors": [
        {
            "id": "d303c77e-0110-471b-a3a6-37fce9ac848d",
            "created_at": "2022-10-25T15:50:23.342452Z",
            "updated_at": "2025-03-27T02:00:55.447692Z",
            "deleted_at": null,
            "main_name": "Machete",
            "aliases": [
                "APT-C-43",
                "El Machete"
            ],
            "source_name": "MITRE:Machete",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "edc11896-f4f1-4132-9c38-d073ccdcf5b6",
            "created_at": "2022-10-25T16:07:23.576476Z",
            "updated_at": "2025-03-27T02:02:09.873658Z",
            "deleted_at": null,
            "main_name": "El Machete",
            "aliases": [
                "APT-C-43",
                "ATK 97",
                "Operation HpReact",
                "TAG-NS1",
                "TEMP.Andromeda"
            ],
            "source_name": "ETDA:El Machete",
            "tools": [
                "El Machete",
                "ForeIT",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Loki",
                "Loki.Rat",
                "LokiBot",
                "LokiPWS",
                "Pyark"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "ba4f277c-c3da-45e6-a2fb-4ed556dbae64",
            "created_at": "2023-01-06T13:46:38.605117Z",
            "updated_at": "2025-03-27T02:00:02.871423Z",
            "deleted_at": null,
            "main_name": "El Machete",
            "aliases": [
                "APT-C-43",
                "G0095",
                "machete-apt"
            ],
            "source_name": "MISPGALAXY:El Machete",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716491,
    "ts_updated_at": 1743041355,
    "ts_creation_date": 1565068548,
    "ts_modification_date": 1565068548,
    "files": {
        "pdf": "https://archive.orkl.eu/c7a8c2597269ab369b4f0527056f9bb13c65a2a6.pdf",
        "text": "https://archive.orkl.eu/c7a8c2597269ab369b4f0527056f9bb13c65a2a6.txt",
        "img": "https://archive.orkl.eu/c7a8c2597269ab369b4f0527056f9bb13c65a2a6.jpg"
    }
}