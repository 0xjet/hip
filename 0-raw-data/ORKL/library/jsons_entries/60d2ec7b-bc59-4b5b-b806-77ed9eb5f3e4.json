{
    "id": "60d2ec7b-bc59-4b5b-b806-77ed9eb5f3e4",
    "created_at": "2023-01-12T15:08:26.380937Z",
    "updated_at": "2025-03-27T02:06:05.262839Z",
    "deleted_at": null,
    "sha1_hash": "5f45fbc12d1dfe0f87f135f7538fa6c3f6a3bdda",
    "title": "2012-06-05 - Smartcard vulnerabilities in modern banking malware",
    "authors": "",
    "file_creation_date": "2022-05-28T15:45:28Z",
    "file_modification_date": "2022-05-28T15:45:28Z",
    "file_size": 757045,
    "plain_text": "# Smartcard vulnerabilities in modern banking malware\n\n**[welivesecurity.com/2012/06/05/smartcard-vulnerabilities-in-modern-banking-malware/](https://www.welivesecurity.com/2012/06/05/smartcard-vulnerabilities-in-modern-banking-malware/)**\n\nJune 5, 2012\n\nAleksandr Matrosov and Eugene Rodionov presented their research into â€œSmartcard\nvulnerabilities in modern banking malwareâ€� at PHDays'2012.\n\n5 Jun 2012 - 12:49PM\n\nAleksandr Matrosov and Eugene Rodionov presented their research into â€œSmartcard\nvulnerabilities in modern banking malwareâ€� at PHDays’2012.\n\n[Last week an epic security event took place in Russia – the PHDays’2012 conference. This](http://phdays.com/)\nevent started last year as the first conference in Russia for security researchers focusing on\n[deeply technical speakers – all the videos translated into English are already online here.](http://digitaloctober.com/event/positive_hack_days)\nThis year, ESET Canada's Pierre-Marc Bureau presented a workshop on “Win32/Georbot.\nUnderstanding a malware and automating its analysis”, about reverse engineering the\nGeorbot trojan. And I and my colleague Eugene Rodionov presented the results of our\nresearch into “Smartcard vulnerabilities in modern banking malware”.\n\nOur presentation starts with a consideration of the evolution of the Carberp family of\n[banking malware (we already discussed this in our CARO presentation in May).](https://www.welivesecurity.com/2012/05/24/carberp-gang-evolution-at-caro-2012)\n\nOn the day before the conference I tracked blackhat SEO poisoning on the Russian Google\nsearch results page for requests relating to Eurovision 2012 in the Russian language.\n\nThe first Google search item returned is a redirect to a malicious webpage passing itself off\nas a legitimate site about Eurovision 2012. If a malicious JavaScript detected real user\n[activity, the next step would be a redirection to a Nuclear Pack exploitation service.](https://www.welivesecurity.com/2012/04/05/blackhole-exploit-kit-plays-with-smart-redirection)\n\n\n-----\n\nNuclear Pack uses some interesting techniques for generating unique file names with\nexploitation vectors to bypass crawlers – if you can’t step all the way through the malicious\nredirection you can’t track all the logic that governs name generation). All java exploits here\nused layered obfuscation, and used applet parameters to implement the deobfuscation\nflow.\n\nThe second part of our talk was about attack techniques against client-bank systems. The\nmost interesting part of presentation was about vectors for attacks on smartcards. In 2010\n[we already published a blogpost – “Dr. Zeus: the Bot in the Hat” – about the manipulation of](https://www.welivesecurity.com/2010/11/05/dr-zeus-the-bot-in-the-hat)\nAPDU commands and hidden remote channels for controlling a smartcard device. This bot\nis still in the wild and ESET detects this family as Win32/Spy.Ranbyus (MD5:\nF2744552D24F7EA31E64228EB3022830). We have found functionality for covert\nsmartcard manipulation in the code of the latest modifications too. The current C&C\n(Command & Control) has changed domain, to wh1tesun.info (80.79.117.171).\n\nIf Win32/Spy.Ranbyus finds an active smartcard or smartcard reader device on the infected\nmachine, the bot sends this information to the C&C with a description of the type of\nsmartcard it finds. All malicious smartcard manipulation works at the SmartCard API level.\n\n\n-----\n\nThe user authenticates to the smartcard device, and the bot sends a signal to the C&C.\nAfter that, the smartcard can be used remotely through the C&C by means of APDU\ncommand manipulation, allowing all typical smartcard workflow using the victim's\ncredentials.\n\nThe next interesting case involving smartcards was detected at the beginning of this year.\nHodprot, the latest Carberp cybercrime group, switched to using RDPdoor v4.2.x (MD5:\n0E9CCECABA272942F1A4297E42D3BA43). This modification collects information about\nan infected system and devices in use by means of SetupApi.\n\n\n-----\n\nIts activity is focused on smartcard devices used in Russian remote banking systems:\n\n\n-----\n\nIf a smartcard device is detected, the bot prepares a special description to send to the\nC&C:\n\n[VendorId]:[ProductId]:[Revision]:[InfoRetrievedFromDevice]:[DeviceNameOrDescription]\n\nExamples of the filled-in structure look like this:\n\n0A89:0060:0102:06512119781D0E:Rutoken Magistra;\n\n096E:0005:0290:065C62807A1C0E:USB Token Device;\n\n0A89:0060:0102:06336059708D9E:Rutoken Magistra;\n\n0CA6:00A0:0010:06024350706F87:USB Smart Card reader;\n\n23A0:0002:0100:20BEA090712EC1:BIFIT ICCD Smart Card Reader;\n\n2022:0008:1001::USB Smart Card reader;\n\n\n-----\n\nA420:542A:0100::VPN Key;\n\n0A89:0020:0200::Rutoken S;\n\nRDPdoor collects a great deal of information about the infected system to facilitate the\nfollowing analysis by the botmaster.\n\nAfter analysis, the botmaster can send additional commands back to the bot for installing\nadditional modules onto the infected system. If a smartcard device is detected, RDPdoor\ncan install FabulaTech USB for Remote Desktop to implement remote control of smartcards\non the infected machine.\n\nThe use of smart cards reduces the security risks of online transactions, but we see here\nsome attacks that bypass smartcard security at the operating system API level in order to\nsteal money.\n\n**Aleksandr Matrosov, Security Intelligence Team Lead**\n\n5 Jun 2012 - 12:49PM\n\n## Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n Newsletter\n\n Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2012/2012-06-05 - Smartcard vulnerabilities in modern banking malware.pdf"
    ],
    "report_names": [
        "2012-06-05 - Smartcard vulnerabilities in modern banking malware.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536106,
    "ts_updated_at": 1743041165,
    "ts_creation_date": 1653752728,
    "ts_modification_date": 1653752728,
    "files": {
        "pdf": "https://archive.orkl.eu/5f45fbc12d1dfe0f87f135f7538fa6c3f6a3bdda.pdf",
        "text": "https://archive.orkl.eu/5f45fbc12d1dfe0f87f135f7538fa6c3f6a3bdda.txt",
        "img": "https://archive.orkl.eu/5f45fbc12d1dfe0f87f135f7538fa6c3f6a3bdda.jpg"
    }
}