{
    "id": "8f930e98-a435-4eb3-8966-ef5422b37ada",
    "created_at": "2023-01-12T15:00:07.557131Z",
    "updated_at": "2025-03-27T02:16:28.814839Z",
    "deleted_at": null,
    "sha1_hash": "e65ee5e116b52059fda570b40073aecefa46059f",
    "title": "2021-08-05 - Detecting Cobalt Strike- Government-Sponsored Threat Groups (APT32)",
    "authors": "",
    "file_creation_date": "2022-05-28T18:17:07Z",
    "file_modification_date": "2022-05-28T18:17:07Z",
    "file_size": 207905,
    "plain_text": "# Detecting Cobalt Strike: Government-Sponsored Threat Groups\n\n**[secureworks.com/blog/detecting-cobalt-strike-government-sponsored-threat-groups](https://www.secureworks.com/blog/detecting-cobalt-strike-government-sponsored-threat-groups)**\n\nCounter Threat Unit Research Team\n\n_TIN WOODLAWN used a customized version of Cobalt Strike to evade configuration-based_\n_detections, but a combination of strategic and tactical countermeasures identifies the activity._\nThursday, August 5, 2021 By: Counter Threat Unit Research Team\n\n\n-----\n\nDuring a focused investigation into malicious use of the legitimate Cobalt Strike penetration\ntesting tool, Secureworks® Counter Threat Unit™ (CTU) researchers explored how\ngovernment-sponsored threat groups leverage it during intrusions. These groups use various\ntactics to operate with stealth.\n\n[Secureworks incident responders observed the TIN WOODLAWN cyberespionage group](https://www.secureworks.com/research/threat-profiles/tin-woodlawn)\nusing a modified version of Cobalt Strike to evade countermeasures that rely on the default\nconfiguration for detection. CTU™ research indicates that this group is likely operated or\ntasked by the Vietnamese government to steal intellectual property and trade secrets. The\nthreat actors have also targeted individuals deemed to be of interest to the Vietnamese\ngovernment, including journalists and political opponents.\n\nTIN WOODLAWN uses Cobalt Strike extensively during intrusions, often delivering it via\nspearphishing emails containing malicious document attachments. These documents include\nmacro code that registers a scheduled task. This scheduled task uses the Windows mshta\nutility to download a Cobalt Strike Beacon PowerShell stager that executes in memory. This\nmethod avoids writing a portable executable to disk, making in-memory detection the only\nway to identify this phase of the intrusion.\n\nCTU researchers observed TIN WOODLAWN deploying a custom stager that created a\nnamed pipe, using a command-line parameter as the pipe name. CTU researchers dubbed\nthis stager 'CommaChameleon' because it uses the '-comma' PowerShell command-line\nswitch. This switch is short for the '-command' switch string, which indicates that a\nPowerShell command follows. As of this publication, TIN WOODLAWN is the only threat\ngroup known to use the shortened command-line switch and a randomized uppercase and\nlowercase spelling (e.g., POWersHEll -cOmmA).\n\nThe stager waits for an RC4-encrypted executable payload to be written to the named pipe\nand then injects the payload into a legitimate Windows executable randomly selected from a\nhard-coded list in the stager code. In one campaign, Cobalt Strike injected the Windows\nesentutl.exe Extensible Storage Engine utility with an RC4-encrypted Mimikatz credential\nharvesting payload for credential theft.\n\nCobalt Strike can offer a threat actor anonymity because it is so widely used. Custom\nimplementations may indicate activity by a sophisticated threat actor trying to evade security\ncontrols. In this incident, TIN WOODLAWN's custom stager evaded detections for generic\nCobalt Strike stagers, downloaded and executed a secondary payload in-memory to\nminimize host artifacts, and injected an encrypted portable executable into a Windows utility\nprocess instead of leveraging the standard Cobalt Strike shellcode.\n\nTable 1 maps the observed TIN WOODLAWN's techniques to the [MITRE ATT&CK®](https://attack.mitre.org/)\nframework.\n\n**Observed activity** **MITRE ATT&CK mapping**\n\n\n-----\n\nPhishing campaigns [Phishing: Spearphishing Attachment](https://attack.mitre.org/techniques/T1598/002/)\n\nEstablishing persistence [Scheduled Task/Job: Scheduled Task](https://attack.mitre.org/techniques/T1053/)\n[Create or Modify System Process: Windows Service](https://attack.mitre.org/techniques/T1543/003/)\n\nDefense evasion [Signed Binary Proxy Execution: Mshta](https://attack.mitre.org/techniques/T1218/005/)\n[Process Injection: Portable Executable Injection](https://attack.mitre.org/techniques/T1055/002/)\n\nRemote code execution [Command and Scripting Interpreter: PowerShell](https://attack.mitre.org/techniques/T1059/001/)\n\nCredential harvesting [OS Credential Dumping: LSASS Memory](https://attack.mitre.org/techniques/T1003/)\n\n_Table 1. MITRE ATT&CK techniques used by TIN WOODLAWN._\n\nDirect observation of TIN WOODLAWN's techniques allowed CTU researchers to combine\nstrategic countermeasures that detect generic behaviors with tactical countermeasures that\nidentify customized activity. The resulting detections indicated this was targeted activity by a\ntargeted government-sponsored threat actor rather than the work of an opportunistic\n[cybercriminal. By integrating these countermeasures into the Secureworks Taegis™ XDR](https://www.secureworks.com/products/taegis/xdr)\nplatform, CTU researchers and network defenders can identify attempts by government[sponsored threat actors to weaponize Cobalt Strike in targeted environments. Preview](https://www.secureworks.com/resources/tl-mitre-adversary-software-coverage-tool)\nTaegis XDR to explore more coverage for MITRE ATT&CK techniques.\n\nThis blog is part of a series. Watch for an upcoming post on the use of Cobalt Strike by\npenetration testers.\n\nOther posts in this series:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-08-05 - Detecting Cobalt Strike- Government-Sponsored Threat Groups (APT32).pdf"
    ],
    "report_names": [
        "2021-08-05 - Detecting Cobalt Strike- Government-Sponsored Threat Groups (APT32).pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "870f6f62-84f5-48ca-a18e-cf2902cd6924",
            "created_at": "2022-10-25T15:50:23.303818Z",
            "updated_at": "2025-03-27T02:00:55.435309Z",
            "deleted_at": null,
            "main_name": "APT32",
            "aliases": [
                "APT32",
                "SeaLotus",
                "OceanLotus",
                "APT-C-00",
                "Canvas Cyclone"
            ],
            "source_name": "MITRE:APT32",
            "tools": [
                "Mimikatz",
                "ipconfig",
                "Kerrdown",
                "Cobalt Strike",
                "SOUNDBITE",
                "OSX_OCEANLOTUS.D",
                "KOMPROGO",
                "netsh",
                "RotaJakiro",
                "PHOREAL",
                "Arp",
                "Denis",
                "Goopy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "af509bbb-8d18-4903-a9bd-9e94099c6b30",
            "created_at": "2023-01-06T13:46:38.585525Z",
            "updated_at": "2025-03-27T02:00:02.866727Z",
            "deleted_at": null,
            "main_name": "APT32",
            "aliases": [
                "TIN WOODLAWN",
                "OceanLotus Group",
                "OceanLotus",
                "Sea Lotus",
                "G0050",
                "Cobalt Kitty",
                "SeaLotus",
                "ATK17",
                "Ocean Lotus",
                "Ocean Buffalo",
                "POND LOACH",
                "Canvas Cyclone",
                "APT-C-00",
                "APT-32",
                "APT 32"
            ],
            "source_name": "MISPGALAXY:APT32",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f1518ac1-4710-4dd1-a422-e3801e4806cb",
            "created_at": "2024-05-01T02:03:08.147856Z",
            "updated_at": "2025-03-27T02:05:17.421275Z",
            "deleted_at": null,
            "main_name": "TIN WOODLAWN",
            "aliases": [
                "Cobalt Kitty",
                "OceanLotus",
                "WOODLAWN ",
                "APT32 "
            ],
            "source_name": "Secureworks:TIN WOODLAWN",
            "tools": [
                " Denis",
                " Goopy",
                " JEShell",
                " KerrDown",
                " Mimikatz",
                " Ratsnif",
                " Remy",
                " Rizzo",
                " RolandRAT",
                "Cobalt Strike"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2439ad53-39cc-4fff-8fdf-4028d65803c0",
            "created_at": "2022-10-25T16:07:23.353204Z",
            "updated_at": "2025-03-27T02:02:09.749502Z",
            "deleted_at": null,
            "main_name": "APT 32",
            "aliases": [
                "APT 32",
                "APT-C-00",
                "APT-LY-100",
                "ATK 17",
                "Lotus Bane",
                "Ocean Buffalo",
                "OceanLotus",
                "Operation Cobalt Kitty",
                "Operation PhantomLance",
                "Pond Loach",
                "SeaLotus",
                "SectorF01",
                "Tin Woodlawn"
            ],
            "source_name": "ETDA:APT 32",
            "tools": [
                "Agentemis",
                "Android.Backdoor.736.origin",
                "AtNow",
                "Backdoor.MacOS.OCEANLOTUS.F",
                "BadCake",
                "CACTUSTORCH",
                "CamCapture Plugin",
                "CinaRAT",
                "Cobalt Strike",
                "CobaltStrike",
                "Cuegoe",
                "DKMC",
                "Denis",
                "Goopy",
                "HiddenLotus",
                "KOMPROGO",
                "KerrDown",
                "METALJACK",
                "MSFvenom",
                "Mimikatz",
                "Nishang",
                "OSX_OCEANLOTUS.D",
                "OceanLotus",
                "PHOREAL",
                "PWNDROID1",
                "PhantomLance",
                "PowerSploit",
                "Quasar RAT",
                "QuasarRAT",
                "RatSnif",
                "Remy",
                "Remy RAT",
                "Rizzo",
                "Roland",
                "Roland RAT",
                "SOUNDBITE",
                "Salgorea",
                "Splinter RAT",
                "Terracotta VPN",
                "Yggdrasil",
                "cobeacon",
                "denesRAT",
                "fingerprintjs2"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535607,
    "ts_updated_at": 1743041788,
    "ts_creation_date": 1653761827,
    "ts_modification_date": 1653761827,
    "files": {
        "pdf": "https://archive.orkl.eu/e65ee5e116b52059fda570b40073aecefa46059f.pdf",
        "text": "https://archive.orkl.eu/e65ee5e116b52059fda570b40073aecefa46059f.txt",
        "img": "https://archive.orkl.eu/e65ee5e116b52059fda570b40073aecefa46059f.jpg"
    }
}