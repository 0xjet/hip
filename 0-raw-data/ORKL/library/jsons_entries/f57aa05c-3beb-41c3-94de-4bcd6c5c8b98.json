{
    "id": "f57aa05c-3beb-41c3-94de-4bcd6c5c8b98",
    "created_at": "2023-01-12T15:00:24.335946Z",
    "updated_at": "2025-03-27T02:05:59.20146Z",
    "deleted_at": null,
    "sha1_hash": "d32ed5e269fc01531404d5024174b10a1e2b7488",
    "title": "2017-06-29 - Information Stealer Found Hitting Israeli Hospitals",
    "authors": "",
    "file_creation_date": "2022-05-28T23:51:16Z",
    "file_modification_date": "2022-05-28T23:51:16Z",
    "file_size": 207727,
    "plain_text": "# Information Stealer Found Hitting Israeli Hospitals\n\n**[blog.trendmicro.com/trendlabs-security-intelligence/information-stealer-found-hitting-israeli-hospitals/](http://blog.trendmicro.com/trendlabs-security-intelligence/information-stealer-found-hitting-israeli-hospitals/)**\n\nJune 29, 2017\n\n[The abuse of shortcut (LNK) files is steadily gaining traction among cybercriminals. We’ve](http://blog.trendmicro.com/trendlabs-security-intelligence/rising-trend-attackers-using-lnk-files-download-malware/)\n[seen a plethora of threats that leverage malicious LNK files: from well-known ransomware](https://www.trendmicro.com/vinfo/us/threat-encyclopedia/spam/3606/zip-within-a-zip-contains-locky-ransomware)\n[families, backdoors typically deployed in targeted attacks, and](http://blog.trendmicro.com/trendlabs-security-intelligence/sham-g20-summit-email-carries-split-backdoor/) [banking Trojans to](http://blog.trendmicro.com/trendlabs-security-intelligence/zeuszbot-and-sality-jump-on-the-lnk-exploit-bandwagon/) spam\nemails, even an [exploit to a LNK vulnerability itself. These threats are usually exacerbated by](http://blog.trendmicro.com/trendlabs-security-intelligence/worm-posing-as-a-font-file-trigger-exploits/)\nthe further [abuse of legitimate tools such as PowerShell, or](https://www.trendmicro.com/vinfo/us/security/news/security-technology/security-101-the-rise-of-fileless-threats-that-abuse-powershell) [script automation utility AutoIt.](http://blog.trendmicro.com/trendlabs-security-intelligence/autoit-used-to-spread-malware-and-toolsets/)\nIt’s thus not surprising that we discovered an information stealer employing LNK files, which\nour sensors detected in Israeli hospitals.\n\n[Healthcare is considered a cybercriminal cash cow, as it can be a lucrative source of](https://www.trendmicro.com/vinfo/us/security/news/cyber-attacks/healthcare-under-attack-stolen-medical-records)\n[personally identifiable information that can be monetized in underground marketplaces. Initial](http://blog.trendmicro.com/trendlabs-security-intelligence/healthcare-underground-electronic-health-records-sale/)\nfindings revealed that any browser-based information, e.g., login credentials, can be stolen,\nmaking the use of browser-based management systems and applications important.\n\nWe have observed its attempts to gain footholds in the systems and the local networks’\nshared folders. Another notable aspect we’re seeing so far is the combination of worm\npropagation and stealth capabilities.\n\nOur monitoring and analyses are still ongoing and we will update this post as we find more\ndetails about the threat. Here’s what we know so far:\n\n\n-----\n\n**_Propagation via worm. Initial analysis of the malware indicates it propagates via a worm. It_**\ncreates copies of itself, including shortcut files, a non-malicious AutoIt executable, and a\nmalicious AutoIt script into the affected system’s root directory, i.e., C:\\WinddowsUpdated\\\n_<file copy>._\n\n**_Masquerades as a Windows updater. The shortcut files pose as browser and Windows_**\nupdaters, a web 3D creation tool, and links to the system’s Downloads and Games folder.\n\n**_Execution via AutoIt. AutoIt is a legitimate scripting language software/executable designed_**\nto automate tasks (i.e., macros) for several programs in Windows. However, it’s known to be\nabused for wrapping various remote access trojans (RAT). In this case, a legitimate AutoIt\nexecutable is used to run a secondary file that contains the malicious commands. We’ve\n[actually seen a similar threat in the form of the IPPEDO worm (WORM_IPPEDO.B) back in](https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/worm_ippedo.b)\n2014.\n\n**_It gathers system information. The malware executes a command to retrieve system_**\ninformation via C:\\WINDOWS\\system32\\cmd.exe /c SystemInfo.\n\n**_The LNK files are spawned on the affected machines. The LNK files are embedded with_**\nthese malicious commands:\n\n_cmd.exe /c start ..\\WinddowsUpdateCheck\\WinddowsUpdater.exe_\n_\"..\\WinddowsUpdateCheck\\WinddowsUpdater.zip\" & exit_\n\n**_The threat appears to be a highly obfuscated information stealer. The samples we are_**\ncurrently analyzing were highly obfuscated, with payloads hidden under layers of encryption,\nfor instance. The packages we saw each contain malicious 4 LNK files. These LNK files will\nissue commands leading to AutoIt’s execution of .TNT and .EXE files. Based on the behavior\nwe’ve observed so far, it appears it conducts browser-based information theft and records\nkeystrokes. This actually makes sense given the sensitive nature of the information that goes\nthrough healthcare organizations.\n\nAs [the threat landscape continues to mature and diversify, the IT/system administrators and](https://www.trendmicro.com/vinfo/us/security/research-and-analysis/predictions/2017)\ninformation security professionals that secure organizations should do the same. Among\nthese countermeasures: patch and keep the system updated, enforce the principle of least\nprivilege, secure the gateways to reduce attack surface, and implement defense in depth by\n[arraying multilayered security mechanisms—from endpoints,](http://blog.trendmicro.com/en_us/business/products/user-protection/sps.html) [networks, and](http://blog.trendmicro.com/en_us/business/products/network/advanced-threat-protection.html) [servers.](http://blog.trendmicro.com/en_us/business/products/hybrid-cloud.html)\n\n**Indicators of Compromise (IoCs)**\n\n[01e03241c42b12381e5c3ceb11e53f6c5c6bf0fa — WORM_RETADUP.A](https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/WORM_RETADUP.A)\n1186e8d32677f6ac86a35704c9435ccd9ffa8484 — WORM_RETADUP.A\n[479dcd0767653e59f2653b8d3fcddb662a728df4 — LNK_RETADUP.A](https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/LNK_RETADUP.A)\n580ff21d0c9d8aeda2b7192b4caaccee8aba6be4 — LNK_RETADUP.A\n5f32f648610202c3e994509ca0fb714370d6761d — LNK_RETADUP.A\n\n\n-----\n\n63ac13c121e523faa7a4b871b9c2f63bea05bbff — LNK_RETADUP.A\n68d90647cf57428aca972d438974ad6f98e0e2b2 — LNK_RETADUP.A\nce1b01eccf1b71d50e0f5dd6392bf1a4e6963a99 — LNK_RETADUP.A\n\n**Update as of June 29, 2017, 2:00 PM (PDT)**\n\nFurther analysis of the threat reveals that the malware is delivered as an executable file that\nis bundled with an identically-named file masquerading as another file type. For example, the\nfile named WinddowsUpdater.exe comes with a file named WinddowsUpdater.zip. While the\n.EXE file is a legitimate AutoIt file, the alleged .ZIP file is actually an encrypted data file that\ncontains the actual payload. This is the reason why the above mentioned LNK files use a\ncommand line to run the executable with only one argument, which is the same the name of\nthe payload file. Looking into its code, the malware contains the following strings, which may\nindicate that it attempts to gather system information of affected machines:\n\n@ComputerName\n@UserName\n@LogonDomain\nDriveGetSerial(\"C:\")\n@IPAddress1\nEnvGet(\"OS\") and other os related strings\n@OSLang\n@OSVersion\n@OSBuild\n\nIt also connects to the following domain via HTTP:\n\nhxxp://palestineop[.]com/myblog/user\n\nBy digging further, we found out that this domain appears to have been registered in\nNovember 2016, and that there is evidence that a phishing page has been hosted in the root\nfolder of the domain just a few days after it was registered. The said phishing page, which\nentices users to click on a link that will supposedly lead them to Yahoo! Mail service, will\ninstead point to the following URL:\n\nnewsofpalestine[.]com/newss/gsan\n\nThis second URL was already down when we tried to access the page. However, we\nmanaged to find evidence that that the domain used to host some news content in the past\nwhile also storing some malware. Thus, we strongly believe that the page hosted at\n_newsofpalestine[.]com/newss/gsan must have also been a phishing page designed to_\nretrieve email credentials.\n\nWe will continue to update this post as we uncover more details about this threat.\n\n\n-----\n\n**Update as of June 30, 2017, 4:05 AM (PDT)**\n\n[Additional analyses indicate the main malware to be a backdoor (WORM_RETADUP.A) in](https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/WORM_RETADUP.A)\nthe form of a worm. It’s quite unique in that most remote access Trojans/backdoors deployed\nin these kinds of attacks often require the help of other malicious components in order to\npropagate.\n\nRETADUP’s backdoor routines include:\n\nDownloading files\nConnecting to URLs/command and control (C&C) servers\nOpening command-line (cmd) to execute commands\nInstalling a keylogger\nTaking screenshots\nExtracting passwords from web browsers Mozilla Firefox, Opera, and Google Chrome\nStarting, terminating, and restarting processes\nIssuing sleep command within a specified time\nShutting down, restarting, and logging off the machine\nDisplaying a message in a dialogue box\nUpdating a copy of itself from a specific Uniform Resource Identifier (URI) location via\nC&C communications\nRe-executing a copy of itself\n\nRETADUP is also notable for its stealth. It has a checklist of antivirus (AV) products, script\nfile names, analysis, forensics, and debugging tools as well as sandboxes and virtual\nmachines. It self-destructs if any of these are detected by the malware. Its propagation\nroutine entails dropping copies of itself in all drives, including all existing folders in removable\nmedia.\n\nInterestingly, it also checks for the presence of certain LNK files related to online payment\nand money remittance, indicating the malware may also be stealing information from those\nsites:\n\nC:\\WinddowsUpdateCheck\\ebay.lnk\nC:\\WinddowsUpdateCheck\\hamazon.lnk\nC:\\WinddowsUpdateCheck\\hebay.lnk\nC:\\WinddowsUpdateCheck\\hmoneygram.lnk\nC:\\WinddowsUpdateCheck\\hpaypal.lnk\nC:\\WinddowsUpdateCheck\\hpayza.lnk\nC:\\WinddowsUpdateCheck\\hskrill.lnk\nC:\\WinddowsUpdateCheck\\hukash.lnk\nC:\\WinddowsUpdateCheck\\hwestern union.lnk\nC:\\WinddowsUpdateCheck\\moneygram.lnk\nC:\\WinddowsUpdateCheck\\paypal.lnk\n\n\n-----\n\nC:\\WinddowsUpdateCheck\\skrill.lnk\nC:\\WinddowsUpdateCheck\\ukash.lnk\nC:\\WinddowsUpdateCheck\\western union.lnk\n\n**Update as of July 4, 2017, 9:50 PM PDT**\n\nRETADUP’s original codes resemble another malware, ROWMANTI\n[(WORM_ROWMANTI.B), which emerged in 2015 sporting similar capabilities as](https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/worm_rowmanti.b)\nRETADUP’s. ROWMANTI, in turn, appears to be derived from the IPPEDO worm that\nsurfaced a year earlier.\n\nUnderground conversations and code exchanges also know it as “rad worm”, released as a\n[“final pack” in 2014 and was using a Visual Basic Script-based RAT (DUNIHI) controller that](http://blog.trendmicro.com/trendlabs-security-intelligence/vbs-malware-spreading-in-latin-america/)\nwas modified to support “rad-worm” (IPPEDO). We’ve seen later versions but found that they\nwere simply re-uploads of this “final pack” with predefined C&C servers rather than the\ndefault “Your Domain Here” string.\n\n_Snapshot of the controller; it only works with IPPEDO because the initial communication_\n_protocol has been changed for ROWMANTI and RETADUP._\n\nThe network protocols of the three malware look alike. ROWMANTI and RETADUP’s\nprotocols are similar, for instance, but IPPEDO—their predecessor—uses a different\nseparator and keyword at the start of the protocol. Another notable difference is that\nIPPEDO’s communication is in plain text, while ROWMANTI and RETADUP’s are encoded in\nBase64. They also differ in their use of separators and starting string for their initial phonehome communications.\n\nThe C&C servers used by ROWMANTI in 2015 also contain the string “rad”, which is the\noriginal name of the malware used by their developers. We also saw an underground forum\npost from 2015 showing a code snippet of the Domain Generating Algorithm (DGA) section\nof the worm (by a different malware author), but this DGA code is present only in RETADUP.\nThis indicates that while the codes of RETADUP originated from the “rad-worm”, it also\nintegrated codes from other malware authors.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-06-29 - Information Stealer Found Hitting Israeli Hospitals.pdf"
    ],
    "report_names": [
        "2017-06-29 - Information Stealer Found Hitting Israeli Hospitals.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535624,
    "ts_updated_at": 1743041159,
    "ts_creation_date": 1653781876,
    "ts_modification_date": 1653781876,
    "files": {
        "pdf": "https://archive.orkl.eu/d32ed5e269fc01531404d5024174b10a1e2b7488.pdf",
        "text": "https://archive.orkl.eu/d32ed5e269fc01531404d5024174b10a1e2b7488.txt",
        "img": "https://archive.orkl.eu/d32ed5e269fc01531404d5024174b10a1e2b7488.jpg"
    }
}