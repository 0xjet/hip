{
    "id": "6cea0f05-5c0c-4c79-b44e-7fbb0e0589f3",
    "created_at": "2023-01-12T15:07:48.645728Z",
    "updated_at": "2025-03-27T02:17:11.232448Z",
    "deleted_at": null,
    "sha1_hash": "8b4013344e93565641c95bf2db8ad5fdabcf1e2d",
    "title": "2016-09-27 - Komplex Mac backdoor answers old questions",
    "authors": "",
    "file_creation_date": "2022-05-28T17:59:25Z",
    "file_modification_date": "2022-05-28T17:59:25Z",
    "file_size": 485405,
    "plain_text": "# Komplex Mac backdoor answers old questions\n\n**[blog.malwarebytes.com/threat-analysis/2016/09/komplex-mac-backdoor-answers-old-questions/](https://blog.malwarebytes.com/threat-analysis/2016/09/komplex-mac-backdoor-answers-old-questions/)**\n\nThomas Reed September 27, 2016\n\n[A new piece of Mac malware, dubbed Komplex, has been discovered by Palo Alto Networks.](http://researchcenter.paloaltonetworks.com/2016/09/unit42-sofacys-komplex-os-x-trojan/)\nThis malware provides a backdoor into the system, like most other recent Mac malware.\nWhere it gets most interesting, though, isn’t in its capabilities, but in the connections it allows\nus to make.\n\nThe implementation of Komplex is actually anything but complex. The end product of\ninfection is nothing more than a launch agent masquerading as an Apple updater and a\nhidden executable that is kept running by that launch agent. Trivial in execution, trivial to\ndetect, and trivial to remove.\n\nThe details of how the malware gets installed are still partly unknown. Palo Alto provided\ninformation about three different “binder” files, which are executable files that begin the\nprocess of installing the malware. What’s not said, however, is how these files get executed\non the user’s system.\n\nThose “binders” perform two tasks. The first is to install and run another executable at\n/tmp/content. The second is to create a PDF file – containing information about the Russian\nFederal Space Program – in the Downloads folder and open it. This is common behavior\n\n\n-----\n\namong Trojan apps that masquerade as some kind of document; they typically will create\nand open a decoy document, in an attempt to prevent the user from noticing that anything\nstrange happened.\n\n(I’ve seen a few people under the impression that this is a PDF exploit, but there’s no\nindication that this is the case at this time.)\n\nThe executable at /tmp/content is the “dropper” that actually installs the malicious payload.\nThat payload consists of the following files:\n```\n/Users/Shared/.local/kextd\n/Users/Shared/start.sh\n~/Library/LaunchAgents/com.apple.updates.plist\n\n```\nThe start.sh file is used to load the launch agent, which in turn ensures that the kextd\nprocess is kept running persistently.\n\nAfter the installation is complete, the original “binder,” the /tmp/content file and the start.sh\nfile are all deleted.\n\nIn all, this is just more of the same old Mac malware. It doesn’t even have quite the same\nlevel of backdoor capabilities as most of the new backdoors that have appeared this year.\nHowever, what makes this interesting is the connections it allows us to make with other\nmalware.\n\n\n-----\n\nPalo Alto makes a connection between this malware and other malware created by the\n[Sofacy Group, an organization that is known to target governments. Sofacy appears to be a](https://en.wikipedia.org/wiki/Sofacy_Group)\nRussian group, possibly funded by the Russian government, and are considered to be\ninvolved in the recent Democratic National Committee hacking.\n\nThat’s interesting, but perhaps more fascinating to Mac security folks is an additional\n[connection made with an unnamed piece of malware discovered last year, which installed via](http://baesystemsai.blogspot.com/2015/06/new-mac-os-malware-exploits-mackeeper.html)\na vulnerability in the MacKeeper app. Little was known about the malware beyond what BAE\nSystems published.\n\nNow we seem to have the answer to the question of what that malware was. Palo Alto\nNetworks identified a number of compelling code similarities between Komplex and that\nunnamed malware. Not only does this put a name to that old malware, but it also shows that\nSofacy has had their eyes on the Mac for some time now.\n\nInterestingly, although the method of infection has changed, not much seems to have\nchanged about the payload, which was also a launch agent tasked with loading an\nexecutable file from the /Users/Shared folder.\n\n[Malwarebytes Anti-Malware for Mac detects the dropped components as OSX.Komplex.](https://malwarebytes.com/antimalware/mac)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-09-27 - Komplex Mac backdoor answers old questions.pdf"
    ],
    "report_names": [
        "2016-09-27 - Komplex Mac backdoor answers old questions.pdf"
    ],
    "threat_actors": [
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536068,
    "ts_updated_at": 1743041831,
    "ts_creation_date": 1653760765,
    "ts_modification_date": 1653760765,
    "files": {
        "pdf": "https://archive.orkl.eu/8b4013344e93565641c95bf2db8ad5fdabcf1e2d.pdf",
        "text": "https://archive.orkl.eu/8b4013344e93565641c95bf2db8ad5fdabcf1e2d.txt",
        "img": "https://archive.orkl.eu/8b4013344e93565641c95bf2db8ad5fdabcf1e2d.jpg"
    }
}