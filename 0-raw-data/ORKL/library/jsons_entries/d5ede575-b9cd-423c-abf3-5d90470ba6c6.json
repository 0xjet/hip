{
    "id": "d5ede575-b9cd-423c-abf3-5d90470ba6c6",
    "created_at": "2023-01-12T15:04:48.723395Z",
    "updated_at": "2025-03-27T02:05:42.279807Z",
    "deleted_at": null,
    "sha1_hash": "628766e85ca20a8419c430d16199a103033cdae4",
    "title": "2021-07-08 - Enriching Threat Intelligence for the Carbine Loader Crypto-jacking Campaign",
    "authors": "",
    "file_creation_date": "2022-05-28T04:07:09Z",
    "file_modification_date": "2022-05-28T04:07:09Z",
    "file_size": 206406,
    "plain_text": "# Enriching Threat Intelligence for the Carbine Loader Crypto-jacking Campaign\n\n**[team-cymru.com/blog/2021/07/08/enriching-threat-intelligence-for-the-carbine-loader-crypto-jacking-campaign/](https://team-cymru.com/blog/2021/07/08/enriching-threat-intelligence-for-the-carbine-loader-crypto-jacking-campaign/)**\n\nS2 Research Team View all posts by S2 Research Team July 8, 2021\n\n**Co-authored by Andy Kraus and Dan Heywood**\n\n[Cloud security provider Lacework published an article in April 2021 on a crypto-jacking](https://www.lacework.com/blog/carbine-loader-cryptojacking-campaign/)\ncampaign they dubbed “Carbine Loader”. The campaign targeted servers running Nagios XI,\nan enterprise network monitoring application.\n\nDespite there being roughly 10,000 vulnerable public-facing Nagios servers, the campaign’s\nMonero wallet contained only around $900. This seemed a curiously small amount,\nparticularly considering the campaign’s relatively sophisticated elements, such as the\noverwriting of logs and automated lateral movement.\n\nWe decided to take a look using our threat reconnaissance platform, Recon, to see what we\ncould find out about the activity. The summary of our process is outlined below:\n\n\n-----\n\n**Figure 1: Process used to enrich the Lacework article**\n\nPassive DNS\n\nLacework detailed the use of two domains for command and control (C2) purposes:\n\n1.) sslcer.justdied.com\n\nInfected hosts are set to beacon every 20 minutes to TCP/8080\nThe mining server is hosted on TCP/3333\n\n2.) jquery-dns-07.dns05.com\n\nUsed by related loaders as a C2 server\n\nUsing the passive DNS dataset in Recon, we confirmed Lacework’s findings that the\ndomains were primarily hosted on two IP addresses from January to the present.\n\nNetwork Traffic\n\nBased on the hosting information identified, we used Recon to pivot into our network traffic\ndata to look for organizations communicating with the IPs.\n\nWithin this data set we were able to observe the expected traffic over TCP/3333 and\nTCP/8080, as specified based on analysis of the malware. In addition, we also saw traffic\nover TCP/445 and TCP/3389, originating from potential victim organizations.\n\n**Note: The TCP/445 and TCP/3389 traffic was sourced from IP addresses which also made**\nconnections to the C2 over TCP/3333 and/or TCP/8080.\n\nX.509 Certificates and Open Ports\n\nPivoting into our X.509 certificate and Open Ports data sets, we could show that most of the\nIP addresses communicating with the two C2 servers were running Nagios XI by looking at\nthe HTTP responses.\n\nMany of these servers were found to be hosting the standard login page for Nagios devices.\n\nVictimology\n\nA review of our analysis showed 104 unique IPs communicating with the C2 servers. From\nthese IPs, we were able to identify 31 distinct organizations based on enrichments from a\nvariety of datasets in Recon, including Whois, ASN, PDNS, X.509, and Open Ports.\n\nWhile one might expect a crypto-jacking campaign to be purely opportunistic (i.e., the more\nvictims the better), the victim set we discovered seemed to have a focus on a few specific\nindustries, including IT / Software and Higher Education.\n\n\n-----\n\n**Figure 2: Identified victims by sector**\n\nIn addition to the inbound command and control traffic, our network traffic data showed\noutbound TCP/80 and TCP/443 connections from the C2s to over a dozen additional\norganizations, activity which we attributed to potential reconnaissance by the threat actors.\nThe organizations subject to this activity included an aerial imagery company, a financial\nsoftware company, an agricultural agency, and an educational establishment.\n\nFinancials\n\nFinally, we took another look at the threat actor’s Monero wallet in early June and the value\nwas still approximately the same (2.7 XMR vs. 3.12 XMR) as Lacework reported.\n\nThe campaign currently has no active miners operating, despite ongoing beaconing from\nvictims to the C2s.\n\n**Figure 3: Monero wallet used by the threat actors**\n\nConclusion\n\nUsing Recon, we were able to build on the excellent analysis provided by Lacework and in\nthe process identify a possible evolution of malware communications via TCP/445 and\nTCP/3389 based on our ability to track the hosting IP addresses of C2 domains (and\n\n\n-----\n\npotential victims) over time.\n\nWhile on the surface this appears to be standard crypto-jacking activity, the content of the\ncrypto wallet and victimology seem to tell a different story. While we can’t come to any\ndefinitive conclusions at this time, there may be more to Carbine Loader than meets the eye.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-07-08 - Enriching Threat Intelligence for the Carbine Loader Crypto-jacking Campaign.pdf"
    ],
    "report_names": [
        "2021-07-08 - Enriching Threat Intelligence for the Carbine Loader Crypto-jacking Campaign.pdf"
    ],
    "threat_actors": [
        {
            "id": "6ad410c7-e291-4327-a54b-281c23f0d4fa",
            "created_at": "2022-10-25T16:07:24.501468Z",
            "updated_at": "2025-03-27T02:02:10.26052Z",
            "deleted_at": null,
            "main_name": "Karakurt",
            "aliases": [],
            "source_name": "ETDA:Karakurt",
            "tools": [
                "7-Zip",
                "Agentemis",
                "AnyDesk",
                "Cobalt Strike",
                "CobaltStrike",
                "FileZilla",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "WinZip",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "2af9bea3-b43e-4a6d-8dc6-46dad6e3ff24",
            "created_at": "2022-10-25T16:47:55.853415Z",
            "updated_at": "2025-03-27T02:05:17.401138Z",
            "deleted_at": null,
            "main_name": "GOLD TOMAHAWK",
            "aliases": [
                "Karakurt Lair",
                "Karakurt Team",
                "Karakurt"
            ],
            "source_name": "Secureworks:GOLD TOMAHAWK",
            "tools": [
                " AnyDesk",
                " MEGA",
                " QuickPacket",
                " Rclone",
                " SendGB",
                "7-ZIP"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535888,
    "ts_updated_at": 1743041142,
    "ts_creation_date": 1653710829,
    "ts_modification_date": 1653710829,
    "files": {
        "pdf": "https://archive.orkl.eu/628766e85ca20a8419c430d16199a103033cdae4.pdf",
        "text": "https://archive.orkl.eu/628766e85ca20a8419c430d16199a103033cdae4.txt",
        "img": "https://archive.orkl.eu/628766e85ca20a8419c430d16199a103033cdae4.jpg"
    }
}