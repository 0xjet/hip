{
    "id": "90e40fab-c92b-42c1-b16c-c19f7c82f8b5",
    "created_at": "2023-01-12T15:08:23.756005Z",
    "updated_at": "2025-03-27T02:05:50.815964Z",
    "deleted_at": null,
    "sha1_hash": "22aad8d470b500fdd4ff6cf60f92f12845544b6e",
    "title": "2017-03-01 - Threat Spotlight- Flokibot PoS Malware",
    "authors": "",
    "file_creation_date": "2022-05-28T21:53:45Z",
    "file_modification_date": "2022-05-28T21:53:45Z",
    "file_size": 150542,
    "plain_text": "# Threat Spotlight: Flokibot PoS Malware\n\n**[cylance.com/en_us/blog/threat-spotlight-flokibot-pos-malware.html](https://www.cylance.com/en_us/blog/threat-spotlight-flokibot-pos-malware.html)**\n\nThe BlackBerry Cylance Threat Research Team\n\n[RESEARCH & INTELLIGENCE / 03.01.17 /](https://www.cylance.com/en/category/research-and-intelligence) The BlackBerry Cylance Threat Research\nTeam\n\n## Introduction\n\nMuch has been written in recent years about point-of-sale (PoS) data breaches, most\nnotably attacks against Target in late 2013, Home Depot in mid to late 2014, Wendy’s in\nearly 2016 and most recently Arby’s in January of this year. Generally, malware used in PoS\nattacks is designed to identify payment card data residing in memory, then exfiltrate that\ndata to an off-site, attacker controlled server.\n\n## Background\n\nAccording to a [2016 report published by the Federal Reserve, non-cash payments](https://www.federalreserve.gov/newsevents/press/other/2016-payments-study-20161222.pdf)\nincreased in 2016 to an estimated total value of $178 trillion, with an estimated total noncash payments increase of 5.3 percent per year since 2012. Given these statistics, it is not\nsurprising to learn that there exists a thriving market for stolen payment card information on\nthe dark web.\n\nIn a [2015 study, BitGlass discovered that fake financial information they generated and](http://www.darkreading.com/attacks-breaches/what-happens-when-personal-information-hits-the-dark-web/d/d-id/1319801)\ntracked was viewed almost 1,100 times from 22 different countries. Recent reports released\nby [Arbor Networks and](https://www.arbornetworks.com/blog/asert/flokibot-invades-pos-trouble-brazil/) [Flashpoint mentioned a recent campaign involving PoS malware](https://www.flashpoint-intel.com/flokibot-curious-case-brazilian-connector/)\ncalled Flokibot that has recently targeted endpoints in Brazil, specifically those with\n\n\n-----\n\nPortuguese language versions of Windows 7 installed. Both reports have excellent\nbreakdowns of the files and attack chain analysis which will not be repeated here.\n\n## Testing RAM Scraping Protection\n\nCylancePROTECT® actively blocks RAM scraping techniques used by this type of PoS\nthreat, so the Cylance Threat Guidance Team set out to discover how CylancePROTECT\nwould react to Flokibot in a test environment.\n\nFirst, a brief introduction to what kind of data is encoded on a credit or debit card. The\nmagnetic stripe on the back of a financial payment card contains three “tracks” of data:\nTrack 1, Track 2 and Track 3 (which is rarely used). Track 1 contains, among other things,\nthe account holder's name, account number, expiration date and CVV number. Track 2\ncontains much of the same information, except for the account holder's name and some of\nthe other checks, and is ultimately less data over all, while still possessing enough data to\ngenerate a fake payment card. This makes the information contained on Track 2 a prime\ntarget for attackers. The format of the information contained within Track 2 is illustrated\nbelow:\n\n\n-----\n\nFig1_Floikibot\n\n\n-----\n\n_Figure 1. Track 2 Data (image by Duo Security: https://duo.com/blog/pos-malware-a-pci-_\n_nightmare)_\n\nWe located a recent sample of Flokibot and copied it into a test environment with\nCylancePROTECT v1400 installed and online, where it was quarantined pre-execution:\n\n\n-----\n\nFig2_Floikibot\n\n\n-----\n\n_Figure 2. Malware Quarantined Pre-execution_\n\nThen, we took CylancePROTECT offline and again discovered the same results: the file\nwas quarantined pre-execution, seen below:\n\n\n-----\n\nFig3_Floikibot\n\n\n-----\n\n_Figure 3. Malware Quarantined Pre-execution in Offline Mode_\n\nIt was at this point that we got curious to see what would happen if we removed every\nprotection within CylancePROTECT’s arsenal except for Memory Defense. So, we created\na test environment with Portuguese language version of 32-bit Windows 7 Professional with\nCylancePROTECT installed.\n\nThere are several websites that allow a user to generate credit card numbers that adhere to\nthe [Luhn Algorithm, a checksum formula that is used to validate, among other things, credit](https://en.wikipedia.org/wiki/Luhn_algorithm)\nand debit card numbers. The team leveraged one of these sites to generate fake credit card\nnumbers for testing:\n\n**VISA                  MASTERCARD**\n\n4556920012834452        5341701240865907\n\n4929028434080223        5301666338130225\n\n4532321332286920        5414957219825866\n\n4916294386558609        5181854712024975\n\nThese numbers were used to generate strings that adhered to the formatting structure of\nthe information contained on Track 2, an example is shown below:\n\n_;xxxxxxxxxxxxxxxx=yymm1200123400000000?*_\n\nWhere ‘x’ represents the 16-digit account number and ‘yymm’ represents the card's\nexpiration date, as year and month.\n\nWhen the file is executed, it injects explorer.exe and as a result, any credit card number that\nlies within the memory space of that process should be susceptible to memory scraping by\nFlokibot. This means that we should be able to generate a string that adheres to the\nformatting above and enter it into an open Notepad document, then execute the file. The\nRAM scraping protection built into CylancePROTECT will recognize Track 2 data in memory\nand trigger an alert.\n\nWe disabled all protections in our test environment, except for Memory Defense. The preexecution setup of the test is shown below (again, note that we are using the Portuguese\nlanguage version of 32-bit Windows 7 Professional):\n\n\n-----\n\nFig4_Floikibot\n\n\n-----\n\n_Figure 4. Pre-execution Setup_\n\nAt this point, we executed the file. With the properly formatted Track 2 data in memory, we\nwill expect to see the RAM scraping protection trigger an alert when the malware is\nexecuted, which is exactly what happens. In the screenshot below, the alert (Violation:\nTrackDataRead) can be seen:\n\n\n-----\n\nFig5_Floikibot\n\n\n-----\n\n_Figure 5. Post-execution, TrackDataRead Violation Alert_\n\n## Conclusion\n\nThis demonstration shows that not only did CylancePROTECT quarantine the threat in both\nonline and offline modes, the RAM scraping protection built within the Memory Defense\nprotection is effective in mitigating Flokibot point of sale malware attacks by recognizing\nTrack 2 payment card data residing in memory. It is important for end users to enable\nMemory Defense on their endpoints to aid in defending against PoS memory scraping\nattacks.\n\n[If you use our endpoint protection product, CylancePROTECT, you were already protected](https://www.cylance.com/en_us/products/our-products/protect.html)\nfrom this attack. If you don't have CylancePROTECT, [contact us to learn how our AI based](https://www.cylance.com/en_us/contact-us.html)\nsolution can predict and prevent unknown and emerging threats.\n\n## Indicators of Compromise\n\n**SHA-256 Hash:**\n\n23E8B7D0F9C7391825677C3F13FD2642885F6134636E475A3924BA5BDD1D4852\n\n**MD5 Hash:**\nDCBF3A8BFEC2B5A062F68DE4EEE4B717\n\n**C2:**\nhttps://extensivee(dot)bid/000L7bo11Nq36ou9cfjfb0rDZ17E7ULo_4agents/gate(dot)php\n\nThe BlackBerry Cylance Threat Research Team\n\n## About The BlackBerry Cylance Threat Research Team\n\nThe BlackBerry Cylance Threat Research team examines malware and suspected malware\nto better identify its abilities, function and attack vectors. Threat Research is on the frontline\nof information security and often deeply examines malicious software, which puts us in a\nunique position to discuss never-seen-before threats.\n\nBack\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-03-01 - Threat Spotlight- Flokibot PoS Malware.pdf"
    ],
    "report_names": [
        "2017-03-01 - Threat Spotlight- Flokibot PoS Malware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536103,
    "ts_updated_at": 1743041150,
    "ts_creation_date": 1653774825,
    "ts_modification_date": 1653774825,
    "files": {
        "pdf": "https://archive.orkl.eu/22aad8d470b500fdd4ff6cf60f92f12845544b6e.pdf",
        "text": "https://archive.orkl.eu/22aad8d470b500fdd4ff6cf60f92f12845544b6e.txt",
        "img": "https://archive.orkl.eu/22aad8d470b500fdd4ff6cf60f92f12845544b6e.jpg"
    }
}