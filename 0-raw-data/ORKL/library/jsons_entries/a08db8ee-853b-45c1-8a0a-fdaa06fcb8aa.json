{
    "id": "a08db8ee-853b-45c1-8a0a-fdaa06fcb8aa",
    "created_at": "2023-01-12T15:06:36.171273Z",
    "updated_at": "2025-03-27T02:09:18.489416Z",
    "deleted_at": null,
    "sha1_hash": "0bc5cac5198ddf83861d56013d1c25a21091164c",
    "title": "2022-01-18 - BlackCat Ransomware - Highly-Configurable, Rust-Driven RaaS On The Prowl For Victims",
    "authors": "",
    "file_creation_date": "2022-05-29T01:20:21Z",
    "file_modification_date": "2022-05-29T01:20:21Z",
    "file_size": 837351,
    "plain_text": "# BlackCat Ransomware | Highly-Configurable, Rust-Driven RaaS On The Prowl For Victims\n\n**[sentinelone.com/labs/blackcat-ransomware-highly-configurable-rust-driven-raas-on-the-prowl-for-victims/](https://www.sentinelone.com/labs/blackcat-ransomware-highly-configurable-rust-driven-raas-on-the-prowl-for-victims/)**\n\nJim Walter\n\nBlackCat (aka AlphaVM, AlphaV) is a newly established RaaS (Ransomware as a Service) with payloads written in Rust. While\nBlackCat is not the first ransomware written in the Rust language, it joins a small (yet growing) sliver of the malware landscape\nmaking use of this popular cross-platform language.\n\nFirst [appearing in late November, BlackCat has reportedly been attacking targets in multiple countries, including Australia, India](https://twitter.com/malwrhunterteam/status/1468713125457371139?ref_src=twsrc%5Etfw%7Ctwcamp%5Etweetembed%7Ctwterm%5E1468713125457371139%7Ctwgr%5E%7Ctwcon%5Es1_&ref_url=https%3A%2F%2Fwww.bleepingcomputer.com%2Fnews%2Fsecurity%2Falphv-blackcat-this-years-most-sophisticated-ransomware%2F)\nand the U.S, and demanding ransoms in the region of $400,000 to $3,000,000 in Bitcoin or Monero.\n\n## BlackCat Ransomware Overview\n\nIn order to attract affiliates, the authors behind BlackCat have been heavily marketing their services in well-known underground\nforums.\n\nBlackCat operators maintain a victim blog as is standard these days. The blog hosts company names and any data leaked in\nthe event that the victims do not agree to cooperate.\n\nCurrent data indicates primary delivery of BlackCat is via 3rd party framework/toolset (e.g., Cobalt Strike) or via exposed (and\nvulnerable) applications. BlackCat currently supports both Windows and Linux operating systems.\n\n## BlackCat Configuration Options\n\nSamples analyzed (to date ) require an “access token” to be supplied as a parameter upon execution. This is similar to threats\n[like Egregor, and is often used as an anti-analysis tactic. This ‘feature’ exists in both the Windows and Linux versions of](https://www.sentinelone.com/labs/egregor-raas-continues-the-chaos-with-cobalt-strike-and-rclone/)\nBlackCat.\n\nHowever, the BlackCat samples we analyzed could be launched with any string supplied as the access token. For example:\n```\nMalware.exe -v --access-token 12345\n\n```\nThe ransomware supports a visible command set, which can be obtained via the `-h or` `--help parameters.`\n\n\n-----\n\nBlackCat command line options\nAs seen above, the executable payloads support a variety of commands, many of which are VMware-centric.\n```\n --no-prop                 Do not self propagate(worm) on Windows\n --no-prop-servers <NO_PROP_SERVERS>    Do not propagate to defined servers\n --no-vm-kill                Do not stop VMs on ESXi\n --no-vm-snapshot-kill           Do not wipe VMs snapshots on ESXi\n --no-wall                 Do not update desktop wallpaper on Windows\n\n```\nIn verbose mode ( -v ) the following output can be observed upon launch of the BlackCat payloads:\n\nBlackCat ransomware run in verbose mode\n\n## BlackCat Execution and Encryption Behaviour\n\nImmediately upon launch, the malware will attempt to validate the existence of the previously mentioned access-token, followed\nby querying for the system UUID ( wmic ).\n\n\n-----\n\nThose pieces of data are concatenated together into what becomes the Access key portion of their recovery URL displayed in\nthe ransom note. In addition, on Windows devices, BlackCat attempts to delete VSS (Volume Shadow Copies) as well as\nenumerate any accessible drives to search for and encrypt eligible files.\n\nOther configuration parameters are evaluated before proceeding to execute multiple privilege escalation methods, based on the\nOS identified by `wmic earlier. These methods are visible at the time of execution and include the use of the Com Elevation`\nMoniker.\n\nIt is at this point that BlackCat will attempt to terminate any processes or services listed within the configuration such as any\nprocesses which may inhibit the encryption process. There are also specific files and directories that are excluded from\nencryption. Much of this is configurable at the time of building the ransomware payloads.\n\nThe targeted processes and services are noted in the `kill_processes and` `kill_services sections respectively. File and`\nfolder exclusions are handled in the `exclude directory_names section.`\n\nTo further illustrate, the following were extracted from sample `d65a131fb2bd6d80d69fe7415dc1d1fd89290394 /`\n```\n74464797c5d2df81db2e06f86497b2127fda6766956f1b67b0dcea9570d8b683 :\n\n```\n**Kill_Processes**\n\nbackup memtas mepocs msexchange\n\nsql svc$ veeam vss\n\n**Kill_Services**\n\nagntsvc dbeng50 dbsnmp encsvc\n\nexcel firefox infopath isqlplussvc\n\nmsaccess mspub mydesktopqos mydesktopservice\n\nnotepad ocautoupds ocomm ocssd\n\nonenote oracle outlook powerpnt\n\nsqbcoreservice sql steam synctime\n\ntbirdconfig thebat thunderbird visio\n\nwinword wordpad xfssvccon\n\n**Exclude_Directory_Names**\n\n$recycle.bin $windows.~bt $windows.~ws 386\n\nadv all users ani appdata\n\napplication data autorun.inf bat bin\n\nboot boot.ini bootfont.bin bootsect.bak\n\ncab cmd com config.msi\n\ncpl cur default deskthemepack\n\ndiagcab diagcfg diagpkg dll\n\ndrv exclude_file_extensions:[themepack exclude_file_names:[desktop.ini exe\n\ngoogle hlp hta icl\n\nicns ico iconcache.db ics\n\nidx intel key ldf\n\n\n-----\n\nlnk lock mod mozilla\n\nmpa msc msi msocache\n\nmsp msstyles msu] nls\n\nnomedia ntldr ntuser.dat ntuser.dat.log]\n\nntuser.ini ocx pdb perflogs\n\nprf program files program files (x86) programdata\n\nps1 public rom rtp\n\nscr shs spl sys\n\nsystem volume information theme thumbs.db tor browser\n\nwindows windows.old] wpx\n\nBlackCat also spawns a number of its own processes, with syntax (for Windows) as follows:\n```\n WMIC.exe (CLI interpreter)  csproduct get UUID\n cmd.exe (CLI interpreter)  /c \"reg add HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters\n/v MaxMpxCt /d 65535 /t REG_DWORD /f\"\n cmd.exe (CLI interpreter)  /c \"wmic csproduct get UUID\"\n cmd.exe (fsutil.exe)    /c \"fsutil behavior set SymlinkEvaluation R2L:1\"\n fsutil.exe         behavior set SymlinkEvaluation R2L:1\n cmd.exe (fsutil.exe)    /c \"fsutil behavior set SymlinkEvaluation R2R:1\"\n\n```\nThe `fsutil -based modifications are meant to allow for use of both remote and local symlinks. BlackCat enables ‘remote to`\nlocal’ and ‘remote to remote’ capability.\n```\n fsutil.exe           behavior set SymlinkEvaluation R2R:1\n cmd.exe (vssadmin.exe)     /c \"vssadmin.exe delete shadows /all /quiet\"\n reg.exe (CLI interpreter)   add HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters /v\nMaxMpxCt /d 65535 /t REG_DWORD /f\n cmd.exe (worldwideStrata.exe) /c \"C:\\Users\\admin1\\Desktop\\worldwideStrata.exe\" --child\n vssadmin.exe          delete shadows /all /quietcmd.exe (ARP.EXE) /c \"arp -a\"\n\n```\nSome more recently-built copies have a few additions. For example, in sample\n```\nc1187fe0eaddee995773d6c66bcb558536e9b62c / c3e5d4e62ae4eca2bfca22f8f3c8cbec12757f78107e91e85404611548e06e40\n\n```\nwe see the addition of:\n```\n wmic.exe Shadowcopy Delete\"\n \"iisreset.exe /stop\"\n bcdedit.exe /set {default} recoveryenabled No\n\n```\nMuch like other fine details, all this can be adjusted or configured by the affiliates at the time of building the payloads.\n\nBlackCat configurations are not necessarily tailored to the target operating system. In the Linux variants we have analyzed to\ndate, there are Windows-specific process, service, and file references in the `kill_processes,` `kill_services, and`\n```\nexclude_directory_names .\n\n```\nThe following excerpt is from sample `f8c08d00ff6e8c6adb1a93cd133b19302d0b651afd73ccb54e3b6ac6c60d99c6 .`\n\n\n-----\n\nLinux variant configuration\nSpecific encryption logic is not necessarily novel either and is somewhat configurable by the affiliate at the time of building the\nransomware payloads. BlackCat supports both ChaCha20 and AES encryption schemes.\n\nExtensions on encrypted files can vary across samples. Examples observed include `.dkrpx75,` `.kh1ftzx and` `.wpzlbji .`\n\nBlackCat ransomware execution chain (Windows version)\n\n## Post-Infection, Payment and Portal\n\nInfected clients will be greeted with a ransom note as well as a modified desktop image.\n\nBlackCat’s modified desktop image\n\nInfected uses are instructed to connect to the attackers’ payment portal via TOR.\n\n\n-----\n\nBlackCat ransom note\nThe ransom note informs the victim that not only have files been encrypted but data has been stolen.\n\nVictim’s are threatened with data leakage if they refuse to pay and provided with a list of data types that have been stolen.\n\nIn theory, once victims connect to the attacker’s portal, they are able to communicate and potentially acquire a decryption tool.\nEverything on the BlackCat portal is tied back to the specific target ID, which must be supplied correctly from the URL in the\nransom note.\n\n## Conclusion\n\nIn its relatively short time on the radar, BlackCat has carved a notable place for itself amongst mid-tier ransomware actors. This\ngroup knows their craft and are cautious when selecting partners or affiliates. It is possible that some of the increased affiliation\nand activity around BlackCat is attributed to other actors migrating to BlackCat as larger platforms fizzle out (Ryuk, Conti,\nLockBit and REvil).\n\n\n-----\n\nActors utilizing BlackCat know their targets well and make every attempt to stealthily compromise enterprises. Prevention by\n[way of powerful, modern, endpoint security controls are a must. The SentinelOne Singularity Platform is capable of detecting](https://www.sentinelone.com/why-sentinelone/)\nand preventing BlackCat infections on both Windows and Linux endpoints.\n\n## Indicators of Compromise\n\n**SHA256**\n\n0c6f444c6940a3688ffc6f8b9d5774c032e3551ebbccb64e4280ae7fc1fac479\n\n13828b390d5f58b002e808c2c4f02fdd920e236cc8015480fa33b6c1a9300e31\n\n15b57c1b68cd6ce3c161042e0f3be9f32d78151fe95461eedc59a79fc222c7ed\n\n1af1ca666e48afc933e2eda0ae1d6e88ebd23d27c54fd1d882161fd8c70b678e\n\n28d7e6fe31dc00f82cb032ba29aad6429837ba5efb83c2ce4d31d565896e1169\n\n2cf54942e8cf0ef6296deaa7975618dadff0c32535295d3f0d5f577552229ffc\n\n38834b796ed025563774167716a477e9217d45e47def20facb027325f2a790d1\n\n3d7cf20ca6476e14e0a026f9bdd8ff1f26995cdc5854c3adb41a6135ef11ba83\n\n4e18f9293a6a72d5d42dad179b532407f45663098f959ea552ae43dbb9725cbf\n\n59868f4b346bd401e067380cac69080709c86e06fae219bfb5bc17605a71ab3f\n\n731adcf2d7fb61a8335e23dbee2436249e5d5753977ec465754c6b699e9bf161\n\n74464797c5d2df81db2e06f86497b2127fda6766956f1b67b0dcea9570d8b683\n\n7b2449bb8be1b37a9d580c2592a67a759a3116fe640041d0f36dc93ca3db4487\n\n7e363b5f1ba373782261713fa99e8bbc35ddda97e48799c4eb28f17989da8d8e\nbd337d4e83ab1c2cacb43e4569f977d188f1bb7c7a077026304bf186d49d4117\n\nc3e5d4e62ae4eca2bfca22f8f3c8cbec12757f78107e91e85404611548e06e40\n\nc8b3b67ea4d7625f8b37ba59eed5c9406b3ef04b7a19b97e5dd5dab1bd59f283\ncefea76dfdbb48cfe1a3db2c8df34e898e29bec9b2c13e79ef40655c637833ae\n\nf815f5d6c85bcbc1ec071dd39532a20f5ce910989552d980d1d4346f57b75f89\n\nf8c08d00ff6e8c6adb1a93cd133b19302d0b651afd73ccb54e3b6ac6c60d99c6\n\n**SHA1**\n\n087497940a41d96e4e907b6dc92f75f4a38d861a\n\n11203786b17bb3873d46acae32a898c8dac09850\n\n2a53525eeb7b76b3d1bfe40ac349446f2add8784\n\n45212fa4501ede5af428563f8043c4ae40faec76\n\n57a6dfd2b021e5a4d4fe34a61bf3242ecee841b3\n\n5869820f261f76eafa1ba00af582a9225d005c89\n\n5c6ca5581a04955d8e4d1fa452621fbc922ecb7b\n\n655c2567650d2c109fab443de4b737294994f1fd\n\n783b2b053ef0345710cd2487e5184f29116e367c\n\n89060eff6db13e7455fee151205e972260e9522a\n\n9146a448463935b47e29155da74c68d16e0d7031\n\n94f025f3be089252692d58e54e3e926e09634e40\n\na186c08d3d10885ebb129b1a0d8ea0da056fc362\n\nc1187fe0eaddee995773d6c66bcb558536e9b62c\n\nce5540c0d2c54489737f3fefdbf72c889ac533a9\n\nd65a131fb2bd6d80d69fe7415dc1d1fd89290394\n\nda1e4a09a59565c5d62887e0e9a9f6f04a18b5f4\n\ne17dc8062742878b0b5ced2145311929f6f77abd\n\ne22436386688b5abe6780a462fd07cd12c3f3321\n\nf466b4d686d1fa9fed064507639b9306b0d80bbf\n\n**MITRE ATT&CK**\n\n[T1027.002 – Obfuscated Files or Information: Software Packing](https://attack.mitre.org/techniques/T1027/002/)\n\n[T1027 – Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027/)\n\n[T1007 – System Service Discovery](https://attack.mitre.org/techniques/T1007/)\n\n[T1059 – Command and Scripting Interpreter](https://attack.mitre.org/techniques/T1059/)\n\n[TA0010 – Exfiltration](https://attack.mitre.org/tactics/TA0010/)\n\n[T1082 – System Information Discovery](https://attack.mitre.org/techniques/T1082/)\n\n[T1490 – Inhibit System Recovery](https://attack.mitre.org/techniques/T1490/)\n\n\n-----\n\n[T1485 Data Destruction](https://attack.mitre.org/techniques/T1485/)\n[T1078 – Valid Accounts](https://attack.mitre.org/techniques/T1078/)\n[T1486 – Data Encrypted For Impact](https://attack.mitre.org/techniques/T1486/)\n[T1140 – Encode/Decode Files or Information](https://attack.mitre.org/techniques/T1140/)\n[T1202 – Indirect Command Execution](https://attack.mitre.org/techniques/T1202/)\n[T1543.003 – Create or Modify System Process: Windows Service](https://attack.mitre.org/techniques/T1543/003/)\n[T1550.002 – Use Alternate Authentication Material: Pass the Hash](https://attack.mitre.org/techniques/T1550/002/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-18 - BlackCat Ransomware - Highly-Configurable, Rust-Driven RaaS On The Prowl For Victims.pdf"
    ],
    "report_names": [
        "2022-01-18 - BlackCat Ransomware - Highly-Configurable, Rust-Driven RaaS On The Prowl For Victims.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535996,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653787221,
    "ts_modification_date": 1653787221,
    "files": {
        "pdf": "https://archive.orkl.eu/0bc5cac5198ddf83861d56013d1c25a21091164c.pdf",
        "text": "https://archive.orkl.eu/0bc5cac5198ddf83861d56013d1c25a21091164c.txt",
        "img": "https://archive.orkl.eu/0bc5cac5198ddf83861d56013d1c25a21091164c.jpg"
    }
}