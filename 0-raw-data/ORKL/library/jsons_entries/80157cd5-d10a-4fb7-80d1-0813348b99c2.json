{
    "id": "80157cd5-d10a-4fb7-80d1-0813348b99c2",
    "created_at": "2023-01-12T15:08:54.625735Z",
    "updated_at": "2025-03-27T02:05:37.645797Z",
    "deleted_at": null,
    "sha1_hash": "c747f443f986d09f5bd17d7a7dd49daaf14de847",
    "title": "2022-12-06 - Cova and Nosu- a new loader spreads a new stealer",
    "authors": "",
    "file_creation_date": "2022-12-29T00:26:04Z",
    "file_modification_date": "2022-12-29T00:26:04Z",
    "file_size": 1733442,
    "plain_text": "# Cova and Nosu: a new loader spreads a new stealer\n\n**[bitsight.com/blog/cova-and-nosu-new-loader-spreads-new-stealer](https://www.bitsight.com/blog/cova-and-nosu-new-loader-spreads-new-stealer)**\n\nWritten by João Batista\nDecember 06, 2022\nShare\nFacebook\nTwitter\nLinkedIn\n\n[BitSight Security Research](https://www.bitsight.com/blogs?field_topics_target_id=496)\n\n## Summary\n\nBitSight has discovered two previously undocumented malware families named Cova and\nNosu. They have different purposes and capabilities, although we found some similarities\nduring our research:\n\nCova is a tiny loader with capabilities to update itself, download and execute files, and\nload DLLs.\nNosu is a stealer capable of gathering credentials, cookies, crypto wallets, and files.\n[The threat actor is using Cova to distribute both SystemBC proxy bot and Nosu stealer.](https://www.bitsight.com/blog/systembc-multipurpose-proxy-bot-still-breathes)\nThe server where the Cova web panel is installed is also hosting a SystemBC panel.\nGiven the similarity between Cova and Nosu web panels, it is very likely that these two\nmalware families are developed by the same individual(s).\n\n## Cova overview\n\n\n-----\n\nDuring our research efforts to track the usage of the SystemBC proxy bot, we came across a\ncommand and control (C2) server that was hosting a web panel in the root of the http server\nwith \"Cova\" as the title. From there it didn't take us too long to find a sample with a PDB\nstring that matched the title of the web panel:\n\n_Figure 1 - PDB string (h/t_ _[PE-Bear)](https://github.com/hasherezade/pe-bear)_\nPDB's store symbols. When executables refer to PDB files it means they were compiled in\ndebug mode. This usually gives hints about the internal names of the projects and other\ninteresting details.\n\nAfter reverse engineering the sample, we concluded that this malware was in fact a loader\nthat waits for instructions to download additional malware into the infected system. Loaders\nare a type of malware whose sole purpose is to download and run other malware onto\ninfected systems. The process of successfully infecting systems with another malware is\noften referred to as “loads” and a loader's success is often measured by the number of loads\nit can provide as well as the quality of the infections.\n\nTo get further instructions, Cova sends a request to the C2 server every 15 minutes using a\nHTTP GET request to the following endpoint http://<c2 ip>/client.php?p=<encoded data>.\n\nTo build the data that goes into the p query parameter, the loader generates a bot ID based\non the value that is stored in the registry key Software\\Microsoft\\Cryptography under\nMachineGuid:\n\n\n-----\n\n_Figure 2 - Bot ID generation_\nNext, it collects the hostname and the username and builds a unicode string with the\nfollowing format: <computer name>||<username>||0||<random number computed with\nRtlRandomEx>||<bot ID>\n\nAs the final step, the loader builds a string with the hex values of the previous unicode string\ncontaining the data. For example, the string\nMYPC||user1||0||1749582054||11510924602506494874 is converted into\n4D005900500043007C007C00750073006500720031007C007C0030007C007C003100370034\n0039003500380032003000350034007C007C003100310035003100300039003200340036003\n0003200350030003600340039003400380037003400.\n\nThe C2 server response is always 648 bytes long and it contains an instruction for the bot.\nThe structure below shows the format of the C2 response:\n\n_Figure 3 - C2 response structure_\nExample of a parsed response:\n\n\n-----\n\n_Figure 4 - Parsed C2 response_\nCurrently, the loader supports the following commands:\n\n**ID** **Name** **Description**\n\n100 Idle Do nothing\n\n200 Update Download and execute an update\n\n300 Download and Execute Download executable file, drop to disk, and execute\n\n400 Parsed Dll Download and launch Dll (in memory)\n\nThe URLs from command ID 400 (Parsed Dll) retrieve a custom encoded DLL with some\nbootstrap code in it. The function below is responsible for parsing, decoding, and launching\nthe bootstrap code that will load and execute the DLL in memory:\n\n\n-----\n\n_Figure 5 - Encoded DLL parser_\nWe didn't have to figure out the encoding in detail given that the easiest solution was to build\na simple C loader that would take an encoded file as input and perform the same exact\noperations as the previous decoder function (Figure 5). From there it was easy to dump the\n[decoded DLLs from memory with a tool like PE-sieve.](https://github.com/hasherezade/pe-sieve)\n\n## Cova web panel\n\nThe web panel is very simple and allows the botnet operator to view all the bots, define\ntasks, and search/filter for specific bots.\n\n\n-----\n\n_Figure 6 - Cova login and panel_\n\n_Figure 7 - Cova panel task creation_\n\n\n-----\n\n_Figure 8 - Cova panel search_\n\n## Cova infections\n\nSince we started tracking this loader, we observed over 3700 infected systems pretty much\nworldwide but with much more impact in North and South American countries. The top 10\nmost affected countries are (in order) the United States, Brazil, Indonesia, Vietnam,\nPhilippines, Colombia, Mexico, Thailand, Argentina, and Chile.\n\n_Figure 9 - Geographic distribution of victims_\n\n\n-----\n\n## Cova loads Nosu\n\nDuring our research, we observed that the botnet operator has been using Cova to infect\nsystems with SystemBC proxy bot and a new malware named Nosu stealer. Nosu is capable\nof stealing credentials from various types of applications, browser cookies, crypto wallets,\nand stealing files from the infected systems. We also found that Nosu web panel is very\nsimilar to Cova panel suggesting that this might be work done by the same developer:\n\n_Figure 10 - Nosu stealer login and panel_\n\n## Conclusion\n\nWhile tracking the current usage of the SystemBC proxy bot, BitSight has discovered two\npreviously undocumented malware families being used in the wild. Cova is a tiny and simple\nloader but it seems capable of doing its job. On the other hand Nosu seems to be just\nanother stealer capable of providing the threat actor(s) with tons of information that can be\nmonetized.\n\nWe could see the similarities between the web panels of these two families and it seems very\nlikely that they are developed by the same individual(s). We'll keep an eye on these families\nand see how they evolve.\n\nIf you got curious about the SystemBC proxy bot have a look at our blog post where we\nexplain how it works: https://www.bitsight.com/blog/systembc-multipurpose-proxy-bot-stillbreathes\n\n## IOCs\n\n**C2 servers:**\n\n\n-----\n\n80.66.77[.]6 - Cova & SystemBC C2 server\n80.66.77[.]54 - Cova & SystemBC C2 server\n\n80.66.77[.]63 - Cova & SystemBC C2 server\n\n80.66.77[.]95 - Cova & SystemBC C2 server\n\n80.66.77[.]125 - Cova & SystemBC C2 server\n\n80.66.77[.]33 - Nosu stealer C2 server\n\n**File hashes:**\n\n11ffd58d2707121ab5363d6c08560a50d3209bf60dd4b8eec066eb4241aa7bee - Cova\n(packed)\n\nb0eaf0cc2f88701a216bb994a7bcbd43cb21ac11e295af9f99e6b56d6797ea01 - Cova\n(unpacked)\n\n8d6ba779eb230cb2f0f2db98179d5342f0d9f2cd74c7537d736ecea156195292 - Cova\n(packed)\n\na1ae4a7440c7f2f0d03c6f2e05ff97b875e8295cf2b340b96fdda919af6c7eb5 - Cova\n(unpacked)\n\n6499cadaea169c7dfe75b55f9c949659af49649a10c8b593a8db378692a11962 - Nosu stealer\n\nb369ed704c293b76452ee1bdd99a69bbb76b393a4a9d404e0b5df59a00cff074 - SystemBC\n(dropped by Cova)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-12-06 - Cova and Nosu- a new loader spreads a new stealer.pdf"
    ],
    "report_names": [
        "2022-12-06 - Cova and Nosu- a new loader spreads a new stealer.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536134,
    "ts_updated_at": 1743041137,
    "ts_creation_date": 1672273564,
    "ts_modification_date": 1672273564,
    "files": {
        "pdf": "https://archive.orkl.eu/c747f443f986d09f5bd17d7a7dd49daaf14de847.pdf",
        "text": "https://archive.orkl.eu/c747f443f986d09f5bd17d7a7dd49daaf14de847.txt",
        "img": "https://archive.orkl.eu/c747f443f986d09f5bd17d7a7dd49daaf14de847.jpg"
    }
}