{
    "id": "b8276d07-786d-462e-800b-6c04cb9633da",
    "created_at": "2023-01-12T15:07:50.697537Z",
    "updated_at": "2025-03-27T02:05:55.894096Z",
    "deleted_at": null,
    "sha1_hash": "1f8f8b8c48ac0172dbbe667955dfe5e09f5175c4",
    "title": "2011-08-29 - Aug 28 Morto - Tsclient - RDP worm with DDoS features",
    "authors": "",
    "file_creation_date": "2022-05-28T17:26:54Z",
    "file_modification_date": "2022-05-28T17:26:54Z",
    "file_size": 1133535,
    "plain_text": "# Aug 28 Morto / Tsclient - RDP worm with DDoS features\n\n**[contagiodump.blogspot.com/2011/08/aug-28-morto-tsclient-rdp-worm-with.html](http://contagiodump.blogspot.com/2011/08/aug-28-morto-tsclient-rdp-worm-with.html)**\n\nAccording to Microsoft, Morto is a worm that spreads by trying to compromise (lame)\nadministrator passwords for Remote Desktop connections on a network. They also note it\ncan perform Denial of Service attacks against attacker-specified targets.\n\nI can add that it runs what it looks like a quick DoS test against one Google IP. In addition, it\ncreates a lot of traffic: RDP scans, downloads, receiving commands, and interesting DNS\nqueries for command and control servers.\n\n\n-----\n\nJudging by the domain owners of CC servers (China) and their location (Hong Kong), I would\nsay it is likely it be cybercrimeware originating in erm,...Asia. I don't know how difficult it is for\na foreigner to register domains with Jiangsu Bangning Science & technology Co. Ltd.in\nChina. One of the domains existed for a few years and changed several Chinese registrars\nand hosting companies. Like in Russia, DDoS attack crimes are very common in China (I\ndon't have stats for other Asian countries but I am guessing common there too :)\n\nI want to thank [jsunpack.jeek.org and](http://jsunpack.jeek.org/) [malc0de.com for the sample.](http://malc0de.com/)\n\n## Exploit information and analysis links\n\n**[Windows Remote Desktop worm \"Morto\" spreading (F-Secure )](http://www.f-secure.com/weblog/archives/00002227.html)**\n\nExpert analysis has been done already and I won't repeat it. I ran the sample posted and it\ndoes what the links below describe\n\n**[Worm:Win32/Morto.A Analysis by Matt McCormack (Microsoft)](http://www.microsoft.com/security/portal/Threat/Encyclopedia/Entry.aspx?Name=Worm:Win32/Morto.A)**\n\n**Excerpt from Microsoft:**\n\nThe malware consists of several components, including an executable dropper\ncomponent (the installer), and a DLL component which performs the payload.\nWhen the dropper is executed, the DLL component is installed to the Windows\ndirectory as clb.dll. If updated by the malware, backups are created as clb.dll.bak.The\nexecutable component also writes encrypted code to the registry key\n_HKLM\\SYSTEM\\WPA\\md and exits._\nThe name clb.dll is chosen because it is the name of a real DLL (located in the System\ndirectory), which is used by regedit. To load this malware DLL, a regedit process is\nspawned by the malware. Once regedit is executed, it loads the malicious clb.dll\npreferentially over the real clb.dll due to the way in which Windows searches for files\n(i.e. the Windows directory is searched before the System directory). This dll has\nencrypted configuration information appended to it in order to download and execute\nnew components.\nThe following additional files are also created:\n\n_%windows%\\temp\\ntshrui.dll_\n\n_\\sens32.dll_\n\n_c:\\windows\\offline web pages\\cache.txt_\n\n**[Technet forum discussions](http://social.technet.microsoft.com/Forums/en-US/winserversecurity/thread/31cf740c-818c-4863-8df9-0d9a1d6de6fc)**\n\n**Some screenshots**\n\n**contents of cache.txt in offline web pages folder**\n\n\n-----\n\nThey may be replaced later on with malicious components which are\ndownloaded to:\n\n_c:\\windows\\offline web pages\\cache.txt_\n\n##  General File Information\n\n**MD5: 2eef4d8b88161baf2525abfb6c1bac2b**\n**File Type: EXE**\n**Infection Vector: RDP**\n\n## Download\n\n\n-----\n\nDownload 2eef4d8b88161baf2525abfb6c1bac2b and the created files as a password\n\nprotected archive (contact me if you need the password)\n**(with many thanks to** **[jsunpack.jeek.org and](http://jsunpack.jeek.org/)** **[malc0de.com)](http://malc0de.com/)**\n\n## Automated Scans\n\n**2eef4d8b88161baf2525abfb6c1bac2b.exe**\n\nResult:19 /44 (43.2%)\n\nhttp://www.virustotal.com/file-scan/report.html?\n[id=3d84a7395b23bc363a52a2028cea6cedb8ea4011ebc63865581c35aaa0da5da8-](http://www.virustotal.com/file-scan/report.html?id=3d84a7395b23bc363a52a2028cea6cedb8ea4011ebc63865581c35aaa0da5da8-1314609731)\n1314609731\n\nAhnLab-V3   2011.08.28.00   2011.08.29   Win-Trojan/Npkon.49969\n\nAntiVir   7.11.14.3   2011.08.29   TR/Agent.49969.1\n\nAvast   4.8.1351.0   2011.08.29   Win32:Malware-gen\n\nAvast5   5.0.677.0   2011.08.29   Win32:Malware-gen\n\nAVG   10.0.0.1190   2011.08.29   Agent3.ACOR\n\nByteHero   1.0.0.1   2011.08.22   Trojan.Win32.Heur.Gen\n\nComodo   9914   2011.08.29   TrojWare.Win32.Trojan.Agent.Gen\n\nDrWeb   5.0.2.03300   2011.08.29   BackDoor.Tsclient.1\n\nEmsisoft   5.1.0.10   2011.08.29   Trojan.Agent3!IK\n\nGData   22   2011.08.29   Win32:Malware-gen\n\nIkarus   T3.1.1.107.0   2011.08.29   Trojan.Agent3\n\nJiangmin   13.0.900   2011.08.28   Backdoor/DsBot.dov\n\nMicrosoft   1.7604   2011.08.29   Worm:Win32/Morto.gen!A\n\nNOD32   6418   2011.08.29   a variant of Win32/Agent.SYL\n\nPanda   10.0.3.5   2011.08.28   Trj/MereDrop.B\n\nSophos   4.68.0   2011.08.29   Mal/Generic-L\n\nTheHacker   6.7.0.1.286   2011.08.29   Trojan/Agent.syl\n\nViRobot   2011.8.29.4644   2011.08.29   Backdoor.Win32.DsBot.53076\n\nVirusBuster   14.0.189.0   2011.08.28   Trojan.Agent!MYoVp4jcZjs\n\nMD5  : 2eef4d8b88161baf2525abfb6c1bac2b\n\n**Created file**\n\nclb.dll\n\nSubmission date:2011-08-28 22:58:34 (UTC)\n\nResult:16 /44 (36.4%)\n\nhttp://www.virustotal.com/file-scan/report.html?\n\n\n-----\n\nid=c74b91699e916596884b3833d21825039cf1d200a244fc429341d7723ab1a5f61314572314\nAhnLab-V3   2011.08.27.01   2011.08.28   Win-Trojan/Agent21.Gen\nAntiVir   7.11.14.2   2011.08.28   TR/Agent.6672.5\nAvast   4.8.1351.0   2011.08.28   Win32:Malware-gen\nAvast5   5.0.677.0   2011.08.28   Win32:Malware-gen\nAVG   10.0.0.1190   2011.08.29   Agent3.AENL\nDrWeb   5.0.2.03300   2011.08.29   BackDoor.Tsclient.1\nEmsisoft   5.1.0.10   2011.08.28   Trojan.Agent3!IK\nFortinet   4.2.257.0   2011.08.28   W32/SvcLoad.AJE!tr\nGData   22   2011.08.29   Win32:Malware-gen\nIkarus   T3.1.1.107.0   2011.08.28   Trojan.Agent3\nMicrosoft   1.7604   2011.08.28   Worm:Win32/Morto.gen!A\nNOD32   6418   2011.08.29   Win32/Agent.SYL\nPanda   10.0.3.5   2011.08.28   Suspicious file\nSophos   4.68.0   2011.08.28   Troj/SvcLoad-A\nTheHacker   6.7.0.1.286   2011.08.29   Trojan/Agent.syl\nVIPRE   10300   2011.08.29   Trojan.Win32.Generic!BT\nMD5  : eb19e7a8cd7dee563a2b7477a7b9037f\n\n## Traffic\n\nAs you already noted, it is a worm capable of spreading through local area network. Please\nremember this when running it on a VM attached to any LAN. Take appropriate measures to\nprevent it from spreading.\n\nFrom what I see, it performs DNS queries using servers that are not in the victim's TCP/IP\nconfiguration\n\n\n-----\n\nAccording to Microsoft (and the samples they analysed ), morto\n\n**Contacts remote host**\n_Worm:Win32/Morto.A connects to the following hosts in order to download additional_\ninformation and update its components:\n_210.3.38.82_\n_74.125.71.104_\n_jifr.info_\n_jifr.co.cc_\n_jifr.co.be_\n_qfsl.net_\n_qfsl.co.cc_\n_qfsl.co.be_\nNewly downloaded components are downloaded to a filename that uses the following\nformat:\n_~MTMP ;4 digits 0-f ;.exe_\n**Performs Denial of Service attacks**\nMorto may be ordered to perform Denial of Service attacks against attacker-specified\ntargets.\n\nI have a few additional similar domains\n\nThe list of recorded domains and IPs (see additional/slightly different list in the Microsoft\n\n\n-----\n\nanalysis)\n\n**111.68.13.250 =** **[qfsl.net ASIA PACIFIC SERVER COMPANY, Hong Kong -- orders to](http://www.robtex.com/dns/qfsl.net.html)**\nperform DDoS test\n**210.3.38.82 Hutchison Global Communications, Hong Kong - Location from where**\n160.rar gets downloaded\n**hx-in-f104.1e100.net =Google.com 74.125.71.104/74.125.115.106 - DoS test is on**\nGoogle.com (Google won't \"feel\" it, it is not really \"an attack on Google\")\n\nDomains\n\n**fb1.jifr.net**\n**fb2.jifr.net**\n**db1.jifr.net**\n**db2.jifr.net**\n**dostest1.qfsl.net**\n\n**and etc. as listed on the screenshot below**\n\nDNS used (no changes made in TCP/IP settings)\n\nvictim's preferred DNS\n**212.76.127.133       Internet Rimon LTD, Israel**\n**64.68.200.200        easyDNS Technologies, Inc. Toronto**\n**156.154.71.1         NeuStar, Inc., VA - USA**\n**8.8.8.8              Google DNS**\n**209.166.160.36      CONTINENTAL BROADBAND PENNSYLVANIA, INC.**\n**210.220.163.82       SK Broadband Co Ltd, Korea**\n**4.2.2.2              Level 3 Communications, Inc**\n**202.238.96.2         So-net service, Japan**\n**203.172.246.41      Ministry of Education Network Operation Center, Thailand**\n**205.171.3.65        Qwest Communications Company, LLC**\n**210.196.3.183       DION (KDDI CORPORATION)**\n**163.180.96.54       Kyung Hee University**\n**202.207.184.3       North China Institute Of Technology**\n**168.210.2.2         Dimension Data, South Africa**\nand perhaps others - see the screenshot\n\n\n-----\n\n=======================================\n\n**210.3.38.82  -** **[http://malc0de.com/database/index.php?search=210.3.38.82&IP=on](http://malc0de.com/database/index.php?search=210.3.38.82&IP=on)**\nHost reachable, 284 ms. average\n\n210.3.0.0 - 210.3.127.255\n\nHutchison Global Communications\n\nHong Kong\n\nITMM HGC\n\nhgcnetwork@hgc.com.hk\n\n9/F Low Block,\n\nHutchison Telecom Tower,\n\n99 Cheung Fai Rd, Tsing Yi,\n\nHONG KONG\n\nphone: +852-21229555\n\nfax: +852-21239523\n\n\n-----\n\n**Downloading 160.rar (MD5: 4E69179BB79DE93584E87C4763F6C664 ) = same file that**\n**Microsoft describes as**\n\nNewly downloaded components are downloaded to a filename that uses the following\nformat:\n_~MTMP 4 digits 0-f.exe_\n\nIn my case, these were created and deleted from C\\WINDOWS\\Temp\n**Size: 54496**\n**MD5: 4E69179BB79DE93584E87C4763F6C664**\n~MTMP3C32.exe\n~MTMP4F62.exe\n~MTMP6006.exe\n~MTMP9B40.exe\n~MTMPA327.exe\n\nHowever, they do not seem to have valid PE headers\n\nhttp://www.virustotal.com/file-scan/report.html?\nid=f9a12ac987d7737024df78471169d56c1225f31254d3914af8e16a3bbf32daaf-1314580097\n\n[EDIT] See the comments after the post. The file is actually a DLL\n\nSize: 54484\nMD5: EBB3A5964DA485C0B9E67164B047A7A5\n\n\n-----\n\nMachine           014Ch    i386Â®\nNumber of Sections      0004h\nTime Date Stamp       4E536606h  23/08/2011 08:34:14\nPointer to Symbol Table   00000000h\nNumber of Symbols      00000000h\nSize of Optional Header   00E0h\nCharacteristics       210Eh    The file is executable (no unresolved external\nreferences)\nLine numbers are stripped from the file\nLocal symbols are stripped from the file\nComputer supports 32-bit words\nThe file is a dynamic link library (DLL)\nMagic            010Bh    PE32\nLinker Version        0006h    6.0\nSize of Code         00001000h\nSize of Initialized Data   00000A00h\nSize of Uninitialized Data  00000000h\nAddress of Entry Point    10001D6Ah\nBase of Code         00001000h\nBase of Data         00002000h\nImage Base          10000000h\nSection Alignment      00001000h\nFile Alignment        00000200h\nOperating System Version   00000004h  4.0\nImage Version        00000000h  0.0\nSubsystem Version      00000004h  4.0\nWin32 Version Value     00000000h  Reserved\nSize of Image        00005000h  20480 bytes\nSize of Headers       00000400h\nChecksum           00000000h  Real Image Checksum: 0001B115h\nSubsystem          0002h    Win32 GUI\nDll Characteristics     0000h\nSize of Stack Reserve    00100000h\nSize of Stack Commit     00001000h\nSize of Heap Reserve     00100000h\nSize of Heap Commit     00001000h\nLoader Flags         00000000h  Obsolete\nNumber of Data Directories  00000010h\n\nhttp://www.virustotal.com/file-scan/report.html?\n[id=2aa8bd7268bac0681da9b5d2019ae678b9ed28f643995ac7a68d8ad4cac780b8-](http://www.virustotal.com/file-scan/report.html?id=2aa8bd7268bac0681da9b5d2019ae678b9ed28f643995ac7a68d8ad4cac780b8-1314701651)\n1314701651\n\n\n-----\n\n=======================================\n\n**hx-in-f104.1e100.net - Google.com 74.125.71.104 or vx-in-f106.1e100.net 74.125.115.106**\nin another test\n\nTraffic to Google (DoS test). The response is Error 400 - invalid request.\n_That...s an error. Your client has issued a malformed or illegal request. That...s all we know._\n\n\n-----\n\n=======================================\n\n**qfsl.net**\nAdministrative Contact:\nDOMAIN WHOIS PROTECTION SERVICE\nWHOIS AGENT domian@whoisprotectionservices.net\n\n+86 02586880037 fax: +86 02586880037\n\n\n-----\n\n10F West-Building, Yuhua Software Park, 310 Ningnan Road, Yuhua District\nNanjing Jiangsu 210012\nCN\n\n\n-----\n\n**Registrar History**\n\nDate Registrar\n\n2003-01-28 [INWW.com](http://www.melbourneit.com/)\n\n2005-11-23 [DirectNic.com](http://www.directnic.com/)\n\n2006-03-22 Bizcn.com\n\n2008-06-14 eNom GMP Services\n\n2010-05-03 Jiangsu Bangning Science & technology Co. Ltd.\n\n## IP Address History\n\nEvent Date Action Pre-Action IP Post-Action IP\n\n2005-02-12 Not Resolvable [213.161.76.87](http://whois.domaintools.com/213.161.76.87) -none\n2006-03-24 New -none- [61.152.93.70](http://whois.domaintools.com/61.152.93.70)\n\n2006-06-24 Not Resolvable [61.152.93.70](http://whois.domaintools.com/61.152.93.70) -none\n2006-10-21 New -none- [61.152.93.70](http://whois.domaintools.com/61.152.93.70)\n\n2007-02-24 Change [61.152.93.70](http://whois.domaintools.com/61.152.93.70) [210.95.31.4](http://whois.domaintools.com/210.95.31.4)\n\n2008-03-30 Not Resolvable [210.95.31.4](http://whois.domaintools.com/210.95.31.4) -none\n2008-03-31 New -none- [209.62.72.197](http://whois.domaintools.com/209.62.72.197)\n\n2008-04-13 Change [209.62.72.197](http://whois.domaintools.com/209.62.72.197) [124.42.34.171](http://whois.domaintools.com/124.42.34.171)\n\n2008-05-04 Not Resolvable [124.42.34.171](http://whois.domaintools.com/124.42.34.171) -none\n2008-06-13 New -none- [69.64.155.79](http://whois.domaintools.com/69.64.155.79)\n\n2008-06-15 Change [69.64.155.79](http://whois.domaintools.com/69.64.155.79) [69.64.155.136](http://whois.domaintools.com/69.64.155.136)\n\n2008-06-22 Change [69.64.155.136](http://whois.domaintools.com/69.64.155.136) [69.64.155.132](http://whois.domaintools.com/69.64.155.132)\n\n2008-11-16 Change [69.64.155.132](http://whois.domaintools.com/69.64.155.132) [69.64.147.18](http://whois.domaintools.com/69.64.147.18)\n\n2009-03-09 Change [69.64.147.18](http://whois.domaintools.com/69.64.147.18) [69.64.147.212](http://whois.domaintools.com/69.64.147.212)\n\n2009-03-30 Change [69.64.147.212](http://whois.domaintools.com/69.64.147.212) [69.64.147.213](http://whois.domaintools.com/69.64.147.213)\n\n2009-04-06 Change [69.64.147.213](http://whois.domaintools.com/69.64.147.213) [69.64.147.212](http://whois.domaintools.com/69.64.147.212)\n\n\n-----\n\n2009-04-20 Change [69.64.147.212](http://whois.domaintools.com/69.64.147.212) [69.64.147.213](http://whois.domaintools.com/69.64.147.213)\n\n2009-04-27 Change [69.64.147.213](http://whois.domaintools.com/69.64.147.213) [69.64.147.212](http://whois.domaintools.com/69.64.147.212)\n\n2009-07-27 Not Resolvable [69.64.147.212](http://whois.domaintools.com/69.64.147.212) -none\n2010-05-04 New -none- [210.51.7.236](http://whois.domaintools.com/210.51.7.236)\n\n2010-05-23 Change [210.51.7.236](http://whois.domaintools.com/210.51.7.236) [59.188.19.76](http://whois.domaintools.com/59.188.19.76)\n\n2010-10-15 Change [59.188.19.76](http://whois.domaintools.com/59.188.19.76) [58.14.38.169](http://whois.domaintools.com/58.14.38.169)\n\n2010-11-17 Change [58.14.38.169](http://whois.domaintools.com/58.14.38.169) [113.128.1.80](http://whois.domaintools.com/113.128.1.80)\n\n2011-04-10 New -none- [113.128.1.80](http://whois.domaintools.com/113.128.1.80)\n\n2011-05-03 Change [113.128.1.80](http://whois.domaintools.com/113.128.1.80) [113.128.223.131](http://whois.domaintools.com/113.128.223.131)\n\n2011-07-03 Change [113.128.223.131](http://whois.domaintools.com/113.128.223.131) [0.0.0.0](http://whois.domaintools.com/0.0.0.0)\n\n2011-08-10 Not Resolvable [0.0.0.0](http://whois.domaintools.com/0.0.0.0) -none\n**jifr.net**\n\nRegistrant Contact:\n\njian fan ren\n\nfan ren jian j@163.com\n\n+86.01015215412 fax: +86.01012111111\n\nchang an lu 113 hao\n\nma an san an hui 111111\n\nCN\n\n**Registrar History**\n\nDate Registrar\n\n2011-07-21 Jiangsu Bangning Science & technology Co. Ltd.\n\n## IP Address History\n\nWe have no record of any IP changes.\n\n**111.68.13.250 =** **[qfsl.net ASIA PACIFIC SERVER COMPANY, Hong Kong -- orders to](http://www.robtex.com/dns/qfsl.net.html)**\nperform DoS test\n\n=======================================\n\n**111.68.13.250**\n\n\n-----\n\n111.68.0.0 - 111.68.15.255\nHollywood Plaza, 610 Nathan Road\nHong Kong\nASIA PACIFIC SERVER COMPANY - network administrato\nHollywood Plaza, 610 Nathan Road, Mong Kong, KLN\nphone: +85263419611\nnetwork@apacserver.com\n\n**[Qfsl.net point to](http://www.robtex.com/dns/qfsl.net.html)** [111.68.13.250.](http://www.robtex.com/ip/111.68.13.250.html)\n\nRegistrant Contact:\nDOMAIN WHOIS PROTECTION SERVICE\nWHOIS AGENT domian@whoisprotectionservices.net\n+86.02586880037 fax: +86.02586880037\n10F West-Building, Yuhua Software Park, 310 Ningnan Road, Yuhua District\nNanjing Jiangsu 210012\nCN\n\nCreated files\nC:\\WINDOWS\\Offline Web Pages\\1.40_TestDdos - see this in the screenshot below - 6th\nline from the top\nC:\\WINDOWS\\Offline Web Pages\\1.60_0823\nC:\\WINDOWS\\Offline Web Pages\\2011-08-29 0234\nC:\\WINDOWS\\Offline Web Pages\\cache.txt TCP traffic from [111.68.13.250.](http://www.robtex.com/ip/111.68.13.250.html)\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2011/2011-08-29 - Aug 28 Morto - Tsclient - RDP worm with DDoS features.pdf"
    ],
    "report_names": [
        "2011-08-29 - Aug 28 Morto - Tsclient - RDP worm with DDoS features.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536070,
    "ts_updated_at": 1743041155,
    "ts_creation_date": 1653758814,
    "ts_modification_date": 1653758814,
    "files": {
        "pdf": "https://archive.orkl.eu/1f8f8b8c48ac0172dbbe667955dfe5e09f5175c4.pdf",
        "text": "https://archive.orkl.eu/1f8f8b8c48ac0172dbbe667955dfe5e09f5175c4.txt",
        "img": "https://archive.orkl.eu/1f8f8b8c48ac0172dbbe667955dfe5e09f5175c4.jpg"
    }
}