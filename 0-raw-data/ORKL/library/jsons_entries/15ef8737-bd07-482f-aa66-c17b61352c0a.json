{
    "id": "15ef8737-bd07-482f-aa66-c17b61352c0a",
    "created_at": "2023-01-12T15:06:10.193202Z",
    "updated_at": "2025-03-27T02:05:47.128537Z",
    "deleted_at": null,
    "sha1_hash": "252eb1c317fe2fcff38c587ed0543269d5a93989",
    "title": "2021-07-27 - Oscorp evolves into UBEL- an advanced Android malware spreading across the globe",
    "authors": "",
    "file_creation_date": "2022-05-27T22:51:39Z",
    "file_modification_date": "2022-05-27T22:51:39Z",
    "file_size": 8566897,
    "plain_text": "# Oscorp evolves into UBEL\n\n**cleafy.com/cleafy-labs/ubel-oscorp-evolution**\n\nFederico Valentini, Francesco Iubatti\n\n## Download your PDF guide to TeaBot \n\nGet your free copy to your inbox now\n\nDownload PDF Version\n\n## Key Points\n\nBack in February 2021 a smishing campaign was detected distributing Oscorp, a new\nAndroid malware at that time. The main goal of that campaign was stealing funds from\nthe victims' home banking service, by combining the usage of phishing kits and vishing\ncalls\n**Oscorp has been developed to attack multiple financial targets (both banks and crypto**\ncurrency apps) and its main features are the following:\n\no  Ability to send/intercept/delete SMS and make phone calls\n\no  Ability to perform Overlay Attacks for more than 150 mobile applications\n\no  VNC feature through WebRTC protocol and Android Accessibility Services\n\no  Enabling key logging functionalities\n\n\n-----\n\nOnce Oscorp is successfully installed in the victim s device, it enables Threat Actors\n(TAs) to remotely connect to it via WebRTC protocol. In some cases, we found a\nspecific Threat Actor (TA) leveraging on fake bank operators to persuade victims over\nthe phone while performing unauthorized bank transfers in the background.\nAfter an apparent stop of the initial activities, during May 2021, new Oscorp samples\nhave been found in the wild, with some minor changes; at the same time, on multiple\nhacking forums, a new Android botnet known as UBEL started being promoted.\nWe found multiple indicators linking Oscorp and UBEL to the same malicious\ncodebase, suggesting a fork of the same original project or just a rebrand by other\naffiliates, as its source-code appears to be shared between multiple TAs.\n\n## Overview\n\nAt the end of January 2021, a new Android malware started appearing and it was dubbed as\n**Oscorp** [[1]. During February 2021, a new version of Oscorp was detected by Cleafy systems](https://cert-agid.gov.it/news/individuato-sito-che-veicola-in-italia-un-apk-malevolo/)\nand after a couple of hours a first incident related to this threat was reported to us.\n\n**Thanks to the data retrieved plus an in-depth technical analysis of the distributed**\n**Oscorp samples we were able to reconstruct the detailed chain of events and share all**\n**the methodologies used by a specific TA for conducting bank frauds via ATO (Account**\n**Takeover fraud).**\n\nThe following list include some of the high-level indicators we extracted in our recent\nanalysis:\n\nEU retail banks appear to be among the targets of this specific TA, and multiple\nincidents have already been confirmed. Since the list of targets also includes banks\nand financial institutions from US, JP, AU (see the affected countries in the Appendix 4)\nwe don’t exclude that other local TAs might be using the same attack vector (Oscorp) to\ncarry over other malicious activities.\nPhishing campaigns were distributed via SMS messages (smishing), a common tactic\nnowadays for retrieving valid credentials and phone numbers\nA fake bank operator conducts attacks in real-time by persuading victims over the\nphone (vishing), a common tactic typically used for bypassing multi-factor\nauthentication (e.g. OTP codes).\nOscorp appears to be distributed by this TA for gaining full remote access to the\ninfected mobile device and performing unauthorized bank transfers from the infected\ndevice itself, drastically reducing their footprint since a new device enrollment is\n**not required in this scenario.**\nInstant Payments appears to be the most popular cash-out mechanism mainly routed\nthrough a network of money mules. We don’t exclude other cash-out mechanisms (e.g.\nvirtual cards generation, prepaid cards recharge, card-less ATM, etc..) since those\nservices are quite common on modern retail banks services\n\n\n-----\n\nThe following image shows the timeline of captured events describing how this TA managed\nto retrieve valid banking credentials via smishing and successfully deliver Oscorp to the\nvictim device for performing an ATO fraud scenario directly from its infected device:\n\nFigure 1 – Timeline of events retrieved from this new Oscorp campaign\nMoving to the malware internals, we were able to extract multiple features of Oscorp which\nare mainly achieved by abusing the Android Accessibility services, a well-known technique\n[used by the other families as well (e.g. Anubis, Cerberus/Alien, TeaBot [2],etc..).](https://www.cleafy.com/cleafy-labs/teabot)\n\nThe following snippet of code contains all the remote commands found in the Oscorp source\ncode:\n\nFigure 2 – List of Oscorp commands\nAll the commands are encrypted through an AES routine, a well-known technique used by\nmalware authors for slowing down analysts.\n\nThe complete list of commands found in Oscorp is available on Appendix 1.\n\n\n-----\n\nAfter an apparent stop of the initial activities, during May/June 2021, new Oscorp samples\nhave been found in the wild, with some minor changes; at the same time, on multiple hacking\nforums, a new Android botnet known as UBEL started being promoted.\n\nBy analyzing some related samples, we found multiple indicators linking Oscorp and UBEL\nto the same malicious codebase, suggesting a fork of the same original project or just a\nrebrand by other affiliates, as its source-code appears to be shared between multiple TAs.\n\nFigure 3 – UBEL private Android botnet threads found on multiple hacking forums\n\nFigure 4 – Video demo of UBEL botnet and its C2 interaction\nAfter a couple of weeks, we also noticed that the multiple UBEL clients started accusing\nthem of scamming, as it appeared not to work on some specific Android devices, contrary to\nwhat the TA claimed initially.\n\nOne of those clients, after some debate, released some videos as proof of its claims without\nproperly anonymize them, exposing a valid C2 addresses, as shown:\n\n\n-----\n\nFigure 5 – Oscorp sample communicating with omegabots[.xyz\nAnother interesting links between Oscorp and UBEL, is the “bot id” string format, which\nconsist in an initial “RZ-” substring followed by some random alphanumeric characters, as\nshown in another demo video posted online:\n\nFigure 6 – Same “bot id” string prefix “RZ-” shared between Oscorp and UBEL\nAlso, on those newer Oscorp samples (linked to UBEL) we were able to identify different API\nendpoints and different AES keys compared to the initial waves spotted at the very first of\n2021, which will be described in the next section.\n\n\n-----\n\nFigure 7 – Some new C2 path used by UBEL\n\n## Static Analysis\n\nThe following image shows a snippet of the AndroidManifest file:\n\n\n-----\n\nFigure 8 – List of permissions declared in theAndroidManifest.xml file\nIn the following table we included the most interesting permissions requested by Oscorp for\ngetting access to restricted parts of the Android system (e.g. READ_SMS, SEND_SMS) or\nother legitimate applications (e.g. BIND_ACCESSIBILITY_SERVICE):\n\n**SYSTEM_ALERT_WINDOW: Allows an app to create windows shown on top of all**\nother apps. Very few apps should use this permission; these windows are intended for\nsystem-level interaction with the user. Oscorp uses this permission during the\ninstallation phase to force the user to accept the Accessibility permission.\n**RECORD_AUDIO: Allows an app to record audio**\n**READ_SMS: Allows an app to send SMS messages**\n**SEND_SMS:Allows an app to send SMS messages**\n**RECEIVE_SMS: Allows an app to receive SMS messages**\n**REQUEST_INSTALL_PACKAGES: Allows an application to request**\ninstalling packages\n**REQUEST_DELETE_PACKAGES: Allows an application to request deleting packages**\n\n**RECEIVE_BOOT_COMPLETED: Allows an app to launch itself automatically after**\nsystem boot. Oscorp uses this permission to achieve persistence on the device and run\nin the background as an Android service.\n\n\n-----\n\n**BIND_ACCESSIBILITY_SERVICE:** _Accessibility services should only be used to_\n_assist users with disabilities in using Android devices and apps. They run in the_\n_background and receive callbacks by the system when AccessibilityEvents are fired._\n_Such events denote some state transition in the user interface, for example, the focus_\n_has changed, a button has been clicked, etc. Such a service can optionally request the_\n_[capability for querying the content of the active window.”[3] However, Oscorp abused](https://developer.android.com/reference/android/accessibilityservice/AccessibilityService)_\nthis permission to observe and retrieve information on the compromised device\n\nOscorp implements a couple of techniques to slow down static analysis, such as:\n\n[all the strings are obfuscated using an open-source implementation [4] but some](https://github.com/MichaelRocks/paranoid)\nstrings (e.g. bot’s commands, API endpoints, etc.) are also encrypted with AES and\nbase64 encoding.\nnetwork communication between Oscorp and C2 are encrypted using only the AES\nalgorithm and base64 encoding on top of regular HTTP(s).\n\nFigure 9 – Oscorp encryption routine\n**Moreover, strings obfuscation appears to be introduced only on certain samples of**\n**Oscorp[5], sharing the same routine used by Cabassous (Flubot), another Android banking**\nmalware.\n\nFigure 10 – Comparing encryption routines of Oscorp and Cabassous\n\n\n-----\n\nFigure 11 – Network traffic encryption routines (AES algorithm)\n\n## WebRTC – Web Real-Time Communication\n\n_“WebRTC (Web Real-Time Communication) is a free, open-source project providing_\n_web browsers and mobile applications with real-time communication (RTC) via simple_\n_application programming interfaces (APIs). It allows audio and video communication to_\n_work inside web pages by allowing direct peer-to-peer communication, eliminating the_\n_need to install plugins or download native apps. The technologies behind WebRTC are_\n_implemented as an open web standard and available as regular JavaScript APIs in all_\n_major browsers. For native clients, like Android and iOS applications, a library is_\n_available that provides the same functionality.”_ _[[6]](https://webrtc.org/)_\n\n**We assume that Oscorp integrated WebRTC for achieving a real-time interaction with**\n**the compromised device combined with the abuse of Android Accessibility Services**\n**bypassing the need of a “new device enrollment” to perform an Account Take over**\n**scenario (ATO).**\n\nIn fact, the authors named this feature as ‘Reverse VNC’ (or RPM) on their C2 web-panel\nsince a reverse connection is necessary for bypassing NAT or firewall restrictions and live\ninteraction with the device can be achieved via Android Accessibility Services.\n\n\n-----\n\nFigure 12 – ‘Reverse VNC’ function which enable WebRTC remote connection\n**The main goal for this TA by using this feature, is to avoid a “new device enrollment”,**\n**thus drastically reducing the possibility of being flagged ‘as suspicious’ since**\n**device’s fingerprinting indicators are well-known from the bank’s perspective.**\n\nFigure 13 – Views of the UBEL C2 panel during a “Reverse VNC/RPM” attack\n\n## Dynamic Analysis\n\nWhen the malicious application has been downloaded on the device, it tries to be installed\n**as an “Android Service”, which is an application component that can perform long-running**\noperations in the background.\n\n**This feature is abused by the Oscorp to silently hide itself from the user, once**\n**installed, also preventing detection, and ensuring its persistence.**\n\nDuring some campaigns spotted early in 2021, they switched the name of the malicious\napplication from “Android System” to “Protezione Clienti” app (Figure 15):\n\n\n-----\n\nFigure 14 – Screenshots taken during installation phase of Oscorp\n\nFigure 15 – Application names used by Oscorp\nAfter the installation as “Android Service”, Oscorp will request the following permissions,\nwhich are mandatory to perform its malicious behavior:\n\n**Observe your actions:**\n\nUsed to intercept and observe the user action.\n**Retrieve window content:**\n\nUsed to retrieve sensitive information such as login credentials, SMS, two factor\nauthentication (2FA) codes from authenticators, etc.\n**Perform arbitrary gestures:**\n\nOscorp uses this feature to accept different kinds of permissions, immediately after the\ninstallation phase, for example the REQUEST_IGNORE_BATTERY_OPTIMIZATIONS\npermission popup, but also perform different actions during the interaction with the\n**compromised device through the WebRTC protocol.**\n\n\n-----\n\nFigure 16 – List of Android permissions requested by Oscorp to the user\nOnce the requested permissions have been accepted, the malicious application will remove\nits icon from the device, and it immediately starts communicating with its C2 server in the\nbackground.\n\nNetwork communications performed by Oscorp to its C2 server are encrypted with the AES\nalgorithm and at the very first it tries to send all overall information of the newly infected\ndevice, such as vendor, public IP address, list of the installed apps, SMS messages, action\nperformed by the user, etc.\n\n\n-----\n\nThe next figure is an example of a communication intercepted between Oscorp and its C2\nserver where the list of all the installed application was sent:\n\nFigure 17 – Example of network communication intercepted between Oscorp and its C2\nserver\nOscorp can also abuse the Android Accessibility Services to capture and retrieve whatever is\non the screen of the device, for example:\n\n2FA codes (e.g. OTP) generated by banking applications during login authentication\nand while signing new bank transfers (e.g. instant payments, SEPA transfers, etc.)\nIntercepting notification and SMS messages\nPerforming Overlay attacks (described in the Appendix 2)\nEnabling a full interaction with the infected device (e.g. sending arbitrary clicks on\nscreen, opening arbitrary applications already installed, etc.)\n\nThe following figure shows how a new SMS received will be intercepted by Oscorp and send\nback to the designed C2 server:\n\n\n-----\n\nFigure18 – Example of SMS intercepted by Oscorp\n\n## Appendix\n\nAppendix 1: list of bots’ commands\n\nBelow is the summary list of all the bot commands found on Oscorp:\n\n**_toast: Show a simple feedback about an operation in a small popup._**\n**_send_message: Send an SMS message_**\n**_stock_injection: Save the injections (phishing html payload) provided by C2 in the_**\nJedi / Injections.txt file\n**_forward_call: Call forwarding through the code *21* + number + ##_**\n**_run_application: Run an application_**\n**_enab_sil: Mute the device (set to 0 the volume level of the device)_**\n**_switch_sms: Change the default SMS application with Oscorp (through_**\nandroid.provider.Telephony.ACTION_CHANGE_DEFAULT)\n**_remove_injection: Remove an injection_**\n**_2FA: Launch the Google 2FA app (then Oscorp is able to steal the codes abusing the_**\nAccessibility service)\n**_make_call: Perform a call to someone_**\n**_dev_admin: Set itself as admin app_**\n**_run_ussd: Allows itself to initiate a phone call without going through the Dialer user_**\ninterface for the user to confirm the call\n**_block: Save the apps to be blocked in Jedi / block.txt and start MyService_**\n**_launch_url: Launch and URL_**\n**_fetch_applications: Get the list of installed apps_**\n**_delete_message: Remove an SMS_**\n**_delete_application: Remove an application_**\n\n\n-----\n\n**_batt_opt: Insert Oscorp app to a list of apps that ignore optimization battery_**\n**_url_injection: Start the “ramp” class used to perform stream video of the screen and_**\naudio of the compromised device\n**_screencap: start to record the audio and video through the WebRTC and STUN_**\nprotocols (the stun server are embedded in the code)\n\nAppendix 2: Overlay Attack’s technique\n\n“The Overlay attack is a well-known technique implemented on modern Android banking\ntrojans (e.g. Anubis, Cerberus/Alien) which consist of a malicious application somehow able\nto perform actions on behalf of the victim. This usually takes the form of an imitation app or a\nWebView launched “on-top” of a legitimate application (such as a banking app).”\n\n**During our analysis we were able to extract more than 150 targeted applications.**\n\nThe complete list of the geographical distribution of banks and other app targeted by Oscorp\ntargeted apps is available in the Appendix 4.\n\nFigure 19 – Some payloads used by Oscorp for “Overlay Attacks”\n\n\n-----\n\nAll the injections payloads which consist mainly of HTML, CSS and JS files, will be\ndownloaded from the C2 server in a specific directory called\n\n**_YTrJWNMmHkAPfdWA4QsfPwufCBhpYGbG.**\n\nWhen this feature is requested remotely by the TA, if the victim opens one of the targeted\napplications, it will get the injection payload shown in a WebView launched ‘on top’ of the\nlegitimate application.\n\nFigure 20 – C2 path used to download stock injections payload for Overlay Attacks\nIn addition, analyzing one of the web-panel used by this TA, it is also possible to reconstruct\nthis distinction among the different categories of targeted applications, such as:\n\nFigure 21 – Different types of targeted applications (Overlay Attacks)\n\n\n-----\n\nAppendix 3: Extracted IOCs\n\n**Md5**\n0d1df5c35c3c43e1b8bb7daec2495c06\nf73ebc6f645926bf8566220b14173df8\neaf0524ba3214b35a068465664963654\ndaba8377d281c48c1c91e2fa7f703511\n1d848ba69a966f9f0ebe46bcb89a10c4\n8daf9ba69c0dcf9224fd1e4006c9dad3\nde51b859f41b6a9138285cf26a1fad84\n\n**App names**\nProtezione Cliente\nAndroid System\ndeneme\n\n**Package names**\ncom.cosmos.starwarz\ncom.cosmos.starwarz\ncom.mapwqpdox201q.pla203eoaowpzmka\nycpgmsxy.rqhfesas\n\n**C2 Domains**\nmontanatony[.xyz\nmarcobrando[.xyz\nquantumbots[.xyz\nsmoothcbots[.xyz\nomegabots[.xyz\ncallbinary.xyz\ngogleadser.xyz\n\n**Stock injection path**\n/_YTrJWNMmHkAPfdWA4QsfPwufCBhpYGbG/LFwbkjNthZk9jDtvADjnS7FyUPcjKPpb_/\n\n**AES keys**\nRHBuUXFEhkrbrHaYIZ6VYH3uNIBRnwTe\n8HCTSX7IcbAkItzuS34zaVqUs4dMKSqV\n\nIn addition, The Android Banking Trojan Oscorp/Ubel is already classified and blacklisted in\nour Threat Intelligence data with the following tags:\n\n**ASK_BANKER_ANDROID_OSCORP_V1**\n**ASK_BANKER_ANDROID_OSCORP_V2**\n\n\n-----\n\nAppendix 4: Geographical distribution of banks and other app targeted by Oscorp\n\nFigure 22 – Geographical distribution of banks and other app targeted by OSCORP\n\n[1] [https://cert-agid.gov.it/news/individuato-sito-che-veicola-in-italia-un-apk-malevolo/](https://cert-agid.gov.it/news/individuato-sito-che-veicola-in-italia-un-apk-malevolo/)\n\n[2] [https://www.cleafy.com/cleafy-labs/teabot](https://www.cleafy.com/cleafy-labs/teabot)\n\n[3] [https://developer.android.com/reference/android/accessibilityservice/AccessibilityService](https://developer.android.com/reference/android/accessibilityservice/AccessibilityService)\n\n[4] [https://github.com/MichaelRocks/paranoid](https://github.com/MichaelRocks/paranoid)\n\n[5] Name:“secureapp.apk” MD5: daba8377d281c48c1c91e2fa7f703511\n\n[6] [https://webrtc.org/](https://webrtc.org/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-07-27 - Oscorp evolves into UBEL- an advanced Android malware spreading across the globe.pdf"
    ],
    "report_names": [
        "2021-07-27 - Oscorp evolves into UBEL- an advanced Android malware spreading across the globe.pdf"
    ],
    "threat_actors": [
        {
            "id": "bfded1cf-be73-44f9-a391-0751c9996f9a",
            "created_at": "2022-10-25T15:50:23.337107Z",
            "updated_at": "2025-03-27T02:00:55.445946Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "FIN7",
                "GOLD NIAGARA",
                "ITG14",
                "Carbon Spider",
                "ELBRUS",
                "Sangria Tempest"
            ],
            "source_name": "MITRE:FIN7",
            "tools": [
                "Mimikatz",
                "AdFind",
                "JSS Loader",
                "HALFBAKED",
                "REvil",
                "PowerSploit",
                "CrackMapExec",
                "Carbanak",
                "Pillowmint",
                "Cobalt Strike",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRat",
                "Lizar",
                "TEXTMATE",
                "BOOSTWRITE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "bb8702c5-52ac-4359-8409-998a7cc3eeaf",
            "created_at": "2023-01-06T13:46:38.405479Z",
            "updated_at": "2025-03-27T02:00:02.82533Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "JokerStash",
                "ATK32",
                "G0046",
                "Coreid",
                "Carbanak",
                "Sangria Tempest",
                "CARBON SPIDER",
                "GOLD NIAGARA",
                "G0008",
                "ELBRUS",
                "Carbon Spider"
            ],
            "source_name": "MISPGALAXY:FIN7",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d85adfe3-e1c3-40b0-b8bb-d1bacadc4d82",
            "created_at": "2022-10-25T16:07:23.619566Z",
            "updated_at": "2025-03-27T02:02:09.890982Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "APT-C-11",
                "ATK 32",
                "Gold Niagara",
                "ITG14",
                "TAG-CR1"
            ],
            "source_name": "ETDA:FIN7",
            "tools": [
                "7Logger",
                "Agentemis",
                "Anunak",
                "Astra",
                "BIOLOAD",
                "BIRDWATCH",
                "Bateleur",
                "Boostwrite",
                "CROWVIEW",
                "Carbanak",
                "Cobalt Strike",
                "CobaltStrike",
                "DICELOADER",
                "DNSMessenger",
                "FOWLGAZE",
                "HALFBAKED",
                "JSSLoader",
                "KillACK",
                "LOADOUT",
                "Lizar",
                "Meterpreter",
                "Mimikatz",
                "POWERPLANT",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "TEXTMATE",
                "Tirion",
                "VB Flash",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535970,
    "ts_updated_at": 1743041147,
    "ts_creation_date": 1653691899,
    "ts_modification_date": 1653691899,
    "files": {
        "pdf": "https://archive.orkl.eu/252eb1c317fe2fcff38c587ed0543269d5a93989.pdf",
        "text": "https://archive.orkl.eu/252eb1c317fe2fcff38c587ed0543269d5a93989.txt",
        "img": "https://archive.orkl.eu/252eb1c317fe2fcff38c587ed0543269d5a93989.jpg"
    }
}