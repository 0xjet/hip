{
    "id": "c3169ba7-4dfd-4319-b949-ab07197ecee4",
    "created_at": "2022-10-25T16:48:14.248647Z",
    "updated_at": "2025-03-27T02:16:20.894365Z",
    "deleted_at": null,
    "sha1_hash": "64ee9966b41640d4a8477e2bf5ad288422dd0829",
    "title": "",
    "authors": "",
    "file_creation_date": "2018-01-05T16:47:42Z",
    "file_modification_date": "2018-01-05T16:56:11Z",
    "file_size": 7139912,
    "plain_text": "# Diplomats in Eastern Europe bitten by a Turla mosquito\n\n## ESET, spol. s r.o.\n\nJanuary 2018\n\n\n-----\n\n# Diplomats in Eastern Europe bitten by a Turla mosquito\n\n## ESET, spol. s r.o.\n\nJanuary 2018\n\n\n-----\n\n### Table of Content\n\n**1.** **Overview** **5**\n\n**2.** **Why attribute this campaign to the Turla group?** **6**\n\n**3.** **Abusing Adobe Flash and Flash-related domains** **7**\n\n3.1 Apparent distribution through adobe.com 7\n\n3.2 Compromise hypotheses 7\n##### ➊ [Local MitM ] 8 ➋ [Compromised gateway ] 8 ➌ [MitM at the ISP level ] 9 ➍ [BGP hijacking ] 9\n\nWrap-up 9\n\n3.3 Data exfiltration via get.adobe.com URLs 9\n\n**4.** **Analysis of the Win32 Backdoor** **12**\n\n4.1 Installer 12\n\nCrypter 12\n\nInstallation 13\n\n4.2 DebugParser (launcher) 15\n\n4.3 Commander (main backdoor) 17\n\nSetup 18\n\nEncryption 19\n\nLog 20\n\nC&C server communications and backdoor commands 20\n\n**5.** **Analysis of the JavaScript backdoor** **23**\n\n**6.** **Conclusion** **24**\n\n**7.** **Bibliography** **25**\n\n**8.** **IoCs** **26**\n\n8.1 C&C server URLs 26\n\n8.2 Fake adobe URLs 26\n\n8.3 Unofficial URLs for legitimate Flash installers 26\n\n8.4 Hashes 27\n\n8.5 Windows artefacts 28\n\nHijacked CLSIDs 28\n\nFiles 28\n\n8.6 ESET detection names 29\n\nRecent samples 29\n\nOlder variants 29\n\nJavaScript backdoor 29\n\n\n-----\n\n### List of Figures\n\nFigure 1 Possible interception points on the path between the potential\nvictim’s machine and the Adobe servers 8\n\nFigure 2 Code performing request to bogus get.adobe.com URL 10\n\nFigure 3 Installation report sent to bogus get.adobe.com URL 10\n\nFigure 4 Unique ID at the end of the installer 11\n\nFigure 5 Code performing request to bogus get.adobe.com URL in the Snake\nmacOS installer 11\n\nFigure 6 Obfuscated function 12\n\nFigure 7 Debug strings in the PE loader function 13\n\nFigure 8 Files created by the malware in the random child directory of %APPDATA% 14\n\nFigure 9 Registry modifications to establish persistence 14\n\nFigure 10 Pseudocode of the launcher 15\n\nFigure 11 Search the address just after the LoadLibrary call 15\n\nFigure 12 Allocated memory layout 15\n\nFigure 13 Loader and Backdoor in the same library 16\n\nFigure 14 DLL has no EXPORT Address Table in the .reloc section 17\n\nFigure 15 Newly-created export Table 17\n\nFigure 16 Name of the new export 18\n\nFigure 17 Routine patching the export table 18\n\nFigure 18 Structure of the log file 20\n\nFigure 19 Beginning of the log file 20\n\nFigure 20 Structure of the requests to the C&C server – GET request with data\nin the id parameter 21\n\nFigure 21 Selection of the request 21\n\nFigure 22 Structure of the C&C reply packet 22\n\n### List of Tables\n\nTable 1 Backdoor registry values 19\n\nTable 2 Encryption keys and moduli 19\n\nTable 3 Description of the backdoor commands 22\n\n\n-----\n\n#### bitten by a Turla mosquito\n\n\n### 1. Overview\n\nTurla is one of the longest-known state-sponsored cyberespionage groups, with well-known victims\nsuch as the US Department of Defense in 2008. The group owns a large toolset [1] _[2] that is generally_\ndivided into several categories: the most advanced malware is only deployed on machines that are\nthe most interesting to the attackers. Their espionage platform is mainly used against Windows\nmachines, but also against macOS and Linux machines with various backdoors and a rootkit.\n\nFor years, Turla has relied, among other impersonations, on fake Flash installers to compromise\nvictims. This kind of attack vector does not require highly sophisticated exploits but rather depends\non tricking the user into installing the fake program.\n\nIn recent months, we have observed a strange, new behavior, leading to compromise by one of Turla’s\nbackdoors. Not only is it packaged with the real Flash installer, but it also appears to be downloaded\nfrom adobe.com. From the endpoint’s perspective, the remote IP address belongs to Akamai,\nthe official Content Delivery Network (CDN) used by Adobe to distribute their legitimate Flash\ninstaller. After digging a bit more, we realized that the fake Flash installers, including the macOS\ninstaller for Turla’s backdoor Snake — whether or not they were downloaded from adobe.com URLs\n— were performing a GET request to get.adobe.com URLs to exfiltrate some sensitive information\nabout the newly compromised machine. Again, according to our telemetry, the IP address was\na legitimate IP address used by Adobe. In this whitepaper, we will explain the different possibilities\nthat could lead to such malicious behavior. To our knowledge, this malware did not utilize any legitimate\nFlash Player updates nor is it associated with any known Adobe product vulnerabilities. We can state\nwith confidence that Adobe was not compromised. These attackers merely use the Adobe brand\nto trick users into downloading the malware.\n\nWe also found that the Turla group relied on a web app hosted on Google Apps Script as a Command\nand Control (C&C) server for JavaScript-based malware dropped by some versions of the fake Flash\ninstaller. Thus, it is clear they are trying to be as stealthy as possible by hiding in the network traffic\nof the targeted organizations.\n\nBy looking at our telemetry, we found evidence that Turla installers were exfiltrating information\nto get.adobe.com URLs since at least July 2016. The victims are located in territories of the former\nUSSR. As for Gazer, another malware family developed and distributed by the Turla group and previously\ndescribed by ESET [2], the targets are mainly consulates and embassies from different countries\nin Eastern Europe or the vicinity. We have also seen a few private companies infected but they do\nnot seem to be Turla’s main targets. Thus, it seems this campaign is directed against high-value\npolitical organizations. Finally, some of the victims are also infected with other Turla-related\nmalware such as ComRAT or Gazer.\n\n\n-----\n\n#### bitten by a Turla mosquito\n\n\n### 2. Why attribute this campaign to the Turla group?\n\nBefore analyzing the weird connections happening over the network, we will explain why we suspect\nthis campaign is the work of the Turla group.\n\nFirstly, some fake Flash installers in this campaign drop a backdoor known as Mosquito, which some\nsecurity companies already detect as Turla malware.\n\nSecondly, some of the C&C servers linked to the dropped backdoors are using, or used, SATCOM\nIP addresses previously associated with Turla [3].\n\nThirdly, this malware shares similarities with other malware families used by the Turla group.\nThese similarities include the same string obfuscation (string stacking and XOR with 0x55)\nand the same API resolution.\n\nThese elements allow us to say with confidence that Turla’s operators drove this campaign.\n\n\n-----\n\n#### bitten by a Turla mosquito\n\n\n### 3. Abusing Adobe Flash and Flash-related \n domains\n\nIt is not a new tactic for Turla to rely on fake Flash installers to try to trick the user to install one\nof their backdoors. For instance, Kaspersky Lab documented this behavior in 2014 [4]. However,\nthis is the first time, to our knowledge, that the malicious program is downloaded over HTTP\nfrom legitimate Adobe URLs and IP addresses. Thereby, even the most experienced users could\nbe deceived.\n\n##### 3.1 Apparent distribution through adobe.com\n\nSince the beginning of August 2016, we have identified a few attempts to download a Turla installer\nfrom admdownload.adobe.com URLs.\n\nAt first glance, we imagined it was the typical trick that consists of setting the host field\nof the HTTP request while the TCP socket is established to the real IP of the C&C server. However,\nafter deeper analysis, we realized that the IP address legitimately belongs to Akamai, a large\nCDN provider that Adobe uses to distribute its legitimate Flash installer.\n\nEven if the executable is downloaded from a legitimate URL (e.g.: http://admdownload.adobe.com/\nbin/live/flashplayer27_xa_install.exe), the referer field appears to have been tampered\nwith. We have seen this referer field set to http://get.adobe.com/flashplayer/download/\n?installer=Flash_Player, which is not a URL pattern used by Adobe and hence returns\na 404 status code if requested.\n\nIt is important to note that all the download attempts we identified in our telemetry were made\nthrough HTTP, not HTTPS. This allows a wide range of attacks in the path from the user’s machine\nto Akamai’s servers.\n\nThe next section is a review of various possible scenarios that could explain this. Exactly what happened\nis still an open question and we would appreciate any feedback if you have more information.\n\n##### 3.2 Compromise hypotheses\n\nFigure 1 shows the different hypotheses that could explain how a user apparently visiting\nthe legitimate Adobe website over HTTP might be forced to download Turla-related malware.\n\n\n-----\n\n#### bitten by a Turla mosquito\n\n\nFigure 1 Possible interception points on the path between the potential victim’s\nmachine and the Adobe servers\n\nWe quickly discarded the hypothesis of a rogue DNS server, since the IP address corresponds\nto the servers used by Adobe to distribute Flash. After discussions with Adobe and from their\ninvestigations, scenario ➎ seems unlikely as the attackers did not compromise the Adobe\nFlash Player download website. Thus, these are the hypotheses that remain: ➊ a Man-in-theMiddle (MitM) attack from an already-compromised machine in the local network, ➋ a compromised\ngateway or proxy of the organization, ➌ a MitM attack at the Internet Service Provider (ISP) level\nor ➍ a Border Gateway Protocol (BGP) hijack to redirect the traffic to Turla-controlled servers.\n\n##### ➊ Local MitM\n\nTurla operators could use an already-compromised machine in the network of the victim’s\norganization to perform a local MitM attack. Using ARP spoofing, they could modify the traffic\non the fly by redirecting the traffic of the targeted machine to a compromised machine. Even though\nwe are not aware of the presence of such tools in the Turla arsenal, such a tool is not hard to develop,\nespecially given the technical abilities of this group.\n\nHowever, we identified many different victims in many different organizations. That means the Turla\ngroup would have had to have compromised at least one other computer in each of those organizations,\nand specifically, a computer on the same subnet as a more preferred target.\n\n##### ➋ Compromised gateway\n\nThis attack is similar to the previous one but much more interesting for the attackers: they can intercept\nthe traffic for the whole organization, without the need to do ARP spoofing, as gateways and proxies\ntypically see all the incoming and outgoing traffic between the organization’s intranet and the internet.\nWe are not aware of the existence of a Turla tool designed to do this —but their rootkit, called Uroburos,\nhas packet analysis abilities. It can be installed on servers and used as a proxy to distribute tasks\nto infected machines that do not have a public IP address [5]. For a group with the apparent expertise\nand resources Turla has available, this Uroburos code could easily be modified to intercept traffic\non the fly and inject malicious payloads or otherwise modify unencrypted content.\n\n\n-----\n\n#### bitten by a Turla mosquito\n\n\n##### ➌ MitM at the ISP level\n\nIf the traffic is not intercepted before exiting an organization’s internal network, it means it is modified\nlater on the path to the Adobe servers. The ISPs are the main point of access on this path, and ESET\nhas previously reported on other actors, such as FinFisher, using packet injection at the ISP level\nto distribute malware in repackaged installers [6].\n\nAll the victims we identified are located in different, former USSR countries and we identified them using\nat least four different ISPs, based in these different countries. Thus, this scenario would suggest\nthat Turla operators would have to be able to monitor traffic in several different separate countries\nor links where this data transit.\n\n##### ➍ BGP hijacking\n\nIf the traffic is not modified by the ISP and does not reach the Adobe servers, this means it has been\nre-routed to another server that is controlled by the Turla operators. This can be done by conducting\na BGP hijacking attack. There are several methods that can be employed.\n\nOn one hand, Turla operators could use an Autonomous System (AS) they control to announce\na prefix belonging to adobe.com. Thus, the traffic routing to adobe.com from locations near\nthe Turla-controlled AS will be misdirected to their server. An example of such malicious activity\nwas analyzed by RIPE [7]. However, this would be quickly noticed by Adobe or by services performing\nBGP monitoring. Moreover, we checked on RIPEstat and did not notice any suspicious route\nannouncements for the Adobe IP addresses used in this campaign.\n\nOn the other hand, the Turla operators could use their AS to announce they have a shorter route\nthan any other AS might have to the Adobe servers. Thus, the traffic would also go through their routers\nand could be intercepted and modified in real time. However, a big part of the traffic to Adobe would\nbe redirected to the rogue router, so it would be a noisy tactic and the chances are it would have\nbeen noticed at some point since the campaign started, in August 2016 or earlier.\n\n###### Wrap-up\n\nOf the five scenarios presented in Figure 1, we considered only four, as we are confident Adobe was\nnot compromised. The BGP hijacking and the MitM attack at the ISP level are far more complex than\nthe others. Thus, we believe it is more probable the Turla group has a custom tool installed on local\ngateways of the impacted organizations, allowing them to intercept and modify the traffic even\nbefore it exits the intranet.\n\n##### 3.3 Data exfiltration via get.adobe.com URLs\n\nOnce the user has downloaded and launched the fake Flash installer, the compromise process\nstarts. It begins by dropping a Turla backdoor on the machine. This could be Mosquito, a Win32 malware\ndescribed in section 4, a malicious JavaScript file communicating with a web app hosted on Google\nApps Script as described in section 5, or an unknown file downloaded from a fake Adobe URL:\n\nhttp://get.adobe.com/flashplayer/download/update/[x32|x64]\n\nFor the last case, as this URL does not exist on Adobe’s server; for the Turla group to be able to send\ncontent through this URL, something must be man-in-the-middling traffic on the path between\nthe compromised machines and the Adobe servers to provide a response to these requests.\n\nThen, a request is performed exfiltrating information about the newly-compromised machine.\nThis is a GET request to http://get.adobe.com/stats/AbfFcBebD/q=<base64-encoded data>\nwith, according to our telemetry, a legitimate Adobe IP address but with a URL pattern that is not used\nby Adobe and thus returns. As the request is performed through HTTP, the same MitM scenarios\nas discussed in section 3.2 are likely.\n\n\n-----\n\n#### bitten by a Turla mosquito\n\n\nFigure 2 Code performing request to bogus get.adobe.com URL\n\nThe base64-encoded data contain interesting and sensitive information about the victim machine,\nso it would be surprising that it would actually be sent to an Adobe server. Figure 3 is an example\nof a decoded report. It sends various information such as a unique id (the last 8 bytes of the fake\nFlash installer executable, as shown in Figure 4), the username, the list of security products\ninstalled and the ARP table.\n\n\nID=<unique_id>\n```\nInternal error: 0\nLast error :0\n\n```\nExtracted\nuser=<USERNAME>\nAV=<INSTALLED AV SOFTWARE>\nip= 192.168.0.2 <local IP address>\n\nInterface: 192.168.0.2 --- 0x4\nInternet Address Physical Address Type\n192.168.0.1 <redacted> dynamic\n192.168.0.255 ff-ff-ff-ff-ff-ff static\n224.0.0.2 <redacted> static\n224.0.0.22 <redacted> static\n224.0.0.252 <redacted> static\n239.255.255.250 <redacted> static\n255.255.255.255 ff-ff-ff-ff-ff-ff static\n\n\nFigure 3 Installation report sent to bogus get.adobe.com URL\n\n\n-----\n\n#### bitten by a Turla mosquito\n\n\nFigure 4 Unique ID at the end of the installer\n\nInterestingly, the installer of Snake for macOS [8], a backdoor associated with Turla, also uses\nthe exact same URL, as shown in Figure 5. The data sent are a bit different as they only contain\nthe username and device name, although still encoded in base64. However, this behavior\nwas not documented by Fox-IT when they published their analysis.\n\nFigure 5 Code performing request to bogus get.adobe.com URL in the Snake\nmacOS installer\n\nFinally, the fake installer drops or downloads, then runs a legitimate Flash Player application.\nThe legitimate installer is either embedded in the fake installer or downloaded from the following\nGoogle Drive URL: https://drive.google[.]com/uc?authuser=0&id=0B_LlMiKUOIstM0R\nRekVEbnFfaXc&export=download\n\n\n-----\n\n#### bitten by a Turla mosquito\n\n\n### 4. Analysis of the Win32 Backdoor\n\nIn this section, we describe the samples we found in the wild, mainly in 2017. We found evidence\nthat this campaign has been running for some years, and the 2017 samples are an evolution from\na backdoor in a file conventionally named InstructionerDLL.dll. However, these older samples\nwere less obfuscated and there was only the backdoor DLL, without the loader found in more recent\nsamples. Some of these older samples have compilation timestamps that date back to 2009 but\nthese are likely to have been forged.\n\n##### 4.1 Installer\n\nThe installer generally comes as a fake Flash installer and is bundled with two additional components\nlater dropped on the disk. As explained above, we identified several users who downloaded this fake\nFlash installer from a URL and IP used by Adobe for the distribution of the legitimate Flash installer.\nWe detailed the different hypotheses that could explain this behavior in the previous section.\n\n###### Crypter\n\nIn recent versions, the installer is always obfuscated with what seems to be a custom crypter.\nFigure 6 shows an example of a function obfuscated with this tool.\n\nFigure 6 Obfuscated function\n\nFirstly, the crypter makes heavy use of opaque predicates along with arithmetic operations.\nFor example, the obfuscated function will compute a number from hardcoded values and then\ncheck if this number is greater than another hardcoded value. Thus, at each execution the control\nflow will be the same, but emulation is required to determine which path is correct. Therefore,\nthe code becomes far more complex to analyze for both malware researchers and automated\nalgorithms in security software. This may slow down emulation so much that the object won’t\nbe scanned, due to time constraints – and hence software known or shown to be malicious\n(if not obfuscated) won’t be detected.\n\n\n-----\n\n#### bitten by a Turla mosquito\n\n\nSecondly, after the first layer is de-obfuscated, a call to the Win32 API SetupDiGetClassDevs\n(0,0,0,0xFFFFFFFF) is performed, and the crypter then checks whether the return value equals\n0xE000021A. This function is generally used to request information about the devices of the system.\nHowever, this specific Flags value (0xFFFFFFFF) is not documented, but according to our tests,\nthe return value is always 0xE000021A on Windows 7 and Windows 10 machines. We believe\nthis API call and the following check are used to bypass sandboxes and emulators that do not\nimplement it correctly.\n\nThirdly, the real code is divided into several chunks that are decrypted, using a custom function,\nand re-ordered at run time to build a PE in memory. It is then executed in-place by the crypter’s\nPE loader function. This PE loader contains several debug strings as shown in Figure 7.\n\nFigure 7 Debug strings in the PE loader function\n\n###### Installation\n\nOnce decrypted, the installer searches the %APPDATA% subtree and drops two files in the deepest\nfolder it finds. When searching for this folder, it avoids any folder that contains AVAST in its name.\nIt then uses the filename of one of the non-hidden files in this folder, truncated at the extension,\nas the base filename for the files it will drop. If all the files in the directory are hidden, or the directory\nis empty, it takes the name of a DLL from %WINDIR%\\System32. The loader it drops will have a .tlb\nextension and the main backdoor a .pdb extension. Interestingly, it does not use WriteFile to drop\nthese two DLLs. Instead, it creates a file, maps it in memory and calls memmove to copy data.\nIt is probably designed to avoid some sandboxes and security products hooks on WriteFile.\n\nWe have also seen older variants of the installer dropping only one file, with the .tlb extension.\nIn that case, the same file contains both loader and backdoor functions. DllMain chooses which\ncode to execute.\n\nIt writes a simple and unencrypted log file in %APPDATA%\\kb6867.bin. The full log file is created\nin the same directory as the two DLLs and has the .tnl extension.\n\n\n-----\n\n#### bitten by a Turla mosquito\n\n\nFigure 8 Files created by the malware in the random child directory of %APPDATA%\n\nThen, it establishes persistence by using either a Run registry key or COM hijacking [9]. If the antivirus\ndisplay name, retrieved using Windows Management Instrumentation (WMI), is “Total Security”,\nit adds rundll32.exe [backdoor_path], StartRoutine in HKCU\\Software\\Run\\auto_update.\n\nOtherwise, it will replace the registry entry under HKCR\\CLSID\\{d9144dcd-e998-4eca-ab\n6a-dcd83ccba16d}\\InprocServer32 or HKCR\\CLSID\\{08244ee6-92f0-47f2-9fc9-929ba\na2e7235}\\InprocServer32 with the path to the loader. These CLSIDs correspond respectively\nto EhStorShell.dll and to ntshrui.dll. These DLLs are launched legitimately by a lot of processes,\nincluding explorer.exe, the main windows GUI. Thus, the loader will be called each time\nexplorer.exe is started. Finally, it adds an entry in the registry to store the path to the original\nhijacked DLL and to the main backdoor, as shown in Figure 9.\n```\n        // Path to the loader\n\n```\nHKCR\\CLSID\\{d9144dcd-e998-4eca-ab6a-dcd83ccba16d}\\\nInprocServer32\n\n         - C:\\Users\\Administrator\\AppData\\Roaming\\Adobe\\Acrobat\\9.0\\\nAdobeSysFnt09.tlb\n```\n        // the name of the above replaced dll\n\n```\nHKCU\\Software\\Microsoft\\Windows\\OneDriveUpdate explorer.exe\n\n         - %SystemRoot%\\system32\\EhStorShell.dll;\n{d9144dcd-e998-4eca-ab6a-dcd83ccba16d};new\n```\n        // Path to the main backdoor\n\n```\nHKCU\\Software\\Microsoft\\Windows\\OneDriveUpdate (Default)\n\n         - C:\\Users\\Administrator\\AppData\\Roaming\\Adobe\\Acrobat\\\n9.0\\AdobeSysFnt09.pdb\n\nFigure 9 Registry modifications to establish persistence\n\nOther CLSIDs are hardcoded in the binary but we have not seen any use made of them. The full list\nis available in the IoCs section.\n\nAs explained in the previous section, the installer sends some information — such as the unique\nid of the sample, the username or the ARP table — to a URL at an Adobe domain, get.adobe.com.\nIt will also launch a real Adobe Flash installer, which is either downloaded from Google Drive\nor embedded in the fake installer.\n\nBefore launching the main backdoor, the installer creates an administrative account HelpAssistant\n(or HelpAsistant in some samples) with the password sysQ!123. Also, the LocalAccountToken\nFilterPolicy is set to 1, allowing remote administrative actions. We believe this account name\nwas used to remain stealthy as this is the name used when a legitimate Remote Assistance session\nis run [10].\n\n\n-----\n\n#### bitten by a Turla mosquito\n\n\n##### 4.2 DebugParser (launcher)\n\nThe launcher, named DebugParser.dll internally, is called when the hijacked COM object\nis loaded. It is responsible for launching the main backdoor and for loading the hijacked COM object.\nThe simplified pseudo-code of this component is provided in Figure 10.\n\nif (GetModuleFileNameW != “explorer.exe”) {\nCreateMutexW(“slma”)\nCreateProcess(“rundll32 (from HKCU\\Software\\Microsoft\\Windows\\\nOneDriveUpdate @=) StartRoutine”)\n```\n        }\n\n```\n//Load hijacked library\nLoadLibraryW (from HKCU\\Software\\Microsoft\\Windows\\OneDriveUpdate\n“explorer.exe”=)\n\nFigure 10 Pseudocode of the launcher\n\nHowever, it uses some tricks to load the hijacked library and to return to the correct address.\nThe process is described below:\n\n1. Retrieve the original return address after the legitimate call to LoadLibrary. At the beginning\nof DllMain, it stores the value of the ESP register. Then it checks for FF 15 (a CALL opcode)\nat ESP - 6. If it is present, the register holds the original return address.\n\nFigure 11 Search the address just after the LoadLibrary call\n\n2. Allocate RWX memory containing the following values:\n\n3. Jump to the hook function by modifying the return address of DllMain.\n\n\n**0** **4**\n\nPointer to HookLibrary Original return addr\nloader\n\n\n**8**\n\n\n**12**\n\n\n**16** **24** **48**\n\n\nHinst DLL\n\n\nPointer to FreeLibrary 0xCC\n\n\nHook\nfunction\n\n\nFigure 12 Allocated memory layout\n\n\n-----\n\n#### bitten by a Turla mosquito\n\n\n4. In the hook function:\n\na. Call a function that is responsible for loading ntshrui.dll (or any other hijacked library)\n\nb. Call FreeLibrary on the DebugParser.dll (backdoor loader) handle\n\nc. Jump to the original return address before the hook.\n\nBecause the original DLL is loaded, the user is unlikely to notice that the backdoor was launched\nat the same time.\n\nIn the case of older variants, with the loader and backdoor functions in one file, the DllMain chooses\nwhich code to execute, as shown in Figure 13.\n\nFigure 13 Loader and Backdoor in the same library\n\n\n-----\n\n#### bitten by a Turla mosquito\n\n\n##### 4.3 Commander (main backdoor)\n\nThe main backdoor of this campaign, called CommanderDLL by its authors, is launched either\nby the loader described above, or directly at startup if the chosen persistence mechanism is the Run\nregistry entry. In both cases, this library’s StartRoutine export is called while, as shown in Figure 14,\nthis export is not present in the DLL’s export table.\n\nFigure 14 DLL has no EXPORT Address Table in the .reloc section\n\nIn the DllMain function, an export table is built in order to expose this export:\n\n1. It creates an IMAGE_EXPORT_DIRECTORY structure with StartRoutine as the name\nof its only export\n\n2. It copies this structure just after the relocation section, located at the end of the PE’s\nin-memory image\n\n3. It changes the PE header field containing the Relative Virtual Address (RVA) of the export\ntable to the address of the newly-created export table\n\nWith these fix-ups, the memory-mapped library has an export called StartRoutine, as shown\nin Figure 15 and Figure 16. Figure 17 is a screenshot from the Hex-Rays decompiler showing the code\nfor the whole process to add this export.\n\nFigure 15 Newly-created export Table\n\n\n-----\n\n#### bitten by a Turla mosquito\n\n\nFigure 16 Name of the new export\n\nFigure 17 Routine patching the export table\n\n###### Setup\n\nFirstly, the CommanderDLL module deletes the dropper (the fake Flash installer) file. The path\nis received from the dropper via a named pipe called \\\\.\\pipe\\namedpipe. Then, in a new thread,\nit creates a second named pipe, \\\\.\\pipe\\ms32loc, and waits until another process connects\nto this pipe, at which point the program exits.\n\nSecondly, it sets up some internal structures and stores configuration values in the registry.\nTable 1 describes the different registry values stored under HKCU\\Software\\Microsoft\\[dllname].\n\n\n-----\n\n#### bitten by a Turla mosquito\n\n\nTable 1 Backdoor registry values\n\n\nKey value Description\n\nFlags Contains C&C server URLs\n\nlayout MAC address padded with 0x0000\n\n[dllname]tr32 Similar to Flags\n\n[dllname]fgtb Temporary data\n\n[dllname]fga Not seen\n\nAll the registry values, except the layout entry, are encrypted using a custom algorithm\nthat is described in the next section.\n\nThird, an additional C&C server address is downloaded from a document hosted on Google Docs\n_(https://docs.google[.]com/uc?authuser=0&id=0B_wY-Tu90pbjTDllRENWNkNma0k&export=download)._\nIt is also encrypted using the same algorithm described below.\n\n###### Encryption\n\nThis backdoor relies on a custom encryption algorithm. Each byte of the plaintext is XORed with\na stream generated by a function that looks similar to the Blum Blum Shub algorithm [11]. To encrypt\nor decrypt, a key and a modulus are passed to the encryption function.\n\nDifferent keys and moduli are used in the different samples. Some are hardcoded while others are\ngenerated during execution. Table 2 describes the different keys and moduli used by this malware.\n\n\nTable 2 Encryption keys and moduli\n\n\nName Key Modulus Description\n(hexadecimal) (hexadecimal)\n\nFlags 0x3EB13 0x7DFDC101 Registry\n\nfgtb 0x3EB13 0x7DFDC101 Registry\n\ngoogle 0x3EB13 0x7DFDC101 Downloaded C&C server URL\n\ntr32 [offset 0x0] of the data 0x6581E8DD Registry\n\ntnl [offset 0x20] of the log file 0x5DEE0b89 Log file\n\nC&C reply [offset 0x0] of the reply 0x7DFDC101 C&C reply\n\nC&C request payload 0x3EB13 0x7DFDC101 Payload structure\nof the C&C request\n\nURL ID structure [offset 0x0] of the GET 0x7DFDC101 C&C server request\nid parameter\n\nCookie [offset 0x0] of the GET 0x7DFDC101 C&C server request\nid parameter\n\nPOST [offset 0x0] of the GET 0x7DFDC101 C&C server request\nid parameter\n\n\n-----\n\n#### bitten by a Turla mosquito\n\n\n###### Log\n\nThe program maintains a comprehensive log file under the name [dllname].tnl. Interestingly,\nit includes the timestamp of each log entry, allowing an easy retrace of the chain of events\nthat happened on a compromised machine. This could be very helpful for forensic investigators.\nIt is encrypted using the previously-described algorithm. The key is located at offset 0x20\nin the header of the log file and the modulus is always 0x5DEE0B89. Figure 18 describes\nthe structure of this file.\n\n\n**FILETIME** SystemTime;\n\n**DWORD** type1; //ex:0x5336,0x5337, ...\n\n**DWORD** type2; //ex:0x734A,0x7344, ...\n\n**DWORD** data_len;\n\n**BYTE** data[];\n\n\n**DWORD** strmA;\n\n**DWORD** strmB;\n\n**DWORD** xor1_strmA;\n\n**DWORD** xor2_strmA;\n\n**DWORD** xor3_strmB;\n\n**DWORD** xor4_strmA;\n\n**DWORD** strmA_xor_30750789h;\n\n**DWORD** rand_shift_xor;\n\n**DWORD** encryption_key;\n\n\nEncrypted\n\nFigure 18 Structure of the log file\n\nFigure 19 Beginning of the log file\n\n###### C&C server communications and backdoor commands\n\nThe backdoor’s main loop is responsible for managing the communication with the C&C server\nand executing the commands it sends. At the beginning of each round, it sleeps a random amount\nof time – usually around 12 minutes.\n\nThe requests to the C&C server always use the same URL scheme: https://[C&C server\ndomain]/scripts/m/query.php?id=[base64(encrypted data)]. The user-agent is hardcoded\nin the samples and cannot be changed:\n\nMozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/\n41.0.2228.0 Safari/537.36\n\nThis is the default value used by Google Chrome 41. The structure of the id parameter is described\nin Figure 20.\n\n\n-----\n\n#### bitten by a Turla mosquito\n\n\nEncrypted\nwith first **DWORD** data_len; _Encrypted_\n4 bytes **Key** 0x3EB13\n\n**BYTE** data[];\n\n**Modulus** 0x7DFDC101\n\n**BYTE** random_junk;\n\nFigure 20 Structure of the requests to the C&C server – GET request with data\nin the id parameter\n\nThe previous example is the case for which the id GET parameter contains the Data structure.\nHowever, data can also be put inside a cookie (with a null name) or in a POST request.\nFigure 21 describes the various possibilities.\n\nIn all cases, the encryption key is the first DWORD of the URL id structure. This key, in combination\nwith the modulus 0x7DFDC101, can decrypt the URL id structure, the POST data and the cookie\nvalue. Then, the payload of the data structure is decrypted.\n\nREQUEST TO THE C&C\n\nData lenght\n\n**POST** **GET**\n\n|Col1|Col2|\n|---|---|\n|d t||\n\n\nData in GET\nparameter\n\n\nData in cookie\n\n\nFigure 21 Selection of the request\n\nThe initial request contains general information about the compromised machine, such as the result\nof the commands ipconfig, set, whoami and tasklist.\n\nThen, the C&C server replies with one of several batches of instructions. The structure of this reply\nis described in . The packet is fully encrypted (except the first four bytes), with the same algorithm,\nderived from Blum Blum Shub, described in section 4.3 using the first DWORD for the key\nand 0x7DFDC101 for the modulus. Each batch of instructions is encrypted separately using\n0x3EB13 for the key and 0x7DFDC101 for the modulus.\n\n\n-----\n\n#### bitten by a Turla mosquito\n\n\nEncrypted\nwith first 4 bytes\n\n_Each batch is_\n_encrypted separately_\n\n\nInstruction\n\n\n**Header**\n\n**WORD** instruction_id // (0x3001 - 0x300B);\n\n**DWORD** unknown_lenght;\n\n**DWORD** payload_lenght;\n\n**Payload**\n\n**DWORD** string_lenght // no trailling zero;\n\n**BYTE** unicode_string[];\n\n**BYTE** data bin[];\n\n\nFigure 22 Structure of the C&C reply packet\n\nThe backdoor can execute certain predefined actions hardcoded in the binary. Table 3 is a summary\nof the available commands.\n\n\nTable 3 Description of the backdoor commands\n\n\nCommand ID Description\n\n0x3001 Download file to the compromised machine. If there is .dll or .exe\nin the filename, run it using LoadLibrary or CreateProcess.\n\n0x3002 Launch a process (or load a library if there is .dll in the filename)\n\n0x3003 Delete a file using DeleteFileW.\n\n0x3004 Exfiltrate a file (max size sent = 104,857,600 bytes). The C&C server\ncan also ask to delete the files and to flush data in the registry Flags.\n\n0x3005 Store data to the registry Flags. The size of data should be ≤ 240 bytes.\n\n0x3006 Execute cmd.exe /c [command]. The result is read using a pipe and sent back to the C&C.\n\n0x3007 Same as 0x3005.\n\n0x3008 Same as 0x3005.\n\n0x3009 Add a C&C server URL.\n\n0x300A Delete a C&C server URL.\n\n0x300B Same as 0x3009.\n\nIn some of the samples we have analyzed, the backdoor is also able to launch PowerShell scripts.\n\n\n-----\n\n#### bitten by a Turla mosquito\n\n\n### 5. Analysis of the JavaScript backdoor\n\nSome of the fake Flash installers deliver two JavaScript backdoors instead of Mosquito, the Win32\nbackdoor. These files are dropped on the disk in the folder %appdata%\\Microsoft\\. They are named\ngoogle_update_checker.js and local_update_checker.js\n\nThe first one contacts a web app hosted on Google Apps Script with the following URL\n(https://script.google[.]com/macros/s/AKfycbwF_VS5wHqlHmi4EQoljEtIsjmglLBO\n69n_2n_k2KtBqWXLk3w/exec) and expects a base64-encoded reply. Then, it executes the decoded\ncontent using eval. We don’t know what the exact purpose of this additional backdoor is, but\nit may be used to download additional malware or to execute malicious JavaScript code directly.\nTo establish persistence, it adds a Shell value under HKCU\\Software\\Microsoft\\Windows\nNT\\CurrentVersion\\Winlogon\\\n\nThe second JavaScript file reads %programdata%\\1.txt and executes its content using\nthe eval function. To establish persistence, it adds a local_update_check value\nin HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\n\n\n-----\n\n#### bitten by a Turla mosquito\n\n\n### 6. Conclusion\n\nThis campaign shows that Turla’s operators have many ideas to trick the user and to hide\ntheir malicious traffic as legitimate. Even an experienced user can be fooled by downloading\na malicious file that is apparently from adobe.com, since the URL and the IP address correspond\nto Adobe’s legitimate infrastructure. However, the usage of HTTPs would significantly reduce\nthe effectiveness of these kinds of attacks, as it is harder to intercept and modify encrypted traffic\non the path between a machine and a remote server. Similarly, a check of the file signature should\nquickly raise suspicion, as the files used in this campaign are not signed whereas installers\nfrom Adobe are.\n\nIt also shows that Turla is still interested in consulates and embassies located in Eastern Europe\nand they put a lot of effort into keeping their remote access to these important sources of information.\n\n_[For any inquiries, or to make sample submissions related to the subject, contact us at: threatintel@eset.com](mailto:threatintel%40eset.com?subject=Turla%20mosquito)_\n\n\n-----\n\n#### bitten by a Turla mosquito\n\n\n### 7. Bibliography\n\n_1_ ESET Research, “Carbon Paper: Peering into Turla’s second stage backdoor,” ESET, 30 03 2017. [Online].\n[Available: https://www.welivesecurity.com/2017/03/30/carbon-paper-peering-turlas-second-stage-backdoor/.](https://www.welivesecurity.com/2017/03/30/carbon-paper-peering-turlas-second-stage-backdoor/)\n\n_2_ ESET Research, “Gazing at Gazer – Turla’s new second stage backdoor,” ESET, 08 2017. [Online].\n[Available: https://www.welivesecurity.com/wp-content/uploads/2017/08/eset-gazer.pdf.](https://www.welivesecurity.com/wp-content/uploads/2017/08/eset-gazer.pdf)\n\n_3_ AlienVault, “Satellite Turla infrastructure,” 2016. [Online].\n[Available: https://otx.alienvault.com/indicator/hostname/ebay-global.publicvm.com.](https://otx.alienvault.com/indicator/hostname/ebay-global.publicvm.com)\n\n_4_ Kaspersky, “The Epic Turla Operation,” 2014. [Online].\n[Available: https://securelist.com/the-epic-turla-operation/65545/.](https://securelist.com/the-epic-turla-operation/65545/)\n\n_5_ BAE System, “SNAKE CAMPAIGN & CYBER ESPIONAGE TOOLKIT,” 2014. [Online].\n[Available: http://artemonsecurity.com/snake_whitepaper.pdf.](http://artemonsecurity.com/snake_whitepaper.pdf)\n\n_6_ F. Kafka, “New FinFisher surveillance campaigns: Internet providers involved?,” 21 09 2017. [Online].\n[Available: https://www.welivesecurity.com/2017/09/21/new-finfisher-surveillance-campaigns/.](https://www.welivesecurity.com/2017/09/21/new-finfisher-surveillance-campaigns/)\n\n_7_ RIPE, “YouTube Hijacking: A RIPE NCC RIS case study,” 17 03 2008. [Online]. Available:\n[https://www.ripe.net/publications/news/industry-developments/youtube-hijacking-a-ripe-ncc-ris-case-study.](https://www.ripe.net/publications/news/industry-developments/youtube-hijacking-a-ripe-ncc-ris-case-study)\n\n_8_ FOX-IT, “Snake: Coming soon in Mac OS X flavour,” 03 05 2017. [Online].\n[Available: https://blog.fox-it.com/2017/05/03/snake-coming-soon-in-mac-os-x-flavour/.](https://blog.fox-it.com/2017/05/03/snake-coming-soon-in-mac-os-x-flavour/)\n\n_9_ GDATA, “COM Object hijacking: the discreet way of persistence,” 10 2014. [Online]. Available:\n[https://www.gdatasoftware.com/blog/2014/10/23941-com-object-hijacking-the-discreet-way-of-persistence.](https://www.gdatasoftware.com/blog/2014/10/23941-com-object-hijacking-the-discreet-way-of-persistence)\n\n_10_ Microsoft, “HelpAssistant account (installed by using a Remote Assistance session),” 12 05 2014. [Online].\n[Available: https://technet.microsoft.com/en-us/library/dn745900(v=ws.11).aspx#SEC_HelpAssistant.](https://technet.microsoft.com/en-us/library/dn745900(v=ws.11).aspx#SEC_HelpAssistant)\n\n_11_ [Wikipedia, “Blum Blum Shub,” 13 11 2017. [Online]. Available: https://en.wikipedia.org/wiki/Blum_Blum_Shub.](Available: https://en.wikipedia.org/wiki/Blum_Blum_Shub)\n\n\n-----\n\n#### bitten by a Turla mosquito\n\n\n### 8. IoCs\n\n##### 8.1 C&C server URLs\n\nYear URL\n\n2017 smallcloud.ga\n\n2017 fleetwood.tk\n\n2017 docs.google.com/uc?authuser=0&id=0B_wY-Tu90pbjTDllRENW\nNkNma0k&export=download (adstore.twilightparadox.com)\n\n2017 bigpen.ga\n\n2017 https://script.google.com/macros/s/AKfycbxxPPyGP3Z5wgwbs\nmXDgaNcQ6DCDf63vih-Te_jKf9SMj8TkTie/exec\n\n2017 https://script.google.com/macros/s/AKfycbwF_VS5wHqlH\nmi4EQoljEtIsjmglLBO69n_2n_k2KtBqWXLk3w/exec\n\n2017, 2016, ebay-global.publicvm.com\n2015\n\n2017, 2016, psychology-blog.ezua.com\n2015, 2014\n\n2016 agony.compress.to\n\n2016 gallop.mefound.com\n\n2016 auberdine.etowns.net\n\n2016 skyrim.3d-game.com\n\n2016 officebuild.4irc.com\n\n2016 sendmessage.mooo.com\n\n2016, 2014 robot.wikaba.com\n\n2015 tellmemore.4irc.com\n\n##### 8.2 Fake adobe URLs\n\n_http://get.adobe[.]com/stats/AbfFcBebD/?q=<base64-encoded data>_\n\n_http://get.adobe[.]com/flashplayer/download/update/x32_\n\n_http://get.adobe[.]com/flashplayer/download/update/x64_\n\n##### 8.3 Unofficial URLs for legitimate Flash installers\n\n_https://drive.google[.]com/uc?authuser=0&id=0B_LlMiKUOIsteEtraEJYM0QxQVE&export=download_\n\n_https://drive.google[.]com/uc?authuser=0&id=0B_LlMiKUOIstM0RRekVEbnFfaXc&export=download_\n\n\n-----\n\n#### bitten by a Turla mosquito\n\n\n##### 8.4 Hashes\n\n\n-----\n\n#### bitten by a Turla mosquito\n\n\n##### 8.5 Windows artefacts\n\n###### Hijacked CLSIDs\n\n{D9144DCD-E998-4ECA-AB6A-DCD83CCBA16D}\n{08244EE6-92F0-47F2-9FC9-929BAA2E7235}\n{4E14FBA2-2E22-11D1-9964-00C04FBBB345}\n{B5F8350B-0548-48B1-A6EE-88BD00B4A5E7}\n{603D3801-BD81-11D0-A3A5-00C04FD706EC}\n{F82B4EF1-93A9-4DDE-8015-F7950A1A6E31}\n{9207D8C7-E7C8-412E-87F8-2E61171BD291}\n{A3B3C46C-05D8-429B-BF66-87068B4CE563}\n{0997898B-0713-11D2-A4AA-00C04F8EEB3E}\n{603D3801-BD81-11D0-A3A5-00C04FD706EC}\n\n{1299CF18-C4F5-4B6A-BB0F-2299F0398E27}\n\n###### Files\n\n- Three files with the same name but a different extension (.tlb, .pdb and .tnl)\nin a folder of %APPDATA%\n\n- %APPDATA%\\kb6867.bin (simplified log file)\n\n\n-----\n\n#### bitten by a Turla mosquito\n\n\n##### 8.6 ESET detection names\n\n###### Recent samples\n\nWin32/Turla.CQ\nWin32/Turla.CP\nWin32/Turla.CR\nWin32/Turla.CS\nWin32/Turla.CT\nWin32/Turla.CU\nWin32/Turla.CV\nWin32/Turla.CW\n\nWin32/Turla.CX\n\n###### Older variants\n\nWin32/TrojanDownloader.CAM\n\nWin32/TrojanDownloader.DMU\n\n###### JavaScript backdoor\n\nJS/Agent.NWB\n\nJS/TrojanDownloader.Agent.REG\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        }
    ],
    "references": [
        "https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2018/2018.01.09.Turla_Mosquito/ESET_Turla_Mosquito.pdf"
    ],
    "report_names": [
        "ESET_Turla_Mosquito.pdf",
        "ESET_Turla_Mosquito"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716494,
    "ts_updated_at": 1743041780,
    "ts_creation_date": 1515170862,
    "ts_modification_date": 1515171371,
    "files": {
        "pdf": "https://archive.orkl.eu/64ee9966b41640d4a8477e2bf5ad288422dd0829.pdf",
        "text": "https://archive.orkl.eu/64ee9966b41640d4a8477e2bf5ad288422dd0829.txt",
        "img": "https://archive.orkl.eu/64ee9966b41640d4a8477e2bf5ad288422dd0829.jpg"
    }
}