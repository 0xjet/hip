{
    "id": "b127ede0-9e16-4395-949d-96a7264e5aa6",
    "created_at": "2023-01-12T15:09:24.478811Z",
    "updated_at": "2025-03-27T02:16:26.201123Z",
    "deleted_at": null,
    "sha1_hash": "be6e7318018341fc5f738e4ec2c48e7626df881a",
    "title": "2018-10-11 - GPlayed Trojan - .Net playing with Google Market",
    "authors": "",
    "file_creation_date": "2022-05-29T01:10:31Z",
    "file_modification_date": "2022-05-29T01:10:31Z",
    "file_size": 1362557,
    "plain_text": "# GPlayed Trojan - .Net playing with Google Market\n\n**blog.talosintelligence.com/2018/10/gplayedtrojan.html**\n\n[This blog post is authored byVitor Ventura.](https://twitter.com/_vventura)\n\n## Introduction\n\nIn a world where everything is always connected, and mobile devices are involved in\nindividuals' day-to-day lives more and more often, malicious actors are seeing increased\nopportunities to attack these devices. Cisco Talos has identified the latest attempt to\npenetrate mobile devices — a new Android trojan that we have dubbed \"GPlayed.\" This is a\ntrojan with many built-in capabilities. At the same time, it's extremely flexible, making it a very\neffective tool for malicious actors. The sample we analyzed uses an icon very similar to\nGoogle Apps, with the label \"Google Play Marketplace\" to disguise itself.\n\n\n-----\n\nThe malicious application is on the left-hand side.\n\nWhat makes this malware extremely powerful is the capability to adapt after it's deployed. In\norder to achieve this adaptability, the operator has the capability to remotely load plugins,\ninject scripts and even compile new .NET code that can be executed. Our analysis indicates\nthat this trojan is in its testing stage but given its potential, every mobile user should be\naware of GPlayed. Mobile developers have recently begun eschewing traditional app stores\nand instead want to deliver their software directly through their own means. But GPlayed is\nan example of where this can go wrong, especially if a mobile user is not aware of how to\ndistinguish a fake app versus a real one.\n\n\n-----\n\n## Trojan architecture and capabilities\n\nThis malware is written in .NET using the Xamarin environment for mobile applications. The\nmain DLL is called \"Reznov.DLL.\" This DLL contains one root class called \"eClient,\" which is\nthe core of the trojan. The imports reveal the use of a second DLL called \"eCommon.dll.\" We\ndetermined that the \"eCommon\" file contains support code and structures that are platform\nindependent. The main DLL also contains eClient subclasses that implement some of the\nnative capabilities.\n\nThe package certificate is issued under the package name, which also resembles the name\nof the main DLL name.\n\nCertificate information\n\nThe Android package is named \"verReznov.Coampany.\" The application uses the label\n\"Installer\" and its name is \"android.app.Application.\"\n\n\n-----\n\nPackage permissions\n\nThe trojan declares numerous permissions in the manifest, from which we should highlight\nthe BIND_DEVICE_ADMIN, which provides nearly full control of the device to the trojan.\n\nThis trojan is highly evolved in its design. It has modular architecture implemented in the\nform of plugins, or it can receive new .NET source code, which will be compiled on the\ndevice in runtime.\n\n\n-----\n\nInitialization of the compiler object\n\nThe plugins can be added in runtime, or they can be added as a package resource at\npackaging time. This means that the authors or the operators can add capabilities without\nthe need to recompile and upgrade the trojan package on the device.\n\n\n-----\n\nTrojan native capabilities\n\nThis is a full-fledged trojan with capabilities ranging from those of a banking trojan to a full\nspying trojan. This means that the malware can do anything from harvest the user's banking\ncredentials, to monitoring the device's location. There are several indicators (see section\n\"trojan activity\" below) that it is in its last stages of development, but it has the potential to be\na serious threat.\n\n## Trojan details\n\nUpon boot, the trojan will start by populating a shared preferences file with the configuration\nit has on its internal structures. Afterward, it will start several timers to execute different\ntasks. The first timer will be fired on the configured interval (20 seconds in this case), pinging\nthe command and control (C2) server. The response can either be a simple \"OK,\" or can be\na request to perform some action on the device. The second timer will run every five seconds\nand it will try to enable the WiFi if it's disabled. The third timer will fire every 10 seconds and\nwill attempt to register the device into the C2 and register wake-up locks on the system to\ncontrol the device's status.\n\nDuring the trojan registration stage, the trojan exfiltrates private information such as the\nphone's model, IMEI, phone number and country. It will also report the version of Android\nthat the phone is running and any additional capabilities.\n\n\n-----\n\nDevice registration\n\nThis is the last of the three main timers that are created. The trojan will register the SMS\nhandler, which will forward the contents and the sender of all of the SMS messages on the\nphone to the C2.\n\nThe final step in the trojan's initialization is the escalation and maintenance of privileges in\nthe device. This is done both by requesting admin privileges on the device and asking the\nuser to allow the application to access the device's settings.\n\nPrivilege escalation requests\n\n\n-----\n\nThe screens asking for the user's approval won't close unless the user approves the privilege\nescalation. If the user closes the windows, they will appear again due to the timer\nconfiguration.\n\nAfter the installation of the trojan, it will wait randomly between three and five minutes to\nactivate one of the native capabilities — these are implemented on the eClient subclass\ncalled \"GoogleCC.\" This class will open a WebView with a Google-themed page asking for\npayment in order to use the Google services. This will take the user through several steps\nuntil it collects all the necessary credit card information, which will be checked online and\nexfiltrated to the C2. During this process, an amount of money, configured by the malicious\noperator, is requested to the user.\n\nSteps to request the user's credit card information\n\nIn our sample configuration, the request for the views above cannot be canceled or removed\nfrom the screen — behaving just like a screen lock that won't be disabled without providing\ncredit card information.\n\nAll communication with the C2 is done over HTTP. It will use either a standard web request\nor it will write data into a web socket if the first method fails. The C2 can also use WebSocket\nas a backup communication channel.\n\nBefore sending any data to the C2 using the trojan attempts to disguise its data, the data is\nserialized using JSON, which is then encoded in Base64. However, the trojan replaces the '='\nby 'AAAZZZXXX', the '+' by '|' and the '/' by '.' to disguise the Base64.\n\n\n-----\n\nRequest encoding process\n\nThe HTTP requests follow the format below, while on the WebSocket only the query data is\nwritten.\n\n<server path>?q=<IMEI>-<REQUEST CODE>:<Obfuscated Base64 encoded data>\n\nAs is common with trojans, the communication is always initiated by the trojan on the device\nto the C2. The request codes are actually replies to the C2 action requests, which are\nactually called \"responses.\" There are 27 response codes that the C2 can use to make\nrequests to the trojan, which pretty much match what's listed in the capabilities section.\n\n\nError\nRegistration\nOk\nEmpty\nSendSMS\nRequestGoogleCC\nWipe\nOpenBrowser\nSendUSSD\n\n\nRequestSMSList\nRequestAppList\nRequestLocation\nShowNotification\nSetLockPassword\nLockNow\nMuteSound\nLoadScript\nLoadPlugin\n\n\nServerChange\nStartApp\nCallPhone\nSetPingTimer\nSMSBroadcast\nRequestContacts\nAddInject\nRemoveInject\nEvaluate\n\n\nAnother feature of this trojan is the ability to register injects, which are JavaScript snippets of\ncode. These will be executed in a WebView object created by the trojan. This gives the\noperators the capability to trick the user into accessing any site while stealing the user's\ncookies or forging form fields, like account numbers or phone numbers.\n\n## Trojan activity\n\nAt the time of the writing of this post, all URLs (see IOC section) found on the sample were\ninactive, and it does not seem to be widespread. There are some indicators that this sample\nis just a test sample on its final stages of development. There are several strings and labels\nstill mentioning 'test' or 'testcc' — even the URL used for the credit card data exfiltration is\nnamed \"testcc.php.\"\n\n\n-----\n\nDebug information on logcat\n\nAnother indicator is the amount of debugging information the trojan is still generating — a\nproduction-level trojan would keep its logging to a minimum.\n\nThe only sample was found on public repositories and almost seemed to indicate a test run\nto determine the detection ratio of the sample. We have observed this trojan being submitted\nto public antivirus testing platforms, once as a package and once for each DLL to determine\nthe detection ratio. The sample analyzed was targeted at Russian-speaking users, as most\nof the user interaction pages are written in Russian. However, given the way the trojan is\nbuilt, it is highly customizable, meaning that adapting it to a different language would be\nextremely easy. The wide range of capabilities doesn't limit this trojan to a specific malicious\nactivity like a banking trojan or a ransomware. This makes it impossible to create a target\nprofile.\n\n## Conclusion\n\nThis trojan shows a new path for threats to evolve. Having the ability to move code from\ndesktops to mobile platforms with no effort, like the eCommon.DLL demonstrates that\nmalicious actors can create hybrid threats faster and with fewer resources involved than ever\nbefore. This trojan's design and implementation is of an uncommonly high level, making it a\ndangerous threat. These kinds of threats will become more common, as more and more\ncompanies decide to publish their software directly to consumers.\n\nThere have been several recent examples of companies choosing to release their software\ndirectly to consumers, bypassing traditional storefronts. The average user might not have the\nnecessary skills to distinguish legitimate sites from malicious ones. We've seen that this has\nbeen the case for many years with spear-phishing campaigns on desktop and mobile\nplatforms, so, unfortunately, it doesn't seem that this will change any time soon. And this just\nmeans attackers will continue to be successful.\n\n\n-----\n\n## Coverage\n\nAdditional ways our customers can detect and block this threat are listed below.\n\n[Advanced Malware Protection (AMP) is ideally](https://www.cisco.com/c/en/us/products/security/advanced-malware-protection)\n\nsuited to prevent the execution of the malware used by these threat actors.\n\n[Cisco Cloud Web Security (CWS) or Web Security Appliance (WSA) web scanning prevents](https://www.cisco.com/c/en/us/products/security/cloud-web-security/index.html)\naccess to malicious websites and detects malware used in these attacks.\n\n[Email Security can block malicious emails sent by threat actors as part of their campaign.](https://www.cisco.com/c/en/us/products/security/email-security-appliance/index.html)\n\n[Network Security appliances such as Next-Generation Firewall (NGFW), Next-Generation](https://www.cisco.com/c/en/us/products/security/firewalls/index.html)\n[Intrusion Prevention System (NGIPS), and Meraki MX can detect malicious activity](https://meraki.cisco.com/products/appliances)\nassociated with this threat.\n\n[AMP Threat Grid helps identify malicious binaries and build protection into all Cisco Security](https://www.cisco.com/c/en/us/solutions/enterprise-networks/amp-threat-grid/index.html)\nproducts.\n\n[Umbrella, our secure internet gateway (SIG), blocks users from connecting to malicious](https://umbrella.cisco.com/)\ndomains, IPs, and URLs, whether users are on or off the corporate network.\n\nOpen Source Snort Subscriber Rule Set customers can stay up to date by downloading the\n[latest rule pack available for purchase on Snort.org.](https://www.snort.org/products)\n\n## Indicators of compromise (IOC)\n\n**URLs**\n\nhxxp://5.9.33.226:5416\n\n\n-----\n\nhxxp://172.110.10.171:85/testcc.php\nhxxp://sub1.tdsworker.ru:5555/3ds/\n\n**Hash values**\nPackage.apk A342a16082ea53d101f556b50532651cd3e3fdc7d9e0be3aa136680ad9c6a69f\neCommon.dl - 604deb75eedf439766896f05799752de268baf437bf89a7185540627ab4a4bd1\nReznov.dll - 17b8665cdbbb94482ca970a754d11d6e29c46af6390a2d8e8193d8d6a527dec3\n\n**Custom activity prefix**\ncom.cact.CAct\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-10-11 - GPlayed Trojan - .Net playing with Google Market.pdf"
    ],
    "report_names": [
        "2018-10-11 - GPlayed Trojan - .Net playing with Google Market.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536164,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653786631,
    "ts_modification_date": 1653786631,
    "files": {
        "pdf": "https://archive.orkl.eu/be6e7318018341fc5f738e4ec2c48e7626df881a.pdf",
        "text": "https://archive.orkl.eu/be6e7318018341fc5f738e4ec2c48e7626df881a.txt",
        "img": "https://archive.orkl.eu/be6e7318018341fc5f738e4ec2c48e7626df881a.jpg"
    }
}