{
    "id": "77437536-a9d5-4fd1-b107-4d353fd488db",
    "created_at": "2022-10-25T16:48:11.28491Z",
    "updated_at": "2025-03-27T02:09:18.783697Z",
    "deleted_at": null,
    "sha1_hash": "34560d1903165277659d65f52594cebe7aae768f",
    "title": "",
    "authors": "",
    "file_creation_date": "2021-05-06T14:06:38Z",
    "file_modification_date": "2021-05-06T14:06:39Z",
    "file_size": 241061,
    "plain_text": "# Evicting Maze\n\n## Talos and SecureX stop an active attack cold in its tracks\n\n\nIn the summer of 2020, a manufacturing company received\na phishing email containing a malicious attachment. After\nan employee opened the email, several suspicious activities\noccurred, including the execution of encoded PowerShell\ncommands to obtain elevated privileges, with indications of\nuse of the penetration-testing tool Cobalt Strike.\n\nIn the week that followed, the company received a\nnotification from Cisco SecureX Threat Hunting warning\nabout the PowerShell execution as a potential precursor to\na ransomware attack. The company soon contacted CTIR at\nthe behest of their legal counsel.\n\nCTIR provided emergency response services, including\nincident command, expert guidance on containment and\nremediation, forensic analysis, threat intelligence and reverseengineering. CTIR began reviewing data from the Secure\nEndpoint, SecureX Cloud Edge, and Secure Network Analytics\nconsoles, as well as triage data from affected hosts.\n\nLeveraging threat intelligence from Talos’ Threat\nIntelligence and Interdiction team, CTIR and Talos\nconcluded that the activity Cisco SecureX Threat Hunting\nalerted on was likely the beginning stages of a Maze\nransomware attack. Now allegedly disbanded, Maze was\none of the more notorious ransomware families of late,\nengaging in “big game hunting,” or targeting prominent\norganizations for large ransoms, and innovating the practice\nof exfiltrating data prior to dropping their ransomware, and\nthen threatening to release the stolen data as another lever\nto compel victims to pay the ransom.\n\nMaze adversaries typically maintain a long dwell time on the\nvictim network as they search for privileged accounts and\nsensitive information. CTIR assessed that the adversaries\nhad indeed been on the network several weeks before\nCTIR was engaged. However, this dwell time provided an\nopportunity for CTIR to identify the threat actor and thwart\nthe more destructive elements of the attack.\n\nFrom previous Maze attacks, Talos had developed a\nplaybook that matched typical Maze tactics, techniques\nand procedures (TTPs) to ATT&CK information, as well as\nassociated search strings in Secure Endpoint.\n\n\nWhile reviewing malicious activity in Secure Endpoint data\nand associated ATT&CK information, CTIR realized that\nmuch of the TTPs appearing in this engagement were\nsimilar to previous Maze incidents. We discovered similar\nsystem information and owner discovery. The attackers\n[also leveraged procdump for credential dumping and](https://docs.microsoft.com/en-us/sysinternals/downloads/procdump)\nused privileged accounts to traverse the network. All of\nthese TTPs looked identical to what was happening at the\nmanufacturing company. The use of Cobalt Strike and a\ncommand and control (C2) IP address previously associated\nwith a Maze attack confirmed the likely connection to Maze.\n\nCTIR had additionally drawn up guides for combating Maze\nattacks and remediation strategies. Because of this, CTIR\nquickly delivered a plan of action (POA) to the customer\nthe day they were engaged, containing a series of steps to\ntake to prevent the adversary from accessing even more\nsystems, exfiltrating data and dropping their ransomware.\n\nThese steps included:\n\n### • Preparing an Active Directory Domain password reset.\n\n • Changing passwords of accounts in highly\n_privileged groups._\n\n### • Rolling Kerberos Ticket Granting Ticket (KRBTGT)\n_twice._\n\n### • Changing built-in local admin password.\n • Forcing password change on next login for general\n_user accounts._\n\n### • Disabling the ability of the Windows operating\n_system to cache credentials on any device where_\n_credentials are not needed._\n\n### • Installing and setting up Microsoft Local Administrative\nPassword Solutions (LAPS) to provide management of\nand strong passwords for all local administrator accounts.\n\n### • Ensuring that backups are offline and separated from the\nimpacted machines in network\n\n### • Limiting access to PowerShell, PSExec, Windows\nManagement Instrumentation (WMI), Remote Desktop\nProtocol (RDP), SMB and administrative shares to\ntrusted accounts or systems that have a legitimate\naccess to such tools.\n\n\n-----\n\n## Case Study: Evicting Maze\n\nThe customer was very receptive to the plan of action and\nactively began implementing these recommendations.\nThese actions had an immediate effect on the adversary’s\nability to move laterally throughout the network. With\npasswords reset, they had lost their privileged accounts.\nWith access to PowerShell locked down, they could not\nexecute commands. Locking down SMB and RDP prevented\nthem from spreading to more machines on the network,\nand with backups isolated, the potential for encryption\ndecreased.\n\nThe customer also had Secure Endpoint deployed, but\nin Audit mode so that malicious files would be alerted on\nbut not necessarily quarantined. CTIR worked with the\ncustomer to push Secure Endpoint throughout the network\nand ensure it was running in Protect mode.\n\nWith their avenues for lateral movement restricted, the\nadversaries dropped the ransomware binary on all systems\nthey had previously accessed. The adversaries dropped the\nmalicious DLL file on 130 systems. However, with Secure\n\n\nEndpoint running in Protect mode, the file was successfully\nquarantined, and the ransomware component of the attack\nwas prevented.\n\nMeanwhile, Talos safely detonated the ransomware file in\nSecure Malware Analytics. From there, they obtained the\nransom note that confirmed the analysts’ assessment that\nthis was, in fact, a Maze ransomware attack.\n\nCTIR continued analysis and remediation efforts. Although\nsome NetFlow data indicated potential exfiltration, CTIR\nfound no evidence of data staging and, as opposed to many\nother Maze victims, had no stolen information posted on the\nMaze leaks website.\n\nThis engagement exemplifies how CTIR leverages Taloswide resources, past experience and their expertise\nto deliver quick identification of threats as well as\nrecommendations for remediation. With an active customer,\nCTIR prevented one of the most dangerous ransomware\nthreat actors from achieving their goal.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://s3.amazonaws.com/talos-intelligence-site/production/document_files/files/000/095/543/original/CTIR_casestudy_1.pdf"
    ],
    "report_names": [
        "CTIR_casestudy_1.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716491,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1620309998,
    "ts_modification_date": 1620309999,
    "files": {
        "pdf": "https://archive.orkl.eu/34560d1903165277659d65f52594cebe7aae768f.pdf",
        "text": "https://archive.orkl.eu/34560d1903165277659d65f52594cebe7aae768f.txt",
        "img": "https://archive.orkl.eu/34560d1903165277659d65f52594cebe7aae768f.jpg"
    }
}