{
    "id": "b25e7019-8e68-4961-b855-8444d21297d2",
    "created_at": "2023-01-12T15:07:51.868381Z",
    "updated_at": "2025-03-27T02:16:25.622956Z",
    "deleted_at": null,
    "sha1_hash": "4c113063d87ee0d77c5b3a5de8faf813eacc0b41",
    "title": "2022-09-02 - Sharkbot is back in Google Play",
    "authors": "",
    "file_creation_date": "2022-10-02T12:01:53Z",
    "file_modification_date": "2022-10-02T12:01:53Z",
    "file_size": 2008035,
    "plain_text": "# Sharkbot is back in Google Play\n\n**[blog.fox-it.com/2022/09/02/sharkbot-is-back-in-google-play/](https://blog.fox-it.com/2022/09/02/sharkbot-is-back-in-google-play/)**\n\n**Authored by Alberto Segura (main author) and Mike Stokkel (co-author)**\n\n## Introduction\n\n\nSeptember 2, 2022\n\n\n[After we discovered in February 2022 the SharkBotDropper in Google Play posing as a fake](https://blog.fox-it.com/2022/03/03/sharkbot-a-new-generation-android-banking-trojan-being-distributed-on-google-play-store/)\nAndroid antivirus and cleaner, now we have detected a new version of this dropper active in\nthe Google Play and dropping a new version of Sharkbot.\n\nThis new dropper doesn’t rely Accessibility permissions to automatically perform the\ninstallation of the dropper Sharkbot malware. Instead, this new version ask the victim to\ninstall the malware as a fake update for the antivirus to stay protected against threats.\n\nWe have found two SharkbotDopper apps active in Google Play Store, with 10K and 50K\ninstalls each of them.\n\n\n-----\n\nThe Google Play droppers are downloading the full featured Sharkbot V2, discovered some\n[time ago by ThreatFabric. On the 16th of August 2022, Fox-IT’s Threat Intelligence team](https://twitter.com/ThreatFabric/status/1524767906780831750)\nobserved new command-and-control servers (C2s), that were providing a list of targets\nincluding banks outside of United Kingdom and Italy. The new targeted countries in those\nC2s were: Spain, Australia, Poland, Germany, United States of America and Austria.\n\nOn the 22nd of August 2022, Fox-IT’s Threat Intelligence team found a new Sharkbot\nsample with version 2.25; communicating with command-and-control servers mentioned\npreviously. This Sharkbot version introduced a new feature to steal session cookies from the\nvictims that logs into their bank account.\n\n\n-----\n\n## The new SharkbotDropper in Google Play\n\nIn the previous versions of SharkbotDropper, the dropper was abusing accessibility\npermissions in order to install automatically the dropper malware. To do this, the dropper\nmade a request to its command-and-control server, which provided an URL to download the\nfull featured Sharkbot malware and a list of steps to automatically install the malware, as we\ncan see in the following image.\n\nAbusing the accessibility permissions, the dropper was able to automatically click all the\nbuttons shown in the UI to install Sharkbot. But this not the case in this new version of the\ndropper for Sharkbot. The dropper instead will make a request to the C2 server to directly\nreceive the APK file of Sharkbot. It won’t receive a download link alongside the steps to\ninstall the malware using the ‘Automatic Transfer Systems’ (ATS) features, which it normally\ndid.\n\nIn order to make this request, the dropper uses the following code, in which it prepares the\nPOST request body with a JSON object containing information about the infection. The body\nof the request is encrypted using RC4 and a hard coded key.\n\n\n-----\n\nIn order to complete the installation on the infected device, the dropper will ask the user to\ninstall this APK as an update for the fake antivirus. Which results in the malware starting an\nAndroid Intent to install the fake update.\n\nThis way, the new version of the Sharkbot dropper is now installing the payload in a non\nautomatic way, which makes it more difficult to get installed – since it depends on the user\ninteraction to be installed -, but it is now more difficult to detect before being published in\n\n\n-----\n\nGoogle Play Store, since it doesn t need the accessibility permissions which are always\nsuspicious.\n\nBesides this, the dropper has also removed the ‘Direct Reply’ feature, used to automatically\nreply to the received notifications on the infected device. This is another feature which needs\nsuspicious permissions, and which once removed makes it more difficult to detect.\n\nTo make detection of the dropper by Google’s review team even harder, the malware\ncontains a basic configuration hard coded and encrypted using RC4, as we can see in the\nfollowing image.\n\nThe decrypted configuration, as we can see in the following image, contains the list of\ntargeted applications, the C2 domain and the countries targeted by the campaign (in this\nexample UK and Italy).\n\nIf we look carefully at the code used to check the installed apps against the targeted apps,\nwe can realize that it first makes another check in the first lines:\n\n\n-----\n\n```\nString lowerCase ((TelephonyManager)\nApp.f7282a.getSystemService(\"phone\")).getSimCountryIso().toLowerCase();\n\n  if (!lowerCase.isEmpty() && this.f.getString(0).contains(lowerCase))\n\n```\nBesides having at least one of the targeted apps installed in the device, the SharkbotDropper\nis checking if the SIM provider’s country code is one of the ones included in the configuration\n– in this campaign it must be GB or IT. If it matches and the device has installed any of the\ntargeted apps, then the dropper can request the full malware download from the C2 server.\nThis way, it is much more difficult to check if the app is dropping something malicious. But\nthis is not the only way to make sure only targeted users are infected, the app published in\nGoogle Play is only available to install in United Kingdom and Italy.\n\nAfter the dropper installs the actual Sharkbot v2 malware, it’s time for the malware to ask for\naccessibility permissions to start stealing victim’s information.\n\n## Sharkbot 2.25-2.26: New features to steal cookies\n\nThe Sharkbot malware keeps the usual information stealing features we introduced in our\nfirst post about Sharkbot:\n\nInjections (overlay attacks): this feature allows Sharkbot to steal credentials by showing\na fake website (phishing) inside a WebView. It is shown as soon as the malware\ndetects one of the banking application has been opened.\n\n\n-----\n\nKeylogging: this feature allows Sharkbot to receive every accessibility event produced\nin the infected device, this way, it can log events such as button clicks, changes in\nTextFields, etc, and finally send them to the C2.\n\n\n-----\n\nSMS intercept: this feature allows Sharkbot to receive every text message received in\nthe device, and send it to the C2.\n\n\n-----\n\nRemote control/ATS: this feature allows Sharkbot to simulate accessibility events such\nas button clicks, physical button presses, TextField changes, etc. It is used to\nautomatically make financial transactions using the victim’s device, this way the threat\nactors don’t need to log in to the stolen bank account, bypassing a lot of the security\nmeasures.\n\nThose features were present in Sharkbot 1, but also in Sharkbot 2, which didn’t change too\nmuch related to the implemented features to steal information. As ThreatFabric pointed out in\ntheir [tweet, Sharkbot 2, which was detected in May 2022, is a code refactor of the malware](https://twitter.com/ThreatFabric/status/1524767906780831750)\nand introduces a few changes related to the C2 Domain Generation Algorithm (DGA) and the\nprotocol used to communicate with the server.\n\nVersion 2 introduced a new DGA, with new TLDs and new code, since it now uses MD5 to\ngenerate the domain name instead of Base64.\n\nWe have not observed any big changes until version 2.25, in which the developers of\nSharkbot have introduced a new and interesting feature: Cookie Stealing or Cookie logger.\nThis new feature allows Sharkbot to receive an URL and an User-Agent value – using a new\ncommand ‘logsCookie’ -, these will be used to open a WebView loading this URL – using the\nreceived User-Agent as header – as we can see in the following images of the code.\n\n\n-----\n\nOnce the victim logged in to his bank account, the malware will receive the PageFinished\nevent and will get the cookies of the website loaded inside the malicious WebView, to finally\nsend them to the C2.\n\n\n-----\n\n## New campaigns in new countries\n\nDuring our research, we observed that the newer C2 servers are providing new targeted\napplications in Sharkbot’s configuration. The list of targeted countries has grown including\n**Spain, Australia, Poland, Germany, United States of America and Austria. But the**\ninteresting thing is the new targeted applications are not targeted using the typical\nwebinjections, instead, they are targeted using the keylogging – grabber – features. This\nway, the malware is stealing information from the text showed inside the official app. As we\ncan see in the following image, the focus seems to be getting the account balance and, in\nsome cases, the password, by reading the content of specific TextFields.\n\n\n-----\n\nAlso, for some of the targeted applications, the malware is providing within the configuration\na list of ATS configurations used to avoid the log in based on fingerprint, which should allow\nto show the usual username and password form. This allows the malware to steal the\ncredentials using the previously mentioned ‘keylogging’ features, since log in via fingerprint\nshould ask for credentials.\n\n\n-----\n\n## Conclusion\n\nSince we published our first blog post about Sharkbot in March 2022, in which we detected\nthe SharkbotDropper campaigns within Google Play Store, the developers have been\nworking hard to improve their malware and the dropper. In May, ThreatFabric found a new\nversion of Sharkbot, the version 2.0 of Sharkbot that was a refactor of the source code,\nincluded some changes in the communication protocol and in the DGA.\n\nUntil now, Sharkbot’s developers seem to have been focusing on the dropper in order to\nkeep using Google Play Store to distribute their malware in the latest campaigns. These\nlatest campaigns still use fake antivirus and Android cleaners to install the dropper from the\nGoogle Play.\n\nWith all these the changes and new features, we are expecting to see more campaigns,\ntargeted applications, targeted countries and changes in Sharkbot this year.\n\n## Indicators of compromise\n\nSharkbotDropper samples published in Google Play:\n\n**hxxps://play.google[.]com/store/apps/details?id=com.kylhavy.antivirus**\n**hxxps://play.google[.]com/store/apps/details?id=com.mbkristine8.cleanmaster**\n\nDropper Command-and-control (C2):\n\n**hxxp://mefika[.]me/**\n\nSharkbot 2.25 (introducing new Cookie stealing features):\n\nHash: 7f2248f5de8a74b3d1c48be0db574b1c6558d6edae347592b29dc5234337a5ff\nC2: hxxp://browntrawler[.]store/ (185.212.47[.]113)\n\n\n-----\n\nSharkbot v2.26 sample:\n\nHash: 870747141b1a2afcd76b4c6482ce0c3c21480ae3700d9cb9dd318aed0f963c58\nC2: hxxp://browntrawler[.]store/ (185.212.47[.]113)\n\nDGA Active C2s:\n\n**23080420d0d93913[.]live (185.212.47[.]113)**\n**7f3e61be7bb7363d[.]live (185.212.47[.]113)**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-09-02 - Sharkbot is back in Google Play.pdf"
    ],
    "report_names": [
        "2022-09-02 - Sharkbot is back in Google Play.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536071,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1664712113,
    "ts_modification_date": 1664712113,
    "files": {
        "pdf": "https://archive.orkl.eu/4c113063d87ee0d77c5b3a5de8faf813eacc0b41.pdf",
        "text": "https://archive.orkl.eu/4c113063d87ee0d77c5b3a5de8faf813eacc0b41.txt",
        "img": "https://archive.orkl.eu/4c113063d87ee0d77c5b3a5de8faf813eacc0b41.jpg"
    }
}