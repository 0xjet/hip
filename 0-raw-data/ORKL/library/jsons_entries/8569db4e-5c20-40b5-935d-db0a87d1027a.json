{
    "id": "8569db4e-5c20-40b5-935d-db0a87d1027a",
    "created_at": "2022-10-25T16:48:24.950492Z",
    "updated_at": "2025-03-27T02:11:34.709269Z",
    "deleted_at": null,
    "sha1_hash": "10a5f550f9265c745b75db913753bbed6c9a0413",
    "title": "APT Targets Financial Analysts with CVE-2017-0199",
    "authors": "Proofpoint",
    "file_creation_date": "2017-06-28T04:00:29Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 997964,
    "plain_text": "# g y\n\n**[proofpoint.com /us/threat-insight/post/apt-targets-financial-analysts](https://www.proofpoint.com/us/threat-insight/post/apt-targets-financial-analysts)**\n\nOn April 20, Proofpoint observed a targeted campaign focused on financial analysts working at top global financial\nfirms operating in Russia and neighboring countries. These analysts were linked by their coverage of the\ntelecommunications industry, making this targeting very similar to, and likely a continuation of, activity described in\n[our “In Pursuit of Optical Fibers and Troop Intel ” blog. This time, however, attackers opportunistically used spear-](https://www.proofpoint.com/us/threat-insight/post/PlugX-in-Russia)\n[phishing emails with a Microsoft Word attachment exploiting the recently patched CVE-2017-0199 to deploy the](https://www.proofpoint.com/us/threat-insight/post/dridex-campaigns-millions-recipients-unpatched-microsoft-zero-day)\n[ZeroT Trojan, which in turn downloaded the PlugX Remote Access Trojan (RAT).](https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx)\n\nProofpoint is tracking this attacker, believed to operate out of China, as TA459. The actor typically targets Central\nAsian countries, Russia, Belarus, Mongolia, and others. TA549 possesses a diverse malware arsenal including\nPlugX, NetTraveler, and ZeroT. [1][2][3]\n\nIn this blog, we also document other 2017 activity so far by this attack group, including their distribution of ZeroT\nmalware and secondary payloads PCrat/Gh0st.\n\n**Analysis**\n\nIn this campaign, attackers used a Microsoft Word document called 0721.doc, which exploits CVE-2017-0199. This\nvulnerability was disclosed and patched days prior to this attack.\n\n_Figure 1: Microsoft Word document 0721.doc_\n\nThe document uses the logic flaw to first download the file power.rtf from hxxp://122.9.52[.]215/news/power.rtf. The\npayload is actually an HTML Application (HTA) file, not an RTF document.\n\n\n-----\n\n_Figure 2: The first script downloaded by the exploit document is an HTA file_\n\nAs shown in the figure above, the HTA’s VBScript changes the window size and location and then uses PowerShell\nto download yet another script: power.ps1. This is a PowerShell script that downloads and runs the ZeroT payload\ncgi.exe.\n\n_Figure 3: The second script downloaded by the exploit document is a PowerShell script_\n\n_Figure 4: Combined network traffic showing the document downloading its payloads_\n\n**ZeroT and other payloads**\n\nThe attack group has made incremental changes to ZeroT since our last analysis. While they still use RAR SFX\nformat for the initial payloads, ZeroT now uses a the legitimate McAfee utility (SHA256\n3124fcb79da0bdf9d0d1995e37b06f7929d83c1c4b60e38c104743be71170efe) named mcut.exe instead of the\nNorman Safeground AS for sideloading as they have in the past. The encrypted ZeroT payload, named Mctl.mui, is\ndecoded in memory revealing a similarly tampered PE header and only slightly modified code when compared to\nZeroT payloads we analyzed previously.\n\nOnce ZeroT is running, we observed that the fake User-Agent used in the requests changed from “Mozilla/6.0\n(compatible; MSIE 10.0; Windows NT 6.2; Tzcdrnt/6.0)” to “Mozilla/6.0 (compatible; MSIE 11.0; Windows NT 6.2)”,\nthus removing the “Tzcdrnt” typo observed in previous versions. The initial beacon to index.php changed to index.txt\nbut ZeroT still expects an RC4-encrypted response using a static key: “(*^GF(9042&*”.\n\n\n-----\n\n_Figure 5: ZeroT initial beacon over HTTP requesting URL configuration_\n\nNext, ZeroT uses HTTP beacons to transmit information about the infected system to the command and control\n(C&C). All posts are encrypted, unlike the last time we analyzed a sample from this actor, when the first POST was\naccidentally not encrypted. After that, stage 2 payloads are still retrieved as Bitmap (BMP) images that use Least\nSignificant Bit (LSB) Steganography to hide the real payloads. These images appear normal in image viewers.\n\n_Figure 6: Collage of example BMP images containing stage 2 payloads hidden using LSB steganography_\n\nThe stage 2 payload was PlugX that beaconed to C&C servers www[.]icefirebest[.]com and www[.]icekkk[.]net.\n\n\n-----\n\n_Figure 7: ZeroT and PlugX HTTP network activity_\n\n**Additional 2017 activity by TA459**\n\nThroughout 2017 we observed this threat actor actively attempting to compromise victims with various malware\npayloads. ZeroT remained the primary stage 1 payload, but the stage 2 payloads varied. One such interesting\nexample was “ПЛАН РЕАЛИЗАЦИИ ПРОЕКТА.rar” (SHA256\nb5c208e4fb8ba255883f771d384ca85566c7be8adcf5c87114a62efb53b73fda). Translated from Russian, this file is\nnamed “PROJECT REALIZATION PLAN” and contains a compressed .scr executable. This ZeroT executable\ncommunicated with the C&C domain www[.]kz-info[.]net and downloaded PlugX as well as an additional\nPCRat/Gh0st Trojan which communicated with the www[.]ruvim[.]net C&C server. PCRat/Gh0st is a payload that we\ndo not see this group using frequently.\n\nAnother interesting ZeroT sample (SHA256\nbc2246813d7267608e1a80a04dac32da9115a15b1550b0c4842b9d6e2e7de374) contained the executable\n0228.exe and a decoy document 0228.doc in the RAR SFX archive. Bundling decoy documents is a common tactic\nby this group. RAR SFX directives are used to display the decoy while the malicious payload is executed. We\nsuspect that this specific lure was copied from the news article hxxp://www.cis.minsk[.]by/news.php?id=7557. This\narticle was about “73-го заседания Экономического совета СНГ”, translated from Russian as “73rd meeting of the\nCIS Economic Council”, which describes a meeting held in Moscow by the Commonwealth of Independent States\n(CIS) countries, an organization that includes nine out of the fifteen former Soviet Republics.\n\n\n-----\n\n_Figure 8: Decoy document_\n\n_Figure 9: The believed source of the text in decoy document_\n\n**Conclusion**\n\nTA459 is well-known for targeting organizations in Russia and neighboring countries. However, their strategy,\ntactics, techniques, and procedures in this particular attack emphasize the importance of rigorous patching regimens\nf ll i ti E ft l biliti ft t k b k t t h l it d i l\n\n\n-----\n\nthoughtful end user education. Paying attention to the details of past attacks is also an important means of preparing\nfor future attacks. Noting who is targeted, with what malware, and with what types of lures provide clues with which\norganizations can improve their security posture.\n\nAt the same time, multinational organizations like the financial services firms targeted here must be acutely aware of\nthe threats from state-sponsored actors working with sophisticated malware to compromise users and networks.\nOngoing activity from attack groups like TA459 who consistently target individuals specializing in particular areas of\nresearch and expertise further complicate an already difficult security situation for organizations dealing with more\ntraditional malware threats, phishing campaigns, and socially engineered threats every day.\n\n**References**\n\n[[1]https://www.proofpoint.com/us/threat-insight/post/PlugX-in-Russia](https://www.proofpoint.com/us/threat-insight/post/PlugX-in-Russia)\n\n[[3]https://www.proofpoint.com/us/threat-insight/post/nettraveler-apt-targets-russian-european-interests](https://www.proofpoint.com/us/threat-insight/post/nettraveler-apt-targets-russian-european-interests)\n\n[[3]https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx](https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx)\n\n**Indicators of Compromise (IOCs)**\n\n**IOC** **IOC Type** **Description**\n\na64ea888d412fd406392985358a489955b0f7b27da70ff604e827df86d2ca2aa SHA256 0721.doc CVE2017-0199\n\nhxxp://122.9.52[.]215/news/power.rtf URL 0721.doc payload\n\nhxxp://122.9.52[.]215/news/power.ps1 URL 0721.doc payload\n\nhxxp://www.firesyst[.]net/info/net/sports/drag/cgi.exe URL 0721.doc payload\n\nbf4b88e42a406aa83def0942207c8358efb880b18928e41d60a2dc59a59973ba SHA256 ZeroT (cgi.exe)\n\nwww.firesyst[.]net Hostname ZeroT C&C\n\nwww.icekkk[.]net Hostname PlugX C&C\n\n**Indicators of Compromise (IOCs) - Related**\n\n|IOC|IOC Type|Description|\n|---|---|---|\n|a64ea888d412fd406392985358a489955b0f7b27da70ff604e827df86d2ca2aa|SHA256|0721.doc CVE- 2017-0199|\n|hxxp://122.9.52[.]215/news/power.rtf|URL|0721.doc payload|\n|hxxp://122.9.52[.]215/news/power.ps1|URL|0721.doc payload|\n|hxxp://www.firesyst[.]net/info/net/sports/drag/cgi.exe|URL|0721.doc payload|\n|bf4b88e42a406aa83def0942207c8358efb880b18928e41d60a2dc59a59973ba|SHA256|ZeroT (cgi.exe)|\n|www.firesyst[.]net|Hostname|ZeroT C&C|\n|www.icekkk[.]net|Hostname|PlugX C&C|\n\n|IOC|IOC Type|Description|\n|---|---|---|\n|www.kz-info[.]net|Hostname|ZeroT C&C|\n|www.firesyst[.]net|Hostname|ZeroT C&C|\n|www.buleray[.]net|Hostname|ZeroT C&C|\n|www.intersu[.]net|Hostname|ZeroT C&C|\n|868ee879ca843349bfa3d200f858654656ec3c8128113813cd7e481a37dcc61a|SHA256|ZeroT|\n\n\n-----\n\n|5fd61793d498a395861fa263e4438183a3c4e6f1e4f098ac6e97c9d0911327bf|SHA256|ZeroT|\n|---|---|---|\n|b5c208e4fb8ba255883f771d384ca85566c7be8adcf5c87114a62efb53b73fda|SHA256|ZeroT|\n|ab4cbfb1468dd6b0f09f6e74ac7f0d31a001d396d8d03f01bceb2e7c917cf565|SHA256|ZeroT|\n|79bd109dc7c35f45b781978436a6c2b98a5df659d09dee658c2daa4f1984a04e|SHA256|ZeroT|\n|www.icekkk[.]net|Hostname|PlugX C&C|\n|www.icefirebest[.]com|Hostname|PlugX C&C|\n|www.ruvim[.]net|Hostname|PlugX C&C|\n\n\n**ET and ETPRO Suricata/Snort Coverage**\n\n2821028 | ETPRO TROJAN APT.ZeroT CnC Beacon HTTP POST\n\n2825365 | ETPRO TROJAN APT.ZeroT CnC Beacon Fake User-Agent\n\n2824641 | ETPRO TROJAN APT.ZeroT Receiving Config\n\n2810326 | ETPRO TROJAN PlugX Related Checkin\n\n2024196 | ET WEB_CLIENT HTA File containing Wscript.Shell Call - Potential Office Exploit Attempt\n\n2024197 | ET CURRENT_EVENTS SUSPICIOUS MSXMLHTTP DL of HTA (Observed in RTF 0-day )\n\n2016922 | ET TROJAN Backdoor family PCRat/Gh0st CnC traffic\n\n2021716 | ET TROJAN Backdoor family PCRat/Gh0st CnC traffic (OUTBOUND) 102\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/thla4hs15c78z638bw7g5fmjlixmex9b"
    ],
    "report_names": [
        "Proofpoint_APT-Targets-Financial-Analysts-CVE-2017-0199(04-27-2017)"
    ],
    "threat_actors": [
        {
            "id": "0bf35542-9ebc-44a9-b319-b6df0bee4bac",
            "created_at": "2022-10-25T15:50:23.437853Z",
            "updated_at": "2025-03-27T02:00:55.468981Z",
            "deleted_at": null,
            "main_name": "TA459",
            "aliases": [
                "TA459"
            ],
            "source_name": "MITRE:TA459",
            "tools": [
                "gh0st RAT",
                "NetTraveler",
                "PlugX",
                "ZeroT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "7041fcf5-b34d-47c3-be4c-3c40f243af89",
            "created_at": "2023-01-06T13:46:38.611261Z",
            "updated_at": "2025-03-27T02:00:02.872972Z",
            "deleted_at": null,
            "main_name": "TA459",
            "aliases": [
                "G0062"
            ],
            "source_name": "MISPGALAXY:TA459",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "808d8d52-ca06-4a5f-a2c1-e7b1ce986680",
            "created_at": "2022-10-25T16:07:23.899157Z",
            "updated_at": "2025-03-27T02:02:10.019417Z",
            "deleted_at": null,
            "main_name": "NetTraveler",
            "aliases": [
                "APT 21",
                "Hammer Panda",
                "NetTraveler",
                "TEMP.Zhenbao"
            ],
            "source_name": "ETDA:NetTraveler",
            "tools": [
                "Agent.dhwf",
                "Destroy RAT",
                "DestroyRAT",
                "Kaba",
                "Korplug",
                "NetTraveler",
                "Netfile",
                "PlugX",
                "RedDelta",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "TravNet",
                "Xamtrav"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "254f2fab-5834-4d90-9205-d80e63d6d867",
            "created_at": "2023-01-06T13:46:38.31544Z",
            "updated_at": "2025-03-27T02:00:02.802896Z",
            "deleted_at": null,
            "main_name": "APT21",
            "aliases": [
                "HAMMER PANDA",
                "TEMP.Zhenbao",
                "NetTraveler"
            ],
            "source_name": "MISPGALAXY:APT21",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "802552ac-1f16-4b85-8d78-76d683684124",
            "created_at": "2022-10-25T16:07:24.28032Z",
            "updated_at": "2025-03-27T02:02:10.158732Z",
            "deleted_at": null,
            "main_name": "TA459",
            "aliases": [],
            "source_name": "ETDA:TA459",
            "tools": [
                "Agent.dhwf",
                "AngryRebel",
                "Destroy RAT",
                "DestroyRAT",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "Kaba",
                "Korplug",
                "Moudour",
                "Mydoor",
                "NetTraveler",
                "Netfile",
                "PCRat",
                "PlugX",
                "RedDelta",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "TravNet",
                "Xamtrav",
                "ZeroT"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716504,
    "ts_updated_at": 1743041494,
    "ts_creation_date": 1498622429,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/10a5f550f9265c745b75db913753bbed6c9a0413.pdf",
        "text": "https://archive.orkl.eu/10a5f550f9265c745b75db913753bbed6c9a0413.txt",
        "img": "https://archive.orkl.eu/10a5f550f9265c745b75db913753bbed6c9a0413.jpg"
    }
}