{
    "id": "7b6bb785-b133-490c-a3b7-4777ecba00b4",
    "created_at": "2022-10-25T16:48:11.970053Z",
    "updated_at": "2025-03-27T02:16:20.82665Z",
    "deleted_at": null,
    "sha1_hash": "3679bcb061a90c9daee667fa244a4d159c195f89",
    "title": "",
    "authors": "",
    "file_creation_date": "2018-02-09T12:23:14Z",
    "file_modification_date": "2018-02-09T12:23:14Z",
    "file_size": 729352,
    "plain_text": "# Hey Uroburos! What's up ?\n\n_ExaTrack - Stéfan Le Berre (stefan.le-berre [at] exatrack.com)_\n\nUroburos is a malware / APT, detected in 2014, that had been a big deal in the world of computer\nsecurity. It distinguished itself from others by his 64b (rootkit) driver for Windows, including a bypass\nof PatchGuard. Moreover the driver is not signed, the malware leveraged a vulnerability in a third\nparty driver to get kernel execution. For more details about past research on this malware, you can\nread the Andrzej Dereszowski and Matthieu Kaczmarek’s publication in reference [1].\n\nA few months ago now we have identified an Uroburos/Turla sample dating from 2017. After\ninvestigation the driver turned out to be an evolution of the one used in 2014. We had a look at this\nnew driver and discovered that it had some serious differences with the original despite an common\nbase. In this paper we present an analysis of some new behaviours of this 64-bit rootkit.\n\nThe analysis will focus on the identification of the rootkit from a memory dump (as we would do\nduring a search for compromise), then we will study a part of its new communication protocol. The\ngoal is to be able to spot the presence of the rootkit remotely without requiring an authentication on\nthe server. It should be noted that the rootkit only targets servers.\n\nThe code we will analyze is:\n[https://www.virustotal.com/en/file/f28f406c2fcd5139d8838b52da703fc6ffb8e5c00261d86aec90c28](https://www.virustotal.com/en/file/f28f406c2fcd5139d8838b52da703fc6ffb8e5c00261d86aec90c28a20cfaa5b/analysis)\n[a20cfaa5b/analysis](https://www.virustotal.com/en/file/f28f406c2fcd5139d8838b52da703fc6ffb8e5c00261d86aec90c28a20cfaa5b/analysis)\n\nTo put ourself in the situation of a compromise search on a server, we will use the tool Comae\nDumpIt (https://www.comae.io/) and will analyze the generated crashdump.\n\n## Identification of the core compromise\n\nThe driver hides itself quite well in the kernel space, it is not present in the list of loaded modules\nand the integrity of the other modules is correct.\n\nTo assist the analysis we will use an internal tool developed by ExaTrack that aims to check the\nintegrity of the kernel and highlight the potential irregularities present.\n\nThe Windows Callback system, which allow arbitrary functions to be called during certain events such\nas process creation, is among the critical components we check.\n\nIn our case, by looking at them we identify an anomaly:\n\n\n-----\n\n```\n>>> ccb\n# Check CallBacks\n [*] Checking \\Callback\\TcpConnectionCallbackTemp : 0xfffffa8002f38360\n [*] Checking \\Callback\\TcpTimerStarvationCallbackTemp : 0xfffffa8004dfd640\n [*] Checking \\Callback\\LicensingData : 0xfffffa80024bc2f0\n[...]\n [*] PspLoadImageNotifyRoutine\n [*] PspCreateProcessNotifyRoutine\n Callback fffffa8004bc2874 -> SUSPICIOUS ***Unknown*** 48895c2408574881ec30010000488bfa\n\n```\nThe callbacks in the PspCreateProcessNotifyRoutine list are called when creating a process.\nAdding an entry to it is particularly interesting to modify the data, and therefore the behavior, of a\nnew process. In the previous command, the tool has identified an entry that is considered suspicious\nbecause it points to a memory address that is not assigned to a driver.\n\nA second anomaly is present in the callbacks, it is less visible because it does not impact deeply the\noperation of the system, but it slightly modifies it.\n```\n [...]\n [*] IopNotifyShutdownQueueHead\n Name : Null\n Driver Object : fffffa80032753e0\n  Driver : \\Driver\\Null\n  Address: fffff88001890000\n  Driver : Null.SYS\n Name : 000000a6\n Driver Object : fffffa8003d2adb0\n  Driver : \\Driver\\usbhub\n  Address: fffff88000da6000\n  Driver : usbhub.sys\n[...]\n>>> cirp \\Driver\\Null\n  Driver : \\Driver\\Null\n  Address: fffff88001890000\n  Driver : Null.SYS\n  DriverUnload : fffff88001895100 c:\\windows\\system32\\drivers\\null.sys\n    IRP_MJ_CREATE          fffff88001895008 Null.SYS\n    IRP_MJ_CREATE_NAMED_PIPE     fffff80002abb1d4 ntoskrnl.exe\n    IRP_MJ_CLOSE           fffff88001895008 Null.SYS\n    IRP_MJ_READ           fffff88001895008 Null.SYS\n    IRP_MJ_WRITE           fffff88001895008 Null.SYS\n    IRP_MJ_QUERY_INFORMATION     fffff88001895008 Null.SYS\n    IRP_MJ_SET_INFORMATION      fffff80002abb1d4 ntoskrnl.exe\n    IRP_MJ_QUERY_EA         fffff80002abb1d4 ntoskrnl.exe\n    IRP_MJ_SET_EA          fffff80002abb1d4 ntoskrnl.exe\n    IRP_MJ_FLUSH_BUFFERS       fffff80002abb1d4 ntoskrnl.exe\n    IRP_MJ_QUERY_VOLUME_INFORMATION fffff80002abb1d4 ntoskrnl.exe\n    IRP_MJ_SET_VOLUME_INFORMATION  fffff80002abb1d4 ntoskrnl.exe\n    IRP_MJ_DIRECTORY_CONTROL     fffff80002abb1d4 ntoskrnl.exe\n    IRP_MJ_FILE_SYSTEM_CONTROL    fffff80002abb1d4 ntoskrnl.exe\n    IRP_MJ_DEVICE_CONTROL      fffff80002abb1d4 ntoskrnl.exe\n    IRP_MJ_INTERNAL_DEVICE_CONTROL  fffff80002abb1d4 ntoskrnl.exe\n    IRP_MJ_SHUTDOWN         fffff80002abb1d4 ntoskrnl.exe\n    IRP_MJ_LOCK_CONTROL       fffff88001895008 Null.SYS\n    IRP_MJ_CLEANUP          fffff80002abb1d4 ntoskrnl.exe\n    IRP_MJ_CREATE_MAILSLOT      fffff80002abb1d4 ntoskrnl.exe\n    IRP_MJ_QUERY_SECURITY      fffff80002abb1d4 ntoskrnl.exe\n\n```\n\n-----\n\n```\n    IRP_MJ_SET_SECURITY       fffff80002abb1d4 ntoskrnl.exe\n    IRP_MJ_POWER           fffff80002abb1d4 ntoskrnl.exe\n    IRP_MJ_SYSTEM_CONTROL      fffff80002abb1d4 ntoskrnl.exe\n    IRP_MJ_DEVICE_CHANGE       fffff80002abb1d4 ntoskrnl.exe\n    IRP_MJ_QUERY_QUOTA        fffff80002abb1d4 ntoskrnl.exe\n    IRP_MJ_SET_QUOTA         fffff80002abb1d4 ntoskrnl.exe\n    IRP_MJ_PNP            fffff80002abb1d4 ntoskrnl.exe\n\n```\nThe \"\\Driver\\Null\" driver is referenced in the list of modules to be called when the system is shut\ndown. This driver is not supposed to be in this list. However its IRP table does not seem to have been\nmodified and even points to ntoskrnl (for IRP_MJ_SHUTDOWN interface). We did not identify any\nreal usefulness to that behavior.\n\nLet's continue troubleshooting, Windows has many filter systems in its Input Output (IO) handlers.\nAmong these IO there is the network that is divided into several parts, we will take a deeper look at\none of those: NetIO.\n\nNetIo also offers a system of callbacks which allow to act on the exchanged network data. These\ncallbacks are called \"Callout\" and are therefore network callbacks, the structures are not\ndocumented and do not appear in the Windows symbols. These properties make it a good place to\nimplant a malware. In the dump we can find 5 callbacks that point to code not belonging, again, to\nany driver.\n```\n>>> cnetio\n [*] NetIo Callouts (callbacks) : fffffa8004965000 (4790)\n Callback fffffa8004bd9580 -> SUSPICIOUS ***Unknown*** 488bc448895808488950105556574154\n Callback fffffa8004bca6b0 -> SUSPICIOUS ***Unknown*** 33c0c3cc40534883ec20488b89500100\n Callback fffffa8004bd9af8 -> SUSPICIOUS ***Unknown*** 4883ec286683f91474066683f916750f\n Callback fffffa8004bd9ca0 -> SUSPICIOUS ***Unknown*** 48895c24084889742410574883ec4048\n Callback fffffa8004bd9de0 -> SUSPICIOUS ***Unknown*** 4c8bdc49895b0849896b104989731857\n\n```\nOne of these functions will be studied in more detail later in the document.\n\nFinally we will search for loaded drivers that try to hide from Windows.\n```\n>>> pe\n[...]\n [OK] fffff88001899000 : \\SystemRoot\\System32\\Drivers\\Beep.SYS\n [OK] fffff88000da6000 : \\SystemRoot\\system32\\DRIVERS\\usbhub.sys\n [NO] fffffa8004bb8000 (Header overwritten)\n [OK] fffff88006a00000 : \\SystemRoot\\system32\\DRIVERS\\E1G6032E.sys\n [OK] fffff880017d2000 : \\SystemRoot\\System32\\Drivers\\Npfs.SYS\n[...]\n>>> dq fffffa8004bb8000 100\n FFFFFA8004BB8000 0000000300000000 0000FFFF00000004 ....?...?...¦¦..\n FFFFFA8004BB8010 00000000000000B8 0000000000000040 ........@.......\n FFFFFA8004BB8020 0000000000000000 0000000000000000 ................\n FFFFFA8004BB8030 0000000000000000 000000D800000000 ................\n FFFFFA8004BB8040 CD09B4000EBA1F0E 685421CD4C01B821 ??.?....!.?L.!Th\n FFFFFA8004BB8050 72676F7270207369 6F6E6E6163206D61 is program canno\n FFFFFA8004BB8060 6E75722065622074 20534F44206E6920 t be run in DOS\n\n```\n\n-----\n\n```\n FFFFFA8004BB8070 0A0D0D2E65646F6D 0000000000000024 mode....$.......\n FFFFFA8004BB8080 095520395A3B417D 0955203909552039 }A;Z9 U.9 U.9 U.\n FFFFFA8004BB8090 095520A609542039 0955203C092E28A6 9 T.. U..(..< U.\n FFFFFA8004BB80A0 0955203B0928E61E 095520510938E61E ?.(.; U.?.8.Q U.\n FFFFFA8004BB80B0 09552038092FE61E 09552038092DE61E ?./.8 U.?.-.8 U.\n FFFFFA8004BB80C0 0955203968636952 0000000000000000 Rich9 U.........\n FFFFFA8004BB80D0 0000000000000000 0006866400000000 ............d.?.\n FFFFFA8004BB80E0 000000005900F3CF 202200F000000000 ...Y..........\"\n FFFFFA8004BB80F0 00042E000008020B 000000000001BC00 ??....?...?.....\n>>> list fffffa8004bb8000 fffffa8004bbb000\n  FFFFFA8004BB8000 rwx  FFFFFA8004BB9000 rwx  FFFFFA8004BBA000 rwx\n```\nHere again, an important anomaly is observable. A driver is present in memory and has overwritten\nits MZ and PE headers probably to hide itself from raw memory search. Its addressing corresponds to\nthe callbacks we encoutered before and it is mapped with RWX rights.\n\nAll the elements support the idea that a malware operates from the kernel. We will now analyze\nsome of its code (mainly network communication) to get an idea of how it works.\n\n## Driver analysis\n\n### Entry point\nDuring its initialization the driver quickly targets the \"Null\" device. It retrieves a pointer to the object\nand registers it in the list of \"shutdown\" callbacks mentioned previously. It also registers its callback\ncalled during process creations.\n```\n[...]\n   if ( (unsigned int)get_top_deviceObjet(L\"\\\\Device\\\\Null\", &device_obj_null)\n    && (result = get_top_deviceObjet(L\"\\\\Device\\\\Beep\", &device_obj_null),\n(_DWORD)result) )\n   {\n    __asm { xchg  rbx, qword ptr cs:isNullDeviceFailed }\n   }\n   else\n   {\n    v5 = IoRegisterShutdownNotification(device_obj_null);\n    if ( v5 || (drvobj_null = device_obj_null->DriverObject, (v5 =\nsub_4E21C(byte_1188D)) != 0) )\n[...]\n      PsSetCreateProcessNotifyRoutine(cbCreateProcess, 0i64);\n[...]\n\n### Encrypting strings\n```\nTo avoid easy identification by anti-virus all of the Uroburos related strings are encrypted. Each block\nof encrypted data is 0x40 bytes, a XOR operation is performed with the previous 0x40 bytes.\n\n\n-----\n\nThe decryption function can be represented as follows (an oneliner is simpler for IDA). It is thus\npossible to decipher all the chains.\n```\nPython>def decrypt(addr, clen): return ''.join(chr(b) for b in\n[struct.unpack('B'*clen,idaapi.get_many_bytes(addr,64))[a] ^\nstruct.unpack('B'*clen,idaapi.get_many_bytes(addr-clen,clen))[a] for a in xrange(clen)])\nPython>[decrypt( 0x53530 + (i*0x80), 0x40).replace(\"\\x00\",'') for i in xrange(38)]\n['system', 'isapi_http', 'isapi_log', 'isapi_dg', 'isapi_openssl', 'shell.{F21EDC09-85D34eb9-915F-1AFA2FF28153}', 'Hd1', 'Hd2', 'RawDisk1', 'RawDisk2', 'wininet_activate',\n'dmtev', 'Ultra3', 'Ultra3', 'services_control', 'fixdata.dat', '$NtUninstallQ817473$',\n'fdisk.sys', 'fdisk_mon.exe', '400', '16', '{AAAA1111-2222-BBBB-CCCC-DDDD3333EEEE}',\n'~WA434.tmp', '~WA4276.tmp', '.', '~WA356.tmp', 'rasmon.dll', 'rasman.dll', 'user',\n'internat', 'NTUSER.DAT', 'ntuser.dat.LOG1', '.', 'mscrt.dll', 'msvcrt.dll', '0', '1',\n'.']\n\n```\nA YARA rule of the cryptographic function is provided in the appendix.\n\n### Network interception\nAs seen above, network callbacks are installed. They will be registered through the function\n\"FwpsCalloutRegister0\" (which allows to add a network filter) and allows the driver to transfer or not\nthe data received.\n```\n v20 = addCalloutAddress(\n     &stru_14930,\n     &a2,\n     DeviceObject,\n     (__int64)intercept_packet,\n     (__int64)&ret_null,\n     (__int64)a6,\n     (__int64)&v47,\n     (__int64)&v34,\n     &a9,\n     &a10);\n\n```\n\n-----\n\nThe \"intercept_packet\" function (at address fffffa8004bd9580 in the memory dump) will analyze the\ndata passing through the network connections. Interestingly, it will not look at data passing through\nport 139. For the other ports it will only look at data received and only if the host is the server.\n```\n if ( v9 || LOWORD(a1->layerId) == 20 && a1->pIP_infos->src_port == 139 )\n  return;\n if ( LOWORD(a1->layerId) == 22 && a1->pIP_infos->src_port == 139 )\n  return;\n[...]\n  fwpsCopyStreamDataToBuffer0(v8, datas_tcp_buffer, *(_QWORD *)(v8 + 48), &v31);\n[...]\n   buffer_type_2 = find_and_decode_datas(datas_tcp_buffer, v24, *((_DWORD *)v11 +\n0x1FF) == 0, &a4a);\n\n```\nThe \"find_and_decode_datas\" function is responsible for testing the different accepted\ncommunication protocols. In our case we will study an HTTP communication. The goal is to see if it is\npossible, remotely, to determine if a server is compromised by Uroburos.\n\nThe malware validates that the received message is a standard HTTP request. Then he will look for a\ncovert message in one of the arguments of the HTTP header.\n```\n if ( space_offset_1 != 3i64\n  || ((v18 = *(_WORD *)Buf < (unsigned __int16)str_GET, *(_WORD *)Buf !=\n(_WORD)str_GET)\n   || (v19 = Buf[2], v18 = (unsigned __int8)v19 < BYTE2(str_GET), v19 !=\nBYTE2(str_GET)) ? (v20 = -v18 - (v18 - 1)) : (v20 = 0),\n    v20) )\n {\n  if ( space_offset_1 != 4 || *(_DWORD *)Buf != str_POST )\n   return 0i64;\n }\n[...]\n  if ( *(_DWORD *)start_word_2 != *(_DWORD *)\"http://\"\n[...]\n if ( v33 != *(_DWORD *)\"HTTP/\" || (v35 = v32[4], v34 = v35 < aHttp_0[4], v35 !=\naHttp_0[4]) )\n[...]\n  || !(unsigned int)check_and_decode_buffer(&Buf[nextline], v14, response_tag,\nout_decoded_b64, v7) )\n[...]\n\n```\nThe \"check_and_decode_buffer\" function will look for the first ':' and will try to find a covert\nmessage in the corresponding HTTP argument.\n```\n   v15 = memchr(v10, ':', (unsigned int)(v14 - 1));\n   if ( !v15 || *((_BYTE *)v15 + 1) != ' ' )\n    return (unsigned int)v5;\n\n```\n\n-----\n\nThis is followed by a check of the message by means of several checksums.\n```\n  v10 = get_checksum(datas, 12);\n  result = (unsigned __int64)reverse_littleendian(v10) == *(_DWORD *)v4;\n\n```\nThe checksum function use a modified \"threefish256\" algorithm truncated to 4 bytes.\n```\n  crypto_it(v3, v6, (v5 - 1) >> 5, 32);\n[...]\n  memcpy((void *)(v3 + *(_QWORD *)(v3 + 8) + 64), v6, v5);\n  *(_QWORD *)(v3 + 8) += v5;\n\n```\nThe hash function is used three times to obtain a final hash, the first time with a static buffer that will\nallow to initialize the data, the second with the data to hash and a last with the hash of this data. This\nfinal hash will be truncated on 4 bytes and used as checksum. A key is initialized, our guess is that\nthere is one per target. It allows to have a shared secret between the malware and the operator. It\nwill be used in the calculation of hashes but will not be sent in the request.\n\nThe message is contained at the end of the line, it is 7 bytes + 1 byte integrity check which is only an\nsum of the previous 7 bytes. This 8 bytes block is then base64 encoded.\n\nThe HTTP request data will be adjusted as follows:\n\nKey Code Tag Sum1 Tag\n\n\nThreefish\n\n\nThreefish\n\n\nHttpHeader : Sum1 Tag Sum2 Message X\n\nBase64\n\nIt is interesting to note that the \"Code\" element is not present in the final query. Four values can be\nused and they are bruteforced by the malware during the verification.\n\nWhen a server is contacted with a request of this type (on a port already open) it is the rootkit that\nanswers us (the data will not be transferred to the userland).\n\nIf the message corresponds to the expected format the driver will send a response of variable size\nand padded with random bytes.\n```\n  if ( reply_datas[6] & 2 )\n  {\n   v8 = 8 * (rand() % -32);\n   v4 = v8;\n   v9 = &v21[-v8];\n   if ( v8 )\n   {\n    v10 = v8;\n\n```\n\n-----\n\n```\n    do\n    {\n     *v9++ = rand();\n     --v10;\n    }\n    while ( v10 );\n   }\n  }\n }\n *(_BYTE *)(v7 + 0xBE0);\n sprintf(Dest, \"HTTP/1.1 200 OK\\r\\nContent-Length: %u\\r\\nConnection: %s\\r\\n\\r\\n\",\n(unsigned int)(v4 + 8));\n\n```\nOnly the first 8 bytes respond to a specific format, all other data are random. The integrity of this\nblock is enforced by an additional checksum between the first 7 bytes, with the result stored in byte\n8. This cheksum is similar to the one mentioned above.\n\nWe are therefore able to develop a PoC to remotely check if a server is compromised by this version\nof the malware:\n```\n> request_builder.py 192.168.48.133 8080\ndatas :\n 0000000000000000 E8 F6 E8 4E 72 61 03 EA C8 B3 DD 8D 25 D0 26 12 ...Nra♥.....%.&↕\n 0000000000000010 B7 F9 50 E5 8C D2 01 62 A0 37 2F FB AD C8 91 DA ..P...☺b.7/.....\n 0000000000000020 44 A5 53 C7 1D 76 0E 4D AC AF F7 18 F4 12 57 A2 D.S.↔v♫M...↑.↕W.\n 0000000000000030 A0 75 3B 0F 50 C5 6C 55 31 4B A1 9F D0 2E F4 F4 .u;☼P.lU1K......\n 0000000000000040 30 39 93 13 1A DF B8 A2 B4 7C DB 88 55 DE 26 98 09.‼→....|..U.&.\n 0000000000000050 98 04 29 6F AF 25 CF 9F FA F5 90 0D D8 23 E9 97 .♦)o.%.......#..\n [*] checksum OK – Host is compromised\n\n```\nThis PoC is available on our website [2].\n\n## Differences and similarities between Uroburos 2014 and 2017\n\nSeveral changes and non-change are surprising compared to the 2014 version of the malware. This\nlist is really not exhaustive but allows to realize the state of the project as of today.\n\nThe names of the files remained the same and the name of the service too, which makes it easily\ndetectable by any IOC.\n\nThe driver is always loaded with a VirtualBox exploit. A kernel vulnerability exploitation is therefore\ndone at each reboot of the system.\n\nThe PatchGuard bypass has been removed, which necessarily limits kernel alterations later.\n```\nDriver 2014:\n if ( v2 )\n  installService(v3);\n\n```\n\n-----\n\n```\n v4 = PG_bypass();\n if ( v4 )\n  goto LABEL_16;\n ObjectAttributes.Length = 48;\n ObjectAttributes.RootDirectory = 0i64;\nDriver 2017:\n  if ( v2 )\n   installService(cp_DriverObject);\n  ObjectAttributes.RootDirectory = 0i64;\n  ObjectAttributes.SecurityDescriptor = 0i64;\n\n```\nThe \\Driver\\Null driver is still used and the \\Device\\FWPMCALLOUT device is still attached to it.\n```\n>>> drv_stack \\Driver\\Null\n- Stack of device name : \\Device\\FWPMCALLOUT\n Driver Object : fffffa80032753e0\n  Driver : \\Driver\\Null\n  Address: fffff88001890000\n  Driver : Null.SYS\n- Stack of device name : \\Device\\Null\n Driver Object : fffffa80032753e0\n  Driver : \\Driver\\Null\n  Address: fffff88001890000\n  Driver : Null.SYS\n\n```\nThe string encryption system has remained the same. The registering of the \"Null\" driver in\n```\n  IopNotifyShutdownQueueHead is a good idea in itself but we have not seen its use. A possible use of\n\n```\nthis callback would be the possibility to inject registry key for persistance at shutdown time.\n\nThe checksum system has evolved, the malware uses Threefish and the message's format has\nevolved since the 2014 version. The goal was probably to escape the network signatures. However\nthe correction of a English typo 221 Service closing transmittion channel to give 221 Closing\n```\n  transmission channel allows us to date the driver as more recent (see reference [1]).\n\n```\nOverall the rootkit still has serious assets, but also some carelessness, such as the names of files and\nregistry keys, suggesting that it will only be used on isolated servers. Despite an apparent decreased\npopularity, kernel malware (64b) are still present and are not ready to disappear because their\npresence is harder to identify than userland components.\n\n\n-----\n\n## References\n\n[1] Paper of \"Andrzej Dereszowski\" and \"Matthieu Kaczmarek\", one of moste valuables on this\nsubject:\n[http://artemonsecurity.com/uroburos.pdf](http://artemonsecurity.com/uroburos.pdf)\n\n[2] PoC of http request:\n[http://www.exatrack.com/public/uroburos_poc.py](http://www.exatrack.com/public/uroburos_poc.py)\n\n[3] SNAKE CAMPAIGN & CYBER ESPIONAGE TOOLKIT:\n[http://artemonsecurity.com/snake_whitepaper.pdf](http://artemonsecurity.com/snake_whitepaper.pdf)\n\n## Appendix\n\nYARA rule :\n```\nrule Sig\n{\n strings:\n  $strings_crypt = { 4d 8b c1 41 ba 40 00 00 00 41 ?? ?? ?? 41 ?? ?? 49 83 c0 01 49 83\nea 01 75 ??}\n  $hash_part1 = { 49 c1 c3 0e 4e ?? ?? ?? 4c 33 dd 4c 03 c7 4c 03 c1 48 c1 c0 10 49 33\nc0 4d 03 c3 48 03 e8 48 c1 c8 0c 48 33 c5 49 c1 cb 07 4d 33 d8 4c 03 c0 49 03 eb 49 c1 c3\n17 4c 33 dd 48 c1 c8 18 49 33 c0 4d 03 c3 48 03 e8 49 c1 cb 1b 4d 33 d8 4c 03 df 4c 03 d9\n48 c1 c0 05 48 33 c5 4a ?? ?? ?? ??}\n condition:\n  1 of them\n}\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://exatrack.com/public/Uroburos_EN.pdf"
    ],
    "report_names": [
        "Uroburos_EN.pdf"
    ],
    "threat_actors": [
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716491,
    "ts_updated_at": 1743041780,
    "ts_creation_date": 1518178994,
    "ts_modification_date": 1518178994,
    "files": {
        "pdf": "https://archive.orkl.eu/3679bcb061a90c9daee667fa244a4d159c195f89.pdf",
        "text": "https://archive.orkl.eu/3679bcb061a90c9daee667fa244a4d159c195f89.txt",
        "img": "https://archive.orkl.eu/3679bcb061a90c9daee667fa244a4d159c195f89.jpg"
    }
}