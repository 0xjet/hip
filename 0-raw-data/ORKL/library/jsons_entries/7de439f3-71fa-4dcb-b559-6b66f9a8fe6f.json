{
    "id": "7de439f3-71fa-4dcb-b559-6b66f9a8fe6f",
    "created_at": "2022-10-25T16:48:15.89948Z",
    "updated_at": "2025-03-27T02:17:14.460341Z",
    "deleted_at": null,
    "sha1_hash": "abc7a05c68aa39ac904c0f59a30c583f7c379da0",
    "title": "",
    "authors": "",
    "file_creation_date": "2019-04-24T02:48:06Z",
    "file_modification_date": "2019-04-24T02:48:06Z",
    "file_size": 1517612,
    "plain_text": "# Operation ShadowHammer: a high-profile supply chain attack\n\n**[securelist.com/operation-shadowhammer-a-high-profile-supply-chain-attack/90380](https://securelist.com/operation-shadowhammer-a-high-profile-supply-chain-attack/90380/)**\n\nBy GReAT, AMR on April 23, 2019. 10:00 am\n\nIn late March 2019, we [briefly highlighted our](https://securelist.com/operation-shadowhammer/89992/)\nresearch on ShadowHammer attacks, a\nsophisticated supply chain attack involving ASUS\nLive Update Utility, which was [featured in a Kim](https://motherboard.vice.com/en_us/article/pan9wn/hackers-hijacked-asus-software-updates-to-install-backdoors-on-thousands-of-computers)\nZetter article on Motherboard. The topic was also\none of the research announcements made at the\nSAS conference, which took place in Singapore on\nApril 9-10, 2019. Now it is time to share more details\nabout the research with our readers.\n\nAt the end of January 2019, Kaspersky Lab\nresearchers discovered what appeared to be a new\nattack on a large manufacturer in Asia. Our researchers named it “Operation ShadowHammer”.\n\nSome of the executable files, which were downloaded from the official domain of a reputable and trusted\nlarge manufacturer, contained apparent malware features. Careful analysis confirmed that the binary had\nbeen tampered with by malicious attackers.\n\nIt is important to note that any, even tiny, tampering with executables in such a case normally breaks the\ndigital signature. However, in this case, the digital signature was intact: valid and verifiable. We quickly\nrealized that we were dealing with a case of a compromised digital signature.\n\nWe believe this to be the result of a sophisticated supply chain attack, which matches or even surpasses\nthe [ShadowPad and the](https://securelist.com/shadowpad-in-corporate-networks/81432/) [CCleaner incidents in complexity and techniques. The reason that it stayed](https://blog.avast.com/update-to-the-ccleaner-5.33.6162-security-incident)\nundetected for so long is partly the fact that the trojanized software was signed with legitimate certificates\n(e.g. “ASUSTeK Computer Inc.”).\n\nThe goal of the attack was to surgically target an unknown pool of users, who were identified by their\nnetwork adapters’ MAC addresses. To achieve this, the attackers had hardcoded a list of MAC addresses\ninto the trojanized samples and the list was used to identify the intended targets of this massive operation.\nWe were able to extract more than 600 unique MAC addresses from more than 200 samples used in the\nattack. There might be other samples out there with different MAC addresses on their lists, though.\n\n## Technical details\n\nThe research started upon the discovery of a trojanized ASUS Live Updater file (setup.exe), which\ncontained a digital signature of ASUSTeK Computer Inc. and had been backdoored using one of the two\ntechniques explained below.\n\nIn earlier variants of ASUS Live Updater (i.e. MD5:0f49621b06f2cdaac8850c6e9581a594), the attackers\nreplaced the WinMain function in the binary with their own. This function copies a backdoor executable\nfrom the resource section using a hardcoded size and offset to the resource. Once copied to the heap\nmemory, another hardcoded offset, specific to the executable, is used to start the backdoor. The offset\npoints to a position-independent shellcode-style function that unwraps and runs the malicious code further.\n\n\n-----\n\nSome of the older samples revealed the project path via a\nPDB file reference:\n“D:\\C++\\AsusShellCode\\Release\\AsusShellCode.pdb“.\nThis suggests that the attackers had exclusively prepared the\nmalicious payload for their target. A similar tactic of precise\ntargeting has become a persistent property of these attackers.\n\nA look at the resource section used for carrying the malicious\npayload revealed that the attackers had decided not to change\nthe file size of the ASUS Live Updater binary. They changed\nthe resource contents and overwrote a tiny block of the code\nin the subject executable. The layout of that patched file is\nshown below.\n\n\n_Backdoored WinMain function in ASUS Live Utility_\n\n\n_Execution passed from the original code to the embedded payload_\n\n\n-----\n\nWe managed to find the original ASUS Live Updater executable which had been patched and abused by\nthe attackers. As a result, we were able to recover the overwritten data in the resource section. The file we\nfound was digitally signed and certainly had no infection present.\n\nBoth the legitimate ASUS executable and the resource-embedded updater binary contain timestamps from\nMarch 2015. Considering that the operation took place in 2018, this raises the following question: why did\nthe attackers choose an old ASUS binary as the infection carrier?\n\n\n_Original ASUS Live Updater (above) and the trojanized executable (below)_\n\n\nAnother injection technique was found in more recent samples. Using that technique, the attackers patched\nthe code inside the C runtime (CRT) library function “___crtExitProcess”. The malicious code executes a\nshellcode loader instead of the standard function “___crtCorExitProcess”:\n\n\n-----\n\n_Backdoored (on the left) and original code (on the right)_\n\n\nThis way, the execution flow is passed to another address which is located at the end of the code section.\nThe attackers used a small decryption routine that can fit into a block at the end of the code section, which\nhas a series of zero bytes in the original executable. They used the same source executable file from\nASUS (compiled in March 2015) for this new type of injection.\n\n\n_Improved code injection with encrypted payload_\n\n\n_Injected code (left) and the same place in legitimate ASUS binary (right)_\n\n\n-----\n\nThe loader code copies another block of encrypted shellcode from the file s resource section (of the type\n“EXE”) to a newly allocated memory block with read-write-execute attributes and decrypts it using a custom\nblock-chaining XOR algorithm, where the first dword is the initial seed and the total size of the shellcode is\nstored at an offset of +8.\n\n\n_Shellcode decryption routine_\n\n\nWe believe that the attackers changed the payload start routine in an attempt to evade detection.\nApparently, they switched to a better method of hiding their embedded shellcode at some point between the\nend of July and September 2018.\n\n### ShadowHammer downloader\n\nThe compromised ASUS binaries carried a payload that was a Trojan downloader. Let us take a closer look\nat one such ShadowHammer downloader extracted from a copy of the ASUS Live Updater tool with\nMD5:0f49621b06f2cdaac8850c6e9581a594. It has the following properties:\n\nMD5: 63f2fe96de336b6097806b22b5ab941a\nSHA1: 6f8f43b6643fc36bae2e15025d533a1d53291b8a\nSHA256: 1bb53937fa4cba70f61dc53f85e4e25551bc811bf9821fc47d25de1be9fd286a\nDigital certificate fingerprint: 0f:f0:67:d8:01:f7:da:ee:ae:84:2e:9f:e5:f6:10:ea\nFile Size: 1’662’464 bytes\nFile Type: PE32 executable (GUI) Intel 80386, for MS Windows\nLink Time: 2018.07.10 05:58:19 (GMT)\n\nThe relatively large file size is explained by the presence of partial data from the original ASUS Live\nUpdater application appended to the end of the executable. The attackers took the original Live Updater\nand overwrote it with their own PE executable starting from the PE header, so that the file contains the\n\n\n-----\n\nactual PE image, whose size is only 40448 bytes, while the rest comes from ASUS. The malicious\nexecutable was created using Microsoft Visual C++ 2010.\n\nThe core function of this executable is in a subroutine which is called from WinMain, but also executed\ndirectly via a hardcoded offset from the code injected into ASUS Live Updater.\n\nThe code uses dynamic import resolution with its own simple hashing algorithm. Once the imports are\nresolved, it collects MAC addresses of all available network adapters and calculates an MD5 hash for each\nof these. After that, the hashes are compared against a table of 55 hardcoded values. Other variants of the\ndownloader contained a different table of hashes, and in some cases, the hashes were arranged in pairs.\n\n\n_Example of hardcoded MD5 values_\n\n\nIn other words, the malware iterates through a table of hashes and compares them to the hashes of local\nadapters’ MAC hashes. This way, the target system is recognized and the malware proceeds to the next\nstage, downloading a binary object from https://asushotfix[.]com/logo.jpg (or\n**https://asushotfix[.]com/logo2.jpg in newer samples). The malware also sends the first hash from the**\nmatch entry as a parameter in the request to identify the victim. The server response is expected to be an\nexecutable shellcode, which is placed in newly allocated memory and started.\n\n\n-----\n\n_Execution of the next stage shellcode_\n\n\nOur investigation uncovered 230 unique samples with different shellcodes and different sets of MAC\naddress hashes. This leads us to believe that the campaign targeted a vast number of people or\ncompanies. In total, we were able to extract 14 unique hash tables. The smallest hash table found\ncontained eight entries and the biggest, 307 entries. Interestingly, although the subset of hash entries was\nchanging, some of the entries were present in all of the tables.\n\n\n_Format of the hash table entries_\n\n\nFor all users whose MAC did not match expected values, the code would create an INI file located two\ndirectory levels above the current executable and named “idx.ini”. Three values were written into the INI file\nunder the [IDX_FILE] section:\n\n[IDX_FILE]\nXXX_IDN=YYYY-MM-DD\nXXX_IDE=YYYY-MM-DD\n\n\n-----\n\nXXX_IDX=YYYY-MM-DD\n\nwhere YYYY-MM-DD is a date one week ahead of the current system date.\n\nThe code injected by the attackers was discovered with over 57000 Kaspersky Lab users. It would run but\nremain silent on systems that were not primary targets, making it almost impossible to discover the\nanomalous behavior of the trojanized executables. The exact total of the affected users around the world\nremains unknown.\n\n## Digital signature abuse\n\nA lot of computer security software deployed today relies on integrity control of trusted executables. Digital\nsignature verification is one such method. In this attack, the attackers managed to get their code signed\nwith a certificate of a big vendor. How was that possible? We do not have definitive answers, but let us take\na look at what we observed.\n\nFirst of all, we noticed that all backdoored ASUS binaries were signed with two different certificates. Here\nare their fingerprints:\n\n0ff067d801f7daeeae842e9fe5f610ea\n05e6a0be5ac359c7ff11f4b467ab20fc\n\nThe same two certificates have been used in the past to sign at least 3000 legitimate ASUS files (i.e. ASUS\nGPU Tweak, [ASUS PC Link and others), which makes it very hard to revoke these certificates.](https://softfamous.com/asus-pc-link/)\n\nAll of the signed binaries share certain interesting features: none of them had a signing timestamp set, and\nthe digest algorithm used was SHA1. The reason for this could be an attempt at hiding the time of the\noperation to make it harder to discover related forensic artefacts.\n\n\n_ASUS real digital signature (left) and attacker’s signature (right)_\n\n\nAlthough there is no timestamp that can be relied on to understand when the attack started, there is a\nmandatory field in the certificate, “Certificate Validity Period”, which can help us to understand roughly the\ntimeframe of the operation. Apparently, because the certificate that the attackers relied on expired in 2018\nand therefore had to be reissued, they used two different certificates.\n\n\n-----\n\n_Validity period of two abused digital certificates_\n\n\nAnother notable fact is that both abused certificates are from the DigiCert SHA2 Assured ID Code Signing\nCA.\n\n\n_Properties of legitimate ASUS binaries’ digital certificate_\n\n\nThe legitimate ASUS binaries that we have observed use a different certificate, which was issued by the\n[DigiCert EV Code Signing CA (SHA2). EV stands for “Extended Validation” and provides for stricter](https://www.digicert.com/code-signing/ev-code-signing/)\nrequirements for the party that intends to use the certificate, including hardware requirements. We believe\nthat the attackers simply did not have access to a production signing device with an EV certificate.\n\nThis indicates that the attackers most likely obtained a copy of the certificates or abused a system on the\nASUS network that had the certificates installed. We do not know about all software with malware injection\nthey managed to sign, and we believe that the compromised signing certificates must be removed and\nrevoked. Unfortunately, one month after this was reported to ASUS, newly released software (i.e. md5:\n1b8d2459d4441b8f4a691aec18d08751) was still being signed with a compromised certificate. We have\nimmediately notified ASUS about this and provided evidence as required.\n\n\n_ASUS Download Agent signed by ASUS a month after breach notification_\n\n\n## ASUS-related attack samples\n\n\n-----\n\nUsing decrypted shellcode and through code similarity, we found a number of related samples which\nappear to have been part of a parallel attack wave. These files have the following properties:\n\nthey contain the same shellcode style as the payload from the compromised ASUS Live Updater\nbinaries, albeit unencrypted\nthey have a forgotten PDB path of “D:\\C++\\AsusShellCode\\Release\\AsusShellCode.pdb”\nthe shellcode from all of these samples connects to the same C2: asushotfix[.]com\nall samples were compiled between June and July 2018\nthe samples have been detected on computers all around the globe\n\nThe hashes of these related samples include:\n\n_322cb39bc049aa69136925137906d855_\n_36dd195269979e01a29e37c488928497_\n_7d9d29c1c03461608bcab930fef2f568_\n_807d86da63f0db1fc746d1f0b05bc357_\n_849a2b0dc80aeca3d175c139efe5221c_\n_86A4CAC227078B9C95C560C8F0370BF0_\n_98908ce6f80ecc48628c8d2bf5b2a50c_\n_a4b42c2c95d1f2ff12171a01c86cd64f_\n_b4abe604916c04fe3dd8b9cb3d501d3f_\n_eac3e3ece94bc84e922ec077efb15edd_\n_128CECC59C91C0D0574BC1075FE7CB40_\n_88777aacd5f16599547926a4c9202862_\n\nThese files are dropped by larger setup files / installers, signed by an ASUS certificate (serial number:\n0ff067d801f7daeeae842e9fe5f610ea) valid from 2015-07-27 till 2018-08-01).\n\nThe hashes of the larger installers/droppers include:\n\n0f49621b06f2cdaac8850c6e9581a594\n17a36ac3e31f3a18936552aff2c80249\n\nAt this point, we do not know how they were used in these attacks and whether they were delivered via a\ndifferent mechanism. These files were located in a “TEMP” subfolder for ASUS Live Updater, so it is\npossible that the software downloaded these files directly. Locations where these files were detected\ninclude:\n\nasus\\asus live update\\temp\\1\\Setup.exe\nasus\\asus live update\\temp\\2\\Setup.exe\nasus\\asus live update\\temp\\3\\Setup.exe\nasus\\asus live update\\temp\\5\\Setup.exe\nasus\\asus live update\\temp\\6\\Setup.exe\nasus\\asus live update\\temp\\9\\Setup.exe\n\n## Public reports of the attack\n\nWhile investigating this case, we were wondering how such a massive attack could go unnoticed on the\nInternet. Searching for any kind of evidence related to the attack, we came by a Reddit thread created in\nJune 2018, where user GreyWolfx posted a screenshot of a suspicious-looking ASUS Live Update\n\n\n-----\n\nmessage:\n\nThe message claims to be a “ASUS Critical Update” notification, however, the item does not have a name\nor version number.\n\nOther users commented in the thread, while some uploaded the suspicious updater to VirusTotal:\n\nThe file uploaded to VT is not one of the malicious compromised updates; we can assume the person who\nuploaded it actually uploaded the ASUS Live Update itself, as opposed to the update it received from the\nInternet. Nevertheless, this could suggest that potentially compromised updates were delivered to users as\nfar back as June 2018.\n\nIn September 2018, another Reddit user, FabulaBerserko also posted a message about a suspicious ASUS\nLive update:\n\n[Asus_USA replied to FabulaBerserko with the following message, suggesting he run a scan for viruses:](https://www.reddit.com/user/Asus_USA)\n\nIn his message, the Reddit user FabulaBerserko talks about an update listed as critical, however without a\nname and with a release date of March 2015. Interestingly, the related attack samples containing the PDB\n“AsusShellCode.pdb” have a compilation timestamp from 2015 as well, so it is possible that the Reddit user\nsaw the delivery of one such file through ASUS Live Update in September 2018.\n\n## Targets by MAC address\n\nWe managed to crack all of the 600+ MAC address hashes and analyzed distribution by manufacturer,\nusing publicly available Ethernet-to-vendor assignment lists. It turns out that the distribution is uneven and\ncertain vendors are a higher priority for the attackers. The chart below shows statistics we collected based\non network adapter manufacturers’ names:\n\n\n_Statistics of targeted device MAC addresses by manufacturers_\n\n\n-----\n\nSome of the MAC addresses included on the target list were rather popular, i.e. 00-50-56-C0-00-08 belongs\nto the VMWare virtual adapter VMNet8 and is the same for all users of a certain version of the VMware\nsoftware for Windows. To prevent infection by mistake, the attackers used a secondary MAC address from\nthe real Ethernet card, which would make targeting more precise. However, it tells us that one of the\ntargeted users used VMWare, which is rather common for software engineers (in testing their software).\n\nAnother popular MAC was 0C-5B-8F-27-9A-64, which belongs to the MAC address of a virtual Ethernet\nadapter created by a Huawei USB 3G modem, model E3372h. It seems that all users of this device shared\nthe same MAC address.\n\n## Interaction with ASUS\n\nThe day after the ShadowHammer discovery, we created a short report for ASUS and approached the\ncompany through our local colleagues in Taiwan, providing all details of what was known about the attack\nand hoping for cooperation. The following is a timeline of the discovery of this supply-chain attack, together\nwith ASUS interaction and reporting:\n\n29-Jan-2019 – initial discovery of the compromised ASUS Live Updater\n30-Jan-2019 – created preliminary report to be shared with ASUS, briefed Kaspersky Lab colleagues\nin Taipei\n31-Jan-2019 – in-person meeting with ASUS, teleconference with researchers; we notified ASUS of\nthe finding and shared hard copy of the preliminary attack report with indicators of compromise and\nYara rules. ASUS provided Kaspersky with the latest version of ASUS Live Updater, which was\nanalyzed and found to be uninfected.\n01-Feb-2019 – ASUS provides an archive of all ASUS Live Updater tools beginning from 2018. None\nof them were infected, and they were signed with different certificates.\n14-Feb-2019 – second face-to-face meeting with ASUS to discuss the details of the attack\n20-Feb-2019 – update conf call with ASUS to provide newly found details about the attack\n08-Mar-2019 – provided the list of targeted MAC addresses to ASUS, answered other questions\nrelated to the attack\n08-Apr-2019 – provided a comprehensive report on the current attack investigation to ASUS.\n\nWe appreciate a quick response from our ASUS colleagues just days before one of the largest holidays in\nAsia (Lunar New Year). This helped us to confirm that the attack was in a deactivated stage and there was\nno immediate risk to new infections and gave us more time to collect further artefacts. However, all\ncompromised ASUS binaries had to be properly flagged as containing malware and removed from\nKaspersky Lab users’ computers.\n\n## Non-ASUS-related cases\n\nIn our search for similar malware, we came across other digitally signed binaries from three other vendors\nin Asia.\n\nOne of these vendors is a game development company from Thailand known as Electronics Extreme\n**Company Limited. The company has** [released digitally signed binaries of a video game called](https://exe.in.th/download)\n“Infestation: Survivor Stories”. It is a zombie survival game in which players endure the hardships of a\npost-apocalyptic, zombie-infested world. According to Wikipedia, “the game was panned by critics and is\nconsidered one of the [worst video games of all time“. The game servers were taken offline on December](https://en.wikipedia.org/wiki/List_of_video_games_notable_for_negative_reception)\n15, 2016.”\n\n\n-----\n\n_“Infestation: Survivor Stories” game art_\n\n\nThe history of this videogame itself contains many controversies. According to Wikipedia, it was originally\ndeveloped under the title of “The War Z” and released by OP Productions which put it in the [Steam store](https://store.steampowered.com/app/226700/Infestation_Survivor_Stories_Classic/)\nin December 2012. In April 4, 2013, the game servers were compromised, and the game source code was\nmost probably stolen and [released to the public.](https://ragezone.com/2013/04/12/the-war-z-source-code/)\n\nIt seems that certain videogame companies picked up this available code and started making their own\nversions of the game. One such version (md5: de721e2f055f1b203ab561dda4377bab) was digitally signed\nby Innovative Extremist Co. LTD., a company from Thailand that currently provides web & IT\ninfrastructure services. The game also contains a logo of Electronics Extreme Company Limited with a\nlink to their website. The homepage of Innovative Extremist also listed Electronics Extreme as one of their\npartners.\n\nNotably, the certificate from Innovative Extremist that was used to sign Infestation is currently revoked.\nHowever, the story does not end here. It seems that Electronics Extreme picked up the video game where\nInnovative Extremist dropped it. And now the game seems to be causing trouble again. We found at least\nthree samples of Infestation signed by Electronics Extreme with a certificate that must be revoked again.\n\nWe believe that a poorly maintained development environment, leaked source code, as well vulnerable\nproduction servers were at the core of the bad luck chasing this videogame. Ironically, this game about\ninfestation brought only trouble and a serious infection to its developers.\n\nSeveral executable files from the popular FPS videogame PointBlank contained a similar malware injection.\nThe game was developed by the South Korean company Zepetto Co, whose digital signature was also\nabused. Although the certificate was still unrevoked as at early April, Zepetto seems to have stopped using\nthe certificate at the end of February 2019.\n\nWhile some details about this case were [announced in March 2019 by our colleagues at ESET, we have](https://www.welivesecurity.com/2019/03/11/gaming-industry-scope-attackers-asia/)\nbeen working on this in parallel with ESET and uncovered some additional facts.\n\nAll these cases involve digitally signed binaries from three vendors based in three different Asian countries.\nThey are signed with different certificates and a unique chain of trust. What is common to these cases is\nthe way the binaries were trojanized.\n\n\n-----\n\n_Chain of malicious code execution_\n\n\nThe code injection happened through modification of commonly used functions such as CRT (C runtime),\nwhich is similar to ASUS case. However, the implementation is very different in the case of the videogame\ncompanies. In the ASUS case, the attackers only tampered with a compiled ASUS binary from 2015 and\ninjected additional code. In the other cases, the binaries were recent (from the end of 2018). The malicious\ncode was not inserted as a resource, neither did it overwrite the unused zero-filled space inside the\nprograms. Instead, it seems to have been neatly compiled into the program, and in most cases, it starts at\nthe beginning of the code section as if it had been added even before the legitimate code. Even the data\nwith the encrypted payload is stored inside this code section. This indicates that the attackers either had\naccess to the source code of the victim’s projects or injected malware on the premises of the breached\ncompanies at the time of project compilation.\n\n## Payload from non-ASUS-related cases\n\nThe payload included into the compromised videogames is rather simple. First of all, it checks whether the\nprocess has administrative privileges.\n\n\n-----\n\n_Pseudocode checking if the process has got admin rights_\n\n\nNext, it checks the registry value at HKCU\\SOFTWARE\\Microsoft\\Windows\\{0753-6681-BD59-8819}. If\nthe value exists and is non-zero, the payload does not run further. Otherwise, it starts a new thread with a\nmalicious intent.\n\nThe file contains a hardcoded miniconfig—an annotated example of the config is provided below.\n\nC2 URL: https://nw.infestexe[.]com/version/last.php\nSleep time: 240000\nTarget Tag: warz\nUnwanted processes:\nwireshark.exe;perfmon.exe;procmon64.exe;procmon.exe;procexp.exe;procexp64.exe;netmon.exe\n\nApparently, the backdoor was specifically created for this target, which is confirmed by an internal tag (the\nprevious name of the game is “The War Z”).\n\nIf any of the unwanted processes is running, or the system language ID is Simplified Chinese or Russian,\nthe malware does not proceed. It also checks for the presence of a mutex named Windows-{0753-6681**BD59-8819}, which is also a sign to stop execution.**\n\nAfter all checks are done, the malware gathers information about the system including:\n\nNetwork adapter MAC address\nSystem username\nSystem hostname and IP address\nWindows version\nCPU architecture\nCurrent host FQDN\nDomain name\nCurrent executable file name\n\n\n-----\n\nDrive C: volume name and serial number\nScreen resolution\nSystem default language ID\n\nThis information is concatenated in one string using the following string template:\n“%s|%s|%s|%s|%s|%s|%s|%dx%d|%04x|%08X|%s|%s”.\n\nThen the malware crafts a host identifier, which is made up of the C drive serial number string XOR-ed with\nthe hardcoded string “*&b0i0rong2Y7un1” and encoded with the Base64 algorithm. Later on, the C: serial\nnumber may be used by the attackers to craft unique backdoor code that runs only on a system with\nidentical properties.\n\nThe malware uses HTTP for communication with a C2 server and crafts HTTP headers on its own. It uses\nthe following hardcoded User-Agent string: “Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36\n**(KHTML, like Gecko) Chrome/54.0.2840.71 Safari/537.36”**\n\nInterestingly, when the malware identifies the Windows version, it uses a long list:\n\nMicrosoft Windows NT 4.0\nMicrosoft Windows 95\nMicrosoft Windows 98\nMicrosoft Windows Me\nMicrosoft Windows 2000e\nMicrosoft Windows XP\nMicrosoft Windows XP Professional x64 Edition\nMicrosoft Windows Server 2003\nMicrosoft Windows Server 2003 R2\nMicrosoft Windows Vista\nMicrosoft Windows Server 2008\nMicrosoft Windows 7\nMicrosoft Windows Server 2008 R2\nMicrosoft Windows 8\nMicrosoft Windows Server 2012\nMicrosoft Windows 8.1\nMicrosoft Windows Server 2012 R2\nMicrosoft Windows 10\nMicrosoft Windows Server 2016\n\nThe purpose of the code is to submit system information to the C2 server with a POST request and then\nsend another GET request to receive a command to execute.\n\nThe following commands were discovered:\n\n**DownUrlFile – download URL data to file**\n**DownRunUrlFile – download URL data to file and execute it**\n**RunUrlBinInMem – download URL data and run as shellcode**\n**UnInstall – set registry flag to prevent malware start**\n\n\n-----\n\nThe UnInstall command sets the registry value HKCU\\SOFTWARE\\Microsoft\\Windows\\{0753-6681**BD59-8819} to 1, which prevents the malware from contacting the C2 again. No files are deleted from the**\ndisk, and the files should be discoverable through forensic analysis.\n\n## Similarities between the ASUS attack and the non-ASUS-related cases\n\nAlthough the ASUS case and the videogame industry cases contain certain differences, they are very\nsimilar. Let us briefly mention some of the similarities. For instance, the algorithm used to calculate API\nfunction hashes (in trojanized games) resembles the one used in the backdoored ASUS Updater tool.\n\n\nhash = 0\n\nfor c in string:\n\nhash = hash * 0x21\n\nhash = hash + c\n\nreturn hash\n\n\nhash = 0\n\nfor c in string:\n\nhash = hash * 0x83\n\nhash = hash + c\n\nreturn hash & 0x7FFFFFFF\n\n\nASUS case Other cases\n\n_Pseudocode of API hashing algorithm of ASUS vs. other cases_\n\nBesides that, our behavior engine identified that ASUS and other related samples are some of the only\ncases where the IPHLPAPI.dll was used from within a shellcode embedded into a PE file.\n\n\nIn the case of ASUS, the function GetAdaptersAddresses\nfrom the IPHLPAPI.dll was used for calculating the\nhashes of MAC addresses. In the other cases, the\nfunction GetAdaptersInfo from the IPHLPAPI.dll was\nused to retrieve information about the MAC addresses of\nthe computer to pass to remote C&C servers.\n\n## ShadowPad connection\n\n\n_Loading of IPHLPAPI.dll from within ASUS shellcode_\n\n\nWhile investigating this case, we worked with several companies that had been abused in this wave of\nsupply chain attacks. Our joint investigation revealed that the attackers deployed several tools on an\nattacked network, including a trojanized linker and a powerful backdoor packed with a recent version of\nVMProtect.\n\nOur analysis of the sophisticated backdoor (md5: 37e100dd8b2ad8b301b130c2bca3f1ea) that was\ndeployed by the attackers on the company’s internal network during the breach, revealed that it was an\nupdated version of the ShadowPad backdoor, which [we reported on in 2017.](https://securelist.com/shadowpad-in-corporate-networks/81432/)\n\nThe ShadowPad backdoor used in these cases has a very high level of complexity, which makes it almost\nimpossible to reverse engineer:\n\n\nThe newly updated version of ShadowPad follows\nthe same principle as before. The backdoor\nunwraps multiple stages of code before activating a\nsystem of plugins responsible for bootstrapping the\nmain malicious functionality. As with ShadowPad,\n\n\n_2018 version of ShadowPad used in the supply chain attacks_\n\n\n-----\n\nthe attackers used at least two stages of C2\nservers, where the first stage would provide the\nbackdoor with an encrypted next-stage C2 domain.\n\nThe backdoor contains a hardcoded URL for C2\ncommunication, which points to a publicly editable\nonline Google document. Such online documents,\nwhich we extracted from several backdoors, were\ncreated by the same user under a name of Tom\n**Giardino (hrsimon59@gmail[.]com), probably a**\nreference to the spokesperson from Valve\nCorporation.\n\nThese online documents contained an ASCII block\nof text marked as an RSA private key during the\ntime of operation. We noticed that inside the private\nkey, normally encoded with base64, there was an\ninvalid character injection (the symbol “$”):\n\n\n_Malware communication injected into Google document contents_\n\n\nThe message between the two “$” characters in fact contained an encrypted second-stage C2 URL.\n\nWe managed to extract the history of changes and collected the following information indicating the time\nand C2 of ongoing operations in 2018:\n\nJul 31: UDP://103.19.3[.]17:443\nAug 13: UDP://103.19.3[.]17:443\n\n\n-----\n\nOct 08: UDP://103.19.3[.]17:443\nOct 09: UDP://103.19.3[.]17:443\nOct 22: UDP://117.16.142[.]9:443\nNov 20: HTTPS://23.236.77[.]177:443\nNov 21: UDP://117.16.142[.]9:443\nNov 22: UDP://117.16.142[.]9:443\nNov 23: UDP://117.16.142[.]9:443\nNov 27: UDP://117.16.142[.]9:443\nNov 27: HTTPS://103.19.3[.]44:443\nNov 27: TCP://103.19.3[.]44:443\nNov 27: UDP://103.19.3[.]44:1194\nNov 27: HTTPS://23.236.77[.]175:443\nNov 29: HTTPS://23.236.77[.]175:443\nNov 29: UDP://103.19.3[.]43:443\nNov 30: HTTPS://23.236.77[.]177:443\n\nThe IP address range 23.236.64.0-23.236.79.255 belongs to the Chinese hosting company Aoyouhost\n**LLC, incorporated in Los Angeles, CA.**\n\nAnother IP address (117.16.142[.]9) belongs to a range listed as the Korean Education Network and likely\nbelongs to Konkuk university (konkuk.ac.kr). This IP address range has been [previously reported by Avast](https://blog.avast.com/update-ccleaner-attackers-entered-via-teamviewer)\nas one of those related to the ShadowPad activity linked to the CCleaner incident. It seems that the\nShadowPad attackers are still abusing the university’s network to host their C2 infrastructure.\n\nThe last one, 103.19.3[.]44, is located in Japan but seems to belong to another Chinese ISP known as\n“xTom Shanghai Limited”. Connected to via the IP address, the server displays an error page from Chinese\nweb management software called [BaoTa (“宝塔” in Chinese):](https://www.bt.cn/)\n\n\n-----\n\n_Screenshots of server error pages_\n\n\n## PlugX connection\n\n\n-----\n\nWhile analyzing the malicious payload injected into the signed ASUS Live Updater binaries, we came\nacross a simple custom encryption algorithm used in the malware. We found that ShadowHammer reused\nalgorithms used in multiple malware samples, including many of [PlugX. PlugX is a backdoor quite popular](https://securelist.com/all/?tag=778)\namong Chinese-speaking hacker groups. It had previously been seen in the Codoso, MenuPass and Hikit\nattacks. Some of the samples we found (i.e. md5:5d40e86b09e6fe1dedbc87457a086d95) were created as\nearly as 2012 if the compilation timestamp is anything to trust.\n\n\n_PlugX code from 2012 (on the left) and ShadowHammer (on the right)_\n\n\nApparently, both pieces of code share the same constants (0x11111111, 0x22222222, 0x33333333,\n0x44444444), but also implement identical algorithms to decrypt data, summarized in the python function\nbelow.\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\nfrom ctypes import c_uint32\nfrom struct import pack,unpack\ndef decrypt(data):\np1 = p2 = p3 = p4 = unpack(\"<L\", data[0:4])[0];\npos = 0\ndecdata = \"\"\nwhile pos < len(data):\np1 = c_uint32(p1 + (p1 >> 3) - 0x11111111).value\np2 = c_uint32(p2 + (p2 >> 5) - 0x22222222).value\np3 = c_uint32(p3 - (p3 << 7) + 0x33333333).value\np4 = c_uint32(p4 - (p4 << 9) + 0x44444444).value\ndecdata += chr( ( ord(data[pos]) ^ ( ( p1%256 + p2%256 + p3%256 + p4%256 ) % 256 ) ) )\npos += 1\nreturn decdata</td>\n\n\n-----\n\nWhile this does not indicate a strong connection to PlugX creators, the reuse of the algorithm is unusual\nand may suggest that the ShadowHammer developers had some experience with PlugX source code, and\npossibly compiled and used PlugX in some other attacks in the past.\n\n## Compromising software developers\n\nAll of the analyzed ASUS Live Updater binaries were backdoored using the same executable file patched\nby an external malicious application, which implemented malware injection on demand. After that, the\nattackers signed the executable and delivered it to the victims via ASUS update servers, which was\ndetected by Kaspersky Lab products.\n\nHowever, in the non-ASUS cases, the malware was seamlessly integrated into the code of recently\ncompiled legitimate applications, which suggests that a different technique was used. Our deep search\nrevealed another malware injection mechanism, which comes from a trojanized development environment\nused by software coders in the organization.\n\nIn late 2018, we found a suspicious sample of the link.exe tool uploaded to a public malware scanning\nservice. The tool is part of Microsoft Visual Studio, a popular integrated development environment (IDE)\nused for creating applications for Microsoft Windows. The same user also uploaded digitally signed\ncompromised executables and some of the backdoors used in the same campaign.\n\nThe attack is comprised of an infected Microsoft Incremental Linker, a malicious DLL module that gets\nloaded through the compromised linker. The malicious DLL then hooks the file open operation and redirects\nattempts to open a commonly used C++ runtime library during the process of static linking. The redirect\ndestination is a malicious .lib file, which gets linked with the target software instead of the legitimate library.\nThe code also carefully checks which executable is being linked and applies file redirection only if the name\nmatches the hardcoded target file name.\n\nSo, was it a developer from a videogame company that installed the trojanized version of the development\nsoftware, or did the attackers deploy the Trojan code after compromising the developer’s machine? This\ncurrently remains unknown. While we could not identify how the attackers managed to replace key files in\nthe integrated development environment, this should serve as a wakeup call to all software developers. If\nyour company produces software, you should ask yourself:\n\n1. Where does my development software come from?\n2. Is the delivery process (download) of IDE distributions secure?\n3. When did we last check the integrity of our development software?\n\n## Other victims\n\nDuring the analysis of samples related to the updated ShadowPad arsenal, we discovered one unusual\nbackdoor executable (md5: 092ae9ce61f6575344c424967bd79437). It comes as a DLL installed as a\nservice that indirectly listens to TCP port 80 on the target system and responds to a specific URL schema,\nregistered with Windows HTTP Service API: http://+/requested.html. The malware responds to HTTP\nGET/POST requests using this schema and is not easy to discover, which can help it remain invisible for a\nlong time.\n\nBased on the malware network behavior, we identified three further, previously unknown, victims, a\nvideogame company, a conglomerate holding company and a pharmaceutical company, all based in South\nKorea, which responded with a confirmation to the malware protocol, indicating compromised servers. We\n\n\n-----\n\nare in the process of notifying the victim companies via our local regional channels. Considering that this\ntype of malware is not widely used and is a custom one, we believe that the same threat actor or a related\ngroup are behind these further compromises. This expands the list of previously known usual targets.\n\n## Conclusions\n\nWhile attacks on supply chain companies are not new, the current incident is a big landmark in the\ncyberattack landscape. Not only does it show that even reputable vendors may suffer from compromising of\ndigital certificates, but it raises many concerns about the software development infrastructure of all other\nsoftware companies. ShadowPad, a powerful threat actor, previously concentrated on hitting one company\nat a time. Current research revealed at least four companies compromised in a similar manner, with three\nmore suspected to have been breached by the same attacker. How many more companies are\ncompromised out there is not known. What is known is that ShadowPad succeeded in backdooring\ndeveloper tools and, one way or another, injected malicious code into digitally signed binaries, subverting\ntrust in this powerful defense mechanism.\n\nDoes it mean that we should stop trusting digital signatures? No. But we definitely need to investigate all\nstrange or anomalous behavior, even by trusted and signed applications. Software vendors should\nintroduce another line in their software building conveyor that additionally checks their software for potential\nmalware injections even after the code is digitally signed.\n\nAt this unprecedented scale of operations, it is still a mystery why attackers reduced the impact by limiting\npayload execution to 600+ victims in the case of ASUS. We are also unsure who the ultimate victims were\nor where the attackers had collected the victims MAC addresses from. If you believe you are one of the\nvictims, we recommend checking your MAC address using this [free tool or](https://kas.pr/shadowhammer) [online check website. And if you](https://shadowhammer.kaspersky.com/)\ndiscover that you have been targeted by this operation, please email us at\n[shadowhammer@kaspersky.com.](mailto:shadowhammer@kaspersky.com)\n\nWe will keep tracking the ShadowPad activities and inform you about new findings!\n\n## Indicators of compromise\n\n**C2 servers:**\n\n103.19.3[.]17\n103.19.3[.]43\n103.19.3[.]44\n117.16.142[.]9\n23.236.77[.]175\n23.236.77[.]177\n\n**Malware samples and trojanized files:**\n\n02385ea5f8463a2845bfe362c6c659fa 915086d90596eb5903bcd5b02fd97e3e\n\n04fb0ccf3ef309b1cd587f609ab0e81e 943db472b4fd0c43428bfc6542d11913\n\n05eacf843b716294ea759823d8f4ab23 95b6adbcef914a4df092f4294473252f\n\n063ff7cc1778e7073eacb5083738e6a2 98908ce6f80ecc48628c8d2bf5b2a50c\n\n06c19cd73471f0db027ab9eb85edc607 9d86dff1a6b70bfdf44406417d3e068f\n\n\n-----\n\n0e1cc8693478d84e0c5e9edb2dc8555c a17cb9df43b31bd3dad620559d434e53\n\n0f49621b06f2cdaac8850c6e9581a594 a283d5dea22e061c4ab721959e8f4a24\n\n128cecc59c91c0d0574bc1075fe7cb40 a4b42c2c95d1f2ff12171a01c86cd64f\n\n17a36ac3e31f3a18936552aff2c80249 a76a1fbfd45ad562e815668972267c70\n\n1a0752f14f89891655d746c07da4de01 a96226b8c5599e3391c7b111860dd654\n\n1b95ac1443eb486924ac4d399371397c a9c750b7a3bbf975e69ef78850af0163\n\n1d05380f3425d54e4ddfc4bacc21d90e aa15eb28292321b586c27d8401703494\n\n1e091d725b72aed432a03a505b8d617e aac57bac5f849585ba265a6cd35fde67\n\n2ffc4f0e240ff62a8703e87030a96e39 aafe680feae55bb6226ece175282f068\n\n322cb39bc049aa69136925137906d855 abbb53e1b60ab7044dd379cf80042660\n\n343ad9d459f4154d0d2de577519fb2d3 abbd7c949985748c353da68de9448538\n\n36dd195269979e01a29e37c488928497 b042bc851cafd77e471fa0d90a082043\n\n3c0a0e95ccedaaafb4b3f6fd514fd087 b044cd0f6aae371acf2e349ef78ab39e\n\n496c224d10e1b39a22967a331f7de0a2 b257f366a9f5a065130d4dc99152ee10\n\n4b8d5ae0ad5750233dc1589828da130b b4abe604916c04fe3dd8b9cb3d501d3f\n\n4fb4c6da73a0a380c6797e9640d7fa00 b572925a7286355ac9ebb12a9fc0cc79\n\n5220c683de5b01a70487dac2440e0ecb b96bd0bda90d3f28d3aa5a40816695ed\n\n53886c6ebd47a251f11b44869f67163d c0116d877d048b1ba87c0de6fd7c3fb2\n\n55a7aa5f0e52ba4d78c145811c830107 c778fc8e816061420c537db2617e0297\n\n5855ce7c4a3167f0e006310eb1c76313 cdb0a09067877f30189811c7aea3f253\n\n5b6cd0a85996a7d47a8e9f8011d4ad3f d07e6abebcf1f2119622c60ad0acf4fa\n\n5eed18254d797ccea62d5b74d96b6795 d1ed421779c31df2a059fe0f91c24721\n\n6186b317c8b6a9da3ca4c166e68883ea d4c4813b21556dd478315734e1c7ae54\n\n63606c861a63a8c60edcd80923b18f96 dc15e578401ad9b8f72c4d60b79fdf0f\n\n63f2fe96de336b6097806b22b5ab941a dca86d2a9eb6dc53f549860f103486a9\n\n6ab5386b5ad294fc6ec4d5e47c9c2470 dd792f9185860e1464b4346254b2101b\n\n6b38c772b2ffd7a7818780b29f51ccb2 e7dcfa8e75b0437975ce0b2cb123dc7b\n\n6cf305a34a71b40c60722b2b47689220 e8db4206c2c12df7f61118173be22c89\n\n6e94b8882fe5865df8c4d62d6cff5620 ea3b7770018a20fc7c4541c39ea271af\n\n7d9d29c1c03461608bcab930fef2f568 eac3e3ece94bc84e922ec077efb15edd\n\n807d86da63f0db1fc746d1f0b05bc357 ecf865c95a9bec46aa9b97060c0e317d\n\n849a2b0dc80aeca3d175c139efe5221c ef43b55353a34be9e93160bb1768b1a6\n\n8505484efde6a1009f90fa02ca42f011 f0ba34be0486037913e005605301f3ce\n\n\n-----\n\n8578f0c7b0a14f129cc66ee236c58050 f2f879989d967e03b9ea0938399464ab\n\n86a4cac227078b9c95c560c8f0370bf0 f4edc757e9917243ce513f22d0ccacf2\n\n8756bafa7f0a9764311d52bc792009f9 f9d46bbffa1cbd106ab838ee0ccc5242\n\n87a8930e88e9564a30288572b54faa46 fa83ffde24f149f9f6d1d8bc05c0e023\n\n88777aacd5f16599547926a4c9202862 fa96e56e7c26515875214eec743d2db5\n\n8baa46d0e0faa2c6a3f20aeda2556b18 fb1473e5423c8b82eb0e1a40a8baa118\n\n8ef2d715f3a0a3d3ebc989b191682017 fcfab508663d9ce519b51f767e902806\n\n092ae9ce61f6575344c424967bd79437 7f05d410dc0d1b0e7a3fcc6cdda7a2ff\n\neb37c75369046fb1076450b3c34fb8ab\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2019/2019.04.23.Operation_ShadowHammer/Operation%20ShadowHammer.pdf"
    ],
    "report_names": [
        "Operation ShadowHammer"
    ],
    "threat_actors": [
        {
            "id": "1f3cf3d1-4764-4158-a216-dd6352e671bb",
            "created_at": "2022-10-25T15:50:23.837615Z",
            "updated_at": "2025-03-27T02:00:55.556414Z",
            "deleted_at": null,
            "main_name": "APT19",
            "aliases": [
                "APT19",
                "Codoso",
                "C0d0so0",
                "Codoso Team",
                "Sunshop Group"
            ],
            "source_name": "MITRE:APT19",
            "tools": [
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1c97ccfd-1888-492c-b7b9-bb52c4c3809b",
            "created_at": "2023-01-06T13:46:38.940529Z",
            "updated_at": "2025-03-27T02:00:02.957652Z",
            "deleted_at": null,
            "main_name": "Operation ShadowHammer",
            "aliases": [],
            "source_name": "MISPGALAXY:Operation ShadowHammer",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ba3fff0c-3ba0-4855-9eeb-1af9ee18136a",
            "created_at": "2022-10-25T15:50:23.298889Z",
            "updated_at": "2025-03-27T02:00:55.433541Z",
            "deleted_at": null,
            "main_name": "menuPass",
            "aliases": [
                "menuPass",
                "POTASSIUM",
                "Stone Panda",
                "APT10",
                "Red Apollo",
                "CVNX",
                "HOGFISH",
                "BRONZE RIVERSIDE"
            ],
            "source_name": "MITRE:menuPass",
            "tools": [
                "certutil",
                "FYAnti",
                "UPPERCUT",
                "SNUGRIDE",
                "P8RAT",
                "RedLeaves",
                "SodaMaster",
                "pwdump",
                "Mimikatz",
                "PlugX",
                "PowerSploit",
                "ChChes",
                "cmd",
                "QuasarRAT",
                "AdFind",
                "Cobalt Strike",
                "PoisonIvy",
                "EvilGrab",
                "esentutl",
                "Impacket",
                "Ecipekac",
                "PsExec",
                "HUI Loader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "ba9fa308-a29a-4928-9c06-73aafec7624c",
            "created_at": "2024-05-01T02:03:07.981061Z",
            "updated_at": "2025-03-27T02:05:17.28602Z",
            "deleted_at": null,
            "main_name": "BRONZE RIVERSIDE",
            "aliases": [
                "CTG-5938 ",
                "CVNX ",
                "Hogfish ",
                "MenuPass ",
                "POTASSIUM ",
                "Red Apollo ",
                "Stone Panda ",
                "APT10 "
            ],
            "source_name": "Secureworks:BRONZE RIVERSIDE",
            "tools": [
                " ChChes",
                " Cobalt Strike",
                " PlugX",
                " PoisonIvy",
                " QuasarRAT",
                " QuasarRAT Loader",
                " RedLeaves",
                "ANEL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "46a151bd-e4c2-46f9-aee9-ee6942b01098",
            "created_at": "2023-01-06T13:46:38.288168Z",
            "updated_at": "2025-03-27T02:00:02.794118Z",
            "deleted_at": null,
            "main_name": "APT19",
            "aliases": [
                "Black Vine",
                "TEMP.Avengers",
                "PinkPanther",
                "G0073",
                "KungFu Kittens",
                "Group 13",
                "Shell Crew",
                "BRONZE FIRESTONE",
                "G0009",
                "Sunshop Group",
                "DEEP PANDA",
                "Codoso"
            ],
            "source_name": "MISPGALAXY:APT19",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c7d9878a-e691-4c6f-81ae-84fb115a1345",
            "created_at": "2022-10-25T16:07:23.359506Z",
            "updated_at": "2025-03-27T02:02:09.752427Z",
            "deleted_at": null,
            "main_name": "APT 41",
            "aliases": [
                "BrazenBamboo",
                "Bronze Atlas",
                "Double Dragon",
                "Earth Baku",
                "Grayfly",
                "Operation ColunmTK",
                "Operation CuckooBees",
                "Operation ShadowHammer",
                "Red Kelpie",
                "SparklingGoblin",
                "TA415",
                "TG-2633"
            ],
            "source_name": "ETDA:APT 41",
            "tools": [
                "9002 RAT",
                "ADORE.XSEC",
                "ASPXSpy",
                "ASPXTool",
                "AceHash",
                "Agent.dhwf",
                "Agentemis",
                "AndroidControl",
                "AngryRebel",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BLUEBEAM",
                "Barlaiy",
                "BlackCoffee",
                "Bladabindi",
                "BleDoor",
                "CCleaner Backdoor",
                "CHINACHOPPER",
                "COLDJAVA",
                "China Chopper",
                "ChyNode",
                "Cobalt Strike",
                "CobaltStrike",
                "Crackshot",
                "CrossWalk",
                "CurveLast",
                "CurveLoad",
                "DAYJOB",
                "DBoxAgent",
                "DEADEYE",
                "DEADEYE.APPEND",
                "DEADEYE.EMBED",
                "DEPLOYLOG",
                "DIRTCLEANER",
                "DUSTTRAP",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "DodgeBox",
                "DragonEgg",
                "ELFSHELF",
                "EasyNight",
                "Farfli",
                "FunnySwitch",
                "Gh0st RAT",
                "Ghost RAT",
                "HDD Rootkit",
                "HDRoot",
                "HKDOOR",
                "HOMEUNIX",
                "HUI Loader",
                "HidraQ",
                "HighNoon",
                "HighNote",
                "Homux",
                "Hydraq",
                "Jorik",
                "Jumpall",
                "KEYPLUG",
                "Kaba",
                "Korplug",
                "LATELUNCH",
                "LOLBAS",
                "LOLBins",
                "LightSpy",
                "Living off the Land",
                "Lowkey",
                "McRAT",
                "MdmBot",
                "MessageTap",
                "Meterpreter",
                "Mimikatz",
                "MoonBounce",
                "MoonWalk",
                "Motnug",
                "Moudour",
                "Mydoor",
                "NTDSDump",
                "PACMAN",
                "PCRat",
                "PINEGROVE",
                "PNGRAT",
                "POISONPLUG",
                "POISONPLUG.SHADOW",
                "POTROAST",
                "PRIVATELOG",
                "PipeMon",
                "PlugX",
                "PortReuse",
                "ProxIP",
                "ROCKBOOT",
                "RbDoor",
                "RedDelta",
                "RedXOR",
                "RibDoor",
                "Roarur",
                "RouterGod",
                "SAGEHIRE",
                "SPARKLOG",
                "SQLULDR2",
                "STASHLOG",
                "SWEETCANDLE",
                "ScrambleCross",
                "Sensocode",
                "SerialVlogger",
                "ShadowHammer",
                "ShadowPad Winnti",
                "SinoChopper",
                "Skip-2.0",
                "SneakCross",
                "Sogu",
                "Speculoos",
                "Spyder",
                "StealthReacher",
                "StealthVector",
                "TERA",
                "TIDYELF",
                "TIGERPLUG",
                "TOMMYGUN",
                "TVT",
                "Thoper",
                "Voldemort",
                "WIDETONE",
                "WINNKIT",
                "WINTERLOVE",
                "Winnti",
                "WyrmSpy",
                "X-Door",
                "XDOOR",
                "XMRig",
                "XShellGhost",
                "Xamtrav",
                "ZXShell",
                "ZoxPNG",
                "certutil",
                "certutil.exe",
                "cobeacon",
                "gresim",
                "njRAT",
                "pwdump",
                "xDll"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "0639667a-fb3f-43d9-a38c-6c123fd19c7f",
            "created_at": "2022-10-25T16:07:23.335869Z",
            "updated_at": "2025-03-27T02:02:09.743237Z",
            "deleted_at": null,
            "main_name": "APT 19",
            "aliases": [
                "APT 19",
                "Bronze Firestone",
                "C0d0so0",
                "Codoso",
                "Deep Panda",
                "Operation Kingslayer",
                "Red Pegasus",
                "Sunshop Group",
                "TG-3551"
            ],
            "source_name": "ETDA:APT 19",
            "tools": [
                "Agentemis",
                "C0d0so0",
                "Cobalt Strike",
                "CobaltStrike",
                "Derusbi",
                "EmPyre",
                "EmpireProject",
                "Fire Chili",
                "PowerShell Empire",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "04b07437-41bb-4126-bcbb-def16f19d7c6",
            "created_at": "2022-10-25T16:07:24.232628Z",
            "updated_at": "2025-03-27T02:02:10.146043Z",
            "deleted_at": null,
            "main_name": "Stone Panda",
            "aliases": [
                "APT 10",
                "ATK 41",
                "Bronze Riverside",
                "CTG-5938",
                "CVNX",
                "Cuckoo Spear",
                "Earth Kasha",
                "Granite Taurus",
                "Happyyongzi",
                "Hogfish",
                "ITG01",
                "Operation A41APT",
                "Operation Cache Panda",
                "Operation ChessMaster",
                "Operation Cloud Hopper",
                "Operation Cuckoo Spear",
                "Operation New Battle",
                "Operation Soft Cell",
                "Operation TradeSecret",
                "Potassium",
                "Red Apollo",
                "Stone Panda",
                "TA429",
                "menuPass",
                "menuPass Team"
            ],
            "source_name": "ETDA:Stone Panda",
            "tools": [
                "Agent.dhwf",
                "Agentemis",
                "Anel",
                "AngryRebel",
                "BKDR_EVILOGE",
                "BKDR_HGDER",
                "BKDR_NVICM",
                "BUGJUICE",
                "CHINACHOPPER",
                "ChChes",
                "China Chopper",
                "Chymine",
                "CinaRAT",
                "Cobalt Strike",
                "CobaltStrike",
                "DARKTOWN",
                "DESLoader",
                "DILLJUICE",
                "DILLWEED",
                "Darkmoon",
                "DelfsCake",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "Ecipekac",
                "Emdivi",
                "EvilGrab",
                "EvilGrab RAT",
                "FYAnti",
                "Farfli",
                "Gen:Trojan.Heur.PT",
                "Gh0st RAT",
                "Ghost RAT",
                "GreetCake",
                "HAYMAKER",
                "HEAVYHAND",
                "HEAVYPOT",
                "HTran",
                "HUC Packet Transmit Tool",
                "Ham Backdoor",
                "HiddenFace",
                "Impacket",
                "Invoke the Hash",
                "KABOB",
                "Kaba",
                "Korplug",
                "LODEINFO",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "MiS-Type",
                "Mimikatz",
                "Moudour",
                "Mydoor",
                "NBTscan",
                "NOOPDOOR",
                "Newsripper",
                "P8RAT",
                "PCRat",
                "PlugX",
                "Poison Ivy",
                "Poldat",
                "PowerSploit",
                "PowerView",
                "PsExec",
                "PsList",
                "Quarks PwDump",
                "Quasar RAT",
                "QuasarRAT",
                "RedDelta",
                "RedLeaves",
                "Rubeus",
                "SNUGRIDE",
                "SPIVY",
                "SharpSploit",
                "SigLoader",
                "SinoChopper",
                "SodaMaster",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Trochilus RAT",
                "UpperCut",
                "Vidgrab",
                "WinRAR",
                "WmiExec",
                "Wmonder",
                "Xamtrav",
                "Yggdrasil",
                "Zlib",
                "certutil",
                "certutil.exe",
                "cobeacon",
                "dfls",
                "lena",
                "nbtscan",
                "pivy",
                "poisonivy",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716495,
    "ts_updated_at": 1743041834,
    "ts_creation_date": 1556074086,
    "ts_modification_date": 1556074086,
    "files": {
        "pdf": "https://archive.orkl.eu/abc7a05c68aa39ac904c0f59a30c583f7c379da0.pdf",
        "text": "https://archive.orkl.eu/abc7a05c68aa39ac904c0f59a30c583f7c379da0.txt",
        "img": "https://archive.orkl.eu/abc7a05c68aa39ac904c0f59a30c583f7c379da0.jpg"
    }
}