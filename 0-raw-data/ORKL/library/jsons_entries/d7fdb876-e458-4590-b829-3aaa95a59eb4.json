{
    "id": "d7fdb876-e458-4590-b829-3aaa95a59eb4",
    "created_at": "2022-12-27T17:06:14.075317Z",
    "updated_at": "2025-03-18T19:58:09.292238Z",
    "deleted_at": null,
    "sha1_hash": "bb90576c05d17e97447dc798e8963e0d66178f30",
    "title": "BlackMatter Ransomware",
    "authors": "CISA, NSA, FBI",
    "file_creation_date": "2021-10-18T14:49:54Z",
    "file_modification_date": "2021-10-18T14:49:54Z",
    "file_size": 919870,
    "plain_text": "Co-Authored by:\n\n0\n\nTLP:WHITE\n\nProduct ID: AA21-291A\nOctober 18, 2021\n\nBlackMatter Ransomware\nSUMMARY\nThis joint Cybersecurity Advisory was developed by the\nCybersecurity and Infrastructure Security Agency (CISA),\nthe Federal Bureau of Investigation (FBI), and the\nNational Security Agency (NSA) to provide information on\nBlackMatter ransomware. Since July 2021, BlackMatter\nransomware has targeted multiple U.S. critical\ninfrastructure entities, including two U.S. Food and\nAgriculture Sector organizations.\n\nActions you Can Take Now to\nProtect Against BlackMatter\nRansomware:\n Implement and enforce backup\nand restoration policies and\nprocedures.\n Use strong, unique passwords.\n Use multi-factor authentication.\n Implement network segmentation\nand traversal monitoring.\n\nThis advisory provides information on cyber actor tactics,\ntechniques, and procedures (TTPs) obtained from a\nsample of BlackMatter ransomware analyzed in a\nsandbox environment as well from trusted third-party reporting. Using embedded, previously\ncompromised credentials, BlackMatter leverages the Lightweight Directory Access Protocol (LDAP)\nand Server Message Block (SMB) protocol to access the Active Directory (AD) to discover all hosts\non the network. BlackMatter then remotely encrypts the hosts and shared drives as they are found.\nRansomware attacks against critical infrastructure entities could directly affect consumer access to\ncritical infrastructure services; therefore, CISA, the FBI, and NSA urge all organizations, including\ncritical infrastructure organizations, to implement the recommendations listed in the Mitigations\nsection of this joint advisory. These mitigations will help organizations reduce the risk of compromise\nfrom BlackMatter ransomware attacks.\n\nVictims of ransomware should report it immediately to CISA at us-cert.cisa.gov/report, a local FBI Field Office,\nor U.S. Secret Service Field Office. When available, please include the following information regarding the\nincident: date, time, and location of the incident; type of activity; number of people affected; type of equipment\nused for the activity; the name of the submitting company or organization; and a designated point of contact. For\nNSA client requirements or general cybersecurity inquiries, contact the NSA Cybersecurity Requirements\nCenter at 410-854-4200 or Cybersecurity_Requests@nsa.gov.\nThis document was developed by CISA, the FBI, and NSA in furtherance of their respective cybersecurity\nmissions, including their responsibilities to develop and issue cybersecurity specifications and mitigations.\nThis document is marked TLP:WHITE. Disclosure is not limited. Sources may use TLP:WHITE when information\ncarries minimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public\nrelease. Subject to standard copyright rules, TLP:WHITE information may be distributed without restriction.\nFor more information on the Traffic Light Protocol, see cisa.gov/tlp/.\nTLP:WHITE\n\nCISA | FBI | NSA\n\nTLP:WHITE\n\nDraft\n\nTECHNICAL DETAILS\nOverview\nFirst seen in July 2021, BlackMatter is ransomware-as-a-service (Raas) tool that allows the\nransomware’s developers to profit from cybercriminal affiliates (i.e., BlackMatter actors) who deploy it\nagainst victims. BlackMatter is a possible rebrand of DarkSide, a RaaS which was active from\nSeptember 2020 through May 2021. BlackMatter actors have attacked numerous U.S.-based\norganizations and have demanded ransom payments ranging from $80,000 to $15,000,000 in Bitcoin\nand Monero.\n\nTactics, Techniques, and Procedures\nThis advisory provides information on cyber actor TTPs\nobtained from the following sample of BlackMatter\nransomware, which was analyzed in a sandbox\nenvironment, as well as from trusted third parties: SHA256: 706f3eec328e91ff7f66c8f0a2fb9b556325\nc153a329a2062dc85879c540839d. (Note: click here to\nsee the sample’s page on VirusTotal.)\n\nThis advisory uses the MITRE\nATT&CK® framework, version 9.\nSee the ATT&CK for Enterprise for\nall referenced threat actor tactics and\ntechniques.\n\nThe BlackMatter variant uses embedded admin or user credentials that were previously compromised\nand NtQuerySystemInformation and EnumServicesStatusExW to enumerate running processes\nand services, respectively. BlackMatter then uses the embedded credentials in the LDAP and SMB\nprotocol to discover all hosts in the AD and the srvsvc.NetShareEnumAll Microsoft Remote\nProcedure Call (MSRPC) function to enumerate each host for accessible shares. Notably, this variant\nof BlackMatter leverages the embedded credentials and SMB protocol to remotely encrypt, from the\noriginal compromised host, all discovered shares’ contents, including ADMIN$, C$, SYSVOL, and\nNETLOGON.\nBlackMatter actors use a separate encryption binary for Linux-based machines and routinely encrypt\nESXI virtual machines. Rather than encrypting backup systems, BlackMatter actors wipe or reformat\nbackup data stores and appliances.\nTable 1 maps BlackMatter’s capabilities to the MITRE ATT&CK for Enterprise framework, based on\nthe analyzed variant and trusted third-party reporting.\nTable 1: BlackMatter Actors and Ransomware TTPs\nTactic\n\nTechnique\n\nProcedure\n\nPersistence\n[TA0003]\n\nExternal Remote Services\n[T1133]\n\nBlackMatter leverages legitimate remote\nmonitoring and management software\nand remote desktop software, often by\n\nPage 2 of 7 | Product ID: AA21-291A\nTLP: WHITE\n\nCISA | FBI | NSA\n\nTLP:WHITE\n\nDraft\nTactic\n\nTechnique\n\nProcedure\nsetting up trial accounts, to maintain\npersistence on victim networks.\n\nCredential Access\n[TA0006]\n\nOS Credential Dumping: LSASS\nMemory [T1003.001]\n\nBlackMatter harvests credentials from\nLocal Security Authority Subsystem\nService (LSASS) memory using procmon.\n\nDiscovery\n[TA0007]\n\nRemote System Discovery\n[T1018]\n\nBlackMatter leverages LDAP and SMB\nprotocol to discover all hosts in the AD.\n\nProcess Discovery [T1057]\n\nBlackMatter uses\nNtQuerySystemInformation to\nenumerate running processes.\n\nSystem Service Discovery\n[T1007]\n\nBlackMatter uses\nEnumServicesStatusExW to enumerate\nrunning services on the network.\n\nLateral Movement\n[TA0008]\n\nRemote Services: SMB/Windows\nAdmin Shares [T1021.002]\n\nBlackMatter uses\nsrvsvc.NetShareEnumAll MSRPC\nfunction to enumerate and SMB to\nconnect to all discovered shares,\nincluding ADMIN$, C$, SYSVOL, and\nNETLOGON.\n\nExfiltration\n[TA0010]\n\nExfiltration Over Web Service\n[T1567]\n\nBlackMatter attempts to exfiltrate data for\nextortion.\n\nImpact [TA0040]\n\nData Encrypted for Impact\n[T1486]\n\nBlackMatter remotely encrypts shares via\nSMB protocol and drops a ransomware\nnote in each directory.\n\nDisk Wipe [T1561]\n\nBlackMatter may wipe backup systems.\n\nDETECTION SIGNATURES\nThe following Snort signatures may be used for detecting network activity associated with BlackMatter\nactivity.\nIntrusion Detection System Rule:\nalert tcp any any -> any 445 ( msg:\"BlackMatter remote encryption attempt\";\ncontent:\"|01 00 00 00 00 00 05 00 01 00|\"; content:\"|2e 00 52 00 45 00 41 00 44\n00 4d 00 45 00 2e 00 74 00|\"; distance:100; detection_filter: track by_src, count\n4, seconds 1; priority:1; sid:11111111111; )\n\nPage 3 of 7 | Product ID: AA21-291A\nTLP: WHITE\n\nCISA | FBI | NSA\n\nTLP:WHITE\n\nDraft\nInline Intrusion Prevention System Rule:\nalert tcp any any -> any 445 ( msg:\"BlackMatter remote encryption attempt\";\ncontent:\"|01 00 00 00 00 00 05 00 01 00|\"; content:\"|2e 00 52 00 45 00 41 00 44\n00 4d 00 45 00 2e 00 74 00|\"; distance:100; priority:1; sid:10000001; )\nrate_filter gen_id 1, sig_id 10000001, track by_src, count 4, seconds 1,\nnew_action reject, timeout 86400\n\nMITIGATIONS\nCISA, the FBI, and NSA urge network defenders, especially for critical infrastructure organizations, to\napply the following mitigations to reduce the risk of compromise by BlackMatter ransomware:\n\nImplement Detection Signatures\n\n\nImplement the detection signatures identified above. These signatures will identify and\nblock placement of the ransom note on the first share that is encrypted, subsequently blocking\nadditional SMB traffic from the encryptor system for 24 hours.\n\nUse Strong Passwords\n\n\nRequire all accounts with password logins (e.g., service account, admin accounts, and\ndomain admin accounts) to have strong, unique passwords. Passwords should not be\nreused across multiple accounts or stored on the system where an adversary may have\naccess. Note: devices with local administrative accounts should implement a password policy\nthat requires strong, unique passwords for each individual administrative account.\n\nImplement Multi-Factor Authentication\n\n\nRequire multi-factor authentication for all services to the extent possible, particularly for\nwebmail, virtual private networks, and accounts that access critical systems.\n\nPatch and Update Systems\n\n\nKeep all operating systems and software up to date. Timely patching is one of the most\nefficient and cost-effective steps an organization can take to minimize its exposure to\ncybersecurity threats.\n\nLimit Access to Resources over the Network\n\n\n\n\nRemove unnecessary access to administrative shares, especially ADMIN$ and C$. If\nADMIN$ and C$ are deemed operationally necessary, restrict privileges to only the necessary\nservice or user accounts and perform continuous monitoring for anomalous activity.\nUse a host-based firewall to only allow connections to administrative shares via SMB from a\nlimited set of administrator machines.\n\nPage 4 of 7 | Product ID: AA21-291A\nTLP: WHITE\n\nCISA | FBI | NSA\n\nTLP:WHITE\n\nDraft\n\nImplement Network Segmentation and Traversal Monitoring\nAdversaries use system and network discovery techniques for network and system visibility and\nmapping. To limit an adversary from learning the organization’s enterprise environment, limit common\nsystem and network discovery techniques by taking the following actions.\n\n\n\n\nSegment networks to prevent the spread of ransomware. Network segmentation can help\nprevent the spread of ransomware by controlling traffic flows between—and access to—\nvarious subnetworks and by restricting adversary lateral movement.\nIdentify, detect, and investigate abnormal activity and potential traversal of the\nindicated ransomware with a networking monitoring tool. To aid in detecting the\nransomware, implement a tool that logs and reports all network traffic, including lateral\nmovement activity on a network. Endpoint detection and response (EDR) tools are particularly\nuseful for detecting lateral connections as they have insight into common and uncommon\nnetwork connections for each host.\n\nUse Admin Disabling Tools to Support Identity and Privileged Access Management\nIf BlackMatter uses compromised credentials during non-business hours, the compromise may not be\ndetected. Given that there has been an observed increase in ransomware attacks during nonbusiness hours, especially holidays and weekends, CISA, the FBI, and NSA recommend\norganizations:\n\n\n\n\nImplement time-based access for accounts set at the admin level and higher. For\nexample, the Just-in-Time (JIT) access method provisions privileged access when needed\nand can support enforcement of the principle of least privilege (as well as the Zero Trust\nmodel). This is a process where a network-wide policy is set in place to automatically disable\nadmin accounts at the AD level when the account is not in direct need. When the account is\nneeded, individual users submit their requests through an automated process that enables\naccess to a system, but only for a set timeframe to support task completion.\nDisable command-line and scripting activities and permissions. Privilege escalation and\nlateral movement often depend on software utilities that run from the command line. If threat\nactors are not able to run these tools, they will have difficulty escalating privileges and/or\nmoving laterally.\n\nImplement and Enforce Backup and Restoration Policies and Procedures\n\n\n\n\nMaintain offline backups of data, and regularly maintain backup and restoration. This\npractice will ensure the organization will not be severely interrupted, have irretrievable data, or\nbe held up by a ransom demand.\nEnsure all backup data is encrypted, immutable (i.e., cannot be altered or deleted) and\ncovers the entire organization’s data infrastructure.\n\nPage 5 of 7 | Product ID: AA21-291A\nTLP: WHITE\n\nCISA | FBI | NSA\n\nTLP:WHITE\n\nDraft\nCISA, the FBI, and NSA urge critical infrastructure organizations to apply the following additional\nmitigations to reduce the risk of credential compromise.\n\n\n\n\n\n\nDisable the storage of clear text passwords in LSASS memory.\nConsider disabling or limiting New Technology Local Area Network Manager (NTLM)\nand WDigest Authentication.\nImplement Credential Guard for Windows 10 and Server 2016 (Refer to Microsoft: Manage\nWindows Defender Credential Guard for more information). For Windows Server 2012R2,\nenable Protected Process Light for Local Security Authority (LSA).\nMinimize the AD attack surface to reduce malicious ticket-granting activity. Malicious activity\nsuch as “Kerberoasting” takes advantage of Kerberos’ Ticket Granting service and can be\nused to obtain hashed credentials that attackers attempt to crack.\no Set a strong password policy for service accounts.\no Audit Domain Controllers to log successful Kerberos Ticket-Granting Service requests\nand ensure the events are monitored for anomalous activity.\n\nRefer to the CISA-Multi-State information and Sharing Center (MS-ISAC) Joint Ransomware Guide\nfor general mitigations to prepare for and reduce the risk of compromise by ransomware attacks.\nNote: critical infrastructure organizations with industrial control systems/operational technology\nnetworks should review joint CISA-FBI Cybersecurity Advisory AA21-131A: DarkSide Ransomware:\nBest Practices for Preventing Business Disruption from Ransomware Attacks for more mitigations,\nincluding mitigations to reduce the risk of severe business or functional degradation should their entity\nfall victim to a ransomware attack.\n\nRESPONDING TO RANSOMWARE ATTACKS\nIf a ransomware incident occurs at your organization, CISA, the FBI, and NSA recommend:\n\n\n\n\n\nFollowing the Ransomware Response Checklist on p. 11 of the CISA-Multi-State\nInformation Sharing and Analysis Center (MS-ISAC) Joint Ransomware Guide.\nScanning backups. If possible, scan backup data with an antivirus program to check that it is\nfree of malware.\nReporting incidents immediately to the FBI at a local FBI Field Office, CISA at uscert.cisa.gov/report, or the U.S. Secret Service at a U.S. Secret Service Field Office.\nApplying incident response best practices found in the joint Advisory, Technical\nApproaches to Uncovering and Remediating Malicious Activity, developed by CISA and the\ncybersecurity authorities of Australia, Canada, New Zealand, and the United Kingdom.\n\nNote: CISA, the FBI, and NSA strongly discourage paying a ransom to criminal actors. Paying a\nransom may embolden adversaries to target additional organizations, encourage other criminal actors\nto engage in the distribution of ransomware, and/or may fund illicit activities. Paying the ransom also\ndoes not guarantee that a victim’s files will be recovered.\n\nPage 6 of 7 | Product ID: AA21-291A\nTLP: WHITE\n\nCISA | FBI | NSA\n\nTLP:WHITE\n\nDraft\n\nRESOURCES\n\n\n\n\n\n\nFor more information and resources on protecting against and responding to ransomware,\nrefer to StopRansomware.gov, a centralized, whole-of-government webpage providing\nransomware resources and alerts.\nCISA’s Ransomware Readiness Assessment (RRA) is a no-cost self-assessment based on a\ntiered set of practices to help organizations better assess how well they are equipped to\ndefend and recover from a ransomware incident.\nCISA offers a range of no-cost cyber hygiene services to help critical infrastructure\norganizations assess, identify, and reduce their exposure to threats, including ransomware. By\nrequesting these services, organizations of any size could find ways to reduce their risk and\nmitigate attack vectors.\n\nNote: the information you have accessed or received is being provided “as is” for informational\npurposes only. CISA, the FBI, and NSA do not endorse any commercial product or service, including\nany subjects of analysis. Any reference to specific commercial products, processes, or services by\nservice mark, trademark, manufacturer, or otherwise, does not constitute or imply their endorsement,\nrecommendation, or favoring by CISA, the FBI, or NSA.\n\nPage 7 of 7 | Product ID: AA21-291A\nTLP: WHITE",
    "language": "EN",
    "sources": [
        {
            "id": "4e039bf8-7239-4999-8ec0-eb202d1465af",
            "created_at": "2022-12-04T11:19:36.52593Z",
            "updated_at": "2022-12-04T11:19:36.52593Z",
            "deleted_at": null,
            "name": "ORKL",
            "url": "https://github.com/ORKL/library",
            "description": "ORKL Community Contributed Content",
            "reports": null
        }
    ],
    "references": [
        "https://media.defense.gov/2021/Oct/18/2002875430/-1/-1/0/CSA_BLACKMATTER_RANSOMWARE_211018.PDF"
    ],
    "report_names": [
        "CSA_BLACKMATTER_RANSOMWARE_211018.PDF"
    ],
    "threat_actors": [],
    "ts_created_at": 1672160774,
    "ts_updated_at": 1742327889,
    "ts_creation_date": 1634568594,
    "ts_modification_date": 1634568594,
    "files": {
        "pdf": "https://archive.orkl.eu/bb90576c05d17e97447dc798e8963e0d66178f30.pdf",
        "text": "https://archive.orkl.eu/bb90576c05d17e97447dc798e8963e0d66178f30.txt",
        "img": "https://archive.orkl.eu/bb90576c05d17e97447dc798e8963e0d66178f30.jpg"
    }
}