{
    "id": "758681e7-7e0a-4363-b545-32aba6cf644e",
    "created_at": "2023-01-12T14:59:39.326595Z",
    "updated_at": "2025-03-27T02:05:56.423808Z",
    "deleted_at": null,
    "sha1_hash": "e2b0c22daf0fb29b7a7eb73fcdbee31eb80f4a4d",
    "title": "2021-05-12 - Nefilim Ransomware",
    "authors": "",
    "file_creation_date": "2022-05-28T15:38:15Z",
    "file_modification_date": "2022-05-28T15:38:15Z",
    "file_size": 967737,
    "plain_text": "# Nefilim Ransomware\n\n**[blog.qualys.com/vulnerabilities-research/2021/05/12/nefilim-ransomware](https://blog.qualys.com/vulnerabilities-research/2021/05/12/nefilim-ransomware)**\n\nBajrang Mane May 12, 2021\n\nOver the past year there has been a rise in extortion malware that focuses on stealing sensitive data and\nthreatening to publish the data unless a ransom is paid. This technique bypasses some of the mitigations\nput in place, such as backups, which would allow IT organizations to recover data without having to pay\nsuch a ransom. One of the more popular ransomware families over the last few months to switch to this\nextortion tactic was Nefilim.\n\n## About Nefilim Ransomware\n\nNefilim ransomware emerged in March 2020 when Nemty operators quit the ransomware as a service\nmodel to concentrate their energy on more targeted attacks with more focused resources. The author of\nthe Nemty ransomware also appears to have shared Nemty’s source code with others. According to Vitali\nKremez and ID Ransomware’s Michael Gillespie, the new Nefilim ransomware appears to be based on\nNemty’s code. Sharing many notable similarities with Nemty version 2.5, Nefilim has the capabilities to\nmove laterally within networks.\n\n[Nefilim targets vulnerabilities such as CVE-2019-11634 and](https://threatpost.com/nefilim-ransomware-ghost-account/163341/) [CVE-2019-19781 in Citrix gateway devices,](https://cyware.com/news/nefilim-gang-leveraged-citrix-gateway-exploit-6da5fa37)\nidentified in December 2019 and patched in January 2020. The hackers target organizations using the\nunpatched or poorly secured Citrix remote-access technology, stealing data and then deploying\nransomware.\n\nNefilim attackers exfiltrate sensitive data before encryption. When ransoms are not paid, they have been\nknown to shame victims by posting their data on the dark web.\n\n## Technical Details\n\n\n-----\n\n**Initial access**\n\nNefilim ransomware is distributed through exposed Remote Desktop Protocol (RDP) setups by bruteforcing them and using other known vulnerabilities for initial access, i.e. vulnerabilities in Citrix gateway\ndevices. Nefilim places a heavy emphasis on Remote Desktop Protocols.\n\nOnce an attacker gains a foothold on the victim system, the attacker drops and executes its components\nsuch as anti-antivirus, exfiltration tools, and finally Nefilim itself.\n\n**Lateral Movement**\n\nAmong the various tactics and techniques used by the attackers, they rely on tools such as PsExec to\nremotely execute commands in their victims’ networks. It has been also seen that Nefilim uses other tools\nto gather credentials that include Mimikatz, LaZagne, and NirSoft’s NetPass. It uses bat files to stop\nservices/kill processes as shown in below image, and the stolen credentials are used to reach high-value\nmachines like servers. The hackers work to move around the network before deploying their ransomware\nto find out where juicier data may be stored. They exfiltrate sensitive data before encryption.\n\nSome of the commands that execute by the attacker\n```\nStart copy kill.bat \\destinationip\\c$\\windows\\temp\nStart psexec.exe \\destinationip -u domain\\username\\ -p password -d -h -r mstdc -s -accepteula nobanner c:\\windows\\teamp\\Kill.bat\nStart psexec.exe -accepteula \\destinationip -u domain\\username\\ -p password reg add\nHKLM\\software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System /v EnableLUA /t REG_DWORD /d 0 /F\nWMIC /node: \\destinationip /username:”domain\\username” /password:”password” process CALL CREATE\n“cmd.exe /c copy \\sourceip\\c$\\windows\\temp C:\\WINDOWS\\TEMP\\kill.bat\"\nWMIC /node: \\destinationip /username:”domain\\username” /password:”password” process CALL CREATE\n“cmd.exe /c C:\\WINDOWS\\TEMP\\kill.bat\"\n\n```\nBelow images shows A batch file to stop services/kill processes\n\n\n-----\n\nFig. 1 Stopping Services\n\nFig. 2 Killing Process\n\n**Data exfiltration**\n\nIt copies data from servers/shared directories to the local directory and compresses with dropped 7zip\nbinary. It also drops and installs MegaSync to exfiltrate data.\n\n\n-----\n\n**Ransomware Execution**\n\nThe Nefilim malware uses AES-128 encryption to lock files and their blackmail payments are made via\nemail. After encryption, it dropped the ransomware note by named ‘NEFILIM-DECRYPT.txt’. All files are\nencrypted with the extension of (.NEFILIM). It appends AES encrypted key at end of the encrypted file.\nThis AES encryption key will then be encrypted by an RSA-2048 public key that is embedded in the\nransomware executable. In addition to the encrypted AES key, the ransomware will also add the “NEFILIM”\nstring as a file marker to all encrypted files.\n\nFig. 3 Crypto API’s in Nefilim IOC\nIn the Below image malware create Mutex\n\nFig. 4 Creating Mutex\n\n\n-----\n\nSome of the Anti-debugging techniques: Ransomware uses anti-debugging method by calling the\nIsDebuggerPresent function. This function detects if the calling process is being debugged by a user-mode\ndebugger. It also makes use of API GetTickCount / QueryPerformanceCounter to get the number of ticks\nsince the last system reboot. It checks for a timestamp and compare it to another one after a few malicious\ninstructions, in order to check if there was a delay.\n\nFig. 5 Anti debugging API\n\nFig. 6 Anti debugging API\nShell execute: Nefilim delete itself from the target systems after infection with the help of ShellExecute API\n```\n\"C:\\Windows\\System32\\cmd.exe\" /c timeout /t 3 /nobreak && del\n\"C:\\Users\\admin\\Download{ransomware_filename}.exe\" /s /f /q\n\n```\n\n-----\n\nFig. 7 Self Deletion\n\n## High-Profile Attacks Taking a Toll\n\nNefilim’s highest-profile ransomware attack to date was against the Australian shipping organization, Toll\nGroup. The attack was first published on May 5, 2020. Two months previously, Toll Group was a victim of a\nNetwalker ransomware attack. In both cases, Toll Group refused to pay the ransom. In response, Nefilim\n[leaked sensitive Toll Group data and popularized that Toll Group had failed to employ full cybersecurity](https://www.bankinfosecurity.com/blogs/toll-group-data-leaked-following-second-ransomware-incident-p-2902)\nprotocols even after the Netwalker attack, potentially making the organization vulnerable to more attacks.\nThis demonstrates how Nefilim will keep the pressure on its victims to pay ransoms.\n\n## Mitigation or Additional Important Safety Measures\n\n**Network**\n\nKeep strong and unique passwords for login accounts.\nDisable RDP if not used. If required change RDP port to a non-standard port.\nConfigure firewall in following way,\n\nDeny access to Public IPs to important ports (in this case RDP port 3389)\nAllow access to only IP’s which are under your control.\nUse VPN to access the network, instead of exposing RDP to the Internet. Possibility implement Two\nFactor Authentication (2FA).\nSet lockout policy which hinders credentials guessing.\nCreate a separate network folder for each user when managing access to shared network folders.\n\n**Take regular data backup**\n\nProtect systems from ransomware by periodically backing up important files regularly and keep a\nrecent backup copy offline. Encrypt your backup.\nIf your computer gets infected with ransomware, your files can be restored from the offline backup\nonce the malware has been removed.\nAlways use a combination of online and offline backup.\n\n\n-----\n\nDo not keep offline backups connected to your system as this data could be encrypted when\nransomware strike.\n\n**Keep software updated**\n\nAlways keep your security software (antivirus, firewall, etc.) up to date to protect your computer from\nnew variants of malware.\nRegularly patch and update applications, software, and operating systems to address any exploitable\nsoftware vulnerabilities.\nDo not download cracked/pirated software as they risk backdoor entry for malware into your\ncomputer.\nAvoid downloading software from untrusted P2P or torrent sites. In most cases, they are malicious\nsoftware.\n\n**Having minimum required privileges**\n\nDon’t assign Administrator privileges to users. Most importantly, do not stay logged in as an\nadministrator unless it is strictly necessary. Also, avoid browsing, opening documents, or other\nregular work activities while logged in as an administrator.\n\n## Monitor for Lateral Movement\n\nTo spot these attacks, keep an eye out not only for attack code but also monitor for any evidence of\nlateral movement and data exfiltration within the environment. To determine if an organization has\nbeen hit by Nefilim, check remote-access systems for any signs of unauthorized access. To identify\npotential data exfiltration, additionally identify unusual host outbound traffic patterns.\n\n## Nefilim TTP Map\n\n\n**Initial**\n**Access** **Execution**\n\n\n**Credential**\n**Access** **Discovery**\n\n\n**Lateral**\n**Movement** **Exfiltration** **Impact**\n\n\nExploit\nPublicFacing\nApplication\n(T1190)\n\n\nNative API\n(T1106)\n\n\n**Defense**\n**Evasion**\n\nFile\nDeletion\n(T1070.004)\n\nImpair\nDefenses:\nDisable or\nModify\nTools\n(T1562:001)\n\n\nOS\nCredential\nDumping\n(T1003)\n\n\nSoftware\nDiscovery:\nSecurity\nSoftware\nDiscovery\n(T1518.001)\n\nRemote\nSystem\nDiscovery\n(T1018)\n\nSystem\nInformation\nDiscovery\n(T1082)\n\n\nLateral\nTool\nTransfer\n(T1570)\n\n\nExfiltration\nOver Web\nService:\nExfiltration\nto Cloud\nStorage\n(T1567.002)\n\n\nData\nEncrypted\nfor impact\n(T1486)\n\nInhibit\nsystem\nRecovery\n(T1490)\n\n\n-----\n\n**Initial**\n**Access** **Execution**\n\n\n**Defense**\n**Evasion**\n\n\n**Credential**\n**Access** **Discovery**\n\nFile and\nDirectory\nDiscovery\n(T1083)\n\n\n**Lateral**\n**Movement** **Exfiltration** **Impact**\n\n\n## Indicators of Compromise (IOCs)\n\n**SHA256**\n```\n8be1c54a1a4d07c84b7454e789a26f04a30ca09933b41475423167e232abea2b\nb8066b7ec376bc5928d78693d236dbf47414571df05f818a43fb5f52136e8f2e\n3080b45bab3f804a297ec6d8f407ae762782fa092164f8ed4e106b1ee7e24953\n7de8ca88e240fb905fc2e8fd5db6c5af82d8e21556f0ae36d055f623128c3377\nb227fa0485e34511627a8a4a7d3f1abb6231517be62d022916273b7a51b80a17\n3bac058dbea51f52ce154fed0325fd835f35c1cd521462ce048b41c9b099e1e5\n353ee5805bc5c7a98fb5d522b15743055484dc47144535628d102a4098532cd5\n5ab834f599c6ad35fcd0a168d93c52c399c6de7d1c20f33e25cb1fdb25aec9c6\n52e25bdd600695cfed0d4ee3aca4f121bfebf0de889593e6ba06282845cf39ea\n35a0bced28fd345f3ebfb37b6f9a20cc3ab36ab168e079498f3adb25b41e156f\n7a73032ece59af3316c4a64490344ee111e4cb06aaf00b4a96c10adfdd655599\n08c7dfde13ade4b13350ae290616d7c2f4a87cbeac9a3886e90a175ee40fb641\nD4492a9eb36f87a9b3156b59052ebaf10e264d5d1ce4c015a6b0d205614e58e3\nB8066b7ec376bc5928d78693d236dbf47414571df05f818a43fb5f52136e8f2e\nfcc2921020690a58c60eba35df885e575669e9803212f7791d7e1956f9bf8020\n\n## References\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-05-12 - Nefilim Ransomware.pdf"
    ],
    "report_names": [
        "2021-05-12 - Nefilim Ransomware.pdf"
    ],
    "threat_actors": [
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535579,
    "ts_updated_at": 1743041156,
    "ts_creation_date": 1653752295,
    "ts_modification_date": 1653752295,
    "files": {
        "pdf": "https://archive.orkl.eu/e2b0c22daf0fb29b7a7eb73fcdbee31eb80f4a4d.pdf",
        "text": "https://archive.orkl.eu/e2b0c22daf0fb29b7a7eb73fcdbee31eb80f4a4d.txt",
        "img": "https://archive.orkl.eu/e2b0c22daf0fb29b7a7eb73fcdbee31eb80f4a4d.jpg"
    }
}