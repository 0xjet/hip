{
    "id": "92c19aec-3262-4567-a199-2ec69cfed46c",
    "created_at": "2022-10-25T16:48:24.306966Z",
    "updated_at": "2025-03-27T02:16:20.85768Z",
    "deleted_at": null,
    "sha1_hash": "dc20be49cbcecaf38bde2105a54580eb96605c25",
    "title": "The 'Penquin' Turla",
    "authors": "Kaspersky",
    "file_creation_date": "2014-12-09T03:11:15Z",
    "file_modification_date": "2014-12-09T03:11:15Z",
    "file_size": 145465,
    "plain_text": "Recently, an interesting malicious sample was uploaded to a multi-scanner service. This immediately\n\ntriggered our interest because it appears to represent a previously unknown piece of a larger puzzle. That\n\npuzzle is \"Turla\", one of the most complex APTs in the world.\n\n[We have written previously about the Turla APT with posts about their Epic Turla operations and](http://securelist.com/analysis/publications/65545/the-epic-turla-operation/)\n\n[Agent.btz inspiration . So far, every single Turla sample we've encountered was designed for the Microsoft](http://securelist.com/blog/virus-watch/58551/agent-btz-a-source-of-inspiration/)\n\nWindows family, 32 and 64 bit operating systems. The newly discovered Turla sample is unusual in the\n\nfact that it's the first Turla sample targeting the Linux operating system that we have discovered.\n\nThis newly found Turla component supports Linux for broader system support at victim sites. The attack\n\n[tool takes us further into the set alongside the Snake rootkit and components first associated with this](http://www.baesystems.com/what-we-do-rai/the-snake-campaign)\n\nactor a couple years ago. We suspect that this component was running for years at a victim site, but do not\n\nhave concrete data to support that statement just yet.\n\nThe Linux Turla module is a C/C++ executable statically linked against multiple libraries, greatly\n\nincreasing its file size. It was stripped of symbol information, more likely intended to increase analysis\n\neffort than to decrease file size. Its functionality includes hidden network communications, arbitrary\n\nremote command execution, and remote management. Much of its code is based on public sources.\n\n**Md5** **Size** **Verdict Name**\n\n0994d9deb50352e76b0322f48ee576c6 627.2 kb N/A (broken file)\n\n14ecd5e6fc8e501037b54ca263896a11 637.6 kb HEUR:Backdoor.Linux.Turla.gen\n\nGeneral executable characteristics:\n\nELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), statically linked, for GNU/Linux 2.2.5, stripped\n\nStatically linked libraries:\n\nglibc2.3.2 - the GNU C library\n\n|Md5|Size|Verdict Name|\n|---|---|---|\n|0994d9deb50352e76b0322f48ee576c6|627.2 kb|N/A (broken file)|\n|14ecd5e6fc8e501037b54ca263896a11|637.6 kb|HEUR:Backdoor.Linux.Turla.gen|\n\n\n-----\n\nlibpcap - tcpdump s network capture library\n\nHardcoded C&C, known Turla activity: news-bbc.podzone[.]org\n\nThe domain has the following pDNS IP: 80.248.65.183\n\n\n80.248.65.183\naut-num:    AS30982\n\n|Col1|80.248.65.183 aut-num: AS30982 announcement: 80.248.65.0/24 as-name: CAFENET descr: CAFE Informatique et telecommunications admin-c: YN2-AFRINIC tech-c: AN39-AFRINIC org: ORG-CIet1-AFRINIC mnt-by: AFRINIC-HM-MNT mnt-lower: CAFENET-NOC source: AFRINIC # Filtered|\n|---|---|\n\n\nNote: the C&C domain is currently sinkholed by Kaspersky Lab.\n\n## Functional description\n\n[The sample is a stealth backdoor based on the cd00r sources.](http://www.phenoelit.org/stuff/cd00r.c)\n\nThis Turla cd00r-based malware maintains stealth without requiring elevated privileges while running\n\narbitrary remote commands. It can't be discovered via netstat, a commonly used administrative tool. It\n\nuses techniques that don't require root access, which allows it to be more freely run on more victim hosts.\n\nEven if a regular user with limited privileges launches it, it can continue to intercept incoming packets and\n\nrun incoming commands on the system.\n\n### Startup and Execution\n\nTo start execution, the process requires two parameters: ID (a numeric value used as a part of the \"magic\n\npacket for authentication\") and an existing network interface name. The parameters can be inputted two\n\ndifferent ways: from STDIN, or from dropper a launching the sample. This is NOT a command-line\n\nparameter it's a real prompt asking the attacker user to provide the input parameters After the ID and\n\n\n-----\n\nscreenshot of this simple interface:\n\nWhile there is no initial network callback, a section of code maintains a hardcoded c2 string \"news\nbbc.podzone[.]org\". This fully qualified domain name was first set up in 2010, suggesting that this binary\n\nis fairly recent in the string of Turla campaigns. Also, while we haven't seen additional file download\n\nactivity from this server by this tool, it likely participated as a file server of sorts.\n\n### Magic Packets for Remote Command Execution\n\nThe module statically links PCAP libraries, and uses this code to get a raw socket, applies a filter on it, and\n\ncaptures packets, checking for a specific condition (the *original cd00r first used this method, based on\n\nports and SYN-packets). This condition is expressed here (it is based on the ID value input at startup by\n\nthe attacker):\n\nID = 123 Filter = (tcp[8:4] & 0xe007ffff = 0xe003bebe) or (udp[12:4] & 0xe007ffff = 0xe003bebe) ID =\n\n321 Filter = (tcp[8:4] & 0xe007ffff = 0x1bebe) or (udp[12:4] & 0xe007ffff = 0x1bebe)\n\nIn simple terms, it checks for an ACK number in the TCP header, or the second byte from the UDP packet\n\nbody.\n\nIf such a packet is received and the condition check is successful, execution jumps to the packet payload\n\ncontents, and it creates a regular socket. The backdoor handles this socket as a file with read/write\n\noperations. It's not the typical recv/send used in this code. It uses this new socket to connect to the source\n\naddress of the \"magic packets\". Then it reports its own PID and IP to the remote address, and starts an\n\nendless loop for receiving remote commands. When a command arrives, it is executed with a \"/bin/sh -c \"\n\nscript.\n\nFurther analysis of the sample's functionality will be updated here.\n\n## Conclusions\n\nAlthough Linux variants from the Turla framework were known to exist, we haven't seen any in the wild\n\nyet.\n\nThis specific module appears to have been put together from public sources with some added functionality\n\n\n-----\n\nversions of the implant. Perhaps the most interesting part here is the unusual command and control\n\nmechanism based on TCP/UDP packets, as well as the C&C hostname which fits previously known Turla\n\nactivity.\n\nThe discovery of this Turla module rises one big question: how many other unknown Turla variants exist?\n\n**Update: Since the publishing of this blogpost, we have discovered another Linux Turla module, which**\n\napparently represents a different malware generation than the previously known samples:\n\nThe new sample was heuristically detected by our product due to similarities with the previously\n\ndiscovered samples.\n\n**Md5** **Size** **Verdict Name**\n\n19fbd8cbfb12482e8020a887d6427315 801,561 bytes HEUR:Backdoor.Linux.Turla.gen\n\n## Related research:\n\n[BAE Systems - The Snake Campaign](http://www.baesystems.com/what-we-do-rai/the-snake-campaign)\n\n|Md5|Size|Verdict Name|\n|---|---|---|\n|19fbd8cbfb12482e8020a887d6427315|801,561 bytes|HEUR:Backdoor.Linux.Turla.gen|\n\n\n-----\n\n[TR-25 Analysis - Turla / Pfinet / Snake/ Uroburos by CIRCL.LU](https://www.circl.lu/pub/tr-25/)\n\n[\"Uroburos: the snake rootkit\", technical analysis by deresz and tecamac](http://artemonsecurity.com/uroburos.pdf)\n\n[Agent.BTZ - A Source of Inspiration?](http://securelist.com/blog/virus-watch/58551/agent-btz-a-source-of-inspiration/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/5gfajyyz8firhnttdo72j0iz6uo4eo6q",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2014/2014.12.08.Penquin_Turla/Turla_2_Penquin.pdf"
    ],
    "report_names": [
        "Turla_2_Penquin"
    ],
    "threat_actors": [
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716504,
    "ts_updated_at": 1743041780,
    "ts_creation_date": 1418094675,
    "ts_modification_date": 1418094675,
    "files": {
        "pdf": "https://archive.orkl.eu/dc20be49cbcecaf38bde2105a54580eb96605c25.pdf",
        "text": "https://archive.orkl.eu/dc20be49cbcecaf38bde2105a54580eb96605c25.txt",
        "img": "https://archive.orkl.eu/dc20be49cbcecaf38bde2105a54580eb96605c25.jpg"
    }
}