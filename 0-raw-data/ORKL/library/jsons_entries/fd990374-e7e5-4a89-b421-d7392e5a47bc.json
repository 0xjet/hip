{
    "id": "fd990374-e7e5-4a89-b421-d7392e5a47bc",
    "created_at": "2023-01-12T15:04:39.484734Z",
    "updated_at": "2025-03-27T02:17:01.030135Z",
    "deleted_at": null,
    "sha1_hash": "4b5c83e0f60093b5d23d909c9879336dcbea91d9",
    "title": "2022-07-21 - Alibaba OSS Buckets Compromised to Distribute Malicious Shell Scripts via Steganography",
    "authors": "",
    "file_creation_date": "2022-08-18T03:28:23Z",
    "file_modification_date": "2022-08-18T03:28:23Z",
    "file_size": 392473,
    "plain_text": "# Alibaba OSS Buckets Compromised to Distribute Malicious Shell Scripts via Steganography\n\n**[trendmicro.com/en_us/research/22/g/alibaba-oss-buckets-compromised-to-distribute-malicious-shell-sc.html](https://www.trendmicro.com/en_us/research/22/g/alibaba-oss-buckets-compromised-to-distribute-malicious-shell-sc.html)**\n\nJuly 21, 2022\n\n[Previously, we reported on how threat actors are targeting multiple cloud environments such as Huawei Cloud to](https://www.trendmicro.com/en_us/research/21/j/actors-target-huawei-cloud-using-upgraded-linux-malware-.html)\nhost [cryptocurrency-mining malware by abusing misconfiguration issues and weak or stolen credentials obtained](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cybercrime-and-digital-threats/security-101-the-impact-of-cryptocurrency-mining-malware)\nfrom a previous malware infection.\n\n[This time, we have identified a malicious campaign using the object storage service (OSS) of Alibaba Cloud (also](https://www.alibabacloud.com/product/object-storage-service)\nknown as Aliyun) for malware distribution and illicit cryptocurrency-mining activities. OSS is a service that allows\nAlibaba Cloud customers to store data like web application images and backup information in the cloud.\nUnfortunately, this is not the first time that we’ve seen malicious actors targeting Alibaba Cloud: Earlier this year,\n[we detailed how malicious actors disabled features inside Alibaba Cloud for cryptojacking purposes.](https://www.trendmicro.com/en_us/devops/22/b/cryptojacking-attacks-target-alibaba-ecs-instances.html)\n\nHow malicious actors abuse unsecure OSS buckets, credentials\n\nTo secure an OSS bucket, a user has [to set up a proper access policy. If this is done incorrectly, a malicious user](https://www.alibabacloud.com/help/en/object-storage-service/latest/tutorial-use-ram-policies-to-control-access-to-oss)\ncan upload or download a user’s files to or from the bucket itself.\n\n[Malicious actors can also get hold of a user’s OSS bucket by obtaining their AccessKey ID and AccessKey secret](https://www.alibabacloud.com/help/en/log-service/latest/accesskey-pair)\nor an auth-token. Any of these can be stolen from previously compromised services, particularly those that have\nsecrets accessible as configurations inside plain-text files or environmental variables. Malicious actors can also\n[obtain access to an OSS bucket by using credential stealers. TeamTNT’s extended credential harvester is a](https://www.trendmicro.com/en_us/research/21/e/teamtnt-extended-credential-harvester-targets-cloud-services-other-software.html)\nnotorious example of a stealer that targeted multiple cloud environments.\n\nWhen we investigated the technical details of this campaign, we saw that one of the shell scripts contained a\nreference to OSS KeySecret and GitHub. Initially, we assumed that malicious actors simply search for credentials\nthat have been inadvertently pushed into the GitHub public repository.\n\nFigure 1. A comment inside a malicious script suggesting that a bad developer practice has been exploited\nWe saw a comment on a malicious script in one of the samples that we analyzed and confirmed our initial\nassumption after using Google Translate to obtain an English translation of the comment that was originally\nwritten in Chinese.\n\n\n-----\n\nFigure 2. The English translation of the comment written inside a malicious script\nThe role of steganography in distributing malware to exploited OSS buckets\n\nUpon further investigation, we discovered that malicious actors uploaded images that contained an embedded\nshell script to the compromised OSS buckets using steganography.\n\nSteganography is a technique used by malicious actors to bypass defense mechanisms, especially networkrelated ones. The simplest version of this tactic involves simply changing the extension of the malicious file to a\ntrivial one, such as “.png”. As a result, a security proxy that only looks at a file’s extension would grant access to\nthe malicious file.\n\nAfter this technique was uncovered, cybercriminals were forced to improve their tactics. For example, they started\nhiding malware in images and videos for obfuscation purposes. Typically, a simple security solution looks at an\nimage file by analyzing its header. If the header matches that of a file type usually considered harmless (like a\nPNG file), then the solution would grant the file access into a corporation’s network — even if it contains malicious\nscripts.\n\nIn the campaign we analyzed, the malicious actors opted to use a simple steganography tactic and embedded\nmalware inside an image file. The PNG image itself is a legitimate image file, but the malicious actors appended a\nmalicious shell script at the end of it. A user would therefore be able to access the image itself without seeing the\nmalicious script attached to the file.\n\nFigure\n\n3. The image containing a malicious shell script\n[As Figure 4 shows, when the command \"file\" is used, it reads the header of the picture and determines that it is](https://www.man7.org/linux/man-pages/man1/file.1.html)\n[an image file. Using a tool like \"hd\" to check the raw content of the file results in the same outcome in which the](https://man7.org/linux/man-pages/man4/hd.4.html)\nheader is considered compatible with that of a PNG file.\n\n\n-----\n\nFigure 4. The PNG\n\nheader of the downloaded file\nHowever, upon downloading the image and doing a closer investigation, we found the embedded malicious shell\nscript.\n\nFigure 5. The malicious shell script embedded inside a PNG file\n[The malware authors used a Unix dd command-line utility program to extract the malicious shell script after the](https://man7.org/linux/man-pages/man1/dd.1.html)\ndownload was completed. Because this command is typically used in more advanced tasks, it’s evident that the\nauthors have at least intermediate knowledge of Unix systems.\n\nFigure 6. From PNG file to malicious code execution\n\n## Shell scripts target misconfigured Redis instances to mine Monero\n\n[We observed that the payload itself illicitly mined Monero using XMRig, an open-source and multiplatform Monero](https://github.com/xmrig/xmrig)\nminer. The campaign used the xmr-asia1[.]nanopool[.]org pool. The malicious shell scripts also targeted\n[misconfigured Redis instances, which can be abused to perform remote code execution (RCE). This is similar to](https://www.trendmicro.com/en_us/research/20/d/more-than-8-000-unsecured-redis-instances-found-in-the-cloud.html)\n[what multiple threat actors involved in a cryptojacking competition (such as TeamTNT and](https://www.trendmicro.com/vinfo/tmr/?/gb/security/news/cybercrime-and-digital-threats/teamtnt-activities-probed) [Kinsing) have done in](https://www.trendmicro.com/en_us/research/20/d/exposed-redis-instances-abused-for-remote-code-execution-cryptocurrency-mining.html)\nthe past.\n\n## Conclusion and Trend Micro solution\n\nWe are continuously observing how cybercriminals are adapting to new environments and targeting an increasing\nnumber of cloud services. As we predict that this will be an enduring trend, we advise cloud users to be aware\nthat in most cases, malicious actors will continue to exploit both misconfiguration issues and design issues in\ncloud services to easily access authentication tokens\n\n\n-----\n\nDevelopers should also avoid putting any credentials and secrets into the versioning systems of their favors or\npushing them into publicly accessible repositories. Indeed, this investigation is further proof that malicious actors\nare always actively seeking leaked or exposed credentials.\n\n[Security solutions such as Trend Micro Cloud One™ protect cloud-native systems and their various layers. By](https://www.trendmicro.com/en_us/business/products/hybrid-cloud.html)\nleveraging this solution, enterprises gain access to protection for continuous integration and continuous delivery\n[(CI/CD) pipeline and applications. The Trend Micro Cloud One platform also includes Workload Security runtime](https://www.trendmicro.com/en_us/business/products/hybrid-cloud/cloud-one-workload-security.html)\nprotection for workloads.\n\n## Indicators of compromise (IOCs)\n\nce95789643e31a65ee77a31c69a6952e9e260200b50e0e8ba6bf8493cce7fb71 Coinminer.SH.MALXMR.UWEKO\n\n34c78249ab1415afacd16cf76375a800d8d56fa5ac60b5522146e65c1521955b Trojan.Linux.XB.VSNW12G22\n\n495605cee98f3b437c3744c24fcf255d1cee7717f7e3150d38f95673ca0617e4 Trojan.Linux.FRS.VSNW12G22\n\n8bb70f52377091ccbb13e7be0a1d4dab079edeca6adc18b126bbdc40dbcf3ae4 Trojan.SH.SHELLMA.AAS\n\n8ec8e800fe3f627ce9f49268e4d67e944848f8ae3a8efc2ef6f77e46781a70f3 Trojan.Linux.MALXMR.UWELMS\n\nMITRE ATT&CK® table\n\nCloud\n\nIn this blog entry, we discuss a malicious campaign that targets Alibaba Cloud’s OSS buckets with leaked\ncredentials for malware distribution and cryptojacking.\n\nBy: Alfredo Oliveira, David Fiser\nJuly 21, 2022\nRead time: ( words)\n\n\n-----\n\nContent added to Folio\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-07-21 - Alibaba OSS Buckets Compromised to Distribute Malicious Shell Scripts via Steganography.pdf"
    ],
    "report_names": [
        "2022-07-21 - Alibaba OSS Buckets Compromised to Distribute Malicious Shell Scripts via Steganography.pdf"
    ],
    "threat_actors": [
        {
            "id": "81dde5cc-c29f-430d-8c6e-e5e92d5015e7",
            "created_at": "2022-10-25T16:07:23.704358Z",
            "updated_at": "2025-03-27T02:02:09.932453Z",
            "deleted_at": null,
            "main_name": "Harvester",
            "aliases": [],
            "source_name": "ETDA:Harvester",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "Graphon",
                "Metasploit",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f809bfcb-b200-4988-80a8-be78ef6a52ef",
            "created_at": "2023-01-06T13:46:39.186988Z",
            "updated_at": "2025-03-27T02:00:03.016358Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "Adept Libra"
            ],
            "source_name": "MISPGALAXY:TeamTNT",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1f6ae238-765f-4495-9d54-6a7883d7a319",
            "created_at": "2022-10-25T16:07:24.573456Z",
            "updated_at": "2025-03-27T02:02:10.284644Z",
            "deleted_at": null,
            "main_name": "TA511",
            "aliases": [
                "MAN1",
                "Moskalvzapoe"
            ],
            "source_name": "ETDA:TA511",
            "tools": [
                "Agentemis",
                "Chanitor",
                "Cobalt Strike",
                "CobaltStrike",
                "Ficker Stealer",
                "Hancitor",
                "NetSupport",
                "NetSupport Manager",
                "NetSupport Manager RAT",
                "NetSupport RAT",
                "NetSupportManager RAT",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c3ca592f-0669-49bd-ab5c-310007ab2fb4",
            "created_at": "2022-10-25T15:50:23.334495Z",
            "updated_at": "2025-03-27T02:00:55.445098Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "TeamTNT"
            ],
            "source_name": "MITRE:TeamTNT",
            "tools": [
                "Peirates",
                "MimiPenguin",
                "LaZagne",
                "Hildegard"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "542cf9d0-9c68-428c-aff8-81b6f59dc985",
            "created_at": "2023-02-15T02:01:49.554105Z",
            "updated_at": "2025-03-27T02:00:03.110991Z",
            "deleted_at": null,
            "main_name": "Moskalvzapoe",
            "aliases": [
                "MAN1",
                "TA511"
            ],
            "source_name": "MISPGALAXY:Moskalvzapoe",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "3fff98c9-ad02-401d-9d4b-f78b5b634f31",
            "created_at": "2023-01-06T13:46:38.376868Z",
            "updated_at": "2025-03-27T02:00:02.818071Z",
            "deleted_at": null,
            "main_name": "Cleaver",
            "aliases": [
                "Cobalt Gypsy",
                "G0003",
                "Operation Cleaver",
                "Op Cleaver",
                "Tarh Andishan",
                "Alibaba",
                "TG-2889"
            ],
            "source_name": "MISPGALAXY:Cleaver",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a6c351ea-01f1-4c9b-af75-cfbb3b269ed3",
            "created_at": "2023-01-06T13:46:39.390649Z",
            "updated_at": "2025-03-27T02:00:03.072899Z",
            "deleted_at": null,
            "main_name": "Kinsing",
            "aliases": [
                "Money Libra"
            ],
            "source_name": "MISPGALAXY:Kinsing",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535879,
    "ts_updated_at": 1743041821,
    "ts_creation_date": 1660793303,
    "ts_modification_date": 1660793303,
    "files": {
        "pdf": "https://archive.orkl.eu/4b5c83e0f60093b5d23d909c9879336dcbea91d9.pdf",
        "text": "https://archive.orkl.eu/4b5c83e0f60093b5d23d909c9879336dcbea91d9.txt",
        "img": "https://archive.orkl.eu/4b5c83e0f60093b5d23d909c9879336dcbea91d9.jpg"
    }
}