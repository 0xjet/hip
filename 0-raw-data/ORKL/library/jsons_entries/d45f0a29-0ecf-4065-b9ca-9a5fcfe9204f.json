{
    "id": "d45f0a29-0ecf-4065-b9ca-9a5fcfe9204f",
    "created_at": "2023-01-12T15:04:31.911558Z",
    "updated_at": "2025-03-27T02:09:30.411802Z",
    "deleted_at": null,
    "sha1_hash": "fb6cdc309039eb2ce9b4003d3d4b1e227c36db81",
    "title": "2022-01-21 - Creating a safe dummy C&C to test Android bots",
    "authors": "",
    "file_creation_date": "2022-08-18T04:01:00Z",
    "file_modification_date": "2022-08-18T04:01:00Z",
    "file_size": 99365,
    "plain_text": "# Creating a safe dummy C&C to test Android bots\n\n**[cryptax.medium.com/creating-a-safe-dummy-c-c-to-test-android-bots-ffa6e7a3dce5](https://cryptax.medium.com/creating-a-safe-dummy-c-c-to-test-android-bots-ffa6e7a3dce5)**\n\n@cryptax January 21, 2022\n\n[@cryptax](https://cryptax.medium.com/?source=post_page-----ffa6e7a3dce5--------------------------------)\n\nJan 21\n\n\n2 min read\n\nTo explain what a malware does, there’s no such good thing as showing in a video. But how\ncan you do that safely? This is how I did it for Android/BianLian.\n\nThanks to al1foobar for his help with iptables ;-)\n\n## The bot\n\nSimply use an Android emulator. The BianLian sample installs fine on Android 8.\n\n## The (fake) server\n\n[BianLian communicates to a C&C via HTTP. So, I created a quick Flask application to act as](https://cryptax.medium.com/android-bianlian-payload-61febabed00a)\nthe web server.\n\nAt first, you don’t know all routes you need to serve. That’s not an issue, we’ll find them: run\nthe fake server and notice all the HTTP 404 responses. They happen when the bot fails to\ncontact a URL it needs. In the console, you’ll see the missing URL, add those in your code.\n\nFrom my previous analysis of BianLian, I know the C&C sends back JSON data, and I know\nhow some commands should be formatted. A fake server is great to test those commands\nsafely, and see what they do + Flask dynamically reloads its code when it changes, so we\ncan actually send different commands if we want.\n\n[Download my fake server template.](https://github.com/cryptax/misc-code/blob/master/bianlian/fakebianserver.py)\n\n## Redirecting to our fake server\n\n\n-----\n\nNormally, the bot communicates to a C&C on `hxxp://rheacollier31532.website . This`\nname resolves (currently) to IP address `159.223.187.91 . So, what we’ll do is redirect all`\ntraffic from the emulator and going to `159.223.187.91 on port` `80 to the fake server`\n( 127.0.0.1 ) on the desired port (I used `9999 ).`\n\nOn Linux, use iptables: `sudo iptables -t nat -A OUTPUT -d 159.223.187.91 -p tcp`\n```\n-j DNAT — to-destination 127.0.0.1:9999 .\n\n```\nTest it on the emulator and open a browser, and request for example\n```\nhxxp://rheacollier31532.website, you should see the request in your fake Flask\n\n```\nserver.\n\n## Videos\n\nThe resulting videos below.\n\nEnjoy!\n\n— the Crypto Girl\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-21 - Creating a safe dummy C&C to test Android bots.pdf"
    ],
    "report_names": [
        "2022-01-21 - Creating a safe dummy C&C to test Android bots.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535871,
    "ts_updated_at": 1743041370,
    "ts_creation_date": 1660795260,
    "ts_modification_date": 1660795260,
    "files": {
        "pdf": "https://archive.orkl.eu/fb6cdc309039eb2ce9b4003d3d4b1e227c36db81.pdf",
        "text": "https://archive.orkl.eu/fb6cdc309039eb2ce9b4003d3d4b1e227c36db81.txt",
        "img": "https://archive.orkl.eu/fb6cdc309039eb2ce9b4003d3d4b1e227c36db81.jpg"
    }
}