{
    "id": "ba81260e-89ef-4b99-9286-416f1175543a",
    "created_at": "2023-01-12T15:00:34.79796Z",
    "updated_at": "2025-03-27T02:17:11.544661Z",
    "deleted_at": null,
    "sha1_hash": "97a691898a8239c60b923c03a45ce37f40ce5c9c",
    "title": "2019-07-10 - Flirting With IDA and APT28",
    "authors": "",
    "file_creation_date": "2022-05-28T22:00:04Z",
    "file_modification_date": "2022-05-28T22:00:04Z",
    "file_size": 141205,
    "plain_text": "# Flirting With IDA and APT28\n\n**[threatvector.cylance.com/en_us/home/flirting-with-ida-and-apt28.html](https://threatvector.cylance.com/en_us/home/flirting-with-ida-and-apt28.html)**\n\nThe BlackBerry Cylance Threat Research Team\n\n[RESEARCH & INTELLIGENCE / 07.10.19 /](https://threatvector.cylance.com/en/category/research-and-intelligence) The BlackBerry Cylance Threat Research\nTeam\nThis document shares a methodology used to develop Hex-Rays' Interactive Disassembler\n_(IDA) signatures created as part of pre-analysis for a recently published APT28 sample._\n_The internal functions, features and behavior of the published sample are not discussed._\n_Access to IDA Flair, used to generate signatures for the IDA disassembler, requires a_\n_current hex-rays subscription._\n\nOn May 17, the U.S. CyberCom Cyber National Mission Force (CNMF) tweeted\na VirusTotal link to a new APT28 malware sample. No information about the circumstances\nsurrounding the sample or its discovery was included.\n\nThe SHA256 hash of the published sample is:\n\n**b40909ac0b70b7bd82465dfc7761a6b4e0df55b894dd42290e3f72cb4280fa44**\n\nConsensus amongst researchers suggests the sample is x-tunnel (aka XAPS), a tool used\nby APT28 to make a compromised host inside the firewall act as a traffic proxy. This allows\nattacker-controlled traffic originating from external hosts to be relayed to other internal\ntargets that might otherwise be inaccessible owing to perimeter traffic policy.\n\nX-tunnel was first seen in the wild in May 2013, and is understood to have been used in\nprevious compromises including the 2016 DNC hack.\n\nAnalysis of other in-the-wild (ITW) builds of x-tunnel shows its capabilities include remote\ncommand execution, UDP tunnelling, TLS encryption, proxy support, and persistent HTTP\nvia the HTTP keep-alive header\n\n\n-----\n\nPrior versions have weighed in around 1-2MB in size. Versions with obfuscated code, found\nin 2015, tended towards the larger end of the scale. The sample uploaded by CNMF stands\nat 3.2MB.\n\nA file this size hints at code obfuscation/virtualisation, static linking and/or embedded\nresources. Static linking affords self-sufficiency - a high priority for a threat actor operating\ninside a victim network. Code obfuscation hampers analysis efforts but can make a sample\nmore suspicious in the eyes of antivirus (AV) software.\n\nEvidence within the sample indicates it was produced using Microsoft Visual C++. When\nformulating an execution plan for a target computer, the author has two options: assume the\ncorresponding (and necessary) Visual C++ Redistributable package is installed, or\nbundle (link) every piece of executable code needed within the file itself. This latter\napproach of static linking increases the size of the file but also increases the odds of\nsuccessful execution.\n\nA few hints that our x-tunnel binary was built with Microsoft Visual C++:\n\n1.   The presence of a .pdata section containing the exception data directory. It’s here that\nthe compiler stores exception handling metadata for PE32+/64-bit binaries. This section is\npresent even for the simplest C/C++ ”Hello World” applications, provided it links\nagainst Microsoft Visual C++ Runtime.\n\n2.   For C++ specifically, the presence of mangled function names and references\nto Standard Template Library namespaces/containers/classes (“std”, “vector”, “ios”) within\nthe strings output.\n\n3.   Output from parsing the PE Rich header.\n\nFor the alternative of dynamic linking a Visual C++ PE, you would typically see an import for\nmscvpXXX.dll, where XXX maps to the Visual Studio release number – 120 for Visual\nStudio 2013, 140 for Visual Studio 2015 etc.\n\nDisassembly of the sample using IDA shows a vast sea of executable code. What approach\ncan we use to tackle the analysis of such an unwieldy file, allowing us to quickly zero\nin on its design and capabilities?\n\nIDA’s Navigator toolbar offers a visual decomposition of a sample’s executable code and\ndata. If, during sample loading, the automatic use of Flirt Signatures is\ndisabled (see “Kernel Options 2”), measuring the number of functions can be achieved\nusing a simple Python one-liner:\n\n\n-----\n\nPython>len(list(idautils.Functions()))\n7533\n\n_Figure 1: Function count via IDAPython_\n\nSince we’re dealing with a 64-bit Microsoft Visual C++ binary, we can\napply the relevant default signatures provided with IDA (first re-select Use flirt signatures\nunder General -> Kernel Options 2): vc64rtf, vc64ucrt.\n\nThe Signatures sub-view tells us ~1600 functions have been identified as\nlibrary (benign) code:\n\n_Figure 2: First round of default signatures provided by IDA_\n\nThe majority of published x-tunnel samples link against the same version of the OpenSSL\nTLS/SSL library. Strings output for this sample shows it is also following suit: 1.0.1e 11 Feb\n2013.\n\nAnalysts following along at home will also have noticed another recurring identifier present\nin the strings output: “poco”. Google results show this to be a C++ framework. In the\nongoing effort to stay ahead of endpoint security, the author(s) have evidently re-tooled xtunnel using a framework.\n\nLeveraging custom IDA Flirt signatures to fill in as many of the blanks as possible\n(by identifying benign library code) reduces the time required to derive meaningful analysis\nof the sample. Focusing our efforts on understanding the important (interesting)\nparts means we can expedite delivery of actionable threat intelligence.\n\nStrings output tell us version 1.7.3 of the Poco framework was used. We can use this\ninformation to build a static library (.lib) and from that, derive custom IDA signatures.\n\n_Note: The Flair tools pcf (COFF parser) and sigmake (Signature File Maker) are available_\n_from the Hex Rays website as a zip download (active subscription required). Both Mac and_\n_Windows binaries are included; substitute paths in examples below reflect the location of_\n_your zip extract (and operating system, if using Windows)._\n\nThe first question we need to answer is which version of Visual Studio should we use to\nbuild our libs, and for the sake of curiosity, does it matter? (Spoiler: yes it does, at least\nfor the small number of default installs of Visual Studio that were tested).\n\nThe Rich header in the PE holds metadata about the compiler/linker used to\nproduce a binary. Parsing it using one of the widely available tools we are shown:\n\n\n-----\n\n_Figure 3: Rich header embedded within the sample_\n\nAssuming this isn’t a forgery, our first build attempt should be with Visual Studio 2010 RTM.\n\n_Note: Building the OpenSSL and Poco static libraries was performed using the author’s_\n_standard Windows 7 SP1 x86 analysis environment. Building under a native x64_\n_environment should only involve minor changes to the steps described below._\n\nThe Poco framework’s 1.7.3 source code is readily available for download from Github. The\nbuild instructions are easy to follow (see README, “Building on Windows”). The only minor\ncaveat is a dependency on OpenSSL, which needs to exist first. We will adjust the build\nprocess slightly to remove the MySQL dependency. This can be done by editing\nthe Poco components file.\n\nBuilding the OpenSSL .lib files is also straightforward. As stated by the documentation,\nsome prerequisites need to be installed such as ActiveState ActivePerl; make sure perl.exe\nis in your %PATH% (handled by the installer when using defaults).\n\nSince our sample is 64-bit, we use the Visual Studio x64 Cross Tools Command Prompt\n(see Windows Start menu under Visual Studio Tools).\n\nAs per the OpenSSL build documentation, running the following commands in\nthe extracted source code directory should produce the necessary libeay32.lib and\nssleay32.lib static libraries. This, in turn, will allow us to build Poco and finally produce our\nIDA signatures:\n\nperl Configure VC-WIN64A\nms\\do_win64\nanmake -f ms\\nt.mak\n\n_Figure 4: Building OpenSSL static libs_\n\nAssuming the build process completes without error, static libraries should be in the out32\nfolder:\n\n_Figure 5: OpenSSL x64 1.0.1e static libraries_\n\nWith these available, we can now build the Poco C++ framework libs. We need to modify\nthe Poco buildwin.cmd file to indicate the location of our freshly built OpenSSL libraries and\nprovide the whereabouts of OpenSSL header files. Here’s the edited buildwin.cmd:\n\n\n-----\n\nrem Change OPENSSL_DIR to match your setup\nset OPENSSL_DIR=E:\\Code\\openssl-1.0.1e.tar\\openssl-1.0.1e\nset OPENSSL_INCLUDE=%OPENSSL_DIR%\\inc32\nset OPENSSL_LIB=%OPENSSL_DIR%\\out32dll;%OPENSSL_DIR%\\lib\\VC\nset INCLUDE=%INCLUDE%;%OPENSSL_INCLUDE%\nset LIB=%LIB%;%OPENSSL_LIB%\n\n_Figure 6: Poco framework buildwin.cmd environment variables_\n\nNote the use of inc32 for the OPENSSL_INCLUDE variable. The 1.0.1e tarball contains\nsymlinks from include to inc32 that fail to extract properly on a Windows host, resulting in 0\nbyte .h files in the include folder.\n\nWe can now build the Poco framework static libs using the Visual Studio 2010 x64\ncommand prompt:\n\nbuildwin.cmd 100 build static_mt release x64 nosamples notests\n\n_Figure 7: Command to build Poco static libs_\n\nThe emitted libs can be found in the lib64 folder:\n\n_Figure 8: Poco framework static libraries_\n\nArmed with our Poco and OpenSSL library files, we can now generate the IDA signatures.\n\nThe syntax for pcf and sigmake is straightforward. First, derive a pattern file for each of our\n.libs using pcf, found inside the Flair .zip download, available from Hex-Rays.\n\nAn example execution of pcf for the OpenSSL libs on Mac OS (the .libs were copied locally\nfrom the build VM):\n\n./flair72/bin/mac/pcf libeay32.lib\nlibeay32.lib: skipped 98, total 5646\n\n_Figure 9: Generating the IDA pattern file on MAC_\n\nFor Windows, an equivalent command would be:\n\n.\\flair72\\bin\\win\\pcf.exe libeay32.lib\n\n_Figure 10: Generating the IDA pattern file on Windows_\n\n\n-----\n\nNow generate signature files and resolve any resulting collisions. Collisions occur when the\ngeneralized opcodes taken from object files within the .lib are the same for more than one\nsub routine. The Flair signature generator won’t arbitrate, it’s up to the user to hand-curate\n(or ignore) any collisions.\n\nDepending on how many collisions are identified and how much time is available, you can\nopt to leave all colliding subroutines un-named or manually resolve/assign names by\ninspecting the .exc file.\n\nIt’s helpful to add a name field to the signature file. This will be displayed in the FLAIR\nselection dialog, making your custom sigs easier to identify – particularly if you’re building\nlots of different versions with distinct compiler flags:\n\n./flair72/bin/mac/sigmake -n\"OpenSSL 1.0.1e x64 VS2010 LIBEAY32 Od\"\nlibeay32.pat openssl-101e-x64-vs2010-libeay32.sig\nopenssl-101e-x64-vs2010-libeay32-Od.sig: modules/leaves: 2971/5438,\nCOLLISIONS: 114\n\n_Figure 11: FLAIR signature creation command-line_\n\nFor this example, we opt to take the path of least resistance and ignore all collisions - delete\nthe four comment lines at the top of the generated .exc file. Re-execute sigmake to indicate\nthe contents of the .exc file should be incorporated. No output means success. Repeat for\nssleay32.lib.\n\nAs a final step, our signatures need to be copied into the IDA install. On Mac OS for\nPE/COFF files:\n\n/Applications/IDA XXX YYY/ida.app/Contents/MacOS/sig/pc\n\n_Figure 12: IDA signature files location on MAC_\n\nFor Windows installs, the default location would be:\n\nProgram Files\\IDA XXX\\sig\\pc\n\n_Figure 13: IDA signature files location on Windows_\n\nWith the signatures in place, let’s apply them to the sample (File -> Load File -> FLIRT\nSignature File). No IDA restart is required.\n\nThe Signatures sub-view tells us how well our signatures are faring:\n\n\n-----\n\n_Figure 14: Poco framework signatures applied_\n\nComplementing this with our OpenSSL signatures:\n\n_Figure 15: OpenSSL signatures applied_\n\nProgress, but many OpenSSL functions have been missed. Skimming through the\ndisassembly for code still flagged as Regular function, the string annotations (comments)\nfor OpenSSL code are readily apparent. Something in our signature generation has run\nwide of the mark.\n\nBy cross-referencing disassembly strings in IDA (e.g., “retcode=” present in\nsub_180097950), with the OpenSSL source code (hint: grep), we can identify a routine to\nserve as a starting point for improving our custom signatures.\n\nFor the sake of brevity, sub_180097950 in IDA is the OpenSSL function module_run, found\nin ./crypto/conf/conf_mod.c. The string constants to the ERR_add_error_data function map\n(uniquely) to the IDA-generated cross-reference comments.\n\nInspecting libeay32.pat gives us the current pattern is for the module_run function:\n\n_Figure 16: FLAIR pattern for module_run_\n\nWhich disassembles to:\n\n_Figure 17: OpenSSL’s module_run as compiled using “Ox” in Visual Studio 2010_\n\nCompare this with our sample’s module_run:\n\n_Figure 18: sub_180097950 opcodes_\n\nClearly, our .lib compiled with Visual Studio 2010 has generated a different set of opcodes.\n\nIf object files inside the .lib have differing opcodes, then our derived signatures won’t match\nthose in the sample and, as is the case for our “stock” build here, legitimate OpenSSL code\nis missed.\n\n[The disassembly for the module_run opcodes in our .pat file starts with a 2-byte hotpatch](https://docs.microsoft.com/en-us/cpp/build/reference/hotpatch-create-hotpatchable-image?view=vs-2019)\n[aligned[1] push rbx instruction (40 53; hotpatch is implicit on x64). This is followed by](https://docs.microsoft.com/en-us/cpp/build/reference/hotpatch-create-hotpatchable-image?view=vs-2019)\npreservation by the callee of non-volatile registers rbx, rsi, rdi, as determined by the x64\ncalling convention.\n\n\n-----\n\nOur APT-28 function prolog for the same function shows the use of spill or home space on\nthe stack for the r8, r9, rcx and rdx registers.\n\nAn explanation for the difference in compiler output comes courtesy of Raymond Chen in a\nblog post from 2011:[2]\n\n_\"When compiler optimizations are disabled, the Visual C++ x64 compiler will spill all register_\n_parameters into their corresponding slots. This has as a nice side effect that debugging is a_\n_little easier, but really it’s just because you disabled optimizations, so the compiler_\n_generates simple, straightforward code, making no attempts to be clever.”_\n\nWith this in mind, let’s try building a non-optimised version of OpenSSL and see if it yields\nany improvements to our IDA signature hit count.\n\nOpenSSL compilation is adjusted by modifying nt.mak and editing the CFLAGS statement.\nCompiler optimisations are disabled by changing the default Ox (most speed optimisations)\nto Od (disable optimisations):\n\n# Set your compiler options\nPLATFORM=VC-WIN64A\nCC=cl\nCFLAGS= /MT /Od -DOPENSSL_THREADS -DDSO_WIN32 -W3 –Gs0 -Gy -nologo\nAPP_CFLAG= /Zi /Fd$(TMP_D)/app\nLIB_FLAG= /Zl /Zi /Fd$(TMP_D)/lib\n\n_Figure 19: Optimisations disabled via Ox -> Od_\n\nFollowing recompilation, regeneration of signatures, and a re-apply in IDA, our custom\nsignature hit count looks healthier. The previously missed OpenSSL module_run function\nhas also been correctly identified:\n\n_Figure 20: Revised Poco and OpenSSL signatures_\n\nCompare the IDA Navigator toolbar showing initial decomposition (Figure 21) with custom\nPoco and non-optimised OpenSSL signatures applied (Figure 22):\n\n_Figure 21: Initial decomposition_\n\n_Figure 22: Decomposition after applying Poco and OpenSSL signatures_\n\nMuch of the remaining, unidentified code relates to C++ exception handling, thunk functions\n(single jmp instructions), or small sub routines that were marked as having collisions at the\ntime of signature generation. These are easy to identify with only a cursory review.\n\n\n-----\n\nA valid consideration when developing custom signatures is the ability to mirror the author s\ndevelopment environment. Visual Studio 2010 is quite old and only available for download\nfrom Microsoft if you are fortunate enough to have an MSDN subscription. Does the\naccuracy of our signatures change if Visual Studio 2019 Community Edition is used?\n\n_Version 1.7.3 of the Poco C++ framework, released in May 2016, only supports up to Visual_\n_Studio 2015, therefore, no attempt was made to rebuild signatures using Visual Studio_\n_2019:_\n\n_Figure 23: OpenSSL built with VS2019 Community; optimizations disabled_\n\nBuilding v1.0.1e of the OpenSSL framework, released Feb 2013, using Visual Studio 2019\nends in premature failure: unresolved symbols to iob_func,a consequence of stdio changes\nmade to the Microsoft CRT in Visual Studio 2015. Fortunately, the errors occur when\nbuilding OpenSSL test executables - the static libraries are already (successfully) built by\nthat point.\n\nRepeating the process using Visual Studio 2015 Community Edition:\n\n_Figure 24: OpenSSL & Poco Framework built with Visual Studio 2015 Community_\n\nFor Visual Studio 2015 and 2019, the OpenSSL and Poco static libraries were built\nfollowing a default install. The reason behind the reduction in signature hits was not\ninvestigated. One possibility is the addition of security/SDL checks incorporated by default\nin newer Visual Studio versions, altering the prolog opcodes and resultant Flair pattern.\n\nSignature hit counts reported by IDA for different Visual Studio builds (2010, 2015 and\n2019) tells us the most accurate signatures are obtained when mirroring the author’s build\nenvironment – at least for analysis of x64 PE files and when using default installs of Visual\nStudio.\n\nIn this instance, the PE Rich header appears to be telling the truth.\n\nWith our custom signatures applied, we’re ready to commence analysis of the sample.\nReducing the amount of unidentified code has greatly simplified the analysis effort. We can\nnow start in earnest to understand its inner workings, and how this version has evolved\nfrom previous ITW variants.\n\nNow the interesting work begins. счастливой охоты!\n\n_Lumina metadata for the Poco and OpenSSL libraries has been pushed to Hex Rays._\n_Anyone with IDA 7.2 or above can perform a Lumina pull from within IDA and get immediate_\n_identification of all benign library code found within this sample._\n\n\n-----\n\n**Citations:**\n\n[1] _https://docs.microsoft.com/en-us/cpp/build/reference/hotpatch-create-hotpatchable-_\n\n_image?view=vs-2019_\n\n\n\n[2] _[https://devblogs.microsoft.com/oldnewthing/20110302-00/?p=11333](https://devblogs.microsoft.com/oldnewthing/20110302-00/?p=11333)_\n\nThe BlackBerry Cylance Threat Research Team\n\n## About The BlackBerry Cylance Threat Research Team\n\nThe BlackBerry Cylance Threat Research team examines malware and suspected malware\nto better identify its abilities, function and attack vectors. Threat Research is on the frontline\nof information security and often deeply examines malicious software, which puts us in a\nunique position to discuss never-seen-before threats.\n\nBack\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-07-10 - Flirting With IDA and APT28.pdf"
    ],
    "report_names": [
        "2019-07-10 - Flirting With IDA and APT28.pdf"
    ],
    "threat_actors": [
        {
            "id": "f4f16213-7a22-4527-aecb-b964c64c2c46",
            "created_at": "2024-06-19T02:03:08.090932Z",
            "updated_at": "2025-03-27T02:05:17.387119Z",
            "deleted_at": null,
            "main_name": "GOLD NIAGARA",
            "aliases": [
                "Carbanak",
                "Carbon Spider ",
                "FIN7 ",
                "Navigator ",
                "Sangria Tempest ",
                "TelePort Crew ",
                "Calcium "
            ],
            "source_name": "Secureworks:GOLD NIAGARA",
            "tools": [
                " Carbanak",
                " Cobalt Strike",
                " DICELOADER",
                " DRIFTPIN",
                " GGLDR",
                " GRIFFON",
                " JSSLoader",
                " Meterpreter",
                " OFFTRACK",
                " PILLOWMINT",
                " POWERTRASH",
                " SUPERSOFT",
                " TAKEOUT",
                " TinyMet",
                "Bateleur"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535634,
    "ts_updated_at": 1743041831,
    "ts_creation_date": 1653775204,
    "ts_modification_date": 1653775204,
    "files": {
        "pdf": "https://archive.orkl.eu/97a691898a8239c60b923c03a45ce37f40ce5c9c.pdf",
        "text": "https://archive.orkl.eu/97a691898a8239c60b923c03a45ce37f40ce5c9c.txt",
        "img": "https://archive.orkl.eu/97a691898a8239c60b923c03a45ce37f40ce5c9c.jpg"
    }
}