{
    "id": "526cfc6d-634e-4e3f-8251-dbf28889fdd8",
    "created_at": "2023-01-12T15:00:22.604393Z",
    "updated_at": "2025-03-27T02:12:54.663749Z",
    "deleted_at": null,
    "sha1_hash": "d35060cf340ddd6c0d15f6c642e3b4793a06dd1c",
    "title": "2020-07-13 - Remcos RAT Macro Dropper Doc",
    "authors": "",
    "file_creation_date": "2022-05-25T14:20:50Z",
    "file_modification_date": "2022-05-25T14:20:50Z",
    "file_size": 277810,
    "plain_text": "# analyses/RemcosDocDropper.MD\n\n**[github.com/1d8/analyses/blob/master/RemcosDocDropper.MD](https://github.com/1d8/analyses/blob/master/RemcosDocDropper.MD)**\n\n## Remcos RAT Macro Dropper Doc\n\n Overview\n\n[Sample & more info](https://bazaar.abuse.ch/sample/202d979d74f0478de0fbea103e2585a84fdab5646ad19437f5e4c4ba0cda7b90/)\nPassword to the zip file is infected\nFirst seen: May 27, 2020\nurl no longer up\nFile type: docm\nSha256 hash:\n202d979d74f0478de0fbea103e2585a84fdab5646ad19437f5e4c4ba0cda7b90\nurl used was: hxxp://185.205.209.166/dkkp/qlyzbsuu.a12.exe &\nshortened via tinyurl\n[Macros used](https://pastebin.com/raw/T9YNjDpD)\n\n## Analysis\n\nOnce opened, the document looks like this:\n\n\n-----\n\nIn my opinion, not much work was put into crafting the actual document, but\nwho am I to judge?\n\nWhen you enable content, you'd get this error message:\n\nThis isn't a makeshift error message crafted by the attacker as a social\n[engineering tactic (as I did here ;) ) but rather an actual error message since the](https://github.com/1d8/pysock)\nfile they attempt to download & execute (named Filename.exe) doesn't\nactually download.\n\nAfter enabling content & letting the macros run, we open Procmon's process\ntree & we can see that powershell is used to attempt to drop the main malware\n(ignore all the notepad.exe noise, that was all generated by me):\n\n\n-----\n\nThe full powershell command used by the macro is here:\n\nAs we can see, it executes it in a hidden window & uses the bypass flag in order\nto bypass any protections a user has set up in order to prevent execution of\nunauthorized scripts (I may be incorrect, but I believe this method only works if\nthe user is running with admin level privileges).\n\nThe powershell also drops the file to disk & saves it in the Temp directory as\n**Filename.exe as we seen earlier & then executes it.**\n\nThe url used is hxxps://tinyurl.com/ybz4nnyg. Tinyurl is a url shortener which\nwill redirect to the main website. Attempting to navigate to this tinyurl yields\nno response, which likely means whatever site this malware was hosted as has\nsince been taken down.\n\nThe final payload that would've been grabbed if the url was still up would be the\nRemcos RAT\n\nMy claim of the URL no longer being up is backed by the powershell logs:\n\n\n-----\n\nIf you wish to receive the powershell code without actually running it the way\nthe attackers intended, simply edit the code and delete the Shell() command &\nadd in a variable, then print that variable in a message box:\n\nBefore:\n\nAfter:\n\nResult after running:\n\n_NOTE: The reason Shell is called on a variable + a function is because the_\n_command passed to Shell is base64 encoded twice & needs to be decoded twice_\n_before being ran. So the variable asdas contains the command after it's_\n\n\n-----\n\n_decoded once and then when Shell is called as Shell(sadsad(asdas, True)) is_\n_when the command is decoded the second time. Basically the function_\n**_sadsad() is responsible for doing the base64 decoding. I hope this makes_**\n_sense. Thanks for reading!_\n\nDetails\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-07-13 - Remcos RAT Macro Dropper Doc.pdf"
    ],
    "report_names": [
        "2020-07-13 - Remcos RAT Macro Dropper Doc.pdf"
    ],
    "threat_actors": [
        {
            "id": "9e767b38-12ae-4ef7-9878-5ce1701066d7",
            "created_at": "2024-05-01T02:03:08.131819Z",
            "updated_at": "2025-03-27T02:05:17.413497Z",
            "deleted_at": null,
            "main_name": "NICKEL ACADEMY",
            "aliases": [
                "COVELLITE ",
                "CTG-2460 ",
                "Diamond Sleet ",
                "Guardians of Peace",
                "HIDDEN COBRA ",
                "High Anonymous",
                "Labyrinth Chollima ",
                "NNPT Group",
                "New Romanic Cyber Army Team",
                "Temp.Hermit ",
                "The Lazarus Group ",
                "UNC577 ",
                "Who Am I?",
                "Whois Team",
                "ZINC ",
                "Black Artemis "
            ],
            "source_name": "Secureworks:NICKEL ACADEMY",
            "tools": [
                " DarkMessenger",
                " Destover",
                " Duuzer",
                " HOPLIGHT",
                " Joanap",
                " KorHigh",
                " LiveJinx",
                " Volgmer",
                "Brambul"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535622,
    "ts_updated_at": 1743041574,
    "ts_creation_date": 1653488450,
    "ts_modification_date": 1653488450,
    "files": {
        "pdf": "https://archive.orkl.eu/d35060cf340ddd6c0d15f6c642e3b4793a06dd1c.pdf",
        "text": "https://archive.orkl.eu/d35060cf340ddd6c0d15f6c642e3b4793a06dd1c.txt",
        "img": "https://archive.orkl.eu/d35060cf340ddd6c0d15f6c642e3b4793a06dd1c.jpg"
    }
}