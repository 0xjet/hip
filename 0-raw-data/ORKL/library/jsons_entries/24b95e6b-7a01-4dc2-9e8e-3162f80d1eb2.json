{
    "id": "24b95e6b-7a01-4dc2-9e8e-3162f80d1eb2",
    "created_at": "2023-01-12T15:04:21.926788Z",
    "updated_at": "2025-03-27T02:13:46.705346Z",
    "deleted_at": null,
    "sha1_hash": "8a284149836327004d3e467ba1283f81c0fbd7a0",
    "title": "2022-05-03 - The Strange Link Between A Destructive Malware And A Ransomware-Gang Linked Custom Loader- IsaacWiper Vs Vatet",
    "authors": "",
    "file_creation_date": "2022-05-27T22:53:01Z",
    "file_modification_date": "2022-05-27T22:53:01Z",
    "file_size": 2025351,
    "plain_text": "# The strange link between a destructive malware and a ransomware-gang linked custom loader: IsaacWiper vs Vatet\n\n**cluster25.io/2022/05/03/a-strange-link-between-a-destructive-malware-and-the-loader-of-a-ransomware-group-**\nisaacwiper-vs-vatet/\n\nMay 3, 2022\n\n**NOTICE**\n\n\n-----\n\n```\nAfter additional reviews, the team at Cluster25 has determined that the code\ncommonality identified in the two analyzed samples contained in this blog post was\ncoincidental. The code they had in common is aligned with Microsoft standard\nlibraries, and therefore common for use. In this blog post, Cluster25 outlines a code\nmatch between two samples from different threat actors for clarification.\n\n```\n**BLOGPOST**\n\nCluster25 researchers, during a comparative analysis performed at the beginning of March\n2022, found evidence that suggests a possible relationships between a piece of malware\nbelonging to the Sprite Spider arsenal (or some elements that are or were part of it) and\nanother malware that has recently taken part in destructive attacks against organizations and\ninstitutions in Ukraine.\nC25 analyzes the evolution of the events that led to this analysis and the related conclusions.\n\n**INTRODUCTION**\n\nOn March 1st, 2022, ESET researchers reported variants of a destructive malware deployed\nagainst Ukraine. (ESET Research: Ukraine hit by destructive attacks before and during the\nRussian invasion with HermeticWiper and IsaacWiper). On the same day C25 submitted\ncopies of the reported samples to our internal attribution engine to acquire key points for the\nattribution.\n\nOur attribution engine is designed to find similarities between malware samples by\ncomparing the input with a vast pool of already attributed and categorized malware.\n\nWe submitted the file corresponding to the following hash:\n\n**TYPE** **VALUE**\n\nSHA256 7bcd4ec18fc4a56db30e0aaebd44e2988f98f7b5d8c14f6689f650b4f11e16c0\n\nleading to the following results:\n\nCluster25 internal threat attribution engine\n**TA1222 is the internal Cluster25 nomenclature about an unidentified group and**\n**GoldDupont is a financially motivated threat actor, that has compromised several important**\ntargets, including Regione Lazio. It is also called RansomExx, Defray777 or Defray.\n\nAfter this we manually analyzed the two samples.\n\n\n-----\n\n**INSIGHTS**\n\nWe spotted some overlaps in the source code of these two pieces of malware:\n\n**TYPE** **VALUE**\n\nSHA256 7bcd4ec18fc4a56db30e0aaebd44e2988f98f7b5d8c14f6689f650b4f11e16c0\n\nSHA256 01a2404fcf56027be610c65bbfb0f2dda9cfaf67385cb7f93f0b586e3aa6803a\n\nIn particular, code chunks at sub_10005810 for IsaacWiper and sub_100DDAE0 for Vatet\nhave the following degree of similarity, as shown below graphically:\n\nThe similarity analysis returned a 24% of rate with near 10.000 basic block that matched on\nnon-library code\n\n\n-----\n\nAs an example, the subroutines responsible for resolving Windows API’s at runtime through\n**LoadLibraryExW and GetProcAddress are the same on both the samples.**\n\nThe other identical subroutines are responsible for error handling, heap memory\n**allocation, dynamic API resolution and concurrency management (through**\n**EnterCriticalSection and LeaveCriticalSection Windows API’s).**\n\n\n-----\n\n**SPRITE SPIDER**\n\nSprite Spider is an active criminal crew since at least 2017 and is usually characterized by its\neffectiveness and speed in compromising the targeted environment. It uses offensive tools\nsuch as Vatet (or VatetLoader), PyXie and CobaltStrike. The crew is often able to evade\neven the most advanced endpoint and network security solutions by hiding fragments of their\nmalicious code in open-source projects and adopting an approach to the operation that\nsees, as principle, the writing of very few files on disk heavily complicating the detection\nactivities. In fact, the only payload written to disk is Vatet.\n\n**Sprite Spider usually runs as a secondary (sometimes tertiary) payload directly in memory**\nwithout ever touching the disk. The actor usually prepares a unique and specific ransomware\npayload for each of the victims, making the implant more elusive and difficult to track.\n\nDuring its execution, it has the ability to terminate some undesirable threads and processes\nsuch as powershell.exe, rundll32.exe, vmnat.exe, wefault.exe and explorer.exe. It is able\nto encrypt files using AES-256 without interrupting the main functions of the system and\nexecutes specific commands to interact with the files that have already been impacted by it.\nOften this means that files are already encrypted when security tools, such as EDRs, are\nable to report potential malicious activities.\n\n**VATET LOADER**\n\n**Vatet is a loader that executes custom shellcodes, protected by different encoding layers**\nfrom the local disk or network shares. This loader is typically known to use opensource\napplications, found on GitHub or other repositories, that the threat actor modifies to load the\nfinal payload (e.g., CobaltStrike).\n\nBased on this, we proceeded with our investigation on open-source applications that may\nshare these portions of code. We have attributed these routines to a well-known project\nknown Rainmeter (https://github.com/rainmeter/rainmeter/), already used in the past by\n**Vatet to drop CobaltStrike payloads.**\n\n**Rainmeter is a desktop customization tool that allows users to customize their desktop using**\nskins. During a legit installation, Rainmeter creates an executable (rainmeter.exe) and a\nDLL (rainmeter.dll) responsible for reading configuration files and facilitating the desktop\ncustomization.\n\nIn the past, Vatet used a compromised and modified version of rainmeter.dll to lure the\nvictim and install a CobaltStrike malicious payload. However, during a comparative analysis,\nwe noticed a different behavior on the IsaacWiper and Vatet samples. In particular, to lower\nthe detection rates, this time the malware developers have integrated in the sample’s\ndifferent utilities subroutines of the rainmeter.dll, instead of entirely using the legit DLL.\n\n\n-----\n\nIn fact, analyzing the legit rainmenter.dll we noticed a lot of similarities in identical\nsubroutines regarding the dynamic API, resolving and the concurrency management. In\nsupport of our hypothesis, we performed another comparative analysis from the IsaacWiper\nsample and the Rainmeter DLL. Again, we can notice a 24% similarity with 10.000 basic\nblock matches on non-library subroutines like reported following:\n\n**CONCLUSIONS**\n\nAccording to collected evidences, the threat actor behind the destructive attacks against\n**Ukraine used open-source code to build IsaacWiper variants. In particular, they extracted**\nand re-used some utility functions of the library rainmeter.dll. Although it is not possible to\ndirectly associate the two pieces of malware with the same actor (as rainmeter is an opensource project and therefore it’s freely accessible), it is a curious coincidence that it has\nalready been used in the past, as reported by Palo Alto UNIT42 researchers\n[(https://unit42.paloaltonetworks.com/vatet-pyxie-defray777/), during Sprite Spider](https://unit42.paloaltonetworks.com/vatet-pyxie-defray777/)\nintrusions.\n\nHowever this could at least suggest that the threat actor behind IsaacWiper knew it well\nenough to extract specific parts and reuse its code for very specific tasks.\n\nWritten by: [Cluster25](https://cluster25.io/author/cluster25/)\n\nTagged as: [IsaacWiper,](https://cluster25.io/tag/isaacwiper/) [Vatet,](https://cluster25.io/tag/vatet/) [RansomExx.](https://cluster25.io/tag/ransomexx/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-05-03 - The Strange Link Between A Destructive Malware And A Ransomware-Gang Linked Custom Loader- IsaacWiper Vs Vatet.pdf"
    ],
    "report_names": [
        "2022-05-03 - The Strange Link Between A Destructive Malware And A Ransomware-Gang Linked Custom Loader- IsaacWiper Vs Vatet.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7268a08d-d4d0-4ebc-bffe-3d35b3ead368",
            "created_at": "2022-10-25T16:07:24.225216Z",
            "updated_at": "2025-03-27T02:02:10.144446Z",
            "deleted_at": null,
            "main_name": "Sprite Spider",
            "aliases": [
                "Gold Dupont",
                "Sprite Spider"
            ],
            "source_name": "ETDA:Sprite Spider",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "Coroxy",
                "Defray 2018",
                "Defray777",
                "DroxiDat",
                "Glushkov",
                "LaZagne",
                "Metasploit",
                "PyXie",
                "PyXie RAT",
                "Ransom X",
                "RansomExx",
                "SharpHound",
                "Shifu",
                "SystemBC",
                "Target777",
                "Vatet",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "27e51b73-410e-4a33-93a1-49cf8a743cf7",
            "created_at": "2023-01-06T13:46:39.210675Z",
            "updated_at": "2025-03-27T02:00:03.022315Z",
            "deleted_at": null,
            "main_name": "GOLD DUPONT",
            "aliases": [
                "SPRITE SPIDER"
            ],
            "source_name": "MISPGALAXY:GOLD DUPONT",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "07775b09-acd9-498e-895f-f10063115629",
            "created_at": "2024-06-04T02:03:07.817613Z",
            "updated_at": "2025-03-27T02:05:17.351811Z",
            "deleted_at": null,
            "main_name": "GOLD DUPONT",
            "aliases": [
                "Sprite Spider "
            ],
            "source_name": "Secureworks:GOLD DUPONT",
            "tools": [
                " ArtifactExx",
                " Cobalt Strike",
                " Defray",
                " Metasploit",
                " PyXie",
                " Shifu",
                " SystemBC",
                " Vatet",
                "777"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535861,
    "ts_updated_at": 1743041626,
    "ts_creation_date": 1653691981,
    "ts_modification_date": 1653691981,
    "files": {
        "pdf": "https://archive.orkl.eu/8a284149836327004d3e467ba1283f81c0fbd7a0.pdf",
        "text": "https://archive.orkl.eu/8a284149836327004d3e467ba1283f81c0fbd7a0.txt",
        "img": "https://archive.orkl.eu/8a284149836327004d3e467ba1283f81c0fbd7a0.jpg"
    }
}