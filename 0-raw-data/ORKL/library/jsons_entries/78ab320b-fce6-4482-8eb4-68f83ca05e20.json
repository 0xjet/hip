{
    "id": "78ab320b-fce6-4482-8eb4-68f83ca05e20",
    "created_at": "2023-01-12T15:01:21.012019Z",
    "updated_at": "2025-03-27T02:16:25.688637Z",
    "deleted_at": null,
    "sha1_hash": "be78fdab08d895f5a9870d06167476b92f68deb0",
    "title": "2017-07-12 - The Magala Trojan Clicker- A Hidden Advertising Threat",
    "authors": "",
    "file_creation_date": "2022-05-29T10:35:03Z",
    "file_modification_date": "2022-05-29T10:35:03Z",
    "file_size": 426752,
    "plain_text": "# The Magala Trojan Clicker: A Hidden Advertising Threat\n\n**[securelist.com/the-magala-trojan-clicker-a-hidden-advertising-threat/78920/](https://securelist.com/the-magala-trojan-clicker-a-hidden-advertising-threat/78920/)**\n\nAuthors\n\n[Sergey Yunakovsky](https://securelist.com/author/sergeyyunakovsky/)\n\nOne large group will slowly conquer another large group, reduce its numbers, and thus\nlessen its chance of further variation and improvement. <…> Small and broken groups\nand sub-groups will finally tend to disappear.\n\nCharles Darwin. ‘On the Origin of Species’\n\nThe golden age of Trojans and viruses has long gone. Malicious programs created by\nenthusiasts for research purposes and for fun are now largely confined to history books and\ndusty computer incident reports. They have been replaced by programs that put a heavy\nemphasis on making money.\n\nIf we ignore targeted attacks prepared by professionals for very specific purposes, what sort\nof malware do we most often hear about today? Encryption malware and DDoS botnets\nmade up of IoT devices. Both types are profitable for cybercriminals and relatively easy to\nimplement. However, they are not the only types of malware capable of generating cash; we\nmustn’t overlook a third particularly numerous borderline malware family that includes\n\n\n-----\n\nadvertising bots and modules, and partnership programs – all of which is typically referred to\nas potentially unwanted adware/potentially unwanted programs (PUA/PUP). They are\nborderline because there is a fine line between classifying a program as adware and defining\nthe same program as an outright Trojan. In this paper, we will deal with one such renegade\nthat has gone well beyond the limits of ‘fair play’ when it comes to advertising.\n\nThe malware in question is detected by Kaspersky Lab products as TrojanClicker.Win32.Magala.\n\n## Operating algorithm\n\nMagala falls into the category of Trojan Clickers that imitate a user click on a particular\nwebpage, thus boosting advertisement click counts. It’s worth pointing out that Magala\ndoesn’t actually affect the user, other than consuming some of the infected computer’s\nresources. The main victims are those paying for the advertising; typically they are small\nbusiness owners doing business with unscrupulous advertisers.\n\nThe first stage of infection involves the Trojan checking which version of Internet Explorer is\ninstalled and locating it in the system. If it’s version 8 or earlier, the Trojan won’t run. So, if\nyou still have this version on your computer, there’s nothing to worry about.\n\nChecking the version of Internet Explorer, virtual desktop initialization.\n\nIf the desired version of Internet Explorer is found, then, unbeknown to the user, a virtual\ndesktop is initialized. All further activities are performed here. After that a sequence of utility\noperations is run (something that is typical for this malware family): autorun is set up, a\nreport is sent to a hardcoded URL, and the required adware is installed. To interact with the\n[content of an open page, Magala uses IHTMLDocument2, the standard Window interface](https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa752574(v=vs.85))\n\n\n-----\n\nthat makes it easy to use DOM tree. The Trojan uses it to load MapsGalaxy Toolbar, installs\nit on the system and adds the site hxxp://hp.myway.com to the system registry, also\nassociated with MapsGalaxy, so that it becomes the browser’s home page.\n\nA simple check is incorporated into the Trojan to find out if the search bar has already been\ninstalled – this is done with the help of the appropriate registry branch.\n\nMagala then contacts the remote server and requests a list of search queries for the click\ncounts that need to be boosted.\n\n\n-----\n\nReceiving the list of search queries\n\nThis list is sent ‘as is’, in a plain text file with lots of strings.\n\n\n-----\n\nList of search queries\n\nUsing this list, the program begins to send the requested search queries and click on each of\nthe first 10 links in the search results, with an interval of 10 seconds between each click.\n\n\n-----\n\n## Profit margin\n\nAs far as we know, an average cost per click (CPC) in a campaign like this is 0.07 USD. The\ncost per thousand (CPM) comes to 2.2 USD. It should be noted that Trojan Clickers are\ncertainly not the most popular way of selling advertising: the method most in demand is the\ndisplaying of a set homepage, where each installation also costs 0.07 USD.\n\n\n-----\n\nA botnet consisting of 1000 infected computers clicking 10 website addresses from each\nsearch result and performing some 500 search requests with no overlaps in the search\nresults could ideally mean the virus writer earns up to 350 USD from each infected computer.\nHowever, these cost estimates are only approximations, and don’t typically occur in the real\nworld. The costs of different requests may vary greatly, and the price of 0.07 USD per click is\nalso an average value.\n\n## Propagation statistics\n\nAs can be seen in the diagram below, Trojan-Clicker.Win32.Magala infections occur most\noften in Germany and the US. This finding is corroborated by an analysis of the search\nrequests for which the click numbers need to be boosted. These statistics were collected\nfrom March to early June 2017.\n\n## Conclusion\n\nPrograms belonging to the potentially unwanted adware class do not typically pose as much\nof a threat to the end user as, say, encryption or banking malware does. However, there are\ntwo characteristic features to this malware class which make it difficult to deal with. Firstly,\nthere is the borderline functionality that blurs the lines between legitimate and malicious\nsoftware. It has to be clarified whether a specific program is part of a secure and legal\nadvertising campaign or if it is illegitimate software performing similar functions. A second\nimportant aspect of this class – its sheer quantity – also means a fundamentally different\napproach to any analysis is required.\n\n\n-----\n\n## MD5\n\n1EB2D932BB916D4DB7F483859EEBABF8\n206DD0B0E8FAA2D81AB617491F80AD0B\n25BC675D23C2ACD5F288856F6B91818D\n44A408386B983583CAEB0590433BE07B\n4E4FA0B8C73889E9AA028C8FD7D7B3A5\n6D3D80E89ABDED981AE329203F1779EB\n6FA035264744E9C9A30409012BAB18DE\n732B82A7424B60FEBB1E874B205E2D76\n771E742D6C110F8BD68A7304EF93B131\nA6B288A3B8C48A23092246FBBF6DB7C2\nCF5A5C45778C793477ECAB02F1B3B2C3\nDC16BA21BFE4838FD2A897FF13050FF4\nF364B043BD6E2CC9C43F86E2004D71D3\nF36672933F3CBACF8D8B396DFE259526\n\nThe Magala Trojan Clicker: A Hidden Advertising Threat\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-07-12 - The Magala Trojan Clicker- A Hidden Advertising Threat.pdf"
    ],
    "report_names": [
        "2017-07-12 - The Magala Trojan Clicker- A Hidden Advertising Threat.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535681,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1653820503,
    "ts_modification_date": 1653820503,
    "files": {
        "pdf": "https://archive.orkl.eu/be78fdab08d895f5a9870d06167476b92f68deb0.pdf",
        "text": "https://archive.orkl.eu/be78fdab08d895f5a9870d06167476b92f68deb0.txt",
        "img": "https://archive.orkl.eu/be78fdab08d895f5a9870d06167476b92f68deb0.jpg"
    }
}