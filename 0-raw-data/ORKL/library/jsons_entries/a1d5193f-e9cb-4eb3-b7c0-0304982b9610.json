{
    "id": "a1d5193f-e9cb-4eb3-b7c0-0304982b9610",
    "created_at": "2023-01-12T15:06:57.335893Z",
    "updated_at": "2025-03-27T02:16:26.192145Z",
    "deleted_at": null,
    "sha1_hash": "863f7251cf710727b0d424db24823a67a7a833e9",
    "title": "2018-04-20 - XLoader Android Spyware and Banking Trojan Distributed via DNS Spoofing",
    "authors": "",
    "file_creation_date": "2022-05-28T16:00:47Z",
    "file_modification_date": "2022-05-28T16:00:47Z",
    "file_size": 1174769,
    "plain_text": "# XLoader Android Spyware and Banking Trojan Distributed via DNS Spoofing\n\n**[trendmicro.com/en_us/research/18/d/xloader-android-spyware-and-banking-trojan-distributed-via-dns-spoofing.html](https://www.trendmicro.com/en_us/research/18/d/xloader-android-spyware-and-banking-trojan-distributed-via-dns-spoofing.html)**\n\nApril 20, 2018\n\nWe have been detecting a new wave of network attacks since early March, which, for now,\nare targeting Japan, Korea, China, Taiwan, and Hong Kong. The attacks use Domain Name\n[System (DNS) cache poisoning/DNS spoofing, possibly through infringement techniques](http://blog.trendmicro.co.jp/archives/17181)\nsuch as brute-force or dictionary attacks, to distribute and install malicious Android apps.\nTrend Micro detects these as ANDROIDOS_XLOADER.HRX.\n\n[These malware pose as legitimate Facebook or Chrome applications. They are distributed](http://blog.trendmicro.co.jp/archives/17170)\nfrom polluted DNS domains that send a notification to an unknowing victim’s device. The\nmalicious apps can steal personally identifiable and financial data and install additional apps.\nXLoader can also hijack the infected device (i.e., send SMSs) and sports selfprotection/persistence mechanisms through device administrator privileges.\n\n\n-----\n\n-----\n\nFigure 1. Screenshot of the fake Facebook and Chrome apps (highlighted)\n\nFigure 2. XLoader’s infection chain\n\n**Infection Chain**\n\nAs with our [earlier](http://blog.trendmicro.co.jp/archives/17170) [reports in late March, the attack chain involves diverting internet traffic to](http://blog.trendmicro.co.jp/archives/17181)\nattacker-specified domains by compromising and overwriting the router’s DNS settings. A\nfake alert will notify and urge the user to access the malicious domain and download\nXLoader.\n\n\n-----\n\nFigure 3. Screenshot of the fake notification on a spoofed/poisoned domain\n\n**Technical Analysis**\n\nXLoader first loads the encrypted payload from Assets/db as test.dex to drop the necessary\nmodules then requests for device administrator privileges. Once granted permission, it hides\nits icon from the launcher application list then starts a service that it keeps running in the\n[background. The background service uses the reflection technique (a feature that allows the](https://blog.trendmicro.com/trendlabs-security-intelligence/mobile-ransomware-protect/)\ninspection and modification of Java-based programs’ internal properties) to invoke the\nmethod com.Loader.start in the payload.\n\n\n-----\n\nFigure 4. Code snippet showing the main malicious module invoked via the reflection\ntechnique\n\n**Monitoring Broadcast Events**\n\nXLoader registers many broadcast receivers in the payload dynamically (to monitor\n[broadcast events sent between system and applications). Registering broadcast receivers](https://developer.android.com/guide/components/broadcasts.html)\nenable XLoader to trigger its malicious routines. Here is a list of broadcast actions:\n\nandroid.provider.Telephony.SMS_RECEIVED\nandroid.net.conn.CONNECTIVITY_CHANGE\nandroid.intent.action.BATTERY_CHANGED\nandroid.intent.action.USER_PRESENT\nandroid.intent.action.PHONE_STATE\nandroid.net.wifi.SCAN_RESULTS\nandroid.intent.action.PACKAGE_ADDED\nandroid.intent.action.PACKAGE_REMOVED\nandroid.intent.action.SCREEN_OFF\nandroid.intent.action.SCREEN_ON\nandroid.media.RINGER_MODE_CHANGED\nandroid.sms.msg.action.SMS_SEND\nandroid.sms.msg.action.SMS_DELIVERED\n\n**Creating a Web Server to Phish**\n\n\n-----\n\nXLoader creates a provisional web server to receive the broadcast events. It can also create\n[a simple HTTP server on the infected device to deceive victims. It shows a web phishing](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/best-practices-identifying-and-mitigating-phishing-attacks)\npage whenever the affected device receives a broadcast event (i.e., if a new package is\ninstalled or if the device’s screen is on) to steal personal data, such as those keyed in for\nbanking apps. The phishing page is translated in Korean, Japanese, Chinese, and English,\nwhich are hardcoded in the payload. It will appear differently to users depending on the\nlanguage set on the device.\n\nFigure 5. Screenshot of the phishing page (in Japanese)\n\n**XLoader as Spyware and Banking Trojan**\n\nXLoader can also collect information related to usage of apps installed in the device. Its datastealing capabilities include collecting SMSs after receiving an SMS-related broadcast event\nand covertly recording phone calls. XLoader can also hijack accounts linked to financial or\ngame-related apps installed on the affected device.\n\n\n-----\n\nFigure 6. Code Snippet showing how XLoader records phone calls\n\nXLoader can also start other attacker-specified packages. A possible attack scenario\ninvolves replacing legitimate apps with repackaged or malicious versions. By monitoring the\npackage installation broadcast event, XLoader can start their packages. This enables it to\nlaunch malicious apps without the user’s awareness and explicit consent.\n\nWe reverse engineered XLoader and found that it appears to target South Korea-based\n[banks and game development companies. XLoader also prevents victims from accessing the](https://blog.trendmicro.com/trendlabs-security-intelligence/selling-online-gaming-currency-makes-way-attacks-enterprises/)\ndevice’s settings or using a known antivirus (AV) app in the country.\n\nXLoader can also load multiple malicious modules to receive and execute commands from\nits remote command-and-control (C&C) server, as shown below:\n\n\n-----\n\nFigure 7. Screenshot showing XLoader’s malicious modules\n\nHere’s a list of the modules and their functions:\n\n_sendSms — send SMS/MMS to a specified address_\n_setWifi — enable or disable Wi-Fi connection_\n_gcont — collect all the device’s contacts_\n_lock — currently just an input lock status in the settings (pref) file, but may be used as a_\nscreenlocking ransomware\n_bc — collect all contacts from the Android device and SIM card_\n_setForward — currently not implemented, but can be used to hijack the infected device_\n_getForward — currently not implemented, but can be used to hijack the infected device_\n_hasPkg — check the device whether a specified app is installed or not_\n_setRingerMode — set the device’s ringer mode_\n_setRecEnable — set the device’s ringer mode as silent_\n_reqState — get a detailed phone connection status, which includes activated network_\nand Wi-Fi (with or without password)\n_showHome — force the device’s back to the home screen_\n_getnpki: get files/content from the folder named NPKI (contains certificates related to_\nfinancial transactions)\n_[http — access a specified network using HttpURLConnection](https://developer.android.com/reference/java/net/HttpURLConnection.html)_\n_onRecordAction — simulate a number-dialed tone_\n_call — call a specified number_\n_get apps — get all the apps installed on the device_\n\n\n-----\n\n_show_fs_float_window — show a full-screen window for phishing_\n\n[Of note is XLoader’s abuse of the WebSocket protocol (supported in many browsers and](https://tools.ietf.org/html/rfc6455)\nweb applications) via ws(WebSockets) or wss(WebSockets over SSL/TLS) to communicate\nwith its C&C servers. The URLs — abused as part of XLoader’s C&C — are hidden in three\nwebpages, and the C&C server that XLoader connects to differ per region.\n\nThe abuse of the WebSocket protocol provides XLoader with a persistent connection\nbetween clients and servers where data can be transported any time. XLoader abuses the\nMessagePack (a data interchange format) to package the stolen data and exfiltrate it via the\nWebSocket protocol for faster and more efficient transmission.\n\nFigure 8. Screenshot showing one of the web pages with hidden C&C-related URL\n\nFigure 9. Code snippet showing how XLoader parses the C&C URL\n\n\n-----\n\n**Mitigations**\n\nXLoader will not download malicious apps if the Android device uses a mobile data\n[connection. Nevertheless, users should practice proper security hygiene to mitigate threats](https://www.trendmicro.com/vinfo/us/security/news/internet-of-things/securing-routers-against-mirai-home-network-attacks)\nthat may take advantage of a home or business router’s security gaps. Employ stronger\ncredentials, for instance, to make them less susceptible to unauthorized access. Regularly\nupdate and patch the router’s software and firmware to prevent exploits, and enable its builtin firewall.\n\nFor system administrators and information security professionals, configuring the router to be\n[more resistant to attacks like DNS cache poisoning can help mitigate similar threats.](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/infosec-guide-defending-against-man-in-the-middle-attacks)\n[Everyday users can do the same by checking the router’s DNS settings if they’ve been](http://sitesafety.trendmicro.com/)\nmodified. Even threats like DNS cache poisoning employ social engineering, so users should\n[also be more prudent against suspicious or unknown messages that have telltale signs of](https://www.trendmicro.com/vinfo/us/security/news/mobile-safety/best-practices-securing-your-mobile-device)\nmalware.\n\n[We have worked with Google and they ensure that Google Play Protect proactively catches](https://www.android.com/play-protect/)\napps of this nature. No instances of these apps were found in Google Play.\n\n**Trend Micro Solutions**\n\n[Trend Micro™ Mobile Security blocks malicious apps that may exploit this vulnerability. End](https://www.trendmicro.com/en_us/forHome/products/mobile-security.html)\nusers and enterprises can also benefit from its multilayered security capabilities that secure\nthe device’s data and privacy, and safeguard them from ransomware, fraudulent websites,\nand identity theft.\n\n[For organizations, Trend Micro™ Mobile Security for Enterprise provides device, compliance](https://www.trendmicro.com/en_us/business/products/user-protection/sps/mobile.html)\nand application management, data protection, and configuration provisioning. It also protects\ndevices from attacks that leverage vulnerabilities, prevents unauthorized access to apps, and\ndetects and blocks malware and access to fraudulent websites.\n\nTrend Micro’s [Mobile App Reputation Service (MARS) covers Android threats using leading](https://mars.trendmicro.com/)\nsandbox and machine learning technologies. It can protect users against malware, zero-day\nand known exploits, privacy leaks, and application vulnerability.\n\n**Indicators of Compromise**\n\n_Hashes detected as ANDROIDOS_XLOADER.HRX (SHA-256):_\n\n**Hash** **Package** **Label**\n\n\n0F49416B6BCB6E755D 999255FABB4C77C5EA\n7DEDEB7E6CDB0925C 4F23C1FB00E\n\n958135E163E0518F24F BD1AF6EF18C30E30C1\nA4DFB383FF47D111930 55D4CDCE\n\n\nfddf.tre.hjgdsgkh Chrome\n\nfghdf.rtghj.hjkh Chrome\n\n\n-----\n\nC65318AA58C9091B938 948B62C4B5D6E472376\n97D8D2F96863F99EF17 7B6818D\n\n62312475CF0EC1ED66F A29938C30D029BA2F02\nBCD6B6ED5AC6C0E5DB E3626BF6\n\n17D1415176121AFF8C0020\nC3A094B3D72F9802F5145\nC80EBCA47DCFE10CC21F6\n\n1849E8DFD9D1C03DBE6C\n1464F9B05492012A6C14A0\nA5B63FEB938F1C8B70309B\n\nAC0C7F59859B5DC3ACBC3\nBACA6A6B0FD6ECD05375\nD06995D7E28D3F6CB36322A\n\nB623DA28673A1934BD61DE\nA94A88C37E5FBE9999ED3\nD6BA311176D65F64C4A4D\n\n4232B36C2B306A47B6C67D\n5D949349024F57CDBC4516\n3A2CA7B7DEE304229C2B\n\nB8FB1857881F20E8E3223E\n390E13E6DD97D47CABB81\n870D51421C04631D63FC1\n\nAA183FDA57FDE0137AB931\nF3729215956E6F9EE158D90\nED82151948F70DB841B\n\nB125EA78FB390950893D14\n6A51F513440314BE7648207 B59E5D0A1752740F273\n\n6690FBA689E5AE957E0D01\n565BA8F849E0F6AA214F2F\n93535D1A7C9C75030BD3\n\nE690C05F2AB668A661CD21\n9E324291819D5F5646775C2\nA17F3B3A03E79332A04\n\n4E32493E6C87B0E2EF3E6A\nE32F5C32D75AE36C92524A\n185EABC88FEA3C7938C8\n\n82D7A496091BD8B0435359\nBAFC9E7C923CF09BE58D3\nECC9C477E29E541811582\n\n\nghd.et.hds Chrome\n\ngfhd.rewq.cvxbdf Chrome\n\ngfdg.qwe.gsdg Facebook\n\njfgh.rtw.ghm Facebook\n\ngwer.dfdf.cxv Facebook\n\nertt.fgh.nfg Facebook\n\ngfdg.qwe.gsdg Facebook\n\nertt.fgh.nfg Facebook\n\ndfg67.as44f.cvx87df Facebook\n\njfgh.rtw.ghm Facebook\n\nertt.fgh.nfg Facebook\n\ntryrt.sdf.bfd Facebook\n\nfddf.tre.hjgdsgkh Facebook\n\ntrghj.asdf.cvxebdf Facebook\n\n\n-----\n\nE1FB10B714420F23F1BB09B\n6C4C55B674B6EFD93685EE\n7D1D4574C7FA8B39A94\n\nCC2617D7D904986B83BAF7\n843DB6969151363000678E8\nDA599EDBF6CF23CB827\n\n3698DF22E8A4656FC53BD2\nBDE2DA74DD9DA90083481\n29347D5D3E6F976FABA6C\n\n065E266016A15BB639C31D\n49511DBCD0ADC83261D03\nC6652DFBFCAB611B9DB53\n\n6F20F227F79DEBFDAE322\n33B59F4DC15C7FAF05036B\n21E8CD46B24EBC52F0BF8\n\nA4031768A9F1AEB227389E\nDD99140303420F3A45F0C1\n36D3863C703C685CDEF1\n\n7E49B7C6ED359B4E910E8D\n4D2C9436D99CDDEB7F9AF\n2E2F1082D0CA45D469566\n\nMobile\n\n\ntrghj.asdf.cvxebdf Facebook\n\njfgh.rtw.ghm Facebook\n\ntrghj.asdf.cvxebdf Facebook\n\ntrghj.asdf.cvxebdf Facebook\n\ngfdg.qwe.gsdg Facebook\n\ntryrt.sdf.bfd Facebook\n\njfgh.rtw.ghm Facebook\n\n\nWe have been detecting a new wave of network attacks since early March, which, for now,\nare targeting Japan, Korea, China, Taiwan, and Hong Kong. Trend Micro detects these as\nANDROIDOS_XLOADER.HRX.\n\nBy: Trend Micro April 20, 2018 Read time: ( words)\n\nContent added to Folio\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-04-20 - XLoader Android Spyware and Banking Trojan Distributed via DNS Spoofing.pdf"
    ],
    "report_names": [
        "2018-04-20 - XLoader Android Spyware and Banking Trojan Distributed via DNS Spoofing.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536017,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653753647,
    "ts_modification_date": 1653753647,
    "files": {
        "pdf": "https://archive.orkl.eu/863f7251cf710727b0d424db24823a67a7a833e9.pdf",
        "text": "https://archive.orkl.eu/863f7251cf710727b0d424db24823a67a7a833e9.txt",
        "img": "https://archive.orkl.eu/863f7251cf710727b0d424db24823a67a7a833e9.jpg"
    }
}