{
    "id": "b2e2d3bd-4136-42f4-af9d-78ff784e708c",
    "created_at": "2023-01-12T15:10:25.261148Z",
    "updated_at": "2025-03-27T02:09:24.547091Z",
    "deleted_at": null,
    "sha1_hash": "38c1d362ef1d9bb289d92f5f318f2df3bb1962d7",
    "title": "2021-11-04 - Threat Thursday- Karma Ransomware",
    "authors": "",
    "file_creation_date": "2022-05-28T23:17:18Z",
    "file_modification_date": "2022-05-28T23:17:18Z",
    "file_size": 3764503,
    "plain_text": "# Threat Thursday: Karma Ransomware\n\n**[blogs.blackberry.com/en/2021/11/threat-thursday-karma-ransomware](https://blogs.blackberry.com/en/2021/11/threat-thursday-karma-ransomware)**\n\nThe BlackBerry Research & Intelligence Team\n\n### Summary\n\nKarma is fast-acting ransomware designed to quickly encrypt data on compromised machines. In\nthe wild since mid-2021, Karma initially used the stream cipher known as ChaCha20. Recent\nsamples have swapped this out for Salsa20, suggesting the malware is still under development.\n\nThe Karma ransom group has created a leak site named “Karma Leaks,” which is hosted via an\nOnion page. This site has blog-like posts that allude to infiltration of an organization’s network\nbefore deploying their ransomware, a technique which allows them to get a better sense of the\nvalue of their victim’s data before setting a ransom amount. The group also uses this site as a\ndouble-extortion ploy. Affected organizations that refuse to pay the ransom demands or that do not\npay within a specific time, have their data published.\n\nIn October 2021, Karma ransomware went through an iterative change, showing rapid\nadvancement including smaller sample-size and shifts in their encryption routine. Files encrypted\nby the newest version of the ransomware have the file-extension [.KARMA_V2] appended, rather\nthan the initial [.KARMA] file-extension used in a previous version.\n\n### Operating System\n\n\n-----\n\n### Risk & Impact\n\n Technical Analysis\n\n Infection Vector\n\nThe infection vector used by the Karma ransomware gang is unknown, but based on initial findings\nof reconnaissance performed on the victims by the threat group, it appears to vary. Once the group\nhas established a foothold, they likely attempt to move laterally and exfiltrate any data of value.\nOnce reconnaissance and information-stealing has concluded, they execute the Karma\nransomware to encrypt victim systems that they have compromised.\n\n### File Analysis\n\nThe ransomware file itself is small, with samples ranging between 15 KB and 130 KB. Despite their\nsmall size, none of the samples found in the wild were packed by digital software packers. The\nobserved samples were all Windows® 32-bit Portable Executables (PE) with a compilation\ntimestamp of 2021. All samples found in the wild were compiled in Microsoft® Visual C++.\n\nThough most samples of Karma are unsigned, lacking digital certificates, at least one known\nsample was signed with a currently un-revoked digital signature.\n\n\n-----\n\n_Figure 1: Static information of Karma_V2 sample_\n\nAs noted, Karma appears to be still under development. BlackBerry has observed a clear lateral\nprogression between initial samples of Karma, leading up to KARMA_V2. Over a short period of\ntime, the samples of Karma that have been analyzed became progressively smaller, shifted their\nencryption routine, and increased in complexity.\n\nThe initial samples of Karma contained a console pop-up box during encryption, meaning an\nattentive user could attempt to terminate the process before all their data was encrypted. However,\ngiven the speed of the malware’s encryption routine, it would have been difficult to act quickly\nenough to keep all data intact.\n\n_Figure 2: Initial console dialog box of Karma_\n\n\n-----\n\nMore recently, samples contain the static string: Karma_V2. These samples share a lot of\nresemblance to the proceeding version, but the initial console box that was once displayed on the\nvictim device is no longer visible. Its speed and method of encryption appear the same.\n\n### Karma Mutex\n\nKarma_V2, like the original, initially creates a mutex called “KARMA.” This functions as a buffer to\nprevent another instance of the ransomware from being executed if one is already running. This is\nlikely done to prevent re-infection, as well as double-encryption that might occur if the ransomware\ninadvertently executes twice.\n\nIf ransomware were to be executed twice on a system, doubly-encrypted data is likely to become\nun-recoverable and corrupt. This would defeat the purpose of such malware demanding a payment\nfor decrypting and recovering the user’s data.\n\n_Figure 3: Formation of the \"KARMA\" mutex_\n\nKarma calls on the use of crypt32.dll. This Dynamic-Link Library (.DLL) is a native module used to\nimplement cryptographic messaging and certification functions with the Windows CryptoAPI. The\nDLL is used during encryption.\n\n\n-----\n\n_Figure 4: crypt32.dll being loaded_\n\nAfter loading the DLL, the malware will then iterate through all available drives connected to the\nvictim’s device. If a logical drive is identified and verified, the malware will attempt to encrypt its\ncontents.\n\n### Encryption\n\nNot all samples of Karma have the same goals. Though they all operate the same, they can target\ndifferent files and folders.\n\nKarma samples vary in which file-extensions and folders they exclude from encrypting. This\ninformation is statically hard-coded into the malware, located in the .rdata section of each sample.\n\n\n-----\n\nFigure 5: Static references to folder exclusions\n\n_Figure 6: These exclusions are then used by the malware when executing_\n\nThese exclusions are likely included to avoid inadvertently encrypting core and critical Windows\ncomponents.\n\n\n-----\n\n_Figure 7: File extension exclusion list_\n\n### KARMA (ChaCha20)\n\n**SHA1:** a9367f36c1d2d0eb179fd27814a7ab2deba70197\n\n**File Size:** 127 KB\n\n**Excluded Extensions:** .EXE\n.LOG\n.BAT\n.INI\n.URL\n.PIF\n.MP4\n.MSI\n.LNK\n\n\n-----\n\n**Excluded Folder:** Windows\nProgram Files\nProgram Files (x86)\nProgramData\n\n**Ransom Extension** .KARMA\n\n**Ransom Note:** KARMA-AGREE.txt\n\n### KARMA (Salsa20)\n\n**SHA1:** 08f1ef785d59b4822811efbc06a94df16b72fea3\n\n**File Size:** 19 KB\n\n**Excluded Extensions:** .EXE\n.INI\n.DLL\n.URL\n.LNK\n\n**Excluded Folder:** Windows\n$Recycle Bin\nAll Users\nDefault User\nPublic\nProgramData\nAppData\nProgram Files\nProgram Files (x86)\nDefault\nSystem Volume Information\nSearches\n\n**Ransom Extension:** KARMA\n\n**Ransom Note:** KARMA_ENCRYPTED.txt\n\n**KARMA_V2**\n\n**SHA1:** 338cff5f17663b7552fb0d687d3b67e9b47fca95\n\n**File Size:** 18 KB\n\n\n-----\n\n**Excluded Extensions:** .EXE\n.INI\n.DLL\n.URL\n.LNK\n\n**Excluded Folder:** Windows\n$Recycle Bin\nAll Users\nDefault User\nPublic\nAppData\nProgramData\nProgram Files\nProgram Files (x86)\nDefault\nSystem Volume Information\nSearches\n\n**Ransom Extension:** KARMA_V2\n\n**Ransom Note:** KARMA_V2_ENCRYPTED.txt\n\nOnce files are passed through the malware encryption routine, and the file-extension has been\nappended, the malware will add the 8 bytes of data shown below to signify successful encryption.\n\n_Figure 8: File encrypted by Karma_V2_\n\n### Background Change\n\nIn all samples of Karma ransomware analyzed to date, once encryption is completed, the malware\ncreates a file called “background.jpg.” This file is generated and stored in the %Temp% directory.\n\n\n-----\n\n_Figure 9: Creating 'background.jpg'_\n\nOnce the malware has carried out its encryption, it will change the victim’s desktop image as\nshown below.\n\n_Figure 10: System affected by Karma_\n\n### Ransom Note\n\n\n-----\n\n_Figure 11: Example of Karma ransom note_\n\nThere are few deviations in the Karma ransom note. However, the formatting is generally the same\nacross all versions.\n\nTypically, the contents of these notes are Base-64 encoded and contained within the file’s static\nstrings. The contents are decoded into memory before being placed into the text file KARMAENCRYPTED.txt or KARMA-AGREE.txt. These ransom notes are created and dropped in all\nfolders where the malware has encrypted files.\n\nThe note contains an Onion link to the threat actor’s leak site. It also contains unique email\naddresses related to that specific sample of Karma.\n\nThese addresses often follow a pattern of containing at least one of each of the following email\nservices:\n\nOnionMail\nTutanota\nProtonMail\n\n### Leak Site\n\nWhile other prevalent ransomware threats have been observed selling their malicious code to\nother threat actors as Ransomware-as-a-Service offerings, Karma appears to be used solely by its\nown creators.\n\nSince Karma began posting to its Onion webpage in May 2021, the ransomware threat actors have\nbeen busy populating their basic WordPress site with the names and data of victims who have\nrefused to pay their ransom.\n\n\n-----\n\n_Figure 12: Current content of “Karma Leaks” website (redacted)_\n\nAs of November 2021, the site hosts the data of four victims who have not engaged or contacted\nthe group and therefore have had their data publicly leaked. Each post shown in Figure 12\ncontains multiple links to download confidential information stolen by the threat actors. The site\nsuggests that these “double-extortion” posts would be removed if a fee is paid, which means that\nthe true number of victims who have fallen to Karma may extend beyond this initial tally.\n\nIt appears that the Karma ransomware gang tends to target large multinational organizations; in\nparticular, those with more than 1,000 employees and around $1 billion in revenue.\n\n\n-----\n\n_Figure 13: Karma leak site s About page text_\n\nKarma’s website has a few blog-like posts about potential victims they intend to leak data from\nsoon, and further ways to contact the gang. The “About\" page shares a few additional pieces of\ninformation, as seen in Figure 13.\n\nNeither the ransom note nor the website publicly discloses a specific ransom amount. Typically,\nransomware would immediately demand a victim-specific fee or a flat-rate fee for the decryption of\nfiles.\n\nAs the Karma ransomware gang likely infiltrates organizations directly, as opposed to an RaaS\nmodel, fees could vary based on not just on the damage caused by the ransomware, but on the\nvictim’s ability to pay and criticality of the affected data.\n\n### Conclusion\n\nKarma ransomware is a quickly evolving and ruthless operation. Though Karma shares a lot of\nsimilarities with other known ransomware families, its rapid development and advancement in\ntechniques makes both the malware and the threat actor behind it extremely dangerous. The use\nof “Karma Leaks” as a double-extortion ploy shows the threat group’s willingness to expose victims\nwho do not pay.\n\nWith both the activity on “Karma Leaks” and the development of KARMA_V2, it appears this threat\nactor is spinning up its operations, and that it is actively looking for large organizations to target\nnext.\n\n### YARA Rule\n\nThe following YARA rule was authored by the BlackBerry Research & Intelligence Team to catch\nthe threat described in this document:\n\n\n-----\n\nimport \"pe\"\n\nrule Mal_Ransom_Win32_Karma_2021\n\n{\nmeta:\n\ndescription = \"Detects Karma Ransomware 2021\"\n\nauthor = \"Blackberry Threat Research Team \"\n\ndate = \"2021-10\"\n\nlicense = \"This Yara rule is provided under the Apache License 2.0\n(https://www.apache.org/licenses/LICENSE-2.0) and open to any user or organization, as long as\nyou use it under this license and ensure originator credit in any derivative to The BlackBerry\nResearch & Intelligence Team\"\n\nstrings:\n$s1 =\n\"WW91ciBuZXR3b3JrIGhhcyBiZWVuIGJyZWFjaGVkIGJ5IEthcm1hIHJhbnNvbXdhcmUgZ3JvdXAu\"\nascii wide\n\n$x2 = \"crypt32.dll\" nocase\n\n$x3 = \"KARMA\" ascii wide\n$x4 = \"Sleep\" nocase\n\ncondition:\n\n//PE File\n\nuint16(0) == 0x5a4d and\n\n//Base64 Karma Note\n\nall of ($s*) and\n\n//All Strings\n\nall of ($x*)\n\n}\n\n### Indicators of Compromise (IoCs)\n\n\n-----\n\n**Ransom Note:**\n\nKARMA-AGREE.txt\n\nKARMA-ENCRYPTED.txt\n\n**Encrypted Files:**\n\n*.KARMA\n\n*.KARMA_V2\n\n**Mutex:**\n\nGlobal\\KARMA\n\n**Malware Digital Cert:**\n\nSerial: {00 C4 CD EE EB 36 88 DA 08 1F 95 D6 AA 33 7E 93 D1}\n\n**Payment Email IoC’s:**\n\nJamesHoopkins1988[@]onionmail[.]com\n\nLeslydown1988[@]tutanota[.]com\n\nollivergreen1977[@]protomail[.]com\n\nIndiAdams[@]onionmail[.]org\n\nJimmyhendricks[@]tutanota[.]com\n\nkarlironsterson122[@]protomail[.]com\n\n**Leak Site:**\n\nhxxp://3nvzqyo6l4wkrzumzu5aod7zbosq4ipgf7ifgj3hsvbcr5vcasordvqd[.]onion/\n**SHA256:**\n\n**KARMA_V2**\n\n1c41acdc2e9d8b89522ebb51d65b4c41d7fd130a14ce9d449edb05f53bbb8d59\n\n6c98d424ab1b9bfba683eda340fef6540ffe4ec4634f4b95cf9c70fe4ab2de90\n\n**KARMA**\n\n0d037ee0252e4f26800bcf7c750f61d0c549b7ba0a522c75e8d96dcf4f689e27\n\n84d24a16949b5a89162411ab98ab2230128d8f01a3d3695874394733ac2a1dbd\n\n124f3a5caf6eb464027f2865225a6a1238c3639e5b4a399f0f7f2dda7bd75aec\n\n3ff1b90dbad5d78397fdc731c3a3c080d91fc488ac9152793b538b74a1e2d8f3\n\nad841882052c3f9d856ad9a393232e0a59d28e17c240d23258f1dac62f903ab8\n\n19417c0a38a1206007a0cc82c0fc2e19db897214d27d0998bc4dbac53cc2788d\n\na63937d94b4d0576c083398497f35abc2ed116138bd22fad4aec5714f83371b0\n\n34629751d8202be456dcf149b516afefc980a9128dd6096fd6286fee530a0d20\n\n### BlackBerry Assistance\n\nIf you’re battling this malware or a similar threat, you’ve come to the right place, regardless of your\nexisting BlackBerry relationship.\n\n[The BlackBerry Incident Response team is made up of world-class consultants dedicated to](https://www.blackberry.com/us/en/services/incident-response)\nhandling response and containment services for a wide range of incidents, including ransomware\nand Advanced Persistent Threat (APT) cases.\n\nWe have a global consulting team standing by to assist you providing around-the-clock support,\nwhere required, as well as local assistance. Please contact us here:\n\n\n-----\n\nhttps://www.blackberry.com/us/en/forms/cylance/handraiser/emergency-incident-responsecontainment\n\n_Want to learn more about cyber threat hunting? Check out the BlackBerry Research & Intelligence_\n_Team’s new book,_ _[Finding Beacons in the Dark: A Guide to Cyber Threat Intelligence, now](https://blogs.blackberry.com/en/2021/10/blackberry-shines-spotlight-on-evolving-cobalt-strike-threat-in-new-book)_\n_[available for pre-order here.](https://www.blackberry.com/us/en/forms/enterprise/ebook-beacons-in-the-dark)_\n\n## About The BlackBerry Research & Intelligence Team\n\nThe BlackBerry Research & Intelligence team examines emerging and persistent threats, providing\nintelligence analysis for the benefit of defenders and the organizations they serve.\n\nBack\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-11-04 - Threat Thursday- Karma Ransomware.pdf"
    ],
    "report_names": [
        "2021-11-04 - Threat Thursday- Karma Ransomware.pdf"
    ],
    "threat_actors": [
        {
            "id": "20c759c2-cd02-45bb-85c6-41bde9e6a7cf",
            "created_at": "2024-01-18T02:02:34.189827Z",
            "updated_at": "2025-03-27T02:02:09.937024Z",
            "deleted_at": null,
            "main_name": "HomeLand Justice",
            "aliases": [
                "Karma",
                "Storm-842",
                "Void Manticore"
            ],
            "source_name": "ETDA:HomeLand Justice",
            "tools": [
                "BABYWIPER",
                "BiBi Wiper",
                "BiBi-Linux Wiper",
                "BiBi-Windows Wiper",
                "Cl Wiper",
                "LowEraser",
                "No-Justice Wiper",
                "Plink",
                "PuTTY Link",
                "RevSocks",
                "W2K Res Kit"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536225,
    "ts_updated_at": 1743041364,
    "ts_creation_date": 1653779838,
    "ts_modification_date": 1653779838,
    "files": {
        "pdf": "https://archive.orkl.eu/38c1d362ef1d9bb289d92f5f318f2df3bb1962d7.pdf",
        "text": "https://archive.orkl.eu/38c1d362ef1d9bb289d92f5f318f2df3bb1962d7.txt",
        "img": "https://archive.orkl.eu/38c1d362ef1d9bb289d92f5f318f2df3bb1962d7.jpg"
    }
}