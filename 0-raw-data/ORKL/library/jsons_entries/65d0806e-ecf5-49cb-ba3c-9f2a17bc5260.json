{
    "id": "65d0806e-ecf5-49cb-ba3c-9f2a17bc5260",
    "created_at": "2023-01-12T15:05:40.549451Z",
    "updated_at": "2025-03-27T02:05:22.237642Z",
    "deleted_at": null,
    "sha1_hash": "320a327fc40ced59b67340f723d17ab621d6cc1a",
    "title": "2016-06-29 - Apocalypse- Ransomware which targets companies through insecure RDP",
    "authors": "",
    "file_creation_date": "2022-05-28T19:06:40Z",
    "file_modification_date": "2022-05-28T19:06:40Z",
    "file_size": 1191528,
    "plain_text": "# Apocalypse: Ransomware which targets companies through insecure RDP\n\n**[blog.emsisoft.com/2016/06/29/apocalypse-ransomware-which-targets-companies-through-insecure-rdp/](http://blog.emsisoft.com/2016/06/29/apocalypse-ransomware-which-targets-companies-through-insecure-rdp/)**\n\nSarah June 29, 2016\n\nBeyond a shadow of a doubt 2016 has been the year of the ransomware. So it comes as no\nsurprise that new ransomware families are popping up on weekly basis. Emsisoft has been\non the frontline battling ransomware for years now, providing users with valuable tools\nallowing them to recover their files after ransomware attacks. As a result Emsisoft\nresearchers often find themselves at the receiving end of hate from ransomware authors.\nLate last year, we took a look at Radamant, whose authors included some rather unkind\nmessages after our research team broke their amateurish ransomware. Today, we want to\ntake a look at a new ransomware family Apocalypse, that reared its ugly head about 2\nmonths ago, that recently started spewing insults towards our team as well.\n\n## Meet Apocalypse\n\n\n-----\n\nThe Apocalypse ransomware was first seen on the 9th May. The main attack vector is weak\npasswords on insecurely configured Windows servers running the remote desktop service.\nThis allows an attacker to use brute force to gain access and means they can easily interact\nwith the system as if they had access in person. Abusing remote desktop has become\nincreasingly common over the last few months, especially for running ransomware like\nApocalypse.\n\nThe earliest variants install themselves to %appdata%windowsupdate.exe and create a run\nkey called windows update to both HKEY_CURRENT_USER and\nHKEY_LOCAL_MACHINE. This variant uses the .encrypted extension. A ransom note is\ncreated for every file in the form\nof *filename*.How_To_Decrypt.txt. The [[email protected]/[email protected]/[email protected]/[](http://blog.emsisoft.com/cdn-cgi/l/email-protection)\nemail protected] email addresses are used in the ransom note.\n\nOn June 9th, another version of the Apocalypse was discovered. This variant uses a different\nlocation, run key name and email address. The ransomware installs itself\nto %ProgramFiles%windowsupdate.exe, and creates a run key called windows update svc.\n[The email address used in this variant is [email protected]](http://blog.emsisoft.com/cdn-cgi/l/email-protection)\n\nOn June 22nd, the newest variant was discovered, which changed a lot more. Instead of\nusing windowsupdate, it uses firefox as a name instead. The newest version installs itself\nto %ProgramFiles%firefox.exe, and creates a run key called firefox update checker. The new\nextension is .SecureCrypted and new name for ransom note\n_*filename*.Contact_Here_To_Recover_Your_Files.txt. The email address used is_\n\n[[email protected]](http://blog.emsisoft.com/cdn-cgi/l/email-protection)\n\n## A closer look into the latest variant\n\nTo give you a better idea on how Apocalypse operates, we want to take a closer look at one\nof the newest variants with the hash AC70F2517698CA81BF161645413F168C. The\nransomware first checks the default system language and if it is set to Russian, Ukrainian or\nBelarusian then the ransomware will quit and not encrypt the system.\n\nThe ransomware then copies itself to %ProgramFiles%firefox.exe, if it doesn’t exist there\nalready, and sets the hidden and system attributes. It also falsifies the timestamp of this file\nusing the explorer.exe timestamp. Then a run value is created, so the ransomware can run\non every startup:\n\n\n-----\n\nCreation of the run values\n\nOnce installation is complete, it then runs the newly created firefox.exe, which then deletes\nthe file. The firefox.exe file does two different tasks at the same time: First, it periodically\nchecks whether certain Windows processes are running and then kills them. Second, it\nstarts the encryption routine where it gets a list of all removable, fixed or remote network\ndrives; the latter however is never encrypted due to a bug in the ransomware. The\nransomware then scans all folders and any files found will be encrypted.\n\nHowever, the malware will not attempt to encrypt any files if they end in one of the following\ntext strings:\n\n.exe\n.dll\n.sys\n.msi\n.com\n.lnk\n.tmp\n.ini\n.SecureCrypted\n.bin\n.bat\n.dat\n.Contact_Here_To_Recover_Your_Files.txt\n\nFiles located in the Windows folder are skipped as well.\n\nTo encrypt a file, the ransomware first checks whether it is encrypted already by comparing\nthe first four bytes of the file against the magic value: 0xD03C2A77. If the file is not\nencrypted already then it will encrypt the content of the file in memory using a custom XOR\nbased algorithm:\n\n\n-----\n\nExample of a Apocalypse encryption loop\n\nThe exact algorithm varies slightly from variant to variant. The magic value and encrypted\ncontent will then be written to the file and SecureCrypted is added to the filename. Before\nclosing it, the original file timestamps will be restored and the following ransom note is\ncreated for the file:\n\nA L L Y O U R F I L E S A R E E N C R Y P T E D\n\nAll your data – documents, photos, videos, backups – everything is encrypted.\n\n[The only way to recover your files: contact us to the next email: [email protected]](http://blog.emsisoft.com/cdn-cgi/l/email-protection)\n\nAttach to e-mail:\n1. Text file with your IP server as Subject (To locate your encryption algoritm)\n2. 1-2 encrypted files (please dont send files bigger than 1 MB)\n\nWe will check the encrypted file and send to you an email with your\nDecrypted FILE as proof that we actually have the decrypter software.\n\nRemember:\n1. The FASTER you’ll CONTACT US – the FASTER you will RECOVER your files.\n2. We will ignore your e-mails without IP server number in Subject.\n3. If you haven’t received reply from us in 24 hours – try to contact us via public e-mail\nservices such as Yahoo or so.\n\nThe ransomware also creates a window which it displays to the user with a similar ransom\nnote:\n\n\n-----\n\nThe screen that the ransomware displays to the user\n\nOne interesting aspect of this screen is that within the code which creates it, the ransomware\nauthor hid messages to Emsisoft:\n\nThe Apocalypse developer insults “emissoft”\n\nAs before, we see messages like this as validation of our work and consider it a backwards\ncompliment.\n\n## How can I decrypt my files encrypted by this ransomware?\n\nAs for many other ransomware families, Emsisoft provides a free decrypter to all Apocalypse\nvictims that allows them to decrypt their files for free.\n\nThe Emsisoft Apocalypse decrypter at work\n\n[The decrypter is available for download at our Emsisoft Decrypter portal here.](https://decrypter.emsisoft.com/apocalypse)\n\n## How can I protect myself?\n\n\n-----\n\nDue to the nature of the attack protection software is rather ineffective. If the attacker\nmanages to get access to the system via remote control, they can simply disable any\nprotection software installed or add the malware to the protection software’s exclusion list. It\ntherefore is imperative to prevent the attacker from gaining access to the system to begin\nwith.\n\nThe most important line of defense is a proper password policy that is enforced for all user\naccounts with remote access to the system. This does apply to rarely used accounts created\nfor testing purposes or by applications as well.\n\n### Protect your device with Emsisoft Anti-Malware.\n\nDid your antivirus let you down? We won’t. Download your free trial of Emsisoft Anti-Malware\nand see for yourself. [Start free trial](https://my.emsisoft.com/signup?p=eam)\nEven better would be to disable Remote Desktop or Terminal Services completely if not\nrequired or at least to use IP address based restrictions to allow the access to these services\nfrom trusted networks only.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-06-29 - Apocalypse- Ransomware which targets companies through insecure RDP.pdf"
    ],
    "report_names": [
        "2016-06-29 - Apocalypse- Ransomware which targets companies through insecure RDP.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535940,
    "ts_updated_at": 1743041122,
    "ts_creation_date": 1653764800,
    "ts_modification_date": 1653764800,
    "files": {
        "pdf": "https://archive.orkl.eu/320a327fc40ced59b67340f723d17ab621d6cc1a.pdf",
        "text": "https://archive.orkl.eu/320a327fc40ced59b67340f723d17ab621d6cc1a.txt",
        "img": "https://archive.orkl.eu/320a327fc40ced59b67340f723d17ab621d6cc1a.jpg"
    }
}