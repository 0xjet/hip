{
    "id": "87ad92a1-b0c4-4cc6-93be-cf4153792796",
    "created_at": "2023-01-12T15:10:55.59228Z",
    "updated_at": "2025-03-27T02:09:41.035324Z",
    "deleted_at": null,
    "sha1_hash": "be817c0c478cfa05874fef422809f2fecc8ac9a6",
    "title": "2020-04-15 - 中國駭客 HUAPI 的惡意後門程式 BiFrost 分析",
    "authors": "",
    "file_creation_date": "2022-05-28T23:26:22Z",
    "file_modification_date": "2022-05-28T23:26:22Z",
    "file_size": 725192,
    "plain_text": "# 中國駭客 HUAPI 的惡意後門程式 BiFrost 分析\n\n**[teamt5.org/tw/posts/technical-analysis-on-backdoor-bifrost-of-the-Chinese-apt-group-huapi/](https://teamt5.org/tw/posts/technical-analysis-on-backdoor-bifrost-of-the-Chinese-apt-group-huapi/)**\n\nGlobal Support & Service\n\n4.15.2020Global Support & Service\n\nShare:\n關鍵字：HUAPI、PLEAD、GhostCat、CVE-2020-1938、Linux、BiFrost、RC4、RAT\n\n## 前言\n\nTeamT5 近期接獲情資，於台灣某學術網路的圖書館網站上發現存有惡意程式。經過 TeamT5\n研究員分析調查發現，該網站系統使用 Tomcat 7.0.73 作為網頁伺服器且開啟 8009 通訊埠，\nTeamT5 研究員驗證網站具有 Ghostcat（CVE-2020-1938） 漏洞，詳見下圖。\n\n\n-----\n\n圖一、Nmap 掃描結果\n駭客利用 Tomcat 網頁伺服器預設開啟的 AJP 服務（預設為 8009 通訊埠），可達到遠端指令\n執行（Remote Code Execution, RCE）之目的並上傳檔案。於該案例中，駭客疑似透過\nGhostcat 漏洞上傳 BiFrost 惡意程式，使該圖書館系統成為惡意程式下載站（Download\nSite）。\n\n## 惡意程式分析\n\n該惡意程式（8fd3925dadf37bebcc8844214f2bcd18）於 2020 年 1 月 31 日被上傳至\nVirustotal 平台，當時的各家防毒軟體的偵測率並不佳，僅有 6 家防毒軟體能夠有效識別，詳\n見下圖。\n\n\n-----\n\n圖二、惡意程式於一月底上傳至 VirusTotal 且一開始防毒軟體的偵測率並不佳\nTeamT5 取得該惡意後門程式並進行分析，該惡意後門程式檔名為 md.png，但檔案格式為\nUNIX ELF 執行檔，推測是利用 PNG 副檔名偽裝在 Tomcat 網站伺服器上，詳見下圖。\n\n圖三、偽裝為 PNG 的 ELF 執行檔\n使用 TeamT5 的 ThreatSonar 惡意威脅鑑識系統可有效辨識出該惡意程式並可以偵測到中繼\n站 IP 位址（107.191.61.247），詳見下圖。\n\n\n-----\n\n圖四、ThreatSonar 偵測畫面\n經過逆向分析，該惡意後門程式具有上傳/下載/列舉/刪除/搬移檔案（File）、執行/結束程序\n（Process）、開啟/關閉遠端命令列介面程式（Remote Shell）等功能，其中惡意後門程式與\n中繼站的連線內容會使用修改過的 RC4 演算法進行加密，此專屬特徵可用來辯認出此惡意程\n式，詳見下圖。\n\n\n-----\n\n圖五、惡意後門程式使\n\n用修改後的 RC4 加密演算法\n\n## 攻擊族群分析\n\n該惡意程式為 Linux 版本的 BiFrost 後門程式，其版本號為 5.0.0.0。根據 TeamT5 長期研究\n的情資顯示，該惡意程式為中國駭客組織 HUAPI（又名為 PLEAD）慣用的後門程式。HUAPI\n駭客組織自 2007 年開始活躍至今，攻擊台灣超過 10 年的時間。TeamT5 觀察到 HUAPI 所開\n發的惡意程式有時會使用加殼來阻擋研究人員分析，且通常會使用修改後的 RC4 演算法來加\n\n\n-----\n\n密傳輸。HUAPI 長期攻擊政府、高科技、電信或研究智庫單位，根據 TeamT5 的統計結果，\n超過 5 成的受害單位為政府機關，受害國家包含台灣、美國、日本及南韓，其中針對台灣政府\n機關進行入侵攻擊的為多。\n\n## 影響與建議\n\n若用戶有使用 Tomcat 服務作為網頁伺服器，且版本為以下之一者：\n\nApache Tomcat 9.x < 9.0.31\n\nApache Tomcat 8.x < 8.5.51\n\nApache Tomcat 7.x < 7.0.100\n\nApache Tomcat 6.x\n\nTeamT5 建議需要立即進行版本更新，避免遭到駭客利用 Ghostcat 漏洞進行遠端控制，甚至\n上傳惡意檔案。\n\n另外，若用戶若遭遇針對性進階持續威脅（Advanced Persistent Threat, APT）時，則需要使\n用如 TeamT5 的 ThreatSonar 惡意威脅鑑識系統，IT 管理者可以在最短時間內偵測並回應這\n類的惡意威脅。TeamT5 建議可將下方威脅指標（Indicator of Compromise, IOC）匯入到各式\n資安設備中偵測與識別威脅。\n\n107.191.61.247\n\n8fd3925dadf37bebcc8844214f2bcd18\n\nYara Rule\n```\n   rule RAT_BiFrost_UNIX\n   {\n     meta:\n     description= \"HUAPI UNIX BiFrost RAT\"\n     author = \"TeamT5\"\n     date = \"2020-04-15\"\n     strings:\n     $hex1 = {25 ?? 00 00 00 85 C0 75 37 8B 45 F0 89 C1 03 4D 08 8B 45 F0 03 45\n   08 0F B6 10 8B 45 F8 01 C2 B8 FF FF FF FF 21 D0 88 01 8B 45 F0 89 C2 03 55 08 8B\n   45 F0 03 45 08 0F B6 00 32 45 FD 88 02}\n     $hex2 = {8B 45 F0 03 45 08 0F B6 00 30 45 FD 8B 45 F0 89 C1 03 4D 08 8B 45\n   F8 89 C2 02 55 FD B8 FF FF FF FF 21 D0 88 01}\n     condition:\n     all of them\n   }\n\n## 外部參考資料\n\n```\n\n-----\n\n[1. https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-1938](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-1938)\n\nShare:\n\n\n-----",
    "language": "ZH",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-04-15 - 中國駭客 HUAPI 的惡意後門程式 BiFrost 分析.pdf"
    ],
    "report_names": [
        "2020-04-15 - 中國駭客 HUAPI 的惡意後門程式 BiFrost 分析.pdf"
    ],
    "threat_actors": [
        {
            "id": "75024aad-424b-449a-b286-352fe9226bcb",
            "created_at": "2023-01-06T13:46:38.962724Z",
            "updated_at": "2025-03-27T02:00:02.964002Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "CIRCUIT PANDA",
                "Temp.Overboard",
                "G0098",
                "Red Djinn",
                "HUAPI",
                "Palmerworm",
                "T-APT-03",
                "Manga Taurus",
                "Earth Hundun"
            ],
            "source_name": "MISPGALAXY:BlackTech",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536255,
    "ts_updated_at": 1743041381,
    "ts_creation_date": 1653780382,
    "ts_modification_date": 1653780382,
    "files": {
        "pdf": "https://archive.orkl.eu/be817c0c478cfa05874fef422809f2fecc8ac9a6.pdf",
        "text": "https://archive.orkl.eu/be817c0c478cfa05874fef422809f2fecc8ac9a6.txt",
        "img": "https://archive.orkl.eu/be817c0c478cfa05874fef422809f2fecc8ac9a6.jpg"
    }
}