{
    "id": "eee95de8-e899-49c1-860b-d7a9dbffc0d8",
    "created_at": "2023-01-12T15:04:33.982251Z",
    "updated_at": "2025-03-27T02:05:50.245301Z",
    "deleted_at": null,
    "sha1_hash": "26f504aefab635296f1226ef9611f4b8548a64f7",
    "title": "2022-08-31 - Tracking PrivateLoader- Malware Distribution Service",
    "authors": "",
    "file_creation_date": "2022-09-01T10:32:15Z",
    "file_modification_date": "2022-09-01T10:32:15Z",
    "file_size": 516866,
    "plain_text": "# Tracking PrivateLoader: Malware Distribution Service\n\n**[bitsight.com/blog/tracking-privateloader-malware-distribution-service](https://www.bitsight.com/blog/tracking-privateloader-malware-distribution-service)**\n\nWritten by André Tavares\nAugust 31, 2022\nShare\nFacebook\nTwitter\nLinkedIn\n\nPrivateLoader is a loader from a pay-per-install malware distribution service that has been\nutilized to distribute info stealers, banking trojans, loaders, spambots, and ransomware on\n[Windows machines. First seen in early 2021, being hosted on websites that claim to provide](https://intel471.com/blog/privateloader-malware)\ncracked software, the customers of the service are able to selectively deliver malware to\nvictims based on location, financial activity, environment, and specific software installed.\nBitSight's partial visibility over its botnet of infected machines suggests that it’s spread\nworldwide, with a significant percentage of infections in India and Brazil.\n\n## Infection chain\n\nPrivateLoader was seen being distributed through SEO-optimized websites that claim to\nprovide cracked software. Victims download a password-protected zip file (the password is in\n[the file name) which contains an NSIS installer that executes many malicious payloads,](https://www.virustotal.com/gui/file/e52e6bbf7705f9b90e4a20f2935cb86ee6078035f14d873d1c126c6ba9ccc551/relations)\nincluding PrivateLoader. It’s a multi-stage malware loader comprising at least three modules:\nthe loader, the core, and the service.\n\nIn the first stage, the _[loader is executed, which downloads and executes the second stage,](https://www.virustotal.com/gui/file/7a62836c8967ef6d3c737f9aba146eb7ef5d08cacc564faaa2699efac7561b97/behavior)_\n[the core module. The core module's primary purpose is to download and execute more](https://www.virustotal.com/gui/file/4312d4c22e8039a51c04bec4e024027b5e663d85d430f6d29725da4ad7622c7b)\n[malware, including another PrivateLoader module named service. The service module takes](https://www.virustotal.com/gui/file/611479c78035c912dd69e3cfdadbf74649bb1fce6241b7573cfb0c7a2fc2fb2f/relations)\ncare of persistence by creating a scheduled task and, not only self-updates but also\ndownloads and executes the loader module. Figure 1 depicts the typical infection chain.\n\n\n-----\n\nFig. 1 - PrivateLoader infection chain.\n\n## Capabilities\n\nThe main purpose of PrivateLoader is to download and execute more malware. Moreover,\nboth static and dynamic analysis (Fig. 3 and 2) suggest that the malware has additional\ncapabilities, such as disabling Windows Defender, the [discovery of user-sensitive data, and](https://www.zscaler.com/blogs/security-research/peeking-privateloader)\nmany anti-analysis techniques.\n\n\n-----\n\nFig. 2 - Automated dynamic [analysis of the loader module.](https://tria.ge/220724-mgh7zscfc9)\n\n[Fig. 3 - Rule-based static analysis of the core module with CAPA.](https://www.virustotal.com/gui/file/4312d4c22e8039a51c04bec4e024027b5e663d85d430f6d29725da4ad7622c7b)\n\n\n-----\n\nMoreover, [previous research on PrivateLoader shared a YARA rule to detect and hunt its](https://tavares.re/blog/2022/06/06/hunting-privateloader-pay-per-install-service/)\n[samples based on its string decryption technique and also a python script to extract all of its](https://gist.github.com/andretavare5/66ec413cdb4c7c39d35c22d38c7067a8)\nstrings, which contains valuable information when reversing the malware. Those strings can\nalso be used for defense, hunting, and tracking purposes since the command and control\nservers (C2) and other configuration values are included in them. As an example, here are\nall of the strings from a [loader module, a core module, and a service module.](https://github.com/bitsight-research/threat_research/blob/main/privateloader/loader_strings_8f70a0f45532261cb4df2800b141551d.txt)\n\n## Botnet tracking\n\nCombining the mentioned sample hunting technique with previous research on how the bots\ncommunicate with their C2 servers allowed us to build a tracker that gives us visibility over\nwhat’s being distributed by PrivateLoader.\n\n[We started tracking PrivateLoader in July 2022 and so far we’ve seen 1K+ URLs used to](https://urlhaus.abuse.ch/browse/tag/PrivateLoader/)\ndistribute 2K+ [samples. As an example, this](https://bazaar.abuse.ch/user/86185858/) [URL was used to distribute 4 samples of](https://urlhaus.abuse.ch/url/2282159/)\nRedline malware. We’ve seen many URLs from Discord, VK, and Amazon CDNs, although\ndomains and IPs are also often used.\n\nFigure 4 shows the top malware distributed by PrivateLoader this past July and August. Most\nof them are stealers, Redline being by far the most common, but there are also banking\ntrojans, loaders, spambots, and even ransomware.\n\nFig. 4 - Top Malware Families Distributed by PrivateLoader in July and August 2022.\n\n\n-----\n\nWe were able to identify with high confidence 30 malware families being distributed by\nPrivateLoader. They are AgentTesla, Amadey, ArrowRAT, AsyncRAT, Azorult, Colibri,\nDanabot, DCRat, Eternity, Fabookie, Formbook, GCleaner, Glupteba, Gozi_ISFB,\nPseudoManuscrypt, Nitol, NetSupport, Nymaim, PrivateLoader, Qakbot, Raccoon, Redline,\nSmokeLoader, Socelars, STOP, Tofsee, Vidar, WarzoneRAT, XMRig, and YTStealer. For\nsome of them, we only encounter a couple of samples, and so they are included in the\n“others” slice.\n\nRegarding the unknown samples, since this classification was done in an automated way,\nsome samples are harder to programmatically classify; some signatures probably need to be\nimproved, but also some of them might be new unknown malware. By sampling and\nmanually analyzing some of the unknown samples, we mainly identify Redline and\nSmokeLoader, although Fabookie, Vidar, Raccoon, and NekoStealer families were also\nobserved.\n\nBitSight's partial visibility over the geographical distribution of PrivateLoader in July 2022\nsuggests that it’s spread worldwide, with a significant percentage of infections in India (21%)\nand Brazil (16%), as figure 5 shows.\n\nFig. 5 - Approximation of botnet distribution in July 2022.\nThe data used to populate this map is sampled, which means that the actual geographic\ndistribution of PrivateLoader may be closer to this one but not exactly what this map\nsuggests.\n\n\n-----\n\n## Indicators of Compromise\n\n0d7692792b4907f9470d3b1bb6ce8310 - NSIS installer\ne8fe5a28d052a908573b49ab0a904ca4 - PrivateLoader loader module\n\n5df119a002dcaf9b7ba82acfe35e4cb1 - PrivateLoader core module\n\n45abb1bedf83daf1f2ebbac86e2fa151 - PrivateLoader service module\n\n[We are currently uploading our live PrivateLoader IoCs and dropped malware to abuse.ch:](https://abuse.ch/)\n\n- PrivateLoader samples by YARA hunting:\n[https://yaraify.abuse.ch/yarahub/rule/privateloader/](https://yaraify.abuse.ch/yarahub/rule/privateloader/)\n\n[- PrivateLoader C2 servers: https://threatfox.abuse.ch/browse/malware/win.privateloader/](https://threatfox.abuse.ch/browse/malware/win.privateloader/)\n\n- Drop URLs obtained from the C2 server:\n[https://urlhaus.abuse.ch/browse/tag/PrivateLoader/](https://urlhaus.abuse.ch/browse/tag/PrivateLoader/)\n\n[- Malware samples from drop URLs: https://bazaar.abuse.ch/user/86185858/](https://bazaar.abuse.ch/user/86185858/)\n\n## Threat Hunting Signatures\n\n**Yara rule**\n\nThe following rule was tested with VirusTotal Retrohunt, which returned 1K+ samples within a\none-year time period:\n\nhttps://github.com/bitsightresearch/threat_research/blob/main/privateloader/privateloader.yara\n\n**Suricata rule**\n\n[The following rule was tested with a PCAP generated from a sandbox run of the loader](https://tria.ge/220724-mgh7zscfc9/behavioral1)\nmodule:\n\nhttps://github.com/bitsightresearch/threat_research/blob/main/privateloader/privateloader.rules\n\n## Get the Weekly Cybersecurity Newsletter\n\nSubscribe to get security news and industry ratings updates in your inbox.\n\nRead more\nBy checking this box, I consent to sharing this information with BitSight Technologies,\nInc. to receive email and phone communications for sales and marketing purposes as\n[described in our privacy policy. I understand I may unsubscribe at any time.](https://www.bitsight.com/privacy-policy)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-08-31 - Tracking PrivateLoader- Malware Distribution Service.pdf"
    ],
    "report_names": [
        "2022-08-31 - Tracking PrivateLoader- Malware Distribution Service.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535873,
    "ts_updated_at": 1743041150,
    "ts_creation_date": 1662028335,
    "ts_modification_date": 1662028335,
    "files": {
        "pdf": "https://archive.orkl.eu/26f504aefab635296f1226ef9611f4b8548a64f7.pdf",
        "text": "https://archive.orkl.eu/26f504aefab635296f1226ef9611f4b8548a64f7.txt",
        "img": "https://archive.orkl.eu/26f504aefab635296f1226ef9611f4b8548a64f7.jpg"
    }
}