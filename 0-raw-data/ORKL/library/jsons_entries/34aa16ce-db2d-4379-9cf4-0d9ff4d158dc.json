{
    "id": "34aa16ce-db2d-4379-9cf4-0d9ff4d158dc",
    "created_at": "2023-01-12T15:06:58.902323Z",
    "updated_at": "2025-03-27T02:13:50.019864Z",
    "deleted_at": null,
    "sha1_hash": "3403529c99ceb62ad8869093aa57a914a8c81e48",
    "title": "2020-11-03 - New RegretLocker ransomware targets Windows virtual machines",
    "authors": "",
    "file_creation_date": "2022-05-27T02:01:08Z",
    "file_modification_date": "2022-05-27T02:01:08Z",
    "file_size": 4448913,
    "plain_text": "# New RegretLocker ransomware targets Windows virtual machines\n\n**[bleepingcomputer.com/news/security/new-regretlocker-ransomware-targets-windows-virtual-machines/](https://www.bleepingcomputer.com/news/security/new-regretlocker-ransomware-targets-windows-virtual-machines/)**\n\nLawrence Abrams\n\nBy\n[Lawrence Abrams](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nNovember 3, 2020\n05:31 PM\n0\n\nA new ransomware called RegretLocker uses a variety of advanced features that allows it\nto encrypt virtual hard drives and close open files for encryption.\n\nRegretLocker was discovered in October and is a simple ransomware in terms of\nappearance as it does not contain a long-winded ransom note and uses email for\ncommunication rather than a Tor payment site.\n\n\n-----\n\n**RegretLocker ransom note**\n\nSource: BleepingComputer\nWhen encrypting files, it will append the innocuous-sounding .mouse extension to\nencrypted file names.\n\n\n-----\n\n**RegretLocker encrypted files**\n\nSource: BleepingComputer\nWhat it lacks in appearance, though, it makes up for in advanced features that we do not\nusually see in ransomware infections, as described below.\n\n## RegretLocker mounts virtual hard disks\n\nWhen creating a Windows Hyper-V virtual machine, a virtual hard disk is created and stored\nin a VHD or VHDX file.\n\nThese virtual hard disk files contain a raw disk image, including a drive's partition table and\npartitions, and like regular disk drives, can range in size from a few gigabytes to terabytes.\n\nWhen a ransomware encrypts files on a computer, it is not efficient to encrypt a large file as\nit slows down the entire encryption process's speed.\n\n[In a sample of the ransomware discovered by MalwareHunterTeam and analyzed by](https://twitter.com/malwrhunterteam)\nAdvanced Intel's [Vitali Kremez, RegretLocker uses an interesting technique of mounting a](https://twitter.com/VK_Intel)\nvirtual disk file so each of its files can be encrypted individually.\n\n[To do this, RegretLocker uses the Windows Virtual Storage API OpenVirtualDisk,](https://docs.microsoft.com/en-us/windows/win32/api/virtdisk/nf-virtdisk-openvirtualdisk)\n[AttachVirtualDisk, and](https://docs.microsoft.com/en-us/windows/win32/api/virtdisk/nf-virtdisk-attachvirtualdisk) [GetVirtualDiskPhysicalPath functions to mount virtual disks.](https://docs.microsoft.com/en-us/windows/win32/api/virtdisk/nf-virtdisk-getvirtualdiskphysicalpath)\n\n\n-----\n\n**Mounting a VHD file**\nAs shown by a debug message in the ransomware, it is specifically searching for VHD and\nmounting them when detected.\n```\nparse_files() | Found virtual drive: %ws in path: %s\n\n```\nOnce the virtual drive is mounted as a physical disk in Windows, the ransomware can\nencrypt each one individually, which increases the speed of encryption.\n\nThe code used by RegretLocker to mount a VHD is believed to have been taken from a\n[recently published research by security researcher smelly__vx.](https://github.com/vxunderground/VXUG-Papers/tree/main/Weaponizing%20Windows%20Virtualization)\n\nIn addition to using the Virtual Storage API, RegretLocker also utilizes the Windows Restart\nManager API to terminate processes or Windows services that keep a file open during\nencryption.\n\nWhen using this API, Kremez told BleepingComputer if the name of a process contains\n'vnc', 'ssh', 'mstsc', 'System', or 'svchost.exe', the ransomware will not terminate it. This\nexception list is likely used to prevent the termination of critical programs or those used by\nthe threat actor to access the compromised system.\n\n\n-----\n\n**Windows Restart Manager exception list**\nThe Windows Restart Manager feature is only used by a few ransomware such as REvil\n(Sodinokibi), Ryuk, [Conti,](https://www.bleepingcomputer.com/news/security/conti-ransomware-shows-signs-of-being-ryuks-successor/) [ThunderX/Ako,](https://www.bleepingcomputer.com/news/security/thunderx-ransomware-rebrands-as-ranzy-locker-adds-data-leak-site/) [Medusa Locker,](https://www.carbonblack.com/blog/tau-threat-analysis-medusa-locker-ransomware/) [SamSam, and](https://www.crowdstrike.com/blog/an-in-depth-analysis-of-samsam-ransomware-and-boss-spider/) [LockerGoga.](https://www.trendmicro.com/vinfo/hk-en/security/news/cyber-attacks/what-you-need-to-know-about-the-lockergoga-ransomware)\n\nRegretLocker is not very active at this point, but it is a new family that we need to keep an\neye on.\n\n### Related Articles:\n\n[Microsoft shares mitigation for Windows KrbRelayUp LPE attacks](https://www.bleepingcomputer.com/news/security/microsoft-shares-mitigation-for-windows-krbrelayup-lpe-attacks/)\n\n[Microsoft adds support for WSL2 distros on Windows Server 2022](https://www.bleepingcomputer.com/news/microsoft/microsoft-adds-support-for-wsl2-distros-on-windows-server-2022/)\n\n[New ‘Cheers’ Linux ransomware targets VMware ESXi servers](https://www.bleepingcomputer.com/news/security/new-cheers-linux-ransomware-targets-vmware-esxi-servers/)\n\n[Microsoft adds Office subscriptions to Windows 11 account settings](https://www.bleepingcomputer.com/news/microsoft/microsoft-adds-office-subscriptions-to-windows-11-account-settings/)\n\n[CISA adds 41 vulnerabilities to list of bugs used in cyberattacks](https://www.bleepingcomputer.com/news/security/cisa-adds-41-vulnerabilities-to-list-of-bugs-used-in-cyberattacks/)\n\n\n-----\n\n[Hyper-V](https://www.bleepingcomputer.com/tag/hyper-v/)\n[RegretLocker](https://www.bleepingcomputer.com/tag/regretlocker/)\n[VHD](https://www.bleepingcomputer.com/tag/vhd/)\n[Virtual Disk](https://www.bleepingcomputer.com/tag/virtual-disk/)\n[Virtual Drive](https://www.bleepingcomputer.com/tag/virtual-drive/)\n[Virtual Machine](https://www.bleepingcomputer.com/tag/virtual-machine/)\n[Virtualization](https://www.bleepingcomputer.com/tag/virtualization/)\n[Windows](https://www.bleepingcomputer.com/tag/windows/)\n\n[Lawrence Abrams](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nLawrence Abrams is the owner and Editor in Chief of BleepingComputer.com. Lawrence's\narea of expertise includes Windows, malware removal, and computer forensics. Lawrence\nAbrams is a co-author of the Winternals Defragmentation, Recovery, and Administration\nField Guide and the technical editor for Rootkits for Dummies.\n\n[Previous Article](https://www.bleepingcomputer.com/news/security/folksam-data-breach-leaks-info-of-1m-swedes-to-google-facebook-more/)\n[Next Article](https://www.bleepingcomputer.com/news/security/leading-toy-maker-mattel-hit-by-ransomware/)\n\nPost a Comment [Community Rules](https://www.bleepingcomputer.com/posting-guidelines/)\n\nYou need to login in order to post a comment\n\n[Not a member yet? Register Now](https://www.bleepingcomputer.com/forums/index.php?app=core&module=global&section=register)\n\n### You may also like:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-11-03 - New RegretLocker ransomware targets Windows virtual machines.pdf"
    ],
    "report_names": [
        "2020-11-03 - New RegretLocker ransomware targets Windows virtual machines.pdf"
    ],
    "threat_actors": [
        {
            "id": "eb8697fd-882a-4323-9eb8-8e20222cfd91",
            "created_at": "2022-10-25T16:07:23.416834Z",
            "updated_at": "2025-03-27T02:02:09.788953Z",
            "deleted_at": null,
            "main_name": "Boss Spider",
            "aliases": [
                "Boss Spider",
                "CTG-0007",
                "Gold Lowell"
            ],
            "source_name": "ETDA:Boss Spider",
            "tools": [
                "Mimikatz",
                "PsExec",
                "SDelete",
                "SamSam",
                "Samas"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4116df25-aff6-46ee-a5dd-926254a78e89",
            "created_at": "2023-01-06T13:46:38.894033Z",
            "updated_at": "2025-03-27T02:00:02.94496Z",
            "deleted_at": null,
            "main_name": "BOSS SPIDER",
            "aliases": [
                "GOLD LOWELL"
            ],
            "source_name": "MISPGALAXY:BOSS SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1b20199b-07ae-42f1-ad22-bbe2dd471df8",
            "created_at": "2024-06-04T02:03:07.872554Z",
            "updated_at": "2025-03-27T02:05:17.383011Z",
            "deleted_at": null,
            "main_name": "GOLD LOWELL",
            "aliases": [
                "CTG-0007 ",
                "Boss Spider "
            ],
            "source_name": "Secureworks:GOLD LOWELL",
            "tools": [
                "Samas"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e3676dfe-3d40-4b3a-bfbd-4fc1f8c896f4",
            "created_at": "2022-10-25T15:50:23.808974Z",
            "updated_at": "2025-03-27T02:00:55.550912Z",
            "deleted_at": null,
            "main_name": "Magic Hound",
            "aliases": [
                "Magic Hound",
                "TA453",
                "COBALT ILLUSION",
                "Charming Kitten",
                "ITG18",
                "Phosphorus",
                "APT35",
                "Mint Sandstorm"
            ],
            "source_name": "MITRE:Magic Hound",
            "tools": [
                "Impacket",
                "CharmPower",
                "FRP",
                "Mimikatz",
                "Systeminfo",
                "ipconfig",
                "netsh",
                "PowerLess",
                "Pupy",
                "DownPaper",
                "PsExec",
                "Havij",
                "sqlmap"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1699fb41-b83f-42ff-a6ec-984ae4a1031f",
            "created_at": "2022-10-25T16:07:23.83826Z",
            "updated_at": "2025-03-27T02:02:09.995863Z",
            "deleted_at": null,
            "main_name": "Magic Hound",
            "aliases": [
                "APT 35",
                "Ballistic Bobcat",
                "Charming Kitten",
                "CharmingCypress",
                "Cobalt Illusion",
                "Cobalt Mirage",
                "Educated Manticore",
                "Magic Hound",
                "Mint Sandstorm",
                "Operation BadBlood",
                "Operation Sponsoring Access",
                "Operation SpoofedScholars",
                "Operation Thamar Reservoir",
                "Phosphorus",
                "TA453",
                "TEMP.Beanie",
                "Tarh Andishan",
                "Timberworm",
                "TunnelVision",
                "UNC788",
                "Yellow Garuda"
            ],
            "source_name": "ETDA:Magic Hound",
            "tools": [
                "7-Zip",
                "AnvilEcho",
                "BASICSTAR",
                "CORRUPT KITTEN",
                "CWoolger",
                "CharmPower",
                "ChromeHistoryView",
                "CommandCam",
                "DistTrack",
                "DownPaper",
                "FRP",
                "Fast Reverse Proxy",
                "FireMalv",
                "Ghambar",
                "GoProxy",
                "GorjolEcho",
                "HYPERSCRAPE",
                "Havij",
                "MPK",
                "MPKBot",
                "Matryoshka",
                "Matryoshka RAT",
                "MediaPl",
                "Mimikatz",
                "MischiefTut",
                "NETWoolger",
                "NOKNOK",
                "PINEFLOWER",
                "POWERSTAR",
                "PowerLess Backdoor",
                "PsList",
                "Pupy",
                "PupyRAT",
                "SNAILPROXY",
                "Shamoon",
                "TDTESS",
                "WinRAR",
                "WoolenLogger",
                "Woolger",
                "pupy",
                "sqlmap"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536018,
    "ts_updated_at": 1743041630,
    "ts_creation_date": 1653616868,
    "ts_modification_date": 1653616868,
    "files": {
        "pdf": "https://archive.orkl.eu/3403529c99ceb62ad8869093aa57a914a8c81e48.pdf",
        "text": "https://archive.orkl.eu/3403529c99ceb62ad8869093aa57a914a8c81e48.txt",
        "img": "https://archive.orkl.eu/3403529c99ceb62ad8869093aa57a914a8c81e48.jpg"
    }
}