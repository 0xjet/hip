{
    "id": "1e79029d-c016-4e6d-9157-d57b13b9b8fa",
    "created_at": "2023-01-12T14:59:36.338182Z",
    "updated_at": "2025-03-27T02:09:18.146827Z",
    "deleted_at": null,
    "sha1_hash": "549bc415a0dc2e3fe6394be4344a79015a38b120",
    "title": "2021-09-30 - Hunting for the Confluence Exploitation- When Falcon OverWatch Becomes the First Line of Defense",
    "authors": "",
    "file_creation_date": "2022-05-28T23:16:21Z",
    "file_modification_date": "2022-05-28T23:16:21Z",
    "file_size": 910790,
    "plain_text": "# How CrowdStrike Threat Hunters Identified a Confluence Exploit\n\n**[crowdstrike.com/blog/how-crowdstrike-threat-hunters-identified-a-confluence-exploit/](https://www.crowdstrike.com/blog/how-crowdstrike-threat-hunters-identified-a-confluence-exploit/)**\n\nFalcon OverWatch Team September 30, 2021\n\nToday’s security defenders are faced with a continuously evolving battleground. The number\nof security vulnerabilities uncovered annually has grown every year for the past four years.\nMoreover, adversaries’ ability to rapidly weaponize these vulnerabilities continues to\nimprove.\n\nIn particular, vulnerabilities affecting ubiquitous software, such as productivity applications\nand collaboration software, are likely to be met with a rapid response from adversaries eager\nto exploit the vulnerabilities during a short window of opportunity.\n\nWith the announcement of vulnerabilities — like the latest affecting Confluence collaboration\nsoftware — the clock is ticking for vendors to issue software updates, for customers to patch\nthe impacted software, and for defenders to quickly identify and close the window of\nopportunity. And [threat hunting — usually the last line of defense — becomes the first line of](https://www.crowdstrike.com/cybersecurity-101/threat-hunting/)\ndefense in the face of novel threats and zero-day exploitation.\n\n## Falcon OverWatch Defends Against New Confluence Vulnerability\n\n\n-----\n\nOn Aug. 25, 2021, Atlassian — the makers of Confluence — published a security advisory\nabout a remote code execution (RCE) vulnerability, [CVE-2021-26084. Immediately,](https://confluence.atlassian.com/doc/confluence-security-advisory-2021-08-25-1077906215.html)\n[CrowdStrike Falcon OverWatch™ threat hunters began investigating for indications that this](https://www.crowdstrike.com/endpoint-security-products/falcon-overwatch-threat-hunting/)\nthreat was impacting customers. By Aug. 28, 2021, threat hunters found evidence that this\nConfluence vulnerability was weaponized and being actively exploited by known threat\nactors.\n\nThe speed with which threat actors were able to operationalize this particular exploit for\ntargeted outcomes was unsurprising, especially considering the potential threat this\nvulnerability raised. Beginning on Sept. 1, 2021, OverWatch observed a substantial increase\nin the compromise of vulnerable Linux-based Confluence servers that were exploited by\nopportunistic actors.\n\nShortly after observing the uptick in Linux server compromises, OverWatch observed the\nrapid shift to Windows-based servers, broadening the reach of the exploitation. The\nobserved increase in active exploitation against unrelated industry verticals signaled to\nOverWatch a shift from targeted intrusion activity to more opportunistic eCrime activity.\n\nOverWatch was able to identify the early stages of this vulnerability being exploited by\ntracking malicious behaviors including decoding and execution of scripts, a mechanism to\nevade known technology-based defenses. Over subsequent days, OverWatch saw multiple\nopportunistic actors exploit the vulnerability to place webshells for persistence by writing and\ndecoding a Base64-encoded string to a file in the `confluence directory. Once the`\nvulnerability was operationalized and widely understood, OverWatch quickly observed\nmultiple adversaries adopt this exploit to gain initial access, then later deploy tools like\n[Cobalt Strike, additional webshells to attempt to achieve persistence, and commodity coin](https://www.crowdstrike.com/blog/getting-the-bacon-from-cobalt-strike-beacon/)\n[miners and commodity malware.](http://crowdstrike.com/cybersecurity-101/malware/)\n\n(Click to enlarge)\n\n\n-----\n\nBy this time, though, OverWatch was already ahead, having proactively worked to develop\nbehavioral-based preventions, as well as update and strengthen existing preventions, to\nreduce the efficacy of eCrime threat actors against their intended targets.\n\n**Timeline of Events**\n\n**AUG 25: Confluence Security Advisory and patch released.**\n**AUG 28: Targeted intrusion attempts observed against a small number of customers. The**\nthreat actor performed hands-on-keyboard operations consistent with data exfiltration\nobjectives.\n\n**AUG 29: OverWatch, working with the CrowdStrike Intelligence team, developed**\nbehavioral-based preventions and increased visibility of indicators of attack (IOAs) and\nindicators of compromise (IOCs).\n\n**AUG 31: Exploit code released, weaponized and widely made public**\n\n**SEPT 1: OverWatch observed a steady increase in attempted Linux-based exploitation.**\n\nSeveral hours later, OverWatch observed a significant increase in attempted exploitation\nconsistent with cryptojacking objectives.\n\nWindows systems become targets of the vulnerability, and OverWatch detected an uptick\nin attempted cryptojacking activity on vulnerable hosts.\n\n**SEPT 2 TO PRESENT: eCrime threat actors continue to use scripting or automation to**\nsearch for and exploit vulnerable systems.\n\nOverWatch has a rich bank of highly curated hunting leads based on a deep understanding\nof adversary behaviors and motivations, intelligence-derived insights, and statistical analysis.\nThe speed and precision with which OverWatch can identify malicious activity allow threat\nhunters to rapidly notify customers of potential hands-on-keyboard activity, allowing them to\n“close the window of opportunity” for threat actors to be successful.\n\n## How You Can Protect Your Organization\n\nThe speed with which threat actors were able to weaponize the Confluence vulnerability is a\nreminder that threat actors are extremely active and highly motivated in their attempts to gain\naccess into networks. OverWatch threat hunters suggest the following to harden your cyber\ndefenses against such exploitation:\n\n\n-----\n\n**Patch vulnerable systems quickly. Patching is the best defense against exploitation.**\nOf the Confluence exploitation activity observed by OverWatch, 97% of attempts at\nexploitation occurred seven days or more after the patch was released, underscoring\nthe importance of timely patching. To ensure unpatched customers were not left\nexposed, CrowdStrike released preventions to the CrowdStrike Falcon console toⓇ\nblock malicious activity. However, the most effective course of action is still for an\norganization to patch their own applications quickly. Instituting a process through which\nsystems are regularly scanned for known vulnerabilities and patched shortens the\nwindow in which your organization can be compromised.\n**Employ threat hunting to find what autonomous defenses can miss. No**\ntechnology is 100% effective at blocking determined intruders.This is especially true for\n[zero-day exploits or novel tradecraft. Expert threat hunters complement and augment](https://www.crowdstrike.com/cybersecurity-101/zero-day-exploit/)\ntechnology-based defenses by continuously hunting for known malicious behaviors to\ndetect and disrupt intrusions at whatever hour of day they may strike.\n\n**Additional Resources**\n\n_Read about the latest trends in threat hunting and more in the 2021 Threat Hunting_\n_Report or simply_ _[download the report now.](https://www.crowdstrike.com/resources/reports/threat-hunting-report-2021/)_\n_[Learn more about Falcon OverWatch proactive managed threat hunting.](https://www.crowdstrike.com/endpoint-security-products/falcon-overwatch-threat-hunting/)_\n_[Watch this video to see how Falcon OverWatch proactively hunts for threats in your](https://www.crowdstrike.com/resources/videos/falcon-overwatch-proactively-hunts-threats-environment/)_\n_environment._\n_[Read more about how hunting part-time is simply not enough in this CrowdStrike blog.](https://www.crowdstrike.com/blog/the-myth-of-part-time-threat-hunting-part-1/)_\n_[Learn more about the CrowdStrike Falcon® platform by visiting the product webpage.](https://www.crowdstrike.com/endpoint-security-products/falcon-platform/)_\n_[Test CrowdStrike next-gen AV for yourself. Start your free trial of Falcon Prevent™](https://go.crowdstrike.com/try-falcon-prevent.html)_\n_today._\n_[Learn more on how Falcon Spotlight™ can help you discover and manage](https://www.crowdstrike.com/endpoint-security-products/falcon-spotlight-vulnerability-management/)_\n_vulnerabilities in your environments._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-09-30 - Hunting for the Confluence Exploitation- When Falcon OverWatch Becomes the First Line of Defense.pdf"
    ],
    "report_names": [
        "2021-09-30 - Hunting for the Confluence Exploitation- When Falcon OverWatch Becomes the First Line of Defense.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535576,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653779781,
    "ts_modification_date": 1653779781,
    "files": {
        "pdf": "https://archive.orkl.eu/549bc415a0dc2e3fe6394be4344a79015a38b120.pdf",
        "text": "https://archive.orkl.eu/549bc415a0dc2e3fe6394be4344a79015a38b120.txt",
        "img": "https://archive.orkl.eu/549bc415a0dc2e3fe6394be4344a79015a38b120.jpg"
    }
}