{
    "id": "040335e5-3a64-4378-9468-ba46b3bf7d62",
    "created_at": "2023-01-12T15:06:26.150168Z",
    "updated_at": "2025-03-27T02:16:25.651057Z",
    "deleted_at": null,
    "sha1_hash": "69af5f991b11960bd9ed35af95f60c7dee03efbd",
    "title": "2022-01-28 - Indian Army Personnel Face Remote Access Trojan Attacks",
    "authors": "",
    "file_creation_date": "2022-05-27T23:06:27Z",
    "file_modification_date": "2022-05-27T23:06:27Z",
    "file_size": 1502898,
    "plain_text": "# Indian Army Personnel Face Remote Access Trojan Attacks\n\n**[blog.cyble.com/2022/01/28/indian-army-personnel-face-remote-access-trojan-attacks/](https://blog.cyble.com/2022/01/28/indian-army-personnel-face-remote-access-trojan-attacks/)**\n\nJanuary 28, 2022\n\n[Cyble Research Labs has come across a Twitter post wherein security researchers have brought to focus an](https://twitter.com/malwrhunterteam/status/1484966581620949005?t=BYJqgYYpCCNe_9v6uwMuCg&s=19)\nAndroid malware that pretends to be the legitimate ARMAAN application. The Army Mobile Aadhaar App\n[Network (ARMAAN) is an umbrella application covering various facets of information & services concerning](https://armaan.gov.in/)\nall ranks of the Indian Army, and the app is used only by Indian Army personnel. Threat Actors (TAs) have\ncustomized the legitimate ARMAAN app and added malicious code into it.\n\nDuring our analysis, we observed that this malicious application uses the icon, name, and even source code\nof the legitimate ARMAAN app. To create this malicious application, attackers have added an extra package\nin the legitimate application’s source code to enable it to perform RAT activities.\n\nFrom our analysis, we concluded that upon successful execution, this malicious application could steal\nsensitive data such as contacts, call logs, SMSes, location, files from external storage, record audio, etc.,\nfrom the victims’ devices.\n\nRecently Cyble Research Labs has come across another malicious android app disguised as HAMRAAZ.\nThe HAMRAAZ is an android application developed for Indian Army Personnel. The TAs have added\nmalicious packages into the HAMRAAZ app.\n\n\n-----\n\nWe analyzed the malicious sample of the HAMRAAZ Android app and identified that the malicious package\nused in ARMAAN and HAMRAAZ is the same. Therefore we can conclude that the Threat Actors (TAs)\nbehind both malware are the same.\n\nIn this section, we have provided details of malicious HAMRAAZ app:\n**c0a3a2401b966c1fb73453c5675ff7da2ef777ab040ff9af5ffdbb79dbeb425c**\n\nWe observed the malicious HAMRAAZ app uses Pastebin URL: hxxps://pastebin[.]com/rA219A98 to\ncommunicate with the C&C IP: 173[.]212.254.151 as shown in the below figure.\n\nFigure 1 – C&C\n\nCommunication via Pastebin\n\n## Technical Analysis\n\n### APK Metadata Information\n\nApp Name: ARMAAN\nPackage Name: in.gov.armaan\nSHA256 Hash: 80c0d95fc2d8308d70388c0492d41eb087a20015ce8a7ea566828e4f1b5510d0\n\nFigure 2 shows the metadata information of the application.\n\nFigure 2 – App Metadata Information\nThe below figure shows the application icon and name displayed on the Android device.\n\n\n-----\n\nFigure 3 – App Icon and Name\n\nThe malware requests for Aadhar numbers, which is also a feature of the legitimate ARMAAN application, as\nshown in the figure below.\n\n\n-----\n\nFigure 4 – App Requests KYC Documents\n\nWhen the user inputs the AADHAAR number, the malware communicates with the official ARMAAN server to\nverify the account, as shown below.\n\nFigure 5 – App Communicates to Legitimate Server\nOn comparing the legitimate ARMAAN application and the modified malicious ARMAAN application, we\nidentified that the TAs have added an extra package containing malicious code, as shown in the figure below.\n\n\n-----\n\nFigure 6 –\n\nAdded Source Code Package in Malicious App\n\n## Manifest Description\n\nThe malware requests the user for 22 different permissions. Out of these, it abuses ten permissions. These\ndangerous permissions are listed below.\n\n**Permissions** **Description**\n\nREAD_SMS Access SMSes in the device database (DB).\n\nRECEIVE_SMS Intercept SMSes received on the victim’s device\n\nREAD_CALL_LOG Access Call Logs\n\nREAD_CONTACTS Access phone contacts.\n\nREAD_PHONE_STATE Allows access to phone state, including the current cellular\nnetwork information, the phone number and the serial number of\nthe phone, the status of any ongoing calls, and a list of any\nPhone Accounts registered on the device.\n\nRECORD_AUDIO Allows the app to record audio with the microphone, which the\nattackers can misuse.\n\nACCESS_COARSE_LOCATION Allows the app to get the approximate location of the device\nnetwork sources such as cell towers and Wi-Fi.\n\nACCESS_FINE_LOCATION Allows the app to get the device’s precise location using the\nGlobal Positioning System (GPS).\n\nACCESS_BACKGROUND_LOCATION Allows an app to access location in the background.\n\nACCESS_WIFI_STATE Allows the app to get information about Wi-Fi connectivity.\n\nWe observed added services and receivers entries in the manifest file of the malicious app, as shown in\nFigure 7.\n\n\n-----\n\nFigure 7 – Added Entries in Manifest\nIt is also observed in the manifest that the TAs have added dangerous permissions entries such as\nREAD_CONTACTS, READ_CALL_LOG, RECORD_AUDIO, ACCESS_COARSE_LOCATION, etc. in\nmodified malicious ARMAAN applications.\n\nFigure 8\n\n– Added Permissions Entry in Malicious APP\n\n## Source Code Review\n\nOur static analysis indicated that the malware steals sensitive data such as Contacts, SMSes, and Call logs,\nbesides recording audio and taking pictures from the camera, etc., on commands from the C&C.\n\nThe malware uses a fixed hardcoded array containing the IP’s ASCII values: 173[.]212.220.230 and port:\n_3617 Details. The malware then converts and uses them for its C&C communication, as shown in Figure 9._\n\n\n-----\n\nFigure 9 – Malware\n\nCommunication\nThe getAlluserInfo() method has been used to collect the user’s device information such as phone number,\ndevice manufacturer’s details, etc., from the device, as shown in Figure 10.\n\nFigure 10 – Collects User’s Information\n\n\n-----\n\nThrough the getAllSMS() method, we identified that the malware collects SMSs data from the device, as\nshown in the below figure.\n\nFigure 11 – Code to Collect SMSs\nThe method getAllContacts() has been used to collect Contacts data from the device, as shown below.\n\nFigure 12 – Code to Collect Contacts Data\nMethod getAllCallLogs() depicts the malware’s ability to collect Call logs data from the device. Refer to Figure\n13.\n\nFigure 13 – Code to Collect Call logs\nThe code snippet shown in the below image depicts the malware’s ability to collect the device’s location data\nfrom the device.\n\nFigure 14 Collects Location Data from the Device\n\n\n-----\n\nThe image shown below showcases the malware s code that collects and sends images from the WhatsApp\ndirectory in the device to the server on commands from the TAs.\n\nFigure 15 – Steals Images from WhatsApp Directory\nThe method sentMicRecording() shown in the below image depicts the malware’s ability to record mic and\nsend the recorded data to the server on the TAs command. After the data is sent, the malware deletes the\nfile.\n\nFigure 16 – Records Mic\nThe below figure represents the malware’s ability to capture images from the front and back camera and\nsend the recorded data to the server on the TAs command.\n\nFigure 17 – Capture Images from Front and Back Camera\nThe malware collects the document files from the device through the remainingDocumentFiles() method\nshown in the figure below.\n\nFigure 18 – Code to Collect Document Files\n\n\n-----\n\nBelow are the commands used by the TA to control the infected device:\n\n**Command** **Description**\n\nD%r6t* Get SMS data\n\ns%7n@2 Get Contacts data\n\ni*g4#3 Get Call logs data\n\nO@y7J& Start mic recording\n\n5w$I!7 Get document files\n\n1^R$4t Get images from the WhatsApp folder\n\nj*7e@4 Click photos from the device camera\n\nA website with the domain name hxxps://armaanapp[.]in was registered around a year ago. It seems that TAs\nused this website to deliver malicious versions of the ARMAAN application, as shown in the below figure\nbelow.\n\nFigure 19 – Fake Website\n\n## Conclusion\n\nThe modified, malicious ARMAAN and HAMRAAZ apps pose a serious threat to the Indian Armed Forces. It\ncan perform RAT activities with the potential to steal Indian Army personnel’s sensitive data, including\ncontacts, call logs, SMSs, Location, and files from external storage, in addition to the ability to record\nsensitive audio.\n\nTAs constantly adapt their methods to avoid detection and find new ways to target users through increasingly\nsophisticated techniques. Such malicious applications often masquerade as legitimate applications to trick\nusers into installing them. This situation makes it imperative for users to install applications only after verifying\ntheir authenticity. Apps should only be installed exclusively via the official Google Play Store and other trusted\nportals to avoid such attacks.\n\n## Our Recommendations\n\nWe have listed some essential cybersecurity best practices that create the first line of control against\nattackers. We recommend that our readers follow the best practices given below:\n\n## How to prevent malware infection?\n\nDownload and install software only from official app stores like Google Play Store or the iOS App Store.\nUse a reputed anti-virus and internet security software package on your connected devices, such as\nPCs, laptops, and mobile devices.\nUse strong passwords and enforce multi-factor authentication wherever possible.\n\n\n-----\n\nEnable biometric security features such as fingerprint or facial recognition for unlocking the mobile\ndevice where possible.\nBe wary of opening any links received via SMS or emails delivered to your phone.\nEnsure that Google Play Protect is enabled on Android devices.\nBe careful while enabling any permissions.\nKeep your devices, operating systems, and applications updated.\n\n## How to identify whether you are infected?\n\nRegularly check the Mobile/Wi-Fi data usage of applications installed in mobile devices.\nKeep an eye on the alerts provided by Anti-viruses and Android OS and take necessary actions\naccordingly.\n\n## What to do when you are infected?\n\nDisable Wi-Fi/Mobile data and remove SIM card – as in some cases, the malware can re-enable the\nMobile Data.\nPerform a factory reset.\nRemove the application in case a factory reset is not possible.\nTake a backup of personal media Files (excluding mobile applications) and perform a device reset.\n\n## What to do in case of any fraudulent transaction?\n\nIn case of a fraudulent transaction, immediately report it to the concerned bank.\n\n## What should banks do to protect their customers?\n\nBanks and other financial entities should educate customers on safeguarding themselves from malware\nattacks via telephone, SMSs, or emails.\n\n## MITRE ATT&CK® Techniques\n\n**Tactic** **Technique ID** **Technique Name**\n\n**Initial Access** [T1476](https://attack.mitre.org/versions/v7/techniques/T1476/) Deliver Malicious App via Other Mean.\n\n**Initial Access** [T1444](https://attack.mitre.org/versions/v7/techniques/T1444) Masquerade as Legitimate Application\n\n**Execution** [T1575](https://attack.mitre.org/versions/v7/techniques/T1575/) Native Code\n\n**Collection** [T1433](https://attack.mitre.org/techniques/T1433) Access Call Log\n\n**Collection** [T1412](https://attack.mitre.org/techniques/T1412) Capture SMS Messages\n\n**Collection** [T1432](https://attack.mitre.org/techniques/T1432) Access Contact List\n\n**Collection** [T1429](https://attack.mitre.org/techniques/T1429) Capture Audio\n\n**Collection** [T1512](https://attack.mitre.org/techniques/T1512) Capture Camera\n\n**Collection** [T1533](https://attack.mitre.org/techniques/T1533) Data from Local System\n\n**Collection** [T1430](https://attack.mitre.org/techniques/T1430) Location Tracking\n\n\n-----\n\n**Command and Control** [T1436](https://attack.mitre.org/techniques/T1436) Commonly Used Ports\n\n## Indicators of Compromise (IOCs)\n\n**Indicators** **Indicator**\n**Type**\n\n\n**Description**\n\n\n**80c0d95fc2d8308d70388c0492d41eb087a20015ce8a7ea566828e4f1b5510d0** SHA256 Malicious\nARMAAN APK\n\n\n**173[.]212.220.230:3617** IP\nAddress\n\n**hxxps://pastebin[.]com/VfRCefzG** Pastebin\nURL\n\n\nMalware\nCommunication\nIP\n\nUsed to\nprovide C&C IP\nto Malicious\nARMAAN App\n\n\n**c0a3a2401b966c1fb73453c5675ff7da2ef777ab040ff9af5ffdbb79dbeb425c** SHA256 Malicious\nHAMRAAJ\nAPK\n\n\n**173[.]212.254.151** IP\nAddress\n\n**hxxps://pastebin[.]com/rA219A98** Pastebin\nURL\n\n\nMalware\nCommunication\nIP\n\nUsed to\nprovide C&C IP\nto Malicious\nHAMRAAZ App\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-28 - Indian Army Personnel Face Remote Access Trojan Attacks.pdf"
    ],
    "report_names": [
        "2022-01-28 - Indian Army Personnel Face Remote Access Trojan Attacks.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535986,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1653692787,
    "ts_modification_date": 1653692787,
    "files": {
        "pdf": "https://archive.orkl.eu/69af5f991b11960bd9ed35af95f60c7dee03efbd.pdf",
        "text": "https://archive.orkl.eu/69af5f991b11960bd9ed35af95f60c7dee03efbd.txt",
        "img": "https://archive.orkl.eu/69af5f991b11960bd9ed35af95f60c7dee03efbd.jpg"
    }
}