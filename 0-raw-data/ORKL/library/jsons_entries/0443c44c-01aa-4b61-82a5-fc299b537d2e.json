{
    "id": "0443c44c-01aa-4b61-82a5-fc299b537d2e",
    "created_at": "2023-01-12T15:02:59.48213Z",
    "updated_at": "2025-03-27T02:09:18.453Z",
    "deleted_at": null,
    "sha1_hash": "438046d3da4ba27a56af904db2a5b75ad57f590c",
    "title": "2022-10-07 - A Visualizza into Recent IcedID Campaigns- Reconstructing Threat Actor Metrics with Pure Signal™ Recon",
    "authors": "",
    "file_creation_date": "2022-10-23T13:14:00Z",
    "file_modification_date": "2022-10-23T13:14:00Z",
    "file_size": 634682,
    "plain_text": "# A Visualizza into Recent IcedID Campaigns:\n\n**[team-cymru.com/post/a-visualizza-into-recent-icedid-campaigns](https://www.team-cymru.com/post/a-visualizza-into-recent-icedid-campaigns)**\n\nS2 Research Team October 7, 2022\n\n## Reconstructing Threat Actor Metrics with Pure Signal™ Recon\n\n### Introduction\n\n\n-----\n\nIcedID (also known as BokBot) started life in early 2017 as a banking trojan that later\nevolved to include dropper malware capabilities. These capabilities enable IcedID to\ndownload and deploy additional malware like Cobalt Strike, with recent infections leading to\nQuantum ransomware. Cybersecurity professionals should continue to pay attention to\nIcedID as it remains one of the top dropper malware in the threat landscape and has no\nsigns of slowing down. It is typically delivered via email spamming campaigns, with new\ncampaigns being delivered on a near-daily basis that leverage an assortment of different lure\ntypes and execution processes.\n\nThis got us curious - how do different campaigns compare to each other? We’ve extensively\ntracked IcedID C2 infrastructure using our Recon and BARS (Botnet Analysis and Reporting\nService) feed tooling, and using this data we were able to peek behind the scenes at metrics\nthat are possibly similar to what the threat actors are tracking themselves.\n\n### C2 Tracking\n\n[We’ve previously written about IcedID Stage 2 Tier 1 (T1) and Tier 2 (T2) C2 infrastructure](https://www.team-cymru.com/post/tracking-bokbot-icedid-infrastructuremapping-a-vast-and-currently-active-icedid-network)\nand threat telemetry, which pertains to bot activity that occurs after IcedID has successfully\ninfected a machine. In this post, our focus is on the Stage 1 T1 C2s that initially load the\nmalware onto a victim’s machine after they perform the action being asked of them in the\nlure, such as ‘enable macros’ or ‘click a disguised shortcut’.\n\n**Registration**\n\nUntil 21 September 2022 and dating back to at least two months, domains used as Stage 1\ndownloader C2s were registered with 1337 Services LLC Hosting (connected to the Njalla\nhosting service) and parked there for an average of 31 days before use as a C2. This\nprocess was possibly developed for the circumvention of firewall blocks against newly\nregistered domains. As of 22 September 2022, however, domains used as C2s have been\nregistered only a few days prior, breaking this long-term pattern.\n\n**C2 Assignment**\n\nEither the day before or the day of a campaign, a C2 domain is assigned to a new IP that is\nused for inbound victim traffic on port 80 and for T1 -> T2 communications. Communication\nwith the T2 C2 generally begins the same day the campaign is released.\n\n\n-----\n\nAccording to our C2 tracking data for the August-September 2022 timeframe, domains and\nIPs are typically only used for one campaign and not recycled. In mid-September there were\na few instances where downloader IPs and domains were reused, but as of the end of\nSeptember, C2s have returned to being unique / single-use.\n\n**C2 Lifespan**\n\nC2 communication with T2 infrastructure occurs for an overall average of six days before\nending, and four or five C2 IPs are normally active at a time. Although, around the third week\nof September active C2s dwindled down to two from the usual amount due to IPs and\ndomains being reused between campaigns, which prevented aged-out C2s from being\nreplaced. In most cases, no changes are made regarding the IP or domain once it’s inactive.\nAll but one of the C2 domains from the campaigns we analyzed were still assigned to the\nsame IPs at the time of writing.\n\n### Campaign Metrics\n\n\n-----\n\nUsing the C2s we ve gathered from tracking IcedID infrastructure, we analyzed data from\ncampaigns that were spammed during the period 13 - 21 September 2022 to see if there was\na correlation between TTPs and the volume of victim interaction.\n\nIn order to identify potential traffic, we had to remove general noise, as well as security\nresearch traffic from our data. This process includes enrichment with supplementary open\nsource data such as WHOIS information. The numbers provided throughout this blog are\nbased on an approximation derived from sampled threat telemetry.\n\n**Delivery Methods**\n\nOf the campaigns analyzed, the following methods were used for malware delivery:\n\n**Password Protected ZIP -> ISO -> LNK -> JS -> [CMD or BAT] -> DLL**\n\nDelivery was via a password protected zip file that contained an ISO which itself contained a\nLNK file and archive holding the files used for IcedID installation. When the LNK file is\nclicked by the user, it functions as a shortcut to run a script within the archive that ultimately\ninstalls IcedID from a DLL. It is typically launched through either a CMD or BAT script,\ndepending on which was included in the archive.\n\n**Password Protected ZIP -> ISO -> CHM -> DLL**\n\nDelivery was via a password protected zip file containing an ISO that led to a CHM\n(Compiled HTML) file. The victim must open the file to launch the DLL and complete the\ninfection process.\n\n**Maldoc**\n\nUsers received either a malicious Word or Excel file that asked them to enable macros,\nwhich then allowed the embedded script to execute and install IcedID.\n\n**PrivateLoader**\n\n\n-----\n\nDelivery was through PrivateLoader, a pay-per-install service that distributes malware by\nhiding it in free software downloaded by unsuspecting users.\n\n________________________________________\n\n### 13 September\n\nThere were two campaigns launched; one targeting Italian speakers (project ID 3281798692)\nand the other targeting English speakers (project ID 726442267).\n\nThe Italian lure was in the form of a malicious ‘.docm’ file with kolinandod[.]com as the C2,\nwhich was set to resolve to 159.203.5[.]238 on 12 September.\n\nThere were around 18 potential victims and most of the victim communication occurred the\nsame day of the campaign. The C2 stopped interacting with the T2 on 19 September.\n\nThe lure targeting English speakers arrived using the following delivery method:\n\n\n-----\n\n**Password Protected ZIP -> ISO -> LNK -> JS -> BAT -> DLL**\n\nThe C2 was qvantumbrakesz[.]com, which resolves to 134.209.97[.]90.\n\nThere were around 115 potential victims that communicated with the C2 before it was\ndisconnected from the T2 on 20 September. Most of this traffic occurred on the day of the\ncampaign and tapered off until the last victim hit it on 19 September.\n\n________________________________________\n\n### 14 September\n\nFor the campaign on 14 September (project ID 809191839), threat actors returned to\nleveraging CHM files for the delivery method:\n\n**Password Protected ZIP -> ISO -> CHM -> DLL**\n\n\n-----\n\n**Note: The use of CHMs was first spotted in a IcedID campaign on 8 August 2022, but**\n**the use of this file-type maliciously is a technique that has been around for several**\n**years.**\n\nThe C2 was allozelkot[.]com and was set to resolve to 188.166.169[.]40 on the day of the\ncampaign. There were around 18 unique victims with the last connections occurring on the\n19th. The C2 stopped communicating with the T2 on 22 September.\n\n________________________________________\n\n### 15-16 September\n\nBoth the 15 September and 16 September campaign used pildofraften[.]com as their C2.\nThis domain has resolved to the same IP address (142.93.44[.]94) since 15 September.\nSeeing domains and IPs reused for Stage 2 bot C2s is not uncommon, but this is the first\ncase of a Stage 1 downloader C2 reusing either since at least mid-August 2022.\n\nThe campaign on September 15 (project ID 612758225) used the delivery method:\n\n\n-----\n\n**Password Protected ZIP -> ISO -> LNK -> JS -> BAT -> DLL**\n\nThe second campaign (project ID 3747825559), seen on 16 September, was delivered as an\nEXE dropped by PrivateLoader.\n\nThere were around 79 potential victims and most of them first communicated with the C2 on\n16 September. The last victim requests to the C2 occurred 19 September and traffic with the\nT2 ended 22 September.\n\n________________________________________\n\n### 19 Sep\n\nThe campaign that occurred on 19 September (project ID 775636601) was a bit of an outlier\ncompared to the others we’ve looked at so far. Delivery consisted of a password protected\nzip file containing an ISO:\n\n\n-----\n\n**Password Protected Zip -> ISO -> LNK -> DLL**\n\nThe C2 was aviadronazhed[.]com, which was updated to resolve to 67.205.169[.]96 on the\nday of the campaign. Inbound port 80 traffic began at around 15:00 UTC and continued for\nabout three hours for a total of five potential victims. T2 traffic began about two and half\nhours after the victim traffic (17:30 UTC) and lasted around two and half hours after the last\nport 80 request (20:30 UTC). Oddly, the C2 was then disconnected from the T2 instead of\ncontinuing to communicate for the usual period of approximately six days.\n\nAnother oddity was that unlike other C2s where domains remained on the same IPs at the\nconclusion of a campaign, this domain was updated and removed from 67.205.169[.]96 on\n22 September.\n\n________________________________________\n\n### 20-21 September\n\nThree campaigns occurred during the period 20 - 21 September and each had a unique\ndomain that resolved to the same IP (161.35.110[.]54). The IP was reused between domains\nsimilarly to the 15 - 16 September campaigns, except in this case the domains were unique.\n\nThere was one campaign seen on 20 September (project ID 512092511) with\nalkaliodplus[.]com as its C2. For delivery it used a password protected zip file and ISO:\n\n**Password Protected ZIP -> ISO -> LNK -> BAT -> DLL**\n\nTwo campaigns were seen on 21 September, each with a unique project ID and domain:\nnikolandfantazy[.]com (project ID 1367965656) and zalikomanperis[.]com (project ID\n2432960414). The delivery was via a password protected zip containing an ISO:\n\n\n-----\n\n**Password Protected ZIP -> ISO -> LNK -> JS -> CMD -> DLL**\n\nThere were 29 potential victims from when the C2 was active between 20 - 27 September,\nwith the last communication from a unique IP on port 80 happening on the 26 September.\nOnly two victims hit the C2 on 20 September and most of the traffic began on 21 September\nbefore gradually tapering off.\n\n________________________________________\n\n### Bonus Bloopers!\n\nThese campaigns fell outside of the timeframe we were focusing on but due to their\npeculiarities we thought it would be interesting to add for comparison.\n\n### 9 September\n\nThe lure for this campaign (project ID 3207262051) was meant to be an XLSM file for\nEnglish-speakers, but the threat actors used the Italian word for “View” on the button they\nwanted to convince users to click.\n\n\n-----\n\n_Figure 1 – Screenshot from Hatching Triage_\n\nThe C2 for this campaign was audifastinggip[.]com and it began resolving to 143.198.178[.]0\non 9 September.\n\n\n-----\n\nUntil 13 September around 12 potential victims were curious enough to click the “Visualizza”\nbutton, and communication with the T2 ended on 15 September.\n\n### 22-23 September\n\nIt appears a key component of the process may have been skipped when setting up the C2\non 22 September (project ID 1023645195). The C2 was trallfasterinf[.]com, and it resolves to\n137.184.114[.]20. Unlike the other C2s we’ve tracked which were registered an average of\n31 days prior to being used in a campaign, this domain was the first to be registered only one\nday before it was a C2. It was assigned to this IP the day of the campaign, which is normal,\nbut T2 communications appear to have never been set up. Potential victim traffic is hitting\nthe C2, but it goes nowhere.\n\nThe C2 for 23 September (project ID 2349072319) was sebdgoldingor[.]com, and it also\nresolves to 137.184.114[.]20. Reusing IPs for these C2s is a new behavior which occurred\ntwice in the same week. It was also registered with Njalla on 21 September, two days prior.\nInterestingly, T2 communications were still not set up when this second campaign launched.\nTwo campaigns seen the following Monday on 26 September contained the expected T2\ntraffic, so it appears the threat actors may have had a bit of a mishap with 137.184.114[.]20.\n\n\n-----\n\n### Analysis/Key Findings\n\n**GEO Targeting**\n\nThe 13 September campaign targeting Italian speakers resulted in 18 potential victims. It\nwas also the only campaign from our timeframe using a malicious Word document as the\ndelivery method, which makes a true comparison difficult. The campaign that leveraged a\nCHM file along with an English-lure also had 18 potential victims. It’s probable that the target\nbase for this campaign was larger than that aimed at Italian speakers (based on the\nprevalence of both languages), so 18 potential Italian victims may be considered a\nsuccessful number to the threat actors.\n\n**Delivery Methods**\n\nThe campaign with the highest potential victim count was the campaign targeting English\nspeakers that was released the same day as the Italian campaign (13 September). It was\ndelivered via the most common method; a password protected zip file containing an ISO,\nwhich contained a LNK file. The second most successful campaign was that which leveraged\nPrivateLoader on 16 September 16.\n\nFrom our observations, it appears that campaigns leveraging CHM files are less successful,\nwhich could explain why we have only seen this technique being used twice. However, we do\nnot have a complete picture - the number of victims may have been proportionately similar\n(or different) based on the number of users targeted. For example, it is possible the CHM file\ncampaigns were tests against a smaller target base, in which case one might argue that they\n_were successful._\n\nLastly, it appears end users are far less likely to fall for a lure if there are any errors within the\naesthetics, as seen with the campaign on 9 September – security awareness training\nappears to pay off! Unfortunately, in the majority of cases, lures look quite realistic and don’t\nalways contain obvious errors and misspellings.\n\n**Traffic Timeline**\n\n\n-----\n\nExcluding the 19 September campaign as an outlier, the majority of victim traffic hits the C2\nthe day after a campaign is first reported in the wild. This could be a coincidence due to the\nsmall dataset being examined, and therefore will be a topic we revisit after further tracking.\n\nCommunication with the T2 infrastructure ends at least one day after the last victim traffic,\nwhich lasted anywhere from three to seven days. Due to the small sample size, this is also\nsomething we will continue to keep an eye on for any emerging patterns.\n\nThe timeframe we examined was coincidently when many odd behaviors were being\nobserved, including the changes with C2s being reused, the time between domain\nregistration and C2 assignment shrinking, and the campaign on 19 September that was\nquickly cut short (among other observations not mentioned). We believe that the threat\nactors behind IcedID were either making changes to various infrastructure processes behind\nthe scenes or were having technical issues during this time.\n\n### Conclusion\n\nIn this post we pulled back the curtain on IcedID campaign metrics and Stage 1 C2\ninfrastructure, to shed light on behaviors and details not often available. These metrics are\nnumbers the threat actors are watching as well, and just like any other business may\ninfluence their future actions.\n\nWhen it comes to delivery methods, daily campaigns often leverage emails containing\npassword protected zip files and ISOs and perform comparatively well. The relative success\nof the campaign leveraging PrivateLoader infections, with the malware concealed within\n‘cracked’ software downloads, makes this method something also worth watching.\n\nThe threat actors spamming IcedID are likely aware that lures with glaring mistakes and\ntypos perform poorly compared to those that are more realistic, as we saw with the campaign\non 9 September. Targets may not be as easily tricked by phishing emails nowadays, but in\nresponse the threat actors have adapted their methods to use lures that appear legitimate\nand don’t typically include errors. Make sure your company’s security awareness training has\nadapted too!\n\n\n-----\n\nWe hope that these findings provide benefit to the reader in a number of areas:\n\nContext on the cadence, volume, and impact of IcedID campaigns.\n\nData points for the assessment of the effectiveness of IcedID delivery TTPs.\n\nContext for the aging out of IcedID C2 IP IOCs; whilst IcedID domains continue to\nresolve to these IPs, their communications with the T2 cease after approximately 6\ndays.\n\nTopics for security awareness trainings that reflect the current environment\n\n### IOCs\n\n67.205.169.96 aviadronazhed[.]com\n\n134.209.97.90 qvantumbrakesz[.]com\n\n\n137.184.114.20\n\n\ntrallfasterinf[.]com\n\nsebdgoldingor[.]com\n\n\n142.93.44.94 pildofraften[.]com\n\n143.198.178.0 audifastinggip[.]com\n\n159.203.5.238 kolinandod[.]com\n\n161.35.110.54 alkaliodplus[.]com\n\nnikolandfantazy[.]com\n\nzalikomanperis[.]com\n\n188.166.169.40 allozelkot[.]com\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-10-07 - A Visualizza into Recent IcedID Campaigns- Reconstructing Threat Actor Metrics with Pure Signal™ Recon.pdf"
    ],
    "report_names": [
        "2022-10-07 - A Visualizza into Recent IcedID Campaigns- Reconstructing Threat Actor Metrics with Pure Signal™ Recon.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535779,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1666530840,
    "ts_modification_date": 1666530840,
    "files": {
        "pdf": "https://archive.orkl.eu/438046d3da4ba27a56af904db2a5b75ad57f590c.pdf",
        "text": "https://archive.orkl.eu/438046d3da4ba27a56af904db2a5b75ad57f590c.txt",
        "img": "https://archive.orkl.eu/438046d3da4ba27a56af904db2a5b75ad57f590c.jpg"
    }
}