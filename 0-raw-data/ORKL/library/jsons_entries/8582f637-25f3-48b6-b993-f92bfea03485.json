{
    "id": "8582f637-25f3-48b6-b993-f92bfea03485",
    "created_at": "2022-10-25T16:48:13.771539Z",
    "updated_at": "2025-03-27T02:12:16.089415Z",
    "deleted_at": null,
    "sha1_hash": "155c112f73a973ecf710fab5caa6434212275d81",
    "title": "Cmstar Downloader: Lurid And Enfal's New Cousin",
    "authors": "Palo Alto",
    "file_creation_date": "2015-05-29T09:22:25Z",
    "file_modification_date": "2015-05-29T09:22:25Z",
    "file_size": 266756,
    "plain_text": "In recent weeks, Unit 42 has been analyzing delivery documents used in spear-phishing attacks that drop\n\na custom downloader used in cyber espionage attacks. This specific downloader, Cmstar, is associated\n\nwith the Lurid downloader also known as ‘Enfal’. Cmstar was named for the log message ‘CM**’ used by\n\nthe downloader.\n\nUnit 42 is aware of threat actors using two toolkits – MNKit and the Tran Duy Linh toolkit – to produce\n\nmalicious documents that exploit CVE-2012-0158 in order to implant Cmstar. The Cmstar downloader\n\nitself has several unique and interesting features, as well as substantial infrastructure overlap with other\n\ntools worth discussing.\n\n## Manual Building of Import Address Table\n\nThe Cmstar downloader starts by manually building its import address table (IAT), much like shellcode\n\nwould; however, it uses a rather unique technique. Instead of finding API function names based on their\n\nhashed values, this malware enumerates libraries’ export address table (EAT) and searches for the name\n\nof the API function the payload needs to load by using a character to offset array. The payload pairs\n\nseveral comma-separated lists of characters with comma-separated lists of numbers. Each list of\n\ncharacters consists of the set found within the API function name the payload seeks to add to its IAT,\n\nwhile the corresponding list of numbers specifies the offset in the function name where those characters\n\nshould be placed. For example, if the payload has “D,e,A” paired with “0,5,19”, this results in the following\n\nmapping:\n\n“D” at offset 0 in API function name\n\n“e” at offset 5 in API function name\n\n“A” at offset 19 in API function name\n\nThe payload loads a specific Windows library’s EAT by calling the ImageDirectoryEntryToData API\n\nfunction using the IMAGE_DIRECTORY_ENTRY_EXPORT flag. It then enumerates the library’s EAT to\n\nfind exported function names by checking each function name for the character and the specific offset.\n\nOnce found, the payload adds the address for the specific API function to its IAT. For instance, the\n\npayload checks the EAT of “wininet.dll” using the comparisons mentioned above to find the address to the\n\n“DeleteUrlCacheEntryA” API function. One specific Cmstar payload that we analyzed used the\n\ncharacter/offsets seen in Figure 1 to locate the API functions within three different Windows libraries to\n\nbuild its IAT.\n\n**Library** **Characters** **Offsets** **Function Name**\n\nD e A 0 5 19 DeleteUrlCacheEntryA\n\n|Library|Characters|Offsets|Function Name|\n|---|---|---|---|\n\n\n-----\n\n|Col1|e,C,A|3,8,15|InternetConnectA|\n|---|---|---|---|\n||p,O,A|3,4,15|HttpOpenRequestA|\n||p,S,A|3,4,15|HttpSendRequestA|\n||p,E,A|3,4,14|HttpEndRequestA|\n||p,Q,A|3,4,13|HttpQueryInfoA|\n||e,R,e|3,8,15|InternetReadFile|\n||e,C,e|3,8,18|InternetCloseHandle|\n|advapi32.dll|S,V,A|3,6,13|RegSetValueExA|\n||C,s,y|3,6,10|RegCloseKey|\n||O,K,A|3,7,12|RegOpenKeyExA|\n||D,K,A|3,9,12|RegDeleteKeyA|\n||D,V,A|3,9,14|RegDeleteValueA|\n||U,r,A|3,6,11|GetUserNameA|\n||v,t,S|3,6,12|ConvertSidToStringSidA|\n||k,A,A|3,6,17|LookupAccountNameA|\n|kernel32.dll|W,E,c|0,3,6|WinExec|\n||C,M,A|0,10,17|CreateFileMappingA|\n||U,V,e|0,5,14|UnmapViewOfFile|\n||M,O,e|0,7,12|MapViewOfFile|\n\n\n**Figure 1. Character and Offset Pairs Found in Cmstar Payload and the Resulting API Function Names**\n\n## Cmstar Behavior\n\nAfter manually creating the IAT, Cmstar decrypts its configuration, several encrypted strings, and a piece\n\nof shellcode. The embedded configuration contains nothing more than a URL that Cmstar uses as its\n\ncommand and control (C2) location. The encrypted strings within the Trojan include fields used within the\n\nHTTP requests that Cmstar will create to communicate with its C2 server, as well as additional strings\n\nused to interact with the registry. The Cmstar sample associated with the MNKIT delivery document\n\ncreates the following registry key to automatically execute at system startup:\n\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\xpsfiltsvcs: “rundll32.exe\n\nC:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp\\xpsfiltsvcs.dll,XpsRegisterServer”\n\nUnit 42 found an additional encrypted registry key that would allow Cmstar to automatically start up after\n\nreboots. However, the code does not decrypt, reference, or use the following registry key in any way, which\n\nsuggests that the malware author left this artifact in the code after swapping to the run key listed above:\n\nHKCU\\Software\\Microsoft\\CTF\\LangBarAddIn\n\n\n-----\n\nspecifically by sending HTTP POST requests to the following URL:\n\nhttp://happy.launchtrue[.]com:8080/cgl-bin/update.cgi\n\nIt should be noted that the C2 URL contains the string ‘cgl-bin’, which visually resembles the common cgi\nbin folder used by many webservers to run server-side scripts. Unit 42 used the Palo Alto Networks\n\nAutoFocus threat intelligence service to locate additional samples using the ‘cgl-bin’ string within URLs of\n\nHTTP requests and found several samples of the Cmwhite tool associated with the LURID/Enfal\n\ndownloader[1], as seen in Figure 2.\n\n**Figure 2. Cmwhite Tools Using “cgl-bin” within HTTP Requests**\n\nCmstar’s HTTP POST requests sent to ‘happy.launchtrue[.]com’ contain data that the Trojan gathers from\n\nthe infected machine that has the following structure:\n\n_<Windows Version number>@@<CPU Architecture (2 for x64, 1 for x86)>??<boolean for elevated_\n\n_privileges>]]**<boolean if antivirus processes are found>!!<static version string>==_\n\nIn one example, Unit 42 observed the following data within an analysis environment, which was then\n\nencrypted using a single-byte XOR algorithm and a key of 0x45 before being sent to the C2 server:\n\n\n-----\n\nHelpfully, the malware author writes log messages to the ‘DF64159.TMP’ file, used for debugging purposes\n\nthroughout the execution of the Cmstar downloader. The log messages are abbreviated strings that\n\ndescribe specific activities during the execution of the code. For instance, the downloader uses the\n\nCreateMutex to create a mutex named ‘{53A4988C-F91F-4054-9076-220AC5EC03F3}’ to determine if\n\nanother instance of the code is running. If the downloader determines another instance of itself is\n\nrunning, the code writes the string ‘CM**’ – which happens to be the basis for the name of the Trojan – to\n\nthe log file. Unit 42 created a Yara signature to detect Cmstar samples based on these debugging strings,\n\nwhich is available in the appendix.\n\n## Hashing Process Names\n\nAs mentioned in the behavioral analysis section, the Cmstar downloader gathers system-specific\n\ninformation to send to the C2 server. One such piece of information is the existence of specific running\n\nprocesses. Many malware families and tools check for the existence of antivirus, but the Cmstar tool does\n\nso in a clever way. Rather than including a list of strings of associated processes, Cmstar enumerates the\n\nrunning processes and subjects these process names to a hashing algorithm. The results of this algorithm\n\nare then compared against three static values: 0x1E00AFA, 0xBEE091E8 and 0xD46FCDFA. Unit 42\n\nreverse engineered the algorithm and created the function seen below to generate hashes in order to\n\ndetermine the processes Cmstar is trying to find:\n\n\ndef hashStr(st):\n\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n\ndef hashStr(st):\n\nhash = 0\n\ncount = 0\n\nwhile count < len(st):\n\nh1 = (hash<<0x13)&0xFFFFFFFF\n\nh2 = (hash>>0x0d)&0xFFFFFFFF\n\n\n-----\n\n14\n\n15\n\n16\n\n17\n\n18\n\n19\n\n20\n\n21\n\n\nhash = (h3 + (ord(st[count]) 0x4a))&0xFFFFFFFF\n\ncount += 1\n\nreturn hash\n\n\nUnit 42 found that the string ‘avp’ subjected to the algorithm above results in the value 0x1E00AFA, which\n\nsuggests the Cmstar sample specifically looks for Kaspersky’s Anti-virus product (avp.exe) running on the\n\ncompromised system. If the Trojan finds processes whose hash matches the three values mentioned\n\nearlier, it sets a boolean value (the character ‘1’) within the data sent to the C2 server and continues\n\ncarrying out its functionality. Rather than altering its activities, Cmstar only notifies the C2 server if a\n\nsystem is running one of these processes, suggesting that the threat actors might employ this technique as\n\na filtering mechanism to ignore analysis systems and researchers.\n\n## Threat Infrastructure\n\nIn order to determine the intrusion set involved with the Cmstar, Unit 42 enumerated infrastructure used\n\nby the downloader for its C2 servers. The related infrastructure chart in Figure 3 shows a rather large\n\ncluster of related entities with one small set of entities that do not share any related entities with the larger\n\ncluster.\n\n\n-----\n\n**Figure 3. Infrastructure and Entites Related to Cmstar**\n\nAs seen in the chart above, the C2 domain ‘happy.launchtrue[.]com’ was originally registered using the\n\nemail address ‘WANGMINGHUA6@GMAIL[.]COM’. When Unit 42 used the Palo Alto Networks\n\nAutoFocus threat intelligence service to locate additional Cmstar samples, we found several with C2\n\ndomains that also had the same original registrant:\n\nlinks.dogsforhelp[.]com\n\nthree.earewq[.]com\n\nquestion.eboregi[.]com\n\nhere.pechooin[.]com\n\nsarey.phdreport[.]com\n\nbakler.featurvoice[.]com\n\nThe only known Cmstar C2 domain not initially registered by the email address was help.ubxpi0s[.]com.\n\nFurther analysis revealed that additional domains related to Cmstar C2 domains were also originally\n\nregistered using the email address ‘WANGMINGHUA6@GMAIL[.]COM’ and updated to the current\n\ninformation within a few days. In addition, this was the original registrant for C2 domain used in our\n\nGoogle Code blog[2] indicating this registrant email is likely a re seller and/or someone who initially sets\n\n\n-----\n\nforever.cowforhelp[.]com\n\nquestion.shiesiido[.]com\n\nendline.biortherm[.]com\n\nright.marubir[.]com\n\nbaby.brabbq[.]com\n\nlind.kruptcy[.]com\n\nThe rest of the domains related to the Cmstar infrastructure did not use the original registrant noted\n\nabove, but instead kept the same information initially used to register them. The difference in domain\n\nregistration patterns could indicate threat actor preference, or could indicate there are at least two groups\n\nusing this malware whose infrastructure at times overlaps.\n\nunder.suttgte[.]com\n\nhelp.ubxpi0s[.]com\n\nfinally.basiccompare[.]com\n\ncrystal.diskfunc[.]com\n\nqueenfansclub[.]com\n\nnovnitie[.]com\n\nflash-vip[.]com\n\nreplyfunt[.]com\n\nnatcongress[.]com\n\nkeep.regebky[.]com\n\nlove.regebky[.]com\n\nInterestingly, the updated registrant information (or original, in the cases where it wasn’t changed) for all\n\nof the C2 domains in this blog has also been used to register scam sites, most purporting to sell knock-off\n\ndesigner products like shoes, software, or cell phones. The contact emails and contact names can vary, but\n\nthe address is re-used. Blue Coat noted this pattern as well in a blog published late last year, which also\n\nnoted the ‘WANGMINGHUA6@GMAIL[.]COM’ registrant email.[3 ]It is not known whether the threat\n\nactors conducting the malicious activity are also behind the scam sites.\n\n## Conclusion\n\nThe Cmstar tool has several interesting features, including a previously unseen method of manually\n\ncreating its import address table using an API function name character to offset mapping techniques, and\n\na hashing algorithm used to find antivirus processes on an infected system. Both of these features are\n\n\n-----\n\nauthors.\n\nThe URL used by Cmstar to communicate with its C2 server, as well as significant infrastructure overlap,\n\nshow a direct relationship between the Cmstar downloader, Lurid/Enfal and Cmwhite tools. In a majority\n\nof the cases, threat actors using the Cmstar downloader initially register the C2 domains using the email\n\naddress ‘WANGMINGHUA6@GMAIL[.]COM’ and later change the registration information to include a\n\ndifferent email address. Unit 42 cannot positively confirm that the threat actors control the\n\n‘WANGMINGHUA6@GMAIL[.]COM’ email address, or if the email address belongs to a reseller that the\n\nthreat actors buy domains from to create their infrastructure; however, we do believe this is an interesting\n\nTTP worth tracking in future infrastructure enumeration.\n\n1. THE “LURID”DOWNLOADER – Nart Villeneuve and David Sancho –\n\n[http://la.trendmicro.com/media/misc/lurid-downloader-enfal-report-en.pdf](http://la.trendmicro.com/media/misc/lurid-downloader-enfal-report-en.pdf)\n\n2. [Attacks on East Asia using Google Code for Command and Control – Jen Miller-Osborn and Rob](http://researchcenter.paloaltonetworks.com/2014/08/attacks-east-asia-using-google-code-command-control/)\n\nDowns — http://researchcenter.paloaltonetworks.com/2014/08/attacks-east-asia-using-google\ncode-command-control/\n\n3. Linking APTs from 2011 and 2014 to an Active Scam Network – Kiel Wadner –\n\nhttps://www.bluecoat.com/security-blog/2014-10-08/linking-apts-2011-and-2014-active-scam\nnetwork\n\n## Appendix\n\n**Known Cmstar Downloaders**\n\nFilename: xpsfiltsvcs.tmp\n\nSHA256: 239a25ac2b38f0be9392ceeaeab0d64cb239f033af07ed56565ba9d6a7ddcf1f\n\nC2: links.dogsforhelp.com\n\nFilename: xpsfiltsvcs.tmp\n\nSHA256: 6b557c22ab12e8ea43d29e4f9f8a9483e3e75cd41338a674c9069b6dacdf7ba7\n\nC2: question.eboregi.com\n\nFilename: xpsfiltsvcs.tmp\n\nSHA256: 7ade616a8f1750cecba944a02e2bce1340b18a55697b29f721ccc4701aadba6e\n\nC2: links.dogsforhelp.com\n\nFilename: xpsfiltsvcs.tmp\n\nSHA256: 88184983733f4d4fa767ad4e7993b01c5754f868470dd78ac1bad2b02c9e5001\n\n\n-----\n\nFilename: xpsfiltsvcs.tmp\n\nSHA256: b9d597aea53023727d8564e47e903b652f5e98a2c32bdc23bc4936448fb2d593\n\nC2: question.eboregi.com\n\nFilename: xpsfiltsvcs.tmp\n\nSHA256: e0b3cc07d3a9b509480b240368dee2a29713ea1e240674c0ccf610c84810a7c5\n\nC2: question.eboregi.com\n\nFilename: xpsfiltsvcs.txt\n\nSHA256: f4b8f71c0e10a345a855763e01033e2144e949c8f98c271755cc025e3f55b7da\n\nC2: three.earewq.com\n\nFilename: xpsfiltsvcs.tmp\n\nSHA256: 2e00a98212c5a2015d12612f0d26039a0c2dfee3e1b384675f613e683f276e02\n\nC2: bakler.featurvoice.com\n\nFilename: xpsfiltsvcs.dll\n\nSHA256: 42ed2edc37b957266ff7b02955a007dd82d955c09ef7be23e685d938e40ad61d\n\nC2: turber.xoxcobbs.com\n\nFilename: xpsfiltsvcs.dll\n\nSHA256: 9b9cc7e2a2481b0472721e6b87f1eba4faf2d419d1e2c115a91ab7e7e6fc7f7c\n\nC2: happy.launchtrue.com\n\nFilename: xpsfiltsvcs.tmp\n\nSHA256: a330c52b7643de9d8be51a4ae0150b7b8390dbabaea9704069694835fbd3298e\n\nC2: three.earewq.com\n\nFilename: xpsfiltsvcs.tmp\n\nSHA256: a8fa487d9f2152738bf49c8c69e8a147aae55c06f37c7e25026a28f21601ad7f\n\nC2: sarey.phdreport.com\n\nFilename: xpsfiltsvcs.tmp\n\nSHA256: c99c0b37f2fd64fa523d39c35ead6416a684ae203ae728feb5feff8490eb902c\n\nC2: help.ubxpi0s.com\n\nFilename: xpsfiltsvcs.tmp\n\nSHA256: d541280b37dd5e2101cc5cd47b0991b8320714f5627b37646330136cddef0c23\n\n\n-----\n\nFilename: coyote_load.dll\n\nSHA256: adb05c1eecd789582886b3354b53831df9c9a06e891bb687633ee7ce21417edc\n\nC2: bakler.featurvoice.com\n\n**Delivery Documents Installing Cmstar**\n\nFilename: Какая реформа армии нужна Украине.doc (What is needed reform of the army Ukraine.doc)\n\nMD5: 76ffb9c2d8d0ae46e8ea792ffacc8018\n\nSHA256: c26c67eac20614038aaadfda19b604862926433333893d65332928b5e36796aa\n\nType: MIME entity text\n\nToolkit: MNKit\n\nAuthor: User123\n\nLast Saved By: User123\n\nCreated: 2012-05-01T14:08:00Z\n\nModified: 2012-05-01T14:12:00Z\n\nFilename: запуск ракеты-носителя Союз.doc (launch of the carrier rocket Soyuz.doc)\n\nMD5: 6fdeadacfe1dafd2293ce5c4e178b668\n\nSHA256: e39b0e777ef0135c1f737b67988df70c2e6303c3d2b01d3cdea3efc1d03d9ad9\n\nType: Microsoft Office Word 97-2003 Document\n\nToolkit: Tran Duy Linh\n\nCreated: 2012:11:23 04:35:00\n\nModified: 2012:11:23 04:39:00\n\nCompany: DLC Corporation\n\nFilename: РФ_КНР_сельское_хозяйство.doc (RF China Agriculture and Economy.doc)\n\nMD5: 9da10a36daf845367e0fc2f3e7e54336\n\nSHA256: a0aeb172a72442d2c2c02e1d32b48accb9975c4da7742df24d9350a8ccd401f2\n\nType: Microsoft Office Word 97-2003 Document\n\nToolkit: Tran Duy Linh\n\nCreated: 2012:11:23 04:35:00\n\nModified: 2012:11:23 04:39:00\n\nCompany: DLC Corporation\n\nFilename: Ерөнхий сайд асан Н.Алтанхуягийг шалгаж эхэлжээ.doc (Former Prime Minister started to\n\ncheck with their lethargy.doc)\n\nMD5: f7d47e1de4f5f4ad530bca0fc080ea53\n\n\n-----\n\nType: Microsoft Office Word 97-2003 Document\n\nToolkit: Tran Duy Linh\n\nCreated: 2012:11:23 04:35:00\n\nModified: 2012:11:23 04:39:00\n\nCompany: DLC Corporation\n\nFilename: запуск ракеты-носителя Союз.doc (launch of the carrier rocket Soyuz.doc)\n\nMD5: 6fdeadacfe1dafd2293ce5c4e178b668\n\nSHA256: e39b0e777ef0135c1f737b67988df70c2e6303c3d2b01d3cdea3efc1d03d9ad9\n\nType: Microsoft Office Word 97-2003 Document\n\nToolkit: Tran Duy Linh\n\nCreated: 2012:11:23 04:35:00\n\nModified: 2012:11:23 04:39:00\n\nCompany: DLC Corporation\n\nMD5: 5aeb8a5aa8f6e2408016cbd13b3dfaf0\n\nSHA256: df34aa9c8021f1f0bdf33249908efc4a9628941453ad79b281b3a46bf9a7f37f\n\nType: Microsoft Office Word 97-2003 Document\n\nToolkit: Tran Duy Linh\n\nCreated: 2012:11:23 04:35:00\n\nModified: 2012:11:23 04:39:00\n\nCompany: DLC Corporation\n\nFilename: Путины урилга.doc (Putin’s invitation.doc)\n\nSHA256: 45027d11ab783993c413f97e8e29759d04b04564f8916f005f5c632f291697bb\n\nType: Microsoft Office Word 97-2003 Document\n\nToolkit: Tran Duy Linh\n\nCreated: 2012:11:23 04:35:00\n\nModified: 2012:11:23 04:39:00\n\nCompany: DLC Corporation\n\nMD5: 46bf922d9ae07a9bc3667a374605bdbb\n\nSHA256: 7dc78caf515d1d3d2b84be7c023ccbd0b4fd670a42babcbcbd5a5ba65bbdd166\n\nType: Microsoft Office Word 97-2003 Document\n\nToolkit: Tran Duy Linh\n\nCreated: 2012:11:23 04:35:00\n\nModified: 2012:11:23 04:39:00\n\n\n-----\n\nFilename: Армия-2015.doc (Army-2015.doc)\n\nMD5: 783a423f5e285269126d0d98f53c795b\n\nSHA256: 5b338decffe665a2141d1079c32b2d612057d1fdbfddf198cc28003dae7f0516\n\nType: Microsoft Office Word 97-2003 Document\n\nToolkit: Tran Duy Linh\n\nCreated: 2012:11:23 04:35:00\n\nModified: 2012:11:23 04:39:00\n\nCompany: DLC Corporation\n\nFilename: С днём 70 лет победы.doc (Happy 70 years of victory.doc)\n\nMD5: 510b3272342765743a202373261c08da\n\nSHA256: 0a10d7bb317dceccd05d18408fd6b8b12c784910e5f7e035ee22c2c5d7e4cbf5\n\nType: Microsoft Office Word 97-2003 Document\n\nToolkit: Tran Duy Linh\n\nCreated: 2012:11:23 04:35:00\n\nModified: 2012:11:23 04:39:00\n\nCompany: DLC Corporation\n\nFilename: new resume.doc\n\nMD5: c5ae7bd6aec1e01aa53edcf41962ac04\n\nSHA256: 87bcc6d18c6a81d92d826b232703dee84b522bd1d0cae56f74bcf58fdca0930e\n\nType: Microsoft Office Word 97-2003 Document\n\nToolkit: Tran Duy Linh\n\nCreated: 2012:11:23 04:35:00\n\nModified: 2012:11:23 04:39:00\n\nCompany: DLC Corporation\n\nMD5: 3d41e3c902502c8b0ea30f5947307d56\n\nSHA256: b65dd4da9f83c11fcb5beaec43fabd0df0f7cb61de94d874f969ca926e085515\n\nType: Microsoft Office Word 97-2003 Document\n\nToolkit: Tran Duy Linh\n\nCreated: 2012:11:23 04:35:00\n\nModified: 2012:11:23 04:39:00\n\nCompany: DLC Corporation\n\nFilename: Центр-2015.doc (Center-2015.doc)\n\n\n-----\n\nSHA256: 671dfc4d47a43cf0bd9205a0f654dcd5050175aef54b69388b0c5f4610896c6a\n\nType: Microsoft Office Word 97-2003 Document\n\nToolkit: Tran Duy Linh\n\nCreated: 2012:11:23 04:35:00\n\nModified: 2012:11:23 04:39:00\n\nCompany: DLC Corporation\n\nRelated Cmwhite Tools\n\nMD5: 3fff0bf6847d0d056636caef9c3056c3\n\nSHA256: 13c1d7eb2fd64591e224dec9534d8252f4b91e425e8f047b36605138d15cbf2d\n\nC2: stone.timmf.com\n\nMD5: 30a6c3c7723fe14c4b6960fa3e4e57ba\n\nSHA256: ab934c6177be0fdc3b6dfbf21f60ce7837a30e6599dcfb111b43008c75ceb91f\n\nC2: xphome.mailru-vip.com\n\nC2: error.yandex-pro.com\n\nMD5: e0417547ba54b58bb2c8f795bca0345c\n\nSHA256: 1cf44815f9eb735e095f68c929d5549e0ebc44af9988cccaf1852baeb96bb386\n\nC2: dns.thinkttun.com\n\nMD5: d05f012c9c1a7fb669a07070be821072\n\nSHA256: a37f337d0bc3cebede2039b0a3bd5afd0624e181d2dcc9614d2f7d816b5a7a6b\n\nC2: help.redhag.com\n\nC2: mssage.hotoicq.com\n\nC2: new.hoticq.com\n\n**Cmstar Yara Rule**\n\n\nrule\nce_enfal_cmstar_debug_msg\n\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n\n-----\n\n8\n\n9\n\n10\n\n11\n\n\nrule ce_enfal_cmstar_debug_msg\n\n{\n\n|12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35|meta: author = \"rfalcone\" description = \"Detects the static debug strings within CMSTAR\" reference = \"9b9cc7e2a2481b0472721e6b87f1eba4faf2d419d1e2c115a91ab7e7e6fc7f7c\" date = \"5/10/2015\" strings: $d1 = \"EEE\\x0d\\x0a\" fullword $d2 = \"TKE\\x0d\\x0a\" fullword $d3 = \"VPE\\x0d\\x0a\" fullword $d4 = \"VPS\\x0d\\x0a\" fullword $d5 = \"WFSE\\x0d\\x0a\" fullword $d6 = \"WFSS\\x0d\\x0a\" fullword $d7 = \"CM**\\x0d\\x0a\" fullword condition: uint16(0) == 0x5a4d and all of ($d*) }|\n|---|---|\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/67esnb1ppzsgyo3mm5es3zs8khtf3rpe",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2015/2015.05.18.Cmstar/CmstarDownloader_Lurid_Enfal_Cousin.pdf"
    ],
    "report_names": [
        "CmstarDownloader_Lurid_Enfal_Cousin"
    ],
    "threat_actors": [
        {
            "id": "7c8cf02c-623a-4793-918b-f908675a1aef",
            "created_at": "2023-01-06T13:46:38.309165Z",
            "updated_at": "2025-03-27T02:00:02.801298Z",
            "deleted_at": null,
            "main_name": "APT15",
            "aliases": [
                "BRONZE PALACE",
                "Nylon Typhoon",
                "VIXEN PANDA",
                "Playful Dragon",
                "BRONZE DAVENPORT",
                "BRONZE IDLEWOOD",
                "G0004",
                "Red Vulture",
                "Ke3Chang",
                "Metushy",
                "Lurid",
                "Social Network Team",
                "Royal APT"
            ],
            "source_name": "MISPGALAXY:APT15",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716493,
    "ts_updated_at": 1743041536,
    "ts_creation_date": 1432891345,
    "ts_modification_date": 1432891345,
    "files": {
        "pdf": "https://archive.orkl.eu/155c112f73a973ecf710fab5caa6434212275d81.pdf",
        "text": "https://archive.orkl.eu/155c112f73a973ecf710fab5caa6434212275d81.txt",
        "img": "https://archive.orkl.eu/155c112f73a973ecf710fab5caa6434212275d81.jpg"
    }
}