{
    "id": "843a4e8c-7bce-4636-afd7-97b43068826a",
    "created_at": "2023-01-12T15:08:37.948936Z",
    "updated_at": "2025-03-27T02:05:30.224629Z",
    "deleted_at": null,
    "sha1_hash": "608e00d158cfbc2b8fe51510f215d76be39bec55",
    "title": "2019-01-28 - Russia hit by new wave of ransomware spam",
    "authors": "",
    "file_creation_date": "2022-05-28T03:36:33Z",
    "file_modification_date": "2022-05-28T03:36:33Z",
    "file_size": 856437,
    "plain_text": "# Russia hit by new wave of ransomware spam\n\n**[welivesecurity.com/2019/01/28/russia-hit-new-wave-ransomware-spam/](https://www.welivesecurity.com/2019/01/28/russia-hit-new-wave-ransomware-spam/)**\n\nJanuary 28, 2019\n\nAmong the increased number of malicious JavaScript email attachments observed in\nJanuary 2019, ESET researchers have spotted a large wave of ransomware-spreading\nspam targeting Russian users\n\n[Juraj Jánošík](https://www.welivesecurity.com/author/jjanosik/)\n28 Jan 2019 - 02:57PM\n\n\n-----\n\nAmong the increased number of malicious JavaScript email attachments observed in\nJanuary 2019, ESET researchers have spotted a large wave of ransomware-spreading\nspam targeting Russian users\n\nJanuary 2019 has seen a dramatic uptick in detections of malicious JavaScript email\nattachments, an attack vector that mostly lay dormant throughout 2018. Among the “New\nYear edition” of malicious spam campaigns relying on this vector, we have detected a new\nwave of Russian-language spam that distributes ransomware known as Shade or Troldesh,\nand detected by ESET as Win32/Filecoder.Shade.\n\nThe campaign appears to be a follow-up to a malicious spam campaign that started\n[distributing the Shade ransomware in October 2018.](https://isc.sans.edu/forums/diary/Russian+language+malspam+pushing+Shade+Troldesh+ransomware/24358/)\n\n## The January 2019 campaign\n\nOur telemetry shows the October 2018 campaign running at a consistent pace until the\nsecond half of December 2018, taking a break around Christmas, and then resuming in\nmid-January 2019 doubled in size, as seen in Figure 1. The drops in the graph are aligned\nwith weekends, which suggests that the attackers favor company email addresses.\n\nFigure 1 – Detections of malicious JavaScript attachments spreading Win32/Filecoder.Shade since\n\nOctober 2018\n\nAs previously mentioned, this campaign is a part of a larger trend we have observed from\nthe beginning of 2019 – the comeback of malicious JavaScript attachments as a widely\nused attack vector. Figure 2 shows this development as seen in our telemetry.\n\n\n-----\n\nFigure 2 – Detections of malicious JavaScript distributed via email attachments, all of which are\n\ndetected as JS/Danger.ScriptAttachment, in the last year\n\nOf particular note, the campaign spreading the Shade ransomware in January 2019 has\nbeen most active in Russia, with 52% of the total detections of these malicious JavaScript\nattachments. Among other affected countries are Ukraine, France, Germany, and Japan, as\nseen in Figure 3.\n\nFigure 3 – Distribution of ESET detections of malicious JavaScript attachments spreading\n\nWin32/Filecoder.Shade between January 1, 2019 and January 24, 2019\n\n\n-----\n\nBased on our analysis, a typical attack in the January 2019 campaign starts with the\ndelivery of an email written in Russian, with an attached ZIP archive named “info.zip” or\n“inf.zip”.\n\nThese malicious emails pose as order updates, seemingly coming from legitimate Russian\norganizations. The emails we have seen impersonate the Russian bank B&N Bank (note:\nrecently merged with Otkritie Bank), and the retail chain Magnit. In one of the emails\ndetected by ESET systems, the English translation is:\n\n_Subject: Details of the order_\n\n_Hello!_\n\n_I’m sending to you the details of the order. The document is enclosed._\n\n_Denis Kudrashev, manager_\n\nFigure 4 – Example of a spam email used in the January 2019 campaign\n\nThe ZIP archive contains a JavaScript file named “Информация.js“ (which translates to\n“Information” in English). Once extracted and launched, the JavaScript file downloads a\nmalicious loader, detected by ESET products as Win32/Injector. The malicious loader\ndecrypts and launches the final payload – the Shade ransomware.\n\n\n-----\n\nThe malicious loader is downloaded from URLs at compromised, legitimate WordPress\nsites, where it is disguised as an image file. To compromise the WordPress pages,\nattackers used mass-scale password brute-force attacks carried out via automated bots.\nOur telemetry data shows hundreds of such URLs, all ending with the string “ssj.jpg”,\nhosting the malicious loader file.\n\nThe loader is signed using an invalid digital signature that claims to be issued by Comodo,\nas seen in Figure 5. The name in “Signer information” and the timestamp are unique for\neach sample.\n\nFigure 5 – Fake digital signature used by the malicious loader\n\nBesides this, the loader attempts to disguise itself further by posing as the legitimate system\nprocess Client Server Runtime Process (csrss.exe). It copies itself into\nC:\\ProgramData\\Windows\\csrss.exe, where “Windows” is a hidden folder created by the\nmalware, and is not normally located in ProgramData.\n\n\n-----\n\nFigure 6 – The malware posing as a system process and using version details copied from a\n\nlegitimate Windows Server 2012 R2 binary\n\n## The Shade ransomware\n\nThe final payload of this malicious campaign is crypto-ransomware dubbed Shade or\nTroldesh. First seen in the wild in late 2014, but frequently resurfacing since, the\nransomware encrypts a wide range of file types on local drives. In the recent campaign, the\nransomware appends the extension .crypted000007 to the encrypted files.\n\nThe payment instructions are presented to victims in a TXT file, in Russian and English,\nwhich is dropped to all drives on the affected computer. The wording of the ransom note is\nidentical to that from the previously-reported October 2018 campaign.\n\nFigure 7 – The Shade ransomware ransom note from January 2019\n\n\n-----\n\n## How to stay safe\n\n[To avoid falling victim to malicious spam, always verify the authenticity of emails before](https://www.welivesecurity.com/2015/01/08/phish-allergy-recognizing-phishing-messages/)\nopening any attachments or clicking on links. If necessary, check with the organization\nseemingly sending the email using contact details provided on their official website.\n\nFor Gmail users, it may be useful to know that Gmail has been blocking JavaScript\n[attachments in both received and sent emails for almost two years now.](https://www.welivesecurity.com/2017/02/16/gmail-starts-blocking-javascript-attachments-alternative-infector-vectors-expected/)\n\nUsers of other email services, including company mail servers, must rely on their\nawareness – unless they use some security solution capable of detecting and blocking\nmalicious JavaScript files.\n\nSeveral different modules in ESET security products independently detect and block\nmalicious JavaScript files.\n\n[To avoid having your WordPress website compromised, use a strong password and](https://www.welivesecurity.com/2019/01/08/new-years-resolutions-passwords-shipshape/) twofactor authentication and make sure to regularly update WordPress itself, as well as\nWordPress plugins and themes.\n\n## Indicators of Compromise (IoCs)\n\n### Example hashes of the malicious ZIP attachments\n\n0A76B1761EFB5AE9B70AF7850EFB77C740C26F82\n\nD072C6C25FEDB2DDF5582FA705255834D9BC9955\n\n80FDB89B5293C4426AD4D6C32CDC7E5AE32E969A\n\n5DD83A36DDA8C12AE77F8F65A1BEA804A1DF8E8B\n\n6EA6A1F6CA1B0573C139239C41B8820AED24F6AC\n\n43FD3999FB78C1C3ED9DE4BD41BCF206B74D2C76\n\n### Example hashes of JavaScript downloaders\n\n37A70B19934A71DC3E44201A451C89E8FF485009\n\n08C8649E0B7ED2F393A3A9E3ECED89581E0F9C9E\n\nE6A7DAF3B1348AB376A6840FF12F36A137D74202\n\n**ESET detection name: Win32/Injector**\n\n\n-----\n\n1F1D2EEC68BBEC77AFAE4631419E900C30E09C2F\n\nCC4BD14B5C6085CFF623A6244E0CAEE2F0EBAF8C\n\n**ESET detection name: Win32/Injector**\n\n### Example hashes of the Shade ransomware\n\nFEB458152108F81B3525B9AED2F6EB0F22AF0866\n\n7AB40CD49B54427C607327FFF7AD879F926F685F\n\n441CFA1600E771AA8A78482963EBF278C297F81A\n\n9023B108989B61223C9DC23A8FB1EF7CD82EA66B\n\nD8418DF846E93DA657312ACD64A671887E8D0FA7\n\n**ESET detection name: Win32/Filecoder.Shade**\n\n### Campaign-specific string in URLs hosting the Shade ransomware\n\nhxxp://[redacted]/ssj.jpg\n\n28 Jan 2019 - 02:57PM\n\n### Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n Newsletter\n\n Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-01-28 - Russia hit by new wave of ransomware spam.pdf"
    ],
    "report_names": [
        "2019-01-28 - Russia hit by new wave of ransomware spam.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536117,
    "ts_updated_at": 1743041130,
    "ts_creation_date": 1653708993,
    "ts_modification_date": 1653708993,
    "files": {
        "pdf": "https://archive.orkl.eu/608e00d158cfbc2b8fe51510f215d76be39bec55.pdf",
        "text": "https://archive.orkl.eu/608e00d158cfbc2b8fe51510f215d76be39bec55.txt",
        "img": "https://archive.orkl.eu/608e00d158cfbc2b8fe51510f215d76be39bec55.jpg"
    }
}