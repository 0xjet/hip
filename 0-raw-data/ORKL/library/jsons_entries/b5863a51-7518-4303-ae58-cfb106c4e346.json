{
    "id": "b5863a51-7518-4303-ae58-cfb106c4e346",
    "created_at": "2023-01-12T14:58:56.426055Z",
    "updated_at": "2025-03-27T02:17:05.716578Z",
    "deleted_at": null,
    "sha1_hash": "552ba9973547d0d264948f9b1dc912f5d2034837",
    "title": "2017-09-18 - Casting a Light on BlackEnergy",
    "authors": "",
    "file_creation_date": "2022-05-29T01:08:57Z",
    "file_modification_date": "2022-05-29T01:08:57Z",
    "file_size": 1928014,
    "plain_text": "# Casting a Light on BlackEnergy\n\n**threatconnect.com/blog/casting-a-light-on-blackenergy/**\n\nSeptember 18, 2017\n\n## A look into BlackEnergy malware and using ThreatConnect to aggregate and memorialize the identified intelligence.\n\nAs workers prepared to head home on December 23, 2015, an attack against Ukraine’s\nenergy sector left 230,000 without electricity (or heat) for six hours. The attackers\n[demonstrated a variety of capabilities, including spearphishing emails and variants of the](https://ics.sans.org/media/E-ISAC_SANS_Ukraine_DUC_5.pdf)\nBlackEnergy 3 malware to gain a foothold into the Information Technology (IT) networks of\nthe electricity companies. The December 2015 incident was the first known instance where a\ncyber attack disrupted electric grid operations. And BlackEnergy 3 malware was key to\nenabling it.\n\nThis blog post will:\n\nExamine how we used the ThreatConnect platform as part of the intelligence cycle\nwhen reviewing the BlackEnergy malware.\nReview the BlackEnergy malware, related incidents, and methods for gathering\nindicators related to the malware.\nDiscuss how researchers can use ThreatConnect to sort through and pull these\nindicators together.\n\n\n-----\n\n_This graphic captures how we incorporated ThreatConnect into the intelligence cycle to_\n_aggregate and memorialize intelligence on BlackEnergy. We started off by identifying_\n_background information on BlackEnergy and the actors behind it, which ultimately drove our_\n_later research efforts._\n\n## Planning and Direction – BlackEnergy Background\n\n[Since it was first found in the wild in 2007, the BlackEnergy malware family has grown to](http://atlas-public.ec2.arbor.net/docs/BlackEnergy+DDoS+Bot+Analysis.pdf)\ninclude three variants, the third of which was used in the Ukraine cyber attacks. The first\nvariant is a simple Trojan that runs distributed denial of service (DDOS) attacks against\ntargeted servers. The second variant –also known as BlackEnergy 2– marked a major\nchange to the malware’s capabilities and an almost complete code rewrite from the first\nvariant. BlackEnergy 2 added support for 64 bit drivers and implemented UAC Bypass\nInstallers to give the malware elevated code execution privileges on Windows. The third\nvariant (BlackEnergy 3) was also a big change from BlackEnergy 2 with the addition of a\nwider variety of plugins and anti-analysis techniques.\n\n\n-----\n\n[The Russian APT Sandworm Team, also known as Quedagh and BE2 APT, is associated](https://app.threatconnect.com/auth/threat/threat.xhtml?threat=1003869&owner=Common+Community)\nwith BlackEnergy attacks targeting various organizations in Ukraine. Since at least 2009,\nSandworm Team has also previously attacked government, telecommunications, defense,\nand energy organizations.\n\nThe consistent use of BlackEnergy malware against the energy and industrial sectors means\nthose organizations should consider BlackEnergy an intelligence requirement. Identifying\nand memorializing strategic intelligence on when BlackEnergy was used, what it targeted,\nwhat it can do, and how it has evolved can ultimately inform those organizations’ higher level\ndefensive efforts. The next step in the intelligence cycle is to collect intelligence on the threat\nitself.\n\n## Intelligence Collection\n\n_OSINT Baseline_\n\nOne method ThreatConnect uses when researching a threat, is collecting indicators from\nopenly available sources. These collections often include network and file indicators\nincluding hashes, hostnames, IP addresses, and email addresses. ThreatConnect also has a\n[free intelligence feed collecting over 75 cybersecurity reports and blogs that automatically](https://app.threatconnect.com/auth/browse/index.xhtml?filters=typeName%20in%20(%22Incident%22)&intelType=groups&owners=10666)\ncaptures indicators so organizations and researchers can incorporate them into their\ninvestigative and defensive efforts.\n\n\n-----\n\n_Technical Blogs and Reports Intelligence Source Browse Screen, Filtered for ICS related_\n_Incidents_\n\n[One good starting point was a 2014 Kaspersky report detailing BlackEnergy use that](https://securelist.com/be2-custom-plugins-router-abuse-and-target-profiles/67353/)\ncontained five MD5 hashes associated with the BlackEnergy 3 malware. After identifying\nthese openly available reports and indicators, we imported them into ThreatConnect and\nassociated them with their respective BlackEnergy Incidents.\n\n_Malware Hunting_\n\n\n-----\n\n[Another method that can be used to identify and gather indicators is hunting using YARA](https://virustotal.github.io/yara/)\nrules. We used the ThreatConnect YARA hunting integration to deploy a YARA ruleset of five\nBlackEnergy signatures and identified samples submitted to a public malware scanning site\nthat matched those YARA rules. The matching file results identified all three variants of the\nmalware and associated the file indicators with YARA signature groups in the Platform.\n\n_Hunting for BlackEnergy in the ThreatConnect Platform_\n\nAbove is an image of the output from hunting for BlackEnergy using ThreatConnect. The\nYARA hunting integration automatically imports file indicators that match deployed YARA\nrules. These indicators are organized into groups based on the date of identification, the\nassociated rule, and sample. This integration helped us identify hundreds of files related to\nthis specific threat. Additionally, it helped us organize the data so that it can be enriched and\nassociated with other BlackEnergy intelligence in the platform.\n\n## Processing and Exploitation – Building Out Intelligence With ThreatConnect\n\nAfter we’ve collected intelligence from a variety of sources, we can leverage ThreatConnect’s\nvarious integrations, Spaces apps, and investigation links to build out our understanding of\nthe identified activity. This iterative process helps organizations identify tactical intelligence\nthat may inform their incident response efforts in the wake of experienced activity.\n\nFor example, we can use our investigation links for a BlackEnergy 3 malware hash identified\n[in an RSA forum to query VxStream for the given file.](https://community.rsa.com/thread/186012)\n\n\n-----\n\n[We can then use VxStream to find similar samples to the queried hash. Many public](https://www.payload-security.com/)\nmalware scanning sites associate similar files to the sample being scanned, which\nresearchers can use to find associated samples related to the incident they are investigating.\n\nThese similar samples have already been scanned, making it easier for us to identify the\nvariant of the malware. This decreases the amount of time an analyst needs to spend\nanalyzing the sample.\n\n\n-----\n\n_[Hybrid Analysis BlackEnergy Malware Associated Samples](https://www.reverse.it/search?query=similar-to:07e726b21e27eefb2b2887945aa8bdec116b09dbd4e1a54e1c137ae8c7693660&block_redirect=1)_\n\nThis newly identified information that augments findings from intelligence collection efforts, is\nthen imported into ThreatConnect and associated with the BlackEnergy threat to further\nincrease visibility into the malware activity.\n\n## Analysis and Production – Using ThreatConnect to Associate Indicators\n\nNext we began grouping the indicators according to the three variants of BlackEnergy in\nThreatConnect, where we can easily and efficiently associate indicators and show\nrelationships using incidents, threats, and campaigns. Here’s how:\n\nBlackEnergy Threat\n\nThe first thing that we did to start pulling BlackEnergy indicators together was create a\n[BlackEnergy malware threat. Threats in the Platform are made up of incidents and activity](https://app.threatconnect.com/auth/threat/threat.xhtml?threat=974230)\ngroups defined by common infrastructure, common malware, and carried out by a common\nadversary or team. Our BlackEnergy Threat captured the information we learned about\nBlackEnergy during the prior phases of the intelligence cycle.\n\n\n-----\n\n_Screenshot of the BlackEnergy Threat in the ThreatConnect Common Community_\n\nWe also applied a few relevant tags such as the names of the malware variants, targeted\nindustry, and type of activity, and then associated the BlackEnergy malware threat group to\nthe preexisting Sandworm threat actor group. Tags provide another useful way to pivot\nthrough information of interest in ThreatConnect.\n\n_BlackEnergy Incidents_\n\nAfter building the BlackEnergy threat, we began compiling incidents for each variant of the\nmalware. These incidents have indicators associated to them, and allow us to organize our\n[work as we enrich those indicators. We started with a BlackEnergy 2 Malware Samples](https://app.threatconnect.com/auth/incident/incident.xhtml?incident=5366471)\nincident, [BlackEnergy 3 Malware Samples incident, and a BlackEnergy Malware incident.](https://app.threatconnect.com/auth/incident/incident.xhtml?incident=5365190)\n[Shortly thereafter we pulled together a Ukraine BlackEnergy 3 Attacks incident so that we](https://app.threatconnect.com/auth/incident/incident.xhtml?incident=5365191)\ncould move all of the indicators of compromise from that attack into one group.\n\n_BlackEnergy Malware Incidents_\n\nWe also associated two incidents that were already associated with the Sandworm threat\nactor and the CVE-2014-4114 vulnerabilities, as they had similar indicators and\ncharacteristics to the BlackEnergy 3 malware. From there, we began gathering BlackEnergy\nrelated indicators to associate to each incident.\n\n_BlackEnergy 3 Campaign_\n\n[After building the Threat and Incidents, we created a BlackEnergy 3 Campaign to organize](https://app.threatconnect.com/auth/campaign/campaign.xhtml?campaign=5365195)\nall of the BlackEnergy 3 related Incidents including the Ukraine BlackEnergy 3 Attacks, and\nBlackEnergy 3 Samples Incidents. We chose to create a campaign for this variant because\n\n\n-----\n\nwe found several reports\nwith different indicators,\nthat we felt needed\nindividual Incidents.\nGenerally, the purpose\nof creating a campaign in\nThreatConnect is to\nassociate together\nrelated incidents, or\nother campaigns.\n\n\n-----\n\n_BlackEnergy 3 Campaign in the ThreatConnect Common Community_\n\n## Dissemination and Integration\n\nInformation and data you found in ThreatConnect can be shared out to other users and other\ncommunities that you have access to. This includes our Common Community, which is\navailable to all of our wonderful users as well as the ThreatConnect Intelligence source,\nreserved for our paying customers. You can also download your Incidents, Indicators, and\nThreats as a PDF and copy other incidents to your research organization using the “Copy to\nMy Org” function to show to individuals that may not have access to ThreatConnect, so that\nthey can make informed decisions using ThreatConnect data. You are also able to follow\nincidents from other organizations and get immediate or summarized reports on changes\nmade to those incidents.\n\n\n-----\n\n## Making it Actionable\n\nNow that we have identified and pulled all of this information together in ThreatConnect and\nshared with appropriate parties, what happens next? As we like to say, intelligence doesn’t\nexist for its own sake: [it exists to inform decisions. Using the ThreatConnect Platform, the](https://threatconnect.com/blog/defining-security-orchestration/)\ninformation gathered can be used to make informed decisions about the threat posed by\nBlackEnergy, and prevent and respond effectively to incoming threats. ThreatConnect has\nnumerous integrations that make it easy to take action on information pulled together in the\n[Platform. The added functionality of ThreatConnect Playbooks further simplifies these](https://threatconnect.com/blog/act-faster-with-threatconnect-playbooks/)\nprocesses allowing users to quickly send indicators to be blocked, further analyzed by an\nautomated malware analysis service, or even assigned to an analyst.\n\n[Looking beyond ThreatConnect, recommendations like these from the ICS-CERT are other](https://ics-cert.us-cert.gov/alerts/ICS-ALERT-14-281-01B)\nways to protect ICS (Industrial Control Systems) and energy sector systems:\n\nMinimize network exposure for all control system devices. Control system devices\nshould not directly face the Internet.\nLocate control system networks and devices behind firewalls, and isolate them from the\nbusiness network\nIf remote access is required, employ secure methods, such as Virtual Private Networks\n(VPNs), recognizing that VPN is only as secure as the connected devices.\nRemove, disable, or rename any default system accounts wherever possible.\nApply patches in the ICS environment, when possible to mitigate known vulnerabilities\nImplement policies requiring the use of strong passwords.\nMonitor the creation of administrator level accounts by third-party vendors.\nLimiting remote systems or unmanned stations with sensitive information or computer\nsystems.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-09-18 - Casting a Light on BlackEnergy.pdf"
    ],
    "report_names": [
        "2017-09-18 - Casting a Light on BlackEnergy.pdf"
    ],
    "threat_actors": [
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7bd810cb-d674-4763-86eb-2cc182d24ea0",
            "created_at": "2022-10-25T16:07:24.1537Z",
            "updated_at": "2025-03-27T02:02:10.126127Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "APT 44",
                "ATK 14",
                "BE2",
                "Blue Echidna",
                "CTG-7263",
                "FROZENBARENTS",
                "IRIDIUM",
                "Iron Viking",
                "Quedagh",
                "Sandworm",
                "Sandworm Team",
                "Seashell Blizzard",
                "TEMP.Noble",
                "UAC-0082",
                "UAC-0113",
                "UAC-0125",
                "UAC-0133",
                "Voodoo Bear"
            ],
            "source_name": "ETDA:Sandworm Team",
            "tools": [
                "AWFULSHRED",
                "ArguePatch",
                "BIASBOAT",
                "Black Energy",
                "BlackEnergy",
                "CaddyWiper",
                "Colibri Loader",
                "Cyclops Blink",
                "CyclopsBlink",
                "DCRat",
                "DarkCrystal RAT",
                "Fobushell",
                "GOSSIPFLOW",
                "Gcat",
                "IcyWell",
                "Industroyer2",
                "JaguarBlade",
                "JuicyPotato",
                "Kapeka",
                "KillDisk.NCX",
                "LOADGRIP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "ORCSHRED",
                "P.A.S.",
                "PassKillDisk",
                "Pitvotnacci",
                "PsList",
                "QUEUESEED",
                "RansomBoggs",
                "RottenPotato",
                "SOLOSHRED",
                "SwiftSlicer",
                "VPNFilter",
                "Warzone",
                "Warzone RAT",
                "Weevly"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535536,
    "ts_updated_at": 1743041825,
    "ts_creation_date": 1653786537,
    "ts_modification_date": 1653786537,
    "files": {
        "pdf": "https://archive.orkl.eu/552ba9973547d0d264948f9b1dc912f5d2034837.pdf",
        "text": "https://archive.orkl.eu/552ba9973547d0d264948f9b1dc912f5d2034837.txt",
        "img": "https://archive.orkl.eu/552ba9973547d0d264948f9b1dc912f5d2034837.jpg"
    }
}