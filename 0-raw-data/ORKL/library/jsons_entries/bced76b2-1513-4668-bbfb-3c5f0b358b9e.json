{
    "id": "bced76b2-1513-4668-bbfb-3c5f0b358b9e",
    "created_at": "2023-01-12T15:06:19.41763Z",
    "updated_at": "2025-03-27T02:05:28.47509Z",
    "deleted_at": null,
    "sha1_hash": "dacbb34d5513012a9213592d9ea5260cbd27a1f8",
    "title": "2021-12-02 - Alert (AA21-336A)- APT Actors Exploiting CVE-2021-44077 in Zoho ManageEngine ServiceDesk Plus",
    "authors": "",
    "file_creation_date": "2022-05-29T01:07:23Z",
    "file_modification_date": "2022-05-29T01:07:23Z",
    "file_size": 145105,
    "plain_text": "# APT Actors Exploiting CVE-2021-44077 in Zoho ManageEngine ServiceDesk Plus\n\n**us-cert.cisa.gov/ncas/alerts/aa21-336a**\n\n## Summary\n\n_This joint Cybersecurity Advisory uses the MITRE Adversarial Tactics, Techniques, and_\n_Common Knowledge (ATT&CK®) framework, Version 9. See the_ _ATT&CK for Enterprise_\n_framework for referenced threat actor techniques and for mitigations._\n\nThis joint advisory is the result of analytic efforts between the Federal Bureau of Investigation\n(FBI) and the Cybersecurity and Infrastructure Security Agency (CISA) to highlight the cyber\nthreat associated with active exploitation of a newly identified vulnerability (CVE-202144077) in Zoho ManageEngine ServiceDesk Plus—IT help desk software with asset\nmanagement.\n\nCVE-2021-44077, which Zoho rated critical, is an unauthenticated remote code execution\n(RCE) vulnerability affecting all ServiceDesk Plus versions up to, and including, version\n11305. This vulnerability was addressed by the update released by Zoho on September 16,\n2021 for ServiceDesk Plus versions 11306 and above. The FBI and CISA assess that\nadvanced persistent threat (APT) cyber actors are among those exploiting the vulnerability.\nSuccessful exploitation of the vulnerability allows an attacker to upload executable files and\nplace webshells, which enable the adversary to conduct post-exploitation activities, such as\ncompromising administrator credentials, conducting lateral movement, and exfiltrating\nregistry hives and Active Directory files.\n\nThe Zoho update that patched this vulnerability was released on September 16, 2021, along\nwith a [security advisory. Additionally, an email advisory was sent to all ServiceDesk Plus](https://pitstop.manageengine.com/portal/en/community/topic/security-advisory-authentication-bypass-vulnerability-in-servicedesk-plus-versions-11138-and-above)\ncustomers with additional information. Zoho released a subsequent security advisory on\nNovember 22, 2021, and advised customers to patch immediately.\n\nThe FBI and CISA are aware of reports of malicious cyber actors likely using exploits against\n[CVE-2021-44077 to gain access [T1190] to ManageEngine ServiceDesk Plus, as early as](https://attack.mitre.org/versions/v9/techniques/T1190/)\nlate October 2021. The actors have been observed using various tactics, techniques and\nprocedures (TTPs), including:\n\n[Writing webshells [T1505.003] to disk for initial persistence](https://attack.mitre.org/versions/v9/techniques/T1505/003/)\n[Obfuscating and Deobfuscating/Decoding Files or Information [T1027 and](https://attack.mitre.org/versions/v9/techniques/T1027/) [T1140]](https://attack.mitre.org/versions/v9/techniques/T1140/)\n[Conducting further operations to dump user credentials [T1003]](https://attack.mitre.org/versions/v9/techniques/T1003/)\n[Living off the land by only using signed Windows binaries for follow-on actions [T1218]](https://attack.mitre.org/versions/v9/techniques/T1218/)\n[Adding/deleting user accounts as needed [T1136]](https://attack.mitre.org/versions/v9/techniques/T1136/)\n\n\n-----\n\n[Stealing copies of the Active Directory database ( NTDS.dit ) [T1003.003] or registry](https://attack.mitre.org/versions/v9/techniques/T1003/003/)\nhives\n[Using Windows Management Instrumentation (WMI) for remote execution [T1047]](https://attack.mitre.org/versions/v9/techniques/T1047/)\n[Deleting files to remove indicators from the host [T1070.004]](https://attack.mitre.org/versions/v9/techniques/T1070/004/)\n[Discovering domain accounts with the net Windows command [T1087.002]](https://attack.mitre.org/versions/v9/techniques/T1087/002/)\n[Using Windows utilities to collect and archive files for exfiltration [T1560.001]](https://attack.mitre.org/versions/v9/techniques/T1560/001/)\n[Using custom symmetric encryption for command and control (C2) [T1573.001]](https://attack.mitre.org/versions/v9/techniques/T1573/001/)\n\nThe FBI and CISA are proactively investigating this malicious cyber activity:\n\nThe FBI leverages specially trained cyber squads in each of its 56 field offices and\nCyWatch, the FBI’s 24/7 operations center and watch floor, which provides around-theclock support to track incidents and communicate with field offices across the country\nand partner agencies.\nCISA offers a range of no-cost cyber hygiene services to help organizations assess,\nidentify, and reduce their exposure to threats. By requesting these services,\norganizations of any size could find ways to reduce their risk and mitigate attack\nvectors.\n\nSharing technical and/or qualitative information with the FBI and CISA helps empower and\namplify our capabilities as federal partners to collect and share intelligence and engage with\nvictims, while working to unmask and hold accountable those conducting malicious cyber\nactivities.\n\n[Click here for a PDF version of this report.](https://us-cert.cisa.gov/sites/default/files/AA21-336A_APT_Actors_Exploiting_CVE-2021-44077_in_Zoho_ManageEngine_ServiceDesk_Plus.pdf)\n\n[Click here for indicators of compromise (IOCs) in STIX format.](https://us-cert.cisa.gov/sites/default/files/AA21-336A%20APT%20Actors%20Exploiting%20CVE-2021-44077%20in%20Zoho%20ManageEngine%20ServiceDesk%20Plus.stix.xml)\n\n## Technical Details\n\nCompromise of the affected systems involves exploitation of CVE-2021-44077 in\nServiceDesk Plus, allowing the attacker to:\n\n1. Achieve an unrestricted file upload through a POST request to the ServiceDesk REST\n\nAPI URL and upload an executable file,\n```\n   C:\\ManageEngine\\Servicedesk\\bin\\msiexec.exe, with a SHA256 hash of\n   ecd8c9967b0127a12d6db61964a82970ee5d38f82618d5db4d8eddbb3b5726b7 . This\n\n```\nexecutable file serves as a dropper and contains an embedded, encoded Godzilla JAR\nfile.\n2. Gain execution for the dropper through a second POST request to a different REST\n\nAPI URL, which will then decode the embedded Godzilla JAR file and drop it to the\nfilepath `C:\\ManageEngine\\ServiceDesk\\lib\\tomcat\\tomcat-postgres.jar with a`\nSHA256 hash of\n```\n   67ee552d7c1d46885b91628c603f24b66a9755858e098748f7e7862a71baa015 .\n\n```\n\n-----\n\nConfirming a successful compromise of ManageEngine ServiceDesk Plus may be difficult—\nthe attackers are known to run clean-up scripts designed to remove traces of the initial point\nof compromise and hide any relationship between exploitation of the vulnerability and the\nwebshell.\n\n**Targeted Industries**\n\nAPT cyber actors have targeted Critical Infrastructure Sector industries, including the\nhealthcare, financial services, electronics and IT consulting industries.\n\n## Indicators of Compromise\n\n**Hashes**\n\n_Webshell:_\n```\n67ee552d7c1d46885b91628c603f24b66a9755858e098748f7e7862a71baa015\n068D1B3813489E41116867729504C40019FF2B1FE32AAB4716D429780E666324\n759bd8bd7a71a903a26ac8d5914e5b0093b96de61bf5085592be6cc96880e088\n262cf67af22d37b5af2dc71d07a00ef02dc74f71380c72875ae1b29a3a5aa23d\na44a5e8e65266611d5845d88b43c9e4a9d84fe074fd18f48b50fb837fa6e429d\nce310ab611895db1767877bd1f635ee3c4350d6e17ea28f8d100313f62b87382\n75574959bbdad4b4ac7b16906cd8f1fd855d2a7df8e63905ab18540e2d6f1600\n5475aec3b9837b514367c89d8362a9d524bfa02e75b85b401025588839a40bcb\n\n```\n_Dropper:_\n\n```\necd8c9967b0127a12d6db61964a82970ee5d38f82618d5db4d8eddbb3b5726b7\n\n```\n\n_Implant:_\n```\n009d23d85c1933715c3edcccb46438690a66eebbcccb690a7b27c9483ad9d0ac\n083bdabbb87f01477f9cf61e78d19123b8099d04c93ef7ad4beb19f4a228589a\n342e85a97212bb833803e06621170c67f6620f08cc220cf2d8d44dff7f4b1fa3\n\n```\n_NGLite Backdoor:_\n```\n805b92787ca7833eef5e61e2df1310e4b6544955e812e60b5f834f904623fd9f\n3da8d1bfb8192f43cf5d9247035aa4445381d2d26bed981662e3db34824c71fd\n5b8c307c424e777972c0fa1322844d4d04e9eb200fe9532644888c4b6386d755\n3f868ac52916ebb6f6186ac20b20903f63bc8e9c460e2418f2b032a207d8f21d\n342a6d21984559accbc54077db2abf61fd9c3939a4b09705f736231cbc7836ae\n7e4038e18b5104683d2a33650d8c02a6a89badf30ca9174576bf0aff08c03e72\n\n```\n_KDC Sponge:_\n```\n3c90df0e02cc9b1cf1a86f9d7e6f777366c5748bd3cf4070b49460b48b4d4090\nb4162f039172dcb85ca4b85c99dd77beb70743ffd2e6f9e0ba78531945577665\ne391c2d3e8e4860e061f69b894cf2b1ba578a3e91de610410e7e9fa87c07304c\n\n```\n\n-----\n\n_Malicious IIS Module:_\n\n```\nbec067a0601a978229d291c82c35a41cd48c6fca1a3c650056521b01d15a72da\n\n```\n\n_Renamed WinRAR:_\n\n```\nd0c3d7003b7f5b4a3bd74a41709cfecfabea1f94b47e1162142de76aa7a063c7\n\n```\n\n_Renamed csvde:_\n\n```\n7d2780cd9acc516b6817e9a51b8e2889f2dec455295ac6e6d65a6191abadebff\n\n```\n\n## Network Indicators\n\nPOST requests sent to the following URLs:\n\n```\n/RestAPI/ImportTechnicians?step=1\n\n```\n\n**_Domains:_**\n\n```\nseed.nkn[.]org\n\n```\n\n**Note: the domain seed.nkn[.]org is a New Kind of Network (NKN) domain that provides**\nlegitimate peer to peer networking services utilizing blockchain technology for\ndecentralization. It is possible to have false positive hits in a corporate network environment\nand it should be considered suspicious to see any software-initiated contacts to this domain\nor any subdomain.\n\n## Log File Analysis\n\nCheck serverOut*.txt log files under C:\\ManageEngine\\ServiceDesk\\logs\\ for\nsuspicious log entries matching the following format:\n```\n      [<time>]|[<date>]|\n      [com.adventnet.servicedesk.setup.action.ImportTechniciansAction]|\n      [INFO]|[62]: fileName is : msiexec.exe]\n\n## Filepaths\n\n```\nC:\\ManageEngine\\ServiceDesk\\bin\\msiexec.exe\n\nC:\\ManageEngine\\ServiceDesk\\lib\\tomcat\\tomcat-postgres.jar\n\nC:\\Windows\\Temp\\ScriptModule.dll\n\nC:\\ManageEngine\\ServiceDesk\\bin\\ScriptModule.dll\n\nC:\\Windows\\system32\\ME_ADAudit.exe\n\nc:\\Users\\[username]\\AppData\\Roaming\\ADManager\\ME_ADManager.exe\n\n%ALLUSERPROFILE%\\Microsoft\\Windows\\Caches\\system.dat\n\nC:\\ProgramData\\Microsoft\\Crypto\\RSA\\key.dat\n\nc:\\windows\\temp\\ccc exe\n\n\n-----\n\n## Tactics, Techniques, and Procedures\n\nUsing WMI for lateral movement and remote code execution (in particular, `wmic.exe )`\nUsing plaintext credentials for lateral movement\nUsing `pg_dump.exe to dump ManageEngine databases`\nDumping `NTDS.dit and` `SECURITY/SYSTEM/NTUSER registry hives`\nActive credential harvesting through `LSASS (KDC Sponge)`\nExfiltrating through webshells\nConducting exploitation activity often through other compromised U.S. infrastructure\nDropping multiple webshells and/or implants to maintain persistence\nUsing renamed versions of `WinRAR,` `csvde, and other legitimate third-party tools for`\nreconnaissance and exfiltration\n\n## Yara Rules\n\nrule ReportGenerate_jsp {\n\nstrings:\n\n$s1 = \"decrypt(fpath)\"\n\n$s2 = \"decrypt(fcontext)\"\n\n$s3 = \"decrypt(commandEnc)\"\n\n$s4 = \"upload failed!\"\n\n$s5 = \"sevck\"\n\n$s6 = \"newid\"\n\ncondition:\n\nfilesize < 15KB and 4 of them\n\n}\n\nrule EncryptJSP {\n\nstrings:\n\n$s1 = \"AEScrypt\"\n\n$s2 = \"AES/CBC/PKCS5Padding\"\n\n$s3 = \"SecretKeySpec\"\n$s4 = \"FileOutputStream\"\n\n$s5 = \"getParameter\"\n\n$s6 = \"new ProcessBuilder\"\n\n$s7 = \"new BufferedReader\"\n\n$s8 = \"readLine()\"\n\ncondition:\n\nfilesize < 15KB and 6 of them\n\n}\n\nrule ZimbraImplant {\n\nstrings:\n$u1 = \"User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36\n\n\n-----\n\n(KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36\n$u2 = \"Content-Type: application/soap+xml; charset=UTF-8\"\n$u3 = \"/service/soap\"\n$u4 = \"Good Luck :::)\"\n$s1 = \"zimBR\"\n$s2 = \"log10\"\n$s3 = \"mymain\"\n$s4 = \"urn:zimbraAccount\"\n$s5 = \"/service/upload?fmt=extended,raw\"\n$s6 = \"<query>(in:\\\"inbox\\\" or in:\\\"junk\\\") is:unread</query>\"\ncondition:\n(uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and filesize < 2MB and\n1 of ($u*) and 3 of ($s*)\n}\n\nrule GodzillaDropper {\nstrings:\n$s1 = \"UEsDBAoAAAAAAI8UXFM\" // base64 encoded PK/ZIP header\n$s2 = \"../lib/tomcat/tomcat-postgres.jar\"\n$s3 = \"RunAsManager.exe\"\n$s4 = \"ServiceDesk\"\n$s5 = \"C:\\\\Users\\\\pwn\\\\documents\\\\visual studio 2015\\\\Projects\\\\payloaddll\"\n$s6 = \"CreateMutexA\"\n$s7 = \"cplusplus_me\"\ncondition:\n(uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and filesize < 350KB\nand 4 of them\n}\n\nrule GodzillaJAR {\nstrings:\n$s1 = \"org/apache/tomcat/SSLFilter.class\"\n$s2 = \"META-INF/services/javax.servlet.ServletContainerInitializer\"\n$s3 = \"org/apache/tomcat/MainFilterInitializer.class\"\ncondition:\nuint32(0) == 0x04034B50 and filesize < 50KB and all of them\n}\n\nrule APT_NGLite {\nstrings:\n$s1 = \"/mnt/hgfs/CrossC2-2.2\"\n$s2 = \"WHATswrongwithU\"\n$s3 = \"//seed.nkn.org:\"\n\n\n-----\n\n$s4 = Preylistener\n$s5 = \"preyid\"\n$s6 = \"Www-Authenticate\"\ncondition:\n(uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and filesize < 15MB\nand 4 of them\n}\n\nrule KDCSponge {\nstrings:\n$k1 = \"kdcsvc.dll\"\n$k2 = \"kdccli.dll\"\n$k3 = \"kdcsvs.dll\"\n$f1 = \"KerbHashPasswordEx3\"\n$f2 = \"KerbFreeKey\"\n$f3 = \"KdcVerifyEncryptedTimeStamp\"\n$s1 = \"download//symbols//%S//%S//%S\" wide\n$s2 = \"KDC Service\"\n$s3 = \"\\\\system.dat\"\ncondition:\n(uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and filesize < 1MB and\n1 of ($k*) and 1 of ($f*) and 1 of ($s*)\n\n## Mitigations\n\n Compromise Mitigations\n\nOrganizations that identify any activity related to ManageEngine ServiceDesk Plus indicators\nof compromise within their networks should take action immediately.\n\nZoho ManageEngine ServiceDesk Plus build 11306, or higher, fixes CVE-2021-44077.\nManageEngine initially released a patch for this vulnerability on September 16, 2021. A\nsubsequent security advisory was released on November 22, 2021, and advised customers\nto patch immediately. Additional information can be found in the Zoho security advisory\nreleased on November 22, 2021.\n\nIn addition, [Zoho has set up a security response plan center that provides additional details,](https://www.manageengine.com/products/service-desk/security-response-plan.html)\na downloadable tool that can be run on potentially affected systems, and a remediation\nguide.\n\nFBI and CISA also strongly recommend domain-wide password resets and double Kerberos\nTGT password resets if any indication is found that the `NTDS.dit file was compromised.`\n\n\n-----\n\n**Note: Implementing these password resets should not be taken as a comprehensive**\nmitigation in response to this threat; additional steps may be necessary to regain\nadministrative control of your network. Refer to your specific products mitigation guidance for\ndetails.\n\n## Actions for Affected Organizations\n\n[Immediately report as an incident to CISA or the](https://us-cert.cisa.gov/report) [FBI (refer to Contact information section](http://10.10.0.46/mailto:CyWatch@fbi.gov)\nbelow) the existence of any of the following:\n\nIdentification of indicators of compromise as outlined above.\nPresence of webshell code on compromised ServiceDesk Plus servers.\nUnauthorized access to or use of accounts.\nEvidence of lateral movement by malicious actors with access to compromised\nsystems.\nOther indicators of unauthorized access or compromise.\n\n## Contact Information\n\nRecipients of this report are encouraged to contribute any additional information that they\nmay have related to this threat.\n\nFor any questions related to this report or to report an intrusion and request resources for\nincident response or technical assistance, please contact:\n\n[The FBI through the FBI Cyber Division (855-292-3937 or CyWatch@fbi.gov) or a](http://10.10.0.46/mailto:CyWatch@fbi.gov) local\nfield office\n[CISA (888-282-0870 or Central@cisa.dhs.gov).](http://10.10.0.46/mailto:Central@cisa.dhs.gov)\n\n## Revisions\n\nDecember 2, 2021: Initial version\n\nDecember 6, 2021: STIX file added\n\n[This product is provided subject to this Notification and this](https://us-cert.cisa.gov/privacy/notification) [Privacy & Use policy.](https://www.dhs.gov/privacy-policy)\n\n**Please share your thoughts.**\n\n[We recently updated our anonymous product survey; we'd welcome your feedback.](https://www.surveymonkey.com/r/CISA-cyber-survey?product=https://us-cert.cisa.gov/ncas/alerts/aa21-336a)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-12-02 - Alert (AA21-336A)- APT Actors Exploiting CVE-2021-44077 in Zoho ManageEngine ServiceDesk Plus.pdf"
    ],
    "report_names": [
        "2021-12-02 - Alert (AA21-336A)- APT Actors Exploiting CVE-2021-44077 in Zoho ManageEngine ServiceDesk Plus.pdf"
    ],
    "threat_actors": [
        {
            "id": "bfded1cf-be73-44f9-a391-0751c9996f9a",
            "created_at": "2022-10-25T15:50:23.337107Z",
            "updated_at": "2025-03-27T02:00:55.445946Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "FIN7",
                "GOLD NIAGARA",
                "ITG14",
                "Carbon Spider",
                "ELBRUS",
                "Sangria Tempest"
            ],
            "source_name": "MITRE:FIN7",
            "tools": [
                "Mimikatz",
                "AdFind",
                "JSS Loader",
                "HALFBAKED",
                "REvil",
                "PowerSploit",
                "CrackMapExec",
                "Carbanak",
                "Pillowmint",
                "Cobalt Strike",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRat",
                "Lizar",
                "TEXTMATE",
                "BOOSTWRITE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "bb8702c5-52ac-4359-8409-998a7cc3eeaf",
            "created_at": "2023-01-06T13:46:38.405479Z",
            "updated_at": "2025-03-27T02:00:02.82533Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "JokerStash",
                "ATK32",
                "G0046",
                "Coreid",
                "Carbanak",
                "Sangria Tempest",
                "CARBON SPIDER",
                "GOLD NIAGARA",
                "G0008",
                "ELBRUS",
                "Carbon Spider"
            ],
            "source_name": "MISPGALAXY:FIN7",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d85adfe3-e1c3-40b0-b8bb-d1bacadc4d82",
            "created_at": "2022-10-25T16:07:23.619566Z",
            "updated_at": "2025-03-27T02:02:09.890982Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "APT-C-11",
                "ATK 32",
                "Gold Niagara",
                "ITG14",
                "TAG-CR1"
            ],
            "source_name": "ETDA:FIN7",
            "tools": [
                "7Logger",
                "Agentemis",
                "Anunak",
                "Astra",
                "BIOLOAD",
                "BIRDWATCH",
                "Bateleur",
                "Boostwrite",
                "CROWVIEW",
                "Carbanak",
                "Cobalt Strike",
                "CobaltStrike",
                "DICELOADER",
                "DNSMessenger",
                "FOWLGAZE",
                "HALFBAKED",
                "JSSLoader",
                "KillACK",
                "LOADOUT",
                "Lizar",
                "Meterpreter",
                "Mimikatz",
                "POWERPLANT",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "TEXTMATE",
                "Tirion",
                "VB Flash",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535979,
    "ts_updated_at": 1743041128,
    "ts_creation_date": 1653786443,
    "ts_modification_date": 1653786443,
    "files": {
        "pdf": "https://archive.orkl.eu/dacbb34d5513012a9213592d9ea5260cbd27a1f8.pdf",
        "text": "https://archive.orkl.eu/dacbb34d5513012a9213592d9ea5260cbd27a1f8.txt",
        "img": "https://archive.orkl.eu/dacbb34d5513012a9213592d9ea5260cbd27a1f8.jpg"
    }
}