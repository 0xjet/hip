{
    "id": "fad8b2a7-4698-4df1-8cd7-995c89b4bc73",
    "created_at": "2023-01-12T15:00:23.82272Z",
    "updated_at": "2025-03-27T02:16:41.170749Z",
    "deleted_at": null,
    "sha1_hash": "9f591bf49de7a89e9504a872791d1c64080bac89",
    "title": "2016-01-22 - Sykipot APT Malware",
    "authors": "",
    "file_creation_date": "2022-05-28T19:05:43Z",
    "file_modification_date": "2022-05-28T19:05:43Z",
    "file_size": 466369,
    "plain_text": "# NetWitness Community\n\n**community.rsa.com/thread/185437**\n\n## Information\n\nMalware Family/Aliases: Sykipot\n\nMalware Type: Trojan/Backdoor:Win32\n\nPlatform: Windows\n\nMD5: 4f90ffbdf64fd1b2b96324378007aa8c\n\nSHA1: 736537d5c264e5a784d3fda128d9d8e7f88f8274\n\n\nJanuary 22, 2016\n\n\nSHA256: c13eb82839e133da2c8881c6690c91f3e20e145050b8b58ffef206335fd38e77\n\nMD5: 1747e47baee61e06d1ee0e4d1c3649bf\n\nSHA1: 06bb28927fe12aeb5e70d2e518abf5b9796cda9d\n\nSHA256: 5ce4a75d368a337cfbd16c8eab3b8fbd0fb99d1d7d3d27636a9b36e9fa0e4859\n\nDiscovery Date: 2007\n\n## Summary\n\nSykipot is an APT malware family that is around since 2007 and is used as a backdoor to\nfully control the victim’s machine. Once the machine is infected, the backdoor communicates\nwith the C&C server to execute several kinds of commands on the affected system. Sykipot\nAPT malware family has been used by cybercriminals on targeted attacks in order to steal\nsensitive information from key industries.\n\nNotable features of this malware family are the ability to execute both command prompt and\nbackdoor commands sent by the C&C server on the affected system, so that it can be able to\nretrieve system and network information, reboot the system, manage processes (list,\nexecute, kill and etc.), manage files (list, read, delete, copy and etc.), uninstall itself from the\nsystem and so on. This malware family is also able to send and receive files to and from the\nC&C server and to configure a delay timer for the next communication time with the C&C\nserver.\n\n## Malware Installation\n\n[c13eb82839e133da2c8881c6690c91f3e20e145050b8b58ffef206335fd38e77]\n\n\n-----\n\nThis malware sample is an executable file that pretends to be a Merry Christmas image file.\nWhen the executable file is executed, the image is extracted and displayed to the user:\n\nRight after that, the malware creates an msrt.exe file in temp folder:\n\n%Temp%\\msrt.exe\n\nThe malware then installs a fake Help and Support Center service that pretends to be\noriginal’s Windows Help and Support service:\n\nThis is done by calling Windows APIs to install the new service and by adding and setting the\nfollowing Registry entries:\n\n_HKLM\\SYSTEM\\ControlSet001\\Services\\helpsvcc\\ImagePath:_\n_\"C:\\WINDOWS\\system32\\msrt.exe\"_\n\n_HKLM\\SYSTEM\\ControlSet001\\Services\\helpsvcc\\DisplayName: \"Help and Support Center\"_\n\n_HKLM\\SYSTEM\\ControlSet001\\Services\\helpsvcc\\Description: \"Enables Help and Support_\n_Center to run on this computer. If this service is stopped, Help and Support Center will be_\n_unavailable. If this service is disabled, any services that explicitly depend on it will fail to_\n_start.\"_\n\n_HKLM\\SYSTEM\\CurrentControlSet\\Services\\helpsvcc\\ImagePath:_\n_\"C:\\WINDOWS\\system32\\msrt.exe\"_\n\n_HKLM\\SYSTEM\\CurrentControlSet\\Services\\helpsvcc\\DisplayName: \"Help and Support_\n_Center\"_\n\n\n-----\n\n_HKLM\\SYSTEM\\CurrentControlSet\\Services\\helpsvcc\\Description: Enables Help and_\n_Support Center to run on this computer. If this service is stopped, Help and Support Center_\n_will be unavailable. If this service is disabled, any services that explicitly depend on it will fail_\n_to start.\"_\n\nNext, the malware persists itself at\n\n%WINDIR%\\system32\\msrt.exe\n\nDeletes itself from\n\n%Temp%\\msrt.exe\n\nAnd start the newly created Help and Support Center service, which points to\n%WINDIR%\\system32\\msrt.exe.\n\nThis instance of the malware will extract malicious code and write file\n%WINDIR%\\system32\\wship4.dll, which pretends to be an IPv4 Helper DLL from Microsoft\nCorporation:\n\nThe malware creates a hidden instance of Internet Explorer browser and makes it use\n%WINDIR%\\system32\\wship4.dll to serve as backdoor to communicate with the C&C server\nand execute commands on the affected machine:\n\n\n-----\n\nFinally, after the backdoor is running, the malware stops newly created Help and Support\nCenter service.\n\n[5ce4a75d368a337cfbd16c8eab3b8fbd0fb99d1d7d3d27636a9b36e9fa0e4859]\n\nThis malware sample is an executable file that pretends to be a girl image file. When the\nexecutable file is executed, the image is extracted and displayed to the user:\n\nRight after that, the malware creates a siop.exe file in temp folder:\n\n%Temp%\\siop.exe\n\nExactly as the previous sample, the malware extracts malicious code and write file\n%Temp%\\rsm.dll, which also pretends to be an IPv4 Helper DLL from Microsoft Corporation.\nThe malware then creates a hidden instance of Internet Explorer browser and makes it use\n%Temp%\\rsm.dll to serve as backdoor to communicate with the C&C server and execute\ncommands on the affected machine.\n\n\n-----\n\n## Malware Protective Mechanisms\n\n[c13eb82839e133da2c8881c6690c91f3e20e145050b8b58ffef206335fd38e77]\n\nTo protect the dropped files, the malware clones all date timestamp file properties from\noriginal’s system file svchost.exe to dropped files msrt.exe and wship4.dll, making them look\nauthentic.\n\nThe malware also creates and runs a hidden instance of Internet Explorer browser with\ncurrent user’s credentials by using current user’s token, which is retrieved by looping through\nthe list of processes and retrieving Windows Explorer current user’s token.\n\n[5ce4a75d368a337cfbd16c8eab3b8fbd0fb99d1d7d3d27636a9b36e9fa0e4859]\n\nExactly as the previous sample, the malware also creates and runs a hidden instance of\nInternet Explorer browser with current user’s credentials by using current user’s token, which\nis retrieved by looping through the list of processes and retrieving Windows Explorer current\nuser’s token.\n\n## Malware Persistency Techniques\n\n[c13eb82839e133da2c8881c6690c91f3e20e145050b8b58ffef206335fd38e77]\n\nAs mentioned before, the malware installs it as a Windows service and is configured to\nautomatically start during Windows startup (start type equals to “2”):\n\n_HKLM\\SYSTEM\\ControlSet001\\Services\\helpsvcc\\Start: 0x00000002_\n\n_HKLM\\SYSTEM\\CurrentControlSet\\Services\\helpsvcc\\Start: 0x00000002_\n\n[5ce4a75d368a337cfbd16c8eab3b8fbd0fb99d1d7d3d27636a9b36e9fa0e4859]\n\nTo make itself persistent, the malware configures itself to be run during Windows startup. It\ndoes this by adding the following registry key.\n\n_RegKey:_\n\n_HKU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\start:_\n\n_Value:_\n\n_start_\n\n_Data:_\n\n_\"%Temp%\\siop.exe -install\"_\n\n\n-----\n\n## Network Behavior\n\nSome of the malware samples try to connect to the following domains:\n\nmotor.hyundei-motor.com\nonesfocus.com\nstrongtable.3322.org\nnotes.topix21century.com\nmap.kortimes.com\nchosunkor.com\nracingfax.com\nnews.marinetimemac.com\nhotgreenlight.com\nsports.hotgreenlight.com\nmysundayparty.com\nnews.mysundayparty.com\nmovieshowgirl.com\nmoto.sourceinsightonline.com\nhappybehere.com\nmusic.defense-association.com\naltchksrv.hostdefence.net\n\nOnce the backdoor is active, the malware communicates with the C&C server from time to\ntime and can execute commands on the affected machine.\n\nThe malware pings the C&C by using a GET request that follows the pattern:\n\nhttp://[C&C_Domain]/asp/kys_allow_get.asp?name=getkys.[jpg|dat|kys]&hostname=\n\n[Computer_Name]-[IP_Address]-[Unique_Identifier]\n\nSome versions of the malware have the ability to read a delay timer information from the\nconfiguration file retrieved from the C&C server. This will be used to configure the time\ninterval of the communication between the malware and the C&C server. The purpose of this\nfeature is to make it hard to be detected by analysis tools.\n\n## Security Analytics Solution\n\nThe following query can be used to detect Sykipot network activity using RSA Security\nAnalytics:\n\n**action = 'get' && filename = 'kys_allow_get.asp' && query begins 'name='**\n\n[More details can be found here.](https://community.rsa.com/thread/185436)\n\n\n-----\n\n## Researcher\n\nNorton Santos\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-01-22 - Sykipot APT Malware.pdf"
    ],
    "report_names": [
        "2016-01-22 - Sykipot APT Malware.pdf"
    ],
    "threat_actors": [
        {
            "id": "68cc6e37-f16d-4995-a75b-5e8e2a6cbb3d",
            "created_at": "2024-05-01T02:03:07.943593Z",
            "updated_at": "2025-03-27T02:05:17.259709Z",
            "deleted_at": null,
            "main_name": "BRONZE EDISON",
            "aliases": [
                "DarkSeoul",
                "Maverick Panda ",
                "Sykipot ",
                "TG-0623 ",
                "getkys",
                "APT4 "
            ],
            "source_name": "Secureworks:BRONZE EDISON",
            "tools": [
                " Wkysol",
                " ZxPortMap",
                "Gh0st RAT"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "d4ac28d1-66eb-4f2d-9f9b-a72394349fd0",
            "created_at": "2023-01-06T13:46:38.667954Z",
            "updated_at": "2025-03-27T02:00:02.887442Z",
            "deleted_at": null,
            "main_name": "APT4",
            "aliases": [
                "PLA Navy",
                "MAVERICK PANDA",
                "BRONZE EDISON",
                "SODIUM",
                "Salmon Typhoon"
            ],
            "source_name": "MISPGALAXY:APT4",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6fbff48b-7a3e-4e54-ac22-b10f11e32337",
            "created_at": "2022-10-25T16:07:23.318008Z",
            "updated_at": "2025-03-27T02:02:09.734465Z",
            "deleted_at": null,
            "main_name": "APT 4",
            "aliases": [
                "APT 4",
                "Bronze Edison",
                "Maverick Panda",
                "Salmon Typhoo",
                "Sodium",
                "Sykipot",
                "TG-0623",
                "Wisp Team"
            ],
            "source_name": "ETDA:APT 4",
            "tools": [
                "Getkys",
                "Sykipot",
                "Wkysol",
                "XMRig"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535623,
    "ts_updated_at": 1743041801,
    "ts_creation_date": 1653764743,
    "ts_modification_date": 1653764743,
    "files": {
        "pdf": "https://archive.orkl.eu/9f591bf49de7a89e9504a872791d1c64080bac89.pdf",
        "text": "https://archive.orkl.eu/9f591bf49de7a89e9504a872791d1c64080bac89.txt",
        "img": "https://archive.orkl.eu/9f591bf49de7a89e9504a872791d1c64080bac89.jpg"
    }
}