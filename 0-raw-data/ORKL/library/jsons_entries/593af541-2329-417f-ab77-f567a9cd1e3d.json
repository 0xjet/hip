{
    "id": "593af541-2329-417f-ab77-f567a9cd1e3d",
    "created_at": "2023-01-12T15:03:14.369348Z",
    "updated_at": "2025-03-27T02:14:02.523663Z",
    "deleted_at": null,
    "sha1_hash": "7d762deff367229f51571ba3496796e7fdc8432d",
    "title": "2018-03-08 - New investigations into the CCleaner incident point to a possible third stage that had keylogger capacities",
    "authors": "",
    "file_creation_date": "2022-05-28T21:56:24Z",
    "file_modification_date": "2022-05-28T21:56:24Z",
    "file_size": 2059726,
    "plain_text": "# New investigations into the CCleaner incident point to a possible third stage that had keylogger capacities\n\n**[blog.avast.com/new-investigations-in-ccleaner-incident-point-to-a-possible-third-stage-that-had-keylogger-capacities](https://blog.avast.com/new-investigations-in-ccleaner-incident-point-to-a-possible-third-stage-that-had-keylogger-capacities)**\n\nActivity was found in Piriform network although not on any of the CCleaner customers’ PCs\n\n[Following the CCleaner incident last year, we have continued to investigate what happened](https://blog.avast.com/additional-information-regarding-the-recent-ccleaner-apt-security-incident)\n[and have shared our latest insights at the Security Security Analyst Summit today.](https://sas.kaspersky.com/)\n\nTo recap, on September 18, 2017, we disclosed that CCleaner had been targeted by\ncybercriminals, in order to distribute malware via the CCleaner installation file. The altered\ninstallation file was downloaded by 2.27 million CCleaner customers worldwide. The malware\nwas introduced to the build server of Piriform, the company developing CCleaner, some time\nbetween March 11 and July 4, 2017, prior to Avast’s acquisition of Piriform on July 18, 2017.\n\n[The first stage of the malware was designed to collect non-sensitive information from](https://www.ccleaner.com/news/blog/2017/9/18/security-notification-for-ccleaner-v5336162-and-ccleaner-cloud-v1073191-for-32-bit-windows-users)\nCCleaner users, including, for example, name of the computer, list of installed software, and\na list of running processes. The first stage included downloader capabilities, which were\nused to download a second stage binary onto just 40 PCs out of the millions of devices\ninfected with stage one, making it a highly targeted attack. Up until now, we don’t have any\nevidence that a third stage binary has been downloaded onto the affected computers.\nHowever, we have found evidence of activity that could indicate what the intended third stage\nof the attack could have looked like.\n\n\n-----\n\nTo eliminate the threat from the Piriform network, we migrated the Piriform build environment\nto the Avast infrastructure, replaced all hardware and moved the entire Piriform staff onto the\nAvast-internal IT system. We consolidated and inspected the Piriform infrastructure and\ncomputers, and found preliminary versions of the stage one and stage two binaries on these,\nand we found evidence of a specialized tool, ShadowPad, which is used by a specific group\nof cybercriminals, installed on four Piriform computers.\n\nShadowPad is a cyber attack platform that cybercriminals deploy in victims’ networks to gain\n[remote control capabilities, and has been analyzed in the past. The tool was installed on the](https://www.kaspersky.com/about/press-releases/2017_shadowpad-how-attackers-hide-backdoor-in-software-used-by-hundreds-of-large-companies-around-the-world)\nfour Piriform computers on April 12th, 2017, while the preliminary version of stage two had\nbeen installed on the computers on March 12th, 2017.\n\nThe older version of the stage two downloader was contacting CnC servers, but the servers\nwere no longer functioning by the time we got our hands on the computers, so we cannot say\nwith 100% certainty what they were supposed to download. However, given the timeline of\nthe events, we assume that the preliminary stage two downloader installed ShadowPad on\nthe four Piriform computers. Another clue that lead us to this assumption is that ShadowPad\nis believed to be a product of the Chinese hacker group, Axiom, the group likely behind the\nCCleaner attack. The connection between Axiom and the CCleaner attack was first\n[discovered by security researcher Constin Raiu.](https://twitter.com/craiu/status/910059453948579840?lang=en)\n\n_ShadowPad plugins found on Piriform PCs_\n\nWe also found ShadowPad log files that contained encrypted keystrokes from a keylogger\ninstalled on the computers. We discovered that the keylogger’s log was encrypted with the\nvolume ID of the hard drive and consequently were able to decrypt the key strokes. Looking\ninto the log, we found out that the keylogger had been active since April 12th, 2017,\nrecording keystrokes on these computers, including keylogs from Visual Studio and other\n\n\n-----\n\nprograms. The logged data showed us that the keylogger was functional at that time. The\nversion of the ShadowPad tool is custom-built, which makes us think it was explicitly built for\nPiriform.\n\n_Logged keystrokes found on the Piriform computers_\n\nBy installing a tool like ShadowPad, the cybercriminals were able to fully control the system\nremotely while collecting credentials and insights into the operations on the targeted\ncomputer. Besides the keylogger tool, other tools were installed on the four computers,\nincluding a password stealer, and tools with the capacity to install further software and\nplugins on the targeted computer remotely.\n\nShadowPad was installed on the Piriform network and, as far as we can tell from our\ninvestigations up until today, it was not installed on any of the CCleaner customers’\ncomputers, however we believe it was the intended third stage for the CCleaner customers.\nWhile up to 2.27 million CCleaner consumers and businesses had downloaded the infected\nCCleaner product, the attackers installed the malicious second stage on just 40 PCs\noperated by high-tech and telecommunications companies. We don’t have a sample of a\npossible third stage that might have been distributed via the CCleaner attack, and it is not\n\n\n-----\n\nclear if it was the attacker s intention to attack all 40 PCs or just a few or none. We continue\ninvestigating the data dumps from the computers, and will post an update as soon as we\nlearn more.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-03-08 - New investigations into the CCleaner incident point to a possible third stage that had keylogger capacities.pdf"
    ],
    "report_names": [
        "2018-03-08 - New investigations into the CCleaner incident point to a possible third stage that had keylogger capacities.pdf"
    ],
    "threat_actors": [
        {
            "id": "cea5ceec-0f14-4e34-bd0e-4074bc1a707d",
            "created_at": "2022-10-25T15:50:23.629983Z",
            "updated_at": "2025-03-27T02:00:55.509459Z",
            "deleted_at": null,
            "main_name": "Axiom",
            "aliases": [
                "Group 72"
            ],
            "source_name": "MITRE:Axiom",
            "tools": [
                "ZxShell",
                "gh0st RAT",
                "Zox",
                "PlugX",
                "Hikit",
                "PoisonIvy",
                "Derusbi",
                "Hydraq"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5c74936a-79d1-41b8-81eb-01d03c90a26b",
            "created_at": "2022-10-25T16:07:23.371052Z",
            "updated_at": "2025-03-27T02:02:09.766782Z",
            "deleted_at": null,
            "main_name": "Axiom",
            "aliases": [
                "Group 72",
                "Operation SMN"
            ],
            "source_name": "ETDA:Axiom",
            "tools": [
                "9002 RAT",
                "Agent.dhwf",
                "AngryRebel",
                "BlackCoffee",
                "BleDoor",
                "Chymine",
                "Darkmoon",
                "DeputyDog",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "Farfli",
                "Fexel",
                "Gen:Trojan.Heur.PT",
                "Gh0st RAT",
                "Ghost RAT",
                "Gresim",
                "HOMEUNIX",
                "HiKit",
                "HidraQ",
                "Homux",
                "Hydraq",
                "Kaba",
                "Korplug",
                "McRAT",
                "MdmBot",
                "Moudour",
                "Mydoor",
                "PCRat",
                "PNGRAT",
                "PlugX",
                "Poison Ivy",
                "RbDoor",
                "RedDelta",
                "RibDoor",
                "Roarur",
                "SPIVY",
                "Sensocode",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Winnti",
                "Xamtrav",
                "ZXShell",
                "Zox",
                "ZoxPNG",
                "ZoxRPC",
                "gresim",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535794,
    "ts_updated_at": 1743041642,
    "ts_creation_date": 1653774984,
    "ts_modification_date": 1653774984,
    "files": {
        "pdf": "https://archive.orkl.eu/7d762deff367229f51571ba3496796e7fdc8432d.pdf",
        "text": "https://archive.orkl.eu/7d762deff367229f51571ba3496796e7fdc8432d.txt",
        "img": "https://archive.orkl.eu/7d762deff367229f51571ba3496796e7fdc8432d.jpg"
    }
}