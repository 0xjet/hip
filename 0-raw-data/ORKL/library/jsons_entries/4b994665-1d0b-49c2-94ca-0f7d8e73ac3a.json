{
    "id": "4b994665-1d0b-49c2-94ca-0f7d8e73ac3a",
    "created_at": "2023-01-12T15:04:46.844381Z",
    "updated_at": "2025-03-27T02:16:16.847037Z",
    "deleted_at": null,
    "sha1_hash": "5087385e735537289928641c6fbf7dd3b655d07b",
    "title": "2011-07-06 - Cybercriminals switch from MBR to NTFS",
    "authors": "",
    "file_creation_date": "2022-05-29T10:37:39Z",
    "file_modification_date": "2022-05-29T10:37:39Z",
    "file_size": 1160937,
    "plain_text": "# Cybercriminals switch from MBR to NTFS\n\n**[securelist.com/cybercriminals-switch-from-mbr-to-ntfs-2/29117/](https://securelist.com/cybercriminals-switch-from-mbr-to-ntfs-2/29117/)**\n\n[Research](https://securelist.com/category/research/)\n\n[Research](https://securelist.com/category/research/)\n\n06 Jul 2011\n\nminute read\n\n\n-----\n\nAuthors\n\n[Vyacheslav Zakorzhevsky](https://securelist.com/author/vyacheslavz/)\n\nModification of the hard drive areas responsible for the initial loading of the system has\nbecome increasing popular with cybercriminals. Moreover, cybercriminals have now moved\non from just modifying the MBR (master boot record) to infecting the code of the NTFS\nloader.\n\nWe recently discovered an interesting piece of malware — Cidox. It is peculiar in that it\ninfects the load area code of the boot partition on the hard drive.\n\nThe master file Trojan-Dropper.Win32.Cidox “carries on board” two driver rootkits\n(Rootkit.Win32/Win64.Cidox). One is compiled for 32-bit platforms, the other for 64-bit\nplatforms.\n\nThe source component of Cidox makes the following modifications to the beginning of the\nhard drive:\n\nSaves the relevant driver to free sectors at the beginning of the hard drive;\nIt chooses the section marked as the boot partition in the MBR partition table for\ninfection. It is important to note that it only infects partitions with the NTFS file system.\n\n\n-----\n\nWrites part of its code over Extended NTFS IPL (Initial Program Loader), which is\nresponsible for parsing the MFT table (Master File Table), searching for the file with the\nloader in the root directory of the section (ntldr — pre-Vista, bootmgr — Vista+),\nreading this file form the disk and transferring control to it. At the same time the original\ncontents of Extended NTFS IPL are encrypted, saved and added to the end of the\nmalicious code.\n\n_Fragment of the initial domain of the hard drive infected by Cidox_\n_(detected as Rootkit.Boot.Cidox)_\n\nThe next time the system is booted the malicious code in the load area will be invoked. With\nthe help of a known technique, use of the Int 13h interrupt and some Windows kernel\nfeatures it successfully loads the malicious driver to the system. The loaded driver uses\nPsSetCreateProcessNotifyRoutine to control the launch of the following processes:\n\nsvchost.exe\niexplore.exe\nfirefox.exe\nopera.exe\nchrome.exe\n\n_Fragment of Rootkit.Win32.Cidox containing strings with the names of controlled browsers_\n\nIf the launch of one of the processes above is detected, one more Cidox component is\nintegrated into it — a dynamic library (Trojan.Win32.Cidox). This library modifies any browser\noutput, substituting it with its own. As a result, the user sees a browser window displaying an\noffer to renew the browser due to some malicious programs allegedly detected on the\nsystem. The example below tells the user to renew the browser due to infection by\nTrojan.Win32.Ddox.ci.\n\n\n-----\n\n_Fragment of a browser window on a system infected by Cidox_\n\nOf course, the user is asked to pay for the ‘renewal’. In order to obtain it, an SMS has to be\nsent to a short number.\n\nA unique page design is used for each of the most popular browsers.\n\n_Fragment of a browser window on a system infected by Cidox_\n\nIt should be noted that new versions of browsers can in fact be downloaded free of charge\nfrom the vendor’s website. Cybercriminals are merely scaring users in order to extort money\nfrom them.\n\n[Malware Technologies](https://securelist.com/tag/malware-technologies/)\n[MBR](https://securelist.com/tag/mbr/)\n[Rootkits](https://securelist.com/tag/rootkits/)\n[Trojan-Dropper](https://securelist.com/tag/trojan-dropper/)\n\nAuthors\n\n\n-----\n\n[Vyacheslav Zakorzhevsky](https://securelist.com/author/vyacheslavz/)\n\nCybercriminals switch from MBR to NTFS\n\nYour email address will not be published. Required fields are marked *\n\nGReAT webinars\n\n13 May 2021, 1:00pm\n\n## GReAT Ideas. Balalaika Edition\n\n26 Feb 2021, 12:00pm\n17 Jun 2020, 1:00pm\n26 Aug 2020, 2:00pm\n22 Jul 2020, 2:00pm\nFrom the same authors\n\n## How Security Products are Tested – Part 1\n\n\n-----\n\n## You can’t be invulnerable, but you can be well protected\n\n New Flash Player 0-day (CVE-2014-0515) Used in Watering-hole Attacks\n\n\n-----\n\n## CVE-2014-0497 – A 0-day Vulnerability\n\n Loophole in Safari\n\n\n-----\n\nSubscribe to our weekly e mails\n\nThe hottest research right in your inbox\n\nReports\n\n## APT trends report Q1 2022\n\nThis is our latest summary of advanced persistent threat (APT) activity, focusing on events\nthat we observed during Q1 2022.\n\n## Lazarus Trojanized DeFi app for delivering malware\n\n\n-----\n\nWe recently discovered a Trojanized DeFi application that was compiled in November 2021.\nThis application contains a legitimate program called DeFi Wallet that saves and manages a\ncryptocurrency wallet, but also implants a full-featured backdoor.\n\n## MoonBounce: the dark side of UEFI firmware\n\nAt the end of 2021, we inspected UEFI firmware that was tampered with to embed a\nmalicious code we dub MoonBounce. In this report we describe how the MoonBounce\nimplant works and how it is connected to APT41.\n\n## The BlueNoroff cryptocurrency hunt is still on\n\nIt appears that BlueNoroff shifted focus from hitting banks and SWIFT-connected servers to\nsolely cryptocurrency businesses as the main source of the group’s illegal income.\n\nSubscribe to our weekly e-mails\n\nThe hottest research right in your inbox\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2011/2011-07-06 - Cybercriminals switch from MBR to NTFS.pdf"
    ],
    "report_names": [
        "2011-07-06 - Cybercriminals switch from MBR to NTFS.pdf"
    ],
    "threat_actors": [
        {
            "id": "1bdb91cf-f1a6-4bed-8cfa-c7ea1b635ebd",
            "created_at": "2022-10-25T16:07:23.766784Z",
            "updated_at": "2025-03-27T02:02:09.971636Z",
            "deleted_at": null,
            "main_name": "Bluenoroff",
            "aliases": [
                "APT 38",
                "ATK 117",
                "Alluring Pisces",
                "Black Alicanto",
                "Bluenoroff",
                "CTG-6459",
                "Copernicium",
                "Nickel Gladstone",
                "Sapphire Sleet",
                "Selective Pisces",
                "Stardust Chollima",
                "T-APT-15",
                "TA444",
                "TAG-71",
                "TEMP.Hermit"
            ],
            "source_name": "ETDA:Bluenoroff",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f426f0a0-faef-4c0e-bcf8-88974116c9d0",
            "created_at": "2022-10-25T15:50:23.240383Z",
            "updated_at": "2025-03-27T02:00:55.404232Z",
            "deleted_at": null,
            "main_name": "APT38",
            "aliases": [
                "APT38",
                "NICKEL GLADSTONE",
                "BeagleBoyz",
                "Bluenoroff",
                "Stardust Chollima",
                "Sapphire Sleet",
                "COPERNICIUM"
            ],
            "source_name": "MITRE:APT38",
            "tools": [
                "ECCENTRICBANDWAGON",
                "HOPLIGHT",
                "Mimikatz",
                "KillDisk",
                "DarkComet"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "4d5f939b-aea9-4a0e-8bff-003079a261ea",
            "created_at": "2023-01-06T13:46:39.04841Z",
            "updated_at": "2025-03-27T02:00:02.985296Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "G0096",
                "Grayfly",
                "BARIUM",
                "BRONZE ATLAS",
                "BRONZE EXPORT",
                "Red Kelpie",
                "HOODOO",
                "Brass Typhoon",
                "TA415",
                "WICKED SPIDER",
                "WICKED PANDA",
                "G0044",
                "Earth Baku"
            ],
            "source_name": "MISPGALAXY:APT41",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e698860d-57e8-4780-b7c3-41e5a8314ec0",
            "created_at": "2022-10-25T15:50:23.287929Z",
            "updated_at": "2025-03-27T02:00:55.43005Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "APT41",
                "Wicked Panda",
                "Brass Typhoon",
                "BARIUM"
            ],
            "source_name": "MITRE:APT41",
            "tools": [
                "ASPXSpy",
                "BITSAdmin",
                "PlugX",
                "Impacket",
                "gh0st RAT",
                "netstat",
                "PowerSploit",
                "ZxShell",
                "KEYPLUG",
                "ipconfig",
                "sqlmap",
                "China Chopper",
                "ShadowPad",
                "MESSAGETAP",
                "Mimikatz",
                "certutil",
                "njRAT",
                "Cobalt Strike",
                "pwdump",
                "BLACKCOFFEE",
                "ROCKBOOT",
                "dsquery",
                "Winnti for Linux",
                "DUSTTRAP",
                "Derusbi",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535886,
    "ts_updated_at": 1743041776,
    "ts_creation_date": 1653820659,
    "ts_modification_date": 1653820659,
    "files": {
        "pdf": "https://archive.orkl.eu/5087385e735537289928641c6fbf7dd3b655d07b.pdf",
        "text": "https://archive.orkl.eu/5087385e735537289928641c6fbf7dd3b655d07b.txt",
        "img": "https://archive.orkl.eu/5087385e735537289928641c6fbf7dd3b655d07b.jpg"
    }
}