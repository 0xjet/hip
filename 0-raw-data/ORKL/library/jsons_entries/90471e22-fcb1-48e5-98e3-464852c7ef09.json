{
    "id": "90471e22-fcb1-48e5-98e3-464852c7ef09",
    "created_at": "2023-04-05T02:09:33.126764Z",
    "updated_at": "2025-03-27T02:05:59.663176Z",
    "deleted_at": null,
    "sha1_hash": "41389ddc3d7ed0037a2d324ca42f781935ac29e7",
    "title": "2016-04-14 - Bedep has raised its game vs Bot Zombies",
    "authors": "",
    "file_creation_date": "2023-04-03T08:49:58Z",
    "file_modification_date": "2023-04-03T08:49:58Z",
    "file_size": 151029,
    "plain_text": "# Bedep has raised its game vs Bot Zombies\n\n**[malware.dontneedcoffee.com/2016/04/bedepantiVM.html](https://malware.dontneedcoffee.com/2016/04/bedepantiVM.html)**\n\n2016-04-14 - Deception\n\nSimulacra & Simulation - Jean Baudrillard\n\nFeatured in Matrix\n\nBedep could be described as a fileless loader with a resident module that can optionally\n[perform AdFraud. It's intimate to Angler EK and appeared around August 2014.](https://malware.dontneedcoffee.com/2014/08/angler-ek-now-capable-of-fileless.html)\n\nOn the 2016-03-24 I noticed several move in Bedep.\n\n\n-----\n\nAngler infecting a VM and integrating it into an instance of Bedep botnet\n\n2016-03-24\n\nNo more variable in the URI (as several month before), the protocol Key changed and in\nmost of my manual checks, all threads were sending a strange payload in the first stream.\n\n2ko size for Win7 64bits :\n\n[80eb8a6aba5e6e70fb6c4032242e9ae82ce305d656b4ed8b629b24e1df0aef9a](https://www.virustotal.com/file/80eb8a6aba5e6e70fb6c4032242e9ae82ce305d656b4ed8b629b24e1df0aef9a/analysis/1460541070/)\n\n\n-----\n\nPopup shown by the first payload from Bedep Stream - Win7\n\n(in the background Angler Landing)\n\n48ko size for WinXP 32bits:\n\n[a0fe4139133ddb62e6db8608696ecdaf5ea6ca79b5e049371a93a83cbcc8e780](https://www.virustotal.com/file/a0fe4139133ddb62e6db8608696ecdaf5ea6ca79b5e049371a93a83cbcc8e780/analysis/1460550059/)\n\nPopup shown by the first payload from Bedep Stream - WinXP\n\n\n-----\n\nLooking at my traffic I thought for some time that one of the Bedep instances was split in two.\n\nThen I understood that I got different result on my \"manually\" driven VM (on VMWare ESXi)\nand my automated Cuckoo driven one ( on VirtualBox). I suspected it was related to\nhardening, as this is one of the main difference between those two systems.\n\n[And I got confirmation. Here is an example on a GooNky ([1]](https://www.proofpoint.com/us/threat-insight/post/The-Shadow-Knows) [[2]](http://blog.trendmicro.com/trendlabs-security-intelligence/lets-encrypt-now-being-abused-by-malvertisers/) [[3]) malvertising traffic in](https://www.proofpoint.com/us/threat-insight/post/video-malvertising-bringing-new-risks-high-profile-sites)\nAustralia :\n\n\n-----\n\nA VM not hardened enough against Bedep got redirected to a \"decoy\" instance of Bedep\n\nthat i will refer as :\n\nBedep \"Robot Town\" - 2016-04-12\n\nNow look what i get instead with a VM that is not spotted as is:\n\n\n-----\n\nSame Angler thread - VM not detected. 1st Stream get Vawtrak\n\n2016-04-12\n\n( Vawtrak in that stream\n_[d24674f2f9879ee9cec3eeb49185d4ea6bf555d150b4e840407051192eda1d61 )](https://www.virustotal.com/file/d24674f2f9879ee9cec3eeb49185d4ea6bf555d150b4e840407051192eda1d61/analysis/1460644841/)_\n\nI am not skilled enough to give you the list of checks Bedep is doing. But here is one of them\nspotted by Cuckoo :\n\n\n-----\n\nBedep doing some ACPI checks\n\nI think there are multiple level of checks. Some resulting in Bedep not trying to contact the\nC&C, some where the positive check end up with a different seed for the Bedep DGA\nredirecting spotted machines in a dedicated instance.\n\nThis is quite powerful :\n\n- the checks are made without dropping an executable.\n\n- if you don't know what to expect it's quite difficult to figure out that you have been trapped\n\n\n-----\n\n- there is a lot of things that operators can do with this list of known bots and initial Bedep\nthread ID.\n\nOne of them is for instance knowing which of the infection path are researcher/bots\n\"highway\" :\n\nIllustration for Bedep \"Robot Town\" from an \"infection path\" focused point of view\n\n\n-----\n\nThis could be just a move to perform different tasks (AdFraud only (?) ) on VMs, but my\n[guess it that this Bedep evolution on 2016-03-24 is a fast reaction to this Proofpoint Blog](https://www.proofpoint.com/us/threat-insight/post/video-malvertising-bringing-new-risks-high-profile-sites)\nfrom 2016-03-18 which show how Bedep threads are additional connectable dots.\n\nSharing publicly is often a difficult decision. The question is which side will benefits the most\nfrom it, in the long time.\n\nFor researchers:\n\nIn the last 3 weeks, if your VM have communicated with :\n\n95.211.205.228 (which is a Bedep ip from end of 2015 reused) || ( 85.25.41.95 &&\nhttp.uri.path \"ads.php?sid=1901\" ) and you are interested by the \"real payload\" then you\nmight want to give [PAfish a run.](https://github.com/a0rtega/pafish)\n\n\nImage result\nfor robot movie\nsad robot\n\n\nMarvin - Paranoid Android\n\nOn the other hand, any of your VM which has communicated with 104.193.252.245 (Bedep\n\"standard\" 18xx 19xx instance) since the 24 of March is hardened enough to grab the real\npayload.\n\n[Edits]\n\n- Removed the AU focused mention on the Vawtrak. I have been told (Thanks ! ) it's US\nfocused. Got geo\n\nGlitched. Maybe more about that a day or the other.\n\n- Refine the check conditions for Researcher. IP 85.25.41.95 and sid=1901...otherwise...ok\n:)\n\n[/Edits]\n\nAcknowledgements :\n\nThanks [Will Metcalf and](https://twitter.com/node5) [Malc0de for the discussions and help on this topic](https://twitter.com/malc0de)\n-\n\n-----\n\nI m sorry, but I must do it...Greetings to Angler and Bedep guys. ;) You are keeping us\nbusy...and awake !\n\n**Reading :**\n\n[Video Malvertising Bringing New Risks to High-Profile Sites - 2016-03-18 - Proofpoint](https://www.proofpoint.com/us/threat-insight/post/video-malvertising-bringing-new-risks-high-profile-sites)\n[Bedepâ€™s DGA: Trading Foreign Exchange for Malware Domains - 2015-04-21 - Dennis](https://www.arbornetworks.com/blog/asert/bedeps-dga-trading-foreign-exchange-for-malware-domains/)\nSchwarz - ArborSert\n[Angler EK : now capable of \"fileless\" infection (memory malware) - 2014-08-30](https://malware.dontneedcoffee.com/2014/08/angler-ek-now-capable-of-fileless.html)\n[Modifying VirtualBox settings for malware analysis - 2012-08-23 -](http://blog.prowling.nu/2012/08/modifying-virtualbox-settings-for.html) [Mikael Keri](https://twitter.com/nsmfoo)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-04-14 - Bedep has raised its game vs Bot Zombies.pdf"
    ],
    "report_names": [
        "2016-04-14 - Bedep has raised its game vs Bot Zombies.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1680660573,
    "ts_updated_at": 1743041159,
    "ts_creation_date": 1680511798,
    "ts_modification_date": 1680511798,
    "files": {
        "pdf": "https://archive.orkl.eu/41389ddc3d7ed0037a2d324ca42f781935ac29e7.pdf",
        "text": "https://archive.orkl.eu/41389ddc3d7ed0037a2d324ca42f781935ac29e7.txt",
        "img": "https://archive.orkl.eu/41389ddc3d7ed0037a2d324ca42f781935ac29e7.jpg"
    }
}