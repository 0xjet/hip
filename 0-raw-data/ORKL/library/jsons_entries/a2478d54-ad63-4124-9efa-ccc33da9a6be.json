{
    "id": "a2478d54-ad63-4124-9efa-ccc33da9a6be",
    "created_at": "2022-10-25T16:48:17.021052Z",
    "updated_at": "2025-03-27T02:13:46.541748Z",
    "deleted_at": null,
    "sha1_hash": "d0b189531bfd952480d2453dc52fae166f5e2d38",
    "title": "",
    "authors": "",
    "file_creation_date": "2019-02-15T07:33:46Z",
    "file_modification_date": "2019-02-15T07:33:46Z",
    "file_size": 1443806,
    "plain_text": "**[ti.360.net/blog/articles/suspected-molerats-new-attack-in-the-middle-east-en](https://ti.360.net/blog/articles/suspected-molerats-new-attack-in-the-middle-east-en/)**\n\nSuspected Molerats' New Attack in the Middle East\n\n2019-02-14 By 360威胁情报中心 | 事件追踪\n\n# Background\n\nRecently, 360 Threat Intelligence Center captured a bait document designed specifically for\nArabic users. It is an Office Word document with malicious macros embedded to drop and\nexecute a backdoor packed by Enigma Virtual Box. The backdoor program has a built-in\nkeyword list containing names of people or opera movies to communicate with C2, distributes\ncontrol commands to further control the victim's computer device. After investigation, we\nsuspect this attack is carried out by Molerats.\n\nAfter sharing the relevant information through social channels[1], we found that the C2\ndomain was resolved to a server no longer controlled by the attacker just within a few days to\navoid more attacks.\n\n# Activity Records of Molerats\n\nThe activity of Molerats (alias[2]: Gaza Hackers Team, Gaza cybergang, Operation Molerats,\nExtreme Jackal, Moonlight) could be traced back to early 2012. In January 2012, attackers\nwho identified themselves as the \"Gaza Hackers Team\" struck the website of the Israel Fire\nand Rescue services[3]. The same year in October, a suspicious file was found to have been\ncirculating on Israeli police department computers and hence decided to take all its\ncomputers offline temporarily[4]. The follow up analysis report from Trend Micro[5] pointed\nout that the malware being used in the attack was Xtreme RAT which could be used to steal\ninformation and receive commands from a remote attacker. They also discovered that\nXtreme RAT variants had been used to target many other National government agencies[6],\nsuch as those in the United States, United Kingdom, Turkey, New Zealand and etc.\n\nFireEYE reviewed the attack on Israeli police department in a report[7] released in 2013,\nassociated this event to Gaza Hackers Team and named this group as Molerats. Besides\nthat, some other malware such as Poison Ivy used by this attack group also got revealed. In\nanother report[8] released in 2014, FireEYE said ”Molerats are not only aware of security\nresearchers’ efforts in trying to track them but are also attempting to avoid using any obvious,\nrepeating patterns that could be used to more easily track endpoints infected with their\nmalware”.\n\nMolerats became particularly active in Q2 2015, Kaspersky collected lots of related IoCs and\npointed out staffs in IT (Information Technology) and IR (Incident Response) departments\nwere their preferred targets[9].\n\nClearSky first discovered the group's activities on Operation DustSky in January 2016. The\ntarget attack got suspended for more than half a month since the first report[10] got released.\nAfter that, their malware were rewritten in C++ and targets also got switched from before in\n\n\n-----\n\nefforts to evade detection[11]. ClearSky also indicated that Molerats were not as cautious as\nbefore, leaving more clues, which in turn has led to conclude with fairly certainly that Hamas\nmay have a hand behind this attack group.\n\nIn June 2017, 360 Threat Intelligence Center discovered new malware[12] used by Molerats.\nThe malicious payload, which got delivered through CVE-2017-0199 exploit, was completely\ngenerated by using the popular standard attack framework Cobalt Strike. Kaspersky came up\nwith an update of Molerats in late October and mentioned a possible related Android mobile\nmalware in the report[13].\n\n# Sample Analysis\n\n## Dropper（Macros）\n\n**File Name** 1.doc\n\n**MD5** 063a50e5e4b4d17a23ac8c8b33501719\n\n**Author** Motb3A\n\nThe captured bait document is an Office Word document written in Arabic with malicious VBA\nmacros embedded. If macro get enabled, the malicious code is automatically executed when\nthe victim opens the document.\n\nThe contents after translation are as follows.\n\n\n-----\n\nSince the macro is encrypted, we extract the relevant macro code as follows:\n\nThe macro code could drop out and execute the wmsetup.vbs script in the %userprofile%\ndirectory.\n\n## wmsetup.vbs\n\nThe VBS script decodes the data through Base64, and then save the decoded data to\n%temp%/ihelp.exe.\n\nFinally set the scheduled task to start ihelp.exe:\n\n\n-----\n\n## Backdoor（Ihelp.exe）\n\n**File Name** ihelp.exe\n\n**MD5** 46173adc26721fb54f6e1a1091a892d4\n\n**Packer** Enigma Virtual Box\n\nThe backdoor is packed by Enigma Virtual Box：\n\nThe corresponding C2 is encrypted and stored in the configuration blob. When get executed,\nthe backdoor decrypts the blob to obtain the C2 address (smartweb9.com).\n\nThe domain name has been resolved to IP address 198.54.117.244 which could be a\nsinkhole, but the attacker's server (79.124.60.40) was still online. So we were able to directly\nconnect to the attacker’s server and perform follow up investigations. According to the\nnetwork traffic and related decompiled code, the backdoor uses the SFML library for network\ncommunication (a library for game development: https://github.com/SFML).\n\n\n-----\n\nThe backdoor constructs a formatted request through a built-in keyword table, with contents\nrelated to some names or opera movies. This approach looks similar to the one mentioned\nb T l [14] i l\n\n\n-----\n\nJessie Lilliana Jocelynn Londyn\n\nAri Paloma Carmen Cassandra\n\nZachariah Randy Charlee Demi\n\nAnnika Brice Alyssa Erik\n\nAriel Juniper Moises Jeremy\n\nHunter Jaydon Freya Regina\n\nJanelle Lillian Aniyah Kenia\n\nEstelle Mara Daisy Guadalupe\n\nDemetrius\n\nThe request data fall into sub-blocks, and some of the data are encoded by Base64 before\nappending to related keyword.\n\nThe entire block is encrypted and Base64 encoded again when all sub-blocks are ready, and\nfinally sent to C2 via HTTP POST request.\n\nThe data returned by C2 will then be received and decrypted. The decrypted data contains\nkeyword Demi which is supposed to inform the client to upload the collected information.\n\nThe sample collects information, such as the user name and computer name, and a string\nsimilar to the UUID. Then encrypts and encodes the information in the same way and sends\nit back to C2.\n\n\n-----\n\nThe data returned from C2 may contain some configuration information. After processing the\nreceived data, the backdoor starts to acquire the attacker's instructions periodically in order\nto perform functions such as remote shell and file operations.\n\nRemote Shell\n\n\n-----\n\nFile Operation\n\n# Sinkhole\n\nSince 360 Threat Intelligence Center shared related information on the social media\nimmediately after discovering the sample[1], the C2 has been taken over by security\ncompany or related agency before February 10.\n\nBy querying VirusTotal, we find that the IP address (198.54.117.244) being used to take over\nthe C2 domain is associated with a large number of malicious domains.\n\n\n-----\n\nThrough 360 threat analysis platform, it can be seen that both belong to a same domain\nname service provider.\n\n\n-----\n\nTherefore, we have reason to believe that after the 360 Threat Intelligence Center shared the\ninformation, the domain name service provider got notified by some relevant organizations to\ntake over the C2 to avoid more attacks.\n\n# Attribution\n\nAfter analyzing those samples, the attack was suspected to be carried out by Molerats APT\nwith part of the associations as follows.\n\n**Similarity in the bait document**\n\nHighly similar to some of the bait documents used by Kaza Cybergang (Molerats), which\nwere disclosed by Kaspersky in 2017. Both are related to the Gaza region and Hamas.\n\n**Similarity in the payload**\n\nSimilar to those discovered by Kaspersky, the payloads are packed by Enigma Virtual Box\nand pretend to come from Microsoft.\n\n被注释的下载地址\n\nThe URL got commented out in the macro is the same as the one mentioned in Kaspersky’s\nreport[13].\n\n\n-----\n\nMacro code from samples provided in Kaspersky’s report.\n\nBased on the above information and some other internal related data, 360 Threat Intelligence\nCenter suspects Molerats APT group is the one that launched this attack.\n\n# Conclusion\n\nThe Molerats APT group has been in existence for a few years, and has carried out a large\nnumber of attacks by using a variety of public and privately owned malware. Attackers are\nactively improving their toolkit in an effort to minimize their exposure to security products and\nservices.\n\nThis group is good at social engineering by sending various types of decoy documents to the\ntarget in the attack. The decoy documents usually execute subsequent code through\nmalicious macro. Comparing with Office 0day, using macro needs more user interactions and\ncould reduce the success rate, but this approach is still used by lots of attack groups\nconsidering the cost is much lower. It is recommended that users avoid to open documents\nfrom untrusted sources, and Office macro should be disabled by default.\n\nProducts of 360 ESG can protect users from this new malware, including 360 Threat\nIntelligence Platform, SkyEye APT Detection and 360 NGSOC.\n\n# IOC\n\n**MD5**\n\n063a50e5e4b4d17a23ac8c8b33501719\n\n46173adc26721fb54f6e1a1091a892d4\n\n\n-----\n\n**C2**\n\nsmartweb9.com\n\n# References\n\n1. https://twitter.com/360TIC/status/1091890352066162688\n\n2. https://aptmap.netlify.com/#Molerats\n\n3. https://middle-east-online.com/en/cyber-war-gaza-hackers-deface-israel-fire-service\nwebsite\n\n4. http://www.timesofisrael.com/how-israel-police-computers-were-hacked-the-inside\nstory/\n\n5. http://blog.trendmicro.com/trendlabs-security-intelligence/xtreme-rat-targets-israeli\ngovernment/\n\n6. http://blog.trendmicro.com/trendlabs-security-intelligence/new-xtreme-rat-attacks-on\nusisrael-and-other-foreign-governments/\n\n7. https://www.fireeye.com/blog/threat-research/2013/08/operation-molerats-middle-east\ncyber-attacks-using-poison-ivy.html\n\n8. https://www.fireeye.com/blog/threat-research/2014/06/molerats-here-for-spring.html\n\n9. https://securelist.com/blog/research/72283/gaza-cybergang-wheres-your-ir-team/\n\n10. http://www.clearskysec.com/wp\ncontent/uploads/2016/01/Operation%20DustySky_TLP_WHITE.pdf\n\n11. http://www.clearskysec.com/wp-content/uploads/2016/06/Operation\nDustySky2_-6.2016_TLP_White.pdf\n\n12. https://ti.360.net/blog/articles/gaza-cybergang-apt-sample/\n\n13. https://securelist.com/gaza-cybergang-updated-2017-activity/82765/\n\n14. https://blog.talosintelligence.com/2017/06/palestine-delphi.html\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2019/2019.02.14.Molerats_APT/suspected-molerats-new-attack-in-the-middle-east-en.pdf"
    ],
    "report_names": [
        "suspected-molerats-new-attack-in-the-middle-east-en"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1162e0d4-b69c-423d-a4da-f3080d1d2b0c",
            "created_at": "2023-01-06T13:46:38.508262Z",
            "updated_at": "2025-03-27T02:00:02.851407Z",
            "deleted_at": null,
            "main_name": "Molerats",
            "aliases": [
                "Gaza Hackers Team",
                "Gaza cybergang",
                "Gaza Cybergang",
                "Operation Molerats",
                "Extreme Jackal",
                "ALUMINUM SARATOGA",
                "G0021",
                "BLACKSTEM"
            ],
            "source_name": "MISPGALAXY:Molerats",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "0c502f6d-640d-4e69-bfb8-328ba6540d4f",
            "created_at": "2022-10-25T15:50:23.756782Z",
            "updated_at": "2025-03-27T02:00:55.539397Z",
            "deleted_at": null,
            "main_name": "Molerats",
            "aliases": [
                "Molerats",
                "Operation Molerats",
                "Gaza Cybergang"
            ],
            "source_name": "MITRE:Molerats",
            "tools": [
                "MoleNet",
                "DustySky",
                "DropBook",
                "SharpStage",
                "PoisonIvy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "847f600c-cf90-44c0-8b39-fb0d5adfcef4",
            "created_at": "2022-10-25T16:07:23.875541Z",
            "updated_at": "2025-03-27T02:02:10.005591Z",
            "deleted_at": null,
            "main_name": "Molerats",
            "aliases": [
                "ATK 89",
                "Aluminum Saratoga",
                "Extreme Jackal",
                "Gaza Cybergang",
                "Gaza Hackers Team",
                "Molerats",
                "Operation DustySky",
                "Operation DustySky Part 2",
                "Operation Molerats",
                "Operation Moonlight",
                "Operation SneakyPastes",
                "Operation TopHat",
                "TA402",
                "TAG-CT5"
            ],
            "source_name": "ETDA:Molerats",
            "tools": [
                "BadPatch",
                "Bladabindi",
                "BrittleBush",
                "Chymine",
                "CinaRAT",
                "Darkmoon",
                "Downeks",
                "DropBook",
                "DustySky",
                "ExtRat",
                "Gen:Trojan.Heur.PT",
                "H-Worm",
                "H-Worm RAT",
                "Houdini",
                "Houdini RAT",
                "Hworm",
                "Iniduoh",
                "IronWind",
                "Jenxcus",
                "JhoneRAT",
                "Jorik",
                "KasperAgent",
                "Kognito",
                "LastConn",
                "Micropsia",
                "MoleNet",
                "Molerat Loader",
                "NeD Worm",
                "NimbleMamba",
                "Njw0rm",
                "Pierogi",
                "Poison Ivy",
                "Quasar RAT",
                "QuasarRAT",
                "SPIVY",
                "Scote",
                "SharpSploit",
                "SharpStage",
                "WSHRAT",
                "WelcomeChat",
                "Xtreme RAT",
                "XtremeRAT",
                "Yggdrasil",
                "dinihou",
                "dunihi",
                "njRAT",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "efe6ff9a-822d-41a6-90c3-45265cac696b",
            "created_at": "2024-05-01T02:03:07.920302Z",
            "updated_at": "2025-03-27T02:05:17.246342Z",
            "deleted_at": null,
            "main_name": "ALUMINUM SARATOGA",
            "aliases": [
                "Arid Viper",
                "Desert Falcon",
                "Extreme Jackal ",
                "Gaza CyberGang",
                "Gaza CyberGang",
                "Molerats ",
                "Operation DustySky ",
                "TA402",
                "APT-C-23"
            ],
            "source_name": "Secureworks:ALUMINUM SARATOGA",
            "tools": [
                " BrittleBush",
                " DarkComet",
                " LastConn",
                " Micropsia",
                " NimbleMamba",
                " PoisonIvy",
                " QuasarRAT",
                " XtremeRat",
                "BlackShades"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1666716497,
    "ts_updated_at": 1743041626,
    "ts_creation_date": 1550216026,
    "ts_modification_date": 1550216026,
    "files": {
        "pdf": "https://archive.orkl.eu/d0b189531bfd952480d2453dc52fae166f5e2d38.pdf",
        "text": "https://archive.orkl.eu/d0b189531bfd952480d2453dc52fae166f5e2d38.txt",
        "img": "https://archive.orkl.eu/d0b189531bfd952480d2453dc52fae166f5e2d38.jpg"
    }
}