{
    "id": "b94260ce-125f-4481-9041-73165cee77a2",
    "created_at": "2023-01-12T15:04:31.273326Z",
    "updated_at": "2025-03-27T02:05:54.382659Z",
    "deleted_at": null,
    "sha1_hash": "326da49b9421cac2f73459051602455deb51be0a",
    "title": "2021-01-22 - Malware Analysis Report No2",
    "authors": "",
    "file_creation_date": "2022-05-28T00:40:23Z",
    "file_modification_date": "2022-05-28T00:40:23Z",
    "file_size": 184997,
    "plain_text": "# Malware-Analysis-Reports/README.md at master · Finch4/Malware- Analysis-Reports · GitHub\n\n**[github.com/Finch4/Malware-Analysis-Reports/blob/main/13e0f258cfbe3aece8a7e6d29ceb5697/README.md](https://github.com/Finch4/Malware-Analysis-Reports/blob/main/13e0f258cfbe3aece8a7e6d29ceb5697/README.md)**\n\nFinch4\n\n## Malware Analysis Report N°2\n\n(Analysis of BitRat will be soon written, this is the analysis of the dropper)\n\n**Date: 21/01/2021**\n\n**Author/s: Finch**\n\nKey observation\nIndicators of compromise\nDelivery method\n\n## Summary of the analysis\n\n Key observation\n\nThe sample try to compromise the analysis by looking as a benign executable. All the malicious actions are\nbased on the resources of the executable.\n\n## Indicators of compromise\n\nDrop `ywlpCPZYAwl.exe in` `%appdata%/Roaming`\n\nDrop `tmpC51F.tmp in` `%appdata%/Roaming`\n```\n    RegSvcs.exe running lonely and always.\n\n```\n\n-----\n\n## Delivery method\n\nThe delivery is made by email\n\n[Email example(Thanks to abuse_ch):](https://bazaar.abuse.ch/user/41587972/)\n\nMalspam distributing BitRAT:\n\n**HELO: mxout.fullmarket-4.vautronserver.de**\n\n**Sending IP: 151.252.48.227**\n\n**[From: Accounts Payable - Rinaldi finance@chalet-almhuette.at](http://10.10.0.46/mailto:finance@chalet-almhuette.at)**\n\n**Reply-To:** [z0ais@newpacifis.com](http://10.10.0.46/mailto:z0ais@newpacifis.com)\n\n**Subject: Re: Re: Re: Payment processed (Overdues)**\n\n**Attachment: Payment_receipt.img (contains \"Payment Confirmation Paper - Customer Copy_pdf.exe\")**\n\n**BitRAT C2: 195.206.105.10:3988**\n\n## Sample identification\n\n File name, type, size\n\n**File name: Payment Confirmation Paper - Customer Copy_pdf.exe**\n\n**Type: .NET**\n\n**Size: 4.39MB (4,607,488 bytes)**\n\n**Size on disk: 4.39MB (4,608,000 bytes)**\n\n**TargetFramework: .NETFramework,Version=v4.0**\n\n**Assembly title: Lerlibro INC**\n\n**Assembly company:**\n\n**Assembly product: Lerlibro INC**\n\n## File hashes\n\n[Executable]\n\n**MD5: 13e0f258cfbe3aece8a7e6d29ceb5697**\n\n**SHA1: 5890091bacde4d9d62ed76d32dfaefcaa5b988a4**\n\n**SHA256: 76e5467f267a4bca00af800094c3a92f6bd51de54737f07c533d091e2f219b40**\n\n**SHA384:**\n076302660926159d03b133500395d172ee7269491b173ef1aee002c179c0b612af161be3980191a569d9157e30627084\n\n**SSDEEP: 98304:1Unj6PEASk4gI/UqE2mCAc1XdZ2aRmPCBvfq:1U+PEZkFIMX2mbcrFBC**\n\n**human-hash: lemon-zebra-robert-paris**\n\n## Anti-virus indentifiers\n\nBitRat\n\n\n-----\n\n## Dependencies\n\n Supported OS\n\n.NET [The target is Windows]\n\n## Required libraries\n\n.NET\n\n## Configuration file/s\n\nNone\n\n## Script/s and Executable/s\n\nThe loaded executables are obfuscated with various techniques.\n\n## Network traffic\n\n[Taken from JoeSandbox at the moment]\n\nbita.plumfixa.com\n\n149.154.167.220:443\n\nmyexternalip.com\n\n216.239.32.21 216.239.32.21\n\n## Sample identification\n\n Infection capabilities\n\nDrop BitRat, Rat\n\n## Self-preservation capacity\n\nTries to detect virtual machine. Scheduled Task. Various encryption. [See images for everything,\nunfortunately for a few images I didn't take some return values] Process injection to `RegScvs.exe`\n\n**[C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\RegSvcs.exe]** **MD5:**\n2867A3817C9245F7CF518524DFD18F28\n\n## Data leakage abilities\n\n[Analysis of dropper]\n\n## Remote attacker interactions / C&C\n\n[Taken from JoeSandbox at the moment]\n\napi.telegram.org\n```\nhttps://api.telegram.org/bot1529818621:AAH0oTC63FmKKTVji9OyVqkhJRsIx42aBDU/getUpdates?\noffset=-56EBB3\nhttps://api.telegram.org/bot1529818621:AAH0oTC63FmKKTVji9OyVqkhJRsIx42aBDU/getUpdates?\noffset=-5BkIDB\n\n```\n\n-----\n\n```\nhttps://api.telegram.org/bot1529818621:AAH0oTC63FmKKTVji9OyVqkhJRsIx42aBDU/getUpdates?\noffset=-5DU/ge\nhttps://api.telegram.org/bot1529818621:AAH0oTC63FmKKTVji9OyVqkhJRsIx42aBDU/getUpdates?\noffset=-5FmKKT\nhttps://api.telegram.org/bot1529818621:AAH0oTC63FmKKTVji9OyVqkhJRsIx42aBDU/getUpdates?\noffset=-5LMEM\nhttps://api.telegram.org/bot1529818621:AAH0oTC63FmKKTVji9OyVqkhJRsIx42aBDU/getUpdates?\noffset=-5TVjiC\n\n## Observations\n\n Behavioral analysis\n\n```\nExecutables dropping and decrypting. Invoke. Load Assembly. Windows api imports. Drop\n```\n\\AppData\\Local\\Temp\\tmpC51F.tmp [Persistence], \\AppData\\Roaming\\ywlpCPZYAwl.exe [To call a\n\n```\n[method from the first sample that import ResumeThread]. Vm detection by:](https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-resumethread)\n\nSee screenshots section\n\nProcess Injection [Target: RegScvs.exe]\n\n## Code analysis\n\nThe code at first look seems a normal and benign executable. Looking at the resources we find two\nsuspicious samples:\n\nAn image named: \"StringComparison\"\nA string named: \"UrlIdentityPermission\" [Gzip compressed]\n\nThe method with the role of initializing the malicious behaviour is:\n```\n   object WeakReference() contained in the class ProgIdRedirectionEntry() contained in the\n\n```\nnamespace `Lerlibro_INC  The payload is first decoded using the function ArgCount [GZip`\ndecompress]\n\n## Dynamic code analysis\n\n[After decoded the assembly will be loaded by the Assembly.Load() method,](https://docs.microsoft.com/en-us/dotnet/api/system.reflection.assembly.load?view=net-5.0)\n```\nGetType(\"System.Activator\").GetMethods()[2].Invoke() will be called, so the malware will try to\n\n```\ninvoke a method and passing as parameters `ConcurrentSet.ReadOnlyList`,\n\n`ConcurrentSet.PropagationFlags` and `Lerlibro_INC -> where` `ConcurrentSet.ReadOnlyList` is\n\n`StringComparison and` `ConcurrentSet.PropagationFlags` is `kZYcCfRI  we will see the the method`\n```\ntR accept three strings parameters and will perform the extraction of the payload from\nStringComparison and load it. [See screenshots for more dynamic code analysis]\n\n## Memory analysis\n\n```\nNone\n\n## Supporting figures\n\n Logs\n\n Strings\n\n\n-----\n\n## Function listings\n```\n   KjL() is the first function with the role of detecting the virtual machine.\n   flag11 will contain the result of KjL() .\n   org.a6() the function will call CompareString to compare your username, with the attempt to detect\n\n```\nthe virtual machine.\n```\n   or.VD() the function will call Contains to compare the sample name with the attempt to detect an\n\n```\nanalysis environment.\n```\n   dP.djP() another function to detect virtual machine.\n\n## Screenshots\n\n```\n[Not everything is in order]\n\n[Missing arguments]\n\n[Missing arguments]\n\n[The screenshot is called trick for the `!=, it will return` `true if is not detected]`\n\n[See `vmdetectionsnippet.cpp to understand]`\n\n[Autoit detection]\n\n[See `vmdetectionsnippet2.cpp to understand]`\n\n[if `flag11 == true, vm detected]`\n\n[ case 0 == vmdetected ]\n\n[Video about the function `nmI, incoming]`\n\n## Additional comments\n\nThe dropper is similar to others seen used for others differents malware.\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-01-22 - Malware Analysis Report No2.pdf"
    ],
    "report_names": [
        "2021-01-22 - Malware Analysis Report No2.pdf"
    ],
    "threat_actors": [
        {
            "id": "709ceea7-db99-405e-b5a7-a159e6c307e0",
            "created_at": "2022-10-25T16:07:23.373699Z",
            "updated_at": "2025-03-27T02:02:09.768341Z",
            "deleted_at": null,
            "main_name": "BackdoorDiplomacy",
            "aliases": [],
            "source_name": "ETDA:BackdoorDiplomacy",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "3b56d733-88da-4394-b150-d87680ce67e4",
            "created_at": "2023-01-06T13:46:39.287189Z",
            "updated_at": "2025-03-27T02:00:03.040775Z",
            "deleted_at": null,
            "main_name": "BackdoorDiplomacy",
            "aliases": [
                "BackDip",
                "CloudComputating",
                "Quarian"
            ],
            "source_name": "MISPGALAXY:BackdoorDiplomacy",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "401a2035-ed5a-4795-8e37-8b7465484751",
            "created_at": "2022-10-25T15:50:23.616232Z",
            "updated_at": "2025-03-27T02:00:55.506403Z",
            "deleted_at": null,
            "main_name": "BackdoorDiplomacy",
            "aliases": [
                "BackdoorDiplomacy"
            ],
            "source_name": "MITRE:BackdoorDiplomacy",
            "tools": [
                "Turian",
                "China Chopper",
                "Mimikatz",
                "NBTscan",
                "QuasarRAT"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535871,
    "ts_updated_at": 1743041154,
    "ts_creation_date": 1653698423,
    "ts_modification_date": 1653698423,
    "files": {
        "pdf": "https://archive.orkl.eu/326da49b9421cac2f73459051602455deb51be0a.pdf",
        "text": "https://archive.orkl.eu/326da49b9421cac2f73459051602455deb51be0a.txt",
        "img": "https://archive.orkl.eu/326da49b9421cac2f73459051602455deb51be0a.jpg"
    }
}