{
    "id": "46beaa28-19eb-4c84-b827-a567466a513c",
    "created_at": "2023-01-12T15:07:20.493009Z",
    "updated_at": "2025-03-27T02:08:33.395406Z",
    "deleted_at": null,
    "sha1_hash": "366832f91a25d29c6c854975de8ca8c652148d6f",
    "title": "2022-03-28 - Avast Finds Compromised Philippine Navy Certificate Used in Remote Access Tool",
    "authors": "",
    "file_creation_date": "2022-05-28T23:23:55Z",
    "file_modification_date": "2022-05-28T23:23:55Z",
    "file_size": 258603,
    "plain_text": "# Avast Finds Compromised Philippine Navy Certificate Used in Remote Access Tool\n\n**[decoded.avast.io/threatintel/avast-finds-compromised-philippine-navy-certificate-used-in-remote-access-tool/](https://decoded.avast.io/threatintel/avast-finds-compromised-philippine-navy-certificate-used-in-remote-access-tool/)**\n\nMarch 28, 2022\n\nby [Threat Intelligence TeamMarch 28, 20224 min read](https://decoded.avast.io/author/threatintel/)\n\nAvast Threat Intelligence Team has found a remote access tool (RAT) actively being used in the wild in the Philippines\nthat uses what appears to be a compromised digital certificate belonging to the Philippine Navy. This certificate is now\nexpired but we see evidence it was in use with this malware in June 2020.\n\nBased on our research, we believe with a high level of confidence that the threat actor had access to the private key\nbelonging to the certificate.\n\nWe got in touch with [CERT-PH, the National Computer Emergency Response Team for the Philippines to help us contact](https://www.ncert.gov.ph/)\nthe navy. We have shared with them our findings. The navy security team later let us know that the incident has been\nresolved and no further assistance was necessary from our side.\n\nBecause this is being used in active attacks now, we are releasing our findings immediately so organizations can take\n[steps to better protect themselves. We have found that this sample is now available on VirusTotal.](https://www.virustotal.com/gui/file/85fa43c3f84b31fbe34bf078af5a614612d32282d7b14523610a13944aadaacb)\n\n## Compromised Expired Philippine Navy Digital Certificate\n\nIn our analysis we found the sample connects to `dost[.]igov-service[.]net:8443 using TLS in a statically linked`\nOpenSSL library.\n\nA WHOIS lookup on the C&C domain gave us the following:\n\n\n-----\n\nThe digital certificate was pinned so that the malware requires the certificate to communicate.\n\nWhen we checked the digital certificate used for the TLS channel we found the following information:\n\nSome important things to note:\n\nThe certificate is a valid certificate with a subject of `*.navy.mil.ph, the Philippine Navy.`\nThe certificate has recently expired: it was valid for one year, from Sunday December 15, 2019 until Tuesday\nDecember 15, 2020.\nOur research shows that [Censys saw](https://censys.io/) [this certificate employed by the actual navy.mil.ph website](https://search.censys.io/certificates/992310ac9ea465cf62c6e93c1fd86ec5ae266364ef0b35acd2688063b1e59f25)\n\nBased on our research, we believe with a high level of confidence that the threat actor had access to the private key\nbelonging to the certificate.\n\n\n-----\n\nWhile the digital certificate is now expired we see evidence it was in use with this malware in June 2020.\n\nThe malicious PE file was found with filename: `C:\\Windows\\System32\\wlbsctrl.dll and its hash is:`\n```\n85FA43C3F84B31FBE34BF078AF5A614612D32282D7B14523610A13944AADAACB .\n\n```\nIn analyzing that malicious PE file itself, we found that the compilation timestamp is wrong or was edited. Specifically, the\n```\nTimeDateStamp of the PE file was modified and set to the year 2004 in both the PE header and Debug Directory as\n\n```\nshown below:\n\nHowever, we found that the author used OpenSSL 1.1.1g and compiled it on April 21, 2020 as shown below:\n\nThe username of the author was probably `udste . This can be seen in the debug information left inside the used`\nOpenSSL library.\n\nWe found that the malware supported the following commands:\n\nrun shellcode\nread file\nwrite file\ncancel data transfer\nlist drives\nrename a file\n\n\n-----\n\ndelete a file\nlist directory content\n\nSome additional items of note regarding the malicious PE file:\n\nAll configuration strings in the malware are encrypted using `AES-CBC with the exception of the mutex it uses.That`\nmutex is used as-is without decryption: `t7As7y9I6EGwJOQkJz1oRvPUFx1CJTsjzgDlm0CxIa4= .`\n[When this string is decrypted using the hard-coded key it decrypts to](https://gchq.github.io/CyberChef/#recipe=From_Hex('Auto')From_Base64('A-Za-z0-9%2B/%3D',true)AES_Decrypt(%7B'option':'Hex','string':'40%206e%209c%20b6%20df%20e1%202a%2063%20f5%202f%203f%209a%2032%20ae%200a%20e0%20c8%2092%2087%208b%2028%20ec%2077%2048%204a%20b7%20f9%2019%20%2091%20cd%20c3%205f%20'%7D,%7B'option':'Hex','string':'03%20b5%2064%20f4%20ad%2087%20e4%20ea%20c0%2029%2026%20c4%208b%203c%20ce%204b%20'%7D,'CBC','Raw','Raw',%7B'option':'Hex','string':''%7D,%7B'option':'Hex','string':''%7D)&input=NzQgMzcgNDEgNzMgMzcgNzkgMzkgNDkgMzYgNDUgNDcgNzcgNEEgNEYgNTEgNkIgNEEgN0EgMzEgNkYgNTIgNzYgNTAgNTUgNDYgNzggMzEgNDMgNEEgNTQgNzMgNkEgN0EgNjcgNDQgNkMgNkQgMzAgNDMgNzggNDkgNjEgMzQgM0QgMDA) `QSR_MUTEX_zGKwWAejTD9sDitYcK . We`\nsuspect that this is a failed attempt to disguise this malware as the infamous Quasar RAT malware. But this cannot\nbe the case because this sample is written in C++ and the Quasar RAT is written in C#.\n\nAvast customers are protected against this malware.\n\n## Indicators of Compromise (IoC)\n\nRepository: [https://github.com/avast/ioc/tree/master/Philippine-Navy-Certificate](https://github.com/avast/ioc/tree/master/Philippine-Navy-Certificate)\n\n**SHA256** **File name**\n\n85FA43C3F84B31FBE34BF078AF5A614612D32282D7B14523610A13944AADAACB C:\\Windows\\System32\\wlbsctrl.dll\n\n**Mutex**\n\nt7As7y9I6EGwJOQkJz1oRvPUFx1CJTsjzgDlm0CxIa4=\n\n**C&C server**\n\ndost[.]igov-service[.]net:8443\n\n[Tagged asanalysis,](https://decoded.avast.io/tag/analysis/) [backdoor,](https://decoded.avast.io/tag/backdoor/) [malware,](https://decoded.avast.io/tag/malware/) [rat](https://decoded.avast.io/tag/rat/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-28 - Avast Finds Compromised Philippine Navy Certificate Used in Remote Access Tool.pdf"
    ],
    "report_names": [
        "2022-03-28 - Avast Finds Compromised Philippine Navy Certificate Used in Remote Access Tool.pdf"
    ],
    "threat_actors": [
        {
            "id": "5d2bd376-fcdc-4c6a-bc2c-17ebbb5b81a4",
            "created_at": "2022-10-25T16:07:23.667223Z",
            "updated_at": "2025-03-27T02:02:09.916086Z",
            "deleted_at": null,
            "main_name": "GCHQ",
            "aliases": [
                "Government Communications Headquarters",
                "Operation Socialist"
            ],
            "source_name": "ETDA:GCHQ",
            "tools": [
                "Prax",
                "Regin",
                "WarriorPride"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536040,
    "ts_updated_at": 1743041313,
    "ts_creation_date": 1653780235,
    "ts_modification_date": 1653780235,
    "files": {
        "pdf": "https://archive.orkl.eu/366832f91a25d29c6c854975de8ca8c652148d6f.pdf",
        "text": "https://archive.orkl.eu/366832f91a25d29c6c854975de8ca8c652148d6f.txt",
        "img": "https://archive.orkl.eu/366832f91a25d29c6c854975de8ca8c652148d6f.jpg"
    }
}