{
    "id": "a7b32420-a8d5-4d78-a200-d854e82cac1e",
    "created_at": "2023-01-12T15:05:17.572049Z",
    "updated_at": "2025-03-27T02:16:49.072822Z",
    "deleted_at": null,
    "sha1_hash": "a9e2f281036ff0be0f5a23262d26b06a6e9abb35",
    "title": "2022-08-09 - Bitter APT Group Using “Dracarys” Android Spyware",
    "authors": "",
    "file_creation_date": "2022-08-18T04:02:34Z",
    "file_modification_date": "2022-08-18T04:02:34Z",
    "file_size": 2080756,
    "plain_text": "# Bitter APT group using “Dracarys” Android Spyware\n\n**[blog.cyble.com/2022/08/09/bitter-apt-group-using-dracarys-android-spyware/](https://blog.cyble.com/2022/08/09/bitter-apt-group-using-dracarys-android-spyware/)**\n\n## Android Malware Disguised as a Messaging Application\n\n\nAugust 9, 2022\n\n\n[During our routine threat hunting exercise, Cyble Research Labs came across an article wherein the](https://about.fb.com/news/2022/08/metas-adversarial-threat-report-q2-2022/)\nresearchers mentioned Bitter APT delivering the Android Spyware “Dracarys.” Bitter aka T-APT-17 is a\nwell-known Advanced Persistent Threat (APT) group active since 2013 and operates in South Asia. It has\nbeen observed targeting China, India, Pakistan, and other countries in South Asia.\n\nThe Bitter APT is actively involved in both desktop and mobile malware campaigns and uses techniques\nlike spear phishing emails, exploiting known vulnerabilities to deliver Remote Access Trojan (RAT) and\nother malware families.\n\nDracarys Android Spyware impersonates genuine applications such as Signal, Telegram, WhatsApp,\nYouTube, and other chat applications and distributes through phishing sites.\n\nDuring analysis, we observed that one of the phishing sites is still live and distributing Dracarys. The\nphishing site mimics the genuine Signal site and delivers a trojanized Signal app.\n\n\n-----\n\n_Figure 1 – Phishing site which distributes Dracarys malware_\nUpon in-depth analysis of the malware, we observed that the Threat Actor (TA) had inserted the malicious\ncode into the Signal app source code to avoid being detected. The below image showcases the extra\nadded spyware module “org.zcode.dracarys” in the trojanized version of the Signal App.\n\n_Figure 2 –_\n\n_Comparison of the genuine and trojanized Signal App_\n\n\n-----\n\n## Technical Analysis\n\n### APK Metadata Information \n\nApp Name: Signal\nPackage Name: org.thoughtcrime.securesms.app\nSHA256 Hash: d16a9b41a1617711d28eb52b89111b2ebdc25d26fa28348a115d04560a9f1003\n\nFigure 3 shows the metadata information of the application.\n\n_Figure 3 – App Metadata Information_\n\n### Manifest Description\n\nThe malicious application mentions 24 permissions, of which the TA exploits 10. The harmful permissions\nrequested by the malware are:\n\n**Permission** **Description**\n\n**READ_CONTACTS** Access phone contacts\n\n**RECEIVE_SMS** Allows an application to receive SMS messages\n\n**READ_SMS** Access phone messages\n\n**CAMERA** Required to access the camera device.\n\n**READ_CALL_LOG** Access phone call logs\n\n**READ_EXTERNAL_STORAGE** Allows the app to read the contents of the device’s external storage\n\n**RECORD_AUDIO** Allows the app to record audio with the microphone, which the\nattackers can misuse\n\n**WRITE_EXTERNAL_STORAGE** Allows the app to write or delete files to the external storage of the\ndevice\n\n**CALL_PHONE** Allows an application to initiate a phone call without going through\nthe Dialer user interface for the user to confirm the call\n\n**ACCESS_FINE_LOCATION** Allows an app to access precise location\n\n### Source Code Review \n\nThe trojanized version of the Signal application has registered the Accessibility Service in the Manifest\nfile. The malware abuses the Accessibility permissions\n\n\n-----\n\nsuch as auto granting permission to run the application in the background, activating Device Admin, and\nperforming auto clicks.\n\n_Figure 4 – Malware abusing Accessibility Service_\nThe malware connects to the Firebase server and receives the commands to execute operations for\ncollecting the data from the victim’s device, as shown in the below image.\n\n_Figure 5 – Receiving commands from the Firebase server_\nThe malware collects all the contacts from the infected device and sends them to the Command and\nControl (C&C) server “hxxps://signal-premium-app[.]org“.\n\n\n-----\n\n_Figure 6 – Malware sending contact list to the C&C server_\nSimilarly, the malware collects SMS data, call logs, installed applications list, and files present on the\ninfected device after receiving a command from the C&C server, as shown in Figures 7 through 10.\n\n_Figure 7 – Collecting call logs from the infected device_\n\n\n-----\n\n_Figure 8 – Collecting installed application list_\n\n_Figure 9 – Collecting SMS list from an infected device_\n\n\n-----\n\n_Figure 10 – Collecting files present in the victim’s device_\nThe malware registers the “DracarysReceiver” broadcast receiver, which receives the event from the\nFirebase server and starts collecting Personal Identifiable Information (PII) data from the infected device,\nas shown below.\n\n_Figure 11 – Dracarys receiver to send updated PII data_\nThe malware can capture screenshots and record audio to spy on the victim’s device. The below figure\nshows the code used by the malware to send captured screenshots and recordings to its C&C server.\n\n\n-----\n\n_Figure 12 – Collecting recordings and captured screenshots_\nThe image below shows the C&C server and the URL path to which the stolen data is sent.\n\n_Figure 13 – C&C server and endpoints_\n\n## Conclusion\n\nAccording to our research, the TA has injected malicious code into genuine messaging applications such\nas Signal. The TA also distributed the malware through a phishing site masquerading as a genuine\nwebsite that tricks users into downloading a trojanized version of popular messaging applications.\n\n\n-----\n\nWe have observed Bitter APT continuously attacking South Asian countries and changing its mode of\nattack with each new campaign. In this campaign, Bitter APT used a sophisticated phishing attack to\ninfect devices with Dracarys Android Spyware.\n\nIn the coming days, we may observe a change in the Bitter APT group’s activities, with different malware\nvariants, enhanced techniques, and distribution modes.\n\n## Our Recommendations\n\nWe have listed some essential cybersecurity best practices that create the first line of control against\nattackers. We recommend that our readers follow the best practices given below:\n\n**How to prevent malware infection?**\n\nDownload and install software only from official app stores like Play Store or the iOS App Store.\nUse a reputed anti-virus and internet security software package on your connected devices, such as\nPCs, laptops, and mobile devices.\nUse strong passwords and enforce multi-factor authentication wherever possible.\nEnable biometric security features such as fingerprint or facial recognition for unlocking the mobile\ndevice where possible.\nBe wary of opening any links received via SMS or emails delivered to your phone.\nEnsure that Google Play Protect is enabled on Android devices.\nBe careful while enabling any permissions.\nKeep your devices, operating systems, and applications updated.\n\n**How to identify whether you are infected?**\n\nRegularly check the Mobile/Wi-Fi data usage of applications installed on mobile devices.\nKeep an eye on the alerts provided by Anti-viruses and Android OS and take necessary actions\naccordingly.\n\n**What to do when you are infected?**\n\nDisable Wi-Fi/Mobile data and remove SIM card – as in some cases, the malware can re-enable the\nMobile Data.\nPerform a factory reset.\nRemove the application in case a factory reset is not possible.\nTake a backup of personal media Files (excluding mobile applications) and perform a device reset.\n\n**What to do in case of any fraudulent transaction?**\n\nIn case of a fraudulent transaction, immediately report it to the concerned bank.\n\n**What should banks do to protect their customers?**\n\nBanks and other financial entities should educate customers on safeguarding themselves from\nmalware attacks via telephone, SMS, or emails.\n\nMITRE ATT&CK® Techniques\n\n**Tactic** **Technique ID** **Technique Name**\n\n\n-----\n\n**Initial Access** [T1476](https://attack.mitre.org/versions/v7/techniques/T1476/) Deliver Malicious App via Other Mean.\n\n**Initial Access** [T1444](https://attack.mitre.org/versions/v7/techniques/T1444) Masquerade as Legitimate Application\n\n**Collection** [T1412](https://attack.mitre.org/techniques/T1412) Capture SMS Messages\n\n**Collection** [T1432](https://attack.mitre.org/techniques/T1432/) Access Contacts List\n\n**Collection** [T1433](https://attack.mitre.org/versions/v7/techniques/T1433/) Access Call Logs\n\n**Collection** [T1517](https://attack.mitre.org/versions/v7/techniques/T1517/) Access Notifications\n\n**Collection** [T1533](https://attack.mitre.org/versions/v7/techniques/T1533/) Data from Local System\n\n**Collection** [T1429](https://attack.mitre.org/versions/v7/techniques/T1429/) Capture Audio\n\n**Exfiltration** [T1437](https://attack.mitre.org/versions/v10/techniques/T1437) Standard Application Layer Protocol\n\n## Indicators of Compromise (IOCs)\n\n**Indicators** **Indicator**\n**Type**\n\n\n**Description**\n\n\n**d16a9b41a1617711d28eb52b89111b2ebdc25d26fa28348a115d04560a9f1003** SHA256 Hash of the\nanalyzed\nAPK file\n\n**2c60fbb9eb22d0eb5e62f15d1e49028944c3ff51** SHA1 Hash of the\nanalyzed\nAPK file\n\n**761705bd1681b94e991593bdcf190743** MD5 Hash of the\nanalyzed\nAPK file\n\n**hxxps://signal-premium-app[.]org** URL C&C server\n\n**hxxps://signalpremium[.]com/** URL Malware\ndistribution\nsite\n\n**43e3a0b0d5e2f172ff9555897c3d3330f3adc3ac390a52d84cea7045fbae108d** SHA256 Hash of the\nanalyzed\nAPK file\n\n**a35653c3d04aaaa76266db6cd253f086872a5d27** SHA1 Hash of the\nanalyzed\nAPK file\n\n**d9a39c41e9f599766b5527986e807840** MD5 Hash of the\nanalyzed\nAPK file\n\n**hxxp://94[.]140.114[.]22:41322** URL C&C server\n\n\n-----\n\n**220fcfa47a11e7e3f179a96258a5bb69914c17e8ca7d0fdce44d13f1f3229548** SHA256 Hash of the\nanalyzed\nAPK file\n\n**04ec835ae9240722db8190c093a5b2a7059646b1** SHA1 Hash of the\nanalyzed\nAPK file\n\n**07532dea34c87ea2c91d2e035ed5dc87** MD5 Hash of the\nanalyzed\nAPK file\n\n**hxxps://youtubepremiumapp[.]com/** URL C&C server\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-08-09 - Bitter APT Group Using “Dracarys” Android Spyware.pdf"
    ],
    "report_names": [
        "2022-08-09 - Bitter APT Group Using “Dracarys” Android Spyware.pdf"
    ],
    "threat_actors": [
        {
            "id": "bf6cb670-bb69-473f-a220-97ac713fd081",
            "created_at": "2022-10-25T16:07:23.395205Z",
            "updated_at": "2025-03-27T02:02:09.777308Z",
            "deleted_at": null,
            "main_name": "Bitter",
            "aliases": [
                "T-APT-17",
                "TA397"
            ],
            "source_name": "ETDA:Bitter",
            "tools": [
                "Artra Downloader",
                "ArtraDownloader",
                "Bitter RAT",
                "BitterRAT",
                "Dracarys"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "655f7d0b-7ea6-4950-b272-969ab7c27a4b",
            "created_at": "2022-10-27T08:27:13.133291Z",
            "updated_at": "2025-03-27T02:00:55.490812Z",
            "deleted_at": null,
            "main_name": "BITTER",
            "aliases": [
                "T-APT-17"
            ],
            "source_name": "MITRE:BITTER",
            "tools": [
                "ZxxZ"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "acd789fa-d488-47f3-b9cc-fdb18b1fa375",
            "created_at": "2023-01-06T13:46:39.332092Z",
            "updated_at": "2025-03-27T02:00:03.053179Z",
            "deleted_at": null,
            "main_name": "HAZY TIGER",
            "aliases": [
                "Orange Yali",
                "TA397",
                "T-APT-17",
                "APT-C-08"
            ],
            "source_name": "MISPGALAXY:HAZY TIGER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "86fd71d3-06dc-4b73-b038-cedea7b83bac",
            "created_at": "2022-10-25T16:07:23.330793Z",
            "updated_at": "2025-03-27T02:02:09.740703Z",
            "deleted_at": null,
            "main_name": "APT 17",
            "aliases": [
                "APT 17",
                "ATK 2",
                "Beijing Group",
                "Bronze Keystone",
                "Deputy Dog",
                "Elderwood",
                "Elderwood Gang",
                "Operation Aurora",
                "Operation DeputyDog",
                "Operation Ephemeral Hydra",
                "Operation RAT Cook",
                "SIG22",
                "Sneaky Panda",
                "TEMP.Avengers",
                "TG-8153",
                "Tailgater Team"
            ],
            "source_name": "ETDA:APT 17",
            "tools": [
                "9002 RAT",
                "AGENT.ABQMR",
                "AGENT.AQUP.DROPPER",
                "AGENT.BMZA",
                "AGENT.GUNZ",
                "Agent.dhwf",
                "AngryRebel",
                "BlackCoffee",
                "Briba",
                "Chymine",
                "Comfoo",
                "Comfoo RAT",
                "Darkmoon",
                "DeputyDog",
                "Destroy RAT",
                "DestroyRAT",
                "Farfli",
                "Fexel",
                "Gen:Trojan.Heur.PT",
                "Gh0st RAT",
                "Ghost RAT",
                "Gresim",
                "HOMEUNIX",
                "HiKit",
                "HidraQ",
                "Homux",
                "Hydraq",
                "Jumpall",
                "Kaba",
                "Korplug",
                "Linfo",
                "MCRAT.A",
                "McRAT",
                "MdmBot",
                "Mdmbot.E",
                "Moudour",
                "Mydoor",
                "Naid",
                "Nerex",
                "PCRat",
                "PNGRAT",
                "Pasam",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "Roarur",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Trojan.Naid",
                "Vasport",
                "Wiarp",
                "Xamtrav",
                "Zox",
                "ZoxPNG",
                "ZoxRPC",
                "gresim",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535917,
    "ts_updated_at": 1743041809,
    "ts_creation_date": 1660795354,
    "ts_modification_date": 1660795354,
    "files": {
        "pdf": "https://archive.orkl.eu/a9e2f281036ff0be0f5a23262d26b06a6e9abb35.pdf",
        "text": "https://archive.orkl.eu/a9e2f281036ff0be0f5a23262d26b06a6e9abb35.txt",
        "img": "https://archive.orkl.eu/a9e2f281036ff0be0f5a23262d26b06a6e9abb35.jpg"
    }
}