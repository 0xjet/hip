{
    "id": "f5d42bfa-2099-4883-9f8a-d42a0058dd79",
    "created_at": "2022-10-25T16:48:22.715006Z",
    "updated_at": "2025-03-27T02:12:36.952547Z",
    "deleted_at": null,
    "sha1_hash": "7796e3ac5f6f5c8f1b2103662b7912ae9b6d2f50",
    "title": "CDS2018-Technical-S1-v2 Hunting for Platinum v2_clean",
    "authors": "",
    "file_creation_date": "2018-10-12T21:54:44Z",
    "file_modification_date": "2018-10-12T15:21:19Z",
    "file_size": 2875068,
    "plain_text": "# Hunting for PLATINUM\n### Mandiant consulting\n\n\n-----\n\n## Adrien Bataille\n\n#### § Senior Consultant at Mandiant\n\n § 10 years experience\n\n###### § Incident Response\n\n § Malware analysis\n\n § Threat intelligence\n\n\n-----\n\n## Matias Bevilacqua\n\n#### § Principal Consultant at Mandiant\n\n § 15+ years experience\n\n###### § Incident Response\n\n § 5 years experience on IR/forensics R&D.\n\n § 2 years onsite focused on the Middle East threat landscape.\n\n\n-----\n\n## Disclaimer\n\n###### “Case studies and examples are drawn from our experiences and activities working for a variety of customers, and do not represent our work for any one customer or set of customers. In many cases, facts have been changed to obscure the identity of our customers and individuals associated with our customers.”\n\n\n-----\n\n## Platinum overview\n\n###### Microsoft Report in April 2016\n\n • Low profile group\n • Targets - South / Southeast Asia\n • Custom backdoor and tools\n • At least four zero-day exploits\n • Hot-patching technique to inject code\n\n Microsoft Blog post in June 2017\n\n • Use of Intel AMT Serial over LAN for communications\n • OS based firewall bypass\n • Seen in file transfer tool\n\n\n-----\n\n## Mandiant case\n\n#### § Mandiant called in to investigate suspicious activity on a handful of hosts\n\n § Compromise confirmed\n\n###### – Breach attributed to a known threat group (not PLATINUM)\n\n – Use of Metasploit, webshells, ZXShell, plink… fairly low-tech and noisy.\n\n\n-----\n\n## Investigative cycle\n\n###### ◆ Host inspection\n\n     - HX used for analysis (triage, live response)\n\n     - HIP for real-time alerting\n\n###### New Investigation IOCs\n\n ◆ Network monitoring / analysis\n\n     - PX network sensors\n\n###### Sweeps and\n Information\n Network Analysis\n\n     - Client network infrastructure **Discovery**\n\n###### Monitoring\n\n ◆ Malware reverse engineering (FLARE)\n\n\n-----\n\n## Suddenly things got interesting…\n\n#### § What is this?…\n\n###### C:\\Program Files\\Common Files\\System\\temp\\alg.exe a -hpqwerty -r -dh ps_dl.dat \"C:\\Program Files\\receptor\\”\n\n C:\\Windows\\Temp\\alg.exe a -hpqwerty -r -ri3 -dh temp_001.dat agent_config.json ragent_install.log connector- deployment-guide.pdf AgentSetup_HIP_xAgent_Bundled.msi\n#### § Live response analysis C:\\Program Files\\7-Zip\\Lang\\bg.txt\n\nC:\\Program Files\\7-Zip\\Lang\\br.txt\n\n###### – Unknown malware in folder C:\\Program Files\\7-Zip\\Lang\\\n\nC:\\Program Files\\7-Zip\\Lang\\bz.txt\n\n###### – Freshly installed C:\\Program Files\\7-Zip\\Lang\\ca.txt\n\n[…]\n\n###### – Regular Powershell event log clearing C:\\Program Files\\7-Zip\\Lang\\id.txt\n\nC:\\Program Files\\7-Zip\\Lang\\iis.txt\n\n###### – Persistence unknown\n\nC:\\Program Files\\7-Zip\\Lang\\io.txt\n\n###### – Submitted to FLARE for triage, named REDPEPPER C:\\Program Files\\7-Zip\\Lang\\ios.txt\n\nC:\\Program Files\\7-Zip\\Lang\\it.txt\n\nC:\\Program Files\\7-Zip\\Lang\\iys.txt\n\nC:\\Program Files\\7-Zip\\Lang\\ja.txt\n\n\n-----\n\n## REDPEPPER •• C:\\Program Files (x86)\\7-zip\\Lang\\bz.txtC:\\Program Files (x86)\\7-zip\\Lang\\iis.txt\n\n###### • C:\\Program Files (x86)\\7-zip\\Lang\\ios.txt\n\n##### § WMI persistence • C:\\Program Files (x86)\\7-zip\\Lang\\iys.txt\n\n###### – Filter “7zip_32” – Consumer triggered on event log message “The Security Center service entered the running state.’” – Base64 encoded powershell loader loading an encrypted shellcode and final payload\n##### § Backdoor with statically linked OpenSSL (1.5MB)\n\n###### – 3DES encrypted configuration file – 3DES to HTTP/HTTPS C2 – SSL communications\n##### § Working hours and self-delete timer § Evolution of Microsoft’s “adbupd” backdoor\n\n###### – but does not trigger on the YARA rule\n\n\n-----\n\n###### • C:\\Program Files (x86)\\7-zip\\Lang\\bz.txt\n\n## Hunting for REDPEPPER • C:\\Program Files (x86)\\7-zip\\Lang\\iis.txt\n\n###### • C:\\Program Files (x86)\\7-zip\\Lang\\ios.txt\n • C:\\Program Files (x86)\\7-zip\\Lang\\iys.txt\n\n PE metadata Persistence/Loading Real-time\n\n • Known bad filenames • WMI filter and consumer • HIP alerts on obfuscated Powershell\n • Payload has single export name • Search for base64 encoded Powershell “GetStartObjectEx” from “iis.txt”\n\n • Encrypted on disk • Requires a special regex audit\n • Use of custom PE loader – won’t • Resource heavy appear as DLL export in running\n\n • EID 104 specific to Powershell: The\n process\n Windows PowerShell log file was cleared\n\n • Search strings in process address space (noisy)\n\n\n-----\n\n###### • C:\\Program Files (x86)\\7-zip\\Lang\\bz.txt\n\n## Hunting for REDPEPPER • C:\\Program Files (x86)\\7-zip\\Lang\\iis.txt\n\n###### • C:\\Program Files (x86)\\7-zip\\Lang\\ios.txt\n • C:\\Program Files (x86)\\7-zip\\Lang\\iys.txt\n\n#### § Network\n\n###### – C2s from the configuration files\n\n – Old user-agents\n\n § IE7, IE8, IE9, IE10\n\n § Chrome 14.0.835.187\n\n § Firefox 3.6.13, 4.0, 5.0\n\n\n-----\n\n## Continuing the investigation\n\n##### § Hits on WMI and obfuscated PowerShell • C:\\Program Files\\WinRAR\\Formats\\tar.txt\n\n###### • C:\\Program Files\\WinRAR\\Formats\\bz.txt\n – REDPEPPER - 64 bit version with different filenames and path\n\n • C:\\Program Files\\WinRAR\\Formats\\cab.txt\n – Several unknown hits using a similar loading technique\n\n • C:\\Program Files\\WinRAR\\Formats\\gz.txt\n § C:\\ProgramData\\Apple\\setup\\BonjourSupport.txt\n\n § C:\\Program Files\\Windows NT\\TableTextService\\TableTexTServiceDaGG.dll\n\n § …\n##### § Live response analysis suspects different malware\n\n § TableTexTServiceDaGG.dll submitted to FLARE for analysis\n\n § Was eventually named REDCURRY\n\n\n-----\n\n## REDCURRY (“KB”)\n\n##### § Same loading technique as REDPEPPER\n\n###### – WMI persistence\n – Several base64 encoded files\n##### § Final payload this time was packed, and\n###### obfuscated\n##### § Keylogger, records keystrokes in encrypted\n###### files\n##### § Found several versions § Encryption keys slightly different per victim (a\n###### few bytes) Unpacked disassembly, duh.\n##### § Unpacked payload identified as\n###### Trojan_Win32_PlaKeylog_B by Microsoft YARA ruleset (PLATINUM)\n\n\n-----\n\n###### • C:\\Program Files\\Internet Explorer\\F112props.dll\n\n## Hunting for REDCURRY • C:\\ProgramData\\CyberLink\\cbd\\tokens.txt\n\n###### • C:\\Program Files\\Windows NT\\TableTextService\\TableTexTServiceDaGG.dll\n\n PE metadata Persistence/Loading Real-time\n\n • Known bad filenames • WMI filter and consumer • HIP alerts on obfuscated Powershell\n • Payload has four exports • Search for base64 encoded Powershell or (correlation observed to PS Empire) “ExLinkFn”, “ExLinkFnW”, “MZ” header “ExUnlinkFn”, “ExUnlinkFnW” • Requires a special regex audit\n\n • Encrypted on disk • Resource heavy\n • Use of custom PE loader – won’t • EID 104 specific to Powershell: The appear as DLL export in running Windows PowerShell log file was cleared process\n • Search strings in process address space\n\n\n-----\n\n## Hunting for more\n\n##### § ShimCache/AmCache sweeps\n\n § Simple & inaccurate description: records executed binaries (win)\n\n § Good method to find files which may have been be deleted\n\n § Hits for some of the preferred filenames of this threat actor\n\n § Hits on « alg.exe » => live responses\n\nC:\\Program Files (x86)\\Cisco Systems\\VPN Client\\cisco_cert_mgr.exe\n\nC:\\Program Files (x86)\\Cisco Systems\\VPN Client\\cisconetworks.dat\n\nC:\\Program Files (x86)\\Cisco Systems\\VPN Client\\cvpnd.exe\n\n#### § Unknown malware found! C:\\Program Files (x86)\\Cisco Systems\\VPN Client\\internal.ini\n\n[…]\n\n###### – C:\\Program Files (x86)\\Cisco Systems\\VPN Client C:\\Program Files (x86)\\Cisco Systems\\VPN Client\\qt-mt335.dll\n – Different loading than REDPEPPER and REDCURRY C:\\Program Files (x86)\\Cisco Systems\\VPN Client\\qtwidgets64.dll\n\nC:\\Program Files (x86)\\Cisco Systems\\VPN Client\\routexchange.dll.mui\n\n###### – Eventually named REDSALT. C:\\Program Files (x86)\\Cisco Systems\\VPN Client\\SetMTU.exe\n\nC:\\Program Files (x86)\\Cisco Systems\\VPN Client\\VAInst64 exe\n\n\n-----\n\n## REDSALT\n\n##### § Backdoor functionality\n\n § Persistence using ACI shims\n\n###### – Shim loads obfuscated 1[st] DLL (95% junk code)\n\n – 1[st] DLL decrypts and loads a second DLL (Rijndael)\n\n – 2[nd] DLL decrypts and loads resource (optional) which is packed payload\n##### § Found several versions\n\n###### – ACI shim and loader tuned for each compromised host\n\n – Final payload often the same\n##### § Final unpacked payload identified as Trojan_Win32_Plagon by Microsoft YARA rule\n\n\n-----\n\n## REDSALT\n\n###### •Service, COM, Winlogon events, ACI shims Persistence\n •Bootkit (pre-Vista)?\n\n •File or registry Configuration •Each entry is RC4 encrypted\n •Key changes for each sample\n\n •Encrypted file dropped on the system Active mode\n •HTTP/HTTPS with configured URLs (Wininet API)\n\n •Door knocking - raw sockets wait for a “magic” packet then open ports\n •Capability of proxying to next host Passive mode\n •Communications using IPV4/IPV6 or Intel AMT SOL on recent versions\n •Compatible with “Zc tool” referenced in MS report\n\n\n-----\n\n## REDSALT – AMT SOL\n\n\n-----\n\n## REDSALT - interactive mode\n\n\n-----\n\n## Hunting for REDSALT\n\n###### § Event logs\n\n – Program-Telemetry logs for InjectDLL shims are a gold mine\n\n – Firewall rule changes (hardcoded names)\n\n § Persistence – search for small sdb\n\n § Unique export “StartThreadAtWinLogon”\n\n – Search in memory\n\n – Stack string in 1[st] stage DLL\n\n\n-----\n\n## Hunting for REDSALT\n\n#### § Example event logs for InjectDll shim\n\n500 | Information | Compatibility fix applied to C:\\Program Files (x86)\\Cisco Systems\\VPN Client\\cvpnd.exe. Fix information: InjectDll, {3432bc96-d181-4529-b261-\n1a3964961b6c}, 0x00010206.\n\n500 | Information | Compatibility fix applied to C:\\Windows\\SysWOW64\\netsh.exe. Fix information: InjectDll, {3432bc96-d181-4529-b261-1a3964961b6c}, 0x00040206.\n\n500 | Information | Compatibility fix applied to C:\\Windows\\SysWOW64\\netsh.exe. Fix information: InjectDll, {3432bc96-d181-4529-b261-1a3964961b6c}, 0x00040206.\n\n500 | Information | Compatibility fix applied to C:\\Windows\\SysWOW64\\netsh.exe. Fix information: InjectDll, {3432bc96-d181-4529-b261-1a3964961b6c}, 0x00040206.\n\n500 | Information | Compatibility fix applied to C:\\Windows\\SysWOW64\\netsh.exe. Fix information: InjectDll, {3432bc96-d181-4529-b261-1a3964961b6c}, 0x00040206.\n\n500 | Information | Compatibility fix applied to C:\\Windows\\SysWOW64\\ipconfig.EXE. Fix information: InjectDll, {3432bc96-d181-4529-b261-1a3964961b6c}, 0x00040206.\n\n500 | Information | Compatibility fix applied to C:\\Windows\\SysWOW64\\netstat.EXE. Fix information: InjectDll, {3432bc96-d181-4529-b261-1a3964961b6c}, 0x00040206.\n\n500 | Information | Compatibility fix applied to C:\\Windows\\SysWOW64\\netstat.EXE. Fix information: InjectDll, {3432bc96-d181-4529-b261-1a3964961b6c}, 0x00040206.\n500 | Information | Compatibility fix applied to C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell.EXE. Fix information: InjectDll, {3432bc96-d181-4529-b261-\n1a3964961b6c}, 0x00040206.\n\n500 | Information | Compatibility fix applied to C:\\Windows\\SysWOW64\\systeminfo.EXE. Fix information: InjectDll, {3432bc96-d181-4529-b261-1a3964961b6c}, 0x00040206.\n\n500 | Information | Compatibility fix applied to C:\\Windows\\SysWOW64\\netstat.EXE. Fix information: InjectDll, {3432bc96-d181-4529-b261-1a3964961b6c}, 0x00040206.\n500 | Information | Compatibility fix applied to C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell.EXE. Fix information: InjectDll, {3432bc96-d181-4529-b261-\n1a3964961b6c}, 0x00040206.\n\n500 | Information | Compatibility fix applied to C:\\Windows\\SysWOW64\\systeminfo.EXE. Fix information: InjectDll, {3432bc96-d181-4529-b261-1a3964961b6c}, 0x00040206.\n500 | Information | Compatibility fix applied to C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell.EXE. Fix information: InjectDll, {3432bc96-d181-4529-b261-\n1a3964961b6c}, 0x00040206.\n\n500 | Information | Compatibility fix applied to C:\\Windows\\SysWOW64\\cmd.EXE. Fix information: InjectDll, {3432bc96-d181-4529-b261-1a3964961b6c}, 0x00040206.\n\n\n-----\n\n## Hunting for REDSALT •• C:\\Program Files (x86)\\Cisco Systems\\VPN Client\\qtwidgets64.dllC:\\Program Files (x86)\\Hewlett-Packard\\HP Hotkey Support\\hpbluetooth32.dll\n\n###### • C:\\Program Files\\DVD Maker\\en-US\\WM2CLIP.dll\n • C:\\Program Files\\DVD Maker\\en-US\\WMM4CLIP.dll\n\n#### § Stack strings in all first stage DLLs\n\n###### • C:\\Program Files (x86)\\SnapComms\\Client\\673\\SnapclientSSes.dll\n\n#### § Only offset on stack changes • C:\\Program Files (x86)\\VERITAS\\VxPBX\\bin\\vxlis_64.dll\n\n\n-----\n\n## Hunting for REDSALT •• C:\\Program Files (x86)\\Cisco Systems\\VPN Client\\qtwidgets64.dllC:\\Program Files (x86)\\Hewlett-Packard\\HP Hotkey Support\\hpbluetooth32.dll\n\n###### • C:\\Program Files\\DVD Maker\\en-US\\WM2CLIP.dll\n • C:\\Program Files\\DVD Maker\\en-US\\WMM4CLIP.dll\n\n#### § Remove displacement and keep\n###### static portion of the instruction • C:\\Program Files (x86)\\SnapComms\\Client\\673\\SnapclientSSes.dll\n\n • C:\\Program Files (x86)\\VERITAS\\VxPBX\\bin\\vxlis_64.dll\n\ndisplacement\n\ndword ptr [ebp + X]\n\nvalue\n\nmov r16/r32,\nimm16/32\n\n$stack string = { C7 45 ?? 53 74 61 72 C7 45 ?? 74 54 68 72 C7 45 ?? 65 61 64 41 C7 45 ?? 74 57 69 6E C7 45 ?? 4C 6F 67 6F }\n\n\n-----\n\n## REDSALT Encryption\n\n##### § Blowfish\n\n § Hardcoded keys K1 and K2 for network communications\n\n § C2 key (file and internet)\n\n###### – K = md5(xor(K1, K2))\n\n – K2 is a slight shift from K1\n##### § Door-knocking / Internal initial packets\n\n###### – K = md5(K1)\n\n – Configured password for authentication\n##### § K1 and K2 unchanged for years according to available samples\n\n § Blowfish small block size makes for potential SNORT sigs\n\n###### – More chances to find fixed patterns to hit on\n\n\n-----\n\n|X|Padding bytes|J|O|B|_|N|O|=|<COMMANDS>|\n|---|---|---|---|---|---|---|---|---|---|\n\n\n## Hunting for REDSALT\n\n#### § Network C2 comms\n\n###### – Malware looks for content starting with JOB_NO=\n\n – Padding at the beginning of the data up to 8 bytes\n\n – Compute all possible values for C2 for the first 8 bytes and encrypt with K\n\n § 1JOB_NO=\n\n § 20JOB_NO\n\n § 300JOB_N\n\n § ...\n\n 0 1 X X+7\n\n X Padding bytes J O B _ N O = <COMMANDS>\n\n 0 0\n\n\n-----\n\n|X|Padding bytes|Col3|Col4|P|A|S|S|W|O|R|D|:|<OPTIONS>|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n||0|0||||||||||||\n\n\n## Hunting for REDSALT\n\n#### § Network internal comms\n\n###### – Malware looks for content starting with campaign password\n\n – Padding at the beginning of the data up to 8 bytes\n\n § If known password, compute possible values like for C2\n\n § If unknown password, lucky hit possible J\n\n – 8 byte padding: 80000000\n\n § Mistake to put padding zeroes at the beginning\n\n 0 1 X X+Y\n\n X Padding bytes P A S S W O R D : <OPTIONS>\n\n 0 0\n\n\n-----\n\n## Going further\n\n##### § REDPEPPER and REDCURRY use the same custom packer\n\n § Sweeping for the packer may yield some results\n\n#### § Packer basics\n\n###### – Exports and imports rewritten on DLL load\n\nAdd A and B Add A and B\n\n###### – Same methodology used for each sample\n\nPush A\n\n###### – Registers, constants, instructions change Push added value Push A\n\nPush added value\n\nPush 0\n#### § Some slight patterns\n\nPush 0\n\nPush 0x6C6C642E =\n\nPush 0x6C6C642E =\n\n”lld.”\n\n”lld.”\n\nPush 0x32336C65 =\n\nPush 0x32336C65 =\n\n”23le”\n\n”23le”\n\nPush 0x6E72656B =\n\nPush 0x6E72656B =\n\n”nrek”\n\nAlways ”nrek”\n\nAlways\n\ntrue\n\ntrue\n\n\n-----\n\n## Example YARA rule for ESI\n\n\n-----\n\n## Hunting for the Packer\n\n##### § Limited resource intensive hunts (nervous client…)\n\n###### – Needed to translate YARA into regex\n\n – Limited to PE files only\n\n – Limited number of possibilities\n##### § Lots of interesting hits found on Exchange servers and Domain Controllers\n\n###### – Older variants of REDSALT, REDCURRY\n\n – REDMAIL\n\n – REDSAFFRON\n\n – pthreadvc3.dll\n\n – Vxlogagt.exe\n\n\n-----\n\n## Wait… REDSALT, REDCURRY again?\n\n##### § REDSALT\n\n###### – COM and Winlogon Events for persistence\n\n • C:\\Program Files\\Common Files\\System\\mslsf\\mslsf64.dll\n – No first stage DLL with stack strings • C:\\Program Files\\Common Files\\System\\mslsf\\msvtvc.DLL\n\n • C:\\Program Files\\Veritas\\NetBackup\\bin\\vxlogctl.exe\n – Firewall IOC would have caught these • C:\\Program Files\\Veritas\\NetBackup\\bin\\vxlogcfg.exe\n\n • C:\\Program Files\\Veritas\\NetBackup\\bin\\vxlogcfg.dll\n\n##### § REDCURRY\n\n###### – No persistence\n\n • C:\\Program Files\\VMware\\VMware Tools\\Drivers\\memctl\\vmaudio.cat\n – No PowerShell event log clearing • C:\\Program Files\\Windows Mail\\Setup\\wabimp.dll\n\n – No base64 encoded files\n\n – Memory only hunting would have failed too (malware no longer active)\n\n § Overall, good example of how difficult it can be to write a generic IOC\n\n\n-----\n\n###### software that is created by Microsoft, by\n\n## REDMAIL (“GP”) third-party vendors, or by your organization, on an Exchange server. This software can\n\n###### then process email messages that pass\n § Microsoft Exchange transport agent “msdbagt.dll” through the transport pipeline.”\n\n – .NET file specified in Exchange configuration file agents.config\n – Blended in as “Microsoft Exchange ODB Agent” § Obfuscated .NET calls a packed J DLL “msdbeng.dll”\n\n – GP export – process email\n – PM export – uninstall / delete § Configuration file “ExchPrf.inf” contains a list of targeted email addresses and a blacklist (spam)\n\n § Compress and encrypt targeted emails to configured directory on disk\n\n – 128 bit AES keys generated using CryptGenRandom()\n – AES keys encrypted with hardcoded public RSA 1024 bit key § Execute commands in an email from a configured sender as a batch script\n\n § First sample in the environment dropped on 2010 (recall first public report identified being MS April 2016)\n\n § No exfiltration mechanism what?\n\n\n-----\n\n###### • C:\\Windows\\SysWOW64\\UCappi.dll\n • C:\\Windows\\SysWOW64\\UCmappi.dll\n\n## REDSAFFRON • C:\\Windows\\SysWOW64\\Ucmmp.dll\n\n###### • C:\\Program Files\\Windows Mail\\setup\\msadco.dll\n\n##### § Found on:\n\n###### – Exchange (2008, 2012) – packed J but not obfuscated – Workstation (2015) – packed and obfuscated, loaded like Redcurry / Redpepper\n##### § Main purpose is acting as a malware carrier for data exfiltration and communication\n###### between hosts\n\n – Interoperate up to 10 utilities/malware – Listening to raw socket “pings” to initiate coms on another port\n##### § Configuration file encrypted using ICE § Helper utility – “showcfg”, “updatecfg”, etc. § Sample configurations retrieved\n\n###### – Start keylogger and unrecovered malware – Start keylogger and Redmail, send keylog data and encrypted emails to another  workstation running REDSAFFRON\n\n\n-----\n\n## REDSAFFRON configuration\n\n\n-----\n\n|Random|NetworkEncryptKey|\n|---|---|\n\n|Magic|Flag|Size|Payload|\n|---|---|---|---|\n\n|Random|Magic|Flag|Size|Payload|\n|---|---|---|---|---|\n\n\n## REDSAFFRON network encryption\n\n###### Random NetworkEncryptKey\n\n GenerateKey()\n\n Network Key\n\n IV = 0 AES 256 ECB Magic Flag Size Payload\n\n Random Magic Flag Size Payload\n\n\n-----\n\n## REDSAFFRON\n\n##### § Weakness in key generation\n\n###### – Example 32 char NetworkEncryptKey + 16 byte rand()\n\n § Only 6096 different possible keys\n\n § 4000 possible keys with known rand() bytes\n\n – Packets can be brute forced without knowing NetworkEncryptKey or rand() bytes\n\n § Search for DWORD decrypted “magic” (0x1E3F2) at offset 16\n\n § Search for DWORD decrypted protocol flags at offset 20 (1, 2, 4, 6, 7, 18, 21, 22)\n\n – Suitable for targeted hunting in an engagement, not general detection (SNORT SO rules, Surricata LUAJIT, …)\n\n\n-----\n\n## Conclusion\n\n##### § Very interesting group with very good opsec\n\n###### – Time triggers to delete malware, secure delete, working hours configs… – References to our engagement found in keylogs… – Op paused when Mandiant arrived\n § Some malware deleted\n § Some malware was put on standby\n § No active malware communications captured – Undetected for 9 years L\n##### § Low profile § Take the best out of public knowledge and use it § Not all IOCs are born equal! § Trying to hide will sometimes reveal you J\n\n\n-----\n\n# Thank you\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://summit.fireeye.com/content/dam/fireeye-www/summit/cds-2018/presentations/cds18-technical-s01-hunting-for-platinum.pdf"
    ],
    "report_names": [
        "cds18-technical-s01-hunting-for-platinum.pdf"
    ],
    "threat_actors": [
        {
            "id": "33f527a5-a5da-496a-a48c-7807cc858c3e",
            "created_at": "2022-10-25T15:50:23.803657Z",
            "updated_at": "2025-03-27T02:00:55.550132Z",
            "deleted_at": null,
            "main_name": "PLATINUM",
            "aliases": [
                "PLATINUM"
            ],
            "source_name": "MITRE:PLATINUM",
            "tools": [
                "JPIN",
                "Dipsind",
                "adbupd"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "7d8ef10e-1d7b-49a0-ab6e-f1dae465a1a4",
            "created_at": "2023-01-06T13:46:38.595679Z",
            "updated_at": "2025-03-27T02:00:02.869216Z",
            "deleted_at": null,
            "main_name": "PLATINUM",
            "aliases": [
                "TwoForOne",
                "G0068",
                "ATK33"
            ],
            "source_name": "MISPGALAXY:PLATINUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e61c46f7-88a1-421a-9fed-0cfe2eeb820a",
            "created_at": "2022-10-25T16:07:24.061767Z",
            "updated_at": "2025-03-27T02:02:10.094583Z",
            "deleted_at": null,
            "main_name": "Platinum",
            "aliases": [
                "ATK 33",
                "Operation EasternRoppels",
                "TwoForOne"
            ],
            "source_name": "ETDA:Platinum",
            "tools": [
                "AMTsol",
                "Adupib",
                "Adupihan",
                "Dipsind",
                "DvDupdate.dll",
                "JPIN",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "RedPepper",
                "RedSalt",
                "Titanium",
                "adbupd",
                "psinstrc.ps1"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716502,
    "ts_updated_at": 1743041556,
    "ts_creation_date": 1539381284,
    "ts_modification_date": 1539357679,
    "files": {
        "pdf": "https://archive.orkl.eu/7796e3ac5f6f5c8f1b2103662b7912ae9b6d2f50.pdf",
        "text": "https://archive.orkl.eu/7796e3ac5f6f5c8f1b2103662b7912ae9b6d2f50.txt",
        "img": "https://archive.orkl.eu/7796e3ac5f6f5c8f1b2103662b7912ae9b6d2f50.jpg"
    }
}