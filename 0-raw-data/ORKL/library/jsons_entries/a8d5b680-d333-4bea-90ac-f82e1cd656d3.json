{
    "id": "a8d5b680-d333-4bea-90ac-f82e1cd656d3",
    "created_at": "2023-01-12T15:11:00.089298Z",
    "updated_at": "2025-03-27T02:17:25.658768Z",
    "deleted_at": null,
    "sha1_hash": "4fab97777e5b2bba367a29bef7a19fea7058f22d",
    "title": "2020-03-05 - Bisonal- 10 years of play",
    "authors": "",
    "file_creation_date": "2022-05-28T15:56:09Z",
    "file_modification_date": "2022-05-28T15:56:09Z",
    "file_size": 3702573,
    "plain_text": "# Bisonal: 10 years of play\n\n**[blog.talosintelligence.com/2020/03/bisonal-10-years-of-play.html](https://blog.talosintelligence.com/2020/03/bisonal-10-years-of-play.html)**\n\nBy [Warren Mercer,](https://twitter.com/SecurityBeard/) [Paul Rascagneres and](https://twitter.com/r00tbsd?lang%3Den) [Vitor Ventura.](https://twitter.com/_vventura)\n\n_Update 06/03/20: added samples from 2020._\n\n## Executive summary\n\nSecurity researchers detected and exposed the Bisonal malware over the past 10\nyears. But the Tonto team, the threat actor behind it, didn't stop.\nThe victimology didn't change over time, either. Japanese, South Korean and Russian\norganizations were the prime targets for this threat actor.\nThe malware evolved to lower its detection ratio and improve the initial vector success\nrate.\n\n### What's new?\n\nBisonal is a remote access trojan (RAT) that's part of the [Tonto Team arsenal. The peculiarity](https://malpedia.caad.fkie.fraunhofer.de/actor/tonto_team)\nof the RAT is that it's been in use for more than 10 years — this is an uncommon and long\nperiod for malware. Over the years, it has evolved and adapted mechanisms to avoid\ndetection while keeping the core of its RAT the same. We identified specific functions here\nfor more than six years.\n\n### How did it work?\n\n\n-----\n\nBisonal used multiple lure documents to entice their victims to open and then be infected\nwith Bisonal malware. This group has continued its operations for over a decade and they\ncontinue to evolve their malware to avoid detection. Bisonal primarily used spear phishing to\nobtain a foothold within their victims' networks. Their campaigns had very specific targets\nwhich would suggest their end game was more around operational intelligence gathering and\nespionage.\n\n### So what?\n\nThis is an extremely experienced group likely to keep their activities even after exposure,\neven if we identified mistakes and bad copy/paste, they are doing this job for more than 10\nyears. We think that exposing this malware, explaining the behavior and the campaigns\nwhere Bisonal was used is important to protect the potential future targets. The targets to this\npoint are located in the public and private sectors with a focus on Russia, Japan and South\nKorea. We recommend the entities located in this area to prepare for this malware and actor\nand implement detections based on the technical details provided in this article.\n\n## Victimology and campaigns\n\nFrom our analysis and the intelligence shared by the community throughout the last decade\nof activities of Bisonal, we can conclude that the actor behind this malware is specifically\ntargeted at the South East Asian region, namely Japan and Korea with another significant\nfocus on Russian-speaking victims.\n\n\n-----\n\nWe identified a couple of decoy documents pointing to the victims. During the Heartbeat\n[campaign documented in 2012 by Trend Micro, dating back to 2009, the attacker used](https://blog.trendmicro.com/trendlabs-security-intelligence/pulsing-the-heartbeat-apt/)\nHangul Word Processor (HWP) decoy documents. This file format is mainly used in South\nKorea. The report mentioned political parties, media outfits, a national policy research\ninstitute, a military branch of South Korean armed forces, a small business sector\n[organization and branches of the South Korean government. Later in 2018, Unit 42 released](https://unit42.paloaltonetworks.com/unit42-bisonal-malware-used-attacks-russia-south-korea/)\na Bisonal paper where we can see a spear-phishing campaign in Russian and a decoy\ndocument alleged to be from Rostec, a Russian state-owned holding conglomerate\nheadquartered in Moscow.\n\n\n-----\n\n[Finally, in 2018, Ahnlab released a paper about \"Operation Bitter Biscuit\" where Bisonal was](https://image.ahnlab.com/file_upload/asecissue_files/ASEC_REPORT_vol.88.pdf)\nused against Korean and Japanese entities. India is also mentioned, but it was by another\nmalware named \"Bioazih\" by Ahnlab. In this paper, the editor mentions targets such as\nmanufacturers, defense industry and government.\n\nAdditionally, we can provide additional decoy documents. For example, a Korean document\nused in September 2014 where the title was \"Contact member and counselor of the\nAgriculture, Forestry, Livestock, Food and Marine Fisheries Committee:\"\n\n\n-----\n\nOr a Russian document about the CIPR Digital conference used in April 2018. This is an\napplication document that has been used to provide a decoy to the Bisonal malware. This\nconference has some high-ranking government and business attendees.\n\n\n-----\n\nIn 2019, a Russian RTF document — судалгаа.doc (research.doc) — was used with an\nexploit to drop the winhelp.wll file, which contains Bisonal.\n\n\n-----\n\nLast year, we also identified multiple Korean decoy documents using similar RTF exploits to\ndeliver Bisonal, namely ☆2020년도 예산안 운영위 서면질의 답변서_발간(1).doc (State\nCouncil Candidate (Minister of Justice Chumiae) Personnel Hearing Execution Plan (1) .doc)\nand 국무위원후보자(법무부장관 추미애) 인사청문회 실시계획서(1).doc (Written Inquiry from\nthe 2020 Budget Operation Committee (Published) (1) .doc) which are both alleged\ngovernment documents.\n\n\n-----\n\nBased on our research and the released paper mentioned above, the Bisonal malware is\n[part of the Tonto Team arsenal. Tonto Team was mentioned in the media in 2017 as one of](https://arstechnica.com/information-technology/2017/04/researchers-claim-china-trying-to-hack-south-korea-missile-defense-efforts/)\nthe actors who targeted South Korea, when the country announced it would deploy a\nTerminal High-Altitude Air Defense (THAAD) in response to North Korean missile tests. At\nthis time, researchers connected the Tonto Team to China.\n\n## 10 years of evolution\n\n### Introduction\n\nThe first variant of Bisonal publicly released went by the name of \"HeartBeat.\" At the end of\n2019, the actor changed their TTP and started using the Microsoft Office extension (.wll) to\nexecute the Bisonal payload. Based on this recent change, we decided to dive into the 10\nyears of evolution of Bisonal. To do so, we analysed more than 50 different samples and\nfocused on the changes that appear during the years of usage.\n\n### 2010: the birth\n\nThe oldest version of Bisonal we identified was compiled on Dec. 24, 2010. This version is\n\n\n-----\n\nthe simplest we identified. The attacker created a Windows library (.dll) designed as a\nWindows service (ServiceMain() entry point). When executed, the malware uses the\nWindows API to communicate with the Service Control Manager (SCM) and finally execute a\nthread. This thread contains the code of the malware.\n\nThe C2 server of this first Bisonal variant is young03[.]myfw[.]us (port 8888). We can notice\nthe usage of a dynamic DNS service. This is a Bisonal pattern. Even the newest version we\nidentified used this kind of service. The domain name was not obfuscated:\n\nThe IP address is a rollback if the first C2 server is down. In this campaign, the rollback was\nnot used as it is configured to localhost. The communication to the C2 server is performed by\nusing raw sockets:\n\n\n-----\n\nThe first action of the malware is to send the hostname of the infected system and the\n\"kris0315\" string. The sent data is not encrypted or obfuscated. We assume the string is an\nidentifier:\n\n\n-----\n\nThe malware supports only three commands:\n\nCommand execution: The execution is performed by the ShellExecuteW() API\nListing the running processes\nCleaning the malware: The malware first removes the registry key of the service and\nremoves the library. As the library is currently running, the deletion cannot be\nperformed immediately. The developer decided to use MoveFileEx() API with the\nMOVE_DELAY_UNTIL_REBOOT to remove the file at the reboot.\n\nThe malware contains the Bisonal string. It is interesting to notice the string is not used but is\nstill visible:\n\n\n-----\n\nThe sample was used in the HeartBeat campaign mentioned above.\n\nSha256: ba0bcf05aaefa17fbf99b1b2fa924edbd761a20329c59fb73adbaae2a68d2307\nC2 server: young03[.]myfw[.]us\n\n### 2011: obfuscation my darling & more espionage capabilities\n\n**2011 March: commect()**\n\nWe identified a sample from March 18, 2011. The sample is really similar to the variant from\n2010. We can notice that the developers wanted to hide some API usage. They use the\nLoadLibrary() API followed by GetProcAdress(). But they obfuscated the function name\nstrings by splitting it in two. Here is an example:\n\nOnce the two strings are concatenated and with the little-endian, the string becomes\n\"commect.\" After the malware replaces the \"m\" by \"n:\"\n\n\n-----\n\nThey use this trick for a couple of other API such as CreateThread(), CreatePipe(),\nPeekNamedPipe(), CreateProcessA(), CreateToolhelp32Snapshot(), ReadFile(), WriteFile()\nand, finally, the string \"cmd.exe.\"\n\nThe attacker also implemented a new order: execution of a command by using named pipe\nto get the output of the executed command. The attackers execute cmd.exe, followed by the\ncommand to be executed. An interesting point is the adding of a charset on each executed\ncommand:\n\n\n-----\n\nThis charset is designed to cover languages that use Cyrillic script such as Russian,\nBulgarian and Serbian. This hardcoded string could be an indicator concerning the targets of\nthis malware.\n\nsha256 : bb61cc261508d36d97d589d8eb48aaba10f5707d223ab5d5e34d98947c2f72af\nC2 server: kissyou01[.]myfw[.]us\n\n**2011 September: The big changes**\n\nThe developer decided to remove the MFC library and put almost all the code in a unique\nfunction. The number of functions is divided by three. Here is the main thread graph flow:\n\n\n-----\n\nAdditionally, the string such as the domain names of the URLs is encoded by using the XOR\nalgorithm (0x1f for example). The network communication is also obfuscated with a XOR\n(0x28).\n\nOn the version, the attacker supports the proxy server. It was a limitation of the previous\nvariants. If the target would have a proxy, the malware would not be able to communicate\noutside. The attacker retrieves the proxy configuration in the registry:\n\n\n-----\n\nThe network communication is divided in two parts. The first part uses the Microsoft\nWindows Wininet library. The purpose is to send reconnaissance information to the\nattackers. The data is sent to the server via InternetOpenA() and InternetOpenURLA(). The\nC2 server of the analysed sample is hxxp://fund[.]cmc[.]or[.]kr/UploadFile/fame/x/o0.asp. The\nmalware sent to the operator the following information: the campaign ID (named Flag by the\ndeveloper), the hostname of the compromised system, the IP address, the OS version, the\nproxy server of the system and if the system is running on VMware. To get this information,\nthe attacker the [VMXh-Magic-Value (0x0a). The second part of the communication is](https://www.aldeid.com/wiki/VMXh-Magic-Value)\ndedicated to the orders and the exfiltration. This part is similar to the previous samples: raw\nsockets usage.\n\nThe features of the malware are the same as previously with new capabilities such as file\ncreation and removal.\n\n\n-----\n\nThe author removed the malware cleaning feature and implements two others features: the\ndeveloper adds PostThreadMessageW() to send message inside the thread and in the\nprevious version the developer used TerminalProcess() API to stop the process executed via\nthe named pipes, in the version the developer append the \"exit\\r\\b\" string to the executed\ncommand in order to exit properly:\n\nAnother interesting change is the fact they don't use CHCP command anymore to force the\ncharset but use code page. You can see in the screenshot 0x4E3 (1251 - Cyrillic Russian)\nand 0x362 (866 - DOS Cyrillic Russian):\n\n\n-----\n\nSha256: 43606116e03672d5c2bca7d072caa573d3fc2463795427d6f5abfa25403bd280\nC2 for the orders: dnsdns1[.]PassAs[.]us\nC2 URL for reconnaissance: hxxp://fund[.]cmc[.]or[.]kr/UploadFile/fame/x/o0.asp\n\n**2011 October: oops where is my cleaning function?**\n\nIn October 2011, the attacker re-implements the cleaning function.\n\n\n-----\n\nIn this implementation, the developer first uses the Windows service management API in\norder to remove the service (instead of removing directly the registry key as he did\npreviously) and, finally, remove the file with the same API as previously (MoveFileExA()).\n\nSha256:43459f5117bee7b49f2cee7ce934471e01fb2aa2856f230943460e14e19183a6\n\nC2 for the orders: jennifer998[.]lookin[.]at\n\nC2 for rollback: 196[.]44[.]49[.]154\n\nC2 URL for reconnaissance: hxxp://fund[.]cmc[.]or[.]kr/UploadFile/fame/x/o0.asp\n\n**2011 December: Not a service anymore**\n\nThe new variant from December 2011 is not a service anymore but a simple library (.dll). The\n\n\n-----\n\nlibrary is executed via a launcher (conime.exe) and the persistence mechanism is not a\nservice anymore but a registry key (CurrentVersion\\\\Run\\\\task).\n\nThe malware is lighter than the previous version but includes more espionage features such\nas file exfiltration, file listing, driver listing, process-killing, file removing. The other features\nare the same as previously.\n\nIt is interesting to note that the obfuscated reconnaissance is still hard-coded in the binary\nbut it is not used anymore. The code used for the reconnaissance was removed but the\ndeveloper forgot the IP variable.\n\nSha256: 915ad316cfd48755a9e429dd5aacbee266aca9c454e9cf9507c81b30cc4222e5\nC2 for the orders: v3net[.]rr[.]nu\nC2 for rollback: faceto[.]UglyAs[.]com\nC2 URL for reconnaissance: hxxp://fund[.]cmc[.]or[.]kr/UploadFile/fame/x/mh/o.asp\n\n**Hardcoded identifiers**\n\nIn this version, we identify hard coded identifiers. We assume these IDs are campaign or\ntarget ID. Here is a list of IDs:\n\n1031\njp0201\njp-serv\nmhi\nm1213\nclassnk\n95mhi\nnscsvc\n\nIn the next version, a campaign ID will be also used. The ID we believe is in reference to\nJapan targets. We believe these targets to sit within both the public and private sectors and\nthey are specifically targeted to further enhance the attacker's capabilities through\nespionage.\n\n### 2012: File format year\n\n**February: Let's hide my code in an almost legit library**\n\nIn February 2012, the developer tried to hide the malicious code in the middle of a legit\nlibrary. The malicious library was named msacm32.dll and contains the same exports as a\n\n\n-----\n\nlegit library from Microsoft Windows named msacm.dll. Here is the export of the malicious\nlibrary with the same name than the real one:\n\nAs previously the hard-coded C2 for reconnaissance variable is here. Without being used.\n\nSha256: 6f8bbea18965b21dc8b9163a5d5205e2c5e84d6a4f8629b06abe73b11a809cca\n\nC2 for the orders: since[.]qpoe[.]com\n\nC2 for rollback: applejp[.]myfw[.]us\n\nC2 URL for reconnaissance: hxxp://fund[.]cmc[.]or[.]kr/UploadFile/fame/x/o0.asp\n\n**2012 May & December: l miss services**\n\nIn May and December 2012, the developers modified the .dll to come back to a Windows\n\n\n-----\n\nservice.\n\nAs previously described, the hardcoded C2 for reconnaissance variable is here. Without\nbeing used.\n\nSha256: b75c986cf63e0b5c201da228675da4eff53c701746853dfba6747bd287bdbb1d\nC2 for the orders: since[.]qpoe[.]com\nC2 for rollback: 69[.]197[.]149[.]98\nC2 URL for reconnaissance: hxxp://fund[.]cmc[.]or[.]kr/UploadFile/fame/x/o0.asp\n\nSha256: 979d4e6665ddd4c515f916ad9e9efd9eca7550290507848c52cf824dfbd72a7e\nC2 for the orders: usababa[.]myfw[.]us\nC2 for rollback: indbaba[.]myfw[.]us\nC2 URL for reconnaissance: hxxp://indbabababa[.]dns94[.]com/o.asp\n\n**2012 October: Standalone PE**\n\nIn October 2012, the attackers used an .exe. The attacker chose a standalone PE.\n\nAs previously the hard coded C2 for reconnaissance variable is here. without being used.\n\nSha256: 6f4a1b423c3936969717b1cfb25437ae8d779c095f158e3fded94aba6b6171ad\n\nC2 for the orders: mycount[.]MrsLove[.]com\n\nC2 for rollback: mycount[.]MrsLove[.]com\n\nC2 URL for reconnaissance: hxxp://fund[.]cmc[.]or[.]kr/UploadFile/fame/x/o0.asp\n\n### 2013: RIP\n\nWe did not identify any Bisonal samples used in 2013. The first explanation could be that it\nwas used so much that it stays under our radar. The second explanation could be a\n[publication from Trend Micro on January 3, 2013. In the publication, the editor described a](https://blog.trendmicro.com/trendlabs-security-intelligence/pulsing-the-heartbeat-apt/)\ncampaign where Bisonal was used. Maybe the actor decided to stop using Bisonal?\n\n### 2014: The rebirth\n\n**Packer**\n\nFor the first time, the Bisonal developers decided to use a packer: MPRESS. The Bisonal\nstring also disappears from the binary however the workflow of the malware stays the same\nand some features are copy/pasted from the previous Bisonal variant.\n\n\n-----\n\n**Obfuscation**\n\nThe domain and the port number are obfuscated but it is not a simple XOR anymore. The\ndevelopers implemented its own byte manipulation algorithm. The developer also\nimplemented an obfuscation concerning OS detection. The OS version string is not stored as\na string anymore but as bytes:\n\nIt is interesting to note that a few samples from 2014 do not use the obfuscation described\nabove.\n\n**Malware core**\n\nThe developer rewrote a large part of the code however the workflow is the same as\npreviously and some features are copy/paste. The binary is compiled with the MFC\nframework.\n\nThe biggest change is the network communication with the C2 server. The malware does not\nuse a raw socket anymore but all the communications are performed with WinInet. The\nmalware performs connection to the C2 server by using InternetOpenA() with an hardcoded\nUser-Agent: \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; .NET CLR 1.1.4322\". Note\nthe missing parenthesis at the end of the User-Agent. This typo will be there till today.\n\n\n-----\n\nThis variant has exactly the same features as the previous variant: file listing, OS version\ngetting, process killing, drive listing, execution via ShellExecuteW(), execution via named\npipe, cleaning, file removal, file downloading.\n\nHere is an example of code similarities on the execution via named pipe function. On the left\na sample from Bisonal 2014 and on the right Bisonal 2011. The code is not exactly the same\nbut the workflow and some constants are similar.\n\n\n-----\n\n**Hard-coded Identifiers & URL pattern**\n\nIn this new version, we identify three hard-coded identifiers:\n\nCampaign ID: an ID put in the exfiltrated data with the hostname and the OS version.\nWe assume this ID is used to identify the campaign and the target by the operator;\nMalware ID: used to generate the first \"word\" of the URL. We assume this ID is used to\nidentify the malware version (from a network protocol point of view);\nThird ID: used to generate the end \"word\" of the URL. It generally looks like a file\nname.\n\nThe URL pattern is the following: hxxp://C2_domain:PORT/MalwareIDVictimIPThirdID\n\nSHA256: c6baef8fe63e673f1bd509a0f695c3b5b02ff7cfe897900e7167ebab66f304ca\n\nC2 URL: hxxp://www[.]hosting[.]tempors[.]com:443/av9d0.0.0.0akspbv.txt\n\n### 2016: More packers\n\nIn 2016, the developer implemented a new way of packing Bisonal. An initial static analysis\nimmediately shows an executable with very little information. IDA Pro only shows five\nfunctions and almost no imports.\n\n\n-----\n\nLooking at the few functions available it becomes clear the packer uses several anti-analysis\ntricks. In the unpacking stage, the malware has a lot of useless jumps and calls which makes\nthe code tracking in the debugger harder.\n\nAfter the unpacking is done the malware continued to use several anti-analysis measures.\nThere are almost no direct calls to functions. It is common during the unpacking process to\n\n\n-----\n\nfind useless code, like sequences of one instruction followed by a jump or increments in\nregister values almost immediately followed by decrements. The initial unpacking is based\non the manipulation of the return addresses pushed in the stack and the ordering of the data\nwithin the .text section. A second stage will allocate memory and unpack code into it, which\nfinally will unpack code into a section that is originally empty called .textbss. This is where\nthe core of the malware will be.\n\nAll API calls are made through a dispatcher function. Which is not called directly either,\nbefore this function is called it goes through a series of jumps and the stack is filled with\nencoded offset values.\n\nThe call of the jump table entry:\n\nPush parameter for dispatch function into the stack:\n\n\n-----\n\nPush all general-purpose registers into the stack:\n\nBefore calling the actual dispatch function, all registers are saved to the stack, by doing this\n\n\n-----\n\nthe offset value is no longer on the top of the stack so the malware needs to put it back on\nthe top of the stack.\n\nAt this time and just before the argument in the stack we also have the return address, inside\nthe core of the malware. The dispatcher function will push the desired API function address\ninto the stack. Afterward, it will do the same for the general-purpose registers.\n\nAfter calling the dispatcher function the malware will first restore the generic purpose\nregisters from the stack, thus leaving the API function address at the top of the stack.\nLogically, after the ret instruction is executed the code will jump into the API function.\n\nThis mechanism allows the malware to execute API functions without ever using the Call\ninstruction, making it difficult to perform the analysis. The other side effect is that even after\nthe code is unpacked if the analyst tries to dump it and analyze it statically, it will be hard for\nthe disassembler to understand the code.\n\n\n-----\n\nThe dispatcher function has other tricks up its sleeve. Every time it is called it will use the\nanti-debug GetTickCount() to check if it is being debugged. If there is a discrepancy in the\ntiming it will terminate the process. The termination can be as simple as a call to\nExitProcess(), or it will first resume a thread that will display a message to the user. So that it\nensures the thread has a chance to run, it will return the API call sleep() no matter what was\noriginally requested. Once sleep() is executed, the error message thread will have a chance\nto be executed and will terminate the process.\n\nFrom the functionality point of view, there aren't many differences between the 2014\nversions. Always using three hard-coded identifiers mentioned previously but with different\nvalues.\n\n\n-----\n\nSHA256: 15d5c84db1fc7e13c03ff1c103f652fbced5d1831c4d98aad8694c08817044cc\nC2 URL: hxxp://emsit[.]serveirc[.]com/ks8d0.0.0.0akspbu.txt\n\n### 2018: I miss you\n\nDuring 2018, the attackers used a mix of samples using the MFC framework or the Visual C\nlibraries. The registry key used for the persistence is now named \"mismyou\".\n\nIn September 2018, the developer made a mistake. Normally on this variant of Bisonal the\ndomain names are encoded. However, the developer forgot to obfuscate the strings and put\nthem in clear text into the variables but the deobfuscation function is still executed:\n\nThe mistake has for effect to destroy the domain and generate garbage strings. The malware\nwill try to perfect connection to this bad domain (hxxp://硟满v鐿緲赥e ?r雀溝1kdi\n簽:70/ks8d0.0.0.0akspbu.txt). You can see here a screenshot of the debugger trying to\nperform a connect on it:\n\n\n-----\n\nSHA256: 92be1bc11d7403a5e9ad029ef48de36bcff9c6a069eb44b88b12f1efc773c504\nC2: kted56erhg[.]dynssl[.]com\n\nSHA256: d83fbe8a15d318b64b4e7713a32912f8cbc7efbfae84449916a0cbc5682a7516\nC2 fail: hxxp://硟满v鐿緲赥e ?r雀溝1kdi簽:70/ks8d0.0.0.0akspbu.txt\n\n### 2019 - Office Extension and a new packer\n\n**Packer**\n\nStatic analysis of this executable shows only two functions, but a regular number of imports.\n\n\n-----\n\nThis time the packer shares some of the characteristics from the advanced one used in\n2016.\n\nThere is a lot of useless code, including jumps and bswap operations. Upon detecting a\ndebugger attached to it, the malware will display the message below and terminate the\nexecution.\n\nThis message translates to \"The debugger was found to be running in your operating\n\n\n-----\n\nsystem. This turns it off before running the program again! .\n\nThis packer also hides the calls to API functions. This time instead of using a dispatcher\nfunction, the malware pushes the arguments into the stack as usual but will then perform a\ncall to a jump table built during the unpacking, in the .text section memory region.\n\nEven though a call is made, these are not functions, in fact, most of the code in this jump\ntable is useless except for the last instruction of each entry. Each entry finishes with a jmp\ninstruction into the respective API function. Effectively the malware doesn't do any call to API\nfunctions, it always performs a jump. The return address is loaded into the stack when the\nmalware does a call to the jump table. The end result is the same has in the packer from\n2016, but with a simpler mechanism.\n\nThe majority of the code was moved into a packed area. The malware configuration (such as\nC2 server and the User-Agent) is outside that area. The packer uses a thread-local storage\n(TLS) callback to unpack some of the code. At this stage, it uses in-place unpacking avoiding\n\n\n-----\n\nmemory allocations. One of the anti-analysis features included in this packer is the lack of\ncalls to API functions. In the early stages of execution, the malware loads the libraries and\nretrieves the addresses from functions it needs.\n\nFeature-wise, there is no change when compared with the 2016 version, in fact when\ncompared the C2 beaconing functions even share some of the offsets.\n\n**Office Extension**\n\nIn 2019, the actor behind Bisonal used a new way to deploy the machine on the target's\nsystems. They sent a malicious RTF document to the targets with an exploit targeting the\nCVE-2018-0798 (Microsoft's Equation Editor vulnerability). The purpose of the shellcode was\nnot to execute the malware (as it is usual) but simply to drop it in the\n%APPDATA%\\microsoft\\word\\startup\\ repository with the .wll extension.\n\nThe libraries in this directory with this specific extension will be loaded as a Microsoft Office\nextension. So next time the user opens an Office application, the malware will be loaded and\nexecuted. The purpose of the malware is to deploy Bisonal on the infected system\n($tmp$\\tmplogon.exe) and to create a Run registry key in order to execute Bisonal at the\nnext reboot of the system.\n\nWe think the purpose of this multistage execution is an anti sandbox technique. If you look at\nthe report after executing the malicious document, you only see one action: the .wll file\ncreation. The user also needs to open an Office application and finally a reboot is needed in\norder to execute the real payload: Bisonal.\n\n**Bigger is better**\n\nWe identified a version of Bisonal using Office extension with a really specific behavior\nduring the installation of the malicious payload. The dropper appends 80MB of binary data at\nthe end of the Bisonal binary:\n\n\n-----\n\nThe binary value is \"56MM\" is ASCII characters. If we look at the malware, we can see the\nappended data:\n\nWe are not sure of the purpose of the creation of a huge binary. It could be an anti-analysis\ntechnique. Some tools limit the size of the analyzed files. For example, by using the\nVirusTotal standard API, we cannot upload files bigger than 32MB. We also identified\nsandboxes that cannot handle big files correctly Remember size matters\n\n\n-----\n\n**Malware code**\n\nThe developer partially refactored the code. The variant from 2019 keeps exactly the same\nfeatures. The two main changes are the obfuscation and the network protocol to\ncommunicate to the C2 server.\n\nThe developers used two different obfuscation algorithms: one for the C2 encoding and one\nfor the data. The C2 encoding is a simple XOR (as in 2012):\n\nThe C2 encoding communication is also different. As the data are now sent with the GET\nmethod, the data must be in ASCII. That's they add base64 encoding in order to get\nsupported characters in the HTTP query.\n\nFor the first time, the developer switched from POST requests to GET requests:\n\n\n-----\n\nThe exfiltrated data is appended to the URL. Here is the pattern:\nhxxp://C2_domain/MalwareIDVictimIPThirdIDExfiltratedDataBase64\n\nSHA256:37d1bd82527d50df3246f12b931c69c2b9e978b593a64e89d16bfe0eb54645b0\nC2 URL:hxxp://www[.]amanser951[.]otzo[.]com/uiho0.0.0.0edrftg.txt\n\n### 2020 Business as Usual\n\n[Ahnlab, a South Korean software company, simultaneously published a paper regarding](https://asec.ahnlab.com/1298)\nBisonal's activity in South Korea. In this case, the infection vector has changed from previous\nsamples. The initial stage is a binary that drops a decoy document (Powerpoint or Excel\ndocument), a VisualBasic script and the packed Bisonal payload. The payload is dropped\nwith a .jpg extension that's been renamed to \".exe.\" Here is an example decoy document:\n\n\n-----\n\nThe purpose of the VisualBasic script is to execute the payload. Similar to attacks in 2019,\nthe attacker appends data in order to generate a large binary. Although the malicious part of\nthe binary is only 2MB, the final file is more than 120MB in size, padded out with random\ndata. This may be an attempt to evade antivirus engines that only scan up to a maximum file\nsize. The payload has been packed with a new packer.\n\nThe code of Bisonal is similar to the version of 2019. The attacker implements indirect API\ncalls by using GetProcAddress() and LoadLibrary() API.\n\n\n-----\n\nSha256: b7ef3ec4d9b0fd29c86c9a4b2a94819a80c83e44cdc47a9091786d839be6a7c4\n\nC2: imbc[.]onthewifi[.]com\n\n## Bisonal timelines summary\n\n\n-----\n\n## Conclusion\n\nThe actor behind Bisonal is clearly motivated and has an interest in Russian, Korean and\nJapanese victims. The development of Bisonal has been active for more than a decade. We\nhave observed the code evolving with the different publications but also with the evolution of\nMicrosoft Windows.\n\nHowever, specific functions are still used today, many years after the original implementation\nof the Bional malware. Even if Bisonal could be considered as simple with less than 30\nfunctions, it has spent its life targeting sensitive entities in both the public and private sectors.\nSome campaigns were even mentioned on mainstream media against military entities within\nthe mentioned regions.\n\nDuring the decade of activities, we also can see mistakes and rollbacks from the attackers.\nFor example, in one campaign they put the domain name of the C2 server in plaintext in the\nmalware which had the function to generate a non-ASCII string for the C2 servers once\ndecoded. In this condition, the malware cannot work on the compromised system. Even after\nso many years of activities, the attackers make mistakes.\n\nWe don't see any reason why this actor will stop in the near future. With this investigation\nand the analysis of this decade of activity, we hope to force this actor to innovate by\nproviding a better understanding of his arsenal and more specifically how Bisonal works.\n\n## Coverage\n\nWays our customers can detect and block this threat are listed below.\n\n\n-----\n\n[Advanced Malware Protection (AMP) is ideally suited to prevent the execution of the](https://www.cisco.com/c/en/us/products/security/advanced-malware-protection)\nmalware used by these threat actors. Exploit Prevention present within AMP is designed to\nprotect customers from unknown attacks such as this automatically.\n\n[Cisco Cloud Web Security (CWS) or Web Security Appliance (WSA) web scanning prevents](https://www.cisco.com/c/en/us/products/security/cloud-web-security/index.html)\naccess to malicious websites and detects malware used in these attacks.\n\n[Email Security can block malicious emails sent by threat actors as part of their campaign.](https://www.cisco.com/c/en/us/products/security/email-security-appliance/index.html)\n\n[Network Security appliances such as Next-Generation Firewall (NGFW), Next-Generation](https://www.cisco.com/c/en/us/products/security/firewalls/index.html)\n[Intrusion Prevention System (NGIPS), Cisco ISR, and Meraki MX can detect malicious](https://www.cisco.com/c/en/us/products/security/intrusion-prevention-system-ips/index.html)\nactivity associated with this threat.\n\n[AMP Threat Grid helps identify malicious binaries and build protection into all Cisco Security](https://www.cisco.com/c/en/us/solutions/enterprise-networks/amp-threat-grid/index.html)\nproducts.\n\n[Umbrella, our secure internet gateway (SIG), blocks users from connecting to malicious](https://umbrella.cisco.com/)\ndomains, IPs, and URLs, whether users are on or off the corporate network.\n\nOpen Source Snort Subscriber Rule Set customers can stay up to date by downloading the\n[latest rule pack available for purchase on Snort.org.](https://www.snort.org/products)\n\n## IOCs\n\n### OSQuery\n\nCisco AMP users can use Orbital Advanced Search to run complex OSqueries to see if their\nendpoints are infected with this specific threat. For specific OSqueries on this threat, click\nbelow:\n\n\n-----\n\n[Bisonal File Path Detected](https://github.com/Cisco-Talos/osquery_queries/blob/master/packs/win_malware.conf#L4)\n[Bisonal Registry Detected](https://github.com/Cisco-Talos/osquery_queries/blob/master/packs/win_malware.conf#L11)\n\n### SHA256:\n\n0cf9d9e01184d22d54a3f9b6ef6c290105eaa32c7063355ca477d94b130976af\n\n7dc58ff4389301a6eccc37098682742b96e5171d908acdeb62aeaa787496c80a\n\n0ff88a6cd7dcd27f14ebb7b2c97727b81e1aa701280d1164685c52c234e4a9df\n\n8252f2cdedf16f404d43c81d005ea8ebb10594477f738e40efacf9013e1470d2\n\n915ad316cfd48755a9e429dd5aacbee266aca9c454e9cf9507c81b30cc4222e5\n\n1128d10347dd602ecd3228faa389add11415bf6936e2328101311264547afa75\n\n92be1bc11d7403a5e9ad029ef48de36bcff9c6a069eb44b88b12f1efc773c504\n\n15d5c84db1fc7e13c03ff1c103f652fbced5d1831c4d98aad8694c08817044cc\n\n9638e7bb963ac881bd81071d305dea91b040536c55b7ee79b526b8afcfad6972\n\n1e66579b856cd331518d67c351bcb2b102399d8ade53370797228b289e905dc1\n\n979d4e6665ddd4c515f916ad9e9efd9eca7550290507848c52cf824dfbd72a7e\n\n22b3a86f91d2eb5a8a1e1cdc044bcf6aca898663071be5233bac00c0f0d3c001\n\n9c86c2dd001c47b933c6b5f43c8f87a6d0c01c066e3520e651fab51d19355d3c\n\n2c1e0facf563bb2054d9a883144ef9bad77ba75cdb46cc80843821c363c0a9dc\n\na4a5c60a392d236b76907f58597e83ba9c9d4cfc6a4502ef3e0e149b8710a0c6\n\n359835c4a9dbe2d95e483464659744409e877cb6f5d791daa33fd601a01376fc\n\nb1da7e1963dc09c325ba3ea2442a54afea02929ec26477a1b120ae44368082f8\n\n37d1bd82527d50df3246f12b931c69c2b9e978b593a64e89d16bfe0eb54645b0\nb75c986cf63e0b5c201da228675da4eff53c701746853dfba6747bd287bdbb1d\n\n43459f5117bee7b49f2cee7ce934471e01fb2aa2856f230943460e14e19183a6\n\nb85e4168972b28758984f919aef2ce0fde271ee1f0863510e521a2920fcc658e\n\n43606116e03672d5c2bca7d072caa573d3fc2463795427d6f5abfa25403bd280\n\nbd1a9b148580dad430683639b747d1c49932db5d8f6eb2d90e2583af976810dc\n\n436fc9530015c2d2b952a16d2a3dfa202d1cb1c577b580811b9b48355855591b\n\nc5496dc3fa96b657ab4467c551877bbced56fd07c00c7ccb199c1794235bf710\n\n444e864a3bb2abb1edccab4a5cd45bc0039f2a48e01615b2719da65a40a5140e\n\nc6baef8fe63e673f1bd509a0f695c3b5b02ff7cfe897900e7167ebab66f304ca\n\ncdba1a69d75f3e2256dccc16255aef07ded41c257b2cc95ccb801a0063445926\n\n5caada5737b0a6c8c8f8a27bfcd0fb2221af68a4856278c3919b37279daa7409\n\nd19b85891dd0f83808b70fbe68a56a64e828611dfe53d04a6c1c211f1352b5b5\n\n6676934d7f214cb256407400357c1f7ead69a523b3017f6a5bc30d06a11a8305\n\nd7692a71b85c869ee11647b80ea6d42b2e4303233c525a8fa7e6bec3599e2c8b\n\n67e286c7308dda5cd8fe4a1340f354927e5791ce6ef0ef02c93a4e063e11c4ad\n\nd83fbe8a15d318b64b4e7713a32912f8cbc7efbfae84449916a0cbc5682a7516\n\n6c714653a8fa54eef1de2f0148e5e8cf514907f6f523bf09c8ee126bebcdbdcc\n\n\n-----\n\ndd88b31275b7079899d945fc6de2dceaf7e8fc143ef24be5bb336585ddf6af1e\n6cc4707942f9323347c95066a43b30f874f1b1c783960cf8ed9ecf5914f85ba7\neb7681c653ef1942103cd3272fd124eaf73e79bb830be978535c18b73c87b985\n6ef4df8460ba57b836f52a9a73e2d739a3f2aa832bec6b663af53b55dc74a63d\neffd31b11bdc6486082967c2d8e53d979e59a88ba28e68a1c94f5a064a8a966d\n6f4a1b423c3936969717b1cfb25437ae8d779c095f158e3fded94aba6b6171ad\n6f8bbea18965b21dc8b9163a5d5205e2c5e84d6a4f8629b06abe73b11a809cca\nf3a30e5f8bfd0f936597bcef7cb43df11ec566467001dff9365771900e90acb1\n77a36530555eada268238050996839bd34670e8bfda477c30d9dd66574625f59\nf9302b7ecc32b891edeaf61353dc5e976832b7104ec0d36f1641f1f40cf6fe12\n799d858ff77c29684fc1522804ed45c24171484d9618211c817df01424bc981a\n23d263b6f55ac81f64c3c3cf628dd169d745e0f2b264581305f2f46efc879587\n72f6a54d0d09a16e6fde9800aa845cd1866001538afb2c8f61f3606f5e13f35a\n4bad5898373eb644662a8c1d5d5c674e2558908e34bb2fd915f3350b0f28752b\nb7ef3ec4d9b0fd29c86c9a4b2a94819a80c83e44cdc47a9091786d839be6a7c4\n\n### C2 servers:\n\n0906[.]toh[.]info\n\ndnsdns1[.]PassAs[.]us\n\neuiro8966[.]organiccrap[.]com\n\njennifer998[.]lookin[.]at\n\nkfsinfo[.]ByInter[.]net\n\nkted56erhg[.]dynssl[.]com\n\nmycount[.]MrsLove[.]com\n\nsince[.]qpoe[.]com\n\nusababa[.]myfw[.]us\n\nv3net[.]rr[.]nu\n\nwww[.]amanser951[.]otzo[.]com\n\nwww[.]amanser951.otzo[.]com\n\n137[.]170[.]185[.]211\n\n196[.]44[.]49[.]154\n\n21kmg[.]my-homeip[.]net\n\n61[.]90[.]202[.]197\n\n61[.]90[.]202[.]198\n\n69[.]197[.]149[.]98\n\nagent[.]my-homeip[.]net\n\napplejp[.]myfw[.]us\n\ndnsdns1[.]PassAs[.]us\n\nemsit[.]serveirc[.]com\n\netude[.]servemp3[.]com\n\neuiro8966[.]organiccrap[.]com\n\n\n-----\n\nfaceto[.]UglyAs[.]com\ngames[.]my-homeip[.]com\nhansun[.]serveblog[.]net\nhxxp://硟满v鐿緲赥e ?r雀溝1kdi簽:70/ks8d0.0.0.0akspbu.txt\nindbaba[.]myfw[.]us\nkazama[.]myfw[.]us\nkreng[.]bounceme[.]net\nkted56erhg[.]dynssl[.]com\nmycount[.]MrsLove[.]com\nnavego[.]serveblog[.]net\nshinkhek[.]myfw[.]us\nwew[.]mymom[.]info\nwww[.]hosting[.]tempors[.]com\nwww[.]nayana[.]adultdns[.]net\nwww[.]dds.walshdavis[.]com\nimbc[.]onthewifi[.]com\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-03-05 - Bisonal- 10 years of play.pdf"
    ],
    "report_names": [
        "2020-03-05 - Bisonal- 10 years of play.pdf"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "bf6cb670-bb69-473f-a220-97ac713fd081",
            "created_at": "2022-10-25T16:07:23.395205Z",
            "updated_at": "2025-03-27T02:02:09.777308Z",
            "deleted_at": null,
            "main_name": "Bitter",
            "aliases": [
                "T-APT-17",
                "TA397"
            ],
            "source_name": "ETDA:Bitter",
            "tools": [
                "Artra Downloader",
                "ArtraDownloader",
                "Bitter RAT",
                "BitterRAT",
                "Dracarys"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "655f7d0b-7ea6-4950-b272-969ab7c27a4b",
            "created_at": "2022-10-27T08:27:13.133291Z",
            "updated_at": "2025-03-27T02:00:55.490812Z",
            "deleted_at": null,
            "main_name": "BITTER",
            "aliases": [
                "T-APT-17"
            ],
            "source_name": "MITRE:BITTER",
            "tools": [
                "ZxxZ"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "58db0213-4872-41fe-8a76-a7014d816c73",
            "created_at": "2023-01-06T13:46:38.61757Z",
            "updated_at": "2025-03-27T02:00:02.874484Z",
            "deleted_at": null,
            "main_name": "Tonto Team",
            "aliases": [
                "BRONZE HUNTLEY",
                "Red Beifang",
                "G0131",
                "PLA Unit 65017",
                "Earth Akhlut",
                "TAG-74",
                "CactusPete",
                "KARMA PANDA"
            ],
            "source_name": "MISPGALAXY:Tonto Team",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "da483338-e479-4d74-a6dd-1fb09343fd07",
            "created_at": "2022-10-25T15:50:23.698197Z",
            "updated_at": "2025-03-27T02:00:55.526588Z",
            "deleted_at": null,
            "main_name": "Tonto Team",
            "aliases": [
                "Tonto Team",
                "Earth Akhlut",
                "BRONZE HUNTLEY",
                "CactusPete",
                "Karma Panda"
            ],
            "source_name": "MITRE:Tonto Team",
            "tools": [
                "Mimikatz",
                "Bisonal",
                "ShadowPad",
                "LaZagne",
                "NBTscan",
                "gsecdump"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "08c8f238-1df5-4e75-b4d8-276ebead502d",
            "created_at": "2023-01-06T13:46:39.344081Z",
            "updated_at": "2025-03-27T02:00:03.056208Z",
            "deleted_at": null,
            "main_name": "Copy-Paste",
            "aliases": [],
            "source_name": "MISPGALAXY:Copy-Paste",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c39b0fe6-5642-4717-9a05-9e94265e3e3a",
            "created_at": "2022-10-25T16:07:24.332084Z",
            "updated_at": "2025-03-27T02:02:10.175452Z",
            "deleted_at": null,
            "main_name": "Tonto Team",
            "aliases": [
                "Bronze Huntley",
                "CactusPete",
                "Earth Akhlut",
                "HartBeat",
                "Karma Panda",
                "LoneRanger",
                "Operation Bitter Biscuit",
                "TAG-74",
                "Tonto Team"
            ],
            "source_name": "ETDA:Tonto Team",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Bioazih",
                "Bisonal",
                "CONIME",
                "Dexbia",
                "Korlia",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "POISONPLUG.SHADOW",
                "RoyalRoad",
                "ShadowPad Winnti",
                "XShellGhost"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536260,
    "ts_updated_at": 1743041845,
    "ts_creation_date": 1653753369,
    "ts_modification_date": 1653753369,
    "files": {
        "pdf": "https://archive.orkl.eu/4fab97777e5b2bba367a29bef7a19fea7058f22d.pdf",
        "text": "https://archive.orkl.eu/4fab97777e5b2bba367a29bef7a19fea7058f22d.txt",
        "img": "https://archive.orkl.eu/4fab97777e5b2bba367a29bef7a19fea7058f22d.jpg"
    }
}