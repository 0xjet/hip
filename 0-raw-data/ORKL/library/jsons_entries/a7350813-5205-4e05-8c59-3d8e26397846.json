{
    "id": "a7350813-5205-4e05-8c59-3d8e26397846",
    "created_at": "2023-01-12T15:00:28.921689Z",
    "updated_at": "2025-03-27T02:09:30.125114Z",
    "deleted_at": null,
    "sha1_hash": "634e488d66bed2499dba8352eb3fd177a638695a",
    "title": "2020-06-13 - TroyStealer – A new info stealer targeting Portuguese Internet users",
    "authors": "",
    "file_creation_date": "2022-05-28T21:47:26Z",
    "file_modification_date": "2022-05-28T21:47:26Z",
    "file_size": 1258404,
    "plain_text": "# TroyStealer – A new info stealer targeting Portuguese Internet users\n\n**[seguranca-informatica.pt/troystealer-a-new-info-stealer-targeting-portuguese-internet-users](https://seguranca-informatica.pt/troystealer-a-new-info-stealer-targeting-portuguese-internet-users)**\n\nJune 12, 2020\n\n**TroyStealer – A new info stealer targeting Portuguese internet users.**\nThe world of cybercrime is changing, and more and more malware variants have spread\nevery day. To keep your system safe, one of the things you can do is following a cyber\ndoctrine focused on the threats that lunk on the web.\n\nOne of the most recent threats is the info stealer TroyStealer, first shared by Abuse.ch on\nTwitter, and targeting Portuguese users.\n\n[There seems to be a new stealer in town called #TroyStealer, targeting Portuguese](https://twitter.com/hashtag/TroyStealer?src=hash&ref_src=twsrc%5Etfw)\ninternet users �\n\n[EXE:https://t.co/FjbUCSreSl](https://t.co/FjbUCSreSl)\n\nExfil email address:\n\n[[email protected]](https://seguranca-informatica.pt/cdn-cgi/l/email-protection)\n\nHas anyone seen this threat before?\n\n/cc [@CNCSgovpt](https://twitter.com/CNCSgovpt?ref_src=twsrc%5Etfw) [@sirpedrotavares](https://twitter.com/sirpedrotavares?ref_src=twsrc%5Etfw) [pic.twitter.com/1bDK3BtYeE](https://t.co/1bDK3BtYeE)\n\n[— abuse.ch (@abuse_ch) June 12, 2020](https://twitter.com/abuse_ch/status/1271371639553490944?ref_src=twsrc%5Etfw)\n\nAn information **stealer (or info stealer) is a Trojan that is designed to gather information**\nfrom a system. The malware gathers login information, like usernames and passwords\nstored on web-browsers, which it sends to another system via email. Another common form\nthis malware is to log user keystrokes which may reveal sensitive information.\n\n\n-----\n\n**_h/t:_** **_[abuse.ch](https://twitter.com/abuse_ch/status/1271371639553490944)_**\n\n**_Figure 1: Email template TroyStealer (in the Portuguese language)._**\n\nThe message sent in the email template is related to problems with the victim’s bank\naccount. When the problems are overcome, the victim will receive payment in your account.\n\n## The binary file\n\n**Threat name: TroyStealer.exe**\n\n**MD5: DAB6194F16CEFDB400E3FB6C11A76861**\n\n**SHA1: C76A9FB1A2AE927BF9C950338BE5B391FED29CD7**\n\n**Imphash: F34D5F2D4577ED6D9CEEC516C1F5A744**\n\n**Created: Thu Jun 11 19:53:24 2020**\n\nAt first glance, the info stealer malware is packed (entropy 7.177), and it was compiled on\n**Thu Jun 11 19:53:24 2020 via a .NET compiler (Microsoft Visual C# v7.0).**\n\n\n-----\n\n**_Figure 2: Compilation and packing details of TroyStealer malware._**\n\nBefore executing the PE file, some details can be observed such as specific call references\nused to decrypt/unpacking the binary and execute another instance in memory via Process\nInjection technique.\n\n**_Figure 3: Process of unpacking the binary._**\n\n\n-----\n\n**_Figure 4: Smart Assembly 6.9.0.114 – used to obfuscate the binary._**\n\nAfter unpacking it, we observed the binary was also obfuscated in a second-round with .NET\n**Reactor(4.8-4.9).**\n\nFigure 5 depicts the high flow diagram of TroyStealer malware.\n\n\n-----\n\n**_Figure 5: TroyStealer malware high flow diagram._**\n\nIn detail, the malware detects if it is running inside a VM and stops the execution. In contrast,\nthe malware is executed and a new process is created and executed using the process\ninjection technique. After that, the harvesting process is initiated. Some modules of collecting\ndetails from the browser are started as well as another module to collect mail credentials\nfrom outlook.\n\nIn sum, the following steps are performed during the malware execution:\n\n**Obtaining victim’s details (credentials info from browser and email)**\n**Getting HKEY_CURRENT_USER\\Software\\Paltalk passwords**\n**Deleting browser specific files**\n**Getting Security products installed on the device**\n**Obtaining Operating system version**\n**Getting Keystrokes**\n**Sent information via email to the attacker**\n\n### Filles accessed during the malware execution\n```\nC:\\Users\\user\\AppData\\Roaming\\Mozilla\\Firefox\\profiles.ini\nC:\\Users\\user\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data\nC:\\Users\\user\\AppData\\Roaming\\Mozilla\\Firefox\\profiles.ini\nC:\\Users\\user\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\0i8ia8vs.default\\logins.json\n\n Deleted files during the malware execution\nC:\\Users\\user\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\0i8ia8vs.default\\cookies.sqlite\nC:\\Users\\user\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\0i8ia8vs.default\\places.sqlite\nC:\\Users\\user\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Cookies\nC:\\Users\\user\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Web Data\nC:\\Users\\user\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\History\n\n Getting security products, OS version, and Reg Keys\nIWbemServices::ExecQuery - root\\cimv2 : SELECT Caption FROM Win32_OperatingSystem\nIWbemServices::ExecQuery - root\\SecurityCenter2 : SELECT * FROM AntivirusProduct\nKey opened: HKEY_CURRENT_USER\\Software\\Paltalk\nKey opened: HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\nMessaging Subsystem\\Profiles\\Outlook\\9375CFF0413111d3B88A00104B2A6676\n\n```\nFinally, the malware validates there is a valid Internet connection through a speed test\nwebsite. If so, it establishes SMTP communication with the authenticated email server and\nsends the victim’s details via email.\n\n\n-----\n\n**_Figure 6: Snippet of code with the email sent to the attacker inbox with the victim’s details._**\n\n\n-----\n\n**_Figure 7: Details sent to the attacker’s email addressed._**\n\n## Final Thoughts\n\nMalware is nowadays one of the major cyber weapons to destroy a business, market\nreputation, and even infect a wide number of users. The next list presents some tips on how\nyou can prevent a malware infection. It is not a complete list, just a few steps to protect\nyourself and your devices.\n\nGet outdated software of your system\nGet email savvy; take several minutes looking at the new email and not a few seconds\nBeware of fake tech support, emails related do bank transactions, invoices, COVID19,\neverything you think be strange\nKeep Internet activity relevant\nLog out at the end of the day\nOnly access secured and trusted sites (not only websites with green lock – please\nthink you are doing, as many phishing campaigns are abusing of free CA to create\nvalid HTTPS certificates and to distribute malicious campaigns over it)\nKeep your operating system up to date\nMake sure you are using an antivírus\nBeware of malvertising\n\n\n-----\n\n## Take-home message Be proactive and start taking malware protection seriously!\n\n Mitre Att&ck Matrix\n\n Indicators of Compromise (IOCs)\n```\nThreat name: TroyStealer.exe\nMD5: DAB6194F16CEFDB400E3FB6C11A76861\nSHA1: C76A9FB1A2AE927BF9C950338BE5B391FED29CD7\nImphash: F34D5F2D4577ED6D9CEEC516C1F5A744\nCreated: Thu Jun 11 19:53:24 2020\nsmtp.]ionos.]es - 213.165.67.102\n[email protected]\nSubject: TROY STEALER\n--/---/---/--/--/--/--/--/--/--/--/--/--/--/--/--/--/--/--/--/---/\nhttps://bazaar.abuse.ch/sample/9bc17db7e037caa4b6f176fdfc89a132dc63445bf66cf51050bb77c\nMalspam distributing TroyStealer:\nHELO: miranda.wv.]pt\nSending IP: 195.22.19.123\nFrom: [email protected]]pt\nSubject: Pagamento Recusado\nAttachment: FA.202005.0069771.DOC.img (contains \"FA.202005.0069771.DOC.exe\")\nTroyStealer SMTP exfil email address:\n[email protected]\n\n References\n\n```\n– Email template, **[Abuse.ch](https://twitter.com/abuse_ch/status/1271371639553490944)**\n\n\n-----\n\n[Pedro Tavares](https://seguranca-informatica.pt/author/pipocaz/)\n**[Pedro Tavares is a professional in the field of information security working as an Ethical](https://www.linkedin.com/in/sirpedrotavares/)**\nHacker/Pentester, Malware Researcher and also a Security Evangelist. He is also a founding\nmember at CSIRT.UBI and Editor-in-Chief of the security computer blog segurancainformatica.pt.\n\nIn recent years he has invested in the field of information security, exploring and analyzing a\nwide range of topics, such as pentesting (Kali Linux), malware, exploitation, hacking, IoT and\nsecurity in Active Directory networks. He is also Freelance Writer (Infosec. Resources\n[Institute and Cyber Defense Magazine) and developer of the 0xSI_f33d – a feed that](https://feed.seguranca-informatica.pt/)\ncompiles phishing and malware campaigns targeting Portuguese citizens.\n\n[Read more here.](https://seguranca-informatica.pt/contacto/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-06-13 - TroyStealer – A new info stealer targeting Portuguese Internet users.pdf"
    ],
    "report_names": [
        "2020-06-13 - TroyStealer – A new info stealer targeting Portuguese Internet users.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535628,
    "ts_updated_at": 1743041370,
    "ts_creation_date": 1653774446,
    "ts_modification_date": 1653774446,
    "files": {
        "pdf": "https://archive.orkl.eu/634e488d66bed2499dba8352eb3fd177a638695a.pdf",
        "text": "https://archive.orkl.eu/634e488d66bed2499dba8352eb3fd177a638695a.txt",
        "img": "https://archive.orkl.eu/634e488d66bed2499dba8352eb3fd177a638695a.jpg"
    }
}