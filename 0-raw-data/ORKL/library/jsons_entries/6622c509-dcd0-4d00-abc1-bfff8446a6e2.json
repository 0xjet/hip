{
    "id": "6622c509-dcd0-4d00-abc1-bfff8446a6e2",
    "created_at": "2023-01-12T15:07:53.437296Z",
    "updated_at": "2025-03-27T02:13:33.067778Z",
    "deleted_at": null,
    "sha1_hash": "de2b3d4d0ba286f5daf682578931e0c040a61d84",
    "title": "2018-10-10 - Gallmaker- New Attack Group Eschews Malware to Live off the Land",
    "authors": "",
    "file_creation_date": "2022-05-28T21:57:57Z",
    "file_modification_date": "2022-05-28T21:57:57Z",
    "file_size": 798898,
    "plain_text": "# Gallmaker: New Attack Group Eschews Malware to Live off the Land\n\n**[symantec.com/blogs/threat-intelligence/gallmaker-attack-group](https://www.symantec.com/blogs/threat-intelligence/gallmaker-attack-group)**\n\n\n-----\n\nThreat Hunter TeamSymantec\n\n## A new attack group is targeting government, military, and defense sectors in what appears to be a classic espionage campaign.\n\n**UPDATE October 11, 2018**\n\n_This blog has been updated with a revised list of IoCs. An earlier list of IOCs attached to this_\n_blog was generated through an automated system and, due to the dual-use nature of the_\n_tools used by the group, erroneously included some low fidelity IoCs._\n\nSymantec researchers have uncovered a previously unknown attack group that is targeting\ngovernment and military targets, including several overseas embassies of an Eastern\nEuropean country, and military and defense targets in the Middle East. This group eschews\ncustom malware and uses living off the land (LotL) tactics and publicly available hack tools to\ncarry out activities that bear all the hallmarks of a cyber espionage campaign.\n\n\"#Gallmaker eschews custom malware, uses living off the land and publicly available hack\ntools https://symc.ly/2RBkaR8\"\n[Click to Tweet](https://twitter.com/intent/tweet?text=%23Gallmaker%20eschews%20custom%20malware,%20uses%20living%20off%20the%20land%20and%20publicly%20available%20hack%20tools%20https://symc.ly/2RBkaR8&via=threatintel&hashtags=undefined)\nThe group, which we have given the name Gallmaker, has been operating since at least\nDecember 2017, with its most recent activity observed in June 2018.\n\n## Tactics and tools\n\nThe most interesting aspect of Gallmaker’s approach is that the group doesn’t use malware\nin its operations. Rather, the attack activity we observed is carried out exclusively using LotL\ntactics and publicly available hack tools. The group takes a number of steps to gain access\nto a victim’s device and then deploys several different attack tools, as follows:\n\n1. The group delivers a malicious Office lure document to victims, most likely via a spear\nphishing email.\n2. These lure documents use titles with government, military, and diplomatic themes, and\n\nthe file names are written in English or Cyrillic languages. These documents are not\nvery sophisticated, but evidence of infections shows that they’re effective. The\nattackers use filenames that would be of interest to a variety of targets in Eastern\nEurope, including:\n\n_bg embassy list docx_\n\n\n-----\n\n_Navy.ro members list.docx_\n\n1. These lure documents attempt to exploit the Microsoft Office Dynamic Data Exchange\n\n(DDE) protocol in order to gain access to victim machines. When the victim opens the\nlure document, a warning appears asking victims to “enable content” (See Figure 1).\nShould a user enable this content, the attackers are then able to use the DDE protocol\nto remotely execute commands in memory on the victim’s system. By running solely in\nmemory, the attackers avoid leaving artifacts on disk, which makes their activities\ndifficult to detect.\n2. Once the Gallmaker attackers gain access to a device, they execute various tools,\n\nincluding:\n\nWindowsRoamingToolsTask: Used to schedule PowerShell scripts and tasks.\nA \"reverse_tcp\" payload from Metasploit: The attackers use obfuscated shellcode that\nis executed via PowerShell to download this reverse shell.\nA legitimate version of the WinZip console: This creates a task to execute commands\nand communicate with the command-and-control (C&C) server. It’s likely this WinZip\nconsole is used to archive data, probably for exfiltration.\nThe Rex PowerShell library, which is publicly available on GitHub, is also seen on\nvictim machines. This library helps create and manipulate PowerShell scripts for use\nwith Metasploit exploits.\n\nGallmaker is using three primary IP addresses for its C&C infrastructure to communicate with\ninfected devices. There is also evidence that it is deleting some of its tools from victim\nmachines once it is finished, to hide traces of its activity.\n\n\n-----\n\nFigure 1. An example of the type of warning displayed by the lure document\nThe DDE protocol can be used for legitimate purposes to send messages between Microsoft\napplications that share data through shared memory, e.g. to share data between Excel and\nWord.\n\n[However, the DDE protocol was flagged as unsecure last year, when researchers discovered](https://www.cyberscoop.com/dde-microsoft-word-vulnerability-feature/)\nit could be exploited to execute code on victim machines via Excel and Word, without macros\nbeing enabled in those applications. Microsoft said at the time that this capability was a\nfeature and the company did not consider it a vulnerability because Office always warned\nusers before enabling DDE in documents, as seen in Figure 1. However, after the DDE\nprotocol was subsequently exploited in a number of malware campaigns, Microsoft issued an\n[update to Office in December 2017 that disabled DDE by default in Word and Excel. DDE](https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/ADV170021)\ncan be enabled manually after this update is applied but only if the registry is altered by an\nadmin account.\n\n\n-----\n\nThe Gallmaker victims we have seen did not have this patch installed and therefore were still\nvulnerable to exploit via the DDE protocol.\n\n## Targets and timeline\n\nGallmaker’s activity appears to be highly targeted, with its victims all related to government,\nmilitary, or defense sectors. Several targets are embassies of an Eastern European country.\nThe targeted embassies are located in a number of different regions globally, but all have the\nsame home country.\n\nThe other targets we have seen are a Middle Eastern defense contractor and a military\norganization. There are no obvious links between the Eastern European and Middle Eastern\ntargets, but it is clear that Gallmaker is specifically targeting the defense, military, and\ngovernment sectors: its targets appear unlikely to be random or accidental.\n\nGallmaker’s activity has been quite consistent since we started tracking it. The group has\ncarried out attacks most months since December 2017. Its activity subsequently increased in\nthe second quarter of 2018, with a particular spike in April 2018.\n\nFigure 2. Gallmaker activity, December 2017 to June 2018\nGallmaker’s activity points strongly to it being a cyber espionage campaign, likely carried out\nby a state-sponsored group.\n\nGallmaker may well have continued to avoid detection were it not for Symantec’s\nTargeted Attack Analytics (TAA) technology.\n\n\n-----\n\n## How did we discover Gallmaker?\n\nThe fact that Gallmaker appears to rely exclusively on LotL tactics and publicly available\nhack tools makes its activities extremely hard to detect. We have written extensively about\nthe increasing use of LotL tools and publicly available hack tools by cyber criminals. One of\nthe primary reasons for the increased popularity of these kinds of tools is to avoid detection;\nattackers are hoping to “hide in plain sight”, with their malicious activity hidden in a sea of\nlegitimate processes.\n\nGallmaker may well have continued to avoid detection were it not for Symantec’s Targeted\nAttack Analytics (TAA) technology. TAA combines the capabilities of Symantec’s worldleading security experts with advanced artificial intelligence and machine learning to provide\norganizations with their own “virtual analysts”, via our Advanced Threat Protection (ATP)\nproduct. Since its inception, TAA has detected security incidents at thousands of\norganizations, automating what would have taken many hours of analyst time. In this\ninstance, TAA identified the specific PowerShell commands used by Gallmaker as being\nsuspicious, leading to the discovery of this new campaign. Without TAA’s advanced AIbased capabilities, Gallmaker’s activities may well have remained undetected.\n\n## Protection\n\nThe following protections are in place to protect customers against Gallmaker attacks:\n\n[System Infected: Meterpreter Reverse TCP](https://www.symantec.com/security_response/attacksignatures/detail.jsp?asid=25678)\n\n[W97M.Downloader](https://www.symantec.com/security-center/writeup/2014-110100-2117-99)\n\nNetwork protection products also detect activity associated with Gallmaker.\n\n## Indicators of Compromise\n\nThe following indicators are specific to Gallmaker:\n\n### Network\n\n111[.]90.149.99/o2\n94[.]140.116.124/o2\n94[.]140.116.231/o2\n\n### Filenames\n\nbg embassy list.docx\nNavy.ro members list.docx\nБГ в чуждите медии 23.03.2018-1.docx\n\n\n-----\n\n[REDACTED] and cae join forces to develop integrated live virtual constructive training\nsolutions.docx\nА-9237-18-brasil.docx\n\nGallmaker also used tools that were available in open source projects. Yara rule and\nmethods shared below were used by Gallmaker but aren't exclusive to the group's activity.\nDetection of these in one's environment is only indicative of possible unauthorized activity.\nEach occurrence of triggers must be examined to determine intent.\n\nrule Suspicious_docx\n{\nmeta:\ncopyright = \"Symantec\"\nfamily = \"Suspicious DOCX”\ngroup = \"Gallmaker\"\ndescription = \"Suspicious file that might be Gallmaker”\n\nstrings:\n$quote = /<w:fldSimple w:instr=\" QUOTE (( [^\"]+)* [0-9]\n\n{2,3}\n\n)\n\n{4}\n\n/\n$text = \"select \\\"Update field\\\" and click \\\"OK\\\"\"\n\ncondition:\nany of them\n}\n\n[Use of Rex Powershell - https://github.com/rapid7/rex-powershell](https://github.com/rapid7/rex-powershell)\n\nUse of obfuscated shellcode executed via PowerShell to download a \"reverse_tcp\" payload\nfrom Metasploit\nonto victim systems. For example, msfvenom -p windows/meterpreter/reverse_tcp -o\npayload.bin\n\n## Further reading\n\nTo find out more about TAA, read our whitepaper: Targeted Attack Analytics: Using Cloudbased Artificial Intelligence for Enterprise-Focused Advanced Threat Protection.\n\n\n-----\n\n## About the Author\n\n### Threat Hunter Team\n\n**Symantec**\n\nThe Threat Hunter Team is a group of security experts within Symantec whose mission is to\ninvestigate targeted attacks, drive enhanced protection in Symantec products, and offer\nanalysis that helps customers respond to attacks.\n\n## Want to comment on this post?\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-10-10 - Gallmaker- New Attack Group Eschews Malware to Live off the Land.pdf"
    ],
    "report_names": [
        "2018-10-10 - Gallmaker- New Attack Group Eschews Malware to Live off the Land.pdf"
    ],
    "threat_actors": [
        {
            "id": "75064860-5d9f-479d-accb-85c66c3b1c59",
            "created_at": "2022-10-25T15:50:23.328221Z",
            "updated_at": "2025-03-27T02:00:55.443322Z",
            "deleted_at": null,
            "main_name": "Gallmaker",
            "aliases": [
                "Gallmaker"
            ],
            "source_name": "MITRE:Gallmaker",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d3f381a3-9f9f-47e7-9d02-de51b73777d3",
            "created_at": "2022-10-25T16:07:23.656177Z",
            "updated_at": "2025-03-27T02:02:09.910436Z",
            "deleted_at": null,
            "main_name": "Gallmaker",
            "aliases": [],
            "source_name": "ETDA:Gallmaker",
            "tools": [
                "LOLBAS",
                "LOLBins",
                "Living off the Land"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "77b28afd-8187-4917-a453-1d5a279cb5e4",
            "created_at": "2022-10-25T15:50:23.768278Z",
            "updated_at": "2025-03-27T02:00:55.5423Z",
            "deleted_at": null,
            "main_name": "Inception",
            "aliases": [
                "Inception Framework",
                "Cloud Atlas"
            ],
            "source_name": "MITRE:Inception",
            "tools": [
                "PowerShower",
                "VBShower",
                "LaZagne"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d2c38c87-27a5-489b-ac64-ee8306409aac",
            "created_at": "2023-01-06T13:46:38.890574Z",
            "updated_at": "2025-03-27T02:00:02.944271Z",
            "deleted_at": null,
            "main_name": "Gallmaker",
            "aliases": [],
            "source_name": "MISPGALAXY:Gallmaker",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536073,
    "ts_updated_at": 1743041613,
    "ts_creation_date": 1653775077,
    "ts_modification_date": 1653775077,
    "files": {
        "pdf": "https://archive.orkl.eu/de2b3d4d0ba286f5daf682578931e0c040a61d84.pdf",
        "text": "https://archive.orkl.eu/de2b3d4d0ba286f5daf682578931e0c040a61d84.txt",
        "img": "https://archive.orkl.eu/de2b3d4d0ba286f5daf682578931e0c040a61d84.jpg"
    }
}