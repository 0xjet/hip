{
    "id": "f7fefbc6-1556-4144-a180-4683f602c7a3",
    "created_at": "2023-01-12T14:59:00.7401Z",
    "updated_at": "2025-03-27T02:10:04.369531Z",
    "deleted_at": null,
    "sha1_hash": "6ae513554c8ca19dba8c775346a1098c58e88d3e",
    "title": "2022-04-12 - Enemybot- A Look into Keksec's Latest DDoS Botnet",
    "authors": "",
    "file_creation_date": "2022-05-28T19:03:04Z",
    "file_modification_date": "2022-05-28T19:03:04Z",
    "file_size": 296550,
    "plain_text": "# Enemybot: A Look into Keksec's Latest DDoS Botnet\n\n**[fortinet.com/blog/threat-research/enemybot-a-look-into-keksecs-latest-ddos-botnet](https://www.fortinet.com/blog/threat-research/enemybot-a-look-into-keksecs-latest-ddos-botnet)**\n\nApril 12, 2022\n\nIn mid-March, [FortiGuard Labs observed a new DDoS botnet calling itself “Enemybot” and](https://www.fortinet.com/fortiguard/labs?utm_source=blog&utm_campaign=fortiguardlabs)\nattributing itself to Keksec, a threat group that specializes in cryptomining and DDoS attacks.\n\nThis botnet is mainly derived from Gafgyt’s source code but has been observed to borrow\nseveral modules from Mirai’s original source code.\n\nIt uses several methods of obfuscation for its strings to hinder analysis and hide itself from\nother botnets. Furthermore, it connects to a command-and-control (C2) server that is hidden\nin the Tor network, making its takedown more complicated.\n\nEnemybot has been seen targeting routers from Seowon Intech, D-Link, and exploits a\nrecently reported iRZ router vulnerability to infect more devices.\n\nThis blog details how this malware leverages these vulnerabilities and the commands it can\nexecute once inside an infected device\n\n\n-----\n\n**Affected Platforms: Linux**\n**Impacted Users: Any organization**\n**Impact: Remote attackers gain control of the vulnerable systems**\n**Severity Level: Critical**\n\n## Enemybot by Keksec\n\nOne of the first things Enemybot does is to drop a file in /tmp/.pwned, containing a message\nthat attributes itself to Keksec. In earlier samples, this message was stored as cleartext. Only\na few days after, a new sample was released with the message encoded with an XOR\noperation using a multiple-byte key. This suggests that this malware is being actively\ndeveloped.\n\nA sample,\nSHA256: fec09b614d67e8933e2c09671e042ce74b40048b5f0feed49ba81a2c18d4f473,\ncaptured on March 24, 2022 has the message in cleartext:\n\n_“ENEMEYBOT V3.1-ALCAPONE_ _hail KEKSEC”_\n\nA sample from March 28, 2022 SHA256:\n93706966361922b493d816fa6ee1347c90de49b6d59fc01c033abdd6549ac8b9, encoded the\nmessage with an XOR operation using a multi-byte key.\n\nUpon decoding, the message has also been changed to:\n\n_“ENEMEYBOT V3.1-ALCAPONE - hail KEKSEC, ALSO U GOT haCkED MY [REDACTED]_\n_(Your device literally has the security of a [shitty device] / [smart doorbell])”_\n\nFigure 1: Code snippet from decoding .pwned message\n\nSubsequently, FortiGuard Labs researchers discovered newer samples that reverted to the\ncleartext versions of the /tmp/.pwned message, which might suggest the possibility of\nmultiple developers working with different versions of the codebase or having different\nprogramming habits.\n\nKeksec is known for operating multiple botnets, some of which are based on Gafgyt (a.k.a.\nBashlite). Gafgyt is a DDoS botnet whose source code was leaked way back in 2015.\n\nIn the case of Enemybot, although it is mainly based on Gafgyt, it was observed that some of\nits modules are clearly borrowed from Mirai’s source code. One of these is Enemybot’s\nscanner module as shown in the screenshots below.\n\nFigure 2: Obvious code similarities between Mirai and Enemybot’s scanner modules\n\n\n-----\n\nAnother module shared with Mirai is the bot killer module where it searches for any running\nprocesses started from certain file paths or with specific keywords in its process memory. It\nthen terminates these processes. Enemybot enhances the original Mirai code with over sixty\nkeywords to identify and kill off any competitors running on the same devices.\n\nWhile researching this botnet, FortiGuard Labs observed that Enemybot shares several\n[similarities with Gafgyt_tor previously reported by other researchers, and assessed that](https://blog.netlab.360.com/gafgtyt_tor-and-necro-are-on-the-move-again/)\nEnemybot is likely an updated and “rebranded” variant of Gafgyt_tor.\n\n## Technical Details\n\n_Infects Multiple Architectures_\n\nLike most botnets, this malware infects multiple architectures to increase its chances of\ninfecting more devices. In addition to IoT devices, Enemybot also targets desktop/server\narchitectures such as BSD, including Darwin (macOS), and x64.\n\nEnemybot targets the following architectures:\n\narm\narm5\narm64\narm7\nbsd\ndarwin\ni586\ni686\nm68k\nmips\nmpsl\nppc\nppc-440fp\nsh4\nspc\nx64\nx86\n\nEnemybot’s download server was previously misconfigured and displayed a list of ELF\nbinaries for different architectures (Figure 3). Threat actors have fixed this at the time of\nwriting.\n\nFigure 3: Open directory of Enemybot’s download server\n\n_Obfuscation_\n\n\n-----\n\nEnemybot obfuscates strings in a variety of ways:\n\nC2 domain uses XOR encoding with a multi-byte key\nCredentials for SSH brute-forcing and bot killer keywords use Mirai-style\nencoding, i.e., single byte XOR encoding with 0x22\nCommands are encrypted with a substitution cipher, i.e,, swapping one character\nfor another\nSome strings are encoded by just adding three to the numeric value of each\ncharacter\n\nWhile these obfuscation techniques are simplistic, they are sufficient to hide tell-tale\nindicators of its presence from casual analysis and other botnets. Most IoT botnets including\nEnemybot are known for searching for such indicators to terminate other botnets running on\nthe same device.\n\n_Infecting More Devices_\n\nIn terms of spreading, Enemybot uses several methods that have also been observed in\nother IoT botnet campaigns.\n\nOne way is using a list of hardcoded username/password combinations to login into devices\nconfigured with weak or default credentials. This is another module that was copied from\nMirai’s source code.\n\nThis malware also tries to run shell commands to infect misconfigured Android devices that\nexpose Android Debug Bridge port (5555).\n\nThe last method is to target devices with specific vulnerabilities as listed below:\n\n[CVE-2020-17456 is a vulnerability that targets SEOWON INTECH SLC-130 and SLR-](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-17456)\n120S routers. Malicious commands can be injected into the pingIPAddr parameter\n(Figure 4)\n\nFigure 4: CVE-2020-17456 exploit request\n\nAnother vulnerability (no CVE assigned) targets the Seowon SLC-130 router. This is\nsimilar to the previous exploit, only this time the command could be injected in the\nvulnerable queriesCnt parameter. The implementation was likely based on publicly\navailable exploit code.\n\nFigure 5: Another exploit targeting Seowon SLC-130 router\n\n\n-----\n\n[CVE-2018-10823 is an older D-Link router vulnerability that allows an authenticated](https://nvd.nist.gov/vuln/detail/CVE-2018-10823)\nuser to execute a malicious command into the Sip parameter of the chkisg.htm page\n(Figure 6). The following devices are affected by this vulnerability.\n\nDWR-116 through 1.06\nDWR-512 through 2.02\nDWR-712 through 2.02\nDWR-912 through 2.02\nDWR-921 through 2.02\nDWR-111 through 1.01\n\nD-Link provided updated firmware for some of the above-mentioned devices. It’s\nrecommended to check and update these devices if they still have vulnerable versions.\n\nFigure 6: CVE-2018-10823 exploit request\n\n[CVE-2022-27226 is a recent vulnerability on iRZ mobile routers that was exploited by](https://nvd.nist.gov/vuln/detail/CVE-2022-27226)\nEnemybot shortly after it was published on March 19, 2022. In fact, this is the first\nbotnet observed by FortiGuard Labs to target devices from this vendor.\n\nThis vulnerability allows an attacker to execute a command by adding a crontab entry in the\ninfected device via the /api/crontab (Figure 7).\n\nFigure 7: CVE-2022-27226 exploit request\n\nDuring the past few weeks, FortiGuard Labs researchers also observed different samples\nadding and removing exploits. A list of these exploits seen in use by Enemybot for\npropagation are as follows:\n\nCVE-2022-25075 to 25084: Targets TOTOLINK routers, previously exploited by the\n[Beastmode botnet](https://www.fortinet.com/blog/threat-research/totolink-vulnerabilities-beastmode-mirai-campaign)\nCVE-2021-44228/2021-45046: Better known as Log4j, more details are available on\nour [Fortinet PSIRT blog](https://www.fortinet.com/blog/psirt-blogs/apache-log4j-vulnerability)\nCVE-2021-41773/CVE-2021-42013: Targets Apache HTTP servers\nCVE-2018-20062: Targets ThinkPHP CMS\nCVE-2017-18368: Targets Zyxel P660HN routers\nCVE-2016-6277: Targets NETGEAR routers\nCVE-2015-2051: Targets D-Link routers\nCVE-2014-9118: Targets Zhone routers\nNETGEAR DGN1000 exploit (No CVE assigned): Targets NETGEAR routers\n\nThis mix of exploits targeting web servers and applications beyond the usual IoT devices,\ncoupled with the wide range of supported architectures, might be a sign of Keksec testing the\nviability of expanding the botnet beyond low-resource IoT devices for more than just DDoS\nattacks. Based on their previous botnet operations, using them for cryptomining is a big\npossibility\n\n\n-----\n\nAfter a successful exploit, a shell command is executed to download another shell script from\na URL. In most cases, particularly in Mirai-based botnets, this URL is hardcoded. In the case\nof Enemybot however, this URL is dynamically updated by the C2 server via the command\n_LDSERVER. The clear advantage of this method is that when the download server is down_\nfor whatever reason, the botnet operators can just update the bot clients with a new URL.\n\nThe shell script update.sh then downloads the actual Enemybot binaries compiled for every\narchitecture it targets and executes them.\n\nFigure 8: Code snippet from update.sh\n\n_Commands and DDoS capabilities_\n\nOnce the bot gets installed on a victim’s device, it connects to its C2 server and waits for\nfurther commands. The C2 server hides in the Tor network and the bot tries to access the\nserverusing a hardcoded list of SOCKS proxy IPs.\n\nThis bot supports several commands listed in the following table.\n\n## Conclusion\n\nBased on the analysis of FortiGuard Labs, Enemybot is Keksec’s latest tool for performing\nDDoS attacks.\n\nTo protect itself, it uses simple obfuscation techniques on its strings as well as hosting its C2\nserver in the Tor network, taking advantage of the network’s anonymity. It uses several\ntechniques commonly found in other DDoS botnet malware to infect other devices.\n\nSeeing how this malware has undergone changes during the research for this article, we\nexpect that more updated versions will be distributed in the wild soon.\n\nFortiGuard Labs will keep monitoring this botnet.\n\n## Fortinet Protections\n\nFortinet customers are protected by the following:\n\nThe FortiGuard Antivirus service detects and blocks this threat as ELF/Gafgyt,\nLinux/Gafgyt, and Linux/Mirai\n\n\n-----\n\nFortiGuard Labs provides IPS signatures against attacks exploiting the following\nvulnerabilities:\n\nCVE-2022-27226 [iRZ.Mobile.Router.API.crontab.AUTH.Remote.Code.Execution](https://www.fortiguard.com/encyclopedia/ips/51342)\n[CVE-2021-44228/2021-45046 - Apache.Log4j.Error.Log.Remote.Code.Execution](https://www.fortiguard.com/encyclopedia/ips/51006)\n[CVE-2021-41773/CVE-2021-42013 - Apache.HTTP.Server.cgi-bin.Path.Traversal](https://www.fortiguard.com/encyclopedia/ips/50825)\n[CVE-2020-17456 - Seowon.Intech.Routers.system_log.CGI.Command.Injection](https://www.fortiguard.com/encyclopedia/ips/49451)\nSeowon SLC-130Vulnerability RCE (vulnerable “queriesCnt” parameter) Seowon.Intech.Routers.Unauthenticated.Remote.Code.Execution\n[CVE-2018-20062 - ThinkPHP.Controller.Parameter.Remote.Code.Execution](https://www.fortiguard.com/encyclopedia/ips/47291)\n[CVE-2018-10823 - D-Link.DWR.CVE-2018-10823.Remote.Code.Execution](https://www.fortiguard.com/encyclopedia/ips/51354)\nCVE-2017-18368 [TrueOnline.ZyXEL.P660HN.V1.Unauthenticated.Command.Injection](https://www.fortiguard.com/encyclopedia/ips/43619)\n[CVE-2016-6277 - NETGEAR.WebServer.Module.Command.Injection](https://www.fortiguard.com/encyclopedia/ips/43532)\nCVE-2015-2051 - D-Link.Devices.HNAP.SOAPActionHeader.Command.Execution\nNetgear DGN1000 exploit (No CVE) [NETGEAR.DGN1000.CGI.Unauthenticated.Remote.Code.Execution](https://www.fortiguard.com/encyclopedia/ips/44738)\nThe FortiGuard Web Filtering Service blocks downloaded URLs.\n\n[FortiGuard IP Reputation & Anti-Botnet Security Service proactively blocks these attacks by](https://www.fortinet.com/support/support-services/fortiguard-security-subscriptions/ipreputation-antibot)\naggregating malicious source IP data from the Fortinet distributed network of threat sensors,\nCERTs, MITRE, cooperative competitors, and other global sources that collaborate to\nprovide up-to-date threat intelligence about hostile sources.\n\n[FortiGuard Application Control Service provides organizations the capability to monitor or](https://www.fortinet.com/support/support-services/fortiguard-security-subscriptions/application-control)\nblock access to malicious, risky, or unwanted applications. Customers without specific\n[business requirements for Tor can refer to these Fortinet Technical Tips for blocking inbound](https://community.fortinet.com/t5/FortiGate/Technical-Tip-How-to-block-traffic-coming-from-TOR-exit-nodes/ta-p/190958)\n[and outbound Tor traffic using the Application Control Service.](https://community.fortinet.com/t5/FortiGate/Technical-Tip-Blocking-and-monitoring-Tor-traffic/ta-p/196239)\n\n## IOCs\n\n_Files_\n\n5260b9a859d936c5b8e0dd81c0238de136d1159e41f0b148f86e2555cf4a4e38\n\nDownload\nURLsb025a17de0ba05e3821444da8f8fc3d529707d6b311102db90d9f04c11577573\n\nbf2f2eb08489552d46b8f50fb07073433f4af94e1215865c48d45f795f96342f\n\nadb51a8d112590a6fdd02ac8d812b837bbe0fcdd762dba6bbba0bd0b538f9aef\n\n373b43345a7e4a6b1d5a6d568a8f6a38906760ea761eacd51a11c164393e4bad\n\nb56655c3c9eed7cd4bce98eeebdcead8daa75a33498ad4f287c753ecc9554aca\n\ncebd50b3a72a314c935b426c0e6b30ec08e0e0cb53e474efffb66f0907309243\n\n73e929575afc04758a23c027ebe4f60ab5c4ba0ab7fa8756b27ed71548302009\n\n\n-----\n\n33d282c6bccf608d4fbf3a211879759019741c1b822c6cea56c6f479be598367\n80f264d7b45a52bd000165f3f3b0fdc0e405f3f128a60a9ec6f085bfba114971\n9acf649b74f4aae43a2db90b8d39a7cd39bf6b82c995da7a1ffa6f23c3549b14\na7213ae906a008ad06020436db120a14568c41eae4335d6c76f2bbc33ee9fbcc\n2ea62957b9dd8e95052d64a48626c0fa137f0fa9ca4fa53f7f1d8fe35aa38dc0\n2ec8016e5fb8375d0cc66bc81f21c2d3f22b785eb4f8e2a02b0b5254159696f5\n06f9083e8109685aecb2c35441932d757184f7749096c9e23aa7d8b7a6c080f8\nfec09b614d67e8933e2c09671e042ce74b40048b5f0feed49ba81a2c18d4f473\nc01156693d1d75481dc96265b41e661301102f3da4edae89338ee9c64dc57d32\n820703b9a28d4b46692b7bf61431dc81186a970c243182740d623817910051d1\n9790f79da34a70e7fb2e07896a5ada662978473457ca5e2701bd1d1df0b9f10f\na799be50ad82e6338c9e0b33d38612e6ad171872407d5d7de36022adf9b8bf63\n4b2b4876ecc7d466eceb30ecbd79001af142b629200bbe61ebd45f4e63cd62ef\nd14df997bdf1e3fd3d18edf771376a666dd791dcac550c7dd8de0323823e1037\n32faf178c5929510234f2d02aea39ca67ab893e18f60c1593f0c043153625e9d\ncc5a743b458bb098998693a73b6a13b9946d375c7c01ac6d37937871d6539102\n980fb4731a70a472699fcbee1a16e76c78c1b36ab6430b94dbe2169f8ac21340\n93706966361922b493d816fa6ee1347c90de49b6d59fc01c033abdd6549ac8b9\nf805f22f668bd0414497ddc061e021c5b80b80c9702053d72fc809f19307073b\n2e6305521d4ac770fc661658da6736d658eef384a9aa68bc49613d2be2d23a0d\ne8c9452581830668941b3dca59896d339eb65cd8f21875b0e36261e5c093f7fe\n\n_Download URLs_\n\nhttp://198[.]12[.]116[.]254/folder/dnsamp.txt\nhttp://198[.]12[.]116[.]254/folder/enemybotarm\nhttp://198[.]12[.]116[.]254/folder/enemybotarm5\nhttp://198[.]12[.]116[.]254/folder/enemybotarm64\nhttp://198[.]12[.]116[.]254/folder/enemybotarm7\nhttp://198[.]12[.]116[.]254/folder/enemybotbsd\nhttp://198[.]12[.]116[.]254/folder/enemybotdarwin\nhttp://198[.]12[.]116[.]254/folder/enemyboti586\nhttp://198[.]12[.]116[.]254/folder/enemyboti686\nhttp://198[.]12[.]116[.]254/folder/enemybotm68k\nhttp://198[.]12[.]116[.]254/folder/enemybotmips\nhttp://198[.]12[.]116[.]254/folder/enemybotmpsl\nhttp://198[.]12[.]116[.]254/folder/enemybotppc\nhttp://198[.]12[.]116[.]254/folder/enemybotppc-440fp\nhttp://198[.]12[.]116[.]254/folder/enemybotsh4\nhttp://198[.]12[.]116[.]254/folder/enemybotspc\nhttp://198[.]12[.]116[.]254/folder/enemybotx64\n\n\n-----\n\nhttp://198[.]12[.]116[.]254/folder/enemybotx86\nhttp://198[.]12[.]116[.]254/folder/enemybotx64\nhttp://198[.]12[.]116[.]254/update.sh\n\n_C2_\n\nxfrvkmokgfb2pajafphw3upl6gq2uurde7de7iexw4aajvslnsmev5id[.]onion (Tor network)\n\n_Learn more about Fortinet’s_ _[FortiGuard Labs threat research and intelligence organization](https://www.fortinet.com/fortiguard/labs?utm_source=blog&utm_campaign=fortiguard-labs)_\n_[and the FortiGuard Security Subscriptions and Services portfolio.](https://www.fortinet.com/fortiguard/labs?tab=security-bundles&utm_source=blog&utm_campaign=security-bundles)_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-04-12 - Enemybot- A Look into Keksec's Latest DDoS Botnet.pdf"
    ],
    "report_names": [
        "2022-04-12 - Enemybot- A Look into Keksec's Latest DDoS Botnet.pdf"
    ],
    "threat_actors": [
        {
            "id": "5a270f6c-2c13-4abf-861e-7d44dcfa5ceb",
            "created_at": "2023-11-03T02:00:07.794425Z",
            "updated_at": "2025-03-27T02:00:03.146871Z",
            "deleted_at": null,
            "main_name": "Keksec",
            "aliases": [],
            "source_name": "MISPGALAXY:Keksec",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535540,
    "ts_updated_at": 1743041404,
    "ts_creation_date": 1653764584,
    "ts_modification_date": 1653764584,
    "files": {
        "pdf": "https://archive.orkl.eu/6ae513554c8ca19dba8c775346a1098c58e88d3e.pdf",
        "text": "https://archive.orkl.eu/6ae513554c8ca19dba8c775346a1098c58e88d3e.txt",
        "img": "https://archive.orkl.eu/6ae513554c8ca19dba8c775346a1098c58e88d3e.jpg"
    }
}