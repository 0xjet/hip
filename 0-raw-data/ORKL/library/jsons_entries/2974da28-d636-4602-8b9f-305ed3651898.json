{
    "id": "2974da28-d636-4602-8b9f-305ed3651898",
    "created_at": "2023-01-12T15:02:50.787733Z",
    "updated_at": "2025-03-27T02:16:28.839252Z",
    "deleted_at": null,
    "sha1_hash": "96046878c8cd896a0e9a716150f5fb0ffe9545cb",
    "title": "2021-02-24 - Overview of Ocean Lotus Samples used to target Vietnamese Human Rights Defenders",
    "authors": "",
    "file_creation_date": "2022-05-28T03:20:50Z",
    "file_modification_date": "2022-05-28T03:20:50Z",
    "file_size": 396198,
    "plain_text": "# Overview of Ocean Lotus Samples used to target Vietnamese Human Rights Defenders\n\n**[github.com/AmnestyTech/investigations/tree/master/2021-02-24_vietnam](https://github.com/AmnestyTech/investigations/tree/master/2021-02-24_vietnam)**\n\nAmnestyTech\n\nFrom May to November 2020, we have identified malware attacks targeting Human\nRights Defenders and organizations from Viet Nam. This technical blog post provides\nan overview of the different Ocean Lotus samples identified, technical indicators, and\ndetails on the link with earlier Ocean Lotus activities. For more information on the\ncontext of these attacks and the targets we identified, please read the report entitled\n[“Click and Bait: Vietnamese Human Rights Defenders Targeted with Spyware Attacks”](https://www.amnesty.org/en/latest/research/2021/02/click-and-bait-vietnamese-human-rights-defenders-targeted-with-spyware-attacks/)\non the Amnesty website (also available in Vietnamese).\n\nWe found 9 different malware samples in this investigation: 4 for Mac OS, and 5 for\nMicrosoft Windows.\n\n## Mac OS Malware\n\n### First appearance in 2018\n\nThe first Mac OS sample we identified targeted Bui Thanh Hieu in February 2018.\nAttackers delivered a malicious Mac OS application named “PHIẾU GHI DANH THAM\n_DỰ TĨNH HỘI HMDC 2018” attached to an email. This sample belongs to the same_\n[family as the Ocean Lotus samples analysed by Trend Micro in 2018, and they even](https://www.trendmicro.com/en_us/research/18/d/new-macos-backdoor-linked-to-oceanlotus-found.html)\nshare the same string encryption algorithm and key.\n\n\n-----\n\nThe malicious application uses a first stage dropper to bypass Apple GateKeeper,\nthen it installs the final payload either in `/Library/CoreMediaIO/Plug-Ins/FCP-`\n```\nDAL/iOSScreenCapture.plugin/Contents/Resources/screenassistantd, if it is\n\n```\nlaunched with root access, otherwise in `~/Library/Spelling/spellagentd . The`\nmalware gains persistence with a Property List file placed in\n```\n~/Library/LaunchAgents/ .\n\n```\nThe final payload communicates with the same domains mentioned in the Trend Micro\nreport: `ssl.arkouthrie.com,` `s3.hiahornber.com and` `widget.shoreoa.com .`\n\n### New variants from 2019\n\nIn 2019 Bui Thanh Hieu received three more malicious emails with links to or attached\nmalicious Mac OS applications, which are more recent variants of the same malware\nwe described above. However, these variants seem less developed than the samples\n[analysed by Trend Micro in November 2020, making them likely intermediate versions](https://www.trendmicro.com/en_us/research/20/k/new-macos-backdoor-connected-to-oceanlotus-surfaces.html)\nbetween those discovered by Trend Micro in 2018 and in 2020.\n\nWhen executed, these applications launch an installer either embedded in the\npackage or decrypted by a dedicated Python script. The installer disables security\nprotections by removing the com.apple.quarantine bit, launches the final payload and\nconfigures persistence by creating a property list in the LaunchAgent user folder, or in\nthe /Library/LaunchDaemons/ folder if launched as root.\n\n\n-----\n\nThe installer drops two files in the destination folder: one Mach-O binary payload and\nan encrypted shared Mach-O library named `[INTEGER].3gp (such as 33.3gp or`\n152.3gp). To avoid their discovery during forensic analysis, these files’ creation date\nand time are faked with the command `touch –t .`\n\nThe payload first gathers information on the system, including the MacOS version, the\nkernel version and details on the hardware and CPU. Then it tries to decrypt all the\nfiles in the folder until it finds a shared library exporting the functions\n```\nArchaeologistCodeine and PlayerAberadurtheIncomprehensible . This shared\n\n```\nlibrary implements the communication with one of three configured Command &\nControl (C&C) domains, using libcurl to send POST HTTP requests with an encrypted\nbody.\n\nThis malware uses custom base64 and AES algorithms to obfuscate all the strings,\nmaking it harder to analyse or build signatures as the encryption keys are changing\nregularly. In comparison, the 2018 variant used a custom base64 but standard AES,\nwhile more recent samples analysed by Trend Micro in 2020 abandoned AES in\nfavour of a custom byte manipulation algorithm.\n\n\n-----\n\nThis backdoor has limited purpose. It allows to manipulate files and execute\ncommands in a terminal. For the full list of supported commands, check Trend Micro’s\nreport.\n\n## Windows Backdoors\n\nWe identified five emails in 2019 and 2020 each containing two files compressed in\nRAR or ISO archives. The first file is a legitimate copy of Microsoft Word 2007’s\nexecutable used for DLL side-loading, while the second is a DLL named wwlib.dll\nloaded at launch by the Word executable it accompanies.\n\n[DLL side-loading is a technique observed several times used by Ocean Lotus,](https://unit42.paloaltonetworks.com/tracking-oceanlotus-new-downloader-kerrdown/)\ntypically with a Microsoft Word executable. The final payload is always a variant of a\n[downloader used exclusively by Ocean Lotus and named Kerrdown by the](https://unit42.paloaltonetworks.com/tracking-oceanlotus-new-downloader-kerrdown/)\ncybersecurity company Palo Alto. All the Kerrdown samples we analysed delivered a\nCobalt Strike payload.\n\n### Kerrdown analysis\n\nKerrdown is a dropper that uses several layers of shellcode to obfuscate the final\npayload. Each one of them decrypting and redirecting to the next layer, until the final\npayload is reached.\n\nFor instance, the first Kerrdown sample we found in May 2019 used 4 distinct stages\nbefore executing the final shellcode that downloads a payload from\n```\napi.ciscofreak.com/HjRX (the domain was down during our investigation, but this\n\n```\nCobalt Strike beacon uploaded on Virus Total in 2019 communicates with this domain)\n\n\n-----\n\nThese layers of shellcode are different for each Kerrdown sample we discovered,\nmaking it challenging to build signatures for this malware family.\n\nOne of the samples which targeted the Vietnamese blogger in July 2020 introduced an\nadditional step in the execution. The wwwlib.dll payload installs a binary in\n```\nC:\\ProgramData\\Java\\UK.exe, a self-extractable RAR archive containing a\n\n```\nlegitimate executable copy of the Opera browser, then used to sideload a malicious\nDLL called opera.dll.\n\nThis opera.dll is another variant of the Kerrdown family, but the file itself is\n[exceptionally large (42MB). Expanding payloads with junk data is a technique, called](https://attack.mitre.org/techniques/T1027/001/)\n“binary padding”, often used by malware to avoid detection by security solutions as\nsome do not analyse large files in depth to avoid performance issues. Binary padding\n[is known to have been used by Ocean Lotus in the past. This Kerrdown sample](https://www.welivesecurity.com/2019/03/20/fake-or-fake-keeping-up-with-oceanlotus-decoys/)\nincludes an obfuscated Cobalt Strike beacon communicating with the domain\n```\ndelicalo.dnsalias.net .\n\n```\n\n-----\n\n### Cobalt Strike\n\nCobalt Strike is an intrusion toolkit sold by the US company [Strategic Cyber LLC]\n(Strategic Cyber LLC) for penetration testing or adversary simulation. Over the past\nyears, cracked versions of Cobalt Strike have been regularly used by attack groups in\n[their operations. Cobalt Strike allows to remotely monitor a compromised system,](https://www.cobaltstrike.com/features)\nincluding accessing files but also logging keystrokes or taking screenshots.\n\n[Ocean Lotus has been known for using Cobalt Strike since at least 2017. The 4](https://www.cybereason.com/blog/operation-cobalt-kitty-apt)\nKerrdown samples we identified all either embedded or downloaded a Cobalt Strike\nbeacon. They all used a Cobalt Strike profile impersonating Google Safe Browsing\n[services URLs, similar to this public profile.](https://github.com/rsmudge/Malleable-C2-Profiles/blob/master/normal/safebrowsing.profile)\n\nThe configuration can be easily extracted with the scripts we released in September\n2020. Here is an example of configuration for a beacon hosted on\n```\ndelicalo.dnsalias.net :\n\n```\n\n-----\n\n```\ndns              False\nssl              True\nport              443\n.sleeptime           4100\n.http-get.server.output\n.jitter            12\n.maxdns            245\npublickey           \n30819f300d06092a864886f70d010101050003818d0030818902818100ac50b035fd1b294778b8cb\n.http-get.uri         \ndelicalo.dnsalias[.]net,/safebrowsing/rd/e3Iz4FnySnhy3IuXKqrWM40JnseSLDHcHOzVVfWmVgwx\n.user-agent          Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36\n(KHTML, like Gecko) Chrome/55.0.2883.87 Safari/537.36\n.http-post.uri        \n/safebrowsing/rd/3KHLhJGZRq4iyImdpSZ5RM90vLo3Yt2hB\n.http-get.client\nGAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflaPREF=ID=Cookie\n.http-post.client\nGAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflatU=NoncmvrScxBxlwoPREF=ID=Cookie\n.post-ex.spawnto_x86      %windir%\\syswow64\\rundll32.exe\n.post-ex.spawnto_x64      %windir%\\sysnative\\rundll32.exe\n.pipename\n.cryptoscheme         1\n.dns_idle           0\n.dns_sleep           0\n.http-get.verb         GET\n.http-post.verb        POST\nshouldChunkPosts        0\n.watermark           0\n.stage.cleanup         0\nCFGCaution           0\n.proxy_type          2\nkilldate            0\ntext_section          0\nprocess-inject-start-rwx    64\nprocess-inject-use-rwx     64\nprocess-inject-min_alloc    0\nprocess-inject-transform-x86\nprocess-inject-transform-x64\n\n## Indicators of Compromise\n\n### Mac OS samples\n\n```\n**Feb 2018**\n\n\nPackage\nname\n\n\nPHIẾU GHI DANH THAM DỰ TĨNH HỘI HMDC 2018\n\n\nDropper 952c16674bde3c16aa3935b3e01f3f0fb4cbac7ffa130143cbf6ccaa72733068\n\n\n-----\n\n**Feb 2018**\n\nPayload d3a198e18f8c5e9ed54ed4959b471a0f15fbda7d4abf92b7726bc07723e46dd5\n\nC&C `ssl.arkouthrie.com` `widget.shoreoa.com` `s3.hiahornber.com`\n\n**June 2019**\n\n\nPackage\nname\n\n\nTaiLieu\n\n\nDropper ecb6186a5e722fa360ece37191589305858a0e176321c9339831f2884dcb0405\n\nPayload 1599fe6cc77764c17802cfde1ca77f091bb3ec2a49f6cab1c80ee667ea7c752b\n\n\nNetwork\nlibrary\n\n\nb8567ce4d0595e6466414999798bcb1dfe01cc5ca1dd058bfc55f92033f0f3d8\n\n\nC&C `tips.jasperpfeiffer.com` `land.rellecharlessper.com and`\n```\n       art.guillermoespana.com\n\n```\n**October**\n**2019**\n\n\nPackage\nName\n\n\nDanh sach nhan su\n\n\nDropper b252a8d2ec5c7080286fe3f0ad193062f506b5c34c4c797f97717e396c0a22d5\n\nPayload 9c14cffd79f863fec0a6c0ed337ea82a9044db09afda53b8ac2aef1d49f74f4f\n\n\nNetwork\nLibrary\n\n\n5ed6b7b450ead2d0e69faa3069d1e0bd3a6852909092235f75087da0ca05462f\n\n\nC&C `tips.jasperpfeiffer.com` `land.rellecharlessper.com and`\n```\n       art.guillermoespana.com\n\n```\n**December**\n**2019**\n\n\nPackage\nName\n\n\nDon keu cuu cua gia dinh Le Nam Tra\n\n\nDropper a890c88b6c64371242b4047830b9189b4546536c6b11576d0738f0ba1840ade\n\nPayload 0c41358adeea24d80b35bac4b4f60d93711e32e287343cb604e1fa79b5e5e465\n\n\nNetwork\nLibrary\n\n\n5ed6b7b450ead2d0e69faa3069d1e0bd3a6852909092235f75087da0ca05462f\n\n\nC&C `tips.jasperpfeiffer.com` `land.rellecharlessper.com and`\n```\n        art.guillermoespana.com\n\n### Windows Samples\n\n```\n\n-----\n\n**June 2019June 2019**\n\nWinword.exe\n(legitimate)\n\n\n6c959cfb001fbb900958441dfd8b262fb33e052342948bab338775d3e83ef7f7\n\n\nwwlib.dll 148e647885712b69258967c5f8798966fb9b8ae24847dda8aeb880cb6f56b6da\n\nC&C `api.ciscofreak.com`\n\n**April 2020**\n\n\nWinword.exe\n(legitimate)\n\n\n6c959cfb001fbb900958441dfd8b262fb33e052342948bab338775d3e83ef7f7\n\n\nwwlib.dll acb33adf7429424170f63fa5490ed580cf502de4a7ef00e4b8c962425cd85052\n\nC&C `node.podzone.org`\n\n**July 2020**\n\n\nWinword.exe\n(legitimate)\n\n\n6c959cfb001fbb900958441dfd8b262fb33e052342948bab338775d3e83ef7f7\n\n\nwwlib.dll 5cc8d52fcabfd35042336e095f1f78c2b2884e7826358f5385729cf45ce4d860\n\n\nOpera.exe\n(legitimate)\n\n\n71c3b9538a0f14a8ab67e579ecc4ce2b01e25507d8c07eaf46555e8f44181e37\n\n\nOpera.dll a51fb048e5a2730bffd0fd43e3bdda4e931c9358254aff960ddf43526c768120\n\nC&C `delicalo.dnsalias.net`\n\n**November**\n**2020 (2**\n**emails)**\n\n\nWinword.exe\n(legitimate)\n\n\n6c959cfb001fbb900958441dfd8b262fb33e052342948bab338775d3e83ef7f7\n\n\nwwlib.dll a574720e7b4f420098a0ac0055089000435439eb61ec6de2077ac0f782a506e9\n\nC&C `coco.cechire.com`\n\n[You can find the full list of indicators of compromise here.](https://github.com/AmnestyTech/investigations/tree/master/2021-02-24_vietnam/indicators)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-02-24 - Overview of Ocean Lotus Samples used to target Vietnamese Human Rights Defenders.pdf"
    ],
    "report_names": [
        "2021-02-24 - Overview of Ocean Lotus Samples used to target Vietnamese Human Rights Defenders.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "870f6f62-84f5-48ca-a18e-cf2902cd6924",
            "created_at": "2022-10-25T15:50:23.303818Z",
            "updated_at": "2025-03-27T02:00:55.435309Z",
            "deleted_at": null,
            "main_name": "APT32",
            "aliases": [
                "APT32",
                "SeaLotus",
                "OceanLotus",
                "APT-C-00",
                "Canvas Cyclone"
            ],
            "source_name": "MITRE:APT32",
            "tools": [
                "Mimikatz",
                "ipconfig",
                "Kerrdown",
                "Cobalt Strike",
                "SOUNDBITE",
                "OSX_OCEANLOTUS.D",
                "KOMPROGO",
                "netsh",
                "RotaJakiro",
                "PHOREAL",
                "Arp",
                "Denis",
                "Goopy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "af509bbb-8d18-4903-a9bd-9e94099c6b30",
            "created_at": "2023-01-06T13:46:38.585525Z",
            "updated_at": "2025-03-27T02:00:02.866727Z",
            "deleted_at": null,
            "main_name": "APT32",
            "aliases": [
                "TIN WOODLAWN",
                "OceanLotus Group",
                "OceanLotus",
                "Sea Lotus",
                "G0050",
                "Cobalt Kitty",
                "SeaLotus",
                "ATK17",
                "Ocean Lotus",
                "Ocean Buffalo",
                "POND LOACH",
                "Canvas Cyclone",
                "APT-C-00",
                "APT-32",
                "APT 32"
            ],
            "source_name": "MISPGALAXY:APT32",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f1518ac1-4710-4dd1-a422-e3801e4806cb",
            "created_at": "2024-05-01T02:03:08.147856Z",
            "updated_at": "2025-03-27T02:05:17.421275Z",
            "deleted_at": null,
            "main_name": "TIN WOODLAWN",
            "aliases": [
                "Cobalt Kitty",
                "OceanLotus",
                "WOODLAWN ",
                "APT32 "
            ],
            "source_name": "Secureworks:TIN WOODLAWN",
            "tools": [
                " Denis",
                " Goopy",
                " JEShell",
                " KerrDown",
                " Mimikatz",
                " Ratsnif",
                " Remy",
                " Rizzo",
                " RolandRAT",
                "Cobalt Strike"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2439ad53-39cc-4fff-8fdf-4028d65803c0",
            "created_at": "2022-10-25T16:07:23.353204Z",
            "updated_at": "2025-03-27T02:02:09.749502Z",
            "deleted_at": null,
            "main_name": "APT 32",
            "aliases": [
                "APT 32",
                "APT-C-00",
                "APT-LY-100",
                "ATK 17",
                "Lotus Bane",
                "Ocean Buffalo",
                "OceanLotus",
                "Operation Cobalt Kitty",
                "Operation PhantomLance",
                "Pond Loach",
                "SeaLotus",
                "SectorF01",
                "Tin Woodlawn"
            ],
            "source_name": "ETDA:APT 32",
            "tools": [
                "Agentemis",
                "Android.Backdoor.736.origin",
                "AtNow",
                "Backdoor.MacOS.OCEANLOTUS.F",
                "BadCake",
                "CACTUSTORCH",
                "CamCapture Plugin",
                "CinaRAT",
                "Cobalt Strike",
                "CobaltStrike",
                "Cuegoe",
                "DKMC",
                "Denis",
                "Goopy",
                "HiddenLotus",
                "KOMPROGO",
                "KerrDown",
                "METALJACK",
                "MSFvenom",
                "Mimikatz",
                "Nishang",
                "OSX_OCEANLOTUS.D",
                "OceanLotus",
                "PHOREAL",
                "PWNDROID1",
                "PhantomLance",
                "PowerSploit",
                "Quasar RAT",
                "QuasarRAT",
                "RatSnif",
                "Remy",
                "Remy RAT",
                "Rizzo",
                "Roland",
                "Roland RAT",
                "SOUNDBITE",
                "Salgorea",
                "Splinter RAT",
                "Terracotta VPN",
                "Yggdrasil",
                "cobeacon",
                "denesRAT",
                "fingerprintjs2"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535770,
    "ts_updated_at": 1743041788,
    "ts_creation_date": 1653708050,
    "ts_modification_date": 1653708050,
    "files": {
        "pdf": "https://archive.orkl.eu/96046878c8cd896a0e9a716150f5fb0ffe9545cb.pdf",
        "text": "https://archive.orkl.eu/96046878c8cd896a0e9a716150f5fb0ffe9545cb.txt",
        "img": "https://archive.orkl.eu/96046878c8cd896a0e9a716150f5fb0ffe9545cb.jpg"
    }
}