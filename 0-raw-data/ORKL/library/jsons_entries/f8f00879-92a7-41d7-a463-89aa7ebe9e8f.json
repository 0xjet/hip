{
    "id": "f8f00879-92a7-41d7-a463-89aa7ebe9e8f",
    "created_at": "2023-01-12T15:05:33.478095Z",
    "updated_at": "2025-03-27T02:14:02.824212Z",
    "deleted_at": null,
    "sha1_hash": "77fbc6c3f48fdcb4f0376e6e0da425f99ed9b850",
    "title": "2016-03-06 - Network detector for Winnti malware",
    "authors": "",
    "file_creation_date": "2022-05-27T22:25:28Z",
    "file_modification_date": "2022-05-27T22:25:28Z",
    "file_size": 118000,
    "plain_text": "# Network detector for Winnti malware\n\n**github.com/TKCERT/winnti-detector**\n\nTKCERT\n\n_winnti-detector detects Winnti (as of 2016/2017) communication patterns in network traffic._\n\nIt can read PCAPs or listen on a live interface.\n\n## Winnti\n\nWinnti is a malware that is used by some APT groups.\n\nIt has been used since at least 2013 and has evolved over time. You can find some\ninformation here\n\nhttps://kasperskycontenthub.com/wp-content/uploads/sites/43/vlpdfs/winnti-more-thanjust-a-game-130410.pdf\n[https://www.novetta.com/wp-content/uploads/2015/04/novetta_winntianalysis.pdf](https://www.novetta.com/wp-content/uploads/2015/04/novetta_winntianalysis.pdf)\nhttps://hitcon.org/2016/pacific/0composition/pdf/1201/1201%20R2%201610%20winnti\n%20polymorphism.pdf\n\n## Handshake\n\nThe driver component of Winnti (aka \"NdisReroute\") is able to reroute network traffic from\nports that are already occupied by legit applications to the malware's userspace component.\n\n\n-----\n\nThe first packet of a TCP stream signals the driver that the stream shall be rerouted. I call\nsuch a packet a \"Winnti HELO\". It is exactly 16 bytes long and the bytes match the following\nrelation:\n```\nWinnti handshake Example:\n  dw0      dw1      dw2       dw3\n5B 44 B4 91  xx xx xx xx  31 18 30 59  [84 C8] {6A 5C}\n5B 44 B4 91    ==    31 18 30 59 ^ {6A 5C} [84 C8]\n\n```\n**dw0 calculated from dw2 and dw3**\n**dw1 random but not zero. Only seen timestamps in here but any value works.**\n**dw2 random but not zero**\n**dw3 random but not zero**\n\n## Installation\n\nwinnti-detector uses libnids which you can install with\n```\n# git clone https://github.com/MITRECND/libnids.git\n# cd libnids\n# ./configure --enable-shared && make && sudo make install\n# sudo ldconfig -i\n\n```\nYou can then compile and run winnti-detector\n```\n# make\n# ./wntidect\nwntidect version 1.6 using libnids 1.25 -- Stefan Ruester\nUsage: ./wntidect <-i device|-f pcapfile> [-l]\n -l Log to syslog (local7.alert 'nsm')\n\n## Output\n\n stdout\n$ wntidect -f finding.pcap\nwntidect version 1.6 using libnids 1.25 -- Stefan Ruester\n[i] Reading PCAP file eth0_capture.pcap\n[!] 2018-01-23 09:12:50.709193Z Found WINNTI session setup: (TCP) 10.123.12.123:59308\n-> 10.34.34.34:443\n[!] 2018-03-06 00:28:46.525901Z Found WINNTI session setup: (UDP) 10.123.12.123:58762\n-> 10.34.34.35:443\n\n syslog\n\n```\n\n-----\n\nAs the usage text suggests, you can use the parameter `-l to write syslog entries whenever`\na match is found. The program always also outputs findings on stdout.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-03-06 - Network detector for Winnti malware.pdf"
    ],
    "report_names": [
        "2016-03-06 - Network detector for Winnti malware.pdf"
    ],
    "threat_actors": [
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535933,
    "ts_updated_at": 1743041642,
    "ts_creation_date": 1653690328,
    "ts_modification_date": 1653690328,
    "files": {
        "pdf": "https://archive.orkl.eu/77fbc6c3f48fdcb4f0376e6e0da425f99ed9b850.pdf",
        "text": "https://archive.orkl.eu/77fbc6c3f48fdcb4f0376e6e0da425f99ed9b850.txt",
        "img": "https://archive.orkl.eu/77fbc6c3f48fdcb4f0376e6e0da425f99ed9b850.jpg"
    }
}