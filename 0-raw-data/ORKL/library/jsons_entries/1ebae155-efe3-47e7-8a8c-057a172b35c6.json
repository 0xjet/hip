{
    "id": "1ebae155-efe3-47e7-8a8c-057a172b35c6",
    "created_at": "2022-10-25T16:48:11.118585Z",
    "updated_at": "2025-03-27T02:16:53.156156Z",
    "deleted_at": null,
    "sha1_hash": "ebebc6910795eff746182e7b9f1070896f3c14c6",
    "title": "",
    "authors": "",
    "file_creation_date": "2022-09-20T08:22:42Z",
    "file_modification_date": "2022-09-20T08:22:42Z",
    "file_size": 5718519,
    "plain_text": "```\n“Mustang Panda” – Enemy at the gate\n          m4n0w4r\n\n```\n```\n” – Enemy at the gate\n\n```\n\n-----\n\n# _ _\n\n\n-----\n\n# g\n\n##### 1. Asian APT Groups connections 2. Mustang Panda Group 3. Samples have targeted Viet Nam\n\n###### 1. Unknown PlugX variant 2. THOR PlugX variant\n##### 4. Other campaigns relate to events in Europe, invasion of Ukraine.\n\n\n##### events in Europe,\n\n\n-----\n\n### p\n\n_ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/space-pirates-tools-and-connections/_\n\n\n-----\n\n# g p ( )\n\n\n-----\n\n# g p ( )\n\n\n-----\n\n###### Our analysis\n\n#### Samples have targeted Viet\n Nam - Our analysis\n\n\n#### Unknown PlugX variant -Threat hunting -Phân tích log.dll -Phân tích shellcode -Phân tích PlugX Dll\n\n\n-----\n\n# g\n\n###### • Cuối tháng 04/2022, qua hoạt động Threat hunting trên VirusTotal, phát hiện các mẫu được tải lên từViệt Nam.\n • Thời điểm này, nghi ngờ có liên quan tới nhóm Mustang Panda (PlugX).\n\n\n-----\n\n###### 1 2 3\n\n\n-----\n\n# y g\n\n##### • Sample hash: 3171285c4a846368937968bf53bc48ae5c980fe32b0de10cf0226b9122576f4e\n • Được tải lên từ Việt Nam, thời gian 2022-04-25 14:04:36 UTC\n • Tên: log.dll.sc. Ai đó đang xửlý sựcố?\n\n\n-----\n\n# p y\n\n###### • File được biên dịch bằng Visual Studio 2012/2013\n • Thông tin sections cho thấy nó có thểbị packed hoặc code\n bị obfuscated.\n • Tên gốc ljAt.dll. Export 02 hàm LogFree và LogInit.\n\n\n###### packed hoặc code\n\n và LogInit.\n\n\n-----\n\n### g\n\n###### • Hàm LogFree: obfuscated hoàn toàn bằng Obfuscator-LLVM, sử\n dụng kĩ thuật Control Flow Flattening\n • Không thực hiện nhiệm vụgì.\n\n\n-----\n\n### g\n\n\n-----\n\n### g\n\n###### • Hàm LogInit_0: gọi hàm f_read_content_of_log_dat_file_to_buf để đọc nội dung của file log.dat và thực thi shellcode sau giải mã.\n\n\n-----\n\n### g\n\n###### • Hàm f_read_content_of_log_dat_file_to_buf cũng bị obfuscated hoàn toàn.\n\n\n-----\n\n### g\n\n###### • Nhiệm vụcủa f_read_content_of_log_dat_file_to_buf:\n – Gọi hàm GetModuleHandleW: lấy handle của kernel32.dll – Gọi hàm GetProcAddress: lấy địa chỉ của các hàm APIs gồm\n```\n   VirtualAlloc, GetModuleFileNameA, CreateFileA, ReadFile.\n – Đọc nội dung của log.dat vào vùng nhớcấp phát.\n\n```\n\n-----\n\n### g\n\n\n-----\n\n# y\n\n###### • Hunting file log.dat trên VT với phạm vi giới hạn nguồn submit từ Việt\n```\n Nam.\n • Chọn log.dat (2de77804e2bd9b843a826f194389c2605cfc17fd2fafde1b8eb2f819fc6c0c84)được tải lên 2022-04-20 12:33:19 UTC (trước 5 ngày so với file log.dll)\n\n```\n```\n             Việt\n\n###### )được so với file log.dll)\n\n```\n\n-----\n\n# p yp\n\n##### • Debug và dump shellcode đã giải mã:\n\n\n-----\n\n-----\n\n# g\n\n##### • Shellcode thực hiện giải nén ra payload cuối là một Dll.\n • Gọi tới hàm được export của Dll này đểthực thi.\n\n\n-----\n\n# g q\n\n##### • Áp dụng kĩ thuật stackstring, shellcode cấu thành\n tên các hàm APIs\n\n\n-----\n\n# p\n\n###### • Gọi hàm RtlDecompressBuffer đểgiải nén ra payload cuối là\n một Dll.\n\n\n-----\n\n###### • Shellcode thực hiện nhiệm vụcủa loader đểmapping Dll vào\n vùng nhớmới.\n • Gọi tới hàm mà Dll này export đểthực thi nhiệm vụchính\n của mã độc.\n\n\n-----\n\n# p p\n\n##### • Dump file từbộnhớra disk đểphục vụphân tích.\n • File đã bịhủy thông tin header.\n\n\n-----\n\n# y g\n\n##### • Cách PlugX gọi hàm API\n\n\n-----\n\n# y g\n\n##### • Giao tiếp với C2\n\n\n##### Giao tiếp với C2\n\n\n-----\n\n# y g\n\n##### • Nhận lệnh và thực thi\n\n\n-----\n\n# yp g g\n\n##### • Với các mẫu cũ từng phân tích, cấu hình của PlugX\n thường lưu tại section .data với độlớn 0x724 (1828) bytes.\n\n\n-----\n\n# yp g g\n\n##### • Trước bước kiểm tra các tham số truyền vào khi thực thi, mã độc gọi tới hàm thực hiện nhiệm vụ giải mã cấu hình:\n\n\n##### số truyền vào khi\n\n\n-----\n\n# yp g g\n\n###### • Phân tích chi tiết kết hợp debug từshellcode:\n\n – Cấu hình nhúng trong shellcode, bắt đầu từoffset 0x69.\n – Độlớn của cấu hình là 0x150C (5388) bytes.\n – Key giải mã là 0xB4.\n\n\n-----\n\n# yp g g\n\n\n-----\n\n# yp g g\n\n###### • Viết python script đểtrích xuất thông tin cấu hình\n\n\n-----\n\n###### Our analysis\n\n#### Samples have targeted Viet\n Nam - Our\n analysis\n\n\n#### THOR PlugX variant -Phân tích log.dll -Phân tích shellcode -Phân tích PlugX Dll\n\n\n-----\n\n# y g\n\n###### • Đọc nội dung log.dat. Không có bước giải mã shellcode.\n • Shellcode thực thi từoffset 0x24 (offset 0x0 + strlen(random_string)).\n\n\n-----\n\n# y\n\n\n-----\n\n# y\n\n###### • Quá trình thực hiện giải mã ra compressed Dll phức tạp hơn so với mẫu đã phân tích.\n\n\n-----\n\n# y\n\n###### • Gọi tời hàm export của Dll đểthực thi nhiệm vụchính của\n mã độc.\n • Gán signature là THOR.\n\n\n-----\n\n# p p\n\n##### • Dumped Dll có kích thước nhỏ hơn và thời gian compile cũ hơn so với mẫu trước.\n\n\n##### hơn và thời gian\n\n\n-----\n\n## y g\n\n###### • Bước giải mã cấu hình cũng được thực hiện trước khi mã độc\n kiểm tra tham sốtruyền vào khi thực thi.\n\n\n-----\n\n# yp\n\n\n-----\n\n# yp g\n\n\n-----\n\n-----\n\n###### Our analysis\n\n#### Other campaigns relate to events in\n Europe, invasion of Ukraine, …\n\n_https://teampassword.com/blog/who-is-mustang-panda-and-how-can-you-protect-yourself_\n\n\n-----\n\n# p g\n\n\n-----\n\n# p g\n\n\n-----\n\n-----\n\n# p\n\n\n-----\n\n# p\n\n\n-----\n\n# g p y\n\n\n##### execute decrypted\n```\n EnumThreadWindows\n\n```\n\n-----\n\n# g g g\n\n\n-----\n\n# y\n\n\n-----\n\n# yp g\n\n###### • Thông tin cấu hình được lưu tại section .data với độlớn\n```\n 0x45C bytes.\n\n • Sửdụng vòng lặp với lệnh XOR đểgiải mã.\n\n```\n\n-----\n\n# g\n\n\n-----\n\n###### • PlugX: A Talisman to Behold\n • Mustang Panda deploys a new wave of malware targeting Europe\n • THOR: Previously Unseen PlugX Variant Deployed During Microsoft Exchange Server Attacks by PKPLUG Group\n • BRONZE PRESIDENT Targets Russian Speakers with Updated PlugX\n • Mustang Panda’s Hodur: Old tricks, new Korplug variant\n • Advanced persistent threat group feature: Mustang Panda\n • Phân tích mã độc lợi dụng dịch Covid-19 để phát tán giả mạo “Chỉ thị của thủ tướng Nguyễn Xuân Phúc”\n • Nhóm APT Mustang Panda có thểvẫn đang tiếp tục hoạt động tấn công vào các tổchức tại Việt Nam\n\n\n-----\n\n-----\n\n-----",
    "language": "VI",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "4e039bf8-7239-4999-8ec0-eb202d1465af",
            "created_at": "2022-12-04T11:19:36.52593Z",
            "updated_at": "2022-12-04T11:19:36.52593Z",
            "deleted_at": null,
            "name": "ORKL",
            "url": "https://github.com/ORKL/library",
            "description": "ORKL Community Contributed Content",
            "reports": null
        }
    ],
    "references": [
        "https://raw.githubusercontent.com/m4now4r/Presentations/main/MustangPanda%20-%20Enemy%20at%20the%20gate_final.pdf"
    ],
    "report_names": [
        "MustangPanda%20-%20Enemy%20at%20the%20gate_final.pdf"
    ],
    "threat_actors": [
        {
            "id": "93542ae8-73cb-482b-90a3-445a20663f15",
            "created_at": "2022-10-25T16:07:24.058412Z",
            "updated_at": "2025-03-27T02:02:10.093621Z",
            "deleted_at": null,
            "main_name": "PKPLUG",
            "aliases": [
                "Stately Taurus"
            ],
            "source_name": "ETDA:PKPLUG",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "536ca49a-2666-4005-8a50-e552fc7e16ef",
            "created_at": "2023-11-21T02:00:07.375813Z",
            "updated_at": "2025-03-27T02:00:03.245695Z",
            "deleted_at": null,
            "main_name": "Webworm",
            "aliases": [
                "Space Pirates"
            ],
            "source_name": "MISPGALAXY:Webworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "cf7fc640-acfe-41c4-9f3d-5515d53a3ffb",
            "created_at": "2023-01-06T13:46:38.228042Z",
            "updated_at": "2025-03-27T02:00:02.775905Z",
            "deleted_at": null,
            "main_name": "APT1",
            "aliases": [
                "GIF89a",
                "G0006",
                "PLA Unit 61398",
                "Group 3",
                "TG-8223",
                "Comment Group",
                "ShadyRAT",
                "COMMENT PANDA",
                "Comment Crew",
                "Byzantine Candor",
                "Brown Fox"
            ],
            "source_name": "MISPGALAXY:APT1",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2f07a03f-eb1f-47c8-a8e9-a1a00f2ec253",
            "created_at": "2022-10-25T16:07:24.277669Z",
            "updated_at": "2025-03-27T02:02:10.157972Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Operation LagTime IT",
                "Operation StealthyTrident",
                "ThunderCats"
            ],
            "source_name": "ETDA:TA428",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "Albaniiutas",
                "BlueTraveller",
                "Chymine",
                "Cotx RAT",
                "CoughingDown",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "LuckyBack",
                "PhantomNet",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "RoyalRoad",
                "SManager",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TManger",
                "TVT",
                "Thoper",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8e385d36-06a2-4294-b3d3-01fe8e9d95f4",
            "created_at": "2022-10-25T16:07:24.219051Z",
            "updated_at": "2025-03-27T02:02:10.142803Z",
            "deleted_at": null,
            "main_name": "Space Pirates",
            "aliases": [
                "Erudite Mogwai",
                "Webworm"
            ],
            "source_name": "ETDA:Space Pirates",
            "tools": [
                "9002 RAT",
                "Agent.dhwf",
                "AngryRebel",
                "BH_A006",
                "Chymine",
                "Darkmoon",
                "Deed RAT",
                "Destroy RAT",
                "DestroyRAT",
                "Farfli",
                "Gen:Trojan.Heur.PT",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "Homux",
                "Hydraq",
                "Kaba",
                "Korplug",
                "McRAT",
                "MdmBot",
                "Moudour",
                "MyKLoadClient",
                "Mydoor",
                "PCRat",
                "PCShare",
                "POISONPLUG.SHADOW",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "Roarur",
                "SPIVY",
                "ShadowPad Winnti",
                "SnappyBee",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Trochilus RAT",
                "XShellGhost",
                "Xamtrav",
                "Zupdax",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "1691c25f-1aa4-4168-8ce2-7aa8f23246e7",
            "created_at": "2024-06-04T02:03:07.724221Z",
            "updated_at": "2025-03-27T02:05:17.284601Z",
            "deleted_at": null,
            "main_name": "BRONZE PRESIDENT",
            "aliases": [
                "Mustang Panda ",
                "Red Lich ",
                "Temp.Hex ",
                "HoneyMyte "
            ],
            "source_name": "Secureworks:BRONZE PRESIDENT",
            "tools": [
                " Cobalt Strike",
                " ORat",
                " PlugX",
                " RCSession",
                "China Chopper"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b69037ec-2605-4de4-bb32-a20d780a8406",
            "created_at": "2023-01-06T13:46:38.790766Z",
            "updated_at": "2025-03-27T02:00:02.919758Z",
            "deleted_at": null,
            "main_name": "MUSTANG PANDA",
            "aliases": [
                "TEMP.HEX",
                "TA416",
                "TANTALUM",
                "Twill Typhoon",
                "Earth Preta",
                "Stately Taurus",
                "LuminousMoth",
                "Polaris",
                "BRONZE PRESIDENT",
                "HoneyMyte",
                "Red Lich"
            ],
            "source_name": "MISPGALAXY:MUSTANG PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9baa7519-772a-4862-b412-6f0463691b89",
            "created_at": "2022-10-25T15:50:23.354429Z",
            "updated_at": "2025-03-27T02:00:55.45162Z",
            "deleted_at": null,
            "main_name": "Mustang Panda",
            "aliases": [
                "Mustang Panda",
                "TA416",
                "RedDelta",
                "BRONZE PRESIDENT"
            ],
            "source_name": "MITRE:Mustang Panda",
            "tools": [
                "Cobalt Strike",
                "RCSession",
                "NBTscan",
                "PoisonIvy",
                "PlugX"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3aaf0755-5c9b-4612-9f0e-e266ef1bdb4b",
            "created_at": "2022-10-25T16:07:23.480196Z",
            "updated_at": "2025-03-27T02:02:09.826059Z",
            "deleted_at": null,
            "main_name": "Comment Crew",
            "aliases": [
                "APT 1",
                "BrownFox",
                "Byzantine Candor",
                "Byzantine Hades",
                "Comment Crew",
                "Comment Panda",
                "GIF89a",
                "Group 3",
                "Operation Oceansalt",
                "Operation Seasalt",
                "Operation Siesta",
                "Shanghai Group",
                "TG-8223"
            ],
            "source_name": "ETDA:Comment Crew",
            "tools": [
                "Auriga",
                "Cachedump",
                "Chymine",
                "CookieBag",
                "Darkmoon",
                "GDOCUPLOAD",
                "GLOOXMAIL",
                "GREENCAT",
                "Gen:Trojan.Heur.PT",
                "GetMail",
                "Hackfase",
                "Hacksfase",
                "Helauto",
                "Kurton",
                "LETSGO",
                "LIGHTBOLT",
                "LIGHTDART",
                "LOLBAS",
                "LOLBins",
                "LONGRUN",
                "Living off the Land",
                "Lslsass",
                "MAPIget",
                "ManItsMe",
                "Mimikatz",
                "MiniASP",
                "Oceansalt",
                "Pass-The-Hash Toolkit",
                "Poison Ivy",
                "ProcDump",
                "Riodrv",
                "SPIVY",
                "Seasalt",
                "ShadyRAT",
                "StarsyPound",
                "TROJAN.COOKIES",
                "TROJAN.FOXY",
                "TabMsgSQL",
                "Tarsip",
                "Trojan.GTALK",
                "WebC2",
                "WebC2-AdSpace",
                "WebC2-Ausov",
                "WebC2-Bolid",
                "WebC2-Cson",
                "WebC2-DIV",
                "WebC2-GreenCat",
                "WebC2-Head",
                "WebC2-Kt3",
                "WebC2-Qbp",
                "WebC2-Rave",
                "WebC2-Table",
                "WebC2-UGX",
                "WebC2-Yahoo",
                "Wordpress Bruteforcer",
                "bangat",
                "gsecdump",
                "pivy",
                "poisonivy",
                "pwdump",
                "zxdosml"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "2ee03999-5432-4a65-a850-c543b4fefc3d",
            "created_at": "2022-10-25T16:07:23.882813Z",
            "updated_at": "2025-03-27T02:02:10.0116Z",
            "deleted_at": null,
            "main_name": "Mustang Panda",
            "aliases": [
                "Bronze President",
                "Camaro Dragon",
                "Earth Preta",
                "HoneyMyte",
                "Mustang Panda",
                "Operation SMUGX",
                "Operation SmugX",
                "PKPLUG",
                "Red Lich",
                "Stately Taurus",
                "TEMP.Hex"
            ],
            "source_name": "ETDA:Mustang Panda",
            "tools": [
                "9002 RAT",
                "AdFind",
                "Agent.dhwf",
                "Agentemis",
                "CHINACHOPPER",
                "China Chopper",
                "Chymine",
                "ClaimLoader",
                "Cobalt Strike",
                "CobaltStrike",
                "DCSync",
                "DOPLUGS",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Farseer",
                "Gen:Trojan.Heur.PT",
                "HOMEUNIX",
                "Hdump",
                "HenBox",
                "HidraQ",
                "Hodur",
                "Homux",
                "HopperTick",
                "Hydraq",
                "Impacket",
                "Kaba",
                "Korplug",
                "LadonGo",
                "MQsTTang",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "NBTscan",
                "NetSess",
                "Netview",
                "Orat",
                "POISONPLUG.SHADOW",
                "PUBLOAD",
                "PVE Find AD Users",
                "PlugX",
                "Poison Ivy",
                "PowerView",
                "QMAGENT",
                "RCSession",
                "RedDelta",
                "Roarur",
                "SPIVY",
                "ShadowPad Winnti",
                "SinoChopper",
                "Sogu",
                "TIGERPLUG",
                "TONEINS",
                "TONESHELL",
                "TVT",
                "TeamViewer",
                "Thoper",
                "TinyNote",
                "WispRider",
                "WmiExec",
                "XShellGhost",
                "Xamtrav",
                "Zupdax",
                "cobeacon",
                "nbtscan",
                "nmap",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716491,
    "ts_updated_at": 1743041813,
    "ts_creation_date": 1663662162,
    "ts_modification_date": 1663662162,
    "files": {
        "pdf": "https://archive.orkl.eu/ebebc6910795eff746182e7b9f1070896f3c14c6.pdf",
        "text": "https://archive.orkl.eu/ebebc6910795eff746182e7b9f1070896f3c14c6.txt",
        "img": "https://archive.orkl.eu/ebebc6910795eff746182e7b9f1070896f3c14c6.jpg"
    }
}