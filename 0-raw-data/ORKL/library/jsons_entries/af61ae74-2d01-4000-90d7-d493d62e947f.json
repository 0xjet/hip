{
    "id": "af61ae74-2d01-4000-90d7-d493d62e947f",
    "created_at": "2023-01-12T15:06:53.861524Z",
    "updated_at": "2025-03-27T02:09:29.609678Z",
    "deleted_at": null,
    "sha1_hash": "40820518c3c009d40f20429021a842d306117a79",
    "title": "2022-02-22 - IcedID to Cobalt Strike In Under 20 Minutes",
    "authors": "",
    "file_creation_date": "2022-05-29T00:53:19Z",
    "file_modification_date": "2022-05-29T00:53:19Z",
    "file_size": 1584717,
    "plain_text": "# IcedID to Cobalt Strike In Under 20 Minutes\n\n**[esentire.com/blog/icedid-to-cobalt-strike-in-under-20-minutes](https://www.esentire.com/blog/icedid-to-cobalt-strike-in-under-20-minutes)**\n\n[Adversaries don’t work 9-5 and neither do we. At eSentire, our 24/7 SOCs are staffed with](https://www.esentire.com/what-we-do/security-operations-center)\nElite Threat Hunters and Cyber Analysts who hunt, investigate, contain and respond to\nthreats within minutes.\n\nWe have discovered some of the most dangerous threats and nation state attacks in our\nspace – including the Kaseya MSP breach and the more_eggs malware.\n\nOur Security Operations Centers are supported with Threat Intelligence, Tactical Threat\nResponse and Advanced Threat Analytics driven by our Threat Response Unit – the TRU\nteam.\n\nIn TRU Positives, eSentire’s Threat Response Unit (TRU) provides a summary of a recent\nthreat investigation. We outline how we responded to the confirmed threat and what\nrecommendations we have going forward.\n\n**Here’s the latest from our TRU Team…**\n\n## What did we find?\n\nWe identified IcedID malware attempting to load Cobalt Strike within 20 minutes of\ninitial infection.\n\n\n-----\n\n[As noted in the June 2021 TRU Positive, IcedID is a modular banking trojan and](https://www.esentire.com/blog/icedid-malware)\nprecursor to hands-on-intrusions and ransomware attacks.\nThe incident started with the victim unwittingly mounting and executing the contents of\nan ISO file delivered through email.\n\nThis technique uses a disk image (.iso) containing a shortcut and hidden files.\n[When clicked, the shortcut command uses the regsvr32 lolbin to execute the](https://lolbas-project.github.io/lolbas/Binaries/Regsvr32/)\nIcedID payload hidden within the mounted image container.\nOnce executed, IcedID immediately performs discovery commands to capture the\nsystem, domain, and networking information. These are common commands executed\nby precursor malware and are likely used to prioritize footholds for further intrusion\nactions.\nLess than 20 minutes from initial infection, the host executed remote PowerShell\ncommands to deploy a Cobalt Strike stager.\n\n_Figure 1 Endpoint View Showing IcedID Execution, Discovery Commands and Cobalt Strike_\n_Execution via PowerShell_\n\n\n-----\n\n_Figure 2 Timeline of Events from IcedID Infection to Cobalt Strike_\n\n_Figure 3 Cobalt Strike PowerShell Stager_\n\n## How did we find it?\n\nOur Machine Learning PowerShell classifier identified the malicious Cobalt Strike\nPowerShell command.\nMDR for Network disrupted and alerted on the IcedID C2 traffic.\n\n## What did we do?\n\nOur 24/7 SOC alerted the customer, and the host was contained.\n\n## What can you learn from this TRU positive?\n\nRansomware precursor threats such as IcedID, Emotet and Qakbot must be identified\nand contained before the host is used as a foothold for further attacks.\n\n\n-----\n\nAdversaries are streamlining attacks to account for defender reaction times.\n\nIn December 2021, Emotet was observed directly deploying Cobalt Strike\nbeacons to expedite intrusion actions. This was a departure from historical\nobservations where malware such as Trickbot was deployed prior to Cobalt\nStrike.\n[IcedID has been documented loading Cobalt Strike as recently as January 2022.](https://thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/)\nIn this case, the rapid deployment of Cobalt Strike stager suggests that an\ninteractive intrusion was imminent.\nAdversaries are using alternative techniques (e.g., .iso containers) to macro-based\nexecution in malicious documents.\n\nThis is likely in response to Microsoft’s recent announcement of blocking macros\n[by default in internet-sourced files starting in 2022.](https://techcommunity.microsoft.com/t5/microsoft-365-blog/helping-users-stay-safe-blocking-internet-macros-by-default-in/ba-p/3071805)\n\n## Recommendations from our Threat Response Unit (TRU) Team:\n\nLoader malware attempts to install other malware, so the priority should be to identify and\ninvestigate the presence of follow-on malware on systems. In addition, we recommend:\n\n[Display file extensions for known file types and consider showing hidden files to users](https://www.bleepingcomputer.com/news/microsoft/hiding-windows-file-extensions-is-a-security-risk-enable-now/)\nby default.\nConduct [Managed Phishing and Security Awareness Training on a regular basis. Warn](https://www.esentire.com/resources/library/managed-phishing-and-security-awareness-training)\nusers about the threat posed by scripts (e.g. JavaScript or VBScript) and image files\n(.iso) attached or linked in emails.\nEmploy email filtering and protection measures.\n\nBlock or quarantine email attachments such as EXEs, Password Protected ZIPs,\nJavaScript, Visual Basic scripts.\nImplement anti-spoofing measures such as DMARC and SPF.\nEmploy an MFA solution to reduce impact of compromised credentials.\nTrain users to identify and report suspicious emails.\nProtect endpoints against malware.\n\nEnsure antivirus signatures are up-to-date.\nUse a Next-Gen AV (NGAV) or Endpoint Detection and Response (EDR) product\nto detect and contain threats.\nLimit or disable macros across the organization. See UK's National Cyber\nCentre guidance on Macro Security.\n\n## Ask Yourself…\n\n1. Is your malware identification and remediation process agile enough to disrupt follow\non attacks stemming from loader malware?\n2. What level of visibility do you have across your network, endpoint and overall\n\nenvironment to detect malicious behavior at scale?\n3. What tools are you employing for email filtering and how is that activity monitored?\n\n\n-----\n\n4. What level of managed endpoint support do you have in place?\n5. Are you monitoring your endpoints 24/7 and what degree of control do you have to\n\ninitiate a kill switch when required?\n\n## Indicators of Compromise\n\n**Value** **Description**\n\n51[.]89[.]73[.]150 IcedID C2\n\n194[.]15[.]112[.]23 IcedID C2\n\n149[.]3[.]170[.]104 IcedID C2\n\ncooldogblunts[.]com IcedID C2\n\nreseptors[.]com IcedID C2\n\ncoolbearblunts[.]com IcedID C2\n\n88[.]119[.]161[.]88 IcedID\n\n934a3c540bb7224f9e0f6229b7dbe00b IcedID\n\nhttp://162[.]33[.]179[.]178/pasdphaiusfoifds PowerShell Download Cradle for Cobalt\nStrike\n\n0ab07147f62d8daabb591c7b4ccb4187 PowerShell Download Cradle for Cobalt\nStrike\n\nhttp://162[.]33[.]179[.]178/asdhodihsa Cobalt Strike PowerShell Stager\n\na1702eceb019352298b88b2011bfe8af Cobalt Strike PowerShell Stager\n\n162[.]33[.]178[.]218 Cobalt Strike\n\njquerysearchengine[.]com Cobalt Strike\n\n162[.]33[.]179[.]178 Cobalt Strike\n\nIf you’re not currently engaged with a Managed Detection and Response provider, we highly\nrecommend you partner with us for security services in order to disrupt threats before they\nimpact your business.\n\n[Want to learn more? Connect with an eSentire Security Specialist.](https://www.esentire.com/get-started)\n\n|Value|Description|\n|---|---|\n|51[.]89[.]73[.]150|IcedID C2|\n|194[.]15[.]112[.]23|IcedID C2|\n|149[.]3[.]170[.]104|IcedID C2|\n|cooldogblunts[.]com|IcedID C2|\n|reseptors[.]com|IcedID C2|\n|coolbearblunts[.]com|IcedID C2|\n|88[.]119[.]161[.]88|IcedID|\n|934a3c540bb7224f9e0f6229b7dbe00b|IcedID|\n|http://162[.]33[.]179[.]178/pasdphaiusfoifds|PowerShell Download Cradle for Cobalt Strike|\n|0ab07147f62d8daabb591c7b4ccb4187|PowerShell Download Cradle for Cobalt Strike|\n|http://162[.]33[.]179[.]178/asdhodihsa|Cobalt Strike PowerShell Stager|\n|a1702eceb019352298b88b2011bfe8af|Cobalt Strike PowerShell Stager|\n|162[.]33[.]178[.]218|Cobalt Strike|\n|jquerysearchengine[.]com|Cobalt Strike|\n|162[.]33[.]179[.]178|Cobalt Strike|\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-02-22 - IcedID to Cobalt Strike In Under 20 Minutes.pdf"
    ],
    "report_names": [
        "2022-02-22 - IcedID to Cobalt Strike In Under 20 Minutes.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536013,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1653785599,
    "ts_modification_date": 1653785599,
    "files": {
        "pdf": "https://archive.orkl.eu/40820518c3c009d40f20429021a842d306117a79.pdf",
        "text": "https://archive.orkl.eu/40820518c3c009d40f20429021a842d306117a79.txt",
        "img": "https://archive.orkl.eu/40820518c3c009d40f20429021a842d306117a79.jpg"
    }
}