{
    "id": "5f3c1181-2d14-49fe-a637-c91ea38e37ab",
    "created_at": "2023-01-12T15:07:17.286162Z",
    "updated_at": "2025-03-27T02:12:11.129439Z",
    "deleted_at": null,
    "sha1_hash": "9367f1b9c5f2966b5a6ff1eab11b8c1b7cdea0d1",
    "title": "2021-10-06 - Inside TeamTNT’s Impressive Arsenal- A Look Into A TeamTNT Server",
    "authors": "",
    "file_creation_date": "2022-05-28T01:58:35Z",
    "file_modification_date": "2022-05-28T01:58:35Z",
    "file_size": 1884968,
    "plain_text": "# Inside TeamTNT’s Impressive Arsenal: A Look Into A TeamTNT Server\n\n**[anomali.com/blog/inside-teamtnts-impressive-arsenal-a-look-into-a-teamtnt-server](https://www.anomali.com/blog/inside-teamtnts-impressive-arsenal-a-look-into-a-teamtnt-server)**\n\nResearch | October 6, 2021\n\nby Anomali Threat Research\n\n\n-----\n\n_Authored By: Tara Gould_\n\n## Key Findings\n\nAnomali Threat Research has discovered an open server to a directory listing that we\nattribute with high confidence to the German-speaking threat group, TeamTNT.\n\nThe server contains source code, scripts, binaries, and cryptominers targeting Cloud\nenvironments.\n\nOther server contents include Amazon Web Services (AWS) Credentials stolen from\nTeamTNT stealers are also hosted on the server.\n\nThis inside view of TeamTNT infrastructure and tools in use can help security operations\nteams to improve detection capabilities for related attacks, whether coming directly from\nTeamTNT or other cybercrime groups leveraging their tools.\n\n## Overview\n\nAnomali Threat Research has identified a TeamTNT server open to directory listing. The\nserver was used to serve scripts and binaries that TeamTNT use in their attacks, and also\nfor the IRC communications for their bot. The directory appears to have been in use since\nat least August 2021 and was in use as of October 5, 2021. The contents of the directory\ncontain metadata, scripts, source code, and stolen credentials.\n\n\n-----\n\nTeamTNT is a German-speaking, cryptojacking threat group that targets cloud\nenvironments. The group typically uses cryptojacking malware and have been active since\nat least April 2020.[1] TeamTNT activity throughout 2021 has targeted AWS, Docker, GCP,\nLinux, Kubernetes, and Windows, which corresponds to usual TeamTNT activity.[2]\n\n## Technical Analysis\n\n### Scripts (/cmd/)\n\n\n-----\n\n**_Figure 1 - Overview of /cmd/_**\n\nContained on the server are approximately 50 scripts, most of which are already\ndocumented, located in the /cmd/ directory. The objective of the scripts vary and include the\nfollowing:\n\nAWS Credential Stealer\nDiamorphine Rootkit\nIP Scanners\nMountsploit\nScripts to set up utils\nScripts to setup miners\nScripts to remove previous miners\n\n\n-----\n\n**_Figure 2 - Snippet of AWS Credential Stealer Script_**\n\nSome notable scripts, for example, is the script that steals AWS EC2 credentials, shown\nabove in Figure 2. The AWS access key, secret key, and token are piped into a text file that\nis uploaded to the Command and Control (C2) server.\n\n**_Figure 3 - Chimaera_Kubernetes_root_PayLoad_2.sh_**\n\nAnother interesting script is shown in Figure 3 above, which checks the architecture of the\nsystem, and retrieves the XMRig miner version for that architecture from another open\nTeamTNT server, 85.214.149[.]236.\n\n\n-----\n\n### Binaries (/bin/)\n\n\n-----\n\n**_Figure 4 - Overview of /bin_**\n\nWithin the /bin/ folder, shown in Figure 4 above, there is a collection of malicious binaries\nand utilities that TeamTNT use in their operations.\n\nAmong the files are well-known samples that are attributed to TeamTNT, including the\nTsunami backdoor and a XMRig cryptominer. Some of the tools have the source code\nlocated on the server, such as TeamTNT Bot. The folder /a.t.b contains the source code for\nthe TeamTNT bot, shown in Figures 5 and 6 below. In addition, the same binaries have\nbeen found on a TeamTNT Docker, noted in Appendix A.\n\n**_Figure 5 - Screenshot of TeamTNTbot.c_**\n\n\n-----\n\n**_Figure 6 - Bot Commands_**\n\n[Lasty, the /bin/ folder also contains utilities including masscan, ngrok, peirates, pnscan,](https://github.com/inguardians/peirates)\nwget, zgrab. These utilities will be used to aid in carrying out the malicious activity.\n\n### Metadata (/in/)\n\nThe folder /in/, shown below in Figure 7, contains interesting data which includes two\nsubfolders, AWS/ and results/. Inside of this folder appears to contain lists of S3 buckets\nand stolen AWS credentials shown in Figure 8 and Figure 9 below, coming from the scripts\nmentioned above. A file named “ngrok.authkeys.txt”, shown in Figure 10 below, displays an\nerror of a failure to bind to a TLS tunnel with an account name. Although it is unclear if\nthese are stolen credentials, TeamTNT have previously been reported to scan targets to\nsteal ngrok credentials.[3] Two text files, docker_ips.txt and weave_uniq.txt, contain lists of\nIPs, with the Docker file totaling 13,282 IP addresses. Another file “HoneyPots.txt” contains\ndata referring to 484 Docker containers.\n\n\n-----\n\n**_Figure 7 - Directory of /in/_**\n\n\n-----\n\n**_Figure 8 - AWS Stolen Credentials_**\n\n**_Figure 9 - Example of Stolen Credentials File_**\n\n\n-----\n\n**_Figure 10 - ngrok.authkeys.txt_**\n\n## Conclusion\n\nTeamTNT is a highly-active group that continues to evolve and target cloud infrastructure.\nThe discovery of their infrastructure gives insight into their toolsets. It is unknown at this\ntime whether TeamTNT have purposefully left this server open to directory listing, and why.\nHowever this is not the first time TeamTNT server has been open, as reported by Unit42 in\nJune 2021.[4] Furthermore, the group appears unbothered with having their toolset\npublicized, and will engage with security researchers on Twitter, even giving\nrecommendations of how the tools should be utilized.[5]\n\n\n## Endnotes\n\n[1] “Tracking The Activities of TeamTNT,” Trend Micro, accessed October 5, 2021, published\n\nJuly 20, 2021, https://documents.trendmicro.com/assets/white_papers/wp-tracking-theactivities-of-teamTNT.pdf.\n\n\n\n[2] “TeamTNT With New Campaign Aka “Chimaera”,” accessed October 5, 2021, published\n\nSeptember 8, 2021,  https://cybersecurity.att.com/blogs/labs-research/teamtnt-with-newcampaign-aka-chimaera.\n\n[3]  ”TeamTNT Actively Enumerating Cloud Environments to Infiltrate Organizations,” Palo\n\nAlto, accessed October 6, 2021, published June 4, 2021,\nhttps://unit42.paloaltonetworks.com/teamtnt-operations-cloud-environments/.\n\n\n\n[4] Ibid.\n\n[5] “HildeGard@TeamTNT,” Twitter, accessed October 6, 2021, published September 9,\n\n2021, https://twitter.com/HildeTNT/status/1436026656695672839.\n\n\n\n[6] “Malicious Docker Images Still Used For Malicious Purposes,” CounterCraft, accessed\n\nOctober 5, 2021, published September 29, 2021,\nhttps://www.countercraftsec.com/blog/post/using-malicious-docker-images-more-teamtntdocker-abuse/.\n\n## IOCs\n\n\n-----\n\n### Hashes\n\n91917fec033047a97a64be297454e6d7 ./init/r.sh\n\n644749dda45caedda59f32f7991f0ffd ./cmd/grab/aws2.sh\n\n7756f215ec37b1f545d1d8648a6d78d0 ./cmd/grab/aws-cloud.sh\n\n273ef84fbe3d495bff371e64cbf74b36 ./cmd/grab/aws.sh\n\nb20ab8eb3c3db7d20cecf44024762bd2 ./cmd/Setup.User.curl.sh\n\n1f6353c16d11e0e841129d55dfd9ac74 ./cmd/Setup_WeaveScope.sh\n\nfb3346a3cb6add01efade50b53dd211f ./cmd/Setup_RainBow_Miner.sh\n\nee9c391c98dee5331ac467854f0ae262 ./cmd/Kubernetes_root_PayLoad_2.2.sh\n\nbcf76b649b5c6016b4071d197b1ce111 ./cmd/setup_moneroocean_miner.sh\n\n7cced044d94a7ac6415598e663b46b26 ./cmd/Setup_ETH_MinerService.sh\n\ne85c28315dcdae18ab273775c29cefa7 ./cmd/gpu/ati.sh\n\n26870afb9524e1ab2eb396d15a222676 ./cmd/gpu/nvidia.sh\n\n27fd3a594fd66f4c113ab1f70a95f82e ./cmd/gpu/c3pool_gpu.sh\n\na8415b189839b9585193e2b2ec63d6f3 ./cmd/DockerAPI-SSH-BreakOut.sh\n\n45fc2131a4e60bb7545a2b1b235d66ef ./cmd/Kubernetes_root_PayLoad_1.sh\n\nf7b90d0f91ed25806d49ca281a7db10c ./cmd/init.sh\n\n940c1c591677efbe91d165751296dddd ./cmd/ld.so.preload.sh\n\n4f476e9ea8aed60e29bf06ffe758f841 ./cmd/Setup_ETH_Miner.sh\n\n9ca7f7e428ff5e3dbe943efe8ed0df31 ./cmd/GRABBER_google-cloud.sh\n\ne2fcb71452e7e4057d144bd1c525432a ./cmd/CLEAN.TeamTNT.sh\n\nc491a19742c352b2c6221037dfac7a4a ./cmd/GRABBER_aws-cloud.sh\n\n3bfed4e4d3b828c427629f764d65bd57 ./cmd/setup/all.glib.sh\n\n66d63fc99fb80c7a1fb67f712582725b ./cmd/setup/docker.ethminer.sh\n\n26870afb9524e1ab2eb396d15a222676 ./cmd/setup/nvidia.sh\n\n846b5ff8a0f64b9af3d22157cb437a5c ./cmd/setup/all.golang.sh\n\n\n-----\n\n701bc6594b2e06952451d266ced2032a ./cmd/setup/ngrok.sh\n\n03c43133db24a7b3f1e8a4d5c268668d ./cmd/setup/tmate.sh\n\n39ea1f63f9ae414c56ab3dc66a7569cd ./cmd/setup/apt.zgrab.sh\n\n64bcf5dc015e53c868950204e2cae3f1 ./cmd/setup/all.tsh.sh\n\n779a0bd628b67834116309bf3b3278ed ./cmd/setup/docker.sh\n\nde036084f92920a921bc2a43b82a8149 ./cmd/Kubernetes_temp_PayLoad_1.sh\n\n4090469125917070c22203b7d973f52e ./cmd/Kubernetes.LAN.IP.Range.sh\n\n406caa94137d5c1e18b9ee7d5c72d72d ./cmd/clean/jupyter.sh\n\nb62fbf2f2a7859e69deeb75fa1153b41 ./cmd/clean/TeamTNT.sh\n\n0d173ab9281f013221a94b4289443a16 ./cmd/Kubernetes_temp_PayLoad_2.sh\n\nd88c87f1afb6de12d885fc0fbc33b605 ./cmd/Kubernetes_scan_LAN_IPs.sh\n\na0c7366cd907197702aed089463af482 ./cmd/install-NVIDIA-driver.sh\n\n287794e108f3a4b07654ce83f6f41b38 ./cmd/Kubernetes_root_PayLoad_2.sh\n\n15d4150a3190e0630a6182a882be5cad ./cmd/fix/nameserver.sh\n\nfd65800ea90386abbdd2b099cb4cdb45 ./cmd/fix/systemfix.sh\n\n419c721fd5eb8f740cb1f971af5dc745 ./cmd/init_main_root.sh\n\nd2c6d0fed174f4cbb09d1596e46258a6 ./cmd/MOUNTSPLOIT_V2.sh.txt\n\nc491a19742c352b2c6221037dfac7a4a ./cmd/GRABBER_aws-cloud2.sh\n\n51a4ba442533bd0d69e0da7dd46e3d9c ./cmd/clean.sh\n\nfefbc41c9514a9a4f4c4e88ead3ebd89 ./cmd/ssh_user.sh\n\n3f9466ee106e947a4cea13d57ce96ed1 ./cmd/exp/ssh.rsa.sh\n\nfffe69fabf5d014579686d8bc790e70f ./cmd/exp/ssh.axx.sh\n\n80f3f20d5923c3a35022f065da9ea924 ./cmd/Setup_tmate.sh\n\ne275c26583f08e6fdbb6045c7b2db647 ./cmd/CLEAN.other.miners.sh\n\n68df6dc236a2f8d7231ca362b89148fe ./cmd/ssh_user2.sh\n\n7d91732b7c8feced0ea698c83769e51d ./bin/ngrok/aarch64\n\n\n-----\n\n0429e95cf9e7f631c944f23f82b89b54 ./bin/ngrok/x86_64\n\n5cdd0e39fc9be0a13134f26aba70ede1 ./bin/golang/go1.12.7.linux-386.tar.gz\n\n23bad8d12c43fc3e3a0568dbc8f19c85 ./bin/ethminer/cuda-9-x86_64.tar.gz\n\nae929d06265be0310c3f2eb6c44314d7 ./bin/a.t.b/TeamTNTbot.c\n\n11d85a39722734273adb7a0b21ac29a6 ./bin/a.t.b/aarch64\n\n5e4424e2a11e53e36eb10eff417fd19a ./bin/a.t.b/jupyter\n\ncffb2c0fbb0bb4a98024a682a982199b ./bin/a.t.b/x86_64\n\n2c22a520cd1ed4fc8e249d333724412d ./bin/xmrig.tar.gz\n\n777e1d9b717d339a7582e06ab28d0dd3 ./bin/bot_root/aarch64\n\nbdb404a243e374cda8948a5480f263e6 ./bin/bot_root/x86_64\n\nd901256374ddd1770270971856bf735a ./bin/masscan/x86_64.rpm\n\n7400bf51827682ec6a43b2d1c0a93eca ./bin/masscan/aarch64.rpm\n\nc1d28488c149ad232ad3073605eeaf35 ./bin/masscan/aarch64.apk\n\nce43c3c74bde98127a91cd0224f1fa26 ./bin/masscan/masscan.sh\n\n87b30ac544d39a044b66ef103f36c357 ./bin/masscan/aarch64\n\n422385becd4e08062b56f57afbc5ae6b ./bin/masscan/x86_64\n\nd4314256672783e773171fd25ac21f78 ./bin/pnscan/aarch64.deb\n\nf7a515b639dc08d8061fa56ffacbecac ./bin/pnscan/x86_64.deb\n\n3102067a3822ff1c3c17999e3e2b602d ./bin/pnscan/x86_64.rpm\n\ndb8bc741c40388270bd88cfa1ff2aa41 ./bin/pnscan/aarch64\n\nd3ba2c41757b203ad0a12d1028074bbf ./bin/pnscan/pnscan.tar.gz\n\n89d7c2db1f892139ee567d7ae29133a9 ./bin/pnscan/x86_64\n\nd3fae6436a45bfbc22fda8bcb66b27c0 ./bin/zgrab/ppc64le\n\n79b8b3d73c8e8c4b1f74a48a617690db ./bin/zgrab/i386\n\nd5869c7c642aff3d91839aaa3f4b0671 ./bin/zgrab/aarch64\n\n26c8f6597826fbdebb5df4cd8cd34663 ./bin/zgrab/x86_64\n\n\n-----\n\nbc4084451fcf1439a23a081e32a6c532 ./bin/pei/pei32\n\n07179295144082d0291759d5cf2d19c2 ./bin/pei/pei64\n\nd9dd55f66b3d783864f21684c612b406 ./bin/tshd/x86_64\n\n3634fd8b0be6de05eb6df806a4f7b11e ./bin/bot/TNT_gpu\n\nbd703ac4ea6ec7127fc9b8f8ce4d7c1e ./bin/bot/SSHSPR\n\n13e2c82ecd3bfee92c75f30cf0f40cdc ./bin/bot/chimaera.cc_Version2.c\n\n1221631e5fd5628435b6dfef15899fce ./bin/bot/chimaera.cc\n\n73a9c6eaa8afc2b02699f172f294b496 ./bin/bot/TNT_gpu.c\n\n29c0f22199b6abb07f5f2a6a6037396b ./bin/bot/AWS\n\n13e2c82ecd3bfee92c75f30cf0f40cdc ./bin/bot/chimaera.cc.c\n\ncd7a98f04de9713b602c314743e5bf55 ./bin/bot/TeamTNTbot.c\n\n5718175711512e3fb20f5cf556c57924 ./bin/src/scope\n\n677000fb99bf02e3c477a4349df76319 ./bin/src/log_clean.c\n\n068f3a272598e55dc02382818f4de70e ./bin/src/master.zip\n\nb767837f26b23ec978c1c8b42f9457a1 ./bin/src/rbm.zip\n\n3c61212d7bfb2c27834bb1d36c389273 ./bin/src/tsh.tar.gz\n\n7950de1f8f013cf3bf2c4eaa8ff4a3e5 ./bin/src/bash.tar.gz\n\n1dc06ba731199951436705f4969e5b4e ./bin/src/dia/Makefile\n\n8ab4cecc4fbf10a1de46a5f0823e0a94 ./bin/src/dia/chimaeraxmr.h\n\n7d4ee4e30088c680b9a50e3924ecce20 ./bin/src/dia/chimaeraxmr.c\n\nb62ce36054a7e024376b98df7911a5a7 ./bin/src/xmrig.so\n\n4b05c9ad17a82104dba978ab68cec49a ./bin/src/chimaeraxmr.tar.gz\n\n1254351aa752d5876ad225243bed69a8 ./CHIMAERA/bin/xmrigCC/kuben3.tar.gz\n\n### Network\n\n45.9.148.182\n\n45.9.148.182/cmd\n\n45.9.148.182/CHIMAERA\n\n\n-----\n\n45.9.148.182/bin\n45.9.148.182/in\n45.9.148.182/init\n51.79.226.64\n85.214.149.236 (appears to have been compromised)\n\n## MITRE ATT&CK TTPs\n\nTechnique ID Name\n\nExecution T1059.004 Command and Scripting Interpreter: Unix\n\nT1609 Container Administration Command\n\nDefense Evasion T1140 Deobfuscate/Decode Files or Information\n\nT1070.003 Indicator Removal on Host: Clear Command\nHistory\n\nT1070.004 Indicator Removal on Host: File Deletion\n\nT1027 Obfuscated Files or Information\n\nT1027.002 Obfuscated Files or Information: Software Packing\n\nT1036.005 Masquerading: Match Legitimate Names or\nLocations\n\nCredential Access T1552.001 Unsecured Credentials: Credentials In Files\n\nT1552.004 Unsecured Credentials: Private Keys\n\nT1552.005 Unsecured Credentials: Instance Metadata API\n\nDiscovery T1046 Network Service Scanning\n\nT1082 System Information Discovery\n\n\nCommand and\nControl\n\n\nT1071 Application Layer Protocol\n\nT1105 Ingress Tool Transfer\n\nT1219 Remote Access Software\n\nT1102 Web Service\n\n\nImpact T1496 Resource Hijacking\n\n\n-----\n\n## Appendix A\n\n### Docker Images\n\nTeamTNT are also hosting malicious docker images on a Docker repo named “alpineos”.\nThe account contains 25 images, which includes XMRig, a reverse shell, moneroocean,\nkubepwn, and TeamTNTbot builder. In some of these images the scripts are reaching out to\nthe scripts described above. In September 2021, CounterCraft released research on the\n“alpinos/dockerapi” image.[6]\n\n**_Figure 11 - TeamTNT Docker Repo_**\n\n\nDocker Image\n\n\nalpineos/dockerapi\n\n\nalpineos/wscopescan\n\n\nalpineos/dsbo\n\n\nalpineos/xxcrace\n\n\nalpineos/firstt\n\n\nalpineos/scopeppc64le\n\n\nalpineos/tntxmrigbuilder\n\n\n-----\n\nalpineos/simpledockerxmr\n\n\nalpineos/ttdft\n\n\nalpineos/tntbotbuilder\n\n\nalpineos/minion\n\n\nalpineos/xmrigcc\n\n\nalpineos/fluxfaxpax\n\n\nalpineos/scopeaarch64\n\n\nalpineos/scanaround\n\n\nalpineos/kirito\n\n\nalpineos/kndb\n\n\nalpineos/jupyter\n\n\nalpineos/java\n\n\nalpineos/revs\n\n\nalpineos/lftk\n\n\nalpineos/basicxmr\n\n\nalpineos/lft\n\n\nalpineos/weavescope\n\n\n## Appendix B\n\n[Source code available for TeamTNTBot.c,](https://gist.github.com/tgould0/87b21ece2f5e39229f35ee045f733b15) [chimaera.cc_Version2.c, and](https://gist.github.com/tgould0/d208f27c0ad17ae5db7bd12a08812c03#file-chimaera-cc_version2-c) [TNT_GPU.c.](https://gist.github.com/tgould0/068077771d835eb667b71d9d7da997f0)\n\n\n-----\n\nTopics: Research\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-10-06 - Inside TeamTNT’s Impressive Arsenal- A Look Into A TeamTNT Server.pdf"
    ],
    "report_names": [
        "2021-10-06 - Inside TeamTNT’s Impressive Arsenal- A Look Into A TeamTNT Server.pdf"
    ],
    "threat_actors": [
        {
            "id": "f809bfcb-b200-4988-80a8-be78ef6a52ef",
            "created_at": "2023-01-06T13:46:39.186988Z",
            "updated_at": "2025-03-27T02:00:03.016358Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "Adept Libra"
            ],
            "source_name": "MISPGALAXY:TeamTNT",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c3ca592f-0669-49bd-ab5c-310007ab2fb4",
            "created_at": "2022-10-25T15:50:23.334495Z",
            "updated_at": "2025-03-27T02:00:55.445098Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "TeamTNT"
            ],
            "source_name": "MITRE:TeamTNT",
            "tools": [
                "Peirates",
                "MimiPenguin",
                "LaZagne",
                "Hildegard"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536037,
    "ts_updated_at": 1743041531,
    "ts_creation_date": 1653703115,
    "ts_modification_date": 1653703115,
    "files": {
        "pdf": "https://archive.orkl.eu/9367f1b9c5f2966b5a6ff1eab11b8c1b7cdea0d1.pdf",
        "text": "https://archive.orkl.eu/9367f1b9c5f2966b5a6ff1eab11b8c1b7cdea0d1.txt",
        "img": "https://archive.orkl.eu/9367f1b9c5f2966b5a6ff1eab11b8c1b7cdea0d1.jpg"
    }
}