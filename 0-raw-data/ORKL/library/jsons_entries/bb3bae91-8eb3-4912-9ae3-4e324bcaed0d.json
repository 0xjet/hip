{
    "id": "bb3bae91-8eb3-4912-9ae3-4e324bcaed0d",
    "created_at": "2023-01-12T15:02:11.123532Z",
    "updated_at": "2025-03-27T02:05:37.852544Z",
    "deleted_at": null,
    "sha1_hash": "cef7573b49fa6edd45c9d7f3ae2c8aa32957e5ae",
    "title": "2020-12-18 - RAT used by Chinese cyberspies infiltrating Indian businesses",
    "authors": "",
    "file_creation_date": "2022-05-27T22:33:16Z",
    "file_modification_date": "2022-05-27T22:33:16Z",
    "file_size": 1409956,
    "plain_text": "# RAT used by Chinese cyberspies infiltrating Indian businesses\n\n**[seqrite.com/blog/rat-used-by-chinese-cyberspies-infiltrating-indian-businesses/](https://www.seqrite.com/blog/rat-used-by-chinese-cyberspies-infiltrating-indian-businesses/)**\n\nPavankumar Chaudhari December 18, 2020\n\n18 December 2020\nWritten by [Pavankumar Chaudhari](https://www.seqrite.com/blog/author/pavankumar/)\n\n[APT,](https://www.seqrite.com/blog/category/cybersecurity/apt/) [Cybersecurity](https://www.seqrite.com/blog/category/cybersecurity/)\n\nEstimated reading time: 5 minutes\nA few months back, Delphibased malware was being distributed on multiple systems via\nSMB exploit. The payloads used by this malware have close similarities with open-source\nGh0stRAT code. Gh0st has been used by Chinese threat actors to target multiple agencies\nin Asia — Gh0st is a Remote Access Trojan having multiple capabilities like keylogging,\nmicrophone surveillance, download and execution of payloads from remote servers,\nrestarting computers, taking the remote shell of systems, et al.\n\nWe have observed this malware targeting important institutions in India such as –\n\nBanks\nRailways\nMilk Distributors\nHospitals and Pharmaceuticals\nAgro Industries\n\n\n-----\n\nFood Production Industries\n\nAfter analysis, it was found that this malware is creating two different payloads app.exe and\nmfc.exe. After execution, both executables extract dlls in ststem32 folder of Windows\ndirectory and register them as service for persistence. Major code of all exacted payloads\nshares similarities with the open-source code of Ghost RAT.\n\n## Technical Analysis\n\n Payload 1 – app.exe\n\nThis executable had an embedded DLL file stored in reverse order as shown in the below\nfigure.\n\n**Figure 1: Embedded**\n\n**DLL in app.exe**\nThis embedded binary is decrypted and written to %SYSTEMROOT%\\System32\\ folder.\nThe below code shows the decryption code — DLL name is generated from the return value\nof GetTickCount() API.\n\n\n-----\n\n**Figure 2:**\n\n**Decryption loop.**\nApp.exe then registers this DLL as service by calling Install exported function. Below are\ndetails of service:\n\n**ServiceName: csrss**\n\n**DisplayName: Security Manager Accounts**\n\n**DesiredAccess: SERVICE_ALL_ACCESS**\n\n**ServiceType: SERVICE_WIN32_OWN_PROCESS|SERVICE_INTERACTIVE_PROCESS**\n\n**StartType: SERVICE_AUTO_START**\n\n**ErrorControl: SERVICE_ERROR_IGNORE**\n\n**BinaryPathName: %SystemRoot%\\System32\\svchost.exe -k “csrss”**\n\nThe exported function of DLL are as below:\n\nDllUpdate\nInstall\nMainThread\nServiceMain\nUninstall\n\n## C2 Functions\n\nThere are multiple C2 commands observed in the code of Gh0stRat. Some C2 functions\nobserved by static analysis of DLL are as below:\n\nShutdown System\nOpen URL\nDownload and Execute File\n\n\n-----\n\nFind Process\nClean Event Logs\n\n### Shutdown System\n\nThis function takes shutdown debug privileges and calls the ExitWindowsEx() function to\nshut down systems.\n\n**Figure 3: Shutdown System**\n\n### Download and Execute File\n\nThis function will download a specific file from the server and execute it.\n\n\n-----\n\n**4: Download and execute file**\n\n### Find Process\n\nThis function searches for a specific process by calling process enumeration APIs.\n\n**5: Find process in an existing running process**\n\n### Open URL\n\nThis function creates an iexplore.exe process with a specified URL.\n\n\n**Figure**\n\n**Figure**\n\n\n-----\n\n**6: Open URL**\n\n### Clean Event Logs\n\nThis function clears all event logs of Application, Security, and System\n\n**7: Clear event logs**\n\n## Payload 2 – mfc.exe\n\nThe second executable dropped by the main payload is mfc.exe having embedded\nexecutable in resource under the name “BIN”.\n\n\n**Figure**\n\n**Figure**\n\n\n-----\n\n**Figure**\n\n**8: Embedded DLL in the resource.**\nWhen this payload is run it drops dll (random name) from the above resource into the\nsystem32 folder and installed as a service with the name “NetworkServices” on an infected\nsystem. After creating DLL into the system32 folder, mfc.exe calls the Install() function of dll.\n\nThis DLL has four exported functions as below:\n\nInstall\nLaunch\nServiceMain\nUnInstall\n\nBelow are C2 Commands observed in this sample:\n\nInstall Keyboard Hook\nProcess Enumeration\nRemote Shell\nAudio Capture\nDownload and Execute File\n\n### Install Keyboard Hook\n\nBelow figure, XX shows that a thread is created to install a keyboard hook. All keylogging\ndata is written to a file named “syslog.dat”.\n\nFigure XX shows a similar keylogger code of Gh0st RAT.\n\n\n-----\n\n**Figure**\n\n**9: Install keyboard hook**\n\n**Figure**\n\n**10: Keylogger function from open-source Gh0st RAT code.**\n\n### Process Enumeration\n\nProcess enumeration involves getting the list of running processes to enumerate modules.\n\n\n-----\n\n**11: Process listing function**\n\n### Remote Shell\n\nThis function will create a remote shell to accept and execute any command.\n\n\n**Figure**\n\n**Figure**\n\n\n**12: Function to get a remote shell**\n\n### Audio Capture\n\n\n-----\n\nThis function records audio with the help of functions like waveInOpen(), waveInStart(),\nwaveInStop() etc.\n\n**Figure**\n\n**13: Function for audio recording**\n\n### Download and Execute File\n\nFunction to download the executable file from a remote server and execute it.\n\n**Figure 14:**\n\n**Download and execute the payload**\n\n\n-----\n\n### IOCs\n\nFF6511DE176A434FA2F7C939795A13CC\nA6CC92A1993F040E87090F8B89836332\n550C055339A9FEC141997CDA3F32FD0A\nA2B75BD7254997BEC6A19D752E26FA50\n4B8C6D70A186FEC7C79D5B52B2FF0E76\nE22E5A85ED5294B179EBD416EEB5BEBB\n5CE36CBD7D4A58A1B1A8C5B7BE194F23\nE94F9AF9EA11301831AAA1BDE34D3DEB\n23D4EC869960CE02865C98F64581136A\n367150E5DA2ED1BFAAE9210105BCEEA1\nBFB095C595FAA47CBFD4AB6199A7E297\nCA07E26D95D927953197840EA93EDD03\n6B8A19DF9827CFB95F6461FEF9929F83\n7DC43FCA774E612BF611ACD882400308\n1127149CB5378FCA7181F81EB8149FC9\nF1E921F5730919E946D9A64019867E13\nB80A559CD7D48C9D3115A013EA662263\n9403464BB99D87A02667E3E5DBA4A57C\n\n### Alerts\n\n## Conclusion\n\nThese samples are modified variants of Gh0st RAT and actors are constantly updating them\nto evade AV detections. Samples and TTPs that are seen in victim organizations are mostly\nassociated with China-based APT groups. We have been following these samples for the\n\n\n-----\n\nlast 1 month but were unable to identify the initial attack vector. As they are targeted towards\nspecific industries, we suspect to find more malware associated with these attack chains.\nInterestingly few of the victims were also infected with Monero miners during the same\nperiod. We would be closely monitoring the campaign to hunt for the entire infection chain.\n\n## Subject matter experts\n\nPavankumar Chaudhari\n\nKalpesh Mantri\n\nPavankumar is associated with Quick Heal Technologies as a Technical Lead (Research and\nDevelopment) and is also a part of Vulnerability Research and Analysis Team....\n\n[Articles by Pavankumar Chaudhari »](https://www.seqrite.com/blog/author/pavankumar/)\n\n### Related Posts\n\n Explained: What is Web3.0 and Why Does it Matter?\n\nApril 8, 2022\n\n\n-----\n\n### Metaverse and the Cybersecurity: Evolving Security into the Latest Digital Universe\n\nMarch 29, 2022\n\n### Advisory on Russia-Ukraine Conflict-Related Cyberattacks\n\nMarch 15, 2022\n\n### No Comments\n\nLeave a Reply.Your email address will not be published.\n\nOur website uses cookies. Cookies enable us to provide the best experience possible and\nhelp us understand how visitors use our website.\n\n[By browsing this website, you agree to our cookie policy.](https://www.seqrite.com/blog/cookie-policy/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-12-18 - RAT used by Chinese cyberspies infiltrating Indian businesses.pdf"
    ],
    "report_names": [
        "2020-12-18 - RAT used by Chinese cyberspies infiltrating Indian businesses.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535731,
    "ts_updated_at": 1743041137,
    "ts_creation_date": 1653690796,
    "ts_modification_date": 1653690796,
    "files": {
        "pdf": "https://archive.orkl.eu/cef7573b49fa6edd45c9d7f3ae2c8aa32957e5ae.pdf",
        "text": "https://archive.orkl.eu/cef7573b49fa6edd45c9d7f3ae2c8aa32957e5ae.txt",
        "img": "https://archive.orkl.eu/cef7573b49fa6edd45c9d7f3ae2c8aa32957e5ae.jpg"
    }
}