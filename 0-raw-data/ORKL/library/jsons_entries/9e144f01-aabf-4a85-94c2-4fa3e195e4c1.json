{
    "id": "9e144f01-aabf-4a85-94c2-4fa3e195e4c1",
    "created_at": "2023-01-12T15:03:15.895652Z",
    "updated_at": "2025-03-27T02:09:15.366561Z",
    "deleted_at": null,
    "sha1_hash": "94170feb75696fc26fd45e1a450a21a4344a1cdb",
    "title": "2019-08-05 - Sharpening the Machete",
    "authors": "",
    "file_creation_date": "2022-05-28T18:07:15Z",
    "file_modification_date": "2022-05-28T18:07:15Z",
    "file_size": 1258595,
    "plain_text": "# Sharpening the Machete\n\n**[welivesecurity.com/2019/08/05/sharpening-machete-cyberespionage/](https://www.welivesecurity.com/2019/08/05/sharpening-machete-cyberespionage/)**\n\nAugust 5, 2019\n\nESET research uncovers a cyberespionage operation targeting Venezuelan government\ninstitutions\n\n[ESET Research](https://www.welivesecurity.com/author/esetresearch/)\n5 Aug 2019 - 11:31AM\n\nESET research uncovers a cyberespionage operation targeting Venezuelan government\ninstitutions\n\n\n-----\n\nLatin America is often overlooked when it comes to persistent threats and groups with\npolitically motivated targets. There is, however, an ongoing case of cyberespionage against\nhigh-profile organizations that has managed to stay under the radar. The group behind\nthese attacks has stolen gigabytes of confidential documents, mostly from Venezuelan\ngovernment organizations. It is still very active at the time of this publication, regularly\nintroducing changes to its malware, infrastructure and spearphishing campaigns.\n\nESET has been tracking a new version of Machete (the group’s Python-based toolset) that\nwas first seen in April 2018. While the main functionality of the backdoor remains the same\nas in previous versions, it has been extended with new features over the course of a year.\n\n[Machete just got sharper: Venezuelan government institutions under attack](https://www.welivesecurity.com/wp-content/uploads/2019/08/ESET_Machete.pdf)\n\n[Download Research Paper](https://www.welivesecurity.com/wp-content/uploads/2019/08/ESET_Machete.pdf)\n\n## Targets\n\nFrom the end of March up until the end of May 2019, ESET researchers observed that there\nwere more than 50 victimized computers actively communicating with the C&C server. This\namounts to gigabytes of data being uploaded every week. More than 75% of the\ncompromised computers were part of Venezuelan government organizations, including the\nmilitary forces, education, police, and foreign affairs sectors. This extends to other countries\nin Latin America, with the Ecuadorean military being another organization highly targeted\nwith the Machete malware. The distribution of this malware in these countries is shown in\nFigure 1.\n\n\n-----\n\n_Figure 1. Countries with Machete victims in 2019_\n\n## Malware operators\n\nMachete’s operators use effective spearphishing techniques. Their long run of attacks,\nfocused on Latin American countries, has allowed them to collect intelligence and refine\ntheir tactics over the years. They know their targets, how to blend into regular\ncommunications, and which documents are of the most value to steal. Not only does\nMachete exfiltrate common office suite documents, but also specialized file types used by\ngeographic information systems (GIS) software. The group is interested in files that\ndescribe navigation routes and positioning using military grids.\n\nThe Machete group sends very specific emails directly to its victims, and these change from\ntarget to target. These emails contain either a link to, or an attachment of, a compressed\nself-extracting archive that runs the malware and opens a document that serves as a decoy.\n\nFigure 2 is a typical PDF file displayed to a potential victim during compromise. To trick\nunsuspecting targets, Machete operators use real documents they have previously stolen;\nFigure 2 is a classified official document that is dated May 21, 2019, the same day thest\n\n\n-----\n\nrelated .zip file was first sent to targets. ESET has seen more cases like this where stolen\ndocuments dated on one particular day were bundled with malware and used on the same\nday as lures to compromise new victims.\n\n_Figure 2. Decoy (PDF file) in one of the Machete downloaders (blurred)_\n\nThe kind of documents used as decoys are sent and received legitimately several times a\nday by the group’s targets. For example, Radiogramas are documents used for\ncommunication in the Venezuelan military forces. Attackers take advantage of that, along\nwith their knowledge of military jargon and etiquette, to craft very convincing phishing\nemails.\n\n## Main characteristics\n\nThe Machete group is very active and has introduced several changes to its malware since\na new version was released in April 2018. Previous versions were described by Kaspersky\nin 2014 and [Cylance in 2017. In Figure 3 we show the components for the new version of](https://threatvector.cylance.com/en_us/home/el-machete-malware-attacks-cut-through-latam.html)\nthe Machete malware.\n\n_Figure 3. Components of Machete_\n\n\n-----\n\nThe first part of the attack consists of a downloader that comes as a self-extracting archive,\nmade with [7z SFX Builder. Once the archive is unpacked by the self-extraction code, the](https://sourceforge.net/projects/s-zipsfxbuilder/)\nextractor opens a PDF or Microsoft Office file that serves as a decoy, and then runs the\ndownloader executable from the archive. That executable is another self-extracting file that\n[contains the actual downloader binary (a py2exe component) and a configuration file with](http://www.py2exe.org/)\nthe downloader’s target URL as an encrypted string.\n\nAll download URLs we have seen are at either Dropbox or Google Docs. The files at these\nURLs have all been self-extracting (RAR SFX) archives containing encrypted configuration\nand py2exe backdoor components. Since May 2019, however, the Machete operators\nstopped using downloaders and started to include the decoy file and backdoor components\nin the same archive.\n\nThe py2exe binaries can be decompiled to obtain Python code. All of the components –\n[downloaders and backdoors – are obfuscated with pyobfuscate. This has been used in](https://github.com/astrand/pyobfuscate)\nprevious versions of the malware as well. Figure 4 shows part of one of these obfuscated\nscripts.\n\n_Figure 4. Script obfuscated with pyobfuscate_\n\n\n-----\n\nSince August 2018, the Machete components have been delivered with an extra layer of\nobfuscation. The scripts now contain a block of zlib-compressed, base64-encoded text\nwhich, after being decoded, produces a script like the one in Figure 4. This first layer of\n[obfuscation is produced using pyminifier with the -gzip parameter.](https://github.com/liftoff/pyminifier)\n\n## Backdoor components\n\nMachete’s dropper is a RAR SFX executable. Three py2exe components are dropped:\nGoogleCrash.exe, Chrome.exe and GoogleUpdate.exe. A single configuration file, jer.dll, is\ndropped, and it contains base64‑encoded text that corresponds to AES‑encrypted strings. A\nschema summarizing the components is shown in Figure 5.\n\n_Figure 5. Backdoor py2exe components of Machete_\n\nGoogleCrash.exe is the main component of the malware. It schedules execution of the\nother two components and creates Windows Task Scheduler tasks to achieve persistence.\n\nThe Chrome.exe component is responsible for collection of data from the victimized\ncomputer. It can:\n\nTake screenshots\nLog keystrokes\nAccess the clipboard\nAES-encrypt and exfiltrate documents\nDetect newly inserted drives and copy files\nExecute other binaries downloaded from the C&C server\nRetrieve specific files from the system\nRetrieve user profile data from several browsers\nCollect geolocation of victims and information about nearby Wi-Fi networks\n\n\n-----\n\nPerform physical exfiltration to removable drives\n\nThe Machete operators are interested in obtaining specific file types from their targets.\nApart from Microsoft Office documents, drives are searched for:\n\nBackup files\nDatabase files\nCryptographic keys (PGP)\nOpenOffice documents\nVector images\nFiles for geographic information systems (topographic maps, navigation routes, etc.)\n\nRegarding the geolocation of victims, Chrome.exe collects data about nearby Wi-Fi\n[networks and sends it to the Mozilla Location Service API. In short, this application provides](https://location.services.mozilla.com/)\ngeolocation coordinates when it’s given other sources of data such as Bluetooth beacons,\ncell towers or Wi-Fi access points. Then the malware takes latitude and longitude\ncoordinates to build a Google Maps URL. Part of the code is shown in Figure 6.\n\n_Figure 6. Code for geolocation_\n\nThe advantage of using Mozilla Location Service is that it permits geolocation without an\nactual GPS and can be more accurate than other methods. For example, an IP address can\nbe used to obtain an approximate location, but it is not so accurate. On the other hand, if\nthere is available data for the area, Mozilla Location Service can provide information such\nas in which building the target is located.\n\nThe GoogleUpdate.exe component is responsible for communicating with the remote C&C\nserver. The configuration to set the connection is read from the jer.dll file: domain name,\nusername and password. The principal means of communication for Machete is via FTP,\nalthough HTTP communication was implemented as a fallback in 2019.\n\nThis component uploads encrypted files to different subdirectories on the C&C server, but it\nalso retrieves specific files that have been put on the server by the Machete operators. This\nway, the malware can have its configuration, malicious binaries and file listings updated, but\n\n\n-----\n\ncan also download and execute other binaries.\n\n## In conclusion\n\nThe Machete group is operating more strongly than ever, even after researchers have\npublished technical descriptions and indicators of compromise for this malware. ESET has\nbeen tracking this threat for months and has observed several changes, sometimes within\nweeks.\n\nAt the time of this publication, the latest change introduced six backdoor components, which\nare no longer py2exe executables. Python scripts for malicious components, an original\nexecutable for Python 2.7, and all libraries used are packed into a self-extracting file.\n\nVarious artifacts that we have seen in Machete’s code and the underlying infrastructure lead\nus to think that this is a Spanish-speaking group. The presence of code to exfiltrate data to\nremovable drives when there is physical access to a compromised computer may indicate\nthat Machete operators could have a presence in one of the targeted countries, although we\ncannot be certain.\n\nA full and comprehensive list of Indicators of Compromise (IoCs) can be found in the full\n[white paper and on GitHub. ESET detects this threat as a variant of Python/Machete.](https://github.com/eset/malware-ioc/tree/master/machete)\n\nFor a detailed analysis of the backdoor, refer to our white paper Machete just got sharper:\nVenezuelan government institutions under attack.\n\n_For any inquiries, or to make sample submissions related to the subject, contact us at_\n_threatintel@eset.com._\n\n## MITRE ATT&CK techniques\n\n**Tactic** **ID** **Name** **Description**\n\n\nInitial\nAccess\n\n\n[T1192](https://attack.mitre.org/techniques/T1192/) Spearphishing Link Emails contain a link\nto download a\ncompressed file from\nan external server.\n\n\n[T1193](https://attack.mitre.org/techniques/T1193/) Spearphishing\nAttachment\n\n\nEmails contain a zipped file with\nmalicious contents.\n\n\nExecution [T1204](https://attack.mitre.org/techniques/T1204/) User Execution Tries to get users to\nopen links or\nattachments that will\nexecute the first\ncomponent of\nMachete.\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\n\n[T1053](https://attack.mitre.org/techniques/T1053/) Scheduled\nTask\n\n\nOther components of Machete\nare executed by Windows Task\nScheduler.\n\n\nPersistence [T1158](https://attack.mitre.org/techniques/T1158/) Hidden Files and Directories Malware files and\nfolders are hidden for\npersistence.\n\n\n[T1053](https://attack.mitre.org/techniques/T1053/) Scheduled\nTask\n\n\nAll of the components are\nscheduled to ensure\npersistence.\n\n\nDefense\nEvasion\n\n\n[T1027](https://attack.mitre.org/techniques/T1027/) Obfuscated Files or Information Python scripts are\nobfuscated.\n\n\n[T1045](https://attack.mitre.org/techniques/T1045/) Software\nPacking\n\n\nMachete payload is delivered as\nself-extracting files. Machete\ndownloaders are UPX packed.\n\n\n[T1036](https://attack.mitre.org/techniques/T1036/) Masquerading File and task names try to\nimpersonate Google Chrome\nexecutables.\n\n\nCredential\nAccess\n\n\n[T1145](https://attack.mitre.org/techniques/T1145/) Private Keys A compromised\nsystem is scanned\nlooking for key and\ncertificate file\nextensions.\n\n\n[T1081](https://attack.mitre.org/techniques/T1081/) Credentials in\nFiles\n\n\nMachete exfiltrates files with\nstored credentials for Chrome\nand Firefox.\n\n\nDiscovery [T1049](https://attack.mitre.org/techniques/T1049/) System Network Connections\nDiscovery\n\n\nNetsh command is\nused to list all nearby\nWi-Fi networks.\n\n\n[T1120](https://attack.mitre.org/techniques/T1120/) Peripheral\nDevice\nDiscovery\n\n[T1083](https://attack.mitre.org/techniques/T1083/) File and\nDirectory\nDiscovery\n\n[T1057](https://attack.mitre.org/techniques/T1057/) Process\nDiscovery\n\n\nNewly inserted devices are\ndetected by listening for the\nWM_DEVICECHANGE window\nmessage.\n\nFile listings are produced for files\nto be exfiltrated.\n\nIn the latest version, running\nprocesses are enumerated\nsearching for browsers.\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\n\n[T1217](https://attack.mitre.org/techniques/T1217/) Browser\nBookmark\nDiscovery\n\n[T1010](https://attack.mitre.org/techniques/T1010/) Application\nWindow\nDiscovery\n\n\nBrowser data such as\nbookmarks is gathered for\nChrome and Firefox.\n\nWindow names are reported\nalong with keylogger\ninformation.\n\n\nCollection [T1115](https://attack.mitre.org/techniques/T1115/) Clipboard Data Clipboard data is\nstolen by creating an\noverlapped window\nthat will listen to\nkeyboard events.\n\n\n[T1005](https://attack.mitre.org/techniques/T1005/) Data from\nLocal System\n\n[T1025](https://attack.mitre.org/techniques/T1025/) Data from\nRemovable\nMedia\n\n\nFile system is searched for files\nof interest.\n\nFiles are copied from newly\ninserted drives.\n\n\n[T1056](https://attack.mitre.org/techniques/T1056/) Input Capture Machete logs keystrokes from\nthe victim’s machine.\n\n\n[T1113](https://attack.mitre.org/techniques/T1113/) Screen\nCapture\n\n\nPython Imaging Library is used\nto capture screenshots.\n\n\n[T1074](https://attack.mitre.org/techniques/T1074/) Data Staged Files and logs are stored in the\nWinde folder, encrypted.\n\n\nCommand\nand Control\n\n\n[T1043](https://attack.mitre.org/techniques/T1043/) Commonly Used Port Standard FTP port is\nused for\ncommunications.\nStandard HTTP port\nas fallback.\n\n\n[T1008](https://attack.mitre.org/techniques/T1008/) Fallback\nChannels\n\n[T1105](https://attack.mitre.org/techniques/T1105/) Remote File\nCopy\n\n[T1071](https://attack.mitre.org/techniques/T1071/) Standard\nApplication\nLayer\nProtocol\n\n\nMachete uses HTTP to exfiltrate\ndocuments if FTP is\nunavailable.\n\nMachete can download\nadditional files for execution on\nthe victim’s machine.\n\nFTP is used for Command &\nControl.\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\nExfiltration [T1020](https://attack.mitre.org/techniques/T1020/) Automated Exfiltration All collected files are\nexfiltrated\nautomatically via FTP\nto remote servers.\n\n\n[T1002](https://attack.mitre.org/techniques/T1002/) Data\nCompressed\n\n[T1022](https://attack.mitre.org/techniques/T1022/) Data\nEncrypted\n\n[T1041](https://attack.mitre.org/techniques/T1041/) Exfiltration\nOver\nCommand and\nControl\nChannel\n\n[T1052](https://attack.mitre.org/techniques/T1052/) Exfiltration\nOver Physical\nMedium\n\n[T1029](https://attack.mitre.org/techniques/T1029/) Scheduled\nTransfer\n\n5 Aug 2019 - 11:31AM\n\n\nMachete compresses browser’s\nprofile data as .zip files prior to\nexfiltrating it.\n\nCollected data is encrypted with\nAES before transmitting it. In the\nlatest version of the malware, it\nis encoded with base64 (but not\nencrypted).\n\nData is exfiltrated over the same\nchannel used for C&C.\n\nData from all drives in a\ncompromised system is copied\nto a removable drive if there is a\nspecial file in that drive.\n\nData is sent to the C&C server\nevery 10 minutes.\n\n\n### Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n Newsletter\n\n Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-08-05 - Sharpening the Machete.pdf"
    ],
    "report_names": [
        "2019-08-05 - Sharpening the Machete.pdf"
    ],
    "threat_actors": [
        {
            "id": "d303c77e-0110-471b-a3a6-37fce9ac848d",
            "created_at": "2022-10-25T15:50:23.342452Z",
            "updated_at": "2025-03-27T02:00:55.447692Z",
            "deleted_at": null,
            "main_name": "Machete",
            "aliases": [
                "APT-C-43",
                "El Machete"
            ],
            "source_name": "MITRE:Machete",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "edc11896-f4f1-4132-9c38-d073ccdcf5b6",
            "created_at": "2022-10-25T16:07:23.576476Z",
            "updated_at": "2025-03-27T02:02:09.873658Z",
            "deleted_at": null,
            "main_name": "El Machete",
            "aliases": [
                "APT-C-43",
                "ATK 97",
                "Operation HpReact",
                "TAG-NS1",
                "TEMP.Andromeda"
            ],
            "source_name": "ETDA:El Machete",
            "tools": [
                "El Machete",
                "ForeIT",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Loki",
                "Loki.Rat",
                "LokiBot",
                "LokiPWS",
                "Pyark"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "ba4f277c-c3da-45e6-a2fb-4ed556dbae64",
            "created_at": "2023-01-06T13:46:38.605117Z",
            "updated_at": "2025-03-27T02:00:02.871423Z",
            "deleted_at": null,
            "main_name": "El Machete",
            "aliases": [
                "APT-C-43",
                "G0095",
                "machete-apt"
            ],
            "source_name": "MISPGALAXY:El Machete",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d2a5c949-7ae0-4610-8bb8-047ab03b1574",
            "created_at": "2022-10-25T16:07:24.064197Z",
            "updated_at": "2025-03-27T02:02:10.096487Z",
            "deleted_at": null,
            "main_name": "Poison Carp",
            "aliases": [
                "Earth Empusa",
                "Evil Eye",
                "EvilBamboo",
                "Poison Carp",
                "Red Dev 16"
            ],
            "source_name": "ETDA:Poison Carp",
            "tools": [
                "ActionSpy",
                "AxeSpy",
                "BADSIGNAL",
                "BADSOLAR",
                "BadBazaar",
                "IRONSQUIRREL",
                "IceCube",
                "MOONSHINE",
                "PoisonCarp"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "52973e5f-9656-4b60-b7f8-457e32ac4bbe",
            "created_at": "2023-01-06T13:46:39.056888Z",
            "updated_at": "2025-03-27T02:00:02.986693Z",
            "deleted_at": null,
            "main_name": "POISON CARP",
            "aliases": [
                "Evil Eye",
                "Red Dev 16",
                "Earth Empusa"
            ],
            "source_name": "MISPGALAXY:POISON CARP",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535795,
    "ts_updated_at": 1743041355,
    "ts_creation_date": 1653761235,
    "ts_modification_date": 1653761235,
    "files": {
        "pdf": "https://archive.orkl.eu/94170feb75696fc26fd45e1a450a21a4344a1cdb.pdf",
        "text": "https://archive.orkl.eu/94170feb75696fc26fd45e1a450a21a4344a1cdb.txt",
        "img": "https://archive.orkl.eu/94170feb75696fc26fd45e1a450a21a4344a1cdb.jpg"
    }
}