{
    "id": "29ad034f-f10e-4e1c-ab8c-191c2c9dec0f",
    "created_at": "2023-01-12T15:08:27.559852Z",
    "updated_at": "2025-03-27T02:05:31.556095Z",
    "deleted_at": null,
    "sha1_hash": "833f8b1200d739f7e22da724761317066d6daa00",
    "title": "2022-02-22 - Like Father Like Son- New Mars Stealer",
    "authors": "",
    "file_creation_date": "2022-05-28T01:31:45Z",
    "file_modification_date": "2022-05-28T01:31:45Z",
    "file_size": 812231,
    "plain_text": "# Like Father Like Son? New Mars Stealer\n\n**cyberint.com/blog/research/mars-stealer/**\n\n## Executive Summary\n\n\nFebruary 22, 2022\n\n\nFirst observed in 2021 and advertised as a standalone version on various cybercriminal forums, Mars is an\ninformation stealer mainly targeting Windows victim credentials and cryptocurrency wallets including 2FA\nplugins and any essential system information. Mars is also capable of loading any type of file by downloading\nand executing them from a given drop-zone.\n\nOver the past several months, Mars took the place of a solid info stealer. We now see more new threat actors\n[comparing its efficiency to Raccoon stealer, and having a hard time choosing between the two given the](https://cyberint.com/blog/research/raccoon-stealer/)\nsimplicity, “noob-friendly” setup, and cheap price.\n\n[As some claims suggest, Mars is actually a new version of Oski stealer which we have written about in the](https://cyberint.com/blog/research/agent-tesla-delivers-oski-stealer/)\npast.\n\n## Advertising\n\nMars is currently advertised in over 47 different underground forums, Telegram channels and Darknet onion\nsites, while the main channel for purchasing the malware is the official Telegram channel (Figure 1), created\non August 4, 2021, giving a big boost to the stealer.\n\nAlthough Mars is a better version than its predecessor, Oski, a leak of the dashboard caused damage to the\ninfo stealer’s team. But over the past months, we’ve seen the effort the team put into branding this info stealer\nwith competitive prices, promoting the “MarsTeam” name, pushing new abilities, providing lifetime support,\nand more.\n\nAs mentioned, Mars offers a cheap lifetime subscription for only $160, paid in cryptocurrency of course. In\ncomparison, Raccoon and Redline, the top 2 info stealers at the moment, charge the same price for a twoweek subscription, although their business model is Malware-as-a-Service (MaaS).\n\n[Another option is to use the leaked panel version that is currently free of charge, but threat actors need to take](https://github.com/mave12/Mars-Stealer)\ncare of the infrastructure, anonymity, and so on, without any help or support from the MarsTeam.\n\n\n-----\n\nFigure 1: Mars Stealer\n\nofficial Telegram channel\n\n## Command and Control\n\nThe C&C setup is fairly easy, whether you buy the panel or use the leaked one. The group provides an all-inone solution that makes the stealer’s infrastructure very simple to use, but also very easy to detect.\n\nThe C&C is comprised of three modules: the dashboard, the drop zone for stealers’ logs, and the downloading\nsource for dependencies.\n\nAlthough the modules are separate, and the leaked code is easy to understand, it seems that most threat\nactors do not use more sophisticated techniques such as reverse proxy or segregation of each module in a\ndifferent host but rather use them all in the same host\n\n\n-----\n\n### Structure\n\nThe Cyberint Research Team has been tracking Mars for some time now and found several C&Cs that were\nset up as public, disclosing the structure and files within the C&C (Figure 2).\n\nFigure 2: C&C files deployment on live server\n\nFurthermore, we were able to find the logs gathered by the stealers (Figure 3) stored in the /logs directory\nwithin the C&C server.\n\n\n-----\n\nFigure 3: Victims’ log files found in the C&C\n\nDashboard\n\n### Dashboard\n\nWhen it comes to the dashboard infrastructure, is provides a full picture of the logs found by the threat actor\nstealers (Figure 4).\n\n\n-----\n\nFigure 4: Mars stealer dashboard\nOther than a campaign overview, the dashboard provides file grabbing statistics and Loader rules, which are\nused for setting up the files the threat actor would like to load into the infected machine.\n\nIt seems that more experienced threat actors will look to use the leaked panel kit given that it comes with full\ninstallation and building instructions, and, like more advanced stealers, can be modelized to create Telegram\nintegration, making the campaign less obvious.\n\n### Dependencies\n\nThe C&C contains the dependencies the stealer needs in order to operate properly when it comes to\ninformation gathering.\n\nThe files are in fact legitimate third-party Dynamic-link Libraries (DLL) used to support access to data of\nvarious applications and/or browsers.\n\n### Drop Zone\n\nThe drop zone module within the C&C is straightforward and simple with the common gate.php file in which\nthe stealer posting a Zip file containing the stolen data.\n\n## Delivery\n\nLacking an out-of-the-box distribution method, recently observed Mars incidents appear to begin with social\nengineering techniques commonly used in gaming forums and groups as the threat actors lure the victims to\ndownload patching software (Figure 5), cracks and keygens (Figure 6).\n\n\n-----\n\nthat delivers Mars\n\n\nFigure 5: Astron patching software\n\nFigure 6: Keygen software that\n\n\ndelivers Mars\nUsing this technique might be even more effective than malicious documents sent via email given the fact that\nvictims might think that the defense mechanisms alerts these files because of their original purposes, which\nare pretty sketchy by themselves. This results in excluding these files from the defense systems by the victims\nand knowingly approves theses files to run in administrator privileges.\n\n\n-----\n\nIn addition to this technique, evidence suggests that malspam campaign delivery is also used in the wild,\nalong with Twitter and Instagram Direct Messaging.\n\nLike most info stealers, the targeting of these campaigns is based more on the hobbies and communities the\nvictims take part in, such as gaming, cryptocurrency, 3D artists and graphic designers, than on a specific\ngeolocation or business sector.\n\nAs mentioned, the more traditional and more scalable technique of spreading the stealer will be a combination\nof social engineering the abusing malspam campaigns – often carried out by delivering malicious documents\nof any kind to the victim’s machine containing malicious macros (Figure 7) that downloads and execute Mars\nin the machine\n\nFigure 7: Malicious macros containing PowerShell commands to download Mars from a Discord channel\nThere has been a rise in cases where campaigners will abuse the Discord infrastructure and use it as a solid\nloading module for their malicious content. With Mars Stealer, it’s no different.\n\n## Post Infection\n\nMars Stealer’s approach is somewhat similar to most other stealer threats. It is obviously focused on the theft\nof credentials from common applications, browsers and credentials stores, as well as the acquisition of\npotentially sensitive and valuable data from a victim machine, such as cryptocurrency wallets or other files,\n\nAdditionally, Mars Stealer can be used as a ‘loader’ to download and execute additional payloads from its\ncommand and control (C2) infrastructure and, notably, will terminate and delete itself upon the conclusion of\nits task.\n\nIn cases in which the default languages of the victim’s machine are from Kazakhstan, Uzbekistan, Azerbaijan,\nBelarus and Russia, the stealer will not proceed with.\n\n### Calling Home\n\nThe first step Mars will take once the machine is infected is to communicate with the C&C in order to receive\nconfigurations and instructions via HTTP GET request to the gate.php file (Figure 8).\n\n\n-----\n\nFigure 8: GET request by Mars to receive\n\nfurther instructions\nThe C&C replies with Base64 encoded strings that will contain configurations regarding file types, specific\ndirectories, and strings the threat actor would like Mars to look for.\n\n### Download Dependencies\n\nAs mentioned, Mars Stealer requires several DLL files provided by the C&C in order to operate properly. It\nobtains them via HTTP GET requests for each file (Figure 9).\n\nFigure 9: Mars dependencies download\n\nThe downloaded DLLs will contribute to the following operations:\n```\n   freebl3.dll, mozglue.dll, nss3.dll & softokn3.dll – Network Security Services and\n\n```\nsupporting libraries used by Mozilla products such as Firefox and Thunderbird\n```\n   msvcp140.dll & vcruntime140.dll – Microsoft Visual C++ redistributable for Visual Studio 2015\n   sqlite3.dll – Enables SQLite related operations, allowing sensitive databases used by browsers\n\n```\nand/or email clients, including cookie and credential stores, to be accessed\n\n### Data Exfiltration\n\nMars Stealer usually creates its working directory in the victim’s machine %TEMP% directory, naming it with\nfourteen random capital letters and numbers. Mars Stealer stores all acquired data within this directory in\npreparation for data exfiltration (Figure 10), including credentials from a variety of chat, email, FTP and webbrowsing applications, as well as cryptocurrency wallets, a desktop screenshot and details of the system\nconfiguration.\n\n\n-----\n\nFigure 10: Mars Stealer working directory content\n\nOnce Mars finishes information gathering according to the configuration and instructions received by the C&C,\nit will create a zip file from the working directory and send it to the C&C (Figure 11).\n\nFigure 11: Mars Stealer uploading\n\nthe zip file to the C&C\n\n### Oski Comparison\n\nThroughout the entire operation process, Mars implements the same methods as Oski: Communication with\nthe C&C, working directory, dependencies use and data exfiltration phase are, all the same. The differences\nbetween the two are with the type of content the info stealer will look for by default and the 2FA plugins.\n\n## Recommendations\n\nEmployee security awareness training remains an important step in helping them identify and be\nsuspicious of unsolicited emails and phishing campaigns, especially messages with embedded links or\nfile attachments.\nDisable administrative tools and script interpreters, such as PowerShell, to prevent their misuse by\nmalicious payloads.\nUse Group Policy to disable macros from running in Microsoft Office applications (legitimate macros\nshould be digitally signed to allow for an exception to the disable rule),\nEducate users on the common TTP used and reinforce the message that documents encouraging them\nto ‘Enable Editing’, ‘Enable Content’ or disable any other security setting are almost certainly malicious.\nMulti-factor authentication should be implemented wherever possible to limit the effectiveness of stolen\ncredentials.\nEmployees should be reminded of the risks associated with credential reuse and weak passwords\nsupported by password policies to encourage best practice.\nLimit user permissions according to the principal of least privilege (POLP).\n\n\n-----\n\nEnsure that email security controls are applied to limit the delivery of potentially malicious attachments\nor links to end-users, as well as implementing protocols and security controls such as DKIM, DMARC\nand SPF.\nContinuous monitoring of unusual endpoint behaviors such as excessive requests to specific webhosts\nusing unusual user-agent strings, can provide an early indication of compromise.\nConsider applying deep content inspection to ensure that any downloaded content filetype matches the\nactual file content in addition to blocking dangerous filetypes, such as executables, for standard users.\n\n## Recommendations\n\nIndicators of Compromise\n\n### File Samples (SHA256)\n\nThe following hashes are provided for reference, given the ongoing nature of these campaigns, it is likely that\nthe threat actor will utilize methods to avoid detection such as packing and crypting resulting in differing\ncryptographic hashes.\n\n**Delivery:**\n```\n   dc52bd40b95294f98db602df36975e9c5a203a2648dd8ddc6748f2e678cc39a6\n   2cfdba6fcd48a3047b93b72092061bf1fac2511f74f8c747215a7c3aaf2a9102\n   ed427feb185f07a51de0194f1165ebaeb002f2b8c9b08d974219be5c6075c6f\n\n```\n**Mars:**\n```\n   a4d54f94d70dcb5a029d89dcd3bcda4bb5e3e0b909fbcad04bb5ed4d09459c7d\n   031ebdaf0189694eec6b83ad26e8252547d843780563f54ec06a170f1c0e40d3\n\n### URLs\n\n```\nThe following URLs have been observed as used during the initial downloader phases:\n```\n   hxxps[:]//siasky.net/OAC12bva5mDWqNV5JIvaN4K9ASZmy1rMTXxCg7lUGhUf0A\n   hxxps[:]//plik.root.gg/file/7Pi2XabIKFrlmvfR/oF2VN0eo1Z0CGt2y/BOINCPortable_7_16_22.log\n\n```\nAdditionally, multiple resources hosted on the Oski Stealer C2 URL have been observed with the directory\nstructure potentially changing between campaigns:\n```\n   anderd2w[.]beget.tech\n   185[.]4.65.70\n   a0626884[.]xsph.ru\n   panel[.]computer\n   f0623459[.]xsph.rublitzhost.ga\n   80[.]79.114.182\n   test[.]akadns9[.]ne\n\n```\n**Want to speak to Cyberint experts?**\n\n**[Contact us!](https://cyberint.com/contact-sales/)**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-02-22 - Like Father Like Son- New Mars Stealer.pdf"
    ],
    "report_names": [
        "2022-02-22 - Like Father Like Son- New Mars Stealer.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536107,
    "ts_updated_at": 1743041131,
    "ts_creation_date": 1653701505,
    "ts_modification_date": 1653701505,
    "files": {
        "pdf": "https://archive.orkl.eu/833f8b1200d739f7e22da724761317066d6daa00.pdf",
        "text": "https://archive.orkl.eu/833f8b1200d739f7e22da724761317066d6daa00.txt",
        "img": "https://archive.orkl.eu/833f8b1200d739f7e22da724761317066d6daa00.jpg"
    }
}