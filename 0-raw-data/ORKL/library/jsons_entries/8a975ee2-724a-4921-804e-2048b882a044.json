{
    "id": "8a975ee2-724a-4921-804e-2048b882a044",
    "created_at": "2023-01-12T15:06:39.615828Z",
    "updated_at": "2025-03-27T02:06:00.705697Z",
    "deleted_at": null,
    "sha1_hash": "475438da0112f14cde5dc20727c3b888bda2f482",
    "title": "2019-01-18 - Nymaim deobfuscation",
    "authors": "",
    "file_creation_date": "2022-05-27T22:56:17Z",
    "file_modification_date": "2022-05-27T22:56:17Z",
    "file_size": 461988,
    "plain_text": "# Malware-Scripts/Nymaim at master · coldshell/Malware- Scripts · GitHub\n\n**[github.com/coldshell/Malware-Scripts/tree/master/Nymaim](https://github.com/coldshell/Malware-Scripts/tree/master/Nymaim)**\n\ncoldshell\n\n## Nymaim deobfuscation\n\n### This tool helps to deobfuscate nymaim samples.\n\n To deobfuscate we use miasm for the emulation and grap to match graph patterns.\n\n## Usage\n\n### Patch nymaim and generate an IDA script to rename fonctions:\n\n\n-----\n\n```\n./nymaim.py ida /tmp/nymaim_unpack_2018 03 28.bin\n[+] Searching for the pattern push_reg\n[i] The graph push_reg was found 1 time(s)\n[+] Emulating each call to push_reg\n[+] Patching each call to push_reg (can take a while)\n[+] Searching for the pattern detour_call\n[i] The graph detour_call was found 34 time(s)\n[e] No XREFS to the function 0x429537 was found\n[+] Emulating each call to detour_call\n[+] Patching each call to detour_call (can take a while)\n[+] Searching for the pattern detour_jmp\n[i] The graph detour_jmp was found 32 time(s)\n[e] No XREFS to the function 0x402AC2 was found\n[e] No XREFS to the function 0x404A23 was found\n[e] No XREFS to the function 0x404EAB was found\n[e] No XREFS to the function 0x406A90 was found\n[e] No XREFS to the function 0x4081B3 was found\n[e] No XREFS to the function 0x40DF3D was found\n[e] No XREFS to the function 0x41148D was found\n[e] No XREFS to the function 0x419F2C was found\n[e] No XREFS to the function 0x41A5B4 was found\n[e] No XREFS to the function 0x41FB49 was found\n[e] No XREFS to the function 0x42247A was found\n[e] No XREFS to the function 0x423A38 was found\n[e] No XREFS to the function 0x42477F was found\n[e] No XREFS to the function 0x4278C1 was found\n[e] No XREFS to the function 0x42914B was found\n[e] No XREFS to the function 0x42BFFF was found\n[e] No XREFS to the function 0x42F385 was found\n[e] No XREFS to the function 0x43212F was found\n[+] Emulating each call to detour_jmp\n[+] Patching each call to detour_jmp (can take a while)\n[+] Creation of an IDA script to rename function: /tmp/nymaim_unpack_2018-0328.bin_ida.py\n[+] Patched nymaim available: /tmp/nymaim_unpack_2018-03-28.bin.clean\n\n### The generated IDA script look like this:\n\n```\n\n-----\n\n```\nMakeFunction(4214618)\nMakeNameEx(4214618, \"detour_jmp_0\", SN_NOWARN)\nMakeFunction(4226729)\nMakeNameEx(4226729, \"detour_jmp_1\", SN_NOWARN)\nMakeFunction(4229427)\nMakeNameEx(4229427, \"detour_jmp_2\", SN_NOWARN)\nMakeFunction(4261327)\nMakeNameEx(4261327, \"detour_jmp_3\", SN_NOWARN)\nMakeFunction(4270551)\nMakeNameEx(4270551, \"detour_jmp_4\", SN_NOWARN)\nMakeFunction(4327584)\nMakeNameEx(4327584, \"detour_jmp_5\", SN_NOWARN)\nMakeFunction(4327617)\nMakeNameEx(4327617, \"detour_jmp_6\", SN_NOWARN)\nMakeFunction(4356652)\n...\n...\n...\n\n### Before/After:\n\n```\n\n-----\n\n## Requirements\n\n### You will need grap and miasm. For the others dependencies see the requierments.txt .\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-01-18 - Nymaim deobfuscation.pdf"
    ],
    "report_names": [
        "2019-01-18 - Nymaim deobfuscation.pdf"
    ],
    "threat_actors": [
        {
            "id": "fce5181c-7aab-400f-bd03-9db9e791da04",
            "created_at": "2022-10-25T15:50:23.759799Z",
            "updated_at": "2025-03-27T02:00:55.540135Z",
            "deleted_at": null,
            "main_name": "Transparent Tribe",
            "aliases": [
                "Transparent Tribe",
                "COPPER FIELDSTONE",
                "APT36",
                "Mythic Leopard",
                "ProjectM"
            ],
            "source_name": "MITRE:Transparent Tribe",
            "tools": [
                "DarkComet",
                "ObliqueRAT",
                "njRAT",
                "Peppy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c68fa27f-e8d9-4932-856b-467ccfe39997",
            "created_at": "2023-01-06T13:46:38.450585Z",
            "updated_at": "2025-03-27T02:00:02.836543Z",
            "deleted_at": null,
            "main_name": "Operation C-Major",
            "aliases": [
                "C-Major",
                "Transparent Tribe",
                "Mythic Leopard",
                "ProjectM",
                "APT 36",
                "TMP.Lapis",
                "Green Havildar",
                "COPPER FIELDSTONE",
                "APT36",
                "Earth Karkaddan",
                "Storm-0156"
            ],
            "source_name": "MISPGALAXY:Operation C-Major",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "abb24b7b-6baa-4070-9a2b-aa59091097d1",
            "created_at": "2022-10-25T16:07:24.339942Z",
            "updated_at": "2025-03-27T02:02:10.179404Z",
            "deleted_at": null,
            "main_name": "Transparent Tribe",
            "aliases": [
                "APT 36",
                "APT-C-56",
                "Copper Fieldstone",
                "Earth Karkaddan",
                "Green Havildar",
                "Mythic Leopard",
                "Operation C-Major",
                "Operation Honey Trap",
                "Operation Transparent Tribe",
                "ProjectM",
                "STEPPY-KAVACH",
                "Storm-0156",
                "TEMP.Lapis",
                "Transparent Tribe"
            ],
            "source_name": "ETDA:Transparent Tribe",
            "tools": [
                "Amphibeon",
                "Android RAT",
                "Bezigate",
                "Bladabindi",
                "Bozok",
                "Bozok RAT",
                "BreachRAT",
                "Breut",
                "CapraRAT",
                "CinaRAT",
                "Crimson RAT",
                "DarkComet",
                "DarkKomet",
                "ElizaRAT",
                "FYNLOS",
                "Fynloski",
                "Jorik",
                "Krademok",
                "Limepad",
                "Luminosity RAT",
                "LuminosityLink",
                "MSIL",
                "MSIL/Crimson",
                "Mobzsar",
                "MumbaiDown",
                "Oblique RAT",
                "ObliqueRAT",
                "Peppy RAT",
                "Peppy Trojan",
                "Quasar RAT",
                "QuasarRAT",
                "SEEDOOR",
                "Scarimson",
                "SilentCMD",
                "Stealth Mango",
                "UPDATESEE",
                "USBWorm",
                "Waizsar RAT",
                "Yggdrasil",
                "beendoor",
                "klovbot",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535999,
    "ts_updated_at": 1743041160,
    "ts_creation_date": 1653692177,
    "ts_modification_date": 1653692177,
    "files": {
        "pdf": "https://archive.orkl.eu/475438da0112f14cde5dc20727c3b888bda2f482.pdf",
        "text": "https://archive.orkl.eu/475438da0112f14cde5dc20727c3b888bda2f482.txt",
        "img": "https://archive.orkl.eu/475438da0112f14cde5dc20727c3b888bda2f482.jpg"
    }
}