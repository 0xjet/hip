{
    "id": "2d6bc754-f47f-4edc-a2f8-718904ee32d7",
    "created_at": "2023-05-06T02:08:47.104298Z",
    "updated_at": "2025-03-27T02:11:47.689927Z",
    "deleted_at": null,
    "sha1_hash": "5c41ac80d56ea6ab130e9663219562bba12251fa",
    "title": "2023-04-18 - State-sponsored campaigns target global network infrastructure",
    "authors": "",
    "file_creation_date": "2023-05-05T02:01:47Z",
    "file_modification_date": "2023-05-05T02:01:47Z",
    "file_size": 229059,
    "plain_text": "# State-sponsored campaigns target global network infrastructure\n\n**[blog.talosintelligence.com/state-sponsored-campaigns-target-global-network-infrastructure/](https://blog.talosintelligence.com/state-sponsored-campaigns-target-global-network-infrastructure/)**\n\nMatt Olney April 18, 2023\n\nBy [Matt Olney](https://blog.talosintelligence.com/author/matt-olney/)\n\nTuesday, April 18, 2023 11:04\n\n[Threats](https://blog.talosintelligence.com/category/threats/) [SecureX\nThreat Advisory](https://blog.talosintelligence.com/category/securex-3/)\n\nCisco is deeply concerned by an increase in the rate of high-sophistication attacks on\nnetwork infrastructure — that we have observed and have seen corroborated by numerous\nreports issued by various intelligence organizations — indicating state-sponsored actors are\ntargeting routers and firewalls globally. We have [spoken about infrastructure security for a](https://blogs.cisco.com/security/the-time-is-now-for-organizations-to-address-their-aging-infrastructure)\nlong time. However, while working with network infrastructure in various parts of the world,\nwe have observed both espionage and obvious targeting to support future destructive\nattacks. While working with our partners, we have experienced the operational barriers that\nslow and sometimes stop security teams from properly securing network infrastructure. In\n\n\n-----\n\nthis report, we are sharing both our observations of top-tier attackers and their activities on\nnetwork devices, and recommendations and resources to help you improve your network\ninfrastructure resilience.\n\n## Background\n\nRecently, the UK’s National Cyber Security Centre (NCSC) released a report on a sustained\ncampaign by a Russian intelligence agency targeting a vulnerability in routers that Cisco\nhad published a patch for in 2017. This campaign, dubbed \"Jaguar Tooth,\" is an example of\na much broader trend of sophisticated adversaries targeting networking infrastructure to\nadvance espionage objectives or pre-position for future destructive activity. While\ninfrastructure of all types has been observed under attack, attackers have been particularly\nsuccessful in compromising infrastructure with out-of-date software.\n\nBecause of the large presence of Cisco network infrastructure around the world, any\nsustained attack against network infrastructure would likely target Cisco equipment, but\nattacks are by no means limited to Cisco hardware. In reporting on Russian intelligence\ncontracting documents, samples of which were recently shared with Cisco Talos, it was\nshown that any infrastructure brand would be targeted, with one scanning component\ntargeting almost 20 different router and switch manufacturers (see the image below).\n[Looking at past research, in 2018 Talos looked into the VPNFilter threat, also believed to be](https://blog.talosintelligence.com/vpnfilter/)\nof Russian origin, which showed a well-developed capability targeting Asus, Huawei,\nLinksys, MikroTik, Netgear, QNAP, TP-LINK, Ubiquiti, and Upvel devices.\n\n[Russia is not alone in its actions. CISA has reported on Chinese adversaries targeting](https://www.cisa.gov/news-events/cybersecurity-advisories/aa22-158a)\nnetwork equipment from a similarly broad set of manufacturers. These are certainly not the\nonly campaigns targeting network equipment, nor the only actors. It is reasonable to\n[conclude that any sufficiently capable national intelligence operation would develop and use](https://blogs.cisco.com/security/shadow-brokers)\nthe capability to compromise the communications infrastructure of their preferred targets.\n\nTalos investigations are consistent with these findings. We have observed traffic\nmanipulation, traffic copying, hidden configurations, router malware, infrastructure\nreconnaissance and active weakening of defenses by adversaries operating on networking\nequipment. Given the variety of activities we have seen adversaries engage in, they have\nshown a very high level of comfort and expertise working within the confines of\ncompromised networking equipment.\n\n\n-----\n\nOur assessment is clear, that national intelligence agencies and state-sponsored actors\nacross the globe have attacked network infrastructure as a target of primary preference.\nRoute/switch devices are stable, infrequently examined from a security perspective, are\noften poorly patched and provide deep network visibility. They are the perfect target for an\nadversary looking to be both quiet and have access to important intelligence capability as\nwell as a foothold in a preferred network.\n\n## Campaign observations\n\nWe’d like to share a non-exhaustive list of the sorts of activities we have observed actors\ntake on various infrastructure devices. Our analysis for this set of actors is that they were\n(depending on the incident) either engaging in espionage or establishing a foothold for\nfollow-on actions in support of any number of strategic goals, which may include destructive\nattacks. While these activities span several different incidents and campaigns, they\ndemonstrate the technical capability of the actor. So, in brief, we have seen the following\nactor behaviors across different infrastructure platforms at critical infrastructure facilities:\n\nThe creation of Generic Router Encapsulation (GRE) tunnels and the hijacking of\nDNS traffic, giving the actor the ability to observe and control DNS resolution\nModifying memory to reintroduce vulnerabilities that had been patched so the actor\nhas a secondary path to access\nModification of configurations to move the compromised device into a compromised\nstate to allow the actor to execute additional exploits to further access\nInstallation of malicious software into an infrastructure device that provides additional\ncapabilities to the actor, including:\n\nMasking of certain configurations so that they can’t be shown by normal\ncommands\nBypassing of ACLs so that traffic can’t be blocked properly by the router\nAllowing for authenticated access to devices outside of the normal SSH/Telnet\nmethods\nModular design allowing for easy updating as new capabilities are needed or\ndeveloped\nCapability to corrupt and disable the infrastructure device\nRedirection of actor-defined traffic to actor-controlled infrastructure\nCreation of hub-and-spoke VPNs designed to allow the siphoning of targeted traffic\nfrom network segments of interest through the VPN\nThe capture of network traffic for future retrieval, frequently limited to specific IPs or\nprotocols\nA variety of logic to allow network packets to enable and disable certain capabilities\nThe use of infrastructure devices to deliver attacks or maintain C2 in various\ncampaigns\n\n\n-----\n\nAdditionally, we have seen traditional enterprise attacks explicitly targeting the\nenvironments that support infrastructure devices such as TACACS+ servers, enterprise\nmanagement servers and jump hosts. Further, we have seen espionage activity on\nenterprise networks specifically searching for network data such as credentials, network\ndiagrams, contracts with network customers and configuration information.\n\nIn short, there are extremely sophisticated actors who are increasingly targeting network\ninfrastructure devices from a variety of manufacturers. We are concerned that insufficient\nawareness and patching, the reliance on end-of-life equipment and the necessity for\nalways-on connectivity makes too many infrastructure devices easy prey. The results of\nthese issues range from being an unwitting participant in criminal activity to events of true\nnational security impact.\n\n## Guard the creds\n\nThe Jaguar Tooth attacks are actually a sequence of attacks, the first looks for poorly\nselected SNMP community strings. Once a community string is found, the attacker exploits\nCVE-2017-6742, which was first announced on June 29, 2017, after which a software patch\nwas made available to all customers. But even unpatched, a well-selected SNMP\ncommunity string stops this attack in its tracks. It should also be noted that if you are not\nusing SNMP v3, even well-chosen credentials are transmitted in the clear, and are subject\nto capture. [NETCONF (Network Configuration Protocol) and RESTCONF are modern](https://community.cisco.com/t5/security-knowledge-base/security-comparison-between-netconf-restconf-and-snmp/ta-p/4805483)\nnetwork management protocols designed to offer better security and functionality than their\nolder counterpart, SNMP. NETCONF typically runs over SSH, while RESTCONF runs over\nHTTPS. Both SSH and HTTPS provide strong encryption and secure authentication\nmechanisms, ensuring the confidentiality, integrity, and authenticity of the data being\nexchanged. SNMP, particularly its older versions (v1 and v2c), lacks proper encryption and\nauthentication, which makes it more vulnerable to cyber attacks.\n\nIn other incidents, we have observed well-positioned adversaries with preexisting access to\ninternal environments targeting TACACS+/RADIUS servers to obtain credentials. This gives\nthem the benefit of understanding the controls enforced by the credential server, as well as\nallowing their traffic to look “normal” by using jump servers and employing other techniques\nthat a typical network administrator would use.\n\nMany of the exploits we’ve seen used in the wild are post-compromise exploits, meaning\nthe attacker had some form of credential to get them to the place where they could then\nlaunch the exploit and get deeper access to the device. Our recommendations are to select\ncomplex passwords and community strings, to utilize multifactor authentication where\npossible, to require encryption when configuring and monitoring devices and to lockdown\nand aggressively monitor credential systems like TACACS+ and any jump hosts.\n\n## Stay modern, stay real\n\n\n-----\n\nNetwork infrastructure is built to last, and in today’s always-on world, it’s sometimes\nimpossible to find a patch window. But recent reports – and our own investigations – show\nthat it is critical to update both the hardware and the software that runs your network. This is\ntrue not just because patching eliminates known vulnerabilities, but upgrades also introduce\nnew security capabilities and controls that weren’t previously available.\n\nCisco has introduced a number of technologies and protocols over time that has improved\nthe security of its products. Some of these advances can be obtained by software upgrade,\nwhile others require more modern networking equipment. For example, in order to combat\ncertain supply chain attacks, Cisco has introduced a series of technologies. These\ntechnologies include hardware improvements such as the Trust Anchor Module and\nsoftware changes like Secure Boot. Organizations that fail to update their hardware and\nsoftware will both be more likely to be a victim of unpatched security vulnerabilities but also\nwill have fewer tools to combat adversaries. Cisco customers can check their version of\n[software to see if any known vulnerabilities exist in it here. You can learn more about Cisco](https://sec.cloudapps.cisco.com/security/center/softwarechecker.x)\n[Trustworthy Technologies here. Several related resources, tools, and services can be found](https://www.cisco.com/c/dam/en_us/about/doing_business/trust-center/docs/trustworthy-technologies-datasheet.pdf)\nat The Trust Center [here.](https://www.cisco.com/c/en/us/about/trust-center/network-resilience.html)\n\n## Know your world and enforce it\n\nAn organization that both understands the configurations that it is running and monitors for\ndepartures from that understanding have a high probability of discovering adversaries early\nin the campaign. For example, an unauthorized GRE tunnel or static VPN, discovered by\nNetFlow analysis, would be grounds for an investigation. Additionally, monitoring for\nconnections to edge routers from unknown external IPs would also uncover some of the\nactivity that we’ve observed. Even basic configuration monitoring and alerting on\nmodifications would help in many cases.\n\nAuthentication, authorization, and accounting (AAA) tools are another area where policy\nenforcement can be useful. We’ve seen actors take unusual action on routers that would\nshow up in AAA logs and ideally could be denied by the correct AAA configuration. One\nexample would be attempts to suppress logging by issuing “no aaa accounting”\nconfiguration commands. Attempts to disable any feature of AAA should be both logged\nand denied by the AAA system.\n\nAsking organizations to monitor their environment for unusual changes in behavior or\nconfigurations is one of the hardest recommendations we are making. It will take a\ncombination of a well-documented network infrastructure environment, network engineering\nand talented security operations to build a monitoring environment tuned to your\nimplementation. While there are many technologies to support you, the excellence in your\nnetwork engineering and security team, and their willingness to collaborate, will be a large\nfactor in whether or not you are successful.\n\n\n-----\n\n## If you need us, call us\n\nResponding to incidents involving specialized hardware can be challenging. If you suspect\nthat a Cisco product has been compromised, please reach out to TAC for assistance. If you\nsuspect there is a vulnerability in a Cisco product, please reach out to PSIRT. You can find\n[out how to contact TAC for general questions here. To report or obtain support for a](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#gsrq)\nsuspected vulnerability, you can contact Cisco’s PSIRT [here.](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#gsrq:~:text=products%20and%20networks.-,Reporting%20or%20Obtaining%20Support%20for%20a%20Suspected%20Security%20Vulnerability,-Individuals%20or%20organizations)\n\n### TL; DR recommendations\n\nSelect complex passwords and community strings, avoid default credentials\nUse multi-factor authentication\nEncrypt all monitoring and configuration traffic (SNMPv3, HTTPS, SSH, NETCONF,\nRESTCONF)\nLockdown and aggressively monitor credential systems like TACACS+ and any jump\nhosts\nDo not run end-of-life hardware and software\nMaintain current software\nUtilize AAA to deny configuration changes of key protections\nMonitor syslog and AAA logs for unusual activities\nMonitor your environment for unusual changes in behavior or configuration\nContact Cisco TAC or PSIRT if you need assistance with a security incident involving\nCisco products\n\n## Conclusion\n\nIf your network isn’t secure, then nothing on that network can be properly secured. We\nknow that there is a myriad of operational realities that make it difficult to maintain a fully\ndefensible network infrastructure. However, given the risks and outcomes that compromised\nnetwork infrastructure bring, these obstacles must be overcome for organizations to truly\nsecure their environment. Regardless of the context, aging infrastructure is a risk. Relying\non out-of-date gear or utilizing out-of-date protocols and technologies will eventually cost\nyour organization. Work with your vendor to give yourself the best chance of defending your\nenvironment.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-04-18 - State-sponsored campaigns target global network infrastructure.pdf"
    ],
    "report_names": [
        "2023-04-18 - State-sponsored campaigns target global network infrastructure.pdf"
    ],
    "threat_actors": [
        {
            "id": "d4f7cf97-9c98-409c-8b95-b80d14c576a5",
            "created_at": "2022-10-25T16:07:24.561104Z",
            "updated_at": "2025-03-27T02:02:10.281202Z",
            "deleted_at": null,
            "main_name": "Shadow Brokers",
            "aliases": [],
            "source_name": "ETDA:Shadow Brokers",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "171b85f2-8f6f-46c0-92e0-c591f61ea167",
            "created_at": "2023-01-06T13:46:38.830188Z",
            "updated_at": "2025-03-27T02:00:02.929729Z",
            "deleted_at": null,
            "main_name": "The Shadow Brokers",
            "aliases": [
                "Shadow Brokers",
                "ShadowBrokers",
                "The ShadowBrokers",
                "TSB"
            ],
            "source_name": "MISPGALAXY:The Shadow Brokers",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1683338927,
    "ts_updated_at": 1743041507,
    "ts_creation_date": 1683252107,
    "ts_modification_date": 1683252107,
    "files": {
        "pdf": "https://archive.orkl.eu/5c41ac80d56ea6ab130e9663219562bba12251fa.pdf",
        "text": "https://archive.orkl.eu/5c41ac80d56ea6ab130e9663219562bba12251fa.txt",
        "img": "https://archive.orkl.eu/5c41ac80d56ea6ab130e9663219562bba12251fa.jpg"
    }
}