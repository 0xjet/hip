{
    "id": "651913c1-e52d-49e6-809d-443ae5319b26",
    "created_at": "2024-04-16T02:06:37.996897Z",
    "updated_at": "2025-03-27T02:05:33.718466Z",
    "deleted_at": null,
    "sha1_hash": "1c99f1edf810b6d7ff41671c3c8eef0fea32519b",
    "title": "Uncovering a broad criminal ecosystem powered by one of the largest botnets, Glupteba",
    "authors": "",
    "file_creation_date": "2022-09-19T17:01:24Z",
    "file_modification_date": "2022-09-24T12:28:16Z",
    "file_size": 3171501,
    "plain_text": "**28 - 30 September, 2022 / Prague, Czech Republic**\n\n## Luca Nagy\n\n### Google, Switzerland\n\n#### lucanagy@google.com\n\n\n# UNCOVERING A BROAD CRIMINAL\n\n\n# ECOSYSTEM POWERED BY ONE OF THE LARGEST BOTNETS, GLUPTEBA\n\n\n**www virusbulletin com**\n\n\n-----\n\n**ABSTRACT**\n\nBotnets continue to represent a serious threat for companies and individuals worldwide. However, little is known about\nexactly how botnets are monetized and how revenues flow to criminal actors. Our research uncovers a whole criminal\nnetwork of organizations behind a one-million-sized botnet, named Glupteba.\n\nThe Glupteba botnet rose to our attention after being downloaded tens of thousands of times per day through traffic\ndistributors and pay-per-install networks. The botnet is known to steal user credentials and cookies from infected hosts,\nmine cryptocurrencies, and deploy and operate proxy components. Given the botnet’s size, its technical sophistication and\nthe wide range of functionality it provides, we decided to map out the ecosystem and try to understand the incentives and\nfunctioning of this underground economy in order to be better able to disrupt it and to build better defences in the future.\nOur investigation led us to uncover a complex ecosystem formed by the botnet, its operators and victims, and the customers\nof the various illicit services provided by the botnet. For instance, a cookie theft service aimed at abusing advertising\nnetworks including Google, Facebook and Twitter (dont[.]farm), a proxy provider giving botnet customers the ability to\nproxy traffic through victim machines (AWMProxy), and a service that sells credit card numbers to be used for malicious\nactivities such as purchasing malicious ads or conducting payment fraud (extracard). The Glupteba ecosystem is one of the\nmost complex we have witnessed that also supports multiple platforms. We have identified and analysed multiple\ncomponents used by the Glupteba actors. We will share details of many of them, including proxy and ad fraud components\nrunning on Windows and IoT devices. Our year-long study of this broad ecosystem led to novel findings and attributions\nthat led to disruption and legal actions being taken against the Glupteba operators.\n\n**INTRODUCTION**\n\nGlupteba was first spotted in the wild in 2011. We have observed the botnet targeting victims worldwide, including in the\nUS, India, Brazil, Vietnam and Southeast Asia.\n\nThe Glupteba malware family is distributed primarily through pay-per-install (PPI) networks and via traffic purchased from\ntraffic distribution systems (TDS). For a period of time, we observed thousands of instances of malicious Glupteba\ndownloads per day and estimated around one million infected machines. Figure 1 shows a web page mimicking a software\ncrack download which delivers a variant of Glupteba to users instead of the promised software.\n\n_Figure 1: Example of a cracked software download site distributing Glupteba._\n\n**C APABILITIES OF GLUPTEBA**\n\nThe Glupteba dropper is known for using the blockchain for updating its C2 domains. When the main C2 servers do not\nrespond, infected systems can retrieve backup domains encrypted in the latest transaction from Bitcoin wallet addresses that\nare hard coded in the binaries. Glupteba also acts as a rootkit by dropping vulnerable kernel drivers in order to hide itself\nfrom different kernel structures. Glupteba can spread on the local network by using EternalBlue, and the dropper is capable\n\n\n-----\n\nof backdooring the infected machine. Based on dynamic analysis we observed many components dropped by the dropper.\nThe most frequent are the proxy components, router exploiters, browser stealers and miners. Additionally, even in low\nvolume, we observed some side-loaded Android samples of Glupteba downloaded from third-party APK downloader sites.\n\n**A CTORS**\n\nWhile analysing Glupteba binaries, we identified a few containing a git repository URL: git.voltronwork.com. This finding\nsparked an investigation that led us to identify, with high confidence, the individuals operating the Glupteba botnet.\nVoltronwork, or Voltron, is a Russia-based developer company using git.voltronwork.com and gitlamp.com for developing\ndifferent components of Glupteba. We found these git domains in some droppers as well. These git repositories led us to\nfind the Android variants.\n\n_Figure 2: Hard-coded git URIs in Glupteba binaries._\n\n**SE RVICES**\n\nIn investigating the registered companies associated with Voltronwork we observed a service, named trapspin.com, which is\nsupported by Prestige-Media, Valtron LLC and Investavto LLC. These companies led us to find more services belonging to\nthese entities, such as AWMProxy and dont[.]farm.\n\n_Figure 3: Contact page of trafspin.com._\n\n**AWMProxy**\n\nAWMProxy is a residential proxy provider. To access the proxy pool, the customer has to configure their device with a\ngiven IP and port number which points to the gateway server. The Glupteba tunnelled proxy is installed on the victim\nmachine and it registers the bot to the server via a DNS request, such as:\n\n\n-----\n\n808f38e3-d84b-45c8-b461-2a4c006a0f4a.server-3.easywbdesign.com\n\nWe observed that these gateway IP addresses overlapped with the Glupteba tunnelled proxy’s C2 IPs.\n\nThis overlap suggests to us that the actors behind Glupteba are developing AWMProxy, leveraging the proxy capabilities of\nthe Glupteba botnet.\n\n_Figure 4: AWMProxy and Glupteba._\n\n**Traf spin**\n\nTrafspin.com is a real-time bidding advertising network that sells disruptive in-app advertising on Android and web traffic\nthrough the botnet’s proxy connections to mobile devices infected by the Glupteba malware. The Android variants of\nGlupteba that we discovered through the hard-coded gitlamp.com git URIs in old ELF proxy modules led us to find\nGlupteba APKs which were acting in a very similar way to the Glupteba desktop variant. They had an interesting method of\nshowing advertisements in a disruptive way: the ‘close’ button of the shown advertisement was hidden. We caught a\nconfiguration response from 2018 using the trafspin.com domain which suggested to us that the Android Ads module uses\nthe trafspin advertisement network. The APK’s network response from the C2 was as follows:\n\n_[{\"command\":\"showDialog\",\"payload\":{\"arg\":\"{\\\"link\\\":true,\\\"advanced_webview\\\":true,\\\"can__\n_close\\\":true,\\\"block_back\\\":false,\\\"click_url\\\":\\\"http://domainforwork.com/ads/_\n_click?id=7132411\\\",\\\"content\\\":\\\"https://click.trafspin.com/ads/view-url?id=xxx&url=..._\n\n_Figure 5: RTB advertising network and Glupteba._\n\n\n-----\n\n**Dont[.]farm**\n\nDont[.]farm is an ads account service. It sells access to users’ accounts with Google and other online platforms. The\noperator loads stolen credentials and cookies of the stolen accounts to virtual machines, to which they sell access. On their\nwebsite, the operators claimed that they support blackhat advertisements for Google Ads. They also claimed that they\nprovide a proxy pointing to the same geolocation as the hijacked user’s location. It is likely that the service uses the\nGlupteba infected machines for proxying in the same way as AWMProxy, and the accounts are hijacked by the Glupteba\nbrowser stealer module.\n\n_Figure 6: Dont[.]farm offers Google Ads accounts._\n\n_Figure 7: Dont[.]farm infrastructure._\n\n**ECOSYST EM**\n\nBased on our research we discovered the actors behind Glupteba developing the different components. We learned that the\nGlupteba actors provide other services which are leveraged on Glupteba’s capabilities. We found evidence for connections\nbetween different components of Glupteba and the services, such as AWMProxy, Trafspin and dont[.]farm. These led us to\nthe conclusion that Glupteba is monetized by these services, and helped in disrupting the botnet.\n\n\n-----\n\n_Figure 8: Ecosystem._\n\n**DISRUPTI ON**\n\nSince 2021, multiple teams at Google have coordinated their efforts to disrupt Glupteba activity. The company terminated\naround 63 million Google Docs observed to have distributed Glupteba, 1,183 Google Accounts, 908 Cloud Projects and\n870 Google Ads accounts associated with their distribution. Furthermore, 3.5 million users were warned before\ndownloading a malicious file through Google Safe Browsing warnings.\n\nIn December 2021, TAG partnered with Internet infrastructure providers and hosting providers, including CloudFlare, to\ndisrupt Glupteba’s operation by taking down servers and placing interstitial warning pages in front of the malicious domain\nnames. During this time, an additional 130 Google accounts associated with this operation were terminated. In parallel with\nthe analysis, tracking and technical disruption of this botnet, Google has filed a lawsuit against two individuals believed to\nbe located in Russia for operating the Glupteba botnet and its various criminal schemes.\n\nSince then we have seen a significant decrease in the size of the botnet. However, technically, the operators of Glupteba are\nstill able to attempt to regain control of the botnet using a backup command-and-control mechanism that uses data encoded\non the Bitcoin blockchain.\n\n**ACKNOWLE DGEMENT**\n\nWould like to thank all individuals and teams involved, both within Google and externally.\n\n**REFERENC ES**\n\n[1] [Huntley, S.; Nagy, L. Disrupting the Glupteba operation. Google Updates from Threat Analysis Group (TAG).](https://blog.google/threat-analysis-group/disrupting-glupteba-operation/)\nDecember 2021. https://blog.google/threat-analysis-group/disrupting-glupteba-operation/.\n\n[2] [Hansen, R.; DeLaine Prado, H. New action to combat cyber crime. Google. The Keyword. December 2021.](https://blog.google/technology/safety-security/new-action-combat-cyber-crime/)\nhttps://blog.google/technology/safety-security/new-action-combat-cyber-crime/.\n\n[3] [Google LLC v. Dmitry Starovikov, et al. https://storage.googleapis.com/gweb-uniblog-publish-prod/documents/1_](https://storage.googleapis.com/gweb-uniblog-publish-prod/documents/1_Complaint.pdf)\nComplaint.pdf.\n\n[4] Nagy, L. Glupteba: Hidden Malware Delivery in Plain Sight. Sophos. June 2020. https://news.sophos.com/\nwp-content/uploads/2020/06/glupteba_final-1.pdf.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.virusbulletin.com/uploads/pdf/conference/vb2022/papers/VB2022-Uncovering-a-broad-criminal-ecosystem-powered-by-one-of-the-largest-botnets-Glupteba.pdf"
    ],
    "report_names": [
        "VB2022-Uncovering-a-broad-criminal-ecosystem-powered-by-one-of-the-largest-botnets-Glupteba.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1713233197,
    "ts_updated_at": 1743041133,
    "ts_creation_date": 1663606884,
    "ts_modification_date": 1664022496,
    "files": {
        "pdf": "https://archive.orkl.eu/1c99f1edf810b6d7ff41671c3c8eef0fea32519b.pdf",
        "text": "https://archive.orkl.eu/1c99f1edf810b6d7ff41671c3c8eef0fea32519b.txt",
        "img": "https://archive.orkl.eu/1c99f1edf810b6d7ff41671c3c8eef0fea32519b.jpg"
    }
}