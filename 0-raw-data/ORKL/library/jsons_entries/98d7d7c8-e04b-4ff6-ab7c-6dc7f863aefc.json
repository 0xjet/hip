{
    "id": "98d7d7c8-e04b-4ff6-ab7c-6dc7f863aefc",
    "created_at": "2023-01-12T15:05:25.721091Z",
    "updated_at": "2025-03-27T02:05:50.772542Z",
    "deleted_at": null,
    "sha1_hash": "151ad5e2d940b9ce21c24fd3a4291ecb83f6b943",
    "title": "2020-05-07 - Ursnif beacon decryptor",
    "authors": "",
    "file_creation_date": "2022-05-28T15:18:37Z",
    "file_modification_date": "2022-05-28T15:18:37Z",
    "file_size": 194600,
    "plain_text": "# Ursnif beacon decryptor\n\n**github.com/mlodic/ursnif_beacon_decryptor**\n\nmlodic\n\nUrsnif v.3 aka Dreambot/Gozi/ISFB\n\nThis is a simple script that could be used to:\n\ncheck if a suspicious URL is correlated to Ursnif activity\ndecrypt the URL check-in on the fly to get the data sent to the C2 server\n\n**Usage:**\n```\npython3 ursnif_beacon_decryptor.py -u <url> -k <key>\n\n```\nA different version inserts the encrypted path as data of a POST request.\n\nIn case, use the option `-o instead of` `-u`\n\n**Example:**\n\nInput:\n```\npython3 ursnif_beacon_decryptor.py -u\n\"http://qjdyugisselle.club/images/NM_2Ff8mqmMQjmr/c842xf8TIJp_2FlmC5/Ulz244kFh/KMjQpHV\n -k \"10291029JSJUYNHG\"\n\n```\nOutput:\n\n\n-----\n\n```\n[2019 04 15 11:24:25 INFO] c2 domain: qjdyugisselle.club \n[2019-04-15 11:24:25 - INFO] path to analyze:\n/images/NM_2Ff8mqmMQjmr/c842xf8TIJp_2FlmC5/Ulz244kFh/KMjQpHVvOnBhk6eOvBBW/R_2FCf2Bk9wZ\n[2019-04-15 11:24:25 - INFO] Congrats! decoded data:\nfjidtflrb=bdaxhhfg&soft=3&version=217173&user=a618b5f78c4ff30be60d08c7ba561278&server=\n\n```\nParams:\n\nfjidtflrb -> junk param, always present at the start of the uri to generate randomness\n(and always different)\nsoft -> major version\nversion -> minor version\nuser -> unique user id\nserver -> unique c2 server id\nid -> bot group id\ncrc -> payload to retrieve (1-DLL32b, 2-DLL64b, 3-ps1)\nuptime -> time elapsed from initial infection (seconds)\n\nDifferent versions could have more parametres. Example: `hash time action os system`\n```\ntor\n\n```\n**Requirements**\n\nPython3\ncryptopp library (libcrypto++6 debian repo)\n\nIf you run a Linux environment, you can just run the python script that will load `Driver.so`\nthat is needed to perform decryption.\n\nIf you run a Windows OS, you should re-compile `Driver.cpp and change the library`\nloaded with the new one.\n\n**Additional info**\n\nThe script needs the key that the malware uses for encryption.\n\nSome reverse engineering is required to get that info.\n\nHowever, observations led to the fact that the key is usually shared among a lot of samples\nand rarely changed.\n\nIf you don't have one, you could just run the script that would try our predefined keys that we\nsaw the malware used in the wild\n\n## Welcome to:\n\n\n-----\n\ntips on observed different behaviours of the malware\ndecryption for other phases of the communication with the C2 infrastructure\neverything that can help to fight this threat\n\nTwitter: [https://twitter.com/matte_lodi](https://twitter.com/matte_lodi)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-05-07 - Ursnif beacon decryptor.pdf"
    ],
    "report_names": [
        "2020-05-07 - Ursnif beacon decryptor.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535925,
    "ts_updated_at": 1743041150,
    "ts_creation_date": 1653751117,
    "ts_modification_date": 1653751117,
    "files": {
        "pdf": "https://archive.orkl.eu/151ad5e2d940b9ce21c24fd3a4291ecb83f6b943.pdf",
        "text": "https://archive.orkl.eu/151ad5e2d940b9ce21c24fd3a4291ecb83f6b943.txt",
        "img": "https://archive.orkl.eu/151ad5e2d940b9ce21c24fd3a4291ecb83f6b943.jpg"
    }
}