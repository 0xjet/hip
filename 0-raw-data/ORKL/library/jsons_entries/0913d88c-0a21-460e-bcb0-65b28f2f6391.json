{
    "id": "0913d88c-0a21-460e-bcb0-65b28f2f6391",
    "created_at": "2023-01-12T15:05:27.413557Z",
    "updated_at": "2025-03-27T02:15:41.787193Z",
    "deleted_at": null,
    "sha1_hash": "cdaf30beb19ee745f1cc6645e71733ae61f9e2d7",
    "title": "2020-05-13 - Ramsay- A cyber‑espionage toolkit tailored for air‑gapped networks",
    "authors": "",
    "file_creation_date": "2022-05-28T19:05:08Z",
    "file_modification_date": "2022-05-28T19:05:08Z",
    "file_size": 944825,
    "plain_text": "# Ramsay: A cyber‑espionage toolkit tailored for air‑gapped networks\n\n**welivesecurity.com/2020/05/13/ramsay-cyberespionage-toolkit-airgapped-networks/**\n\nMay 13, 2020\n\nESET researchers uncover several instances of malware that uses various attack vectors to target systems isolated by an air gap\n\n[Ignacio Sanmillan](https://www.welivesecurity.com/author/isanmillan/)\n13 May 2020 - 11:30AM\n\nESET researchers uncover several instances of malware that uses various attack vectors to target systems isolated by an air gap\n\nESET researchers have discovered a previously unreported cyber-espionage framework that we named Ramsay and that is tailored\nfor collection and exfiltration of sensitive documents and is capable of operating within air‑gapped networks.\n\nWe initially found an instance of Ramsay in VirusTotal. That sample was uploaded from Japan and led us to the discovery of further\ncomponents and versions of the framework, along with substantial evidence to conclude that this framework is at a developmental\nstage, with its delivery vectors still undergoing fine-tuning.\n\nThe current visibility of targets is low; based on ESET’s telemetry, few victims have been discovered to date. We believe this scarcity\nof victims reinforces the hypothesis that this framework is under an ongoing development process, although the low visibility of victims\ncould also be due to the nature of targeted systems being in air‑gapped networks.\n\n[Shared artifacts were found alongside the Retro backdoor. This malware has been associated with Darkhotel, a notorious APT group](https://blog.360totalsecurity.com/en/analysis-cve-2018-8174-vbscript-0day-apt-actor-related-office-targeted-attack/)\n[known to have conducted cyber-espionage operations since at least 2004, having targeted government entities in China and](https://blogs.360.cn/post/apt-c-06_0day.html) [Japan in](https://blogs.jpcert.or.jp/en/2020/04/ie-firefox-0day.html)\nthe past.\n\n## Attack vectors\n\nAlong with the discovery of the different instances of Ramsay, we found they were leveraged using a series of attack vectors. These\nare:\n\n\n-----\n\n_Figure 1. Overview of discovered Ramsay versions_\n\n### Malicious documents dropping Ramsay version 1\n\n[This attack vector consists of malicious documents exploiting CVE-2017-0199 intended to drop an older version of Ramsay.](https://www.cvedetails.com/cve/CVE-2017-0199/)\n\nThis document delivers an initial Visual Basic Script, shown in the screenshot below as OfficeTemporary.sct, that will extract within the\ndocument’s body the Ramsay agent, masquerading as a JPG image by having a base64-encoded PE under a JPG header.\n\n**ID** **Index** **OLE Object**\n\n0 0x80c8 Format_id: 2 (Embedded)\n\nClass name: ‘Package’\n\nData size: 8994\n\nOLE Package object:\n\nFilename: u‘OfficeTemporary.sct’\n\nSource path: u‘C:\\\\Intel\\\\OfficeTemporary.sct’\n\nTemp path = u:‘C\\\\Intel\\\\OfficeTemporary.sct’\n\nMD5 = ‘cf133c06180f130c471c95b3a4ebd7a5’\n\nEXECUTABLE FILE\n\n1 0xc798 Format_id: 2 (Embedded)\n\nClass name: ‘OLE2Link’\n\nData size: 2560\n\nMD5 = ‘daee337d42fba92badbea2a4e085f73f’\n\nCLSID: 00000300-0000-0000-C000-000000000046\n\nStdOleLink (embedded OLE object - known related to CVE-2017-0199, CVE-2017-8570, CVE-2017-8759 or CVE2018-8174.\n\nPossibly an exploit for the OLE2Link vulnerability (VU#921560, CVE-2017-0199)\n\n_Table 1. OLE object layout contained within Ramsay version 1 RTF file as seen by oletools_\n\n\n-----\n\nWe noticed that the specific Ramsay instance dropped by these documents showed low complexity in its implementation and lacked\nmany of the more advanced features seen leveraged by later Ramsay versions.\n\nSeveral instances of these same malicious documents were found uploaded to public sandbox engines, labeled as testing artifacts\nsuch as ‘access_test.docx’ or ‘Test.docx’ denoting an ongoing effort for trial of this specific attack vector.\n\nBased on the low complexity of the Ramsay agent delivered, the threat actors may be embedding this specific instance within these\nmalicious documents for evaluation purposes.\n\n### Decoy installer dropping Ramsay version 2.a\n\nWe found one instance uploaded to VirusTotal of Ramsay masquerading as a 7zip installer.\n\nThe reason we named this malware Ramsay was due to some of the strings contained in this binary, such as the following:\n\n_Figure 2. Strings containing “Ramsay”_\n\nThis version of Ramsay shows a clear refinement of its evasion and persistence tactics along with the introduction of new features\nsuch as a Spreader component and a rootkit; the Spreader component is documented more thoroughly in this part of the Capabilities\nsection.\n\n### Malicious documents dropping Ramsay version 2.b\n\n[This attack vector consists of the delivery of a different malicious document abusing CVE-2017-11882. This document will drop a](https://www.cvedetails.com/cve/CVE-2017-11882/)\nRamsay Installer named lmsch.exe as shown in Table 2.\n\n**ID** **Index** **OLE Object**\n\n0 0x80c8 Format_id: 2 (Embedded)\n\nClass name: ‘Package’\n\nData size: 644790\n\nOLE Package object:\n\nFilename: u‘lmsch.exe’\n\nSource path: u‘C:\\\\fakepath\\\\lmsch.exe’\n\nTemp path = u:‘C:\\\\fakepath\\\\lmsch.exe’\n\nMD5 = ‘27cd5b330a93d891bdcbd08050a5a6e1’\n\n\n-----\n\n**ID** **Index** **OLE Object**\n\n1 0xc798 Format_id: 2 (Embedded)\n\nClass name: ‘Equation.3’\n\nData size: 3584\n\nMD5 = ‘5ae434c951b106d63d79c98b1a95e99d’\n\nCLSID: 0002CE02-0000-0000-C000-000000000046\n\nMicrosoft Equation 3.0 (Known related to CVE-2017-11882 or CVE-2018-0802)\n\nPossibly an exploit for the Equation Editor vulnerability (VU#421280, CVE-2017-11882)\n\n_Table 2. OLE object layout contained within Ramsay version 2.b RTF file as seen by oletools_\n\nThe Ramsay version leveraged by this document is a slightly modified version of Ramsay version 2.a, with the main difference of not\nleveraging the spreader component. The functionality of the remaining components is the same in regard to Ramsay version 2.a.\n\n### Client Execution of Infected Files\n\nAs previously mentioned, Ramsay Version 2.a delivers a Spreader component that will behave as a file infector, changing the structure\nof benign PE executable files held within removable and network shared drives in order to embed malicious Ramsay artifacts triggered\non host file execution.\n\nThe Spreader is highly aggressive in its propagation mechanism and any PE executables residing in the targeted drives would be\ncandidates for infection.\n\nBased on compilation timestamps among the components of the various versions of Ramsay found, we can estimate the following\ndevelopment timeline of this framework:\n\n_Figure 3. Estimation of Ramsay’s development timeline_\n\n\n-----\n\nThe analysis of the different compilation timestamps found across different components implies that this framework has been under\ndevelopment since late 2019, with the possibility of currently having two maintained versions tailored based on the configuration of\ndifferent targets.\n\n## Persistence mechanisms\n\nBased on its version, Ramsay implements various persistence mechanisms of different complexity. Some of these persistence\nmechanisms are the following:\n\n**AppInit DLL registry key**\n\nThe Windows operating system provides the functionality to allow custom DLLs to be loaded into the address space of almost all\napplication processes via AppInit DLL registry key. This technique is not particularly complex; it is implemented in early Ramsay\nversions and is common in other malware families.\n\n**Scheduled Task via COM API**\n\nScheduled tasks enable administrators to run tasks or “jobs” at designated times rather than every time the system is booted or the\nuser logs in. This feature can be implemented via the Windows COM API, which the first versions of Ramsay have tailored. Based on\n[the high ratio of similarity with Carberp’s implementation, it’s highly probable that Ramsay’s implementation was adapted from](https://raw.githubusercontent.com/hzeroo/Carberp/master/source%20-%20absource/pro/all%20source/schtasks/schtasks.cpp)\nCarberp’s publicly available source code.\n\n**Phantom DLL Hijacking**\n\nMore mature versions of Ramsay denote an increase in complexity of its persistence techniques, which include a technique\nsometimes referred to as “Phantom DLL Hijacking”.\n\nPhantom DLL Hijacking abuses the fact that many Windows applications use outdated dependencies not strictly necessary for the\nfunctionality of the application itself, allowing the possibility of leveraging malicious versions of these dependencies.\n\nTwo services will be targeted in order to enforce this technique. These are:\n\nWSearch (Windows Search) hijacking msfte.dll:\n\n\n-----\n\n_Figure 4. Hijacking of Microsoft Search Service msfte.dll_\n\nMSDTC (Microsoft Distributed Transaction Coordinator) service hijacking an oracle dependency seen below as oci.dll:\n\n_Figure 5. Hijacking of MSDTC service dependency oci.dll_\n\nThis persistence technique is highly versatile, enabling Ramsay agents delivered as DLLs to fragment their logic into separated\nsections, implementing different functionality tailored for the subject processes where the agent will be loaded. In addition, the use of\nthis technique makes detection more difficult since the loading of these DLLs into their respective processes/services won’t\nnecessarily trigger an alert.\n\n## Capabilities\n\n\n-----\n\nRamsay s architecture provides a series of capabilities monitored via a logging mechanism intended to assist operators by supplying a\nfeed of actionable intelligence to conduct exfiltration, control, and lateral movement actions, as well as providing overall behavioral and\nsystem statistics of each compromised system. The realization of these actions is possible due to the following capabilities:\n\n### File collection and covert storage\n\nThe primary goal of this framework is to collect all existing Microsoft Word documents within the target’s filesystem. The overall\ncollection stages are shown in Figure 6:\n\n_Figure 6. Mechanism of document collection_\n\nWord documents will first be collected and stored in a preliminary collection directory. The location of this directory may vary\ndepending on the Ramsay version. Two of the directories we observed being used for this purpose were\n%APPDATA%\\Microsoft\\UserSetting and %APPDATA%\\Microsoft\\UserSetting\\MediaCache.\n\nDepending on the Ramsay version, file collection won’t be restricted to the local system drive, but also will search additional drives\nsuch as network or removable drives:\n\n\n-----\n\n_Figure 7. Hex-Rays output of procedure to scan removable drives for collection_\n\n_Figure 8. Hex-Rays output of procedure to scan network drives for collection_\n\nCollected documents are encrypted using the RC4 Stream Cipher Algorithm.\n\nThe RC4 key used to encrypt each file will be a computed MD5 hash of a randomly generated sequence of 16 bytes, salted with 16\nbytes hardcoded in the malware sample. The first 16 bytes of the buffer where the encrypted file will be held will correspond to the\nactual RC4 key used:\n\n\n-----\n\n_Figure 9. Hex-Rays output of RC4 key generation and storage_\n\n[Collected files under the preliminary collection directory will be compressed using a WinRAR instance that the Ramsay Installer drops.](http://wintertechsolutions.weebly.com/blog/winrar)\nThis compressed archive will be saved within the preliminary collection directory and then generate a Ramsay container artifact:\n\n\n-----\n\n_Figure 10. Hex-Rays output of Ramsay container generation_\n\nAs shown in the previous screenshot, these Ramsay containers contain a magic value at the beginning of the file, along with a\nHardware Profile GUID denoting an identifier of the victim’s machine; an additional XOR-based encryption layer will be applied to the\ngenerated compressed archive. The following diagram shows the structure of these artifacts:\n\n\n-----\n\n_g_ _y_ _{_\n\nRamsay implements a decentralized way of storing these artifacts among the victim’s file system by using inline hooks applied on two\nWindows API functions, WriteFile and CloseHandle.\n\nThe hooked WriteFile procedure’s main purpose is to save the file handle of the subject file to write and install another hook in the\nCloseHandle API function. The CloseHandle hooked procedure will then check whether the subject file name has a .doc extension; if\nthat’s the case, it will then append at the end of the subject document the Ramsay container artifact followed by a stream of 1024\nbytes denoting a Microsoft Word document footer.\n\nThis is done as an evasion measure in order to provide a means to hide the embedded artifact within the subject document from the\nnaked eye:\n\n_Figure 12. Hex-Rays output of code for appending Word document footer at the end of the target document_\n\nRamsay containers appended to Word documents will be marked in order to avoid redundant artifacts being appended to already\naffected documents and the preliminary storage directory will be cleared in order to generate a brand-new Ramsay artifact in intervals.\n\nEven though affected documents will be modified, it won’t impact their integrity; each affected Word document remains fully\noperational after artifact appending has taken place.\n\nExfiltration of these artifacts is done via an external component that we haven’t been able to retrieve. However, based on the\ndecentralized methodology Ramsay implements for storage of collected artifacts, we believe this component would scan the victim’s\nfile system in search for the Ramsay container’s magic values, in order to identify the location of artifacts to exfiltrate.\n\n### Command execution\n\nUnlike most conventional malware, Ramsay does not have a network-based C&C communication protocol nor does it make any\nattempt to connect to a remote host for communication purposes. Ramsay’s control protocol follows the same decentralized\nphilosophy implemented for collected artifact storage.\n\nRamsay will scan all the network shares and removable drives (excluding A: and B: drives usually reserved for floppy disks) for\npotential control files. First, Ramsay looks for Word documents and also, in more recent versions, for PDFs and ZIP archives:\n\n\n-----\n\n_Figure 13. Hex-Rays output of Ramsay Scan procedure for Control File retrieval_\n\nThese files are parsed for the presence of a magic marker specific to the control file format. More specifically, Ramsay looks for any of\ntwo given encoded Hardware Profile GUIDs. One of these GUIDs is hardcoded as shown in Figure 14, while the other is dynamically\ngenerated based on the compromised victim’s machine. If any of the subject identifiers are found, parsing for a command signature\nwill be attempted.\n\n\n-----\n\n_Figure 14. Hex-Rays output of Ramsay Control File Parsing_\n\nThe search for these two GUID instances implies that Ramsay’s control documents can be deliberately crafted to be “victim agnostic”,\ncapable of deploying the same control document instance across a number of victims by leveraging a “global” GUID within control\ndocuments. On the other hand, control documents can be crafted by embedding a specific GUID intended to be delivered exclusively\non a single victim’s machine. This indicator of Ramsay’s control protocol implementation implies that its backend counterpart may be\nsomewhat automated.\n\nRamsay control protocol supports three different commands:\n\n**Signature** **Command**\n\nRr*e#R79m3QNU3Sy File Execution\n\nCNDkS_&pgaU#7Yg9 DLL Load\n\n2DWcdSqcv3?(XYqT Batch Execution\n\n_Table 3. Ramsay’s control commands_\n\nAfter a given command signature is retrieved, the contained artifact to execute will be extracted within the control document’s body to\nthen be restored, modifying the subject control document to its original form after command execution.\n\n### Spreading\n\nAmong the different files dropped by the latest versions of Ramsay we find a Spreader component. This executable will attempt to\nscan for network shares and removable drives excluding A: and B: drives:\n\n\n-----\n\n_Figure 15. Hex-Rays output of spreader scanning routines_\n\nIt is important to notice that there is a correlation between the target drives Ramsay scans for propagation and control document\nretrieval. This assesses the relationship between Ramsay’s spreading and control capabilities showing how Ramsay’s operators\nleverage the framework for lateral movement, denoting the likelihood that this framework has been designed to operate within airgapped networks.\n\nThe propagation technique mainly consists of file infection much like a prepender file infector in order to generate executables similar\nin structure to Ramsay’s decoy installers for every accessible PE file within the aforementioned targeted drives. The following diagram\nillustrates the changes applied to targeted executables after infection has taken place and how these components interact on\nexecution:\n\n\n-----\n\n_Figure 16. File structure changes during an infection and execution_\n\nAll of the different artifacts involved in the infection stage are either within the context of the spreader or dropped previously by another\nRamsay component. Some of the artifacts are parsed for the following tokens:\n\n_Figure 17. Hex-Rays output of tokens to search for different artifacts within the spreader context_\n\nAfter a given file has been infected, it will be marked by writing a specific token at the end of it in order to provide the spreader an\nidentifier to prevent redundant infection.\n\nIn addition, some components of Ramsay have implemented a network scanner intended for the discovery of machines within the\n[compromised host’s subnet that are susceptible to the EternalBlue SMBv1 vulnerability. This information will be contained within all](https://www.cvedetails.com/cve/CVE-2017-0143/)\nlogged information Ramsay collects and may be leveraged by operators in order to do further lateral movement over the network in a\nlater stage via a different channel.\n\n## Further remarks\n\nRamsay’s version 2.a Spreader component was found to have reused a series of tokens seen before in Darkhotel’s [Retro Backdoor.](https://s.tencent.com/research/report/741.html)\nThese tokens are the following:\n\n\n-----\n\n_Figure 18. Hex-Rays output of Token Reuse with Retro_\n\n_Figure 19. Token Reuse on Retro URL Crafting_\n\nRamsay serializes victims using the GetCurrentHwProfile API to then retrieve a GUID for the specific victim’s machine. This is also\nseen implemented in Retro. They both use the same default GUID in case the API call fails:\n\n\n-----\n\n_Figure 20. Ramsay and Retro GUID generation_\n\nBoth Ramsay and Retro share the same encoding algorithm to encode the retrieved GUID.\n\n_Figure 21. Ramsay and Retro GUID encoding scheme_\n\nThe GUID retrieved by GetCurrentHwProfile is specific for the system’s hardware but not for the user or PC instance. Therefore, it is\nlikely that by just leveraging this GUID operators may encounter duplicates intended to serialize different victims.\n\nThe purpose of this scheme is to generate a GUID that is less likely to be duplicate-prone by ‘salting’ it with the machine’s ethernet\nadapter address. This implies that Retro and Ramsay share the same scheme to generate unique identifiers.\n\nWe also found similarities in the way Ramsay and Retro saved some of their log files, sharing a similar filename convention:\n\n\n-----\n\n_Figure 22. Some of Ramsay and Retro filename convention_\n\nIs important to highlight that among Retro’s documented techniques, it leverages malicious instances of [msfte.dll,](https://blog.360totalsecurity.com/en/analysis-cve-2018-8174-vbscript-0day-apt-actor-related-office-targeted-attack/) oci.dll and\nlame_enc.dll, and via Phantom DLL Hijacking. As previously documented, Ramsay also uses this technique in some of its versions\nalso using msfte.dll and oci.dll.\n\nIn addition, we also observed similarities among Ramsay and Retro in regard to the open-source tools used among their toolsets, such\n[as leveraging UACMe for privilege escalation and ImprovedReflectiveDLLInjection for deploying some of their components.](https://github.com/hfiref0x/UACME)\n\nFinally, we noticed Korean language metadata within the malicious documents leveraged by Ramsay, denoting the use of Koreanbased templates.\n\n_Figure 23. Malicious document metadata showing the Korean word “title”_\n\n## Conclusion\n\nBased on the different instances of the framework found, Ramsay has gone through various development stages, denoting an\nincreasing progression in the number and complexity of its capabilities.\n\n\n-----\n\nDevelopers in charge of attack vectors seem to be trying various approaches such as old exploits for Word vulnerabilities from 2017\nas well as deploying trojanized applications.\n\nWe interpret this as that developers have a prior understanding of the victims’ environment and are tailoring attack vectors that would\nsuccessfully intrude into targeted systems without the need to waste unnecessary resources.\n\nSome stages of Ramsay’s framework are still under evaluation, which could explain the current low visibility of victims, having in mind\nthat Ramsay’s intended targets may be under air-gapped networks, which would also impact victim visibility.\n\nWe will continue monitoring new Ramsay activities and will publish relevant information on our blog. For any inquiries, contact us as\n_[threatintel@eset.com. Indicators of Compromise can also be found in our GitHub repository.](https://github.com/eset/malware-ioc)_\n\n## Indicators of Compromise (IoCs)\n\n**SHA-1** **ESET detection name** **Comments**\n\nf79da0d8bb1267f9906fad1111bd929a41b18c03 Win32/TrojanDropper.Agent.SHN Initial Installer\n\n62d2cc1f6eedba2f35a55beb96cd59a0a6c66880 Win32/Ramsay.A Installer Launcher\n\nbaa20ce99089fc35179802a0cc1149f929bdf0fa Win32/HackTool.UACMe.T UAC Bypass Module\n\n5c482bb8623329d4764492ff78b4fbc673b2ef23 Win32/HackTool.UACMe.T UAC Bypass Module\n\ne7987627200d542bb30d6f2386997f668b8a928c Win32/TrojanDropper.Agent.SHM Spreader\n\n3bb205698e89955b4bd07a8a7de3fc75f1cb5cde Win32/TrojanDropper.Agent.SHN Malware Installer\n\nbd8d0143ec75ef4c369f341c2786facbd9f73256 Win32/HideProc.M HideDriver Rootkit\n\n7d85b163d19942bb8d047793ff78ea728da19870 Win32/HideProc.M HideDriver Rootkit\n\n3849e01bff610d155a3153c897bb662f5527c04c Win64/HackTool.Inject.A Darkhotel Retro Backdoor Loader\n\n50eb291fc37fe05f9e55140b98b68d77bd61149e Win32/Ramsay.B Ramsay Initial Installer (version 2.b)\n\n\n87ef7bf00fe6aa928c111c472e2472d2cb047eae Win32/Exploit.CVE-201711882.H\n\n\nRTF file that drops\n50eb291fc37fe05f9e55140b98b68d77bd61149e\n\n\n5a5738e2ec8af9f5400952be923e55a5780a8c55 Win32/Ramsay.C Ramsay Agent DLL (32bits)\n\n19bf019fc0bf44828378f008332430a080871274 Win32/Ramsay.C Ramsay Agent EXE (32bits)\n\nbd97b31998e9d673661ea5697fe436efe026cba1 Win32/Ramsay.C Ramsay Agent DLL (32bits)\n\neb69b45faf3be0135f44293bc95f06dad73bc562 Win32/Ramsay.C Ramsay Agent DLL (32bits)\n\nf74d86b6e9bd105ab65f2af10d60c4074b8044c9 Win64/Ramsay.C Ramsay Agent DLL (64bits)\n\nae722a90098d1c95829480e056ef8fd4a98eedd7 Win64/Ramsay.C Ramsay Agent DLL (64bits)\n\n## MITRE ATT&CK techniques\n\n**Tactic** **ID** **Name** **Description**\n\n\nInitial\nAccess\n\n\n[T1091](https://attack.mitre.org/techniques/T1091/) Replication Through Removable Media Ramsay’s spreading mechanism is done via\nremovable drives.\n\n\nExecution [T1106](https://attack.mitre.org/techniques/T1106/) Execution through API Ramsay’s embedded components are\nexecuted via CreateProcessA and\nShellExecute .\n\n\n[T1129](https://attack.mitre.org/techniques/T1129/) Execution\nthrough Module\nLoad\n\n[T1203](https://attack.mitre.org/techniques/T1203/) Exploitation for\nClient Execution\n\n[T1035](https://attack.mitre.org/techniques/T1035/) Service\nExecution\n\n\nRamsay agent can be delivered as a DLL.\n\nRamsay attack vectors exploit CVE-2017-1188 or\nCVE-2017-0199.\n\nRamsay components can be executed as service\ndependencies.\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\n[T1204](https://attack.mitre.org/techniques/T1204/) User Execution Ramsay Spreader component infects files within\nthe file system.\n\nPersistence [T1103](https://attack.mitre.org/techniques/T1103/) AppInit DLLs Ramsay can use this registry key for\npersistence.\n\n[T1050](https://attack.mitre.org/techniques/T1050/) New Service Ramsay components can be executed as service\ndependencies.\n\n[T1053](https://attack.mitre.org/techniques/T1053/) Scheduled Task Ramsay sets a scheduled task to persist after\nreboot.\n\n\nPrivilege\nEscalation\n\nDefense\nEvasion\n\n\n[T1088](https://attack.mitre.org/techniques/T1088/) Bypass User Account Control Ramsay drops UACMe instances for privilege\nescalation.\n\n[T1038](https://attack.mitre.org/techniques/T1038/) DLL Order Hijacking Ramsay agents will masquerade as service\ndependencies leveraging Phantom DLL\nHijacking.\n\n\n[T1107](https://attack.mitre.org/techniques/T1107/) File Deletion Ramsay installer is deleted after execution.\n\n[T1055](https://attack.mitre.org/techniques/T1055/) Process Injection Ramsay’s agent is injected into various\nprocesses.\n\n[T1045](https://attack.mitre.org/techniques/T1045/) Software Packing Ramsay installer may be packed with UPX.\n\nDiscovery [T1083](https://attack.mitre.org/techniques/T1083/) File and Directory Discovery Ramsay agent scans for files and directories\non the system drive.\n\n\n[T1057](https://attack.mitre.org/techniques/T1057/) Process\nDiscovery\n\n\nRamsay will attempt to find if host is already\ncompromised by checking the existence of\nspecific processes.\n\n\nLateral\nMovement\n\n\n[T1210](https://attack.mitre.org/techniques/T1210/) Exploitation of Remote Services Ramsay network scanner may scan the\nhost’s subnet to find targets vulnerable to\nEternalBlue.\n\n\n[T1105](https://attack.mitre.org/techniques/T1105/) Remote File\nCopy\n\n[T1091](https://attack.mitre.org/techniques/T1091/) Replication\nThrough\nRemovable\nMedia\n\n\nRamsay attempts to infect files on network\nshares.\n\nRamsay attempts to infect files on removable\ndrives.\n\n\nCollection [T1119](https://attack.mitre.org/techniques/T1119/) Automated Collection Ramsay agent collects files in intervals.\n\n\n[T1005](https://attack.mitre.org/techniques/T1005/) Data from Local\nSystem\n\n[T1039](https://attack.mitre.org/techniques/T1039/) Data from\nNetwork Shared\nDrive\n\n[T1025](https://attack.mitre.org/techniques/T1025/) Data from\nRemovable\nMedia\n\n\nRamsay agent scans files on system drive.\n\nRamsay agent scans files on network shares.\n\nRamsay agent scans files on removable drives.\n\n\n[T1113](https://attack.mitre.org/techniques/T1113/) Screen Capture Ramsay agent may generate and collect\nscreenshots.\n\n\nCommand\nand Control\n\n\n[T1092](https://attack.mitre.org/techniques/T1092/) Communication Through Removable Media Ramsay agent scans for control files for its\nfile-based communication protocol on\nremovable drives.\n\n\n[T1094](https://attack.mitre.org/techniques/T1094/) Custom\nCommand and\nControl Protocol\n\n\nRamsay implements a custom, file-based C&C\nprotocol.\n\n\nExfiltration [T1002](https://attack.mitre.org/techniques/T1002/) Data Compressed Ramsay agent compresses its collection\ndirectory.\n\n13 May 2020 - 11:30AM\n\n\n-----\n\n### Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n Newsletter\n\n Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-05-13 - Ramsay- A cyber‑espionage toolkit tailored for air‑gapped networks.pdf"
    ],
    "report_names": [
        "2020-05-13 - Ramsay- A cyber‑espionage toolkit tailored for air‑gapped networks.pdf"
    ],
    "threat_actors": [
        {
            "id": "1dadf04e-d725-426f-9f6c-08c5be7da159",
            "created_at": "2022-10-25T15:50:23.624538Z",
            "updated_at": "2025-03-27T02:00:55.508759Z",
            "deleted_at": null,
            "main_name": "Darkhotel",
            "aliases": [
                "Darkhotel",
                "DUBNIUM",
                "Zigzag Hail"
            ],
            "source_name": "MITRE:Darkhotel",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "b13c19d6-247d-47ba-86ba-15a94accc179",
            "created_at": "2024-05-01T02:03:08.149923Z",
            "updated_at": "2025-03-27T02:05:17.422065Z",
            "deleted_at": null,
            "main_name": "TUNGSTEN BRIDGE",
            "aliases": [
                "DUBNIUM ",
                "DarkHotel ",
                "CTG-1948 "
            ],
            "source_name": "Secureworks:TUNGSTEN BRIDGE",
            "tools": [
                "Nemim"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2b4eec94-7672-4bee-acb2-b857d0d26d12",
            "created_at": "2023-01-06T13:46:38.272109Z",
            "updated_at": "2025-03-27T02:00:02.790029Z",
            "deleted_at": null,
            "main_name": "DarkHotel",
            "aliases": [
                "DUBNIUM",
                "Fallout Team",
                "Luder",
                "Tapaoux",
                "Shadow Crane",
                "APT-C-06",
                "SIG25",
                "Karba",
                "Nemim",
                "Nemin",
                "G0012",
                "ATK52",
                "T-APT-02",
                "TUNGSTEN BRIDGE",
                "Zigzag Hail"
            ],
            "source_name": "MISPGALAXY:DarkHotel",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c0cedde3-5a9b-430f-9b77-e6568307205e",
            "created_at": "2022-10-25T16:07:23.528994Z",
            "updated_at": "2025-03-27T02:02:09.847683Z",
            "deleted_at": null,
            "main_name": "DarkHotel",
            "aliases": [
                "APT-C-06",
                "ATK 52",
                "CTG-1948",
                "Dubnium",
                "Fallout Team",
                "Higaisa",
                "Luder",
                "Operation DarkHotel",
                "Operation Daybreak",
                "Operation Inexsmar",
                "Operation PowerFall",
                "Operation The Gh0st Remains the Same",
                "SIG25",
                "Shadow Crane",
                "T-APT-02",
                "Tungsten Bridge",
                "Zigzag Hail"
            ],
            "source_name": "ETDA:DarkHotel",
            "tools": [
                "Asruex",
                "DarkHotel",
                "DmaUp3.exe",
                "GreezeBackdoor",
                "Karba",
                "Nemain",
                "Nemim",
                "Ramsay",
                "Retro",
                "Tapaoux",
                "Trojan.Win32.Karba.e",
                "Virus.Win32.Pioneer.dx",
                "igfxext.exe",
                "msieckc.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535927,
    "ts_updated_at": 1743041741,
    "ts_creation_date": 1653764708,
    "ts_modification_date": 1653764708,
    "files": {
        "pdf": "https://archive.orkl.eu/cdaf30beb19ee745f1cc6645e71733ae61f9e2d7.pdf",
        "text": "https://archive.orkl.eu/cdaf30beb19ee745f1cc6645e71733ae61f9e2d7.txt",
        "img": "https://archive.orkl.eu/cdaf30beb19ee745f1cc6645e71733ae61f9e2d7.jpg"
    }
}