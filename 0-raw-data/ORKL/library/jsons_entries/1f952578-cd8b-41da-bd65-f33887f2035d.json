{
    "id": "1f952578-cd8b-41da-bd65-f33887f2035d",
    "created_at": "2023-01-12T15:08:17.802162Z",
    "updated_at": "2025-03-27T02:16:25.946415Z",
    "deleted_at": null,
    "sha1_hash": "90ec59646048f8a1dd10b1c890603d88ed0ee9d1",
    "title": "2021-10-01 - Made In America- Green Lambert for OS X",
    "authors": "",
    "file_creation_date": "2022-05-28T19:04:00Z",
    "file_modification_date": "2022-05-28T19:04:00Z",
    "file_size": 5069819,
    "plain_text": "# Objective-See's Blog\n\n**objective-see.com/blog/blog_0x68.html**\n\nMade In America: Green Lambert for OS X\n\nby: Runa Sandvik / October 1, 2021\n\n[This guest blog post, was written by Runa Sandvik, a noted security researcher who works](https://twitter.com/runasand)\non digital security for journalists and other high-risk people.\n\nMahalo for sharing Runa! ü§©\nüìù üëæ Want to play along?\n[I‚Äôve uploaded an OSX.GreenLambert sample (password: infect3d).](https://objective-see.com/downloads/malware/GreenLambert.zip)\n\n...please don‚Äôt infect yourself!\n\n## Background\n\nIn March 2017, WikiLeaks began publishing thousands of files detailing the CIA‚Äôs spying\n[operations and hacking tools. The leak, known as Vault 7, was the largest disclosure of](https://wikileaks.org/ciav7p1/cms/index.html)\nclassified information in the agency‚Äôs history. In April, Symantec [publicly linked Vault 7 to an](https://community.broadcom.com/symantecenterprise/communities/community-home/librarydocuments/viewdocument?DocumentKey=7ca2e331-2209-46a8-9e60-4cb83f9602de&CommunityKey=1ecf5f55-9545-44d6-b0f4-4e4a7f5f5e68&tab=librarydocuments)\nadvanced threat actor named Longhorn. Kaspersky then announced it tracks the same actor\nas [The Lamberts, and revealed the existence of an OS X implant called Green Lambert.](https://securelist.com/unraveling-the-lamberts-toolkit/77990/)\n\n[Kaspersky‚Äôs research showed that The Lamberts‚Äô toolkit includes ‚Äúnetwork-driven backdoors,](https://securelist.com/unraveling-the-lamberts-toolkit/77990/)\nseveral generations of modular backdoors, harvesting tools, and wipers.‚Äù A timeline of\nactvitiy for tools used by The Lamberts shows that ‚ÄúGreen Lambert is the oldest and longestrunning in the family.‚Äù Green Lambert is described as an ‚Äúactive implant‚Äù and ‚Äúthe only one\nwhere non-Windows variants have been found.‚Äù\n\nThis blog post, along with the [Made in America]\n[(https://objectivebythesea.com/v4/talks.html#Made In America) talk at](https://objectivebythesea.com/v4/talks.html#Made) Objective By The Sea\nv.4.0, provides a comprehensive analysis of Green Lambert for OS X. I‚Äôll share how I\napproached the research, the tools I used, the things I figured out, and the things I didn‚Äôt. I‚Äôll\nalso look at whether the developers followed the agency‚Äôs guidelines for development\ntradecraft. Some might ask why I‚Äôd look at an implant this old? Doing so helps us better\nunderstand the capabilities of its sophisticated creator, past and present. And, if we‚Äôre being\nhonest: I could, so I did.\n\n\n-----\n\n## Victimology\n\nWe don‚Äôt know how this implant makes it into a target system; the type of system it‚Äôs used\n[on; or the geographical location of a typical target. Symantec said that the actor has](https://community.broadcom.com/symantecenterprise/communities/community-home/librarydocuments/viewdocument?DocumentKey=7ca2e331-2209-46a8-9e60-4cb83f9602de&CommunityKey=1ecf5f55-9545-44d6-b0f4-4e4a7f5f5e68&tab=librarydocuments)\ninfiltrated governments, ‚Äúin addition to targets in the financial, telecoms, energy, aerospace,\n[information technology, education, and natural resources sectors.‚Äù QI-ANXIN said the actor](https://ti.qianxin.com/blog/articles/network-weapons-of-cia/)\nhas previously ‚Äútargeted personnel and institutions in China.‚Äù\n\n[A version of Green Lambert for OS X was first uploaded to VirusTotal, from Russia, in](https://www.virustotal.com/gui/file/af7c395426649c57e44eac0bb6c6a109ac649763065ff5b2b23db71839bac655/detection)\n[September 2014. Kaspersky marked it as malicious in October 2016. AegisLab, a security](https://www.virustotal.com/gui/file/af7c395426649c57e44eac0bb6c6a109ac649763065ff5b2b23db71839bac655/detection/f-af7c395426649c57e44eac0bb6c6a109ac649763065ff5b2b23db71839bac655-1477597496)\n[firm based in Taiwan, followed a couple of weeks later. VirusTotal identified that the implant](https://www.virustotal.com/gui/file/af7c395426649c57e44eac0bb6c6a109ac649763065ff5b2b23db71839bac655/detection/f-af7c395426649c57e44eac0bb6c6a109ac649763065ff5b2b23db71839bac655-1478101948)\n[calls itself GrowlHelper, possibly referencing the popular Growl notification system for OS X](https://growl.github.io/growl/)\nfrom 2004.\n\n## Triage\n\nUsing static analysis methods, we can triage the implant without running it. For example, we\ncan determine that `GrowlHelper is a small, unsigned Mach-O executable.`\n```\n$ file GrowlHelper\nGrowlHelper: Mach-O executable i386\n$ codesign -dvv GrowlHelper\nGrowlHelper: code object is not signed at all\n$ du -h GrowlHelper\n208K\n\n```\nWe can use `otool -L to print a list of linked libraries. This can sometimes provide insight`\ninto the capabilities of the malware, but doesn‚Äôt appear to be particularly helpful here. Note\nthe few dependencies in the list below.\n```\n$ otool -L GrowlHelper\n/System/Library/Frameworks/CoreFoundation.framework/Versions/A/CoreFoundation \n/System/Library/Frameworks/CoreServices.framework/Versions/A/CoreServices\n/System/Library/Frameworks/Security.framework/Versions/A/Security \n/System/Library/Frameworks/SystemConfiguration.framework/Versions/A/SystemConfiguratio\n/usr/lib/libSystem.B.dylib\n/usr/lib/libgcc_s.1.dylib\n\n```\nWhat‚Äôs more interesting is the output of `strings - . This tool can also provide insight into`\nthe capabilities of the malware.\n\n\n-----\n\n```\n$ strings GrowlHelper\nLoginItem\nLaunchAgent\n/Library/LaunchDaemons\nwww.google.com\nError from libevent when adding event for DNS server\n1.3a\n_SecKeychainFindInternetPassword\n_SecKeychainItemCopyAttributesAndData\n_kSCPropNetProxiesHTTPProxy\n_kSCPropNetProxiesProxyAutoConfigEnable\n_kSCPropNetProxiesProxyAutoConfigURLString\n\n```\nThe references to `LoginItem,` `LaunchAgent and` `LaunchDaemons suggest this implant`\nhas different options for gaining persistence on a system. In other words: how the implant\n[ensures it‚Äôs executed again if the system is rebooted. Check out this post by](https://www.sentinelone.com/blog/how-malware-persists-on-macos/) [Phil Stokes at](https://twitter.com/philofishal)\nSentinelOne for an overview of malware persistence techniques seen in the wild.\n\n[The following three lines appear to be related to libevent, the same event notification library](https://libevent.org/)\nthat is used by [Tor. The open-source library is very popular now, but was perhaps less](https://www.torproject.org/)\nknown back when this implant was created. The reference to `1.3a may shed some light on`\n[the development timeline for this implant: version 1.3a of libevent was released in February](https://libevent.org/old-releases.html)\n2007.\n\nThe references to `Keychain,` `Proxies and` `AutoConfig suggest this implant determines`\n[proxy settings on the target system. According to this post,](https://blog.adium.im/2006/01/having-trouble-building/)\n```\nkSCPropNetProxiesProxyAutoConfigEnable and\nkSCPropNetProxiesProxyAutoConfigURLString were added in Xcode version 2.2. This\n\n```\nversion [was released in November 2005. Could be another clue about the development](https://www.macworld.com/article/177734/xcode-6.html)\ntimeline.\n\n## OS X Version\n\nThe static analysis methods we used were helpful, but we‚Äôre going to want to see how the\nimplant behaves on a system. For that, we‚Äôll turn to dynamic analysis in a virtual machine.\nBut which version of OS X does the implant need? We know that it‚Äôs a 32-bit executable, and\nthe latest macOS is 64-bit only. We can narrow this down further by looking at symbols using\n```\nnm .\n\n```\n\n-----\n\n```\n$ nm GrowlHelper\n     U _CFArrayAppendValue\n     U _CFArrayCreateMutable\n     U _CFArrayCreateMutableCopy\n     U _CFArrayGetCount\n     U _CFArrayGetValueAtIndex\n     U _CFArrayRemoveValueAtIndex\n     U _CFDictionaryCreate\n     U _CFDictionaryGetValue\n     U _CFGetTypeID\n     U _CFNumberGetTypeID\n     ...\n\n```\nThe next step is a bit tedious, but does provide helpful information. To better understand\nwhat these symbols represent, we can look them up in Apple‚Äôs [Developer Documentation.](https://developer.apple.com/)\nNot only will we be able to learn how and where a given symbol is used, but we can also see\nwhen it was deprecated. With that information, we can determine which version of OS X the\nimplant will run on.\n\n[FSGetCatalogInfo is available in macOS 10.0 - 10.8](https://developer.apple.com/documentation/coreservices/1565356-fsgetcataloginfo/)\n[FSPathMakeRef is available in macOS 10.0 - 10.8](https://developer.apple.com/documentation/coreservices/1565195-fspathmakeref/)\nFSSetCatalogInfo is [available in macOS 10.0 - 10.8](https://developer.apple.com/documentation/coreservices/1566580-fssetcataloginfo/)\n[SecKeychainSearchCopyNext is available in macOS 10.0 - 10.7](https://developer.apple.com/documentation/security/1515362-seckeychainsearchcopynext/)\n[SecKeychainSearchCreateFromAttributes is available in macOS 10.0 - 10.7](https://developer.apple.com/documentation/security/1515366-seckeychainsearchcreatefromattri/)\n[SecKeychainSetUserInteractionAllowed is available in macOS 10.2 - 12.0](https://developer.apple.com/documentation/security/1396453-seckeychainsetuserinteractionall)\n\nThis means that the implant will run on (at least) 10.7: OS X Lion.\n\n_Note: I confirmed the implant runs on 10.8. It probably runs on any OS X that supports 32-bit_\n_executables._\n\n## Development / Use Timeline\n\nLet‚Äôs look at a potential timeline for the development and use of this implant.\n\nGrowl was released in 2004 and retired in 2020. Xcode version 2.2 was released in\nNovember 2005, while libevent 1.3a was released in February 2007. OS X 10.7 was\nreleased in 2011, and 10.8 in 2012. The implant first appeared on VirusTotal in late 2014.\n\n\n-----\n\nCourt records [show Vault 7 was stolen sometime in early 2016 and published by WikiLeaks a](https://www.justice.gov/usao-sdny/pr/joshua-adam-schulte-charged-unauthorized-disclosure-classified-information-and-other)\nyear later. Based on these datapoints, it‚Äôs likely the implant was created and used between\n2007 and (at least) 2013.\n\n## Setting Up a Virtual Machine\n\nAs of June 2021, OS X 10.7 is [available for free from Apple. You can also do what I did: buy](https://support.apple.com/kb/DL2077?locale=en_US)\nan old MacBook on eBay for $95.\n\nYou may have to unpack the `.dmg you get from Apple to get a file that‚Äôll work with your`\nvirtual machine software. If so, try:\n```\n$ hdiutil attach InstallMacOSX.dmg\n\n```\n[Click on Install Mac OS X on the Desktop and use The Unarchiver (or another tool) to extract](https://theunarchiver.com/)\n```\nInstallMacOSX.pkg to a temporary folder. Go into this folder, click on the new copy of\nInstallMacOSX.pkg and select Show Package Contents. Copy InstallESD.dmg to\n\n```\nwhere you keep your virtual machine images, and use that instead.\n\n[We‚Äôre going to use lldb, the default debugger, to execute the implant, modify registers, and](https://lldb.llvm.org/)\nexamine memory contents. OS X 10.7 doesn‚Äôt include Xcode by default, but a quick Google\nsearch suggests we need version 4.6.3 and can get it from Apple‚Äôs [Developer Downloads](https://developer.apple.com/download/)\npage. After installing Xcode and confirming that `lldb is working, we isolate the machine`\nand create a clean snapshot.\n\n## Persistence\n\n[Phil Stokes at SentinelOne wrote that ‚Äúthe most common way malware persists on macOS is](https://www.sentinelone.com/blog/how-malware-persists-on-macos/)\nvia a LaunchAgent. Each user on a Mac can have a `LaunchAgents folder in their own`\nLibrary folder to specify code that should be run every time that user logs in.‚Äù We can confirm\nthis is the case with Green Lambert by running the implant, then checking the user‚Äôs\n```\nLaunchAgents folder.\n$ ls ~/Library/LaunchAgents\ncom.apple.GrowlHelper.plist\n\n```\nOnce installed, it‚Äôll delete the original `GrowlHelper file from the system. This is where our`\nVM snapshot comes in handy.\n\nFrom Phil‚Äôs post, we know that ‚ÄúLaunchAgents take the form of property list files, which can\neither specify a file to execute or can contain their own commands to execute directly.‚Äù We\ncan confirm this by looking at `com.apple.GrowlHelper.plist .`\n\n\n-----\n\n```\n$ cat /Library/LaunchAgents/com.apple.GrowlHelper.plist\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE plist PUBLIC \"-//Apple Computer//DTD PLIST 1.0//EN\"\n\"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">\n<plist version=\"1.0\">\n<dict>\n     <key>Label</key>\n     <string>com.apple.GrowlHelper</string>\n     <key>ProgramArguments</key>\n     <array>\n<string>/Users/user/Library/Caches/com.apple.Growl.GrowlHelper/5d0d/GrowlHelper</strin\n          <string>-f</string>\n     </array>\n     <key>RunAtLoad</key>\n     <true/>\n     <key>OnDemand</key>\n     <false/>\n</dict>\n</plist>\n\n```\nThe `ProgramArguments tell us where` `GrowlHelper is installed and that it takes at least`\none command line argument ( -f ). The `RunAtLoad key confirms the implant will run every`\ntime the user logs in. To get an overview of the installation process, we can monitor file\nsystem activity for `GrowlHelper events.`\n```\n$ sudo fs_usage -w -f filesys > filesys.out\n$ sudo grep GrowlHelper filesys.out\nexecve   /Users/user/GrowlHelper   0.015273 W bash.2848\nexecve   /Users/user/GrowlHelper   0.000383  GrowlHelper.2851\nopen    /Users/user/.profile    0.000018  GrowlHelper.2851\nopen    /Users/user/.bash_profile  0.000015  GrowlHelper.2851\nopen    /Users/user/.bash_login   0.000015  GrowlHelper.2851\nopen    /Users/user/.bashrc     0.000014  GrowlHelper.2851\nopen    /Users/user/.cshrc     0.000014  GrowlHelper.2851\nopen    /Users/user/.login     0.000014  GrowlHelper.2851\nopen    /Users/user/.tcshrc     0.000014  GrowlHelper.2851\nopen    /Users/user/.xsession    0.000007  GrowlHelper.2851\nopen    /Users/user/.xinitrc    0.000006  GrowlHelper.2851\n\n```\nWe see that `GrowlHelper has a handful of options for maintaining persistence, in case the`\nLaunchAgent is removed. In one case, the implant uses a `.profile file to ensure it‚Äôs`\nlaunched whenever the user opens the Terminal. (Path to `GrowlHelper was lightly edited`\ndue to space constraints.)\n```\n$ cat ~/.profile\nGrowlHelper=`/path/to/com.apple.Growl.GrowlHelper/5d0d/GrowlHelper 2>&1` # Automatic\nGrowlHelper. Do not remove\n\n## Self-Update\n\n```\n\n-----\n\nWe can compare how `GrowlHelper behaves when the system is offline v. online. Here are`\nthe files it created in an isolated VM.\n```\n$ file /Users/offline/Library/Caches/com.apple.Growl.GrowlHelper/5d0d/*\nGrowlHelper: Mach-O executable i386\ndb: Berkeley DB 1.85 (Hash, version 2,\nnative byte-order)\nfifo: socket\nqueue:  directory\n\n```\nAnd here are the files `GrowlHelper created on that old MacBook I got from eBay.`\n```\n$ file /Users/online/Library/Caches/com.apple.Growl.GrowlHelper/5d0d/*\nGrowlHelper: Mach-O executable i386 \nSoftware Update Check: Mach-O executable i386\ndb:\nBerkeley DB 1.85 (Hash, version 2, native byte-order)\nfifo:\nsocket\nqueue:  directory\n\n```\nIt looks like `GrowlHelper creates an executable named` `Software Update Check when`\nit thinks it‚Äôs online. I was pretty excited when I first found this, but quickly realized it just drops\na copy of itself with a different name.\n```\n3fcdbd3c5fa34fb8e8d58038fa1d1f13d37e8a4b GrowlHelper\n3fcdbd3c5fa34fb8e8d58038fa1d1f13d37e8a4b Software Update Check\n\n```\nIt‚Äôs possible that `Software Update Check is used to update` `GrowlHelper .`\n\n## Command Line Arguments\n\nWe know where `GrowlHelper is installed and that it takes at least one command line`\nargument ( -f ). With this information, we can identify other arguments by manually looping\nthrough options a - z and A - Z on the command line. The output below is the result of doing\nthis try/fail experiment in a VM.\n\n**Args** **Meaning** **Action**\n\nc ?? Prints: ** Commands will be processed immediately **\n\nd ?? If GrowlHelper is installed, drops Software Update Check\n\nf Default Persists as LaunchAgent, creates: GrowlHelper, db, fifo, queue\n\np: ?? Prints: GrowlHelper: option requires an argument ‚Äì p\n\ns ?? Runs without persisting, creates: db, fifo, queue\n\nL ?? Runs without persisting, does not create files\n\n\n-----\n\n**Args** **Meaning** **Action**\n\nN ?? Persists as LaunchAgent, creates: GrowlHelper, Software Update\nCheck, db\n\n[Hopper Disassembler is a tool that helps you disassemble, decompile and debug malware.](https://www.hopperapp.com/)\nThere‚Äôs a free version, and you can get a personal license for $99. Using Hopper, we can\nconfirm the arguments we found by looking for `argc,` `argv, and` `getopt .`\n\nBy using Hopper‚Äôs pseudo-code mode, we can see the full set of possible command line\narguments.\n\n## Entry Points\n\nWhen you open `GrowlHelper in Hopper, you‚Äôll see that it has multiple entry points:`\n```\nEntryPoint_1 through EntryPoint_21 . These entry points are called when\nGrowlHelper starts executing, before the main entry point at 0x2cd8. GrowlHelper will\n\n```\nuse these entry points to initialize certain functionality. QI-ANXIN detailed these entry points\nin [this post / this screenshot below.](https://ti.qianxin.com/blog/articles/network-weapons-of-cia/)\n\n\n-----\n\nIt appears `GrowlHelper has a preflight checklist of sorts: it initializes functionality, figures`\nout what it needs, deletes the rest.\n```\n$ sudo grep GrowlHelper filesys.out\nmkdir    /Users/user/.DS_Info    \n0.000083  GrowlHelper.2851\nmkdir /Users/user/.DS_Info/5d0d\n0.000044  GrowlHelper.2851\nmkdir /Users/User/Library/Caches/com.apple.advanced\n0.000066  GrowlHelper.2851\nrmdir /Users/user/.DS_Info/5d0d\n0.000109 W GrowlHelper.2851\nrmdir /Users/user/.DS_Info \n0.000240 W GrowlHelper.2851\nrmdir /Users/User/Library/Caches/com.apple.advanced\n0.000068  GrowlHelper.2851\n\n## Decrypting a String\n\n```\nGiven the author, it‚Äôs no surprise that most strings in this implant are encrypted. The implant\nappears to handle encrypted strings in a bunch of different ways, which makes it challenging\nto automate decryption. Hopper has done some of the analysis work for us, allowing us to at\nleast manually decrypt strings with `lldb . Here‚Äôs one example.`\n\n\n-----\n\nIn the screenshot above, we have:\n\nThe address for the program counter / call to the decryption routine (0x1549b)\nThe values for ecx (0x01), edx (0x31e80), eax (0x2d487)\nThe address after the decryption routine, which we‚Äôll use as a breakpoint for `lldb`\n(0x154a0)\n\nWe load the implant into the debugger using `lldb GrowlHelper, and decrypt the string:`\n\n## Decrypting More Strings\n\n\n-----\n\nManually decrypting strings turned into a rabbit hole for me, but that s OK. I m sure there are\nways to do this faster, but I have to admit I really enjoyed the process of learning to do this\nmanually. Here are the strings I‚Äôve decrypted so far, minus duplicates.\n\n**pc** **String**\n\n0xe8a0 /tmp\n\n0xe9ba upload_dir\n\n0xe9e2 upload_key\n\n0xea23 upload_header\n\n0xed50 52\n\n0x185ef download\n\n0x187d7 ?\n\n0x18eae InternetOpen\n\n0x19121 ** Commands will be processed immediately **\n\n0x191f6 login.php\n\n0x19216 getconf.php\n\n0x19236 s|%s|%s|%s upload.gethostname\n\n0x195be show.php\n\n0xa2f6 ConfigInitdFile\n\n0x2ce6f /etc/init.d\n\n0xa762 /etc/rc.d.File\n\n0xaccc .xinitrc\n\n0xae0b ConfigPersistXsessionFile\n\n0xae23 ConfigPersistXSession\n\n0xaec9 .xsession\n\n0xaf39 ConfigPersistXinitRCFile\n\n0xaf51 ConfigPersistXInitRC\n\n0xc8f0 proxy_type\n\n\n-----\n\n**pc** **String**\n\n0xc916 proxy_url\n\n0xc948 Could not set proxy\n\n0xca62 [http://www.google.com](http://www.google.com/)\n\n0xce05 no proxy_url\n\n0x11309 index.html\n\n0x11816 hps.txt\n\n0x11d35 NODELETE\n\n0x11d64 DELETE\n\n0x11d93 SECDELETE\n\n0x1218d NOWAIT\n\n0x121c0 WAIT\n\n0x121f1 WAIT_FOREVER\n\n0x1225a /bin/sh -c\n\n0x132b1 Version\n\n0x13c1e Service\n\n0x147f8 Proxy\n\n0x14b1e ProxyUser\n\n0x1549b hversion.txt\n\n0x15c12 HHLogEntry\n\n0x15c5b HHLogHead\n\n0x15e2d HHLogTail\n\n0x1a427 hh_last_attempt\n\n0x1a530 localhost_sock_create(pipe)\n\n0x1a8ab hh_last_attempt\n\n0x649e No LP configured\n\n0x6a66 16\n\n\n-----\n\n## Listening Post\n\nOne of the decrypted strings is `No LP configured . LP likely stands for Listening Post, a`\nmilitary term used in the context of signals intelligence and reconnaissance. Where other\ntypes of malware would likely use the terms C2 or Command & Control, the CIA and the\n[NSA use LP. One Vault 7 document is titled Listening Post (LP) Creation, and another details](https://wikileaks.org/ciav7p1/cms/page_17760568.html)\n[requirements for a Listening Post.](https://wikileaks.org/ciav7p1/cms/page_3375129.html)\n\n## Configuration Files\n\nSome of the decrypted strings refer to `.html,` `.php, and` `.txt files, but I‚Äôm unable to`\naccess them. But we know that Kaspersky found ‚Äúa hostname and an IP address‚Äù hardcoded\nin the implant. And researchers at QI-ANXIN determined the implant talks to the Listening\nPost through `login.php and` `getconf.php, and downloads follow-up code through`\n```\ngetfile.php .\n\n## Configuration? Survey?\n\n```\nIf you dig around in Hopper and use pseudo-code mode from time to time, you‚Äôll likely find\nsome interesting bits of information. When I stumbled upon the string `Version=1.2.0, I`\ndecided to see where else `= was referenced. To do that, highlight 0x132b8 as shown below`\nand hit `x .`\n\nThe list of references looks like this, with the current one selected.\n\n\n-----\n\nWe can then go through all these references, decrypt the strings, and get an output that\nlooks like this.\n```\nuname=\nTime=%Y\\%m\\%d %H:%M:%S Z\nUptime=\nVersion=1.2.0\nPID=\n\n```\nThe output lists information from the target system (e.g. `uname ) and information from the`\nimplant (e.g. `Version ). This could be a combination of a configuration file and system`\nsurvey.\n\n## Network Traffic\n\nWe can monitor the network traffic on our OS X 10.7 system using `tcpdump and then view`\nthe output in Wireshark.\n\nThis gives us the hardcoded hostname `notify[.]growlupdate[.]com . Very clever given`\nthe name of the executable.\n\nAnd the hardcoded IP address: `94[.]242[.]252[.]68 .`\n\n\n-----\n\n## Hostname\n\n[Google and the](https://www.google.com/search?q=notify.growlupdate.com) [Wayback Machine don‚Äôt have any results for the domain name. If we look it](https://waybackmachine.com/)\n[up on VirusTotal, we see that it was first submitted in October 2016. But if we look up the](https://www.virustotal.com/gui/domain/notify.growlupdate.com/relations)\n[domain on crt.sh, we see that an SSL certificate was created on October 29, 2013. The](https://crt.sh/)\ndomain may have been purchased earlier, but this at least suggests the domain was active in\n[late 2013. This matches the timeline we created earlier, as well as Kaspersky‚Äôs timeline of](https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2017/04/07180034/Lamberts.png)\nactivity by The Lamberts.\n\nNote: Kaspersky sinkholed the domain to `95[.]211[.]172[.]143 between October 1,`\n2016 and October 2, 2017.\n\n## Development Tradecraft DOs and DON‚ÄôTs\n\nAs part of Vault 7, WikiLeaks published 52 revisions of the CIA‚Äôs [development tradecraft](https://wikileaks.org/ciav7p1/cms/page_14587109.html)\n[guidelines. I mapped the revisions in a public spreadsheet to see how the guidance changed](https://docs.google.com/spreadsheets/d/1cw9wAWxlenq8Mg6wXh4vD6eNmwJCq-QNo8XeXXX0he4/edit#gid=0)\nover time. Studying the development choices made by sophisticated actors may help us\ntrack them over time. For example, when Kaspersky identified a code overlap between\n[Sunburst and Kazuar, it was because of ‚Äúunusual, shared features‚Äù such as the UID](https://securelist.com/sunburst-backdoor-kazuar/99981/)\ngeneration algorithm, the sleeping algorithm, and use of the FNV-1a hash.\n\n\n-----\n\n[As Costin Raiu of Kaspersky pointed out on Twitter, C2 jitter, secure erase / uninstall,](https://twitter.com/craiu/status/1424976647300780032)\nSSL/TLS+extra crypto, size below 150K, encrypt logs and local collection, decrypt strings on\nthe fly in mem‚Ä¶ simply following these guidelines immediately makes the malware (‚Äútools‚Äù)\nmore interesting and, recognizable by a skilled analyst.‚Äù While most of these are true here as\nwell, there are a few things that stand out.\n\nFile size is a bit over the ‚Äúideal binary file size‚Äù for a fully featured tool (208K v. 150K)\n\nThe references to Listening Post / LP may be CIA and USG specific terminology\n\nUse of English abbreviations for days of the week (mtwhfsu / MTWHFSU)\n\nUse of the libevent library back when it was perhaps less well-known\n\n## Conclusion\n\nI‚Äôve really enjoyed working on this project and certainly learned a lot along the way. I‚Äôm\nconfident there‚Äôs more to find here, and I‚Äôd love to collaborate with anyone interested in\ntaking a closer look. As for The Lamberts? Malware from this actor keeps turning up, along\nwith new insights. In fact, Kaspersky‚Äôs [APT trends report for Q1 2021 mentions Purple](https://securelist.com/apt-trends-report-q1-2021/101967/)\nLambert, a malware ‚Äúcapable of providing an attacker with basic information about the\ninfected system and executing a received payload.‚Äù\n\n## Indicators of Compromise\n\nnotify[.]growlupdate[.]com\n94[.]242[.]252[.]68\n3fcdbd3c5fa34fb8e8d58038fa1d1f13d37e8a4b\n\n## References\n\nPatrick‚Äôs free and open-source book on Mac malware analysis was incredibly helpful during\nthis project. If you haven‚Äôt already done so, I highly recommend checking out The Art of Mac\nMalware.\n\nThis website uses cookies to improve your experience.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-10-01 - Made In America- Green Lambert for OS X.pdf"
    ],
    "report_names": [
        "2021-10-01 - Made In America- Green Lambert for OS X.pdf"
    ],
    "threat_actors": [
        {
            "id": "23dfc9f5-1862-4510-a6ae-53d8e51f17b1",
            "created_at": "2024-05-01T02:03:08.146025Z",
            "updated_at": "2025-03-27T02:05:17.420497Z",
            "deleted_at": null,
            "main_name": "PLATINUM TERMINAL",
            "aliases": [
                "Longhorn ",
                "The Lamberts ",
                "Vault7 ",
                "APT-C-39 "
            ],
            "source_name": "Secureworks:PLATINUM TERMINAL",
            "tools": [
                " Assassin",
                " Marble Framework",
                "AfterMidnight"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e993faab-f941-4561-bd87-7c33d609a4fc",
            "created_at": "2022-10-25T16:07:23.460301Z",
            "updated_at": "2025-03-27T02:02:09.814816Z",
            "deleted_at": null,
            "main_name": "Longhorn",
            "aliases": [
                "APT-C-39",
                "Platinum Terminal",
                "The Lamberts"
            ],
            "source_name": "ETDA:Longhorn",
            "tools": [
                "Black Lambert",
                "Blue Lambert",
                "Corentry",
                "Cyan Lambert",
                "Fluxwire",
                "Gray Lambert",
                "Green Lambert",
                "Magenta Lambert",
                "Pink Lambert",
                "Plexor",
                "Purple Lambert",
                "Silver Lambert",
                "Violet Lambert",
                "White Lambert"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "70db80bd-31b7-4581-accb-914cd8252913",
            "created_at": "2023-01-06T13:46:38.57727Z",
            "updated_at": "2025-03-27T02:00:02.865012Z",
            "deleted_at": null,
            "main_name": "Longhorn",
            "aliases": [
                "the Lamberts",
                "APT-C-39",
                "PLATINUM TERMINAL"
            ],
            "source_name": "MISPGALAXY:Longhorn",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536097,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1653764640,
    "ts_modification_date": 1653764640,
    "files": {
        "pdf": "https://archive.orkl.eu/90ec59646048f8a1dd10b1c890603d88ed0ee9d1.pdf",
        "text": "https://archive.orkl.eu/90ec59646048f8a1dd10b1c890603d88ed0ee9d1.txt",
        "img": "https://archive.orkl.eu/90ec59646048f8a1dd10b1c890603d88ed0ee9d1.jpg"
    }
}