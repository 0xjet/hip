{
    "id": "7796c91d-8755-427b-abc5-a7936d284947",
    "created_at": "2022-10-25T16:48:17.128904Z",
    "updated_at": "2025-03-27T02:05:38.95488Z",
    "deleted_at": null,
    "sha1_hash": "efbf11f4d0f97731f77960fbe5c9c4968910e239",
    "title": "",
    "authors": "",
    "file_creation_date": "2020-11-19T17:19:44Z",
    "file_modification_date": "2020-11-19T17:19:44Z",
    "file_size": 1027446,
    "plain_text": "# 19 NOV 2020\n\nAlert Number\n## MU-000140-MW\n\n# WE NEED YOUR HELP!\nIf you find any of these\n\nindicators on your\nnetworks, or have\nrelated information,\n\nplease contact\n\n**FBI CYWATCH**\n\n**immediately.**\n\n## Email:  cywatch@fbi.gov\n\n Phone: 1-855-292-3937\n\n*Note: By reporting any\n\n_related information to_\n\n_FBI CyWatch, you are_\n\n_assisting in sharing_\n_information that allows_\n_the FBI to track malicious_\n\n_actors and coordinate_\n_with private industry and_\n\n_the United States_\n_Government to prevent_\n\n_future intrusions and_\n\n_attacks._\n\n\n#### The following information is being provided by the FBI, with no guarantees or warranties, for potential use at the sole discretion of recipients in order to protect against cyber threats. This data is provided in order to help cyber security professionals and system administrators to guard against the persistent malicious actions of cyber criminals. This FLASH was coordinated with DHS-CISA. \n This FLASH has been released TLP:WHITE: Subject to standard copyright rules, TLP:WHITE information may be distributed without restriction.\n\n# Indicators of Compromise Associated with Ragnar Locker Ransomware\n\n#### Summary\n The FBI first observed Ragnar Locker[1] ransomware in April 2020, when unknown actors used it to encrypt a large corporation’s files for an approximately $11 million ransom and threatened to release 10 TB of sensitive company data. Since then, Ragnar Locker has been deployed against an increasing list of victims, including cloud service providers, communication, construction, travel, and enterprise software companies. The FBI is providing details of Ragnar Locker ransomware to assist with understanding the code and identifying the activity. Ragnar Locker actors first obtain access to a victim’s network and perform reconnaissance to locate network resources, backups, or other sensitive files for data exfiltration. In the final stage of the attack, actors manually deploy the ransomware, encrypting the victim’s data. \n Technical Details\n The Ragnar Locker ransomware family[2] is frequently changing obfuscation techniques to avoid detection and prevention. The Ragnar Locker ransomware is identified by the extension “.RGNR_<ID>,” where <ID> is a hash of the computer’s NETBIOS name. Furthermore, the actors, identifying themselves as “RAGNAR_LOCKER,” leave a .txt ransom note, with instructions on how to pay\n\n\n1 Ragnar Locker, also written as RagnarLocker and Ragnar_Locker, has no association with Ragnarok ransomware.\n2 Ransomware family is a group of binaries associated to several ransomwares or actor groups.\n\n\n-----\n\n#### the ransom and decrypt the data. Ragnar Locker has used VMProtect, UPX, and custom packing algorithms. Ragnar Locker has been deployed within an attacker’s custom Windows XP virtual machine on a target’s site.\n Ragnar Locker uses Windows API GetLocaleInfoW to get the infected machine’s current locale. If the victim’s locale is found to be \"Azerbaijani,\" \"Armenian,\" \"Belorussian,\" \"Kazakh,\" \"Kyrgyz,\" \"Moldavian,\" \"Tajik,\" \"Russian,\" \"Turkmen,\" \"Uzbek,\" \"Ukrainian,\" or \"Georgian,\" the process will terminate.\n\n**Figure 1 _ Code Snippet**\n\n#### The ransomware also checks for current infections to prevent multiple encryption transforms of the data, potentially corrupting it. The binary gathers the unique machine GUID, operating system product name, and user name currently running the process. This data is sent through a custom hashing algorithm to generate a unique identifier: <HashedMachineGuid>- <HashedWindowsProductName>-<HashedUser>-<HashedComputerName>- <HashedAllDataTogether>.\n The Ragnar Locker ransomware identifies all attached hard drives, whether assigned a drive letter or not, using Windows APIs: CreateFileW, DeviceIoControl, GetLogicalDrives, and SetVolumeMountPointA. The ransomware assigns a drive letter to any volumes not assigned a logical drive\n\n\n-----\n\n#### letter and makes them accessible. These newly attached volumes are later encrypted during the final stage of the binary.\n Ragnar Locker iterates through all running services and terminates services commonly used by managed service providers to remotely administer networks. \n\n The list of services terminated includes: \nvss sql memtas mepocs sophos dfs splashtop\nveeam backup pulseway logme logmein mysql connectwise\n\n#### Ragnar Locker also terminates the following running processes:\nsql mysql veeam oracle ocssd\ndbsnmp synctime agntsvc isqlplussvc xfssvccon\nmydesktopservice ocautoupds encsvc firefox tbirdconfig\nmydesktopqos ocomm dbeng50 sqbcoreservice excel\ninfopath msaccess mspub onenote outlook\npowerpnt steam thebat thunderbird visio\nwinword wordpad EduLink2SIMS bengine benetns\nbeserver pvlsvr beremote VxLockdownServer postgres\ndfssvc.exe SavService.exe OWSTIMER SAVAdminService wsstracing\nFdhost dfsrs.exe sophos WSSADMIN swc_service.exe\n\n#### The malware then attempts to silently delete all Volume Shadow Copies preventing user recovery of encrypted files, using two different methods:\n\n  >vssadmin delete shadows /all /quiet\n  >wmic.exe.shadowcopy.delete\n Lastly, Ragnar Locker encrypts all available files of interest. Instead of choosing which files to encrypt, Ragnar Locker chooses which folders it will not encrypt. Taking this approach allows the computer to continue to operate “normally” while the malware encrypts files with known and unknown extensions containing data of value to the victim. For example, if the logical drive being processed is the C: drive, the malware does not encrypt files in the following folders:\n\n  Windows  Mozilla\n  Windows.old  Mozilla Firefox\n  Tor browser  $Recycle.Bin\n  Internet Explorer  ProgramData\n\n|The list of services terminated includes:|Col2|Col3|Col4|Col5|Col6|Col7|\n|---|---|---|---|---|---|---|\n|vss|sql|memtas|mepocs|sophos|dfs|splashtop|\n|veeam|backup|pulseway|logme|logmein|mysql|connectwise|\n\n|Ragnar Locker also terminates the following running processes:|Col2|Col3|Col4|Col5|\n|---|---|---|---|---|\n|sql|mysql|veeam|oracle|ocssd|\n|dbsnmp|synctime|agntsvc|isqlplussvc|xfssvccon|\n|mydesktopservice|ocautoupds|encsvc|firefox|tbirdconfig|\n|mydesktopqos|ocomm|dbeng50|sqbcoreservice|excel|\n|infopath|msaccess|mspub|onenote|outlook|\n|powerpnt|steam|thebat|thunderbird|visio|\n|winword|wordpad|EduLink2SIMS|bengine|benetns|\n|beserver|pvlsvr|beremote|VxLockdownServer|postgres|\n|dfssvc.exe|SavService.exe|OWSTIMER|SAVAdminService|wsstracing|\n|Fdhost|dfsrs.exe|sophos|WSSADMIN|swc_service.exe|\n\n\n#### letter and makes them accessible. These newly attached volumes are later\n\n\n-----\n\n####  Google  Opera Software\n  Opera\n Also, when iterating through files, the malware does not encrypt files with the following extensions: \n\n  .db  .msi\n  .sys  .drv\n  .dll  .exe\n  .lnk\n Recommended Mitigations\n\n  Back-up critical data offline.\n  Ensure copies of critical data are in the cloud or on an external hard drive\n or storage device. This information should not be accessible from the compromised network.\n  Secure your back-ups and ensure data is not accessible for modification\n or deletion from the system where the data resides.\n  Install and regularly update anti-virus or anti-malware software on all\n hosts.\n  Only use secure networks and avoid using public Wi-Fi networks.\n Consider installing and using a VPN.\n  Use multi-factor authentication with strong passwords.\n  Keep computers, devices, and applications patched and up-to-date.\n\n\n\n####  Google  Opera Software\n\n\n-----\n\n#### Reporting Notice\n\n The FBI encourages recipients of this document to report information concerning suspicious or criminal activity to their local FBI field office or the FBI’s 24/7 Cyber Watch (CyWatch). Field office contacts can be identified at CyWatch can be contacted by phone at (855) 292-3937 or by email at CyWatch@fbi.gov. When available, each report submitted should include the date, time, location, type of activity, number of people, and type of equipment used for the activity, the name of the submitting company or organization, and a designated point of contact. Press inquiries should be directed to the FBI’s national Press Office at npo@fbi.gov or (202) 324-3691.\n\n Administrative Note\n\n This product is marked TLP:WHITE. Subject to standard copyright rules, TLP:WHITE information may be distributed without restriction.\n\n For comments or questions related to the content or dissemination of this product, contact CyWatch.\n\n\n# Your Feedback on the Value of this Product Is Critical\n\n### Was this product of value to your organization? Was the content clear and concise?  Your comments are very important to us and can be submitted anonymously. Please take a moment to complete the survey at the link below. Feedback should be specific to\n your experience with our written products to enable the FBI to make quick and continuous improvements to such products. Feedback may be submitted online here: \n https://www.ic3.gov/PIFSurvey\n\n Please note that this survey is for feedback on content and value only. Reporting of technical information regarding FLASH reports must be submitted through FBI CYWATCH.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://assets.documentcloud.org/documents/20413525/fbi-flash-indicators-of-compromise-ragnar-locker-ransomware-11192020-bc.pdf",
        "https://www.waterisac.org/system/files/articles/FLASH-MU-000140-MW.pdf"
    ],
    "report_names": [
        "fbi-flash-indicators-of-compromise-ragnar-locker-ransomware-11192020-bc.pdf",
        "FLASH-MU-000140-MW.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716497,
    "ts_updated_at": 1743041138,
    "ts_creation_date": 1605806384,
    "ts_modification_date": 1605806384,
    "files": {
        "pdf": "https://archive.orkl.eu/efbf11f4d0f97731f77960fbe5c9c4968910e239.pdf",
        "text": "https://archive.orkl.eu/efbf11f4d0f97731f77960fbe5c9c4968910e239.txt",
        "img": "https://archive.orkl.eu/efbf11f4d0f97731f77960fbe5c9c4968910e239.jpg"
    }
}