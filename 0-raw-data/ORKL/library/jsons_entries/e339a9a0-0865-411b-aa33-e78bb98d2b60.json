{
    "id": "e339a9a0-0865-411b-aa33-e78bb98d2b60",
    "created_at": "2023-01-12T14:59:41.983536Z",
    "updated_at": "2025-03-27T02:08:23.169007Z",
    "deleted_at": null,
    "sha1_hash": "5f636d0a0efb65749df21c617e0afb78d9875c28",
    "title": "2021-10-04 - Phish, Phished, Phisher- A Quick Peek Inside a Telegram Harvester",
    "authors": "",
    "file_creation_date": "2022-05-28T23:37:03Z",
    "file_modification_date": "2022-05-28T23:37:03Z",
    "file_size": 1325115,
    "plain_text": "# Phish, Phished, Phisher: A Quick Peek Inside a Telegram Harvester\n\n**[blog.nviso.eu/2021/10/04/phish-phished-phisher-a-quick-peek-inside-a-telegram-harvester/](https://blog.nviso.eu/2021/10/04/phish-phished-phisher-a-quick-peek-inside-a-telegram-harvester/)**\n\nOctober 4, 2021\n\nThe tale is told by many: to access this document, “Sign in to your account” — During our daily\nManaged Detection and Response operations, NVISO handles hundreds of user-reported phishing\nthreats which made it past commercial anti-phishing solutions. To ensure user safety, each report is\ncarefully reviewed for Indicators of Compromise (IoCs) which are blocked and shared in threat\nintelligence feeds.\n\nIt is quite common to observe phishing pages on compromised hosts, legitimate services or, as will be\nthe case for this blog post, directly delivered as an attachment. While it is trivial to get a phishing page,\nidentifying a campaign’s extent usually requires global telemetry.\n\nIn one of the smaller campaigns we monitored last month (September 2021), the threat actor\ninadvertently exposed Telegram credentials to their harvester. This opportunity provided us some insight\ninto their operations; a peek behind the curtains we wanted to share.\n\n## From Phish\n\nThe initial malicious attachment, reported by an end-user, is a typical phishing attachment file ( .htm )\ndelivered by a non-business email address ( hotmail[.]co[.]uk ), courtesy of “Onedrive for\n_Business”. While we have observed some elaborate attempts in the past, it is quite obvious from a first_\nglance that little effort has been put into this attempt.\n\n\n-----\n\nFigure 1: A capture of the reported email with the spoofed recipient name, recipient and warning-banner\nredacted.\nUpon opening the phishing attachment, the user would be presented with a pre-filled login form. The\nform impersonates the usual Microsoft login page in an attempt to grab valid credentials.\n\n\n-----\n\nFigure 2: A capture of the Office 365 phishing attachment with the pre-filled credentials redacted.\nIf the user is successfully tricked into signing-in, a piece of in-line Javascript exfiltrates the credentials to\na harvesting channel. This is performed through a simple `GET request towards the`\n```\napi[.]telegram[.]org domain with the phished email address, password and IP included as\n\n```\nparameters.\n\n\n-----\n\nFigure 3: A capture of the credential harvesting Javascript code.\nAs the analysis of the `1937990321 campaign’s document exposed harvester credentials, our curiosity`\nled us to identify additional documents and campaigns through VirusTotal Livehunt.\n\n**Campaign** **Operator** **Bot** **Lures** **Victims**\n\n`1937990321` `ade` `allgood007bot` Office 365 400\n\n\n127\n\n```\n1036920388 PRo \\u2714\\ufe0f\n\n```\n( Emhacker )\n\n\n`proimp1_bot` M&T Bank,\n_Unknown_\n\n\nFigure 4: An overview of Telegram-based campaigns with code-similarity.\n\n\n-----\n\n-----\n\nFigure 5: A capture of the Excel (left) and US-based M&T Bank (right) lures.\nWhile we managed to identify the M&T Bank campaign ( 1036920388 ), we were unable to identify\nsuccessful phishing attempts. Most of the actor’s harvesting history contained bad data, with occasional\nstolen data originating from unknown lures. As such, the remainder of this blog post will not take the\n```\n1036920388 dataset into account.\n\n## To Phished\n\n```\nThroughout the second half of September, the malicious Telegram bots exfiltrated over 3.386 credentials\nbelonging to 495 distinct victims.\n\nFigure 6: Telegram channel messages over time.\n\n\n-----\n\nIf we take a look at the victim repartitions in figure 7, we can notice a distinct phishing of UK-originating\naccounts.\n\nFigure 7: The victims’ geographical proportions.\nOver 94% of the phished accounts belong to the non-corporate Microsoft mail services. These personal\naccounts are usually more vulnerable as they lack both enterprise-grade protections (e.g.: Microsoft\nDefender for Office 365) and policies (e.g.: Azure AD Conditional Access Policies).\n\n\n-----\n\nFigure 8: The victims’ domain proportions.\nWhile the 5% of collected corporate credentials can act as initial access for hands-on-keyboard\noperations, do the remaining 95% get discarded?\n\n## To Phisher\n\nOne remaining fact of interest in the `1937990321 campaign’s dataset is the presence of a`\ncompromised `alisonb account as can be observed in figure 9.`\n\nFigure 9: A compromise account\n\nre-used for phishing delivery.\n\n\n-----\n\nThe `alisonb account is in fact the original account that targeted one of NVISO s customers. This`\nhighlights the common cycle of phishing:\n\nCorporate accounts are filtered for initial access.\nRemaining accounts are used for further phishing.\n\n[Identifying these accounts as soon as they’re compromised allows us to preemptively gray-list them,](https://en.wikipedia.org/wiki/Greylisting_(email))\nmaking sure the phishing cycle gets broken.\n\n## The Baddies\n\nThe Telegram channels furthermore contain records of the actors starting ( /start command) and\ntesting their collection methods. These tests exposed two IPs likely part of the actors’ VPN\ninfrastructure:\n```\n   91[.]132[.]230[.]75 located in Russia\n   149[.]56[.]190[.]182 located in Canada\n\n```\nFigure 10: The threat actor performing end-to-end tests.\nIn addition to the above test messages, we managed to identify an actor’s screen capture of the\nconversation. By cross-referencing the message times with the obtained logs we can assess with high\nconfidence that the `1168596795 campaign operator` `eric jones ‘s device is operating from the`\nUTC+2 time zone in English.\n\n\n-----\n\nFigure 11: An actor-made screen capture of the test\n\nmessages.\nTo further confirm our theory, we can observe additional Telegram messages originating from the above\nactor IPs. The activity taking place between 9AM (UTC) and 10PM (UTC) tends to confirm the Canadian\nserver is indeed geographically distant from the actor suspected of operating in UTC+2.\n\nFigure 12: The threat actor interactions by time of the day (UTC).\n\n## Final Thoughts\n\nWe rarely get the opportunity to peek behind a phishing operation’s curtains. While the observed\ncampaigns were quite small, identifying the complete phishing cycle with the `alisonb account was`\nquite satisfying.\n\nOur short analysis of the events enabled NVISO to protect its customers from accounts likely used for\nphishing in the coming days and further act as a reminder of how even obvious phishing emails can be\nsuccessful nonetheless.\n\n## Indicators and Rules\n\n Lures\n\n\n-----\n\nThe following files were analyzed to identify harvester credentials. Many more Excel lures can be\nidentified through the `EXCELL typo` [in VirusTotal.](https://www.virustotal.com/gui/search/content%253A%2520%2522%253D%253D%2520EXCELL%2520LOG%2520%253D%253D%2522/files)\n\n**SHA256** **Campaign** **Lure**\n\n`696f2cf8a36be64c281fd940c3f0081eb86a4a79f41375ba70ca70432c71ca29` `1937990321` Office\n365\n\n`2cc9d3ad6a3c2ad5cced10a431f99215e467bfca39cf02732d739ff04e87be2d` `1168596795` Excel\n\n`209b842abd1cfeab75c528595f0154ef74b5e92c9cc715d18c3f89473edfeff9` `1168596795` Excel\n\n`acc4c5c40d11e412bb343357e493d22fae70316a5c5af4ebf693340bc7616eae` `1168596795` Excel\n\n`b7c8bb9e149997630b53d80ab901be1ffb22e1578f389412a7fdf1bd4668a018` `1168596795` Excel\n\n`e36dd51410f74fa6af3d80c2193450cf85b4ba109df0c44f381407ef89469650` `1168596795` Excel\n\n`a7af7c8b83fc2019c4eb859859efcbe8740d61c7d98fc8fa6ca27aa9b3491809` `1168596795` Excel\n\n`ba9dd2ae20952858cdd6cfbaff5d3dd22b4545670daf41b37a744ee666c8f1dc` `1036920388` M&T\nBank\n\n`36368186cf67337e8ad69fd70b1bcb8f326e43c7ab83a88ad63de24d988750c2` `1036920388` M&T\nBank\n\n`7772cf6ab12cecf5ff84b23830c12b03e9aa2fae5d5b7d1c8a8aaa57525cb34e` `1036920388` M&T\nBank\n\n## Yara\n\n\n-----\n\n```\n//For a VirusTotal Livehunt rule, uncomment the vt related statements.\n//import \"vt\"\nrule phish_telegram_bot_api: testing TA0001 T1566 T1566_001\n{\n  meta:\n    description = \"Detects the presence of the Telegram Bot API endpoint often used as\negress\"\n    author   = \"Maxime THIEBAUT (@0xThiebaut)\"\n    date    = \"2021-09-30\"\n    reference  = \"https://blog.nviso.eu/2021/10/04/phish-phished-phisher-a-quick-peekinside-a-telegram-harvester/\"\n    tlp     = \"white\"\n    status   = \"testing\"\n    tactic   = \"TA0001\"\n    technique  = \"T1566.001\"\n    hash1    = \"696f2cf8a36be64c281fd940c3f0081eb86a4a79f41375ba70ca70432c71ca29\"\n  strings:\n    $endpoint  = \"https://api.telegram.org/bot\"\n    $command  = \"/sendMessage\"\n    $option1  = \"chat_id\"\n    $option2  = \"text\"\n    $option3  = \"parse_mode\"\n    $script   = \"<script>\"\n  condition:\n    all of them //and vt.metadata.file_type == vt.FileType.HTML\n}\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-10-04 - Phish, Phished, Phisher- A Quick Peek Inside a Telegram Harvester.pdf"
    ],
    "report_names": [
        "2021-10-04 - Phish, Phished, Phisher- A Quick Peek Inside a Telegram Harvester.pdf"
    ],
    "threat_actors": [
        {
            "id": "81dde5cc-c29f-430d-8c6e-e5e92d5015e7",
            "created_at": "2022-10-25T16:07:23.704358Z",
            "updated_at": "2025-03-27T02:02:09.932453Z",
            "deleted_at": null,
            "main_name": "Harvester",
            "aliases": [],
            "source_name": "ETDA:Harvester",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "Graphon",
                "Metasploit",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535581,
    "ts_updated_at": 1743041303,
    "ts_creation_date": 1653781023,
    "ts_modification_date": 1653781023,
    "files": {
        "pdf": "https://archive.orkl.eu/5f636d0a0efb65749df21c617e0afb78d9875c28.pdf",
        "text": "https://archive.orkl.eu/5f636d0a0efb65749df21c617e0afb78d9875c28.txt",
        "img": "https://archive.orkl.eu/5f636d0a0efb65749df21c617e0afb78d9875c28.jpg"
    }
}