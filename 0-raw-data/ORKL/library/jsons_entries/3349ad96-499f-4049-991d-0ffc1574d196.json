{
    "id": "3349ad96-499f-4049-991d-0ffc1574d196",
    "created_at": "2023-01-12T15:02:04.883224Z",
    "updated_at": "2025-03-27T02:14:05.259302Z",
    "deleted_at": null,
    "sha1_hash": "33fe566b94bb1fe1e152841eeb94bec9635c004d",
    "title": "2022-03-01 - Decryptable PartyTicket Ransomware Reportedly Targeting Ukrainian Entities",
    "authors": "",
    "file_creation_date": "2022-05-28T23:22:24Z",
    "file_modification_date": "2022-05-28T23:22:24Z",
    "file_size": 631814,
    "plain_text": "# How to Decrypt the PartyTicket Ransomware Targeting Ukraine\n\n**[crowdstrike.com/blog/how-to-decrypt-the-partyticket-ransomware-targeting-ukraine/](https://www.crowdstrike.com/blog/how-to-decrypt-the-partyticket-ransomware-targeting-ukraine/)**\n\nCrowdStrike Intelligence Team March 1, 2022\n\n## Summary\n\nOn Feb. 23, 2022, destructive attacks were conducted against Ukrainian entities. Industry\nreporting has claimed the Go-based ransomware dubbed PartyTicket (or HermeticRansom)\nwas identified at several organizations affected by the attack, among other families including1\na sophisticated wiper CrowdStrike Intelligence tracks as DriveSlayer (HermeticWiper).\n\nAnalysis of the PartyTicket ransomware indicates it superficially encrypts files and does not\nproperly initialize the encryption key, making the encrypted file with the associated\n\n`.encryptedJB` extension recoverable.\n\n## Technical Analysis\n\n\n-----\n\nA PartyTicket ransomware sample has a SHA256 hash of\n```\n4dc13bb83a16d4ff9865a51b3e4d24112327c526c1392e14d56f20d6f4eaf382 . It has been\n\n```\nobserved associated with the file names `cdir.exe,` `cname.exe,` `connh.exe and`\n```\nintpub.exe .\n\n```\nThe ransomware sample — written using Go version 1.10.1 — contains many symbols that\nreference the U.S. political system, including `voteFor403,`\n```\nC:/projects/403forBiden/wHiteHousE and primaryElectionProcess .\n\n```\nThe ransomware iterates over all drive letters and recursively enumerates the files in each\ndrive and its subfolders, excluding file paths that contain the strings `Windows and` `Program`\n```\nFiles and the folder path C:\\Documents and Settings (the latter folder was replaced in\n\n```\nWindows versions later than Windows XP with `C:\\Users ). Files with the following`\nextensions are selected for encryption:\n```\nacl, avi, bat, bmp, cab, cfg, chm, cmd, com, contact, crt, css, dat, dip,\ndll, doc, docx, dot, encryptedjb, epub, exe, gif, htm, html, ico, in, iso,\njpeg, jpg, mp3, msi, odt, one, ova, pdf, pgsql, png, ppt, pptx, pub, rar,\nrtf, sfx, sql, txt, url, vdi, vsd, wma, wmv, wtv, xls, xlsx, xml, xps, zip\n\n```\nFor each file path that passes the previously described path and extension checks, the\nransomware copies an instance of itself to the same directory it was executed from and\nexecutes via the command line, passing the file path as an argument. The parent\nransomware process names its clones with a random UUID generated by a public library2\nthat uses the current timestamp and MAC addresses of the infected host’s network adapters.\n\nThe malware developer attempted to use Go’s `WaitGroup types to implement concurrency;`\nhowever, due to a likely coding error, the ransomware creates a very large number of threads\n(one per enumerated file path) and copies its own binary into the current directory as many\ntimes as there are selected files. After all encryption threads have ended, the original binary\ndeletes itself via the command line.\n\nWhen the sample receives a file path as an argument, it encrypts the file using AES in\nGalois/Counter Mode (GCM). The AES key is generated using the Go `rand package’s`\n```\nIntn function to select offsets in the character array\n1234567890ABCDEFGHIJKLMNOPQRSTUVWXYZ, generating a 32-byte key. Due to another\n\n```\nlikely coding error, the seed for the `Intn function is updated after the key is generated,`\nmeaning the same AES key is generated each time the binary and its clones are run. All of\nthe files encrypted on a host are encrypted with the same key, and knowledge of the\ncorresponding PartyTicket sample’s key enables their decryption. A script using this flaw to\n[recover the encrypted files is available on the CrowdStrike Git Repository.](https://github.com/CrowdStrike/PartyTicketDecryptor)\n\nFor each file, the AES encryption key is itself encrypted with RSA-OAEP, using a public RSA\nkey that has the following parameters:\n\n\n-----\n\n```\nModulus (N):\n0xcbb94cb189a638b51e7cfe161cd92edb7145ecbd93989e78c94f8c15c61829286fd834d80c931daed4ac\nExponent (E): 0x10001\n\n```\nBefore encryption, the ransomware renames the file using the format `<original file`\n```\nname>.[vote2024forjb@protonmail[.]com].encryptedJB (“JB” very likely stands for the\n\n```\ninitials of the United States president Joseph Biden, given the other political content in the\nbinary). The ransomware then overwrites the content with the encrypted data. PartyTicket\nwill only encrypt the first 9437184 bytes (9.44 MB) of a file. If the file passed as an argument\nis larger than this limit, any data above it is left unencrypted. After the file contents are\nencrypted, PartyTicket appends the RSA-encrypted AES key at the end of the file.\n\nThe ransomware also writes an HTML ransom note on the user’s desktop directory with the\nname `read_me.html before the file encryption starts (Figure 1). Unless they are intentional`\nmistakes, grammar constructs within the note suggest it was likely not written or proofread by\na fluent English speaker.\n\nFigure 1. Ransom note\n\n## Assessment\n\nCrowdStrike Intelligence does not attribute the PartyTicket activity to a named adversary at\nthe time of writing.\n\n\n-----\n\nThe ransomware contains implementation errors, making its encryption breakable and slow.\nThis flaw suggests that the malware author was either inexperienced writing in Go or\ninvested limited efforts in testing the malware, possibly because the available development\ntime was limited. In particular, PartyTicket is not as advanced as DriveSlayer, which\nimplements low-level NTFS parsing logic. The relative immaturity and political messaging of\nthe ransomware, the deployment timing and the targeting of Ukrainian entities are consistent\nwith its use as an additional payload alongside DriveSlayer activity, rather than as a\nlegitimate ransomware extortion attempt.\n\n### YARA Signatures\n\nThe following YARA rule can be used to detect PartyTicket:\n\n\n-----\n\n```\nrule CrowdStrike_PartyTicket_01 : ransomware golang \n{\n  meta:\n    copyright = \"(c) 2022 CrowdStrike Inc.\"\n    description = \"Detects Golang-based crypter\"\n    version = \"202202250130\"\n    last_modified = \"2022-02-25\"\n  strings:\n    $ = \".encryptedJB\" ascii\n    $start = { ff 20 47 6f 20 62 75 69 6c 64 20 49 44 3a 20 22 }\n    $end = { 0a 20 ff }\n  condition:\n    uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and\n    for 1 of ($end) : ( @start < @ and @start + 1024 > @) and\n    all of them\n}\nrule CrowdStrike_PartyTicket_02 : PartyTicket golang \n{\n  meta:\n    copyright = \"(c) 2022 CrowdStrike Inc.\"\n    description = \"Detects Golang-based PartyTicket ransomware\"\n    version = \"202202250130\"\n    last_modified = \"2022-02-25\"\n   strings:\n    $s1 = \"voteFor403\"\n    $s2 = \"highWay60\"\n    $s3 = \"randomiseDuration\"\n    $s4 = \"subscribeNewPartyMember\"\n    $s5 = \"primaryElectionProces\"\n    $s6 = \"baggageGatherings\"\n    $s7 = \"getBoo\"\n    $s8 = \"selfElect\"\n    $s9 = \"wHiteHousE\"\n    $s10 = \"encryptedJB\"\n    $goid = { ff 20 47 6f 20 62 75 69 6c 64 20 49 44 3a 20 22 71 62 30 48 37 41\n64 57 41 59 44 7a 66 4d 41 31 4a 38 30 42 2f 6e 4a 39 46 46 38 66 75 70 4a 6c 34 71\n6e 45 34 57 76 41 35 2f 50 57 6b 77 45 4a 66 4b 55 72 52 62 59 4e 35 39 5f 4a 62 61\n2f 32 6f 30 56 49 79 76 71 49 4e 46 62 4c 73 44 73 46 79 4c 32 22 0a 20 ff }\n    $pdb = \"C://projects//403forBiden//wHiteHousE\"\n  condition:\n    (uint32(0) == 0x464c457f or (uint16(0) == 0x5a4d and uint16(uint32(0x3c)) ==\n0x4550)) and 4 of ($s*) or $pdb or $goid\n}\n\n### Script to Decrypt PartyTicket Encrypted Files\n\n```\nDue to the previously discussed implementation errors in the AES key generation, it is\npossible to recover the AES key used for encryption by PartyTicket. The below Go script\ndecrypts files encrypted by PartyTicket sample\n```\n4dc13bb83a16d4ff9865a51b3e4d24112327c526c1392e14d56f20d6f4eaf382 . The script\n\n```\n\n-----\n\ntakes the file to be decrypted as an argument via the -p flag and saves the decrypted\noutput to “decrypted.bin” in the same directory. The script can be built as an executable or\nrun via the Go run package; it was tested using Go version go1.16.6.\n\n\n-----\n\n```\npackage main\nimport (\n     \"crypto/aes\"\n     \"crypto/cipher\"\n     \"encoding/hex\"\n     \"fmt\"\n     \"os\"\n     \"flag\"\n)\nfunc main() {\n     encrypted_filepath := flag.String(\"p\", \"encrypted.bin\", \"Path to encrypted\nfile\")\n     flag.Parse()\n     fmt.Printf(\"Decrypting file : %s\\n\", *encrypted_filepath)\n     key_bytes := []byte(\"6FBBD7P95OE8UT5QRTTEBIWAR88S74DO\")\n     key := hex.EncodeToString(key_bytes)\n     fmt.Printf(\"Decryption key : %s\\n\", key_bytes)\n     dat, err := os.ReadFile(*encrypted_filepath)\n     if err != nil {\n          fmt.Println(\"Unable to open file, please supply path of encrypted\nfile with flag -p, default file path is ./encrypted.bin\")\n          os.Exit(3)\n     }\n     decrypted_filepath := \"decrypted.bin\"\n     filecontents := dat\n     encrypted_contents := filecontents[:len(filecontents) - 288]\n     enc_size := len(encrypted_contents)\n     bsize := 1048604\n     cycles := enc_size / bsize\n     if cycles == 0{ \n          encrypted := hex.EncodeToString(encrypted_contents)\n          decrypted := decrypt(encrypted, key)\n          write_output(decrypted_filepath, decrypted)\n          } else {\n              for i:=0; i<cycles; i++ { if i >= 9 {\n                        start := 9 * bsize\n                        end := enc_size\n                        data := string(encrypted_contents[start:end])\n                        write_output(decrypted_filepath, data)\n                        break\n                   }\n                   block_start := i * bsize\n                   block_end := (i+1) * bsize\n                   if block_end > enc_size{\n                        block_end := enc_size\nencrypted:=hex.EncodeToString(encrypted_contents[block_start:block_end])\n\n```\n\n-----\n\n```\n                        decrypted : decrypt(encrypted, key)\n                        write_output(decrypted_filepath, decrypted)\n                   }\nencrypted:=hex.EncodeToString(encrypted_contents[block_start:block_end])\n                   decrypted := decrypt(encrypted, key)\n                   write_output(decrypted_filepath, decrypted)\n              }\n          }\n          fmt.Printf(\"Decrypted file written to : %s\\n\", decrypted_filepath)\n     }\nfunc write_output(filepath string, data string) {\n          f, err := os.OpenFile(filepath, os.O_APPEND|os.O_CREATE|os.O_WRONLY,\n0644)\n          if err != nil {\n              panic(err)\n          }\n          byte_data := []byte(data)\n          f.Write(byte_data)\n          f.Close()\n}\nfunc decrypt(encryptedString string, keyString string) (decryptedString string) {\n     key, _ := hex.DecodeString(keyString)\n     enc, _ := hex.DecodeString(encryptedString)\n     block, err := aes.NewCipher(key)\n     if err != nil {\n          panic(err.Error())\n     }\n     aesGCM, err := cipher.NewGCM(block)\n     if err != nil {\n          panic(err.Error())\n     }\n     nonceSize := aesGCM.NonceSize()\n     nonce, ciphertext := enc[:nonceSize], enc[nonceSize:]\n     plaintext, err := aesGCM.Open(nil, nonce, ciphertext, nil)\n     if err != nil {\n          panic(err.Error())\n     }\n     return fmt.Sprintf(\"%s\", plaintext)\n}\n\n## Endnotes\n\n```\n1. https[:]//symantec-enterprise-blogs.security[.]com/blogs/threat-intelligence/ukraine\nwiper-malware-russia\n\n\n-----\n\n2. https[:]//pkg.go.dev/github[.]com/satori/go.uuid#NewV1\n\n**Additional Resources**\n\n_Read more about use of offensive cyber operations against Ukraine: Lessons Learned_\n_[From Successive Use of Offensive Cyber Operations Against Ukraine and What May](https://www.crowdstrike.com/blog/lessons-from-past-cyber-operations-against-ukraine/)_\n_Be Next._\n_Learn how CrowdStrike Falcon provides continuous protection against DriveSlayer and_\n_wiper-style threats:_ _CrowdStrike Falcon Protects from New Wiper Malware Used in_\n_Ukraine Cyberattacks_\n_Read about about WhisperGate in this CrowdStrike Intelligence blog: Technical_\n_Analysis of the WhisperGate Malicious Bootloader._\n_Learn about the powerful, cloud-native CrowdStrike Falcon platform by visiting the_\n_product webpage._\n_[Get a full-featured free trial of CrowdStrike Falcon Prevent to see for yourself how true](https://go.crowdstrike.com/try-falcon-prevent.html)_\n_next-gen AV performs against today’s most sophisticated threats._\n\nPROPHET SPIDER Exploits Citrix ShareFile Remote Code Execution Vulnerability CVE-2021-22941 to\nDeliver Webshell\n\nAt the start of 2022, CrowdStrike Intelligence and CrowdStrike Services investigated an\nincident in which PROPHET SPIDER exploited CVE-2021-22941 — a remote code\nexecution (RCE) vulnerability impacting Citrix ShareFile Storage Zones Controller — to\ncompromise a Microsoft Internet Information Services (IIS) web server. The adversary\nexploited the vulnerability to deploy a webshell that enabled the […]\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-01 - Decryptable PartyTicket Ransomware Reportedly Targeting Ukrainian Entities.pdf"
    ],
    "report_names": [
        "2022-03-01 - Decryptable PartyTicket Ransomware Reportedly Targeting Ukrainian Entities.pdf"
    ],
    "threat_actors": [
        {
            "id": "8a33d3ac-14ba-441c-92c1-39975e9e1a73",
            "created_at": "2023-01-06T13:46:39.195689Z",
            "updated_at": "2025-03-27T02:00:03.01861Z",
            "deleted_at": null,
            "main_name": "Ghostwriter",
            "aliases": [
                "PUSHCHA",
                "Storm-0257",
                "DEV-0257",
                "UAC-0057",
                "UNC1151",
                "TA445"
            ],
            "source_name": "MISPGALAXY:Ghostwriter",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "056826cb-6e17-4954-a9b4-2cc8c6ae3cb8",
            "created_at": "2023-03-04T02:01:54.115678Z",
            "updated_at": "2025-03-27T02:00:03.125249Z",
            "deleted_at": null,
            "main_name": "Prophet Spider",
            "aliases": [
                "GOLD MELODY",
                "UNC961"
            ],
            "source_name": "MISPGALAXY:Prophet Spider",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "119c8bea-816e-4799-942b-ff375026671e",
            "created_at": "2022-10-25T16:07:23.957309Z",
            "updated_at": "2025-03-27T02:02:10.048343Z",
            "deleted_at": null,
            "main_name": "Operation Ghostwriter",
            "aliases": [
                "DEV-0257",
                "Operation Asylum Ambuscade",
                "PUSHCHA",
                "Storm-0257",
                "TA445",
                "UAC-0051",
                "UAC-0057",
                "UNC1151"
            ],
            "source_name": "ETDA:Operation Ghostwriter",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "HALFSHELL",
                "Impacket",
                "RADIOSTAR",
                "VIDEOKILLER",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "47b52642-e5b8-4502-b714-b625002d86aa",
            "created_at": "2024-06-19T02:03:08.086579Z",
            "updated_at": "2025-03-27T02:05:17.385492Z",
            "deleted_at": null,
            "main_name": "GOLD MELODY",
            "aliases": [
                "UNC961",
                "PROPHET SPIDER"
            ],
            "source_name": "Secureworks:GOLD MELODY",
            "tools": [
                " 7-ZIP",
                " AUDITUNNEL",
                " BURP Suite",
                " GOTROJ",
                " JSP webshells",
                " Mimikatz",
                " Wget",
                "7-ZIP"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535724,
    "ts_updated_at": 1743041645,
    "ts_creation_date": 1653780144,
    "ts_modification_date": 1653780144,
    "files": {
        "pdf": "https://archive.orkl.eu/33fe566b94bb1fe1e152841eeb94bec9635c004d.pdf",
        "text": "https://archive.orkl.eu/33fe566b94bb1fe1e152841eeb94bec9635c004d.txt",
        "img": "https://archive.orkl.eu/33fe566b94bb1fe1e152841eeb94bec9635c004d.jpg"
    }
}