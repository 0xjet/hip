{
    "id": "1b73fc37-c509-44ea-8343-ec2a3cab0944",
    "created_at": "2023-01-12T15:05:08.151964Z",
    "updated_at": "2025-03-27T02:16:57.94056Z",
    "deleted_at": null,
    "sha1_hash": "c5d51aa7c50818c5981fb74368a3a8e63e18cf15",
    "title": "2017-01-17 - Carbanak Group uses Google for malware command-and-control",
    "authors": "",
    "file_creation_date": "2022-05-28T02:07:44Z",
    "file_modification_date": "2022-05-28T02:07:44Z",
    "file_size": 203913,
    "plain_text": "# Carbanak Group uses Google for malware command-and-control\n\n**[forcepoint.com/blog/x-labs/carbanak-group-uses-google-malware-command-and-control](https://www.forcepoint.com/blog/x-labs/carbanak-group-uses-google-malware-command-and-control)**\n\nJanuary 17, 2017\n\nX-Labs\n\nJanuary 17, 2017\n\nNicholas Griffin Security Researcher\n\n[Google](https://www.forcepoint.com/blog/tags/google) [Malware](https://www.forcepoint.com/blog/tags/malware)\nForcepoint Security Labs™ recently investigated a trojanized RTF document which we tied to the Carbank\ncriminal gang. The document contains an encoded Visual Basic Script (VBScript) typical of previous\nCarbanak malware. Recent samples of the malware have now included the ability to use Google services for\ncommand-and-control (C&C) communication. We have notified Google of the abuse and are working with\nthem to share additional information.\n\nCarbanak (also known as Anunak) are a group of financially motivated criminals first exposed in 2015. The\nactors typically steal from financial institutions using targeted malware. Recently a new Carbanak attack\n[campaign dubbed \"Digital Plagiarist\" was exposed where the group used weaponized office documents](https://www.tr1adx.net/intel/TIB-00002.html)\nhosted on mirrored domains, in order to distribute malware.\n\n## Weaponized document\n\nThe RTF document we analyzed (SHA1 1ec48e5c0b88f4f850facc718bbdec9200e4bd2d) has an\n[embedded OLE object which contains a VBScript file. When the document is opened the targeted user is](https://en.wikipedia.org/wiki/Object_Linking_and_Embedding)\nlured into double-clicking on the embedded OLE object which is disguised as an image:\n\n\n-----\n\nDouble clicking on the image results in a file open dialog for \"unprotected.vbe\". If the user executes this file\nthen the VBScript malware will begin to execute.\n\n## Encoded VBScript malware\n\nThe VBScript malware inside the RTF document (SHA1 cd75662751c59951717b4704ea2cdb6fb7ec19bc) is\nan encoded VBScript file. We decoded the script and found hallmarks typical of the Carbanak group's\nVBScript malware, however we also found the addition of a new \"ggldr\" script module.\n\nThe module is base64 encoded inside the main VBScript file along with various other VBScript modules\nused by the malware. When we analyzed the script we noticed that it is capable of using Google services as\na C&C channel.\n\n### Abusing Google for C&C communication\n\nThe \"ggldr\" script will send and receive commands to and from Google Apps Script, Google Sheets, and\nGoogle Forms services. For each infected user a unique Google Sheets spreadsheet is dynamically created\nin order to manage each victim. The use of a legitimate third party service like this one gives the attacker the\nability to hide in plain sight. It is unlikely that these hosted Google services are blocked by default in an\norganization, so it is more likely that the attacker will establish a C&C channel successfully.\n\nThe C&C procedure is outlined in the diagram below.\n\n\n-----\n\nUpon the first attempt to contact the hard-coded Google Apps Script URL with the user's unique infection ID,\nthe C&C will state that no spreadsheet currently exists for the user. The malware will then send two requests\nto another hard-coded Google Forms URL which will result in the creation of unique Google Sheets\nspreadsheet and Google Form IDs for the victim.\n\nThe second time the Google Apps Script is requested, the C&C will return the unique Google Sheet and\nGoogle Form ID values:\n\nThe \"entry\" value is also a unique ID which is sent with each subsequent Google Forms C&C request.\n\n## Protection statement\n\nForcepoint™ customers are protected against this threat via TRITON® ACE at the following stages of\nattack:\n\n**Stage 5 (Dropper File) - The malware components are prevented from being downloaded and/or executed.**\n\n\n-----\n\n**Stage 6 (Call Home) - The HTTP-based Carbanak C&C traffic is blocked.**\n\n## Summary\n\nThe Carbanak actors continue to look for stealth techniques to evade detection. Using Google as an\nindependent C&C channel is likely to be more successful than using newly created domains or domains with\nno reputation. Forcepoint will continue to monitor this group's activities and share data with trusted partners.\n\n## Indicators of Compromise\n\n### Carbanak Documents\n```\n 1ec48e5c0b88f4f850facc718bbdec9200e4bd2d (3 ThompsonDan.rtf)\n 400f02249ba29a19ad261373e6ff3488646e95fb (order.docx)\n 88f9bf3d6e767f1d324632b998051f4730f011c3 (claim.rtf)\n\n Carbanak Google Apps Script C&Cs\n hxxps://script.google[.]com/macros/s/AKfycbzuykcvX7j3TlBNyQfxtB1mqii31b4VTON640yiRJT0t6rS4s4/\n exec\n hxxps://script.google[.]com/macros/s/AKfycbxxx5DHr0F8AYhLuDjnp7kGNELq6g27J4c_JWWx1p1nDfZh6InO\n /exec\n hxxps://script.google[.]com/macros/s/AKfycbwZHCgg5EsCiPup_mNxDbSX7k7yBMeXWenOVN1BWXHmyBpb8ng/\n exec\n\n Carbanak Google Forms C&Cs\n hxxps://docs.google[.]com/forms/d/e/1FAIpQLScx9gwNadC7Vjo11mXLbU3aBQRrqVpoWjmNJ1ZneqpjaYLE3g/formRes\n ponse\n hxxps://docs.google[.]com/forms/d/e/1FAIpQLSfE9kshYBFSDAfRclW8m9rAdajqoYhzhEYmEAgZexE3LQ 17A/formResponse\n hxxps://docs.google[.]com/forms/d/e/1FAIpQLSdcdE7lTEiqV5MW3Up8Hgcy5NGkIKnLKoe0YPFriD4_9qYq9A/formRes\n ponse\n\n Carbanak C&Cs\n hxxp://atlantis bahamas[.]com/css/informs.jsp\n hxxp://138[.]201[.]44[.]4/informs.jsp\n\n Carbanak Cobalt Strike / Meterpreter DNS Beacon C&Cs\n\n```\n\n-----\n\n```\n aaa.stage.15594901.en.onokder[.\n ]com\n aaa.stage.4710846.ns3.kiposerd[\n .]com\n\n### About Forcepoint\n\n```\nForcepoint is the leading user and data protection cybersecurity company, entrusted to safeguard\norganizations while driving digital transformation and growth. Our solutions adapt in real-time to how people\ninteract with data, providing secure access while enabling employees to create value.\n\n[Learn more about Forcepoint](https://www.forcepoint.com/company/about-us)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-01-17 - Carbanak Group uses Google for malware command-and-control.pdf"
    ],
    "report_names": [
        "2017-01-17 - Carbanak Group uses Google for malware command-and-control.pdf"
    ],
    "threat_actors": [
        {
            "id": "c9617bb6-45c8-495e-9759-2177e61a8e91",
            "created_at": "2022-10-25T15:50:23.405039Z",
            "updated_at": "2025-03-27T02:00:55.462193Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Carbanak",
                "Anunak"
            ],
            "source_name": "MITRE:Carbanak",
            "tools": [
                "Carbanak",
                "Mimikatz",
                "PsExec",
                "netsh"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f4f16213-7a22-4527-aecb-b964c64c2c46",
            "created_at": "2024-06-19T02:03:08.090932Z",
            "updated_at": "2025-03-27T02:05:17.387119Z",
            "deleted_at": null,
            "main_name": "GOLD NIAGARA",
            "aliases": [
                "Carbanak",
                "Carbon Spider ",
                "FIN7 ",
                "Navigator ",
                "Sangria Tempest ",
                "TelePort Crew ",
                "Calcium "
            ],
            "source_name": "Secureworks:GOLD NIAGARA",
            "tools": [
                " Carbanak",
                " Cobalt Strike",
                " DICELOADER",
                " DRIFTPIN",
                " GGLDR",
                " GRIFFON",
                " JSSLoader",
                " Meterpreter",
                " OFFTRACK",
                " PILLOWMINT",
                " POWERTRASH",
                " SUPERSOFT",
                " TAKEOUT",
                " TinyMet",
                "Bateleur"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "bb8702c5-52ac-4359-8409-998a7cc3eeaf",
            "created_at": "2023-01-06T13:46:38.405479Z",
            "updated_at": "2025-03-27T02:00:02.82533Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "JokerStash",
                "ATK32",
                "G0046",
                "Coreid",
                "Carbanak",
                "Sangria Tempest",
                "CARBON SPIDER",
                "GOLD NIAGARA",
                "G0008",
                "ELBRUS",
                "Carbon Spider"
            ],
            "source_name": "MISPGALAXY:FIN7",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ed3810b7-141a-4ed0-8a01-6a972b80458d",
            "created_at": "2022-10-25T16:07:23.443259Z",
            "updated_at": "2025-03-27T02:02:09.801771Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Anunak",
                "Carbanak",
                "Carbon Spider",
                "ELBRUS",
                "Gold Waterfall",
                "Sangria Tempest"
            ],
            "source_name": "ETDA:Carbanak",
            "tools": [
                "AVE_MARIA",
                "Agentemis",
                "AmmyyRAT",
                "Antak",
                "Anunak",
                "Ave Maria",
                "AveMariaRAT",
                "BABYMETAL",
                "BIRDDOG",
                "Backdoor Batel",
                "Batel",
                "Bateleur",
                "BlackMatter",
                "Boostwrite",
                "Cain & Abel",
                "Carbanak",
                "Cl0p",
                "Cobalt Strike",
                "CobaltStrike",
                "DNSMessenger",
                "DNSRat",
                "DNSbot",
                "DRIFTPIN",
                "DarkSide",
                "FOXGRABBER",
                "FlawedAmmyy",
                "HALFBAKED",
                "JS Flash",
                "KLRD",
                "MBR Eraser",
                "Mimikatz",
                "Nadrac",
                "Odinaff",
                "POWERPIPE",
                "POWERSOURCE",
                "PsExec",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "SocksBot",
                "SoftPerfect Network Scanner",
                "Spy.Agent.ORM",
                "TEXTMATE",
                "TeamViewer",
                "TiniMet",
                "TinyMet",
                "Toshliph",
                "VB Flash",
                "WARPRISM",
                "avemaria",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535908,
    "ts_updated_at": 1743041817,
    "ts_creation_date": 1653703664,
    "ts_modification_date": 1653703664,
    "files": {
        "pdf": "https://archive.orkl.eu/c5d51aa7c50818c5981fb74368a3a8e63e18cf15.pdf",
        "text": "https://archive.orkl.eu/c5d51aa7c50818c5981fb74368a3a8e63e18cf15.txt",
        "img": "https://archive.orkl.eu/c5d51aa7c50818c5981fb74368a3a8e63e18cf15.jpg"
    }
}