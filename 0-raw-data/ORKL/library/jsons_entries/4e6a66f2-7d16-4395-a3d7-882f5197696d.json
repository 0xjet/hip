{
    "id": "4e6a66f2-7d16-4395-a3d7-882f5197696d",
    "created_at": "2023-01-12T15:10:44.51789Z",
    "updated_at": "2025-03-27T02:14:42.874495Z",
    "deleted_at": null,
    "sha1_hash": "71c72057acae01f689905ec5a8f2f8349d536aa8",
    "title": "2019-06-24 - Ransomware REvil - Sodinokibi- Technical analysis and Threat Intelligence Report",
    "authors": "",
    "file_creation_date": "2022-05-28T23:45:36Z",
    "file_modification_date": "2022-05-28T23:45:36Z",
    "file_size": 3205282,
    "plain_text": "# News - Malware & Hoax\n\n**tgsoft.it/english/news_archivio_eng.asp**\n\n24/06/2019\n\n17:14\n\n## Ransomware REvil - Sodinokibi: Technical analysis and Threat Intelligence Report\n\n The Sodinokibi ransomware, also known as REvil, made its first appearance in April 2019 and seems to have filled the hole left behind GandCrab\n\n\n-----\n\n**Sodinokibi ransomware, also known as REvil, made it first**\nappearance in April 2019, where it looks to exploit the Oracle WebLogic\nServer vulnerability to propagate itself.\n\nC.R.A.M. (Research Centre Anti-Malware) of TG Soft has analysed\nransomware evolution in the last few months.\n\nDownload the report in PDF: Technical analysis and Threat\n**Intelligence REPORT**\n\nLast update: 2019-08-08\n\n## Introduction\n\n\n**SUMMARY**\n\n**==>** Infection\nVector\n\n**==>** Sodinokibi\nRansomware\nAnalysis\n\n**==>** Calculate\nthe private and\npublic keys\n\n**==>** sk_key\nData Structure\n\n**==>** 0_key Data\nStructure\n\n**==>** Registry\nKey “stat”\n\n**==>** Ransom\ninstruction\n\n**==>** File\nencryption\n\n**==>** C2 Server\n\n**==>** Ransom\npayment\n\n**==>** How does\ndecryption\nwork?\n\n**==>** Versions\n\n**==>** Telemetry\n\n**==>** Conclusion\n\n\n-----\n\nIn Italy it made first appearance in May 24th 2019, with a RDP attack, as we\nposted in the tweet of May 28th 2019:\n\nThe authors of Sodinokibi ransomware, even if they are the first versions of\ntheir creation, seem to have a long experience in this threats of cyber-crime.\n\nSome researchers have identified the similarities with GandCrab ransomware,\nwhose project was shut down in beginning June. It seems that Sodinokibi\nransomware is the right candidate to fill the hole left behind GandCrab.\n\n## Infection Vector\n\nSodinokibi ransomware uses different methods of propagation:\n\nOracle WebLogic Server Vulnerability\nRDP attacks\nSpam Campaigns\nWatering hole\nExploit kit and malvertising\n\nIn Italy, we have observed that Sodinokibi ransomware used various methods of\npropagation. All such methods have been found in Italy except Oracle WebLogic Server\nvulnerability.\n\nThe first attack that we have record was on 24th May 2019, in this case the infection vector\nwas through RDP attack. This kind of infection vector execute a brute force on credentials, it\nhas already been used by other ransomware as Dharma.\n\nInterestingly, the IP 151.106.56[.]254 used by cyber criminal to access via RDP was the\nsame IP dentified in other RDP attacks in June of this year.\n\nAffiliates have used spam campaigns to distributed Sodinokibi ransomware, that was\nrecorded in June. A new campaign was discovered which deals:\n\nBooking.com\nDHL\n\n“Booking.com” campaign in the summer months, is very apt choose with the summer\nholiday season approaches, it may induce the victims to open the attachment.\n\nIn the images below, we can see the two malspam campaigns of Sodinokibi.\n\n\n-----\n\nIn Italy the first case of watering hole was recorded on website “winrar.it” a distributor of\nWinRar in Italy. For the whole day on Wednsday the 19th June was downloaded Sodinokibi\ninstead of setup of WinRar.\n\nIn 2016 “winrar.it” website was already attacked by APT StrongPity, here too this was\nwatering hole attack, in which the setup of WinRar was modified to include and downloaded\n[also StrongPity spy malware.](https://www.tgsoft.it/english/news_archivio_eng.asp?id=781)\n\nIf in 2016 the attack on “winrar.it” was organized by a professional cyber-espionage\norganization, in the attack of this year the attackers have replaced the setup of WinRar with\nSodinokibi. Who downloaded WinRar in the afternoon of 19th June, could find something\nstrange in the downloaded file, the icons, actually, are not like the WinRar ones, as we can\nsee in the figures below:\n\nIn addition, the execution of file does not downloaded WinRar, as has been the case of\nStronPity ransomware.\n\nAttackers have poorly exploited the watering hole attack to winrar.it.\n\nIn other cases involving the spread of Sodinokibi, registered in Italy on 7th June 2019, were\nutilized malvertising attack .\n\nThe authors of Sodinokibi seem to be very active in spreading the ransomware.\n\n**Back on top**\n\n\n-----\n\n## Sodinokibi Ransomware Analysys\n\nThen we analyze Sodinokibi version 1.1.\nWhen the file infected from ransomware is executed, Sodinokibi generates a different mutex\nfor each build, as en example :\n\nGlobal\\D382D713-AA87-457D-DDD3-C3DDD8DFBC96\n\nA section of the file infected is decrypted with RC4, this section contains the configuration of\nthe malware structured in this way:\n\n{\n\"pk\": \"\",\n\"pid\": \"\",\n\"sub\": \"\",\n\"dbg\":,\n\"fast\":,\n\"wipe\":,\n\"wht\": {\n\"fld\": [],\n\"fls\": [],\n\"ext\": []\n},\n\"wfld\": [],\n\"prc\": [],\n\"dmn\": \"\",\n\"net\":,\n\"nbody\": \"\",\n\"nname\": \"\",\n\"exp\":,\n\"img\": \"\"\n}\n\nIn the table below we see the description of the fields:\n\n**Field** **Description**\n\npk Public Key in base64\n\npid Identifier of distributor\n\nsub Identifier of subscription\n\ndbg Debug: true/false\n\n\n-----\n\nfast True/False\n\nwipe True/False\n\nwht -> fld Folder exclusions\n\nwht -> fls Files exclusions\n\nwht -> ext Exclusion of the extension\n\nwfld Wipe folder\n\nprc Process to terminate\n\ndmn Domains C2\n\nnet Files encryption in the network: true/false\n\nnbody Instructions for payment\n\nnname {EXT}-readme.txt ( EXT is the extension of file encrypted)\n\nexp Exploit True/False\n\nimg Image contained in alert encryption on the desktop\n\n\n-----\n\nIf \"exp\" field is \"true\" then a 32 or 64 bit shellcode is executed with\nthe exploit CVE-2018-8453 through the elevation of privilege.\n\nThe next step is create a registry key REcfg if it is not already\nexist:\n\nHKEY_LOCAL_MACHINE\\SOFTWARE\\recfg\n\nIf the key do not have permissions, it is created in\nHKEY_CURRENT_USER.\nThe following values are created within REcfg:\n\npk_key\nsk_key\n0_key\nrnd_ext\nstat\n\n**Back on top**\n\n## Calculate the private and public keys\n\nNow the private and the public keys are calculated, as we can see in the figure:\n\nPrivate and public keys are calculated in this way:\n\n\n-----\n\nThe private key was generated from random number of 256 bit, from the figure we can see\nthe random number generation subroutine PRNG (PseudoRandom Number Generators):\n\n\n-----\n\nThe function to generate PRNG use the hardware Intel Ivy Bridge, based on\nNIST’s SP 800-90 guidelines, through the call to assembly rdrand\ninstruction.\n\nThe random number generated, before it becomes private key, is elaborated\nin this way:\n\nAt this point, starting from private key was generated public key. The private and public keys\nare generated using ECC (Elliptic Curve Cryptography).\n\nThe keys (private and public) are both two numbers of 256 bit, which define two points on the\nelliptic curve.\n\nThe Exchange of the keys is made with the “Elliptic Curve Diffie-Hellman” (ECDH) method,\nwhere:\n\nd P = d PA B B A\n\n\n-----\n\nGiven G a fixed point of the curve, where:\n\nd = private key of A (secret random number)A\nP = G*d = public key of A (G multiplied by d )A A A\nd = private key of B (secret random number)B\nP = G*d = public key of BB B\n\n\nSodinokibi use eliptic curve “Curve25519”, in which G={9}, developed by Dan Bernestein, as\nsupposed in the post of Eric Klonowski (@noblebarstool) on Twitter.\nAfter Sodinokibi has generated the ECC pair of keys in the memory, which we call dk_key\n(private key) and pk_key (public key), the public key is stored in the recfg regisry key inside\nof the value pk_key:\n\nHKEY_LOCAL_MACHINE\\SOFTWARE\\recfg\n\n[pk_key] = Public Key\n\n**Back on top**\n\n## sk_key Data Structure\n\nAt this point sk_key data structure is generated by the call to Sub_13597B subroutine:\n\npBuff_sk_key = Sub_13597B (key_pubblica_json, key_privata, size IN, size out)\n\nThe Sub_13597B aims to encrypt the private key generated inside sk_key data structure.\n\nThe Sub_13597B takes 4 input parameters:\n\nkey_pubblica_json: public key “pk” inside the json configuration section\nkey_privata: private key generated “dk”\nsize IN: size of “dk”\nsize out: sk_key structure dimension\n\n\n-----\n\nSub_13597B subroutine execute the following steps:\n\nAllocate a buffer of 0x58 byte and copy the private key (dk_key) “key_privata”\nfrom offset 0x4 into buffer\n\n1. Calculate a new pairs of ECC keys, one private (dk_new) and one\n\npublic (pk_new)\n2. Calculate dk_new*pk -> shared_key_new (where pk is public key inside\n\nthe json configuration section) and the result is “hashato” with SHA-3.\n3. Calculate a random number of 16 byte -> random_16, it will be used as\n\nIV (initialization vector forAES)\n4. Encrypts the buffer allocated from 0 to 0x24 via AES-256 CTR through\n\nthe IV initialization vector and SHA-3 (shared_key_new)\n5. Copy the public key pk_new into buffer allocated at offset 0x24\n6. Copy the random number random_16 into buffer allocated at offset 0x44\n7. Calculate the CRC32 of the buffer allocated from 0 to 0x24 and save the\n\nresult at offset 0x54\n8. Sub_13597B subroutine returns the pointer to buffer that is allocated to\n\nof 0x58 byte inside the sk_key data structure.\n\nsk_key data structure, as we see on the right figure, will be stored in the\nregistry under the same name.\n\nWe can see the call to AES-256 in CTR mode, in the figure below:\n\n\n-----\n\nAES CTR takes the following scheme:\n\n\n-----\n\n**Back on top**\n\n## 0_key Data Structure\n\n0_key data structure is generated in a similar way, by the call to Sub_13597B\nsubroutine:\n\npBuff_0_key = Sub_13597B (master_key_pubblica, key_privata, size IN, size out)\n\nThe procedure for generation of 0_key data structure is similar to that of sk_key\ndata structure, in this case it is used a “master public key” stored inside a\nexecutable file instead of the public key pk (the one inside the json configuration\nsection).\n\nThe “embedded” master public key is:\n\n79 CD 20 FC E7 3E E1 B8 1A 43 38 12 C1 56 28 1A\n\n04 C9 22 55 E0 D7 08 BB 9F 0B 1F 1C B9 13 06 35\n\nInside the 0_key data structure we have the dk private key encrypted through the\n“master public key”. 0_key data structure, as we see in the figure on the right, will\nbe saved in the registry under the same name.\n\n## Registry Key “rnd_ext”\n\nThe value “rnd_ext” is stored inside the registry key REcfg, it contains the encrypted file\nextension randomly calculated.\n\n## Registry Key “stat””\n\nThe value “stat” is stored inside the registry key REcfg, it contains the following string\nformatted:\n\n\n-----\n\n{\"ver\":%d,\"pid\":\"%s\",\"sub\":\"%s\",\"pk\":\"%s\",\"uid\":\"%s\",\"sk\":\"%s\",\n\n\"unm\":\"%s\",\"net\":\"%s\",\"grp\":\"%s\",\"lng\":\"%s\",\"bro\":%s,\"os\":\"%s\",\n\n\"bit\":%d,\"dsk\":\"%s\",\"ext\":\"%s\"}\n\nIt is stored in “stat” in encrypted and base64 encoded form.\n\n**Name** **Description**\n\nver Version of Sodinokibi\n\npid PID of json\n\nsub SUB of json\n\npk PK ofl json\n\nuid CRC32 of “processor brand string” and Volume Serial Number (8 bytes)\n\nsk sk_key in BASE64\n\nunm Username\n\nnet Name of computer\n\nGrp Name of workgroup or domain\n\nlng Language ID\n\nbro True / False if the ID of language is a \"friend\"\n\nOs Operating System\n\nBit Value: 86 or 64\n\nDsk Information of diski in base 64 (drive and free space)\n\nExt Extension of encrypted filei\n\nCountries considered “friends” on the basis of the “bro” value:\n\nRomania\nRussia\nUcraina\nBielorussia\nEstonia\nLettonia\nLituania\n\n\n-----\n\nTajikistan\nIran\nArmenia\nAzerbaijan\nGeorgia\nKazakistan\nKyrgyzstan\nTurkmenistan\nUzbekistan\n\nThe Sodinokibi ransomware ends the current process if the keyboard language belong to the\nlist of countries considered \"friends\".\n\nThe “stat” formatted string is encrypted with a master public key stored inside a executable\nfile.\n\nThe master public key “embedded” is:\n\n36 7D 49 30 85 35 C2 C3 68 60 4B 4B 7A BE 83 53\n\nAB E6 8E 42 F9 C6 62 A5 D0 6A AD C6 F1 7D F6 1D\n\n**Back on top**\n\n## Ransom instruction\n\nRansom instruction are prepared from the body, which is extracted from the “nbody” field of\nthe json configuration.\n\nThe body is formatted with the following value:\n\nuid\nrnd_ext\nstat in base 64\n\nThe “uid” is the user ID calculated from CRC of “processor brand string” and Volume Serial\nNumber, which is used to compose the URL where to make the ransom payment:\n\nhttp://aplebzu47wgazapdqks6vrcv6zcnjppkbxbr6wketf56nf6aq2nmyoyd.onion/<uid>\nhttp://decryptor.top/<uid>\n\n## Terminate Processes and delete Shadow Copy\n\nThe processes listed in the JSON configuration under “prc” are killed and the Windows\nShadow copy with the following command are deleted:\n\n\n-----\n\ncmd.exe /c vssadmin.exe Delete Shadows /All /Quiet & bcdedit /set {default}\nrecoveryenabled No & bcdedit /set {default} bootstatuspolicy ignoreallfailures\n\n## Wipe\n\nThen the malware checks the \"wipe\" value in the JSON configuration and if set to true it\ndeletes all the files contained in the folders that correspond to the \"wfld\" value of the JSON\nconfiguration.\n\n## File encryption\n\nA Thread is created which is pending on function “GetQueuedCompletionStatus”.\n\nFiles on local disk and network folder are numbered (if the “net” parameter of JSON\nconfiguration is a “true” value) then proceed with file encryption.\n\nIn every folder is created a .lock file and the instructions regarding the ransom with name\n{random extension}-readme.txt.\n\nFiles and folders that correspond to the JSON \"wht\" field containing the subfields \"fld\", \"fls\"\nand \"ext\", which are respectively for \"folder\", \"files\" and \"extension\" are excluded from\nencryption.\n\nHere is an example:\n\n\"wht\": {\n\"fld\": [\"google\", \"mozilla\", \"$windows.~bt\", \"programdata\", \"$recycle.bin\", \"program\nfiles (x86)\", \"appdata\", \"msocache\", \"program files\", \"windows.old\", \"$windows.~ws\",\n\"application data\", \"perflogs\", \"windows\", \"boot\", \"intel\", \"system volume information\", \"tor\nbrowser\"],\n\"fls\": [\"bootsect.bak\", \"autorun.inf\", \"ntldr\", \"ntuser.dat.log\", \"ntuser.ini\", \"boot.ini\",\n\"ntuser.dat\", \"bootfont.bin\", \"desktop.ini\", \"thumbs.db\", \"iconcache.db\"],\n\"ext\": [\"exe\"]\n}\n\nFor each file intended to encryption is generated a Salsa20 key, as follows:\n\n\n-----\n\nEncryption algorithm used by Sodinokibi is Salsa20.\n\nThe encryption key for Salsa20 is obtained in this way:\n\n1. Calculate a new pairs of ECC private/public keys (dk_new_file, pk_new_file)\n2. Calculate SHA-3 (dk_new_file*pk_key) -> shared_key_salsa (where pk_key is a public\n\nkey stored inside registry under pk_key voice). In shared_key_salsa we will obtained\nthe key which is plugged in Salsa20 master table.\n3. Calculate a random number of 8 byte for the initialization vector of the Salsa20 master\n\ntable.\n4. Composes the Salsa20 master table.\n\nIt is created in memory a data structure that holds:\n\nHandle of the file to be encrypted\nsk_key\n0_key\npk_new_file\nInitialization vector of Salsa20\nThe CRC32 of pk_new_file\n\n\n-----\n\nMaster table of Salsa20\n\nThis data structure is passed to the Thread created previously through the API functions:\n\nCreateIoCompletationPort\nPostQueuedCompletionStatus\n\nThe thread is pending on the GetQueuedCompletionStatus API function, when it receives a\nnew call it starts the file encryption phase through the Salsa20 algorithm and then appends a\npart of the data structure that contains the following fields:\n\nsk_key\n0_key\npk_new_file\nInitialization vector of Salsa20\nThe CRC32 of pk_new_file\n\nThe size of the appending part varies according to the version of the Sodinokibi malware. In\nversions 1.0 and 1.1 the length is 0xE0 bytes whereas in version 1.2 it is 0xE4 bytes.\n\nIn the figure we can see the encryption scheme of Sodinokibi version 1.1:\n\n**Back on top**\n\n## Desktop image\n\n\n-----\n\nAt the end of the files encryption, the next step is to modify the desktop\nimage, which we can see in the figure on the right.\n\nThe image is generated using API functions for the graphics and the text is\ninserted using “DrawText” function, that is loaded in “img” field through\nJSON configuration.\n\n## C2 Server\n\nWe find a list of 1079 domains inside the JSON configuration. Sodinokibi makes a\nconnection with each domain of this list generating a URL through a DGA algorithm using the\nfollowing terms:\n\n**Term** **Extension**\n\n\nwp-content\npictures\nnews\npics\nadmin\ndata\ntemp\ngraphic\ngame\nstatic\nassets\ntmp\nuploads\nimages\ninclude\nimage\ncontent\n\n\njpg\ngif\npng\n\n\n**https://<host>/<term 1>/<term 2>/<random chars>.<extension>**\n\nSome examples:\n\nhttps://stagefxinc[.]com/wp-content/pictures/pmkapi.jpg\n\nhttps://birthplacemag[.]com/admin/pictures/hpxxqbak.gif\n\nhttps://clemenfoto[.]dk/news/pics/ohxkyt.gif\n\nhttps://wineandgo[.]hu/admin/pics/ahlpbrzo.jpg\n\nhttps://lexced[.]com/data/temp/hpttgdyg.png\n\nSodinokibi transmits through a \"POST\" to each domain of the list the \"stat\" data structure in\nencrypted form.\n\n\n-----\n\nFrom our analysis only the following domains responded with HTTP / 1.1 200 OK :\n\n\nwww[.]zuerich-umzug[.]ch\nbelofloripa[.]be\nwww[.]soundseeing[.]net\nutilisacteur[.]fr\nwww[.]airserviceunlimited[.]com\nwww[.]mediahub[.]co[.]nz\nwww[.]irizar[.]com\nwww[.]cleanroomequipment[.]ie\nwww[.]pinkxgayvideoawards[.]com\nwww[.]rhino-turf[.]com\nmike[.]matthies[.]de\ndrbenveniste[.]com\nscotlandsroute66[.]co[.]uk\nm2graph[.]fr\n\n\ngeitoniatonaggelon[.]gr\ninsane[.]agency\nacb-gruppe[.]ch\nwww[.]cardsandloyalty[.]com\nwww[.]sbit[.]ag\nyourhappyevents[.]fr\ntieronechic[.]com\nmariajosediazdemera[.]com\nwww[.]skyscanner[.]ro\n11[.]in[.]ua\nfunworx[.]de\nwww[.]omnicademy[.]com\nwww[.]bratek-immobilien[.]de\nmetroton[.]ru\n\n\nBut this does not mean that one of these domains is that of Sodinokibi C2 Server.\n**Back on top**\n\n## Ransom payment\n\nAccording to the ransom instructions, the victim have to connect to the following domains for\nthe payment methods:\n\nhttp://aplebzu47wgazapdqks6vrcv6zcnjppkbxbr6wketf56nf6aq2nmyoyd[.]onion/<uid>\nhttp://decryptor[.]top/<uid>\n\nVictims are requested to enter first thing (img.1), the random extension and the “Key” value\ncontained in ransom instructions (it is the “stat” version encrypted on base64).\n\nWhen victims input this data the payment amount is generated (img.2) and are provided\ninformation on how to purchase BitCoin (img.3), and in addition a support chat is included\n(img.4), as we can see in the following images:\n\n\n**img.1**\n\n\n**img.2**\n\n\n**img.3**\n\n\n**img.4**\n\n\nThe wallet for payment is generated automatically for each victim, the ransom price is $\n2,500 it doubles to $ 5,000 if payment is not made within 7 days.\n\n\n-----\n\n## How does decryption work?\n\nThe only way to recover the encrypted files by Sodinokibi is with a “dk_key” private key. The\ndecryption key is encrypted inside “sk_key” and “0_key”.\n\nThe attacker recovered “dk_key” in these ways:\n\n1. Decrypting sk_key\n2. Decrypting 0_key\n\nNow in order to decrypt “sk_key” the attacker use a secret key, the private key\n“dk”, which only they know. The private key “dk” is the symmetric key of the\npublic key “pk” stored in the json configuration.\nThe public key “pk_new” is put in unencrypted way inside “sk_key” structure.\nIt is calculated the value: dk * pk_new = shared_key_new\nThe “shared_key_new” is the same as: dk_new*pk.\n\nThe private key (dk_key) is encrypted with AES-256 CTR through the \"SHA-3\n_(shared_key_new\" and the random number (IV) which is on offset 0x44._\nDecrypting the buffer from 0x4 to 0x24 with AES-256, through \"SHA-3\n_(shared_key_new)\" and the random number you get \"dk_key\"._\n\nNow the same procedure can be performed to decrypted “0_key”, in this case is\nused the master private key, which only the authors of Sodinokibi know, to get\n“dk_key”.\n\nNow we know dk_key so to determinate the encryption key used in Salsa20 we\nexecute the following operation:\n\n_SHA-3 (dk_key *pk_new_file) = shared_key_salsa_\n\nWhere the public key pk_new_file is put in unencrypted way at the end of the\nencrypted file.\n\n_shared_key_salsa is also equals to SHA-3 (dk_new_file*pk_key)_\n\nIn shared_key_salsa we will have the key that is inserted in the Salsa20 master\n_table._\nNow it is possible to decrypt the files through shared_key_salsa.\n\n\n-----\n\n**Back on top**\n\n## Versions\n\nThe authors of Sodinokibi have developed the following versions:\n\n**Version** **Date** **Size appending data**\n\n1.0a 2019-04-23 0xe0\n\n1.0b 2019-04-27 0xe0\n\n1.0c 2019-04-29 0xe0\n\n1.1 2019-05-05 0xe0\n\n1.2 2019-06-10 0xe4\n\n1.3a 2019-07-08 0xe4\n\n1.3b 2019-08-02 0xe4\n\n### Version 1.2\n\nIn version 1.2 the registry key \"sub_key \" has been added which contains the public key of\nthe json configuration (pk) and the data size in the encrypted files is 0xe4 bytes, where an\nadditional control dword with value 0 has been added.\n\n### Version 1.3\n\n\n-----\n\nIn this version has been added a field called “svc” in the json config. This\nfield contains a list of services to delete, as we can see in the figure.\n\nFurthermore to verify if the victim is from a “friend” country, in addition to\ncheck of language of keyboard has been added checks on the default\nlanguage and on system language, as we can see in the figure.\n\nIt uses WQL to determinate the creation of processes:\n\nSELECT * FROM __InstanceCreationEvent WITHIN 1 WHERE TargetInstance ISA\n'Win32_Process'\n\nFurthermore it uses a new key of registry instead of “REcfg”:\n\n**HKEY_LOCAL_MACHINE\\SOFTWARE\\QtProject\\OrganizationDefaults**\n\nInside to QtProject\\OrganizationDefaults are saved the following values:\n\npvg\nsxsP\nBDDC8\nf7gVD7\nXu7Nnkd\nsMMnxpgk\n\nTable of comparison for the version 1.2 and 1.3:\n\n**Vers. 1.2: REcfg** **Vers. 1.3a: QtProject\\OrganizationDefaults**\n\nsub_key pvg\n\npk_key sxsP\n\nsk_key BDDC8\n\n\n-----\n\n0_key f7gVD7\n\nrnd_ext Xu7Nnkd\n\nstat sMMnxpgk\n\n## Telemetry\n\nThe trend of Sodinokibi malware campaigns has been monitored between April and July\n2019.\n\nIn the table below we can see the campaigns monitored:\n\nThe fields from the table are the following:\n\n1. Campaign Date\n2. Type of Campaign\n3. PK (public key inside the JSON configuration)\n4. PID present in JSON configuration\n\n\n-----\n\n5. SUB present in JSON configuration\n6. Sodinokibi version\n7. Date the master file of Sodinokibi is compiled\n\nPID field identify the group has acquired the service Sodinokibi ransomware (RAAS). SUB\nfield probably identify “SUBSCRIPTION” that is the period of validity of the service.\n\nThe pairs of PID & SUB with identical value have the same public key (PK), how we can see\nin the case of PID:7 and SUB: 3.\n\nThe campaign with PID 7 was the first to use Oracle Weblogic vulnerability to distribute the\nransomware on 25 April 2019 (SUB:3), the same group seems to be associated with the\nWatering Hole attack campaign to distributor of WinRar in Italy on 19th June 2019 with a new\nSUB: 474.\n\nAs we can see, the group with PID: 7 has purchased more subscription periods. Using the\nthree parameters PID-SUB-PK, one can identify the campaign associated with the same\nactor.\n\nUntil early July of this year, the PID 40 was the highest value, this suggests that there are at\nleast 40different groups. The highest value of SUB was 607 which could indicate that at least\n607 subscription periods have been purchased.\n\nWe compare in the graphic here below, the date of compilation of the malware and the SUB\nvalue present in json configuration. It is possible to see how the curve growth strongly\nsuggesting that the Sodinokibi CryptoMalware is distributed with the “as-a-service” method.\n\n**Back on top**\n\n\n-----\n\n## Conclusion\n\nThe authors of Sodinokibi are individuals with a certain level of technical knowledge and\nprobably this ransomware is not their first creation and it is actively developed.\n\nThis project is developed to be distributed with model RaaS (Ransomware-as-a-Service).\n\nSodinokibi ransomware uses for file encryption the algorithm Salsa20 with a key exchange\nmethod based on ECDH.\n\nSodinokibi operation spreads wide in the last month, through a different methods to distribute\nthe ransomware via Malspam, RigEK, RDP attacks, ecc. The attackers with the recent\ndecision to shutting down GandCrab Ransomware operation left a hole, that seem to\nexploited by Sodinokibi.\n\n## IOC\n\n**MD5:**\n\nDB42F17991A7BA10218649B978D78674\n\nE713658B666FF04C9863EBECB458F174\n\n16863F6727BC5DD44891678EBCA492D2\n\nFD3F3AF76D31D8F134E2E02463D89D29\n\n6E543C13594F987A6051BC3D9456499F\n\nCCFDE149220E87E97198C23FB8115D5A\n\nFB68A02333431394A9A0CDBFF3717B24\n\n692870E1445E372DDD82AEDD2D43F9B8\n\nDB6D3A460DEDE97CA7E8C5FBFAEF3A72\n\n48A673157DA3940244CE0DFB3ECB58E9\n\n79F2341510D9FB5291AEFC3E69D18253\n\n3DF42FA9732864A9755F5C8FB7ED456A\n\n**URL:**\n\naplebzu47wgazapdqks6vrcv6zcnjppkbxbr6wketf56nf6aq2nmyoyd[.]onion\n\ndecryptor[.]top\n\n**Back on top**\n\nAuthors: Gianfranco Tonello, Michele Zuin and Federico Girotto\n\nTG Soft's Research Centre (C.R.A.M.)\n\n_Any information published on our site may be used and published on other websites, blogs, forums, facebook and/or_\n\n_in any other form both in paper and electronic form as long as the source is always and in any case cited explicitly_\n\n_“Source: CRAM by TG Soft www.tgsoft.it” with a clickable link to the original information and / or web page from_\n\n\n-----\n\n_which textual content, ideas and / or images have been extrapolated._\nIt will be appreciated in case of use of the information of C.R.A.M. by TG Soft www.tgsoft.it in the report of summary\n\narticles the following acknowledgment/thanks “Thanks to Anti-Malware Research Center C.R.A.M. by TG Soft of\n\nwhich we point out the direct link to the original information: [direct clickable link]”\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-06-24 - Ransomware REvil - Sodinokibi- Technical analysis and Threat Intelligence Report.pdf"
    ],
    "report_names": [
        "2019-06-24 - Ransomware REvil - Sodinokibi- Technical analysis and Threat Intelligence Report.pdf"
    ],
    "threat_actors": [
        {
            "id": "67fbc7d7-ba8e-4258-b53c-9a5d755e1960",
            "created_at": "2022-10-25T16:07:24.077859Z",
            "updated_at": "2025-03-27T02:02:10.101173Z",
            "deleted_at": null,
            "main_name": "Promethium",
            "aliases": [
                "APT-C-41",
                "Promethium",
                "StrongPity"
            ],
            "source_name": "ETDA:Promethium",
            "tools": [
                "StrongPity",
                "StrongPity2",
                "StrongPity3",
                "Truvasys"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "cbede712-4cc3-47c6-bf78-92fd9f1beac6",
            "created_at": "2022-10-25T15:50:23.777222Z",
            "updated_at": "2025-03-27T02:00:55.544919Z",
            "deleted_at": null,
            "main_name": "PROMETHIUM",
            "aliases": [
                "PROMETHIUM",
                "StrongPity"
            ],
            "source_name": "MITRE:PROMETHIUM",
            "tools": [
                "Truvasys",
                "StrongPity"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "4660477f-333f-4a18-b49b-0b4d7c66d482",
            "created_at": "2023-01-06T13:46:38.511962Z",
            "updated_at": "2025-03-27T02:00:02.852307Z",
            "deleted_at": null,
            "main_name": "PROMETHIUM",
            "aliases": [
                "StrongPity",
                "G0056"
            ],
            "source_name": "MISPGALAXY:PROMETHIUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536244,
    "ts_updated_at": 1743041682,
    "ts_creation_date": 1653781536,
    "ts_modification_date": 1653781536,
    "files": {
        "pdf": "https://archive.orkl.eu/71c72057acae01f689905ec5a8f2f8349d536aa8.pdf",
        "text": "https://archive.orkl.eu/71c72057acae01f689905ec5a8f2f8349d536aa8.txt",
        "img": "https://archive.orkl.eu/71c72057acae01f689905ec5a8f2f8349d536aa8.jpg"
    }
}