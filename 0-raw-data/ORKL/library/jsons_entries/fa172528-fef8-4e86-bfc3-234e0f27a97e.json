{
    "id": "fa172528-fef8-4e86-bfc3-234e0f27a97e",
    "created_at": "2022-10-25T16:48:11.597823Z",
    "updated_at": "2025-03-27T02:06:06.633019Z",
    "deleted_at": null,
    "sha1_hash": "28c56a1e795cd404308274424d10edcc3e9b4339",
    "title": "Scanbox: A Reconnaissance Framework Used With Watering Hole Attacks",
    "authors": "Alienvault",
    "file_creation_date": "2014-10-28T14:20:49Z",
    "file_modification_date": "2014-10-28T14:20:49Z",
    "file_size": 1128069,
    "plain_text": "# Attacks\n\nA few days ago we detected a watering hole campaign in a website owned by one big industrial company.\n\nThe website is related to software used for simulation and system engineering in a wide range of\n\nindustries, including automotive, aerospace, and manufacturing.\n\nThe attackers were able to compromise the website and include code that loaded a malicious Javascript\n\nfile from a remote server. This Javascript file is a framework for reconnaissance that the attackers call\n\n\"Scanbox\" and includes some of the techniques we described in a previous blog post: Attackers abusing\n\nInternet Explorer to enumerate software and detect security products\n\nThe Scanbox framework first configures the remote C&C server that it will use and collects a small amount\n\nof information about the victim that is visiting the compromised website including:\n\nReferer\n\nUser-Agent\n\nLocation\n\nCookie\n\nTitle (To identify specific content that the victim is visiting)\n\nDomain\n\nCharset\n\nScreen width and height\n\nOperating System\n\nLanguage\n\nResulting in something like this:\n\n\n-----\n\nfollowing function:\n\nProducing the following request:\n\nIf we decrypt the data it translates to:\n\nAfter the first request, the framework contains several plugins to extract different information from the\n\nvictim.\n\n**[Pluginid 1: Enumerates software installed in the system using the technique we explained before that](https://www.alienvault.com/open-threat-exchange/blog/attackers-abusing-internet-explorer-to-enumerate-software-and-detect-securi)**\n\naffects Internet Explorer. It also checks if the system is running different versions of EMET (Enhanced\n\nMitigation Experience Toolkit):\n\n\n-----\n\nProducing the list of security software on the target\n\n\n-----\n\n**Pluginid 2: Enumerates Adobe Flash versions**\n\n**Pluginid 5: Enumerates Microsoft Office versions**\n\n**Pluginid 6: Enumerates Acrobat Reader versions**\n\n**Pluginid 8: Enumerates Java versions**\n\n**Pluginid 21: Implements a “keylogger” functionality trough Javascript that logs all the keystrokes the**\n\nvictim is typing inside the compromised website.\n\n\n-----\n\n-----\n\nC&C periodically. It will also send keystrokes when the user submits web forms that can potentially\n\ninclude passwords and other sensitive data.\n\nAs we have seen, this is a very powerful framework that gives attackers a lot of insight into the potential\n\ntargets that will help them launching future attacks against them.\n\nWe have also seen several Metasploit-produced exploits that target different versions of Java in the same\n\nIP address that hosts the Scanbox framework (122.10.9[.]109).\n\nWe recommend you look for this type of activity against the following machines in your network:\n\nmail[.]webmailgoogle.com\n\njs[.]webmailgoogle.com\n\n122[.]10.9.109\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/vlbe0y40djeaadl2l4iqdm13cju3v3n6",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2014/2014.08.28.Scanbox_Framework_Watering_Hole_Attack/Alienvault_Scanbox.pdf"
    ],
    "report_names": [
        "Alienvault_Scanbox"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716491,
    "ts_updated_at": 1743041166,
    "ts_creation_date": 1414506049,
    "ts_modification_date": 1414506049,
    "files": {
        "pdf": "https://archive.orkl.eu/28c56a1e795cd404308274424d10edcc3e9b4339.pdf",
        "text": "https://archive.orkl.eu/28c56a1e795cd404308274424d10edcc3e9b4339.txt",
        "img": "https://archive.orkl.eu/28c56a1e795cd404308274424d10edcc3e9b4339.jpg"
    }
}