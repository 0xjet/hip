{
    "id": "4a7d30fd-8d5d-480f-8e43-aa969d6359f2",
    "created_at": "2023-01-12T15:01:34.284829Z",
    "updated_at": "2025-03-27T02:06:14.747676Z",
    "deleted_at": null,
    "sha1_hash": "cb8dbc1cf43eae4a488e18a67c2a130121c6b908",
    "title": "2016-03-23 - SamSam- The Doctor Will See You, After He Pays The Ransom",
    "authors": "",
    "file_creation_date": "2022-05-28T21:43:46Z",
    "file_modification_date": "2022-05-28T21:43:46Z",
    "file_size": 692623,
    "plain_text": "# SamSam: The Doctor Will See You, After He Pays The Ransom\n\n**blog.talosintel.com/2016/03/samsam-ransomware.html**\n\nCisco Talos is currently observing a widespread campaign leveraging the\nSamas/Samsam/MSIL.B/C ransomware variant. Unlike most ransomware, SamSam is not\nlaunched via user focused attack vectors, such as phishing campaigns and exploit kits. This\nparticular family seems to be distributed via compromising servers and using them as a\nfoothold to move laterally through the network to compromise additional machines which are\nthen held for ransom. A particular focus appears to have been placed on the healthcare\nindustry.\n\n[Adversaries have been seen leveraging JexBoss, an open source tool for testing and](https://github.com/joaomatosf/jexboss)\nexploiting JBoss application servers, to gain a foothold in the network. Once they have\naccess to the network they proceed to encrypt multiple Windows systems using SamSam.\n\n## Technical Details\n\nUpon compromising the system the sample will launch a samsam.exe process which begins\nthe process of encrypting files on the system.\n\n\n-----\n\nSamSam encrypts various file types (see Appendix A) with Rijndael and then encrypts that\nkey with RSA-2048 bit encryption. This makes the files unrecoverable unless the author\nmade a mistake in the implementation of the encryption algorithms. The adversaries behind\nthis ransomware variant did not go to any length to disguise or cover up the ransomware\nactivity on the system. The samples Talos obtained are not packed and do not contain antidebugging features.\n\nOne interesting note regarding the samples Talos has observed is that the malware will abort\nthe encryption routine if the system is running a version of Microsoft Windows prior to Vista.\nThis is likely done for compatibility reasons. Once installed on a machine there is no\nbeaconing or C2 activity. The ransomware is effectively self sufficient.\n\nBelow is an example of the communication between a victim and the adversaries. Notice in\nthis instance, the victim initially paid for one PC and followed up by paying for all affected\nPCs.\n\n\n-----\n\n## Tools\n\nThere were a couple of open source tools that were seen being leveraged by the\nadversaries. The first is JexBoss, which is a testing and exploitation framework for JBoss\napplication servers. This was being used as an initial infection vector to gain a foothold in the\nnetwork to spread the ransomware. The second is a component of REGeorg, tunnel.jsp.\nREGeorg is an open source framework to create socks proxies for communication. The file\nfound in the samples is an unmodified version of the tunnel.jsp file that is being hosted by\nREGeorg (b963b8b8c5ca14c792d2d3c8df31ee058de67108350a66a65e811fd00c9a340c).\n\n## Payment Evolution\n\nAs we have monitored this activity, we have started to see changes in the amount and types\nof payment options available to victims. Initially, we saw a payment option of 1 bitcoin for\neach PC that has been infected.\n\n\n-----\n\nLater we saw the price for a single system has been raised to 1.5 bitcoin. It is likely the\nmalware author is trying to see how much people will pay for their files. They even added an\noption for bulk decryption of 22 bitcoin to decrypt all infected systems. Below is an example\nof this evolution.\n\n\n-----\n\n[Others have also seen samples that have increased the payment amount to 1.7 bitcoin per](https://www.bleepingcomputer.com/forums/t/607818/encedrsa-ransomware-support-and-help-topic-help-decrypttxt/)\nPC. During our investigation we found multiple different bitcoin wallets being presented to\nusers, some had 0 bitcoins associated with them others had significant amounts. The total\namount of bitcoin in these wallets was at least ~275 which equates to approximately\n$115,000 USD. Below is a screen capture showing some of the obfuscated wallets. They\nhave been obfuscated so that we can continue to monitor their activity.\n\n## IOCs\n\n**Hashes**\n\n036071786d7db553e2415ec2e71f3967baf51bdc31d0a640aa4afb87d3ce3050\n\n553967d05b83364c6954d2b55b8cfc2ea3808a17c268b2eee49090e71976ba29\n\na763ed678a52f77a7b75d55010124a8fccf1628eb4f7a815c6d635034227177e\n\n6bc2aa391b8ef260e79b99409e44011874630c2631e4487e82b76e5cb0a49307\n\n\n-----\n\n7aa585e6fd0a895c295c4bea2ddb071eed1e5775f437602b577a54eef7f61044\n939efdc272e8636fd63c1b58c2eec94cf10299cd2de30c329bd5378b6bbbd1c8\n45e00fe90c8aa8578fce2b305840e368d62578c77e352974da6b8f8bc895d75b\n979692a34201f9fc1e1c44654dc8074a82000946deedfdf6b8985827da992868\n0f2c5c39494f15b7ee637ad5b6b5d00a3e2f407b4f27d140cd5a821ff08acfac\n946dd4c4f3c78e7e4819a712c7fd6497722a3d616d33e3306a556a9dc99656f4\ne682ac6b874e0a6cfc5ff88798315b2cb822d165a7e6f72a5eb74e6da451e155\n58ef87523184d5df3ed1568397cea65b3f44df06c73eadeb5d90faebe4390e3e\nffef0f1c2df157e9c2ee65a12d5b7b0f1301c4da22e7e7f3eac6b03c6487a626\n89b4abb78970cd524dd887053d5bcd982534558efdf25c83f96e13b56b4ee805\n\n## Conclusion\n\nThe SamSam campaign is unusual in that it is taking advantage of remote execution\ntechniques instead of targeting the user. Adversaries are exploiting known vulnerabilities in\nunpatched JBoss servers before installing a web shell, identifying further network connected\nsystems, and installing SamSam ransomware to encrypt files on these devices.\n\nRansomware continues to persist as a successful cyber crime business model. This\ntechnique is proving to be a profitable affair for criminals and will continue to be a threat to\nthe internet at large until a more profitable technique is discovered. Protection against such\nthreats is best achieved using a multi-tier defense architecture to ensure potential threats are\nscanned multiple times. However, one of the most effective ways to protect yourself is by\nsimply backing up valuable files. Victims often find that at the moment when backups are\nmost needed, they are either non-existent or incomplete. These lapses provide the revenue\nstream that is currently fueling the development of ransomware.\n\n## Coverage\n\nThe following Snort rules and ClamAV signatures address this threat. Please note that\nadditional rules may be released at a future date and current rules are subject to change\npending additional vulnerability information. For the most current rule information, please\nrefer to your Defense Center, FireSIGHT Management Center or Snort.org.\n\n**Snort Rules**\n\nJBoss Server Vulnerabilities: 18794, 21516-21517, 24342-24343, 24642, 29909\nSamsam Malware: 38279-38280, 38304\n\n**ClamAV Signature Family**\n\nWin.Trojan.Samas\n\nAdditional ways our customers can detect and block this threat are listed below.\n\n\n-----\n\n[Advanced Malware Protection (AMP) can detect and prevent the execution of this malware](https://www.cisco.com/c/en/us/support/security/amp-firepower-software-license/tsd-products-support-series-home.html)\non targeted systems.\n\n[CWS or](https://www.cisco.com/c/en/us/products/security/cloud-web-security/index.html) [WSA web scanning can prevent access to malicious websites and detects malware](https://www.cisco.com/c/en/us/products/security/web-security-appliance/index.html)\nused in these attacks.\n\n[Network Security encompasses IPS and](https://www.cisco.com/c/en/us/products/security/intrusion-prevention-system-ips/index.html) [NGFW. Both have up-to-date signatures to detect](https://www.cisco.com/c/en/us/products/security/asa-next-generation-firewall-services/index.html)\nmalicious network activity that this campaign exhibits.\n\n## Reference\n\nhttps://blogs.technet.microsoft.com/mmpc/2016/03/17/no-mas-samas-whats-in-thisransomwares-modus-operandi/\nhttp://www.intelsecurity.com/advanced-threatresearch/content/Analysis_SamSa_Ransomware.pdf\nhttp://www.bleepingcomputer.com/forums/t/607818/encedrsa-ransomware-supportand-help-topic-help-decrypttxt/\n\n## Appendix A: File Types Targeted for Encryption\n\nThe following file types are targeted for encryption:\n\n.3dm, .3ds, .3fr, .3g2, .3gp, .3pr, .7z, .ab4, .accdb, .accde, .accdr, .accdt, .ach, .acr, .act,\n.adb, .ads, .agdl, .ai, .ait, .al, .apj, .arw, .asf, .asm, .asp, .aspx, .asx, .avi, .awg, .back,\n.backup, .backupdb, .bak, .bank, .bay, .bdb, .bgt, .bik, .bkf, .bkp, .blend, .bpw, .c, .cdf, .cdr,\n.cdr3, .cdr4, .cdr5, .cdr6, .cdrw, .cdx, .ce1, .ce2, .cer, .cfp, .cgm, .cib, .class, .cls, .cmt, .cpi,\n.cpp, .cr2, .craw, .crt, .crw, .cs, .csh, .csl, .csv, .dac, .db, .db-journal, .db3, .dbf, .dbx, .dc2,\n.dcr, .dcs, .ddd, .ddoc, .ddrw, .dds, .der, .des, .design, .dgc, .djvu, .dng, .doc, .docm, .docx,\n.dot, .dotm, .dotx, .drf, .drw, .dtd, .dwg, .dxb, .dxf, .dxg, .eml, .eps, .erbsql, .erf, .exf, .fdb, .ffd,\n.fff, .fh, .fhd, .fla, .flac, .flv, .fmb, .fpx, .fxg, .gray, .grey, .gry, .h, .hbk, .hpp, .htm, .html, .ibank,\n.ibd, .ibz, .idx, .iif, .iiq, .incpas, .indd, .jar, .java, .jin, .jpe, .jpeg, .jpg, .jsp, .kbx, .kc2, .kdbx,\n.kdc, .key, .kpdx, .lua, .m, .m4v, .max, .mdb, .mdc, .mdf, .mef, .mfw, .mmw, .moneywell, .mos,\n\n\n-----\n\n.mov, .mp3, .mp4, .mpg, .mrw, .msg, .myd, .nd, .ndd, .nef, .nk2, .nop, .nrw, .ns2, .ns3, .ns4,\n.nsd, .nsf, .nsg, .nsh, .nwb, .nx2, .nxl, .nyf, .oab, .obj, .odb, .odc, .odf, .odg, .odm, .odp, .ods,\n.odt, .oil, .orf, .ost, .otg, .oth, .otp, .ots, .ott, .p12, .p7b, .p7c, .pab, .pages, .pas, .pat, .pbl,\n.pcd, .pct, .pdb, .pdd, .pdf, .pef, .pem, .pfx, .php, .php5, .phtml, .pl, .plc, .png, .pot, .potm,\n.potx, .ppam, .pps, .ppsm, .ppsx, .ppt, .pptm, .pptx, .prf, .ps, .psafe3, .psd, .pspimage, .pst,\n.ptx, .py, .qba, .qbb, .qbm, .qbr, .qbw, .qbx, .qby, .r3d, .raf, .rar,, .rat, .raw, .rdb, .rm, .rtf, .rw2,\n.rwl, .rwz, .s3db, .sas7bdat, .say, .sd0, .sda, .sdf, .sldm, .sldx, .sql, .sqlite, .sqlite3, .sqlitedb,\n.sr2, .srf, .srt, .srw, .st4, .st5, .st6, .st7, .st8, .std, .sti, .stw, .stx, .svg, .swf, .sxc, .sxd, .sxg,\n.sxi, .sxi, .sxm, .sxw, .tex, .tga, .thm, .tib, .tif, .tlg, .txt, .vob, .wallet, .war, .wav, .wb2, .wmv,\n.wpd, .wps, .x11, .x3f, .xis, .xla, .xlam, .xlk, .xlm, .xlr, .xls, .xlsb, .xlsm, .xlsx, .xlt, .xltm, .xltx,\n.xlw, .xml, .ycbcra, .yuv, .zip\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-03-23 - SamSam- The Doctor Will See You, After He Pays The Ransom.pdf"
    ],
    "report_names": [
        "2016-03-23 - SamSam- The Doctor Will See You, After He Pays The Ransom.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535694,
    "ts_updated_at": 1743041174,
    "ts_creation_date": 1653774226,
    "ts_modification_date": 1653774226,
    "files": {
        "pdf": "https://archive.orkl.eu/cb8dbc1cf43eae4a488e18a67c2a130121c6b908.pdf",
        "text": "https://archive.orkl.eu/cb8dbc1cf43eae4a488e18a67c2a130121c6b908.txt",
        "img": "https://archive.orkl.eu/cb8dbc1cf43eae4a488e18a67c2a130121c6b908.jpg"
    }
}