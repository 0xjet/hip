{
    "id": "2b5dec66-5d3c-4c44-8a00-b7e3399c5371",
    "created_at": "2023-01-12T15:10:46.871954Z",
    "updated_at": "2025-03-27T02:05:34.104585Z",
    "deleted_at": null,
    "sha1_hash": "dd4778f6d938313ae3a6b13adecfe4f6f2f17fa0",
    "title": "2022-05-31 - WarzoneRAT Can Now Evade Detection With Process Hollowing",
    "authors": "",
    "file_creation_date": "2022-06-13T04:04:13Z",
    "file_modification_date": "2022-06-13T04:04:13Z",
    "file_size": 2200355,
    "plain_text": "# WarzoneRAT Can Now Evade Detection With Process Hollowing\n\n**[uptycs.com/blog/warzonerat-can-now-evade-with-process-hollowing](https://www.uptycs.com/blog/warzonerat-can-now-evade-with-process-hollowing)**\n\n_Research by: Pritam Salunkhe and Shilpesh Trivedi_\n\nThe Uptycs Threat Research Team identified samples of WarzoneRAT dropped through a\nPowershell dropper with a Process Injection/Hollowing technique implementation to bypass\ndetections. We [first identified WarzoneRAT using a Windows User Account Control (UAC)](https://www.uptycs.com/blog/warzone-rat-comes-with-uac-bypass-technique)\nbypass technique in November 2020.\n\n\n-----\n\nThis blog post details the operation of the latest WarzoneRAT sample and also covers the\nadvanced detection capabilities of the Uptycs EDR in detecting techniques like Process\nHollowing and UAC Bypass.\n\n## WarzoneRAT\n\nWarzoneRAT is a Remote Admin Tool that has a wide range of capabilities including\nkeylogging, remote desktop, and webcam capture, live and offline keylogger. This malware is\ndistributed through malware-as-a-service (MaaS) and is also used as a staged payload in the\nattack kill chain by threat actors in APT attacks.\n\n[The Uptycs Threat Research Team contributed to the profile of WarzoneRAT (S0670) in the](https://attack.mitre.org/software/S0670/)\nMITRE ATT&CK framework, detailing the techniques and functionality of the malware.\n\n## Malware Operation\n\nA depiction of the kill chain used by WarzoneRAT in one of the recently captured samples in\nour in-house osquery integrated threat intelligence sandbox is shown below (Figure 1).\n\n\n-----\n\n_Figure 1: Attack Kill Chain of latest WarzoneRAT sample including process hollowing_\n\nThe kill chain includes the following steps:\n\nThe malicious document launches EXCEL.exe and executes wscript.exe to run\nUpdate.js javascript which is embedded in the macro itself and copy the Update.js to\nStartup Folder.\nLater the JS script copies the mshta from C:\\Windows\\System32 to C:\\ProgramData\\\nand names it as ‘ddond.com’. It then launches ddond.com(masqueraded mshta) to\nexecute hxxps://taxfile[.]mediafire[.]com/file/c3zcoq7ay6nq19i/back[.]htm/file.\nThe back.htm executed via ddond.com, runs powershell command to download\nanother powershell script later executing it via Invoke-Expression. And schedules a\ntask using schtasks.exe for persistence.\nThe powershell script executed via Invoke-Expression executes embedded\nWarzoneRat and other .Net binary payloads via process hollowing technique as shown\nin Figure 1.\n\n\n-----\n\nIt also launches csc.exe to compile .cs file on the fly into dll to decompress the\ncompressed code for further execution.\n\nThe Uptycs detection graph showcasing the execution flow of the attack kill chain is shown\nbelow (Figure 2)\n\n_Figure 2: Uptycs Detection graph of WarzoneRAT_\n\n## Chain Process Hollowing Technique\n\n_MITRE:_ _[https://attack.mitre.org/techniques/T1055/012/](https://attack.mitre.org/techniques/T1055/012/)_\n\nThe embedded macro inside the document\n(907012a9e2eff4291cd1162a0f2ac726f93bad0ef57e326d5767489e89bc0b0a) executed\nmultiple set of commands to download a powershell script that loads the malicious\nexecutables using [Reflection.Assembly]::load cmdlet as shown in figure 3:\n\n\n-----\n\n_Figure 3: Deobfuscated Powershell code using process injection in legit process_\n\nThe cmdlet executes the function “Execute” from the Class “projFUD.PA”.\nThe “Execute” Function then uses process hollowing technique to inject malicious code\ninto legit processes such as aspnet_compiler.exe, aspnet_regbrowsers.exe,\nCasPol.exe, RegAsm.exe and MSBuild.exe.\n\nThe API usage for the process hollowing is shown below (See Figure 4).\n\n\n-----\n\n_Figure 4: Process Hollowing code in .NET payload_\n\n## UAC Bypass\n\n_MITRE ATT&CK:_ _[https://attack.mitre.org/techniques/T1548/002/](https://attack.mitre.org/techniques/T1548/002/)_\n\nAlongside process hollowing and code injection, the Powershell script also injects another\n.NET payload\n(8A389D732476E581EA576999E0191142BB8324F708744260303C1D9CFE1A79AE) which\nperforms UAC bypass via ComputerDefaults.exe.\n\n\n-----\n\n_Figure 5: UAC Bypass implemented in .NET payload_\n\n## Uptycs EDR Detection\n\nUptycs EDR armed with YARA process scanning, advanced detections and correlating\nRegistry Events, Process File Events, Process Events and API Events successfully detects\ndifferent types of tactics carried out by WarzoneRAT.\n\nAdditionally, Uptycs EDR contextual detection provides additional details about the detected\nmalware. Users can navigate to the toolkit data section in the detection alert and click on the\nname to find out the behavior as shown as below (See Figure 6)\n\n_Figure 6: Uptycs Detection for WarzoneRAT_\n\n## Conclusion\n\nThis blog detailed the new WarzoneRAT operation on a victim's machine. We shed light on\nthe new Process Hollowing technique used to evade process-based defenses. This makes it\nnecessary to have a security solution that has advanced analytics and provides granular\n\n\n-----\n\nvisibility of targeted attacks and their kill chain. Uptycs EDR with advanced detection\ncapabilities, correlation, and YARA process scanning capabilities successfully identified the\nmalicious behavior and detected WarzoneRAT.\n\n## To learn more about the latest threat research conducted by the Uptycs Team, check out our most recent threat bulletin below.\n\nTag(s): [threat hunting,](https://www.uptycs.com/blog/tag/threat-hunting) [threat intelligence,](https://www.uptycs.com/blog/tag/threat-intelligence) [threat research](https://www.uptycs.com/blog/tag/threat-research)\n\n## Uptycs Threat Research\n\nResearch and updates from the Uptycs Threat Research team.\n\nConnect with the author\n\n## Subscribe to email updates\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-05-31 - WarzoneRAT Can Now Evade Detection With Process Hollowing.pdf"
    ],
    "report_names": [
        "2022-05-31 - WarzoneRAT Can Now Evade Detection With Process Hollowing.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536246,
    "ts_updated_at": 1743041134,
    "ts_creation_date": 1655093053,
    "ts_modification_date": 1655093053,
    "files": {
        "pdf": "https://archive.orkl.eu/dd4778f6d938313ae3a6b13adecfe4f6f2f17fa0.pdf",
        "text": "https://archive.orkl.eu/dd4778f6d938313ae3a6b13adecfe4f6f2f17fa0.txt",
        "img": "https://archive.orkl.eu/dd4778f6d938313ae3a6b13adecfe4f6f2f17fa0.jpg"
    }
}