{
    "id": "35a6f9a4-24f6-46e1-97e8-89a9ef45110e",
    "created_at": "2023-01-12T15:03:45.887641Z",
    "updated_at": "2025-03-27T02:13:34.363947Z",
    "deleted_at": null,
    "sha1_hash": "a5d880280dfc68662b2086965ab74bd683e2269b",
    "title": "2022-04-14 - Threat Thursday- HeaderTip Backdoor Shows Attackers from China Preying on Ukraine",
    "authors": "",
    "file_creation_date": "2022-05-28T23:24:54Z",
    "file_modification_date": "2022-05-28T23:24:54Z",
    "file_size": 1838706,
    "plain_text": "# Threat Thursday: HeaderTip Backdoor Shows Attackers from China Preying on Ukraine\n\n**[blogs.blackberry.com/en/2022/04/threat-thursday-headertip-backdoor-shows-attackers-from-china-preying-on-ukraine](https://blogs.blackberry.com/en/2022/04/threat-thursday-headertip-backdoor-shows-attackers-from-china-preying-on-ukraine)**\n\nThe BlackBerry Research & Intelligence Team\n\nOn March 22, the Computer Emergency Response Team of Ukraine (CERT-UA) reported its\nfindings of a new backdoor targeting Ukrainian infrastructure.\n\n[Known as HeaderTip, this backdoor is thought to be tied to an APT group named Scarab,](https://thehackernews.com/2022/03/another-chinese-hacking-group-spotted.html)\nwhich has been linked to China. Scarab has targeted the U.S. and Russia in the past, but\nHeaderTip is the threat group’s first attack that we’ve seen specifically targeting Ukraine\npost invasion. This makes it one of the first examples of attackers linked to China actively\nexploiting the current situation in Ukraine.\n\n### Operating System\n\n Risk & Impact\n\n\n-----\n\n### Technical Analysis\n\n**A Closer Look at Lure Documents and Infection Techniques**\n\n[As we’ve seen in recent weeks with malware such as SunSeed, many threat actors have](https://blogs.blackberry.com/en/2022/03/threat-thursday-sunseed-malware)\ntaken note of the current political tension in Ukraine. Attackers are taking advantage of this\nsituation to emotionally manipulate people to the point where they fall prey to phishing\nattacks.\n\nThe Scarab group has taken a similar approach with spreading HeaderTip. The original\n[phishing email can vary, but it ultimately results in the delivery of a RAR archive to the](https://en.wikipedia.org/wiki/RAR_(file_format))\nvictim’s endpoint. Opening and extracting that RAR file gives you an EXE file that\nmasquerades as a PDF file containing a message such as the one described in the notice\nfrom CERT-UA. That file purports to be from the National Police of Ukraine, regarding the\nneed to preserve video evidence of crimes committed by the Russian military.\n\nTo people currently residing in Ukraine, those who have been forced to flee, or even\nindividuals in neighboring countries, any new information on this subject could be seen as\ncrucial to them. Threat actors such as Scarab know this, and they have no qualms about\nweaponizing the populace’s need for up to date information on the situation to spread\nmalware like the HeaderTip backdoor.\n\nLaunching that EXE file silently installs and loads the malware. While doing so, it also\nlaunches an actual PDF file with the expected information, to trick the victim into thinking\nthat's all that has happened.\n\nFor this instance of the HeaderTip backdoor, Scarab uses a PDF file with a title that\ntranslates as “On the preservation of video recordings of criminal actions of the army of the\nRussian Federation” (as shown in Figure 1, below).\n\n\n-----\n\n_Figure 1 – Lure document used in HeaderTip deployment_\n\nAt the time of writing this, once HeaderTip is loaded, it only appears to beacon out to its\ncommand-and-control (C2) server, waiting for updates. While we are not certain what is to\ncome from this backdoor, it is likely that this is just the first stage of an attack.\n\nBlackBerry will continue monitoring this situation and will provide updates as more\ninformation becomes available.\n\n### File Contents\n\n\n-----\n\nAfter opening the delivery archive, we are left with a single file. While it may have the icon\nfor a PDF file, a closer look will reveal that it is a standard executable (.EXE). This\nexecutable will act as a loader for HeaderTip and its associated files.\n\nLooking at the resource section for the loader, shown in Figure 2 below, we see resource\ndata labeled 101, 102, and 103. These items are the files to be loaded from the delivery\nexecutable, including their respective names in the beginning of each section.\n\nRCDATA 101 - “#2163_02_33-2022.pdf” (PDF lure document)\nRCDATA 102 - “officecleaner.bat” (batch file for executing HeaderTip)\nRCDATA 103 - “officecleaner.dat” (loader containing HeaderTip backdoor)\n\n_Figure 2 – Resource data for HeaderTip loader_\n\nFor a simplified view, Figure 3 shows the initial loader from the delivery archive in the left\nwindow. The right window shows all files used during execution to establish the HeaderTip\nbackdoor. This list of files includes those in the loader’s resource section, as well as the\nactual backdoor (httpshelper.dll) after it has been built with assistance from the batch file.\n\n_Figure 3 – Simplified view of file contents_\n\n### Execution\n\nWhen the initial loader is executed, it begins running a batch file (“officecleaner.bat”) to\nassist in installing the backdoor, as seen in the code in Figure 4.\n\n_Figure 4 – officecleaner.bat code contents_\n\nThis code performs the following steps:\n\nDefine HeaderTip as httpshelper.dll\n\n\n-----\n\nAppend HeaderTip data to the helper DLL from officecleaner.dat\nAdd a registry key under HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run to\nachieve persistence\nExecute HeaderTip backdoor\n\nTo verify that this threat is achieving persistence, we can look at the process tree for the\nloader executable (as shown in Figure 5), where it shows us the command that is being run\nto add the registry key. This persistence will ensure that HeaderTip can continue to beacon\nout for updates in the future.\n\n_Figure 5 – Process tree displaying command for persistence_\n\nAt this point, HeaderTip is ready and running, and will repeatedly make HTTP POST\nrequests to the associated C2 server shown in Figure 6. Until it receives further updates on\nwhat to download next, we believe this is the current extent of this threat’s performance.\n\n_Figure 6 – Example of HeaderTip beaconing to C2 server for potential updates_\n\nWhile right now HeaderTip is rather basic in its processes, it remains a mystery what\nScarab might decide to send as further updates for the second stage of this attack.\nAwareness of this first step gives us a leg up in detecting and mitigating any future\ndestructive activity.\n\n### Mitigation Tips\n\nWhen it comes to phishing scams, user education and discretion is always key. Always\nexercise caution before opening any email attachments or links and make sure that each\nemail you’re reading is coming from a known, trusted source.\n\n### YARA Rule\n\n\n-----\n\nThe following YARA rule was authored by the BlackBerry Research & Intelligence Team to\ncatch the threat described in this document:\n\nrule HeaderTip{\n\nmeta:\ndescription = \"Detects HeaderTip\"\nauthor = \"BlackBerry Threat Research Team\"\ndate = \"2022-04-06-\"\n\nlicense = \"This Yara rule is provided under the Apache License 2.0\n(https://www.apache.org/licenses/LICENSE-2.0) and open to any user or organization, as\nlong as you use it under this license and ensure originator credit in any derivative to The\nBlackBerry Research & Intelligence Team\"\n\nstrings:\n$s1 = \"type %temp%\\\\officecleaner.dat >> %objfile%\"\n$s2 = \"product2020.mrbasic.com\" wide\n\ncondition:\nfilesize < 750KB and all of them\n\n}\n\n### Indicators of Compromise (IoCs)\n\n839E968AA5A6691929B4D65A539C2261F4ECD1C504A8BA52ABBFBAC0774D6FA3\n\n042271AADF2191749876FC99997D0E6BDD3B89159E7AB8CD11A9F13AE65FA6B1\n\nC0962437A293B1E1C2702B98D935E929456AB841193DA8B257BD4AB891BF9F69\n\n830C6EAD1D972F0F41362F89A50F41D869E8C22EA95804003D2811C3A09C3160\n\n63A218D3FC7C2F7FCADC0F6F907F326CC86EB3F8CF122704597454C34C141CF1\n\n### References\n\n[https://cert.gov.ua/article/38097](https://cert.gov.ua/article/38097)\n\n[https://thehackernews.com/2022/03/another-chinese-hacking-group-spotted.html](https://thehackernews.com/2022/03/another-chinese-hacking-group-spotted.html)\n\n[https://socprime.com/blog/headertip-malware-hits-ukrainian-organizations-cert-ua-warning/](https://socprime.com/blog/headertip-malware-hits-ukrainian-organizations-cert-ua-warning/)\n\n[https://thehackernews.com/2022/04/multiple-hacker-groups-capitalizing-on.html](https://thehackernews.com/2022/04/multiple-hacker-groups-capitalizing-on.html)\n\nhttps://www.trendmicro.com/en_us/research/22/c/cyberattacks-are-prominent-in-the-russiaukraine-conflict.html\n\n[https://blogs blackberry com/en/2022/03/threat-thursday-sunseed-malware](https://blogs.blackberry.com/en/2022/03/threat-thursday-sunseed-malware)\n\n\n-----\n\n### BlackBerry Assistance\n\nIf you’re battling HeaderTip or a similar threat, you’ve come to the right place, regardless of\nyour existing BlackBerry relationship.\n\n[The BlackBerry Incident Response team is made up of world-class consultants dedicated to](https://www.blackberry.com/us/en/services/incident-response)\nhandling response and containment services for a wide range of incidents, including\nransomware and Advanced Persistent Threat (APT) cases.\n\nWe have a global consulting team standing by to assist you, providing around-the-clock\nsupport where required, as well as local assistance. Please contact us\nhere: https://www.blackberry.com/us/en/forms/cylance/handraiser/emergency-incidentresponse-containment.\n\n## About The BlackBerry Research & Intelligence Team\n\nThe BlackBerry Research & Intelligence team examines emerging and persistent threats,\nproviding intelligence analysis for the benefit of defenders and the organizations they serve.\n\nBack\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-04-14 - Threat Thursday- HeaderTip Backdoor Shows Attackers from China Preying on Ukraine.pdf"
    ],
    "report_names": [
        "2022-04-14 - Threat Thursday- HeaderTip Backdoor Shows Attackers from China Preying on Ukraine.pdf"
    ],
    "threat_actors": [
        {
            "id": "e7d03ac8-7d6f-4ea0-83a9-10dff2ea1486",
            "created_at": "2022-10-25T16:07:24.158325Z",
            "updated_at": "2025-03-27T02:02:10.127249Z",
            "deleted_at": null,
            "main_name": "Scarab",
            "aliases": [
                "UAC-0026"
            ],
            "source_name": "ETDA:Scarab",
            "tools": [
                "Scieron"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9099912b-a00a-4afb-8294-c6d35af421a1",
            "created_at": "2023-01-06T13:46:39.338108Z",
            "updated_at": "2025-03-27T02:00:03.054726Z",
            "deleted_at": null,
            "main_name": "Scarab",
            "aliases": [],
            "source_name": "MISPGALAXY:Scarab",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535825,
    "ts_updated_at": 1743041614,
    "ts_creation_date": 1653780294,
    "ts_modification_date": 1653780294,
    "files": {
        "pdf": "https://archive.orkl.eu/a5d880280dfc68662b2086965ab74bd683e2269b.pdf",
        "text": "https://archive.orkl.eu/a5d880280dfc68662b2086965ab74bd683e2269b.txt",
        "img": "https://archive.orkl.eu/a5d880280dfc68662b2086965ab74bd683e2269b.jpg"
    }
}