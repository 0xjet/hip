{
    "id": "7555580a-74d7-4d09-8f88-d9f6fe2cb93e",
    "created_at": "2023-01-12T15:08:53.051998Z",
    "updated_at": "2025-03-27T02:05:34.882857Z",
    "deleted_at": null,
    "sha1_hash": "20a2e269563186294d12f0a1183b47cddf4d9bb9",
    "title": "2021-08-11 - Teaching an Old Dog New Tricks- 2017 Magniber Ransomware Uses PrintNightmare Vulnerability to Infect Victims in South Korea",
    "authors": "",
    "file_creation_date": "2022-05-27T20:00:06Z",
    "file_modification_date": "2022-05-27T20:00:06Z",
    "file_size": 1377063,
    "plain_text": "# Magniber Ransomware Caught Using PrintNightmare Vulnerability\n\n**[crowdstrike.com/blog/magniber-ransomware-caught-using-printnightmare-vulnerability/](https://www.crowdstrike.com/blog/magniber-ransomware-caught-using-printnightmare-vulnerability/)**\n\nLiviu Arsene August 11, 2021\n\n2017 Magniber ransomware makes a comeback using the same methods: exploiting\nunpatched vulnerabilities on South Korean victims\nIn July 2021, CrowdStrike identified Magniber ransomware attempting to use a known\nPrintNightmare vulnerability to compromise victims\nCrowdStrike detects and protects against both the exploitation of the PrintNightmare\nvulnerability and the Magniber ransomware\n\nCrowdStrike recently observed new activity related to a 2017 ransomware family, known as\n[Magniber, using the PrintNighmare vulnerability on victims in South Korea. On July 13,](https://www.crowdstrike.com/blog/protecting-against-microsoft-printnightmare-vulnerability/)\nCrowdStrike successfully detected and prevented attempts at exploiting the PrintNightmare\nvulnerability, protecting customers before any encryption takes place.\n\n[When the PrintNighmare (CVE-2021-34527) vulnerability was disclosed, CrowdStrike](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527)\nintelligence assessed the vulnerability will likely be used by threat actors as it allowed for\npossible remote code execution (RCE) and local privilege escalation (LPE). This assessment\nproved accurate in light of the recent incident.\n\n\n-----\n\nUsing mitigations that target the tactics and techniques used by adversaries to compromise\nendpoints, the CrowdStrike Falcon® platform provides layered coverage against threats by\nusing machine learning (on-sensor and in the cloud) and indicators of attack (IOAs) to\nidentify malicious processes or files associated with known or unknown threats.\n\n## A Timeline for the PrintNightmare Vulnerability\n\n**[June 8, 2021: The PrintNightmare (CVE-2021-1675) vulnerability was initially discovered](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-1675)**\nand reported to Microsoft on June 8, by security researchers working for three different\ncompanies. Their research involved attempting to bypass a previous patch addressing the\n“PrintDemon” (CVE-2020-1048) vulnerability.\n\n**[June 21, 2021: While Microsoft released a patch for CVE-2021-1675, as part of](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-1675)** Microsoft’s\nJune 2021 Patch Tuesday, no additional information regarding how to exploit the vulnerability\nwas made public. At the time, it was believed the vulnerability could only be exploited by a\nlocally authenticated user. However, the vulnerability was elevated to Critical on June 21 by\nMicrosoft, as it was determined it could allow for RCE.\n\n**June 29, 2021: Independently, one of three additional security researchers investigating a**\nsimilar bug in the Windows Print Spooler service inadvertently published a proof of concept\n[(POC) exploiting the (CVE-2021-1675) vulnerability on a GitHub repository, on June 29.](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-1675)\nWhile the error was shortly corrected, the GitHub repo was reportedly forked and the POC\nmade it into the wild, potentially leading to abuse by attackers.\n\n**[July 1, 2021: Although Microsoft addressed the CVE-2021-1675 vulnerability by issuing a](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-1675)**\npatch, the leaked POC exploited a different attack vector that triggered the Print Spooler\nvulnerability. As of July 1, several different proof of concepts exploiting the Printer Spooler\n[vulnerability were made public. Consequently, a second CVE (CVE-2021-34527) was](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527)\ncreated on July 1, with Microsoft stating that “CVE-2021-1675 is similar but distinct from\nCVE-2021-34527.”\n\n**[July 6, 2021: On July 6, Microsoft issued an out-of-band (OOB) update attempting to](https://msrc-blog.microsoft.com/2021/07/06/out-of-band-oob-security-update-available-for-cve-2021-34527/)**\n[mitigate the CVE-2021-34527 vulnerability, but hours later security researchers found that it](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527)\nwas again possible to bypass imposed mitigations under certain conditions. Popular exploit\n[tools, such as Metasploit and Mimikatz, started incorporating the exploit code, paving the](https://www.crowdstrike.com/blog/protecting-against-microsoft-printnightmare-vulnerability/)\nway for adversary weaponization of a yet unpatched vulnerability.\n\n## A Primer on Magniber Ransomware\n\nMagniber ransomware was first spotted in late 2017 targeting victims in South Korea through\nmalvertising campaigns using the Magnitude Exploit Kit (EK). Previous Magniber campaigns\nwent through significant efforts to only infect victims in South Korea, although in mid-2018 it\nwas also spotted targeting victims in other Asia Pacific countries.\n\n\n-----\n\nMagnitude Exploit Kit (EK) operators initially used the Cerber ransomware exclusively before\nturning to Magniber, which is believed to be the successor of Cerber. The most popular\ninfection vector for Magniber involved the use of unpatched vulnerabilities, such as Internet\n[Explorer exploits (CVE-2018-8174,](https://blog.malwarebytes.com/threat-analysis/2018/05/internet-explorer-zero-day-browser-attack/) [CVE-2021-26411,](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-26411) [CVE-2020-0968,](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2020-0968) [CVE-2019-1367) or](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2019-1367)\n[Flash (CVE-2018-8174) vulnerabilities, infecting victims through compromised websites or](https://blog.malwarebytes.com/cybercrime/2018/02/new-flash-player-zero-day-comes-inside-office-document/)\ndrive-by downloads.\n\nWhile the Magniber ransomware only seems to target the Republic of Korea, it has been\nactive since 2017. Our Falcon OverWatch™ team also spotted more recent activity from\nMagniber in early February 2021, exploiting an Internet Explorer vulnerability (CVE-20200968) to exclusively compromise South Korean victims.\n\nMagniber was under active development to include new obfuscation features, evasion tactics\nand encryption mechanisms that made the encryption more robust, showing up in sporadic\ncampaigns over the years. Its developers also went through a significant effort to limit\ninfections to Asia Pacific countries by including various language checks.\n\n## PrintNightmare Meets Magniber Ransomware\n\nThe new incident involving Magniber ransomware using the recent PrintNightmare Printer\nSpooler vulnerability is surprising, but not uncommon considering the impact of the\nvulnerability. Several POCs have been in circulation since the issue was reported, and it was\nonly a matter of time until adversaries attempted to leverage it to compromise victims and\ndeliver malicious payloads.\n\nThe Falcon OverWatch team constantly hunts for adversary attempts trying to exploit the\nPrintNightmare vulnerability and recently spotted an endeavor to exploit it. A malicious dll\nwas written to the folder\n**\\Device\\HarddiskVolume2\\Windows\\System32\\spool\\DRIVERS\\x64\\3\\New\\ after which it**\nwas loaded into the spoolsv.exe process. The DLL itself is associated with the Magniber\nransomware and is responsible for deobfuscating the core ransomware DLL and injecting it\ninto a remote process.\n\nOur IOA coverage that we released as part of the PrintNightmare research successfully\ntriggers due to this action, and prevents this operation, as seen in the screenshot below.\n\n\n-----\n\nCrowdStrike’s behavior-based detection using IOAs successfully prevented the core\nransomware DLL from being injected, thwarting the malicious activity before any encryption\ntook place on the endpoint.\n\nAnalyzing the behavior of the malicious ransomware sample reveals the same Magniber\nbehavior observed in the past by CrowdStrike security researchers: exploiting a vulnerability,\ndropping an obfuscated DLL loader, injecting the loader into a process and then unpacking\nthe cored DLL loader that performs local file traversal and encryption — which is on par with\nthe known Magniber modus operandi.\n\nThe dropped ransom note does not reveal anything new about the operators behind this\nincident or the ransom payment amount. Instead, it provides instructions on contacting the\nransomware operators for potential negotiation and warns victims they have a limited amount\nof time to contact them for decryption before the links expire.\n\n\n-----\n\n## CrowdStrike Falcon Protection\n\nCrowdStrike Falcon takes a layered approach to protecting endpoints that are most valuable\nto organizations by employing machine learning and behavior-based protection. The critical\nWindows Print Spooler vulnerability, PrintNightmare, is something that potentially affects all\nWindows hosts, which is why CrowdStrike customers are encouraged to review their\nprevention policies in accordance with best practices and get Falcon Spotlight™ vulnerability\nmanagement to identify risks related to this. If you are not a customer, you can start a free\ntrial of [Falcon Spotlight today.](https://store.crowdstrike.com/en-US/apps/352/falcon-spotlight?&_gl=1*b5o5mz*_ga*MzczNDM5MTYuMTYxODIxOTAzMA..*_ga_QLQM32M39F*MTYyNjY3MzE0NS4xNzkuMS4xNjI2NjczMjg1LjA.&_ga=2.71652247.549441745.1626668735-37343916.1618219030#overview)\n\nCrowdStrike Falcon leverages machine learning and IOAs to identify malicious behavior of\n[processes or files when dealing with new or unknown threats. This video demonstrates](https://crowdstrike.wistia.com/medias/bs4wrgp1jr)\nFalcon’s capabilities to successfully detect and block the Magniber ransomware DLL. First,\nlearn how Falcon detects Magniber DLL using cloud machine learning written to disk and\nwhen injected into a remote process. Then, see a demo of Falcon’s ability to block the\nMagniber ransomware, when all prevention and protection policies are enabled according to\nbest practices. The Falcon sensor immediately blocks the malicious Magniber behavior,\nprotecting the endpoint.\n\nCrowdStrike continuously monitors the tactics, techniques and procedures (TTPs)\nassociated with over 160 identified threat actors and numerous unnamed groups and threats,\nand incorporates that intelligence into the Falcon platform.\n\n\n-----\n\nCrowdStrike estimates that the PrintNightmare vulnerability coupled with the deployment of\nransomware will likely continue to be exploited by other threat actors. We encourage\norganizations to always apply the latest patches and security updates to mitigate known\nvulnerabilities and adhere to security best practices to strengthen their security posture\nagainst threats and sophisticated adversaries.\n\n## Indicators of Compromise (IOCs)\n\n**File** **SHA256**\n\n\nMagniber\nLoader\nDLL\n\n```\n10b9b1d8f6bafd9bb57ccfb1da4a658f10207d566781fa5fb3c4394d283e860e\n36417f0ea6d948cbd7e003b3cefbb603d886849a8c80e0999c7969b03f2b9c28\n66c4f54da6542339de036872e80306f345b8572a71e782434245455e03541465\n77d3b1cf6d5a0a07090cdb078dce6e3849465c9acde7e1ba66c3893fefc73d4b\n\n```\n```\n9a6584a163d8c378e6f873c5544794274cce2532e91fc079b79fd73399447b03\n\n```\n\n**Additional Resources**\n\n_[Learn how Falcon Spotlight can help you discover and manage vulnerabilities within](https://www.crowdstrike.com/endpoint-security-products/falcon-spotlight-vulnerability-management/)_\n_your organization._\n_Watch how to use Falcon Spotlight and Falcon Real Time Response (RTR) for_\n_[emergency patching.](https://www.crowdstrike.com/blog/tech-center/emergency-patching/)_\n_[Visit the CrowdStrike Falcon Identity Protection solutions webpage.](https://www.crowdstrike.com/products/identity-protection)_\n_[Request a demo of CrowdStrike Falcon Zero Trust or Falcon Identity Threat Detection](https://www.crowdstrike.com/blog/cve-2021-1678-printer-spooler-relay-security-advisory/#:~:text=demo%20of%20CrowdStrike-,Falcon%20Zero%20Trust,-or%20Falcon%20Identity)_\n_products._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-08-11 - Teaching an Old Dog New Tricks- 2017 Magniber Ransomware Uses PrintNightmare Vulnerability to Infect Victims in South Korea.pdf"
    ],
    "report_names": [
        "2021-08-11 - Teaching an Old Dog New Tricks- 2017 Magniber Ransomware Uses PrintNightmare Vulnerability to Infect Victims in South Korea.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536133,
    "ts_updated_at": 1743041134,
    "ts_creation_date": 1653681606,
    "ts_modification_date": 1653681606,
    "files": {
        "pdf": "https://archive.orkl.eu/20a2e269563186294d12f0a1183b47cddf4d9bb9.pdf",
        "text": "https://archive.orkl.eu/20a2e269563186294d12f0a1183b47cddf4d9bb9.txt",
        "img": "https://archive.orkl.eu/20a2e269563186294d12f0a1183b47cddf4d9bb9.jpg"
    }
}