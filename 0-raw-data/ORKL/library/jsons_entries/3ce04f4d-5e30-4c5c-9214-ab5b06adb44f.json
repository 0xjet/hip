{
    "id": "3ce04f4d-5e30-4c5c-9214-ab5b06adb44f",
    "created_at": "2022-10-25T16:48:21.823083Z",
    "updated_at": "2025-03-27T02:14:48.408171Z",
    "deleted_at": null,
    "sha1_hash": "6289dff2cbd2750c76517007989483922179fa40",
    "title": "Pacifier APT",
    "authors": "Bitdefender",
    "file_creation_date": "2016-06-30T15:53:32Z",
    "file_modification_date": "2016-06-30T15:53:35Z",
    "file_size": 3432757,
    "plain_text": "# Pacifier APT\n\n\n-----\n\nWhite Paper\n\n## Contents\n\n###### Overview....................................................................................................................................................................... 3\n\n 2014-15 Executable Files.........................................................................................................................................4\n\n 2014-15 Browser Extension.................................................................................................................................. 11\n\n Other 2015 variants..................................................................................................................................................15\n\n 2016 attack wave..................................................................................................................................................... 16\n\n IOCs...............................................................................................................................................................................22\n\n SHA1 hashes of all known variants...................................................................................................................24\n\n Clean documents opened by droppers............................................................................................................26\n\n#### Authors:\n\n- Marius TIVADAR\n\n- Cristian ISTRATE\n\n- Iulian MUNTEAN\n\n- Andrei ARDELEAN\n\n\n-----\n\nWhite Paper\n\n## Overview\n\n###### Bitdefender detected and blocked an ongoing cyber-espionage campaign against Romanian institutions and other foreign targets. The attacks started in 2014, with the latest reported occurrences in May of 2016. The APT, dubbed Pacifier by Bitdefender researchers, makes use of malicious .doc documents and .zip files distributed via spear phishing e-mail.\n\n Documents used range from curriculum vitae, to invitations to social functions or conferences, to second hand car offers and even, in one case, a letter of instructions from a high-ranking official. Some were marked as “urgent”, “important”, “immediate action required” and so on.\n\n Other samples of the same malicious software were detected in Iran, India, Philippines, Russia, Lithuania, Thailand, Vietnam and Hungary.\n\n The high number of variants, in conjunction with the low number of reports and the nature of the affected machines has brought us to the conclusion that we are dealing with an APT. \n\n The malicious payloads delivered evolved over time, becoming stealthier and adding functionality as time went by. Our analysis focuses on three representative variants of the malware used in the attacks, but a number of others, differing by minor details, were found in the wild.\n\n Aside from the analysis, this paper lists hashes of malicious files, as well as other IOCs.\n\n\n-----\n\nWhite Paper\n\n## 2014-15 Executable Files\n\n###### The Infected Document\n\nThe infection starts from one infected document.\n\nAnalysis started from documents containing droppers. The dropper is encrypted and appended to the end of the document; the\n\ndocument contains a script that reads, decrypts and runs the dropper.\n\nThe last dword in the document file represents the size of the executable. The 5th byte from the end of the document is a checksum on\n\nthe decrypted executable, used for validation. The actions from the script are summarized below:\n\n###### size = last_dword_from_file;\n\n checksum = byte_before_size_dword; // read encrypted dropper in\n```\nbuffer for (key = 35, i = 0; i < size; i++)\n\n {   buffer[i] = buffer[i] ^ key;\n\n   key = (key ^ 217) ^ (i % 256);\n} for (sum = 0, i = 0; i < size; i++)\n\n {   sum = sum ^ buffer[i]; .DOC\n}\n\n if (sum ==checksum)(1 byte) (4 bytes)\n{\n\n Encrypted dropper\n   // write and execute the file in:\n\n   // %appdata%\\Microsoft\\Word\\MSWord.exe\n}\n\n```\n|.DOC|Col2|Col3|\n|---|---|---|\n|Encrypted dropper|||\n||||\n\n\n##### .DOC\n\n###### Encrypted dropper\n\n\nFor the script to run, macros must be enabled in Word.\n\nAs you can see in Appendix A the content of the infected documents is designed to trick the user\n\ninto enabling the macros. If the macros are enabled the dropper is executed and opens another\n\ndocument, as expected by the user. For example if the infected document says it is a „protected”\n\ndocument and you must enable macros to view it, then the dropper will open another document\n\nwith an invitation to a conference as the „protected” document.\n\nIn Appendix B you can find some examples of these „pacifier” documents, these are clean and\n\ncontain no scripts or executables.\n\n\n###### Encrypted dropper\n\n\n###### Checksum Size (1 byte) (4 bytes)\n\n\n-----\n\nWhite Paper\n\n###### Trojan component\n\n Initial infected Clean document document (European_global…)\n\ndrop\n\n###### Level 1 dropper drop (MsWord.exe)\n\ndrop\n\n###### Level 2 dropper drop files (ubfic.exe)\n\nntlm.exe, msvci.dll\nmsvct.exe, msvck.dll\nmsvcp.dll, msvci.exe\n\n###### modify\n\nmsvck60.dll, msvct60.dll\n\n###### msvcp.dll\n\n use\n\n desktop icons\n ntlm.exe\n\n open\n\n open\n Registry autorun\n\n Functionality on 32bit Windows\n\n ntlm.exe – startup executable\n msvcp.dll – get PID of outlook.exe\n msvci.dll – inject msvck.dll in outlook process msvck.dll – main backdoor\n msvct.dll – C&C communication\n\n|mponent|Col2|Col3|Col4|\n|---|---|---|---|\n|Initial infected document|Clean do (European|||\n|||Clean do (European|cument _global…)|\n|||||\n\n\n######  outlook.exe\n\n msvct.dll\n\nuse\n\nmain\n\n###### msvck.dll\n\nbackdoor\n\n\n###### Initial infected document\n\n\n###### Level 1 dropper (MsWord.exe)\n\n\n###### Clean document (European_global…)\n\n\n###### msvci.dll\n\n\n-----\n\nWhite Paper\n\n###### The Dropper\n\nThe script previously loaded from the infected .doc file executes the dropper from:\n\n###### %appdata%\\Microsoft\\Word\\MSWord.exe\n\nThe dropper is a small executable that has the files to be deployed in the overlay encrypted with RC4. It just creates and runs the\n\nfollowing files in this order:\n\n- %appdata%\\TMP\\European_global_navigation_system.doc\n\n- %appdata%\\Axpim\\ubfic.exe\n\n- %appdata%\\Axpim\\ anfel.js\n\nThe file European_global_navigation_system.doc is a clean document used to distract the user (see Appendix B). The file ubfic.exe\n\nis another dropper containing the real payload. The anfel.js file is used for self deletion. The names: Axpim, ubfic, anfel are random\n\ngenerated.\n\nThe folder name will contain 4-6 characters and starts with capital letter. The file names contain 4-5 lowercase letters before the\n\nextension. The random generator is based on GetTickCount API. The algorithm for creating the names is presented below in python\n\nimplementation. Practically, it concatenates random vowels and consonants, but with the condition that no more than two of the same\n\ntype to be consecutive, with the aim of generating names that are somewhat pronounceable and thus may pass as man-made.\n\nThis algorithm was also used in some versions of Zeus for file name generation.\n```\n# name length will be between minLen and maxLen\n\n###### # flags - 4 name will contain spaces #    - 2 name will have first letter uppercase #    - can be combined\ndef RandomName(minLen,maxLen,flag):\n letters = [’aeiouy’, ’bcdfghklmnpqrstvwxz’] name = ’ ’ seed() index = randint(0,1) nameLen = randint(minLen, maxLen) for i in range(0, nameLen): if i > 0 and i % 2 == 0: index = randint(0,1)     if (flag & 4) == 4 and len(name)>0 and name[-1]!=’ ’ and randint(0,3)==0:       name = name + ’ ’ elif i % 2 == 0:       name = name + choice(letters[index]) else:       name = name + choice(letters[1 - index]) if (flag & 2) == 2: name = name.title() return name.rstrip() \n# generate folder name\n RandomName(4, 6, 2) # generate file names RandomName(4, 5, 0)\n\n```\n\n-----\n\nWhite Paper\n\n###### The Second Dropper\n\nThe payload dropper, ubfic.exe, contains its files in its .data section and is not encrypted or compressed. It creates the files:\n\n- %temp%\\ntlm.exe\n\n- %temp%\\msvci.dll\n\n- %temp%\\msvcp.dll\n\n- %temp%\\msvck.dll\n\n- %temp%\\msvct.dll\n\n- %temp%\\msvci.exe (64 bit)\n\n- %temp%\\msvck60.dll (64 bit)\n\n- %temp%\\msvct60.dll (64 bit)\n\nThese files make up the payload. The last three are for 64-bit Windows, the rest are for the 32-bit version. The starting point of the\n\npayload is the ntlm.exe file which is discussed below. Next, using COM objects, the dropper modifies the .lnk files from the desktop and\n\nsaves the original links in %temp%\\Links folder. The links are modified to start the trojan:\n\nLnk Target\n\nOriginal _„C:\\Program Files\\Sysinternals\\Filemon.exe”_\n\n_„C:\\Documents and Settings\\user\\Local Settings\\Temp\\ntlm.exe”_\n\nModified _C:\\Program Files\\Sysinternals\\Filemon.exe_\n\nThe target file of the link is replaced with ntlm.exe and the original target is sent as a parameter to ntlm.exe, which upon execution\n\nwill execute it. Next, the dropper creates %temp%\\startup.bat which adds to the registry:\n\nHKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\svchostUpdate -> %TEMP%\\ntlm.exe\n\nHKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\Devices -> %TEMP%\\ntlm.exe\n\nThe first key is for starting the trojan, along the .lnk files. Some versions do not have the lnk feature, only the registry keys. The\n\nsecond key is never used in our samples.\n\nLast file created is %temp%\\Axpim\\selfdel.bat for self-deletion.\n\n**msvcp.dll**\n\n32 bit library used for returning the PID of one of the processes: iexplore.exe, outlook.exe, firefox.exe, chrome.exe. It hase one export,\n\nmsvcp, which enumerates running processes and checks their names. It will return the PID of the first one found. If the processes could\n\nnot be enumerated it returns 0. If no process was found it returns -1. Instead of storing the actual names of those processes in the dll,\n\nit stores a byte array as a key and one byte array (result) for each of the 4 names. The checking is done: ProcessName xor key == result,\n\non coresponding bytes. The function may return different PIDs when processes are stopped or started.\n\n|Lnk|Target|\n|---|---|\n|Original|„C:\\Program Files\\Sysinternals\\Filemon.exe”|\n|Modified|„C:\\Documents and Settings\\user\\Local Settings\\Temp\\ntlm.exe” C:\\Program Files\\Sysinternals\\Filemon.exe|\n\n\n-----\n\nWhite Paper\n\n**msvci.dll**\n\n32 bit library used for injecting msvck.dll (the 32 bit backdoor) into a running 32 bit process. The library has one export msvci, which\n\ntakes one parameter representing the PID of a running process. It allocates a small chunk of memory into that process (260 bytes). In\n\nthis memory it copies the path to the msvck.dll file, which is found in %temp%\\msvck.dll.\n\nThen, from the current process it gets the address of LoadLibraryA function and creates a remote thread in the target process starting\n\nat that address. The parameter sent for the thread function is the address of the new allocated string containing the path to msvck.dll.\n\nAs a result, in the target process, a thread is created which just executes LoadLibraryA(„path to msvck.dll”).\n\nThis method will work even if ASLR is enabled, because the random loading offset for dlls is calculated once per boot and by default\n\none dll is loaded at the same address in different processes. msvci.exe\n\n64 bit application used for injecting msvck60.dll (the 64 bit backdoor) into a running 64bit process. The executable takes a commandline\n\nparameter representing a PID. The functionality is identical to msvci.dll library. ntlm.exe\n\nThis is the file that starts the trojan. First, it creates a named pipe \\\\.\\pipe\\bc367 used as a mutex, as the file will probably be executed\n\nmany times from the shortcuts. The name of the pipe and all other strings in the file and in the rest of the dlls are encrypted with RC4.\n\nIt sets the other files of the trojan (msvci.dll, msvcp.dll, msvck.dll, msvct.dll, msvci.exe, msvck60.dll, msvct60.dll) as hidden, ntml.exe\n\nwill not be hidden.\n\nAfterwards, the executable enters an infinite loop.\n\nIt checks if the file %temp%\\msvci.dll exists, if it does not exist it will do a self destroy: deletes all components, deletes registry keys,\n\nrestores the original lnk files from %temp%\\Links, closes the pipe. This behaviour is used by the backdoor component later for self\n\ndeleting.\n\nNext it loads the msvcp.dll library and call msvcp export from it. This function returns the PID of one of the processes: iexplore.exe,\n\noutlook. exe, firefox.exe, chrome.exe, and 0 or -1 if none of those processes was found. If a process was found, its PID is saved into a\n\nvariable, then the program checks whether that process is a 32 bit or 64 bit process.\n\nIf it is a 32 bit process it calls msvci export from msvci.dll with one parameter, the PID. If the process is a 64 bit process it creates a\n\n\nyes PID\n\nIsWow64\n\nno\n\nno ntlm.exe\n\nIsWow64\n\nyes\n\ntarget is target is\n32 bit 64 bit\n\n\nyes\n\nPID == last_PID\n\nno\n\n\nCall msvcp,\nGet PID of target\n\n\nCreate pipe,\nHide files\n\n\nstart\n\n\nCall msvci(PID)\n\n\nSleep 30 sec\n\n\n-----\n\nWhite Paper\n\nprocess from msvci.exe with the commandline parameter being the PID converted to ascii, base 10 (ex: msvci.exe 728).\n\nThe purpose of msvci.dll and msvci.exe (64bit) is to inject the payload into a process. After this it sleeps 30 seconds and repeats\n\nindefinitely.\n\nThe saved PID is checked so that it doesn’t inject again into the same process. This mecanism is flawed because another process from\n\nthe list could be found and it will inject into it also, or it is possible to inject in the same process twice, for example outlook.exe opened\n\nfirst and injected then iexplore.exe opened second and injected then iexplore.exe closed and outlook.exe injected again.\n\nAnother bug can appear if msvcp.dll will be deleted because when calling LoadLibrary and GetProcAddress it doesn’t check the return\n\nvalues and the program will crash when calling a NULL pointer.\n\n**msvct.dll**\n\n32 bit library contains functions for communicating with the C&C, using WinINet API. The backdoor does not contain any C&C\n\naddresses or networking logic, it just uses the exports from msvct.dll, namely:\n\n- BOOL CI(void) – Checks for internet connection. Returns true if a http request („GET /1”) to www.google.com succeeds;\n\nreturns false if not.\n\n- BOOL SHR(char *ServerAddr, char *ServerScript, void *ID, void *SendBuff, void *RecvBuff, void *extra) – Sends and receives\n\ndata to/ from C&C. The communication is encrypted through HTTPS, port 443.\n\n- Extra flags are used for the connection: INTERNET_FLAG_IGNORE_ CERT_DATE_INVALID, INTERNET_FLAG_IGNORE_CERT_\n\nCN_INVALID, SECURITY_FLAG_IGNORE_UNKNOWN_CA to ignore errors caused by invalid certificates. ServerAddr and ServerScript\n\nmake the address of the C&C, these are found using the CS export. ID is a structure made from a buffer (string) and its length. The ID\n\nstring will be put into the HTTP headers. SendBuff is the same type of structure like the ID. SendBuff contains data that is sent to the\n\nC&C. RecvBuff is a structure that contains 4 members, 3 being pointers: a data buffer, a buffer length and two strings. This structure\n\nwill be filled with data coming from C&C. The data buffer can contain batch commands or whole files to be written to disk. The first\n\nstring will contain the Content-Type from the headers and this will be the command for the backdoor. The second string will contain the\n\nContent-Location from the headers and will have the name of a file for download/upload commands. The last parameter, extra, is again\n\na structure from a buffer and its length. It is optional. The string that it contains is sent through the HTTP header. This is used by the\n\nCS export and then it contains that „Check: RandomNr” string for C&C validation. It is also used in the „upload” backdoor command.\n\nThe function returns true or false.\n\n- BOOL CS(void *ID, char *ServerAddr, char *ServerScript) – Check C&C connectivity. Returns true if it founds a valid C&C and\n\nServerAdd, ServerScript (output parameters) will contain the address and the page/script of the C&C. ID (input parameter) is a structure\n\nthat contains a string and its length. The string represents an ID identifying the infected system. This function tries two hardcoded C&C\n\naddresses: 88.208.0.130/rss.php, 78.47.51.238/rss.php (other variants used different addreses). It generates a random number from 0\n\nto 32767 and then creates a string with it, such as: „Check: 1352”. This string will be sent in the http headers using SHR function to the\n\nC&C. If a C&C is alive it must respond with the string „1352” back. If none of the two C&Cs are alive the function returns false.\n\n**msvct60.dll**\n\n64 bit version of msvct.dll msvck.dll\n\n32 bit library containing the main functionality, the actual backdoor. It has no exports and will only execute if injected into iexplore.exe,\n\noutlook.exe, firefox.exe or chrome.exe.\n\nFirst, it checks the internet connection using the CI export from msvct.dll. If it has no internet access the execution ends.\n\nNext it creates an ID of the infected system as a string such as:\n\n„MyCookie: {eceee5c0-1eca-11de-abc9-806d6172696f}{3559831177}” – the GUID is obtained using GetCurrentHwProfile API and the\n\nsecond bracketed number is the volume serial number. If GetCurrentHwProfile fails the ID will be:\n\n\n-----\n\nWhite Paper\n\nThe ID created will be used to check the connection to the C&C with the CS export from msvct.dll. The connection is checked in an\n\ninfinite loop with a sleep of 28 minutes after each check, until a valid, active C&C server is found. The C&C addresses are contained\n\nin msvct.dll and one of them is returned by CS function on success. It can be seen that the loop was meant to only check 3 times for\n\nthe connection (like other samples do), but, maybe because this is a intermediary version or by negligence, the code actually loops\n\nindefinitely.\n\nAfter this follows the code for a regular backdoor which receives commands from the C&C. The commands are received and the\n\nresults are sent back with the SHR export from msvct.dll. The backdoor will be identifying the computer with the ID it created. After\n\n3 successful commands received it will sleep for 28 minutes. After 3 consecutive failed commands (SHR returns false) it will again\n\nperform a C&C validation with the CS function in an infinite loop. Here it may receive the other C&C address. If a command is received\n\nbut it is not recognized it will sleep again for 28 minutes. The commands are text strings and are described below:\n\n„cmd” - Creates the file %temp%\\xmlupd.bat which will contain batch commands. It creates a process with xmlupd.bat but with stderr\n\nand stdout redirected to the file %temp%\\1. It waits maximum 30 seconds for it to finish then it will kill the process. After that it sends\n\nback to the C&C the content of the %temp%\\1 file. Some examples of commands received:\n```\nsysteminfo\nset\nnetstat –ano\n\n###### dir/a %programfiles% \n\n dir /a %programfiles(x86)%\n\n```\n„download” – Receives a file and writes it to %temp%. The name of the file is also received from C&C. It will not execute the file.\n\n„upload” – Receives a file name, reads the file, converts the content to base64 and sends it to the C&C with an extra HTTP header „File:\n\nfilename”. If it doesn’t find the file it sends back the last error (GetLastError for CreateFileA).\n\n„text/html” – This looks like a normal Content-Type HTTP header value (the commands arrive in the Content-Type header). When this\n\nis received it resets the number of consecutive failed commands and sleeps 28 minutes. The backdoor will continue after.\n\n„close” – Stops the execution of the backdoor, the injected thread will terminate.\n\n„selfdestroy” – Deletes the file %temp%\\msvci.dll then ntlm.exe will take care of deleteing all other components. The backdoor ends\n\nexecution after the command.\n\n**msvck60.dll**\n\n64 bit version of msvck.dll.\n\n\n-----\n\nWhite Paper\n\n## 2014-15 Browser Extension\n\n###### The Infected Document\n\nThe infection start from a document cv_Mate.Dimitrescu.doc . The document is constructed in the same way as the documents\n\ncontaining the other variant of the malware. The script in it has the same functionality, it will create and execute the dropper %appdata%\\\n\nMicrosoft\\Word\\MSWord.exe\n\n###### The Dropper\n\nThe dropper looks the same as the other droppers, only smaller in size. The files that it contains are encrypted with RC4 in overlay. Only\n\ntwo files will be dropped:\n\n%appdata%\\Aggea\\ivotp.xpi\n\n%appdata%\\Aggea\\ylir.js\n\nThe names Aggea, ivotp.xpi, ylir.js are random generated. No clean document is present in the dropper and the initial infected document\n\nwill not close. There is no second dropper either. The javascript file is executed, installs the xpi file as an extension in Firefox and then\n\ndeletes the directory %appdata%\\Aggea\\.\n\n###### The Firefox Extension\n\nThe extension file will be renamed to {285364ef-e70c-4386-8e5c-2aa93a78daad}.xpi then will be installed in Firefox. In the browser it\n\nwill appear with the name „langpack-en-GB 15.0.0” as in the picture below.\n\n\n-----\n\nWhite Paper\n\nWe tested it in Firefox 35.0, in some newer versions it didn’t work. In this version of the malware the extension will work as the backdoor.\n\nThe functionality is contained in 3 files in the extension package: 1.js, 2.js, main.js.\n\n1.js\n\nThe file 1.js contains encryption and decryption routines. Algorithm used is AES, and the implementation seems to be copied from\n\nhttps:// github.com/chrisveness/crypto/blob/master/aes.js and ran through an obfuscator.\n\n2.js\n\nThe file 2.js contains the C&C addresses and the network functionality. All data to and from the C&C will be sent through normal\n\nHTTP but it will be encrypted and converted to base64. The encryption key is generated once when the extension is started but it\n\ncan be changed if the C&C requests as we will see later. In this variant we find 6 C&C addresses (presumably these are previously\ncompromised machines):\n\nhttp://reckless.dk/wp-includes/class-pomo.php\n\nhttp://reckless.dk/wp-includes/class.wp-db.php\n\nhttp://fishstalk.esy.es/wp-content/plugins/bbpress/includes/common/menu.php\n\nhttp://fishstalk.esy.es/wp-includes/SimplePie/Net/IPv4.php\n\nhttp://77-ufo.com/wp-includes/class-menu.php\n\nhttp://77-ufo.com/pma/db_table.php\n\nThe strings in the files are not visible because the javascript files are highly obfuscated. The function that sends the data to the C&C\n\nalso receives the response. The function will select each time a C&C that responds from the list. This file would be the equivalent of\n\nthe msvct. dll file from the earlier version.\n\nmain.js\n\nThe file main.js is the actual backdoor (msvck.dll equivalent). The malware starts by creating an ID for the system. The ID is a Md5 hash\n\non some data colected from the system. The ID is sent in every request to the C&C as in the previous version with executable files. This\n\nis an example of the data collected for the ID from a test machine:\n\n{285364ef-e70c-4386-8e5c-2aa93a78daad}C:\\Documents and\n\nSettings\\user\\Application Data\\Mozilla\\Firefox\\Profiles\\2gmaw237. defaultC:\\Documents and Settings\\user\\Desktop{ec8030f7\nc20a-464f-9b0e-13a3a9e97384}\n\nThere are no line separators, it is just a long string. The ID in this case will be „5815da5d0d5565f342474d976f507807”. The gathered\n\ndata represents:\n\n{285364ef-e70c-4386-8e5c-2aa93a78daad} – GUID for the extension\n\nC:\\Documents and Settings\\user\\Application Data\\Mozilla\\Firefox\\Profiles\\2gmaw237.default\n\nFirefox profile folder where the extension was placed\n\n\n-----\n\nWhite Paper\n\n{ec8030f7-c20a-464f-9b0e-13a3a9e97384} - GUID for Firefox\n\nAfter the ID was generated, an encryption/decryption key will be created. It concatenates the hardcoded string\n\n„7201895b632dc5044c02ea98b0dbd371” with the string containing the ID. In the case of our example this will make the string\n\n“7201895b632dc5044c02ea98b0dbd3715815da5d0d5565f342474d976f507807”. Then it makes the Md5 hash on the string which will\n\nresult in “ec398e010a0cb6b6e4f48722dc07eaa3”.\n\nThis final buffer (containing a C like string with the md5) is the decryption key. The key is subsequently used for encryption and\n\ndecryption of every message sent and received from the C&C.\n\nNext it gathers more data about the system. Again, an example from the test machine:\n\n5815da5d0d5565f342474d976f507807 {285364ef-e70c-4386-8e5c-2aa93a78daad} winnt x86\n\nMozilla Firefox {ec8030f7-c20a-464f-9b0e-13a3a9e97384} 35.0\n\nC:\\Documents and Settings\\user\\Application Data\\Mozilla\\Firefox\\Profiles\\2gmaw237.default\n\nC:\\Documents and Settings\\user\\Desktop\n\n0040|||C:\\Documents and Settings\\user\\Application Data\\Mozilla\\Firefox\\Profiles\\2gmaw237.default\\user.js\n\nLines are separated by line feed (0x0A). The data represents:\n\n5815da5d0d5565f342474d976f507807 – System ID\n\n{285364ef-e70c-4386-8e5c-2aa93a78daad} – GUID for the extension winnt x86 – Operating system\n\n{ec8030f7-c20a-464f-9b0e-13a3a9e97384} – GUID for Firefox\n\n35.0 – Firefox version\n\nC:\\Perl... - %path%\n\nC:\\Documents and Settings\\user\\Application Data\\Mozilla\\Firefox\\Profiles\\2gmaw237.default – Path to Firefox profile\n\nC:\\Documents and Settings\\user\\Desktop – Desktop folder of the logged user\n\nC:\\Documents and Settings\\user\\ApplicationData\\Mozilla\\Firefox\\Profiles\\2gmaw237.default\\user.js – Config file for Firefox which\n\ncan override normal settings, it will try to delete it. If is still present after deletion it will put 0041 instead 0040 as the status.\n\nThe data is encrypted with the key that was generated and sent to the C&C. Finally the malware sets a timer which calls a function\n\nthat sends to C&C, receives from C&C and processes the backdoor commands every five seconds. The commands are made up from 3\n\nstrings separated by „|||”,like „nr|||string1|||string2”.\n\nfi\n\n\n-----\n\nWhite Paper\n\n„1|||file commandlineOptions”\n\nExecutes the file „file” with command line parameters „commandlineOptions”. stdout and stderr are redirected to a string and the\n\ncontent of the string will be sent to the C&C. If the file to be executed does not exists it sends back to the C&C „0011|||file”\n\n„2|||url|||file”\n\nDownloads the file from „url” and writes it with the name „file”. Returns to the C&C „0020|||file” if the file was successfuly written,\n\n„0021|||file” if the file was not written or „0051|||url|||errCode” if the download failed.\n\n„3|||file”\n\nSearches the file „file” and sends it to the C&C. In case of an error it will return „0034|||file” if the file is a folder, „0033|||file|||size” if the\n\nfile size is greater than 5000000 bytes, „0031|||file” if the file exists but it couldn’t get information about it, „0032|||file” if the file does\n\nnot exists, „0051|||url|||errCode” if the file could not be sent due to some network problems.\n\n„4|||file”\n\nDeletes the file „file”. Returns to the C&C „0040|||file” if the file was deleted or „0041|||file” if the file could not be deleted.\n\n„5|||string1|||file”\n\nSends back „string1” to the C&C. The C&C responds with a buffer which will be written to the file „file”. It sends back to the C&C\n\n„0020|||file” if the file was successfuly written, „0021|||file” if the file could not be written or „0051|||url|||errCode” in case of network\n\nproblems.\n\n„6|||path|||depth”\n\nLists files and directories from „path” recursively until „depth” level, then it sends the list to the C&C. An example:\n\n0060|||c:\\0\n\n1|c:\\0\\Documents|d|ct=NaN|lat=1442919637000|lmt=1442919637000|\n\n1|c:\\0\\main.js|17394|ct=NaN|lat=1442919639000|lmt=1442405697000|\n\n1|c:\\0\\main1.js.js_format|9486|ct=NaN|lat=1442919639000|lmt=1442404160000|\n\n2|c:\\0\\Documents\\rec.doc|12|ct=NaN|lat=1442919637000|lmt=1442919637000|\n\n...\n\n0061|||path_failed|||error_code\n\n...\n\n0061|||c:\\0|||10000\n\nThe „path” listed and a return code would be „0060|||c:\\0”. „1” and „2” from the start of the lines is the level of a file or directory. The\n\ncount starts at 1 and the maximum level would be „depth”+1This is followed by a file or directory path. After the path a „d” follows, if the\n\npath specifies a directory, or something like „17394” in case of a file, which is the size of the file. „ct=NaN” is the creation time of a file.\n\nThere is a typo in the code and because of that the creation time is never actually retrieved („winBirtdhDate” instead of „winBirthDate”).\n\n„lat=1442919637000” is the last access time. „lmt=1442919637000” is last modified time. „0061|||path_failed|||error_code” is optional\n\nand may appear multiple times, contains a path at which the file enumeration failed. „00061|||c:\\0|||10000” at the end is optional and\n\nappears only if the listing so far contains more than 10000 characters, then no more lines will be added.\n\n„0|||key”\n\nSets a new encryption/decryption key with the C string „key”\n\n\n-----\n\nWhite Paper\n\n## Other 2015 variants\n\nWe found different versions of the files with almost identical functionality and only minor differences. The most notable difference is\n\nthat C&C addresses vary. Another interesting fact is where the samples were spotted.\n\n###### More C&C servers\n\n- reckless.dk/wp-includes/class-pomo.php\n\n- reckless.dk/wp-includes/class.wp-db.php\n\n- fishstalk.esy.es/wp-content/plugins/bbpress/includes/common/menu.php\n\n- fishstalk.esy.es/wp-includes/SimplePie/Net/IPv4.php\n\n- 77-ufo.com/wp-includes/class-menu.php\n\n- 77-ufo.com/pma/db_table.php\n\n- scientific.otzo.com/rss.php\n\n###### Documents\n\nThe documents differ in what they present but they are identical in where the dropper resides and how the script operates.\n\n###### Droppers\n\nThe most common level 1 droppers contain the files encrypted with RC4 in the overlay and level 2 droppers have the files in clear in\n\n.data section. Some level 1 and level 2 droppers are just selfextracting winrar archives, but they have the same functionality.\n\n###### Firefox addon\n\nOnly one version was found.\n\n###### ntlm.exe, svchost.exe, dwms.exe\n\nDifferent names for the starting executable. Some variants do not have the link files functionality and rely only on the registry key to\n\nstart. All variants use the key HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run and the value is named „svchostUpdate” or\n\n„dwm service”.\n\n###### msvci.dll\n\nSome versions check if the process into which they inject is 64 bit or 32 bit. If it is 64 bit „msvci.exe PID” is executed. This looks like\n\nan early version of the code because the functionality for 32/64 bit is in ntlm.exe file and if we have a 64 bit process to inject, msvci.dll\n\nwould not be loaded in the first place.\n\n###### msvct.dll\n\nDifferent C&C addresses.\n\n###### msvck.dll\n\nSome versions check the C&C in an infinite loop other will check it only 3 times and if no connection could be established the execution\n\nends. The computer ID has a GUID obtained with GetCurrentHwProfile in some versions and in others the GUID is taken from the\n\nregistry key HKLM\\SOFTWARE\\Microsoft\\Cryptography\\ MachineGuid\n\n###### Strings\n\nAlmost all strings in the files are encrypted. They are encrypted with RC4 in all versions, only the decryption keys are different.\n\n\n-----\n\nWhite Paper\n\n## 2016 attack wave\n\n###### In May 2016 we have encountered a new wave of attacks. They came, at least in some known cases, as spear phishing emails containing\n\nvarious documents: topics like Oil conferences, international politics, budget calculations, simple guidelines on how to interview for a\n\njob in foreign affairs.\n\nThe attackers moved away from using documents containing macro scripts to employing a zip archive containing a java-script file\n\nthat would in turn drop a clean document and the actual malware. The archived file has a double extension, something like urgent\ndocument.doc.js. This method is probably more efficient, as the victim doesn’t have to enable macros in Word Viewer.\n\nGenerally speaking, the components are slightly different from the 2015 variants but they achieve the same results. As a general\n\nrule, we observed that these variants tend to be stealthier than past years’ variants because malware is only injected in legitimate\n\nprocesses, so that no new main executable will be seen in the process list after injection. The components are outlined below.\n\n###### Document containing malicious macro script\n\n The new infected documents have a different structure, as seen in the picture. The clean document is encrypted directly in the infected document, not contained in the dropper as with previous versions. The macro from the infected document will decrypt and run the clean document and the dropper.\n\n At the end of the document there is a dword which contains the total size (document+dropper+4). In front of the encrypted document is a dword which represents its size. After the encrypted document there is one byte, the checksum.\n\n The encrypted dropper has the same structure. The checksum algorithm remains the same but the encryption is slightly different than before:\n```\n// decrypt\nfor (key = 75, i = 0; i < size; i++)\n{\n  buffer[i] = buffer[i] ^ key;\n  key = (key ^ ((200 + i) % 256) ^ (i % 256);\n\n}\n\n The Dropper\n\n The droppers are self-extracting Winrar archives. They do not contain the clean document any more. The component files are extracted to:\n\n```\n        - %appdata%\\Microsoft\\VisualStudio\\11.0\\dws.exe\n\n        - %appdata%\\Microsoft\\VisualStudio\\11.0\\msi.dll\n\n        - %appdata%\\Microsoft\\VisualStudio\\11.0\\msi32.dll\n\n        - %appdata%\\Microsoft\\VisualStudio\\11.0\\msk.dll (optional)\n\n        - %appdata%\\Microsoft\\VisualStudio\\11.0\\msp.dll\n\n\n-----\n\nWhite Paper\n\n        - %appdata%\\Microsoft\\VisualStudio\\11.0\\msi.exe (64 bit)\n\n        - %appdata%\\Microsoft\\VisualStudio\\11.0\\msi60.dll (64 bit)\n\n        - %appdata%\\Microsoft\\VisualStudio\\11.0\\msk60.dll (64 bit, optional)\n\n        - %appdata%\\Microsoft\\VisualStudio\\11.0\\msp60.dll (64 bit)\n\n        - %appdata%\\Microsoft\\VisualStudio\\11.0\\mst60.dll (64 bit)\n\n        - %appdata%\\Microsoft\\VisualStudio\\11.0\\msvci60.dll (64 bit)\n\nmsk.dll and msk60.dll are not always present in which case their functionality is taken by another dll. After the files are dropped the\n\nfile dws.exe is executed without any parameters.\n\n**msp.dll**\n\nSimilar to the old msvcp.dll. Returns the PID of some processes. It has 3 important exports: p, p1, p2.\n\n     - p export has the functionality as the older variant, returns the PID of one of iexplore.exe, firefox.exe, chrome.exe, outlook.exe.\n\n     - p1 export returns the PID of dwm.exe (Windows Desktop Manager).\n\n     - p2 returns the PID of taskhostex.exe (Host Process for Windows Tasks) or sihost.exe (Shell Infrastructure Host). These are\n\nlegitimate processes that can be found in Windows 8 and Windows 10. Some variants do not search for sihost.exe.\n\n     - Some variants also have another export kp which kills a process, but it’s never invoked.\n\n**msp60.dll**\n\n64 bit variant of msp.dll.\n\n**msi.dll**\n\nThis is similar to the old msvci.dll. It has one export msvci with two parameters, a path to a file and a PID. It will inject the file from the\n\npath into the process with that PID. For 32 bit processes.\n\n**msvci60.dll**\n\n64 bit variant of msi.dll.\n\n**msi.exe**\n\nSimilar to msi.dll, for 64 bit processes. It will look for 1 or 2 command line parameters.\n\nThe first is a process PID. The second parameter can be anything and is just a flag for\n\nknowing what library to inject: 2 parameters – will inject msi60.dll, 1 parameter – will\n\ninject msk60.dll. The injection is done with the msvci export from msvci60.dll.\n\n**dws.exe**\n\nThe starting module. If it was started with a parameter and the parameter is not a number (as an ascii string), it will create a process\n\nwith the executable taken from the parameter; this looks like a reminiscent of the .lnk files functionality.\n\nIf the parameter is a number, the number will be interpreted as a PID and it will check if the process with that PID is a 32/64 bit\n\nprocess. If it is a 64 bit process, dws.exe will create a new process with the command line “msi.exe PID”. If it is a 32 bit process, dws.\n\nexe will load msi.dll and call its export as msvci(“msvck”,pid). In this case (parameter as number received) the execution stops here.\n\nIf th fil dll i t t it ill d l t ll t f th t j Oth i it ill ll f dll th t 1 2 ( l\n\n\n-----\n\nWhite Paper\n\nwill run “msi.exe PID 1”; two parameters are passed, the last one being dummy and used by msi.exe just to know to take a different\n\npath of execution. If the returned PID is for a 32 bit process, it will load msi.dll and call msvci(“msi32.dll”, PID). After this the program\n\nterminates (the older ntlm.exe would have stayed in a loop here).\n\n**msi32.dll**\n\nCode from this library will execute injected in dwm.exe, taskhostex.exe. Sets the same registry autorun key as the 2015 variants. It\n\nwill also set a scheduled task:\n\nschtasks /create /SC DAILY /ST 12:00 /TN update /F /TR %appdata%\\Microsoft\\VisualStudio\\11\\dws.exe\n\nwhich will make sure that main module will start daily.\n\nChecks if msp.dll exists, if it does not, it will execute dws.exe without parameters, which in turn will self delete the Trojan. It uses\n\nfrom msp.dll the p export to get a PID. If that PID is a 32 bit process it will run “dws.exe PID” and if it is a 64 bit process it will run\n\n“msi.exe PID”. Those processes with parameters will inject the actual backdoor (msk.dll). It will stay in a loop and try to find targeted\n\nprocesses in order to inject in them. This variant of the Trojan is stealthier than the previous one in which ntlm.exe would stay in a\n\nloop and try to inject, in which case a suspicious process (ntlm.exe) would be visible.\n\n**msi32.dll – with backdoor functionality**\n\nIn some droppers msi32.dll has another variant different enough to be described separately. In this case msi32.dll would contain\n\nbackdoor functionality along the functionality described earlier. It will function in 2 ways (backdoor or earlier msi32.dll) based on the\n\nname of the process from which it runs. If the containing process is dwm.exe, taskhostex.exe or sihost.exe it will function like the\n\nusual msi32.dll and also will copy itself as msk.dll for later use as the backdoor. If the containing process is another process then it\n\nwill function as the backdoor (identical to msk.dll).\n\n**msi60.dll**\n\n64 bit variant of msi32.dll.\n\n**msk.dll**\n\nThe backdoor component, similar to the old msvck.dll, it has the same functionality. For selfdelete it will delete msp.dll. It also has a\n\nnew backdoor command “st” which sets the time in milliseconds for Sleep, time value received from the C&C.\n\n**msk60.dll**\n\n64 bit variant of msk.dll.\n\n**mst.dll**\n\nLibrary used for communication with the C&C. Very similar to the old msvct.dll. Internet connection is checked with “go.microsoft.\n\ncom” .\n\n**mst60.dll**\n\n64 bit variant of mst.dll.\n\n\n-----\n\nWhite Paper\n\n###### Functionality diagram\n\n Functionality summary:\n\n1. The macro from the infected document will drop and open a dummy clean document and a dropper.\n\n2. The dropper will drop the component files in the folder %appdata%\\Microsoft\\VisualStudio\\11\\ and will open dws.exe without\n\nparameters.\n\n3. dws.exe will use the function p2 (only on Windows 8 or Windows Server 2012) or the function p1 from msp.dll. p1 will return the\n\nPID of dwm.exe, p2 will return the PID of taskhostex.exe.\n\n\n-----\n\nWhite Paper\n\n4. dws.exe will load msi.dll and will call its export as msvci(“msi32.dll”, PID), with the PID returned from step 3. This will inject msi32.\n\ndll into dwm.exe or taskhostex.exe depending on the OS. After this dws.exe process terminates.\n\n5. a.  msi32.dll will add a run key in registry and a scheduled task, both will open dws.exe\n\nb.  msi32.dll will copy itself to msk.dll. This step is done only in some versions where msi32.dll has the backdoor functionality and\n\nthe initial backdoor msk.dll is missing.\n\n6. msi32.dll will use the function p from msp.dll which will return the PID of one of iexplore.exe, outlook.exe, firefox.exe, chrome.exe.\n\n7. msi32.dll will create a new process with dws.exe with a parameter, the PID returned at step 6. If at step 6. the file msp.dll was not\n\nfound (selfdelete from backdoor), it will create a new process with dws.exe but without parameters, which in turn will delete all\n\ncomponents. msi32.dll will stay in a loop repeating from step 6 (the backdoor variant of msi32.dll will exit).\n\n8. dws.exe with a parameter will function differently and will call the export from msi.dll as msvci(“msk.dll”, PID), with the PID\n\nreturned at step 6., received as a command line parameter. This will inject msk.dll in the specified process. After this dws.exe\n\nprocess terminates. At this step it does not matter if msk.dll is the msi32.dll variant or not.\n\n9. msk.dll is the backdoor program and will use exports from mst.dll to communicate with the C&C. In case that msk.dll is msi32.\n\ndll variant the selfdelete will be done here (start dws.exe) and not in step 7. because msi32.dll will no longer run in dwm.exe,\n\ntaskhostex.exe or sihost.exe.\n\nZip file containing malicious java-script\n\nIn this variant victim is lured to double click on a file with double extension .doc.js this way java-script file gets executed, will\n\ndecode a clean Word document and a malware executable file, both are embedded in java-script. Next, a windows task is created\n\nto run the malware, and clean document is opened. Malware execution follows as previously described.\n\n###### C&C\n\nWe have 4 unique C&Cs for 2016 variants, hosted in Netherlands, New York and Germany. The machines used are most\n\nlikely compromised web servers.\n\n\n-----\n\nWhite Paper\n\n\n###### Binary difference between 2014/2015 and 2016 variants\n\n**diagram representing backdoor main function**\n\nYellow blocks represent partial code modifications compared to 2015 versions. Red blocks represent added functionality. We can\n\nsee that little functionality was added to backdoor component.\n\n\n-----\n\nWhite Paper\n\n## IOCs\n\nFile paths\n\n%APPDATA%\\Microsoft\\Word\\MSWord.exe\n\n%APPDATA%\\Axpim\\ubfic.exe (random)\n\n%APPDATA%\\Axpim\\anfel.js (random)\n\n%APPDATA%\\Nuuw\\ilebi.xpi (random)\n\n%APPDATA%\\Nuuw\\yqyra.js  (random)\n\n%TEMP%\\ntlm.exe\n\n%TEMP%\\msvci.dll\n\n%TEMP%\\msvcp.dll\n\n%TEMP%\\msvck.dll\n\n%TEMP%\\msvct.dll\n\n%TEMP%\\msvci.exe  (64bit)\n\n%TEMP%\\msvck60.dll (64bit)\n\n%TEMP%\\msvct60.dll (64bit)\n\n%APPDATA%\\Microsoft\\VisualStudio\\11.0\\dws.exe\n\n%APPDATA%\\Microsoft\\VisualStudio\\11.0\\msi.dll\n\n%APPDATA%\\Microsoft\\VisualStudio\\11.0\\msi.exe\n\n%APPDATA%\\Microsoft\\VisualStudio\\11.0\\msi32.dll\n\n%APPDATA%\\Microsoft\\VisualStudio\\11.0\\msi60.dll\n\n%APPDATA%\\Microsoft\\VisualStudio\\11.0\\msk.dll\n\n%APPDATA%\\Microsoft\\VisualStudio\\11.0\\msk60.dll\n\n%APPDATA%\\Microsoft\\VisualStudio\\11.0\\msp.dll\n\n%APPDATA%\\Microsoft\\VisualStudio\\11.0\\msp60.dll\n\n%APPDATA%\\Microsoft\\VisualStudio\\11.0\\mst.dll\n\n%APPDATA%\\Microsoft\\VisualStudio\\11.0\\mst60.dll\n\n%APPDATA%\\Microsoft\\VisualStudio\\11.0\\msvci60.dll\n\n%APPDATA%\\Axpim\\selfdel.bat\n\n%TEMP%\\xmlupd.bat\n\n\n-----\n\nWhite Paper\n\n\npipes\n\n\\\\.\\pipe\\bc367\n\n\\\\.\\pipe\\bc31a7\n\nRegistry paths\n\nHKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\svchostUpdate\n\n-> %TEMP%\\ntlm.exe\n\nHKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\Devices\n\n-> %TEMP%\\ntlm.exe\n\nHKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\svchostUpdate\n\n-> %TEMP%\\svchost.exe\n\nHKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\Devices\n\n-> %TEMP%\\svchost.exe\n\nHKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\dwm service\n\n-> %TEMP%\\dwms.exe\n\nHKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\Devices\n\n-> %TEMP%\\dwms.exe\n\nHKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\dwupdate\n\n-> %APPDATA%\\Microsoft\\VisualStudio\\11.0\\dws.exe\n\n**tasks**\n\nupdate\n\n- command schtasks /create /SC DAILY /ST 12:00 /TN update /F /TR %APPDATA%\\Microsoft\\VisualStudio\\11.0\\dws.exe\n\n**network activity**\n\n2014-2015 variants:\n\nreckless.dk/wp-includes/class-pomo.php\n\nreckless.dk/wp-includes/class.wp-db.php\n\nfishstalk.esy.es/wp-content/plugins/bbpress/includes/common/menu.php\n\nfishstalk.esy.es/wp-includes/SimplePie/Net/IPv4.php\n\n77-ufo.com/wp-includes/class-menu.php\n\n77-ufo.com/pma/db_table.php\n\nscientific.otzo.com/rss.php\n\n\n-----\n\nWhite Paper\n\n## SHA1 hashes of all known variants\n\n\n0641f22e1b4e15cc23660b2e8bbf42623e997dfb\n\n0af1a6d6c487e78aa252ae2f5921606a8a379206\n\n100241519698bb013f668ff49d3d0d4fdab6a584\n\n14014f810a0c07b6dde48b7a8954b56c409ae7f3\n\n16c6d317fd7c361623c62cf5652a6b7937f58e0a\n\n22c565e2cfb8adadd022b0ec281bb2b6ed62dca2\n\n23ce92fd1d4d2d42389a66869434fb578aa3f539\n\n261a8fc8e0e396298120a7bc15c32a37f3ce5b94\n\n2a9c8639215faf08593f17b930f83757324dfbee\n\n2ad7262ad52320399aa54cd8482c30e7a480bebc\n\n2eb5a075b710155c409e727e7f74fdc3be63b58c\n\n325b1075b4544ecc2c5741a7a06a9df00f0965da\n\n336d5957909487990033a3432d0347be34db044a\n\n368b746daf5448812b231aed67bd795dfb5a605d\n\n38d16c19b54bf2c94e0ad81fca207de062181b31\n\n4880a13c4e1cde0343c233f5e107abf4e3d00664\n\n49f0569886e5e6ba4b32b7f118dc35f9e5916dc2\n\n4eecebf5c9720c8e85347e0dcf55a844a6d01b08\n\n5374b898dbb618aa84d92f7a3e9d166e9e819960\n\n54ac8caeae8046e01301379602041c74ee527dfc\n\n5617c1414cb79411c64883ee72d219d52123fa30\n\n583036a7c9b210508c222c7dfdd9b8321feca7df\n\n58952be65d0ed53490f69f566485c699f246dcc0\n\n5a6b14fad221ab65a086b1ee7c97eb63ff38480e\n\n5aaa055fa5eb9a436ca0e643bf2ada268bcd6f33\n\n5bcc6da122b3aa88c766d80eb7774c2c6e9e25d5\n\n623185a651a1962538141d7ffefdc2f2445a9201\n\n66a7642abaf3d05d5ab14e83dfd52eca0c17acc6\n\n67e9e098c2b39b5847f6cd3aa5a3f86917602f5f\n\n6a2d12adc541c9c5aaa1096d7e59c72c489cdd59\n\n713855aa5680154324bfcbac638aa1c12681e3c3\n\n7674f680fd0c24c222c027976c40ffe1e08c6f2e\n\n7abf407b9a19dd9ee528fa6e5a099ea1c8ba2f98\n\n80091e1b7b4dd404c83a9c54fda9e6951b2689b1\n\n852dc73ca9e6d92b3da96500d27ab44b7f9a4ea4\n\n85c03c6fa5e3803e55a46f17d6981992181de57b\n\n88af035dc34f730c884b5a11c8be666974a1a6eb\n\n88fd1ee6fb78385a1c5e462dd0768bc34b8188a3\n\n8c4dd73cdd48908ddf5039c5a99e719dfd44ff41\n\n8d40a65a2bca1378eb6e009c1842aa0e45ae289e\n\na5359856742d09d1596e5c7fde407856d72046db\n\na9239572afe4fbdfe077a262c9699eb1d22a9c87\n\nacc2250be782063f268b87bd0f798549c5838b95\n\naecf66120861b71c92a2d1f0015fc9228c02ee88\n\nb2700f16e4494ef7eba26b88a800728621adffea\n\nb4afc5e0002201ce052466cba9061018474b1de0\n\nb55dac24f646dd5e0ea856d6ed7891ad8c8acdc1\n\n\nc4b06021c6c925c837dab3ba42c6b76eb77ad30b\n\nc5166d1a574bc5e374490846f2584f94f755d90b\n\nc9b1208be2aa2c5cfbcbfcb9b1a45c36854414b8\n\nce234ed0899c8f97e3f2085215b842723a773368\n\nd80d5ccb9d37d971a408d3c91f803e40b8421a2c\n\nd83d7de186fa6c7abe4676eb568ba4dc62a7c931\n\ne20b0f03f6708118bca9f408b156b210ba083b54\n\neacadedc31af04ef86470aec62ad3eccc9a35332\n\neb0f02e36e77221366becabc60e78dd43368ab9d\n\neb1b83825ff28de7f13812bfce273ad7fb1994fb\n\nede8ec9f3efeb515859becd1f430f82933b42dd9\n\nedf96c42f4e1cf43fbaab3f0bbf54280fc8e311d\n\neea9fec97dca5d122069adf6dd71628bd6d9c2fd\n\nf9af4a51616db485adc577ad600b60e77916cace\n\nfbd538cf432f2576b37e2770f860b70b009c3cf3\n\n01e2e16be5828ca03c6b78f253bd962bfaa5ccbf\n\n09df1b0abd32791c3b0d5d657cd956f81e2dacb2\n\n0a9dd2b71df68ba088d7d868d7e191875755e34c\n\n14b6f2bc2b869d3417619201c7205e240a93d2ef\n\n1ae10d6ec5d33b704c32ef52c3ee9671f4298d5f\n\n1e49924afe56e3c782893118a51256ca5f247fba\n\n23d5cc54641f56f554890bbd55d580e5c564e197\n\n26f8d64038439c006f12ec34b035b1dee1c56b31\n\n272c42bcdcc88adba1e01e60a931fbe5f5800883\n\n2a84f90ed23a569defee7b37f4650aca4021a767\n\n2bf06a003a9bd56d2ed91770966a7aee7d9784b9\n\n321ca51b4c250515bc3075abe735e360a57dee22\n\n33f57151a52666ca055f1dc66ef04e2f9cb09918\n\n3e10fd3e8d4c4a7900e603aee7660c83441d998e\n\n3fbaf98c75992db9db11d29ae20c13b7b0f50470\n\n443551d822eba6a81b8ac3177e31e210c99934d0\n\n45c7f3f065cf015289ab17161a1880eb638b508a\n\n46f1b8722f8f094015c749599e94a3e44850df0a\n\n4f35665e689bea4f116505f81ae2906fd1517128\n\n547f525f57f3f47222ae3ab253635df936bd355a\n\n585550816539b73dfdc3cee80cc60e1cdc1cdb3e\n\n5d492ae763bfc227db9eea46e560124128ff925b\n\n5ff776d23e6c6af47619ad2e7333a434b79e19df\n\n621698f821a2bafccad026f9f5d2fe1ac46a39ce\n\n66ec04c005d0a1ebc218455915e31d2a2b6dd459\n\n686ada60c898782b57ca993141b64f7c7a531c50\n\n6c68a9df2d710187d067ecb2d0cc04358d570b52\n\n6e070e01076a4a92f08924a405f389436003d927\n\n78499e4694f847972576960a04f8177691a7c911\n\n840563929f13ab05e45a8d3fb2d11e70e3cdccca\n\n840de34aa767131eb34069e6f936dea3a48c024e\n\n85a6e3a3fcee71ffa2aad90336960132fa8f4c4d\n\n\n-----\n\nWhite Paper\n\n\n8ffd436182f8d2a7ec0a66c0d6d43f71222f62b5\n\n92731e4ed149c59a25c233635c55a87a8a22b19f\n\n96d9cf7296f02bf4e49c0540fb84981493b61a93\n\n9957af2dbfa04bca2a5319a216852ce4f4a17682\n\n9b0effd20ea7239275b6cf1e02280eb67eced701\n\na5daecfd57f006acd15486bd544f40e4cdce3801\n\na753de6b2e6d3d5735fc5e90a879f1ad7e93fb0f\n\nb0b9215e236bb47f5f0a108be97b24d20898d2fc\n\nb35b07ad4f42493ecb19f66aba83da8e74c1bb5a\n\nb4e867893d9d6f8b52de98ab6b41513d61f20472\n\nccf0a302eb264cbb5db726d61ad18ebdc0d3d012\n\nd53eb2a6904d1fb7982bb876916cd3723c3dc9b1\n\nd6d3d9a56513b83db497a8d4701c2ac7270d78eb\n\nd7218e80261517badd8090d3a5ba0a1ed21c21a2\n\nd74d8ec530c02b1eb94203de1f641e15a72faf8d\n\ne32832e3f0e0b8450e7bdded16c441951b171130\n\neda30afac2c1fa0ed2c80e8859e2556ea3dfe2ef\n\nee1f5ba06400fa192664f984d71b1a0cdba96d75\n\nf781e603c55558708ac3101d0bfee2c1752693c2\n\nfdb9d026502aa64aa23b1acb96f6d0013ef874b4\n\n\nb719e1d03e860235a68dda4168f29ac4988d25de\n\nba29c29a35d15a668ea2ea79d1d4e56c2d67553f\n\nbca5accb9f1d0806f8603cf74ce0ebe9519f5004\n\nbe10c837af1f25ee67440f3a33da8c650f5ab54a\n\nc34a68c1a2d2beddbbe8ee8bd125cce14d0dc377\n\nc3bc94b065449879c25a541d740346e060d9d6fe\n\nc414ba1dd1f281a63e58c60eb1d8cb4ac3c4e7f0\n\nc7accc1c4ceedc756c30ebb2f1ff9f0dbd0255b0\n\nc8395601ea301ba083cb530dad7a44c8048eeb77\n\nca07bbfc5e8c15c4258f92e6e6c328b86b7b19a5\n\n\n-----\n\nWhite Paper\n\n## Clean documents opened by droppers\n\n###### Invitation to event organized by the UK embassy in Ashgabat:\n\n\n-----\n\nWhite Paper\n\nCar for sale:\n\n\n-----\n\nWhite Paper\n\n23[rd] International Caspian Oil & Gas Conference\n\nPresentation for a real conference that took place on 1-4 June 2016 in Azerbaijan, Baku. Picture and text are taken from official page\n\nof conference organizers.\n\n\n-----\n\nWhite Paper\n\n###### Australia - Korea Foundation, foreign affairs position, interview guidelines\n\nData seems to be taken from Australian Government, Department of Foreign Affairs and Trade.\n\n\n-----\n\nWhite Paper\n\n###### International politics\n\nText is a Bloomberg news story from October 24th: Bulgaria, Romania and Serbia Ready to Close Borders for Migrants.\n\n\n-----\n\nWhite Paper\n\n\nBudget plan template\n\nThis one looks as a budget calculation template taken from “Relations internationals et Francophonie” of Québec.\n\n\n-----\n\nBitdefender is a global security technology company that delivers solutions in more than 100 countries through a network of value-added alliances, distributors and\n\n\nreseller partners. Since 2001, Bitdefender has consistently produced award-winning business and consumer security technology, and is a leading security provider in\n\nvirtualization and cloud technologies. Through R&D, alliances and partnership teams, Bitdefender has elevated the highest standards of security excellence in both its\n\nnumber-one-ranked technology and its strategic alliances with the world’s leading virtualization and cloud technology providers. More information is available at\n\n\nhttp://www.bitdefender.com/\n\nAll Rights Reserved. © 2015 Bitdefender. All trademarks, trade names, and products referenced herein are property of their respective owners.\n\nFOR MORE INFORMATION VISIT: enterprise.bitdefender.com\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "6825b8cb-7d82-43d2-b0b0-d51c7e255b42",
            "created_at": "2023-01-06T13:46:37.642134Z",
            "updated_at": "2023-01-06T13:46:37.642134Z",
            "deleted_at": null,
            "name": "MISPGALAXY",
            "url": "https://www.misp-project.org/galaxy.html",
            "description": "MISP Galaxy Clusters",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/xcu346jhiokohlj9300q6hif06swac57",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2016/2016.07.01.Bitdefender_Pacifier_APT/Bitdefender-Whitepaper-PAC-A4-en-EN1.pdf",
        "https://download.bitdefender.com/resources/files/News/CaseStudies/study/115/Bitdefender-Whitepaper-PAC-A4-en-EN1.pdf"
    ],
    "report_names": [
        "Bitdefender_Pacifier-APT(7-1-2016)",
        "Bitdefender-Whitepaper-PAC-A4-en-EN1",
        "Bitdefender-Whitepaper-PAC-A4-en-EN1.pdf"
    ],
    "threat_actors": [
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1666716501,
    "ts_updated_at": 1743041688,
    "ts_creation_date": 1467302012,
    "ts_modification_date": 1467302015,
    "files": {
        "pdf": "https://archive.orkl.eu/6289dff2cbd2750c76517007989483922179fa40.pdf",
        "text": "https://archive.orkl.eu/6289dff2cbd2750c76517007989483922179fa40.txt",
        "img": "https://archive.orkl.eu/6289dff2cbd2750c76517007989483922179fa40.jpg"
    }
}