{
    "id": "35aafcf6-e05c-486b-a6de-4eb61e735b02",
    "created_at": "2023-01-12T15:00:33.805723Z",
    "updated_at": "2025-03-27T02:05:38.608291Z",
    "deleted_at": null,
    "sha1_hash": "4577942324a663ea44c48e081073f96347b2c397",
    "title": "2020-03-18 - Why would you even bother-! - JavaLocker",
    "authors": "",
    "file_creation_date": "2022-05-28T01:28:39Z",
    "file_modification_date": "2022-05-28T01:28:39Z",
    "file_size": 399191,
    "plain_text": "# Why would you even bother?! - JavaLocker\n\n**[dissectingmalwa.re/why-would-you-even-bother-javalocker.html](https://dissectingmalwa.re/why-would-you-even-bother-javalocker.html)**\n\nWed 18 March 2020 in [Ransomware](https://dissectingmalwa.re/category/ransomware.html)\n\nToday we'll take a look at a windows ransomware built with Java. As you might have\nguessed this will get ugly and is therefore not for the faint of heart.\n\nHey there, yeah it has been a while. I've been quite busy with university stuff for the past\nweeks, so I'm trying to get back into the analysis/blogging thing. I've been looking for\ninteresting/\"innovative\" samples that differ from the common tricks and techniques. It was\nunavoidable that I would have to look at a ransomware strain written in the most beautiful\nprogramming language there is sooner or later: Java. Let's get it over with.\n\nThis strain is without a doubt still in it's testing phase, so it is possible that there will be\nanother version of it with proper encryption routines and other fixes in the next few days.\n\n[JavaLocker @ AnyRun |](https://app.any.run/tasks/a14f4d72-1628-481c-9206-1266f75d31ae/) [VirusTotal |](https://www.virustotal.com/gui/file/9cb578d8517dc1763db9351d3aa9d6958be57ac0b49e3b851f7148eee57ca18b/detection) [HybridAnalysis -->](https://www.hybrid-analysis.com/sample/9cb578d8517dc1763db9351d3aa9d6958be57ac0b49e3b851f7148eee57ca18b) `sha256`\n```\n9cb578d8517dc1763db9351d3aa9d6958be57ac0b49e3b851f7148eee57ca18b\n\n```\nFirst of all, this is the GUI that the vicitim is presented after a reboot. The Ransomware will\nencrypt the files on the systems without a delay, but this window isn't shown immediately\nafter, so it's easily missed by Sandboxes like AnyRun that don't reboot for analysis. Apart\nfrom the terrible design and english grammar there's nothing more to this screen.\n\n\n-----\n\nTo display the Window with the ransomnote it will copy itself to the Startup Folder.\n\nTo decompile the JAR file that I pulled from AnyRun I'm using JD-GUI. To preserve the\neyesight of potential readers I later opted to copy the code to a dark-mode capable texteditor.\n\nThe Ransomware implements four classes in addition to JavaFX for the GUI:\n\n_JAVABASIC : Handles the core functions of the Malware._\n\n\n-----\n\n_Encryption : Derives a password for the encryption routine and hashes it with MD5._\n\n_crea : Writes another instance of the ransomware to the disk._\n\n_key : Holds the encryption and decryption routines._\n\nThe \"scanner\" function looks for other attached drives connected to the vicitims PC. One\nthing to take note of is that the ransomware will only check the drive letters from C through\nH, so naming and mounting your network drives X:, Y: or Z: might actually save you to some\nextent.\n\n\n-----\n\nA few things that stand out in the next screenshot: The ransomware will spare the\nC:\\Windows path. Secondly the dropped ransomnote will be named\n_\"readmeonnotepad.javaencrypt\" with the following content:_\n\n**\"Q: What Happen to my computer?\\n A:Your personal files are encrypted by**\n**javalocker!\\nQ How can I recover my Files? A You need to send 300$ of bitcoins to the**\n**following adress:BAW4VM2dhxYgXeQepOHKHSQVG6NgaEb94 then contact**\n**soviet@12334@gmail.com!\"**\n\nAnother interesting fact is that the wallet address mentioned in the ransomnote is just a\nrandom string (another indicator for a test build). The address format doesn't match any of\nthe ones used in mainnet, bchtest or testnet. For the BTC mainnet it would have to start with\neither 1, 3 or bc1 and it also contains an illegal character (\"O\"). For further reference I would\n[recommend this guide by AllPrivateKeys.](https://allprivatekeys.com/bitcoin-address-format)\n\nThe functions find2 and ret are also pretty redundant which indicates lack of knowledge or\ntime spent on it.\n\n\n-----\n\nLet's check which filetypes are affected at the moment. Normally these extension lists are\nsorted alphabetically, but this one is not. Looks like they cobbled this one together rather\nthan using one of the premade \"popular file extensions\" lists.\n```\n\".accdb\", \".pub\", \".reg\", \".ico\", \".mui\", \".onetoc2\", \".dwg\", \".wk1\", \".wks\",\n\".vsdx\", \".vsd\", \".eml\", \".msg\", \".ost\", \".pst\", \".pptx\", \".jfif\", \".doc\", \".docx\",\n\".xls\", \".xlsx\", \".ppt\", \".ost\", \".msg\", \".eml\", \".vsd\", \".txt\", \".csv\", \".rtf\",\n\".123\", \".wks\", \".pdf\", \".dwg\", \".onetoc2\", \".snt\", \".snt\", \".jpeg\", \".jpg\", \".docb\",\n\".docm\", \".zip\", \".7z\", \".rar\", \".mp4\", \".wav\", \".mp3\", \".cpp\", \".gho\", \".iso\",\n\".mui\", \".flv\", \".wma\", \".key\", \".sln\", \".vbs\", \".bat\", \".cs\", \".ini\", \".cmd\", \".lv\",\n\".c\", \".js\", \".php\", \".mp4\", \".html\", \".py\", \".docb\", \".pps\", \".gz\", \".gpg\", \".xlsm\",\n\".vmdk\", \".vmx\", \".pot\", \".pps\", \".ppsm\", \".ppsx\", \".ppam\", \".potx\", \".potm\", \".edb\",\n\".hwp\", \".602\", \".sxi\", \".sti\", \".sldx\", \".sldm\", \".vdi\", \".aes\", \".arc\", \".paq\",\n\".bz2\", \".tbk\", \".bak\", \".tar\", \".gz\", \".backup\", \".vcd\", \".bmp\", \".png\", \".gif\",\n\".raw\", \".cgm\", \".tif\", \".tiff\", \".nef\", \".psd\", \".ai\", \".svg\", \".djvu\", \".m4u\",\n\".m3u\", \".mid\", \".wma\", \".3g2\", \".mkv\", \".3gp\", \".mov\", \".avi\", \".asf\", \".asf\",\n\".mpeg\", \".vob\", \".mpg\", \".wmv\", \".fla\", \".swf\", \".wav\", \".sh\", \".rb\", \".asp\",\n\".php\", \".jsp\", \".brd\", \".sch\", \".dch\", \".dip\", \".dp\", \".vb\", \".vbs\", \".ps1\", \".asm\",\n\".h\", \".pas\", \".suo\", \".ldf\", \".mdf\", \".ibd\", \".myi\", \".myd\", \".frm\", \".obd\", \".dbf\",\n\".db\", \".mdb\", \".accdb\", \".sql\", \".sqlitedb\", \".sqlite3\", \".asc\", \".lay6\", \".lay\",\n\".mml\", \".sxm\", \".otg\", \".odg\", \".uop\", \".std\", \".sxd\", \".otp\", \".odp\", \".wb2\",\n\".slk\", \".dif\", \".stc\", \".sxc\", \".ots\", \".ods\", \".3dm\", \".max\", \".3ds\", \".uot\",\n\".stw\", \".sxw\", \".ott\", \".odt\", \".pem\", \".p12\", \".csr\", \".crt\", \".pfx\", \".der\"\n\n```\n\n-----\n\nThis build of the ransomware uses DES via javax.crypto.Cipher to encrypt the victim s files.\nThe Seed Value for the DES SecureRandom function is hardcoded and held in variable td.\n\nFellow researcher @jishuzhain found that the DES key derived from the td seed is static\nwhich should enable victims affected by this exact version to get their files back.\n\n[ðŸ‘Simple analysis of this ransomware. pic.twitter.com/A9zIAhryi8](https://t.co/A9zIAhryi8)\n\n[â€” onion (@jishuzhain) March 9, 2020](https://twitter.com/jishuzhain/status/1236934202429341696?ref_src=twsrc%5Etfw)\n\n\n-----\n\nAnd this is where we come to the point of the article headline. Why would someone even\nbother to: 1. build a Ransomware in JAVA; 2. build it from scratch, because there are, of\ncourse, open source ransomware projects on Github like the one below (I selected this one\n[because it can't be directly weaponized, but you probably know my stance on OSS](https://dissectingmalwa.re/earn-quick-btc-with-hiddentearmp4-about-open-source-ransomware.html)\nransomware) ðŸ™„.\n\n## MITRE ATT&CK\n\n_T1179 --> Hooking --> Persistence_\n\n_T1179 --> Hooking --> Privilege Escalation_\n\n_T1179 --> Hooking --> Credential Access_\n\n_T1114 --> Email Collection --> Collection_\n\n## IOCs\n\n### Javalocker\n```\nJAVABASIC.jar --> SHA256:\n9cb578d8517dc1763db9351d3aa9d6958be57ac0b49e3b851f7148eee57ca18b\n         SSDEEP:\n768:/OJ3GtaE64BWRRJcU99iOZlkp8DOJ3GtaE64BWRRJcU9+0de:/O4tG4cJb9XnLDO4tG4cJD+4e\n\n Associated Files\nJAVABASIC.jar\nreadmeonnotepad.javaencrypt\nDESkey.dat\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-03-18 - Why would you even bother-! - JavaLocker.pdf"
    ],
    "report_names": [
        "2020-03-18 - Why would you even bother-! - JavaLocker.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535633,
    "ts_updated_at": 1743041138,
    "ts_creation_date": 1653701319,
    "ts_modification_date": 1653701319,
    "files": {
        "pdf": "https://archive.orkl.eu/4577942324a663ea44c48e081073f96347b2c397.pdf",
        "text": "https://archive.orkl.eu/4577942324a663ea44c48e081073f96347b2c397.txt",
        "img": "https://archive.orkl.eu/4577942324a663ea44c48e081073f96347b2c397.jpg"
    }
}