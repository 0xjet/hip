{
    "id": "85a3604c-8696-4bfb-9299-b97a0b33c534",
    "created_at": "2023-01-12T15:09:26.046691Z",
    "updated_at": "2025-03-27T02:05:38.915827Z",
    "deleted_at": null,
    "sha1_hash": "c599e65c6630bd1bb5a6fa63e99b49144eefb447",
    "title": "2017-02-22 - New crypto‑ransomware hits macOS",
    "authors": "",
    "file_creation_date": "2022-05-28T16:10:34Z",
    "file_modification_date": "2022-05-28T16:10:34Z",
    "file_size": 460667,
    "plain_text": "# New crypto‑ransomware hits macOS\n\n**welivesecurity.com/2017/02/22/new-crypto-ransomware-hits-macos/**\n\nFebruary 22, 2017\n\nThis last month we have seen a new ransomware for Mac. Written in Swift, it is distributed on BitTorrent distribution site\nas “Patcher” for pirating popular software.\n\n[Marc-Etienne M.Léveillé](https://www.welivesecurity.com/author/marc-etienne/)\n22 Feb 2017 - 02:00PM\n\nThis last month we have seen a new ransomware for Mac. Written in Swift, it is distributed on BitTorrent distribution site\nas “Patcher” for pirating popular software.\n\nCrypto-ransomware has been very popular lately amongst cybercriminals. While most of it targets the Windows desktop,\nwe’ve also seen machines running Linux or macOS being compromised by ransomware in 2016 with, for example,\n[KillDisk affecting Linux and KeRanger attacking OS X.](http://www.welivesecurity.com/2017/01/05/killdisk-now-targeting-linux-demands-250k-ransom-cant-decrypt/)\n\n[Early last week, we have seen a new ransomware campaign for Mac. This new ransomware, written in Swift, is](https://developer.apple.com/swift/)\ndistributed via BitTorrent distribution sites and calls itself “Patcher”, ostensibly an application for pirating popular\nsoftware.\n\n## Distribution\n\n\n-----\n\nBitTorrent site distributing Torrent files containing OSX/Filecoder.E\n\n\nFigure 1 – BitTorrent site distributing Torrent files containing OSX/Filecoder.E\n\nThe Torrent contains a single ZIP file – an application bundle. We saw two different fake application “Patchers”: one for\nAdobe Premiere Pro and one for Microsoft Office for Mac. Mind you, our search was not exhaustive; there might be\nmore out there.\n\n\n-----\n\nFigure 2 - Icons of the Patchers as seen in Finder\n\n\nFigure 2 – Icons of the “Patchers” as seen in Finder\n\nThe application is generally poorly coded. The window has a transparent background, which can be quite distracting or\nconfusing (see Figure3), and it’s impossible to reopen the window if it is closed.\n\nThe application has the bundle identifier NULL.prova and is signed with a key that has not been signed by Apple.\n\n\n-----\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n\n$ codesign -dv \"Office 2016 Patcher.app\"\n\nExecutable=Office 2016 Patcher.app/Contents/MacOS/Office 2016 Patcher\n\nIdentifier=NULL.prova\n\nFormat=app bundle with Mach-O thin (x86_64)\n\nCodeDirectory v=20100 size=507 flags=0x2(adhoc) hashes=11+3 location=embedded\n\nSignature=adhoc\n\nInfo.plist entries=22\n\nTeamIdentifier=not set\n\nSealed Resources version=2 rules=12 files=14\n\nInternal requirements count=0 size=12\n\n\nFigure 3 - The main window of the ransomware\n\n\nFigure 3 – The main window of the ransomware\n\n## File encryption process\n\n\n-----\n\nClicking the start button shown in Figure 3 launches the encryption process. It copies a file called README!.txt all\naround the user’s directories such as “Documents” and “Photos”. Its content is shown later in the article.\n\nThen the ransomware generates a random 25-character string to use as the key to encrypt the files. The same key is\nused for all the files, which are enumerated with the find command line tool; the zip tool is then used to store the file in\nan encrypted archive.\n\nFinally, the original file is deleted with rm and the encrypted file’s modified time is set to midnight, February 13 2010th\nwith the touch command. The reason for changing the file’s modified time is unclear. After the /Users directory is taken\ncare of, it does the same thing to all mounted external and network storage found under /Volumes.\n\nOnce all the files are encrypted there is code to try to null all free space on the root partition with diskutil, but the path to\nthe tool in the malware is wrong. It tries to execute /usr/bin/diskutil, however the path to diskutil in macOS is\n/usr/sbin/diskutil.\n\n\nFigure 4 - Encrypted document and README!.txt as they appear in Finder\n\n\n-----\n\nFigure 4 Encrypted document and README!.txt as they appear in Finder\n\nThe instructions left for the victims in the README!.txt files are hardcoded inside the Filecoder, which means that the\nBitcoin address and email address are always the same for every victim running the same sample. The message and\ncontact details were the same in both samples we analyzed.\n\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n13\n\n14\n\n15\n\n16\n\n17\n\n\nNOT YOUR LANGUAGE? USE https://translate.google.com\n\nWhat happened to your files ?\n\nAll of your files were protected by a strong encryption method.\n\nWhat do I do ?\n\nSo, there are two ways you can choose: wait for a miracle or start obtaining BITCOIN NOW!, and restore YOUR\nDATA the easy way\n\nIf You have really valuable DATA, you better NOT WASTE YOUR TIME, because there is NO other way to get\nyour files, except make a PAYMENT\n\nFOLLOW THESE STEPS:\n\n1) learn how to buy bitcoin https://en.bitcoin.it/wiki/Buying_Bitcoins_(the_newbie_version)\n\n2)send 0.25 BTC to 1EZrvz1kL7SqfemkH3P1VMtomYZbfhznkb\n\n3)send your btc address and your ip (you can get your ip here https://www.whatismyip.com) via mail to\nrihofoj@mailinator.com\n\n4)leave your computer on and connected to the internet for the next 24 hours after payment, your files will be\nunlocked. (If you can not wait 24 hours make a payment of 0.45 BTC your files will be unlocked in max 10\nminutes)\n\nKEEP IN MIND THAT YOUR DECRYPTION KEY WILL NOT BE STORED ON MY SERVER FOR MORE THAN\n1 WEEK SINCE YOUR FILE GET CRYPTED,THEN THERE WON'T BE ANY METHOD TO RECOVER YOUR\nFILES, DON'T WASTE YOUR TIME!\n\n\n[So far, there is no transaction related to the Bitcoin wallet. Which mean the authors have not made a dime from this](https://blockchain.info/address/1EZrvz1kL7SqfemkH3P1VMtomYZbfhznkb)\nransomware. Hopefully this post will raise awareness and keep the wallet’s balance at zero.\n\n## No decryption possible, even from the author\n\nThere is one big problem with this ransomware: it doesn’t have any code to communicate with any C&C server. This\nmeans that there is no way the key that was used to encrypt the files can be sent to the malware operators.\n\nThis also means that there is no way for them to provide a way to decrypt a victim’s files. Paying the ransom in this case\nwill not bring you back your files. That’s one of the reasons we advise that victims never pay the ransom when hit by\nransomware.\n\nAlas, the random ZIP password is generated with arc4random_uniform which is considered a secure random number\ngenerator. The key is also too long to brute force in a reasonable amount of time.\n\n## Public inbox\n\n\n-----\n\nInterestingly, the email address is an address provided by Mailinator. Mailinator provides a free inbox to anyone without\n[requiring them to register or authenticate. This means it is possible to see the inbox used to communicate with the](https://www.mailinator.com/inbox2.jsp?public_to=rihofoj)\nmalware author. We’ve been monitoring this inbox for the last week and didn’t see any messages. However, it’s possible\nthe messages get deleted really fast and we simply missed them.\n\n## Conclusion\n\nThis new crypto-ransomware, designed specifically for macOS, is surely not a masterpiece. Unfortunately, it’s still\neffective enough to prevent the victims accessing their own files and could cause serious damage.\n\nThere is an increased risk when downloading pirated software that someone is using a dubious channel for acquiring\nsoftware in order to make you execute malware. ESET recommends that you have a security product installed but the\nmost important precaution in case you encounter crypto-ransomware is to have a current, offline, backup of all your\nimportant data.\n\nESET products detect this threat as OSX/Filecoder.E.\n\n## Samples\n\n\n**SHA-1** **Filename** **Type**\n\n1b7380d283ceebcabb683464ba0bb6dd73d6e886 Office 2016 Patcher.zip ZIP of App\nbundle\n\n\na91a529f89b1ab8792c345f823e101b55d656a08 Adobe Premiere Pro CC 2017\nPatcher.zip\n\n\nZIP of App\nbundle\n\n\n**ESET detection**\n**name**\n\nOSX/Filecoder.E\n\nOSX/Filecoder.E\n\n\ne55fe159e6e3a8459e9363401fcc864335fee321 Office 2016 Patcher Mach-O OSX/Filecoder.E\n\n\n3820b23c1057f8c3522c47737f25183a3c15e4db Adobe Premiere Pro CC 2017\nPatcher\n\n22 Feb 2017 - 02:00PM\n\n\nMach-O OSX/Filecoder.E\n\n\n### Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n Newsletter\n\n Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-02-22 - New crypto‑ransomware hits macOS.pdf"
    ],
    "report_names": [
        "2017-02-22 - New crypto‑ransomware hits macOS.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536166,
    "ts_updated_at": 1743041138,
    "ts_creation_date": 1653754234,
    "ts_modification_date": 1653754234,
    "files": {
        "pdf": "https://archive.orkl.eu/c599e65c6630bd1bb5a6fa63e99b49144eefb447.pdf",
        "text": "https://archive.orkl.eu/c599e65c6630bd1bb5a6fa63e99b49144eefb447.txt",
        "img": "https://archive.orkl.eu/c599e65c6630bd1bb5a6fa63e99b49144eefb447.jpg"
    }
}