{
    "id": "78545b9c-adf4-4297-8f4a-4a9ded0d060d",
    "created_at": "2022-10-25T16:48:11.843662Z",
    "updated_at": "2025-03-27T02:16:01.986425Z",
    "deleted_at": null,
    "sha1_hash": "6fa5641b366ea3cb82097902227cd9a6c2682607",
    "title": "",
    "authors": "",
    "file_creation_date": "2021-07-29T07:05:46Z",
    "file_modification_date": "2021-07-29T07:05:46Z",
    "file_size": 2417607,
    "plain_text": "# I Knew You Were Trouble: TA456 Targets Defense Contractor with Alluring Social Media Persona\n\n**[proofpoint.com/us/blog/threat-insight/i-knew-you-were-trouble-ta456-targets-defense-contractor-alluring-social-media](https://www.proofpoint.com/us/blog/threat-insight/i-knew-you-were-trouble-ta456-targets-defense-contractor-alluring-social-media)**\n\nJuly 23, 2021\n\n[Blog](https://www.proofpoint.com/us/blog)\n[Threat Insight](https://www.proofpoint.com/us/blog/threat-insight)\nI Knew You Were Trouble: TA456 Targets Defense Contractor with Alluring Social Media Persona\n\nJuly 28, 2021\nJOSHUA MILLER, MICHAEL RAGGI, & CRISTA GIERING\n\n## Key Takeaways\n\nTA456, an Iranian-state aligned actor, spent years masquerading as the persona “Marcella Flores” in an attempt to infect the\nmachine of an employee of an aerospace defense contractor with malware.\nThe malware, dubbed by Proofpoint as LEMPO, was designed to establish persistence, perform reconnaissance, and exfiltrate\nsensitive information.\nTA456 actively targets smaller subsidiaries and contractors in support of efforts to compromise larger defense contractors using a\nsupply chain compromise.\nWhile targeting defense contractors is not new for TA456, this campaign uniquely establishes the group as one of the\nmost determined Iranian-aligned threat actors tracked by Proofpoint because of its significant use of social engineering, cross\nplatform communication, and general persistence.\n\n## Overview\n\nProofpoint researchers have identified a years-long social engineering and targeted malware campaign by the Iranian-state aligned\nthreat actor TA456. Using the social media persona “Marcella Flores,” TA456 built a relationship across corporate and personal\ncommunication platforms with an employee of a small subsidiary of an aerospace defense contractor. In early June 2021, the threat\nactor attempted to capitalize on this relationship by sending the target malware via an ongoing email communication chain. Designed to\n\n\n-----\n\nconduct reconnaissance on the target’s machine, the macro-laden document contained personalized content and demonstrated the\n[importance TA456 placed on the target. Once the malware, which is an updated version of Liderc that Proofpoint has dubbed](https://blog.talosintelligence.com/2019/09/tortoiseshell-fake-veterans.html)\nLEMPO, establishes persistence, it can perform reconnaissance on the infected machine, save the reconnaissance details to the\nhost, exfiltrate sensitive information to an actor-controlled email account via SMTPS, and then cover its tracks by deleting that\nday’s host artifacts.\n\nThis campaign exemplifies the persistent nature of certain state aligned threats and the human engagement they are willing to conduct\nin support of espionage operations. In mid-July, Facebook disrupted a network of similar personas they attributed to\nTortoiseshell. LEMPO, the malware, whose delivery Proofpoint disrupted, along with the network of personas, are attributed to TA456.\nThis actor is believed to be loosely aligned with the Islamic Revolutionary Guard Corps (IRGC) via association with the Iranian\ncompany Mahak Rayan Afraz (MRA), according to Facebook’s analysis.\n\n## Campaign Breakdown\n\nProofpoint data shows that over at least eight months, “Marcella (Marcy) Flores” sent TA456’s target benign email messages,\nphotographs, and a video to establish her veracity and build rapport with the intended victim. At one time, TA456 attempted to send a\nbenign, but flirtatious video via a OneDrive URL. In early June, a TA456 actor self-identified as “Marcy” sent another OneDrive link, this\ntime masquerading as a diet survey (Figure 1).\n\n\n-----\n\n_Figure 1. The diet survey email sent to the target._\n\n\n-----\n\nThe OneDrive URL delivered a .rar file (dfddbd09ccea598c4841f1abbc927f1c661d85d4bd9bcb081f7c811212d8a64a) containing a\n.xlsm (Figure 2) (612bdfb4f6eaf920a7a41fa06de8d99f6ecf6ad147374efa6eb1d5aff91df558). Using previous conversation topics with the\ntarget, the .xlsm purported to be pandemic diet assistance and requested that the user enable content to access the privacy protected\nportions of the file. If the content is enabled, the macro will create and hide the directory \\Appdata\\Perflog and then write LEMPO, a\nvery simple but ingenious plaintext stealer comprised of Visual Basic Script (VBS), to that directory (Schedule.vbs\n1534f95f49ddf2ada38561705f901e5938470c1678d6a81f0f4177ba7412ef5b). After authoring the VBS, the Excel macro will add a registry\nkey (HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run /v Schedule /t REG_SZ /d C:\\Users\\\n\n[redacted_username]\\AppData\\Perflog\\Schedule.vbs /f) to ensure LEMPO is run upon user login.\n\n\n-----\n\n_Figure 2. The diet survey .xlsm file._\n\n\n-----\n\nThe macro in the Excel document also contains code to connect via HTTP POST to showip[.]net. The response, along with the results of\n\"net use\" and \"netstat -nao\" are stored in a hidden sheet within the .xlsm, reminiscent of the technique described in Facebook's July 15th\nannouncement. Proofpoint analysts assess this may indicate code partially remaining from an earlier iteration of the tool that came\nbefore LEMPO or a desire for redundancy in TA456's reconnaissance tooling.\n\n## LEMPO\n\nThe LEMPO reconnaissance tool is a Visual Basic Script dropped by an Excel macro. Leveraging built-in Windows\ncommands it enumerates the host in a variety of ways, records the collected data and then exfiltrates the intelligence to an actorcontrolled email account using Microsoft’s Collaboration Data Objects (CDO). CDO, previously known as OLE Messaging or Active\nMessaging, is an application programming interface included with Microsoft Windows and Microsoft Exchange Server\nproducts. While most of this analysis is based off the sample blocked by Proofpoint\n(1534f95f49ddf2ada38561705f901e5938470c1678d6a81f0f4177ba7412ef5b) in June 2021, we also identified a similar sample\n(da65aa439e90d21b2cf53afef6491e7dcdca19dd1bbec50329d53f3d977ee089) uploaded to a public malware repository with an upload\ndate of June 2020.\n\n## Reconnaissance\n\nLEMPO collects the following information and records it to %temp%\\Logs.txt\n\nDate and time\nComputer and usernames\nSystem information via WMIC os, sysaccount, environment, and computer system commands\nAntivirus products located in the “SecurityCenter2” path\nDrives\nTasklist\nSoftware and version\nNet users and user details\n\nFollowing the connectivity check, detailed in the following section, LEMPO writes the following to %temp%\\Logs.txt\n\n\n-----\n\nFirewall rules\nList of running processes via Powershell Get-Process\nIP config\nDomain hosts, users, computers, and local groups\nTrusted domains\nNetwork shares\nArp cache\nTracert\nExternal IP (via showip.net)\nConnections (netstat -nao)\n\n## Connectivity\n\nPrior to the network focused reconnaissance, LEMPO checks connectivity by reaching out to Yandex, Google, Yahoo, Github, Mailchimp,\nMega, Arxiv (an online academic repository specializing in electrical engineering and scientific research), and Twitter using ping and\ncurl (Figure 3). The June 2020 version of LEMPO includes only a connectivity check to ford[.]com.\n\n\n-----\n\n-----\n\n_Figure 3._\n\nAfter finishing that additional recon, LEMPO moves Logs.txt from %temp% to \\Perflog. LEMPO then checks to ensure the Registry Key\npreviously mentioned has been added and then uses the findstr command to identify files containing “user,” “pass,” and\n“vpn.” The findstr command returns any matching lines which could collect usernames and passwords from the computer. Logs.txt is\nthen compressed into Logs.zip\n\n## Exfiltration\n\nLEMPO uses hardcoded credentials with Microsoft’s CDO to exfiltrate the information over SMTPS on port 465. In the June 2021\nversion of LEMPO, TA456 uses the same Yahoo email address to send and receive the exfiltrated information. In the 2020 version of\nLEMPO, TA456 sent from a Yandex account to a Tutanota email account. Notably, the Yandex email within the 2020 version of\nthe LEMPO implant masqueraded as large technology company focused on supporting the energy industry. After exfiltrating the\ninformation, LEMPO sleeps for 30 seconds and then deletes both Logs.txt and Logs.zip.\n\n## There’s Something About Marcy\n\n“Marcella (Marcy) Flores” was conversing with the targeted aerospace employee since at least November 2020 and was friends with\nthem on social media since at least 2019. Besides the Gmail account used for attempted malware delivery, Marcella maintained a now\n[suspended Facebook profile.](https://web.archive.org/web/*/https:/www.facebook.com/marcella.flores.14019)\n\n\n-----\n\n-----\n\n_Figure 4._\n\nOpen-source research indicates “Marcella” interacted with TA456’s target on social media starting in late 2019. The earliest publicly\navailable Facebook profile photo of “Marcella” was uploaded on May 30, 2018. Proofpoint’s analysis indicates the profile bears strong\nsimilarities to fictitious profiles previously used by Iranian APTs to socially engineer targets of intelligence value. The “Marcella” profile\nappeared to be friends with multiple individuals who publicly identify as defense contractor employees and who are geographically\n[dispersed from “Marcella’s” alleged location in Liverpool, UK. On July 15, 2021, Facebook announced they had disrupted a network of](https://about.fb.com/news/2021/07/taking-action-against-hackers-in-iran/)\nFacebook and Instagram personas, including “Marcella’s,” they attributed to the Iranian-aligned actor.\n\n## Targets\n\nTA456 routinely conducts reconnaissance campaigns disguised as news related spam that target individuals employed\nby aerospace defense contractors. The targeting of U.S. defense contractors, particularly those supporting contracts in the\nMiddle East, is consistent with historical Iranian cyber activity. Additionally, Proofpoint has\nobserved TA456 targeting individuals employed at multiple subcontractors and subsidiaries of larger defense companies. This is\npossibly an effort to target the primary contractor via less secure downstream component suppliers that share a network\nenvironment. Open-source research indicated the individual targeted by “Marcella” in this campaign works as a supply chain manager.\nThis is consistent with TA456’s TTP of targeting business and information technology-related individuals within their\ntarget organization.\n\n\n-----\n\n## Attribution\n\nProofpoint attributes this campaign to TA456, an Iranian-aligned adversary focused on espionage efforts against defense industrial base\nemployees and contractors, particularly those supporting efforts in the Middle East. TA456 overlaps with activity tracked as\n[Tortoiseshell, and Imperial Kitten. On July 15, 2021, Facebook attributed a portion of Tortoiseshell’s activity](https://about.fb.com/news/2021/07/taking-action-against-hackers-in-iran/)\nto Mahak Rayan Afraz (MRA), an Iranian IT company with ties to the IRGC. Based on previous malware analysis and historical opensource research, Proofpoint concurs with this attribution.\n\n[Additionally, LEMPO shares multiple similarities with Tortoiseshell’s Liderc, including extensive machine reconnaissance, exfiltration](https://blog.talosintelligence.com/2019/09/tortoiseshell-fake-veterans.html)\nvia email, hardcoded email addresses with similar formatting, and overall pattern of targeting companies and individuals aligned with\nthe American defense industrial base.\n\n## Outlook\n\nTA456 demonstrated a significant operational investment by cultivating a relationship with a target’s employee over years in order\nto deploy LEMPO to conduct reconnaissance into a highly secured target environment within the defense industrial\nbase. Facebook’s announcement demonstrated TA456 had established an extensive network of these personas dedicated to enabling\ncyberespionage operations. While Proofpoint did not observe the delivery of any remote access trojans or command and\n[control channels like TA456’s Syskit, the information potentially gathered by LEMPO could be operationalized in a variety of](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/tortoiseshell-apt-supply-chain)\nways. These include the utilization of stolen VPN credentials, exploitation of vulnerabilities in the identified software, or the\ncustomization of more advanced malware delivered from “Marcella.”\n\nTA456’s dedication to significant social engineering engagement, benign reconnaissance of targets prior to deploying malware, and their\ncross platform kill chain establish TA456 to be one of the most resourceful Iranian-aligned threats tracked by Proofpoint. The “Marcella\nFlores” persona is likely not the only one in use by TA456, making it important for those working within or tangentially to the defense\nindustrial base to be vigilant when engaging with unknown individuals regardless of whether it is via work or personal accounts.\n\nSubscribe to the Proofpoint Blog\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2021/2021.07.28.TA456/I%20Knew%20You%20Were%20Trouble_%20TA456%20Targets%20Defense%20Contractor%20with%20Alluring%20Social%20Media%20Persona%20_%20Proofpoint%20US.pdf"
    ],
    "report_names": [
        "I Knew You Were Trouble_ TA456 Targets Defense Contractor with Alluring Social Media Persona _ Proofpoint US"
    ],
    "threat_actors": [
        {
            "id": "84a3dd71-1d65-4997-80fc-7fbe55b267f2",
            "created_at": "2023-04-26T02:03:02.969306Z",
            "updated_at": "2025-03-27T02:00:55.450032Z",
            "deleted_at": null,
            "main_name": "CURIUM",
            "aliases": [
                "CURIUM",
                "Crimson Sandstorm",
                "TA456",
                "Tortoise Shell",
                "Yellow Liderc"
            ],
            "source_name": "MITRE:CURIUM",
            "tools": [
                "IMAPLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3ce91297-e4c0-4957-8dd7-9047a3e23dc7",
            "created_at": "2023-01-06T13:46:39.054248Z",
            "updated_at": "2025-03-27T02:00:02.985963Z",
            "deleted_at": null,
            "main_name": "Tortoiseshell",
            "aliases": [
                "IMPERIAL KITTEN",
                "Yellow Liderc",
                "Imperial Kitten",
                "TA456",
                "DUSTYCAVE",
                "Crimson Sandstorm"
            ],
            "source_name": "MISPGALAXY:Tortoiseshell",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "583cdac5-eb9d-46e9-a0f9-7594c4b18281",
            "created_at": "2024-05-01T02:03:08.017491Z",
            "updated_at": "2025-03-27T02:05:17.30797Z",
            "deleted_at": null,
            "main_name": "COBALT FIRESIDE",
            "aliases": [
                "CURIUM ",
                "DEV-0228 ",
                "HIVE0095 ",
                "Imperial Kitten ",
                "TA456 ",
                "Tortoiseshell ",
                "UNC3890 ",
                "Yellow Liderc ",
                "Crimson Sandstorm "
            ],
            "source_name": "Secureworks:COBALT FIRESIDE",
            "tools": [
                " LEMPO",
                " LiderBird",
                "FireBAK"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b5b24083-7ba6-44cc-9d11-a6274e2eee00",
            "created_at": "2022-10-25T16:07:24.337332Z",
            "updated_at": "2025-03-27T02:02:10.177597Z",
            "deleted_at": null,
            "main_name": "Tortoiseshell",
            "aliases": [
                "Crimson Sandstorm",
                "Curium",
                "Houseblend",
                "Imperial Kitten",
                "Marcella Flores",
                "Operation Fata Morgana",
                "TA456",
                "Yellow Liderc"
            ],
            "source_name": "ETDA:Tortoiseshell",
            "tools": [
                "IMAPLoader",
                "Infostealer",
                "IvizTech",
                "LEMPO",
                "MANGOPUNCH",
                "SysKit",
                "get-logon-history.ps1",
                "liderc",
                "stereoversioncontrol"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716491,
    "ts_updated_at": 1743041761,
    "ts_creation_date": 1627542346,
    "ts_modification_date": 1627542346,
    "files": {
        "pdf": "https://archive.orkl.eu/6fa5641b366ea3cb82097902227cd9a6c2682607.pdf",
        "text": "https://archive.orkl.eu/6fa5641b366ea3cb82097902227cd9a6c2682607.txt",
        "img": "https://archive.orkl.eu/6fa5641b366ea3cb82097902227cd9a6c2682607.jpg"
    }
}