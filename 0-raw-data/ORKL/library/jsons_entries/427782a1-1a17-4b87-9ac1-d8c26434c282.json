{
    "id": "427782a1-1a17-4b87-9ac1-d8c26434c282",
    "created_at": "2022-10-25T16:48:16.713408Z",
    "updated_at": "2025-03-27T02:15:37.895565Z",
    "deleted_at": null,
    "sha1_hash": "3836ed16ed8e861c19344558cb4bd40b6d3b6415",
    "title": "",
    "authors": "",
    "file_creation_date": "2020-02-11T08:46:17Z",
    "file_modification_date": "2020-02-11T08:46:17Z",
    "file_size": 1033629,
    "plain_text": "# TA-505 Cybercrime on System Integrator Companies\n\n**[marcoramilli.com/2019/11/12/ta-505-cybercrime-on-system-integrator-companies](https://marcoramilli.com/2019/11/12/ta-505-cybercrime-on-system-integrator-companies/)**\n\nView all posts by marcoramilli November 12, 2019\n\n## Introduction\n\nDuring a normal monitoring activity, one of the detection tools hits a suspicious email coming from\nthe `validtree.com domain. The domain was protected by a Panama company to hide its real`\nregistrant and this condition rang a warning bell on the suspected email so that it required a\nmanual analysis in order to investigate its attachment.\nDigging into this malicious artifact opened up to a possible raising interest of the infamous TA505\nin System Integrator Companies (companies in which have been found that threat).\n\n## Technical Analysis\n\nDuring the past few weeks suspicious emails coming from the `validtree.com domain was`\ndetected: they were addressing System Integration Companies. The domain validtree.com is\nregistered through namecheap.com on 2017-12-07T15:55:27Z but recently renewed on 2019-1016T05:35:18Z. The registrant is protected by a Panama company named WhoisGuard which\nhides the original registrant name. Currently the domain points to 95.211.151.230 which is an IP\naddress assigned to LeaseWeb a VPS hosting provider located in Netherland, Europe. Attached\nto the email a suspicious word document was waiting to be opened from the victim.\n\n### Hash 7ebd1d6‐ fa8c21b0d0c015475ab8c7225f949c13a33d0a39b8c069072a4281392\n\n Threat Macro Dropper\n\n\n### Brief Description\n\n\n### Document Dropper\n\n\n### Ssdeep 384:nFZ5ZtDGGkLmTUrioRPATRn633Dmej0SnJzbmiVywP0jKk:n1o‐ qwT2J633DVgiVy25\n\nBy opening the word document the victim displays the following text (Image1). The document\ntempts the victim in enabling the macro functionality in order to re-encode the document with\nreadable charsets by translating the current encoding charset to the local readable one.\n\n\n-----\n\nImage1: Word Document Content\n\nA transparent Microsoft-word-shape placed on top of the encoded text avoids the victim to\ninteract with the unreadable text. That document holds two VBA-Macro functions which were\nidentified as a romantic `AutoOpen and an additional one named` `HeadrFooterProperty .`\nInteresting to note that the document had no evidences on VT (during the analysis time), so it\ncould be a revamped threat or a totally new one! The two Macros decoded a Javascript payload\nacting as a drop and execute by using a well-known strategy as described in: “Frequent VBA\nMacros used in Office Malware”. The following image shows the decoding process. A first round\nof obfuscation technique was adopted by the attacker in order to make harder the analyst’s\ndecoding process. That stage implements an obfuscated Javascript embedded code which\ndecodes, by using a `XOR with` `key=11, a third Javascript stage acting as drop and execute on`\n```\n66.133.129.5 resource. That IP is assigned to Frontier Communications Solutions: a NY\n\n```\nbased company.\n\nImage2: Deobfuscation Steps from obfuscated VBA to Clear “evaled” javascript\n\nIt was nice to read the obfuscated code since the variable names where actually thematically\nchosen per function. For example the theseus function is obfuscated with “divine terms”, one of\nmy favorite was actually the following conditional branch: If `pastorale` `/ quetzalcoatl <`\n\n\n-----\n\n```\n57 Then ..., which actually was always true ! ( quetzalcoatl is “feathered serpent” a\naztech god, while pastorale is an evocative composition often used for cite or pray to gods).\n\n```\nAnother fun fact was in the variable name the attacker attributed to the string “JavaScript”:\n_emotionless. In particular the attacker refers to JavaScript through the object_\n“ emotionless.Language ”. Funny isn’t it ?\nThe final javascript downloader aims to drop a file from\n```\nhttp://66[.133[.129[.5/~chuckgilbert/09u8h76f/65fg67n placing it into the system\n\n```\ntemporary directory and naming it `nanagrams.exe . Finally it runs that windows PE file on the`\nvictim machine.\nDuring the analysis-time the dropping URL was not working, indeed the dropping URL contains a\n```\nsurprise.php . Actually, a misconfiguration of the dropping website allowed us to visualize its\n\n```\nsource code. As shown in the following image (Image3) the page tracks the visitors through an\niframe pointing to: `http[://tehnofaq[.work and through a random loop redirects the`\ndownloader script to a different dropping URL.\n\nImage3: Redirecting script\n\nBuilding a re-directors or proxy chains is quite useful for attackers in order to evade Intrusion\nPrevention Systems and/or protections infrastructures based upon IPs or DNS blocks. In such a\ncase the redirection script pushes to one of the following domains by introducing the HTML meta\n“refresh” tag, pointing the browser URL to a random choice between 4 different entries belonging\nto the following two domains:\n```\n   http[://com-kl96.net\n   http[://com-mk84.net\n\n## Possible Link with TA-505\n\n```\nThe used infrastructure, by analyzing the dropping urls, looks like an old infrastructure used for\npropagating Ransomware. Indeed it’s possible to observe many analogies with the following\ndropping urls belonging to a previously utilized Ransomware threat:\n```\n   http[://66.133.129.5/~kvas/\n   http[://66.133.129.5/~nsmarc1166/\n   http[://frontiernet.net/~jherbaugh/\n\n```\nThe infrastructure used in the attacks suggests the involvement of the cybercrime group TA505.\n[The TA505 group, that is known to have operated both theDridex and Lockymalware families,](https://securityaffairs.co/wordpress/86274/cyber-crime/ta505-expands-operations.html)\ncontinues to make small changes to its operations. TA505 hacking group has been active since\n2014 focusing on Retail and banking sectors.\n[Recently security experts at Proofpoint observed the notorious TA505 cybercrime group that has](https://www.proofpoint.com/us/threat-insight/post/ta505-distributes-new-sdbbot-remote-access-trojan-get2-downloader)\n[been using a new RAT dubbed SDBbot, it is a backdoor that is delivered via a new downloader](https://www.proofpoint.com/us/threat-insight/post/ta505-distributes-new-sdbbot-remote-access-trojan-get2-downloader)\n\n\n-----\n\ndubbed Get2 that was written in C++. The dropper was also used to distribute other payloads,\nincluding FlawedGrace, FlawedAmmyy, and Snatch. The used URLs in the attack have the same\npattern associated with the notorious crime gang, the researchers also pointed out that the IP\n[addresses (i.e. 66.133.129.5) observed in the attacks were involved in previous campaigns](https://unit42.paloaltonetworks.com/locky-new-ransomware-mimics-dridex-style-distribution/)\ndelivering Locky and Dridex malware.\n\nUnfortunately, I was not able to analyse the final payload of the attack chain that was still not\navailable at the time of the analysis. The final stage malware analysis is essential to attempt\n**to attribute the attack to a specific threat actor. The evidence and artifacts collected in this**\nanalysis suggest two possible scenarios:\n\nTA505 group is expanding his operations, but it still controlling an infrastructure involved in\nprevious attacks across the years. The threat actors still leverage this infrastructure for “hit\nand run” operations or to test new attacks technique and tools avoiding to expose their\nactual infrastructure. Both options are interesting, but only the knowledge of the final\n**stage malware could give us a wider view on the current operations of the group.**\nAnother threat actor, likely financially motivated, is leveraging the same infrastructure used\nby TA505 and used it to make it harder the analysis and the attribution of the attacks.\n\n## Conclusion\n\nAn interesting Maldoc acting as drop-and-execute was identified and spotted in the wild targeting\nSystem Integrator based in Europe . From the described analysis we attempted to identify the\nattacker by observing he was exploiting an old infrastructure behind `66.133.129.5 as a`\ndropping websites.\nDuring the analysis time the attack-path was still incomplete and the attacker didn’t weaponize\nthe dropping websites yet, but the spread document is able to grab content from specific URLs\nand to run directly on the victim machine.\nThe used strings for obfuscating the dropper were actually fun and “thematic”. For example\nstrings like “madrillus”, “vulcano”, “pastorale”, “quetzalcoatl” remind an ancient culture (mandrillus,\nvulcano and quetzalcoatl) while objects like “emotionless” assigned to a specific programming\nlanguage reminds a witty attacker.\n\nSince no final stage was obtained so far, attribution is quite hard, but TTPs suggest a TA-505\nattacker, due to the collected artifacts and to the analyzed URLs.\n\n## Indicator of Compromise (IoC)\n\n**Hash: 7ebd1d6fa8c21b0d0c015475ab8c7225f949c13a33d0a39b8c069072a4281392**\n**URL:**\nhttp://66[.133[.129[.5/~chuckgilbert/09u8h76f/65fg67n\nhttp[://tehnofaq[.work\nhttp[://com-kl96.net/new.php?a=269321&c=wl_con&s=702w’\nhttp[://com-mk84.net/new.php?a=269321&c=wl_con&s=702w’\nhttp[://com-kl96.net/new.php?a=269321&c=job&s=702j’\nhttp[://com-mk84.net/new.php?a=269321&c=job&s=702j’\n\n\n-----\n\n## Yara Rules\n```\nrule TA505_Target_SystemIntegrators_sample {\n  meta:\n   description = \"TA505 target System Integrators\"\n   date = \"2019-11-11\"\n   hash1 = \"7ebd1d6fa8c21b0d0c015475ab8c7225f949c13a33d0a39b8c069072a4281392\"\n  strings:\n   $x1 = \"*\\\\G{00020430-0000-0000-C000000000000046}#2.0#0#C:\\\\Windows\\\\system32\\\\stdole2.tlb#OLE Automation\" fullword wide\n   $s2 = \"*\\\\G{2DF8D04C-5BFA-101B-BDE5-00AA0044DE52}#2.3#0#C:\\\\Program Files\\\\Common\nFiles\\\\Microsoft Shared\\\\OFFICE11\\\\MSO.DLL#Microsoft \" wide\n   $s3 = \"'%TEMP%\\\\conjunctiva.exe'\" fullword ascii\n   $s4 = \"rams.exe\" fullword ascii\n   $s5 = \"*\\\\G{000204EF-0000-0000-C000000000000046}#4.0#9#C:\\\\PROGRA~1\\\\COMMON~1\\\\MICROS~1\\\\VBA\\\\VBA6\\\\VBE6.DLL#Visual Basic\nFor Applicat\" wide\n   $s6 = \"WScript.Shell\" fullword ascii\n   $s7 = \"\\\\nanagrams.exe\" fullword ascii\n   $s8 = \"*\\\\G{00020905-0000-0000-C000-000000000046}#8.3#0#C:\\\\Program\nFiles\\\\Microsoftvolcano\" fullword wide\n   $s9 = \" Office\\\\OFFICE11\\\\MSWORD.OLB#Microsoft Word 11.0 Object Library\" fullword\nwide\n   $s10 = \"PROJECT.THISDOCUMENT.AUTOOPEN\" fullword wide\n   $s11 =\n\"5\\\\x64\\\\x7b\\\\x6e\\\\x65\\\\x23\\\\x29\\\\x4c\\\\x4e\\\\x5f\\\\x29\\\\x27\\\\x7e\\\\x79\\\\x67\\\\x27\\\\x6d\\\\x6a\\\\x\n fullword ascii\n   $s12 = \"Project.ThisDocument.AutoOpen\" fullword wide\n   $s13 = \"mistyeyed\" fullword ascii\n   $s14 = \"(xor_key ^ plain_str.charCodeAt(i)); return xored_str;}\" fullword ascii\n   $s15 = \"IVa.ExE'); StaRT \" fullword ascii\n   $s16 =\n\"65\\\\x2b\\\\x73\\\\x63\\\\x79\\\\x25\\\\x79\\\\x6e\\\\x78\\\\x7b\\\\x64\\\\x65\\\\x78\\\\x6e\\\\x49\\\\x64\\\\x6f\\\\x72\\\\\n fullword ascii\n   $s17 = \"costaTEMP%instantaneous\" fullword ascii\n   $s18 = \"wdSeekCurrentPageHeader$$0\" fullword ascii\n   $s19 = \"TEMP%in \" fullword ascii\n   $s20 = \"conjecturalitygclamydospore\" fullword ascii\n  condition:\n   uint16(0) == 0xcfd0 and filesize < 100KB and\n   1 of ($x*) and 4 of them\n}\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2019/2019.11.12_TA-505_On_SI/TA-505%20Cybercrime%20on%20System%20Integrator%20Companies.pdf"
    ],
    "report_names": [
        "TA-505 Cybercrime on System Integrator Companies"
    ],
    "threat_actors": [
        {
            "id": "99cb4e5b-8071-4f9e-aa1d-45bfbb6197e3",
            "created_at": "2023-01-06T13:46:38.860754Z",
            "updated_at": "2025-03-27T02:00:02.937438Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "SectorJ04 Group",
                "Dudear",
                "G0092",
                "ATK103",
                "Hive0065",
                "Spandex Tempest",
                "GRACEFUL SPIDER",
                "GOLD TAHOE",
                "CHIMBORAZO",
                "SectorJ04"
            ],
            "source_name": "MISPGALAXY:TA505",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5e6b31a6-80e3-4e7d-8b0a-d94897ce9b59",
            "created_at": "2024-06-19T02:03:08.128175Z",
            "updated_at": "2025-03-27T02:05:17.400394Z",
            "deleted_at": null,
            "main_name": "GOLD TAHOE",
            "aliases": [
                "SectorJ04 ",
                "Spandex Tempest ",
                "TA505 ",
                "FIN11 "
            ],
            "source_name": "Secureworks:GOLD TAHOE",
            "tools": [
                " Cobalt Strike",
                " FlawedAmmy",
                " Get2",
                " GraceWire",
                " Malichus",
                " SDBbot",
                " ServHelper",
                " TrueBot",
                "Clop"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75d4d6a9-b5d1-4087-a7a0-e4a9587c45f4",
            "created_at": "2022-10-25T15:50:23.5188Z",
            "updated_at": "2025-03-27T02:00:55.489882Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "TA505",
                "Hive0065",
                "Spandex Tempest",
                "CHIMBORAZO"
            ],
            "source_name": "MITRE:TA505",
            "tools": [
                "AdFind",
                "Azorult",
                "FlawedAmmyy",
                "Mimikatz",
                "Dridex",
                "TrickBot",
                "Get2",
                "FlawedGrace",
                "Cobalt Strike",
                "ServHelper",
                "Amadey",
                "SDBbot",
                "PowerSploit"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e447d393-c259-46e2-9932-19be2ba67149",
            "created_at": "2022-10-25T16:07:24.28282Z",
            "updated_at": "2025-03-27T02:02:10.159466Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "ATK 103",
                "Chimborazo",
                "Gold Evergreen",
                "Gold Tahoe",
                "Graceful Spider",
                "Hive0065",
                "Operation Tovar",
                "Operation Trident Breach",
                "SectorJ04",
                "Spandex Tempest",
                "TA505",
                "TEMP.Warlock"
            ],
            "source_name": "ETDA:TA505",
            "tools": [
                "Amadey",
                "AmmyyRAT",
                "AndroMut",
                "Azer",
                "Bart",
                "Bugat v5",
                "CryptFile2",
                "CryptoLocker",
                "CryptoMix",
                "CryptoShield",
                "Dridex",
                "Dudear",
                "EmailStealer",
                "FRIENDSPEAK",
                "Fake Globe",
                "Fareit",
                "FlawedAmmyy",
                "FlawedGrace",
                "FlowerPippi",
                "GOZ",
                "GameOver Zeus",
                "GazGolder",
                "Gelup",
                "Get2",
                "GetandGo",
                "GlobeImposter",
                "Gorhax",
                "GraceWire",
                "Gussdoor",
                "Jaff",
                "Kasidet",
                "Kegotip",
                "Kneber",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Locky",
                "MINEBRIDGE",
                "MINEBRIDGE RAT",
                "MirrorBlast",
                "Neutrino Bot",
                "Neutrino Exploit Kit",
                "P2P Zeus",
                "Peer-to-Peer Zeus",
                "Philadelphia",
                "Philadephia Ransom",
                "Pony Loader",
                "Rakhni",
                "ReflectiveGnome",
                "Remote Manipulator System",
                "RockLoader",
                "RuRAT",
                "SDBbot",
                "ServHelper",
                "Shifu",
                "Siplog",
                "TeslaGun",
                "TiniMet",
                "TinyMet",
                "Trojan.Zbot",
                "Wsnpoem",
                "Zbot",
                "Zeta",
                "ZeuS",
                "Zeus"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716496,
    "ts_updated_at": 1743041737,
    "ts_creation_date": 1581410777,
    "ts_modification_date": 1581410777,
    "files": {
        "pdf": "https://archive.orkl.eu/3836ed16ed8e861c19344558cb4bd40b6d3b6415.pdf",
        "text": "https://archive.orkl.eu/3836ed16ed8e861c19344558cb4bd40b6d3b6415.txt",
        "img": "https://archive.orkl.eu/3836ed16ed8e861c19344558cb4bd40b6d3b6415.jpg"
    }
}