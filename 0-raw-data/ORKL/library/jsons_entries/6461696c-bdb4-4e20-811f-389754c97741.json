{
    "id": "6461696c-bdb4-4e20-811f-389754c97741",
    "created_at": "2023-01-12T15:05:34.287483Z",
    "updated_at": "2025-03-27T02:16:26.069701Z",
    "deleted_at": null,
    "sha1_hash": "9dca61ee16721d73633fabccd0ac9880552b3abb",
    "title": "2020-01-06 - First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT Group",
    "authors": "",
    "file_creation_date": "2022-05-29T01:35:30Z",
    "file_modification_date": "2022-05-29T01:35:30Z",
    "file_size": 194189,
    "plain_text": "# First Binder Exploit Linked to SideWinder APT Group\n\n**[blog.trendmicro.com/trendlabs-security-intelligence/first-active-attack-exploiting-cve-2019-2215-found-on-google-play-linked-to-sidewinder-apt-group/](https://blog.trendmicro.com/trendlabs-security-intelligence/first-active-attack-exploiting-cve-2019-2215-found-on-google-play-linked-to-sidewinder-apt-group/)**\n\nMobile\n\n\nJanuary 6, 2020\n\n\nWe found malicious apps that work together to compromise devices and collect user data. One of the apps, called Camero, exploits CVE2019-2215, a flaw that exists in Binder. This is the first instance in the wild that exploits said UAF vulnerability.\n\nBy: Ecular Xu, Joseph C Chen January 06, 2020 Read time: ( words)\n\n_Updated January 8, 2020 5PM EST with a video showing the exploit of CVE-2019-2215._\n\nWe found three malicious apps in the Google Play Store that work together to compromise a victim’s device and collect user information. One\n[of these apps, called Camero, exploits CVE-2019-2215, a vulnerability that exists in Binder (the main Inter-Process Communication system in](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-2215)\n[Android). This is the first known active attack in the wild that uses the use-after-free vulnerability. Interestingly, upon further investigation we](https://googleprojectzero.blogspot.com/2019/11/bad-binder-android-in-wild-exploit.html)\nalso found that the three apps are likely to be part of the SideWinder threat actor group’s arsenal. SideWinder, a group that has been active\n[since 2012, is a known threat and has reportedly targeted military entities’ Windows machines.](https://securelist.com/apt-trends-report-q1-2018/85280/)\n\nThe three malicious apps were disguised as photography and file manager tools. We speculate that these apps have been active since March\n2019 based on the certificate information on one of the apps. The apps have since been removed from Google Play.\n\n[Figure. XX](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2020/01/Fig-1.png)\n\nFigure 1. The three apps related to SideWinder group\n\n[Figure.2](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2020/01/Fig-2.png)\n\nFigure 2. Certificate information of one of the apps\n\n## Installation\n\nSideWinder installs the payload app in two stages. It first downloads a DEX file (an Android file format) from its command and control (C&C)\n[server. We found that the group employs Apps Conversion Tracking to configure the C&C server address. The address was encoded by](https://developers.google.com/app-conversion-tracking)\nBase64 then set to referrer parameter in the URL used in the distribution of the malware.\n\n[Figure.3](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2020/01/Fig-3.png)\n\nFigure 3. Parsed C&C Server address\n\nAfter this step, the downloaded DEX file downloads an APK file and installs it after exploiting the device or employing accessibility. All of this is\ndone without user awareness or intervention. To evade detection, it uses many techniques such as obfuscation, data encryption, and invoking\ndynamic code.\n\nThe apps Camero and FileCrypt Manger act as droppers. After downloading the extra DEX file from the C&C server, the second-layer\ndroppers invoke extra code to download, install, and launch the callCam app on the device.\n\n[Figure.4](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2020/01/Fig-4.png)\n\n\n-----\n\ngu e o stage pay oad dep oy e t\n\n[Figure.5](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2020/01/Fig-5.png)\n\nFigure 5. Code showing how the dropper invokes extra DEX code\n\nTo deploy the payload app callCam on the device without the user’s awareness, SideWinder does the following:\n\n1. Device Rooting\n\nThis approach is done by the dropper app Camero and only works on Google Pixel (Pixel 2, Pixel 2 XL), Nokia 3 (TA-1032), LG V20 (LGH990), Oppo F9 (CPH1881), and Redmi 6A devices. The malware retrieves a specific exploit from the C&C server depending on the DEX\ndownloaded by the dropper.\n\n[Figure.6](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2020/01/Fig-6.png)\n\nFigure 6. Code snippet from Extra DEX downloaded by Camero\n\nWe were able to download five exploits from the C&C server during our investigation. They use the vulnerabilities CVE-2019-2215 and\nMediaTek-SU to get root privilege.\n\n[Figure.7](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2020/01/Fig-7.png)\n\nFigure 7. CVE-2019-2215 exploit\n\n[Figure.8](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2020/01/Fig-8.png)\n\nFigure 8. MediaTek-SU exploit\n\nAfter acquiring root privilege, the malware installs the app callCam, enables its accessibility permission, and then launches it.\n\n[Figure.9](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2020/01/Fig-9.png)\n\nFigure 9. Commands install app, launch app, and enable accessibility\n\n2. Device Rooting\n\nThis approach is used by the dropper app FileCrypt Manager and works on most typical Android phones above Android 1.6. After its launch,\nthe app asks the user to enable accessibility.\n\n[Figure.10](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2020/01/Fig-10.png)\n\nFigure 10. Steps FileCrypt Manager prompts user to do\n\nOnce granted, the app shows a full screen window that says that it requires further setup steps. In reality, that is just an overlay screen that is\n[displayed on top of all activity windows on the device. The overlay window sets its attributions to FLAG_NOT_FOCUSABLE and](https://developer.android.com/reference/android/view/WindowManager.LayoutParams.html#FLAG_NOT_FOCUSABLE)\n[FLAG_NOT_TOUCHABLE, allowing the activity windows to detect and receive the users’ touch events through the overlay screen.](https://developer.android.com/reference/android/view/WindowManager.LayoutParams.html#FLAG_NOT_TOUCHABLE)\n\n[Figure.11](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2020/01/Fig-11.png)\n\nFigure 11. Overlay screen\n\nMeanwhile, the app invokes code from the extra DEX file to enable the installation of unknown apps and the installation of the payload app\ncallCam. It also enables the payload app’s accessibility permission, and then launches the payload app. All of this happens behind the overlay\nscreen, unbeknownst to the user. And, all these steps are performed by employing Accessibility.\n\n[Figure.12](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2020/01/Fig-12.png)\n\nFigure 12. Code enabling install of unknown apps and new APK\n\n[Figure.13](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2020/01/Fig-13.png)\n\nFigure 13. Code enable accessibility permission of the newly installed app\n\nThe video below demonstrates payload deployment via CVE-2019-2215 on Pixel 2:\n\n\n-----\n\n[Watch Video At:](https://youtu.be/zyVgOurr33U) https://youtu.be/zyVgOurr33U\n\n## callCam’s Activities\n\nThe app callCam hides its icon on the device after being launched. It collects the following information and sends it back to the C&C server in\nthe background:\n\nLocation\nBattery status\nFiles on device\nInstalled app list\nDevice information\nSensor information\nCamera information\nScreenshot\nAccount\nWifi information\n\nThe app encrypts all stolen data using RSA and AES encryption algorithms. It uses SHA256 to verify data integrity and customize the\nencoding routine. When encrypting, it creates a block of data we named headData. This block contains the first 9 bytes of origin data, origin\ndata length, random AES IV, the RSA-encrypted AES encrypt key, and the SHA256 value of AES-encrypted origin data. Then the headData is\nencoded through the customized routine. After the encoding, it is stored in the head of the final encrypted file followed by the data of the AESencrypted original data.\n\n[Figure.14](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2020/01/Fig-14.png)\n\nFigure 14. Data encryption process\n\n[Figure.15](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2020/01/Fig-15.png)\n\nFigure 15. Customized encoding routine done\n\n## Relation to SideWinder\n\n[These apps may be attributed to SideWinder as the C&C servers it uses are suspected to be part of SideWinder’s infrastructure. In addition, a](https://twitter.com/RedDrip7/status/1206898954383740929)\nURL linking to one of the apps’ Google Play pages is also found on one of the C&C servers.\n\n[Figure. 16](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2020/01/Fig-16.png)\n\nFigure 16. Google Play URL of FileManager app found in one of the C&C servers.\n\n## Trend Micro Solutions\n\n[Trend Micro solutions such as the Trend Micro™ Mobile Security for Android™ can detect these malicious apps. End users can also benefit](https://www.trendmicro.com/en_us/forHome/products/mobile-security.html)\nfrom its multilayered security capabilities that secure the device owner’s data and privacy and safeguard them from ransomware, fraudulent\nwebsites, and identity theft.\n\n[For organizations, the Trend Micro Mobile Security for Enterprise suite provides device, compliance, and application management, data](https://www.trendmicro.com/en_us/business/products/user-protection/sps.html)\nprotection, and configuration provisioning. It also protects devices from attacks that exploit vulnerabilities, prevents unauthorized access to\n[apps, and detects and blocks malware and fraudulent websites. Trend Micro’s Mobile App Reputation Service (MARS) covers Android and iOS](https://mars.trendmicro.com/)\nthreats using leading sandbox and machine learning technologies to protect users against malware, zero-day and known exploits, privacy\nleaks, and application vulnerabilities.\n\n\n-----\n\n**d cato s o Co** **p o** **se**\n\n**SHA256** **Package Name/File type** **App Name/Detection N**\n\nec4d6bf06dd3f94f4555d75c6daaf540dee15b18d62cc004e774e996c703cb34 DEX AndroidOS_SWinderSpy\n\na60fc4e5328dc75dad238d46a2867ef7207b8c6fb73e8bd001b323b16f02ba00 DEX AndroidOS_SWinderSpy\n\n0daefb3d05e4455b590da122255121079e83d48763509b0688e0079ab5d48886 ELF AndroidOS_MtkSu.A\n\n441d98dff3919ed24af7699be658d06ae8dfd6a12e4129a385754e6218bc24fa ELF AndroidOS_BinderExp.A\n\nac82f7e4831907972465477eebafc5a488c6bb4d460575cd3889226c390ef8d5 ELF AndroidOS_BinderExp.A\n\nee679afb897213a3fd09be43806a7e5263563e86ad255fd500562918205226b8 ELF AndroidOS_BinderExp.A\n\n135cb239966835fefbb346165b140f584848c00c4b6a724ce122de7d999a3251 ELF AndroidOS_MtkSu.A\n\na265c32ed1ad47370d56cbd287066896d6a0c46c80a0d9573d2bb915d198ae42 com.callCam.android.callCam2base callCamm\n\n**Package Name/File type** **App Name/Detection Name**\n\ncom.abdulrauf.filemanager FileCrypt Manager\n\ncom.callCam.android.callCam2base callCamm\n\ncom.camero.android.camera2basic Camero\n\n## C&C Servers\n\nms-ethics.net\ndeb-cn.net\nap1-acl.net m\ns-db.net\naws-check.net\nreawk.net\n\n## MITRE ATT&CK Matrix™\n\n[Figure.17](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2020/01/attack-matrix-scaled.jpg)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-01-06 - First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT Group.pdf"
    ],
    "report_names": [
        "2020-01-06 - First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT Group.pdf"
    ],
    "threat_actors": [
        {
            "id": "6b9fc913-06c6-4432-8c58-86a3ac614564",
            "created_at": "2022-10-25T16:07:24.185236Z",
            "updated_at": "2025-03-27T02:02:10.135195Z",
            "deleted_at": null,
            "main_name": "SideWinder",
            "aliases": [
                "APT-C-17",
                "APT-Q-39",
                "BabyElephant",
                "GroupA21",
                "HN2",
                "Hardcore Nationalist",
                "Rattlesnake",
                "Razor Tiger",
                "SideWinder",
                "T-APT-04"
            ],
            "source_name": "ETDA:SideWinder",
            "tools": [
                "BroStealer",
                "Capriccio RAT",
                "callCam"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "173f1641-36e3-4bce-9834-c5372468b4f7",
            "created_at": "2022-10-25T15:50:23.349637Z",
            "updated_at": "2025-03-27T02:00:55.450857Z",
            "deleted_at": null,
            "main_name": "Sidewinder",
            "aliases": [
                "Sidewinder",
                "T-APT-04"
            ],
            "source_name": "MITRE:Sidewinder",
            "tools": [
                "Koadic"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d0c0a5ea-3066-42a5-846c-b13527f64a3e",
            "created_at": "2023-01-06T13:46:39.080551Z",
            "updated_at": "2025-03-27T02:00:02.992026Z",
            "deleted_at": null,
            "main_name": "RAZOR TIGER",
            "aliases": [
                "SideWinder",
                "APT-C-17",
                "T-APT-04"
            ],
            "source_name": "MISPGALAXY:RAZOR TIGER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535934,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653788130,
    "ts_modification_date": 1653788130,
    "files": {
        "pdf": "https://archive.orkl.eu/9dca61ee16721d73633fabccd0ac9880552b3abb.pdf",
        "text": "https://archive.orkl.eu/9dca61ee16721d73633fabccd0ac9880552b3abb.txt",
        "img": "https://archive.orkl.eu/9dca61ee16721d73633fabccd0ac9880552b3abb.jpg"
    }
}