{
    "id": "ed9368b6-f89b-4955-bbb9-bdf57f085218",
    "created_at": "2023-01-12T15:08:29.236629Z",
    "updated_at": "2025-03-27T02:09:17.824961Z",
    "deleted_at": null,
    "sha1_hash": "e939ca7f276077aa3fc7f96092dd88fff95dfb57",
    "title": "2022-09-23 - FARGO Ransomware (Mallox) Being Distributed to Unsecured MS-SQL Servers",
    "authors": "",
    "file_creation_date": "2022-12-29T00:28:58Z",
    "file_modification_date": "2022-12-29T00:28:58Z",
    "file_size": 1951096,
    "plain_text": "# FARGO Ransomware (Mallox) Being Distributed to Unsecured MS-SQL Servers\n\n**asec.ahnlab.com/en/39152/**\n\nSeptember 23, 2022\n\nThe ASEC analysis team is constantly monitoring malware distributed to unsecured MS-SQL\nservers. The analysis team has recently discovered the distribution of FARGO ransomware\nthat is targeting unsecured MS-SQL servers. Along with GlobeImposter, FARGO is one of\nthe prominent ransomware that targets unsecured MS-SQL servers. In the past, it was also\ncalled the Mallox because it used the file extension .mallox.\n\n**– [ASEC Blog]** **[Cobalt Strike Being Distributed to Unsecured MS-SQL Servers](https://asec.ahnlab.com/en/31811/)**\n\n**– [ASEC Blog]** **[Cobalt Strike Being Distributed to Unsecured MS-SQL Servers (2)](https://asec.ahnlab.com/en/32062/)**\n\n**– [ASEC Blog]** **[Coin Miner Being Distributed to Unsecured MS-SQL Servers](https://asec.ahnlab.com/en/32143/)**\n\n**[– [ASEC Blog] AsyncRAT Malware Being Distributed to Unsecured MS-SQL Servers](https://asec.ahnlab.com/en/36315/)**\n\n\n-----\n\n**Figure 1. Process tree**\nAs shown in the process tree in Figure 1, the file downloaded by the MS-SQL process\nthrough cmd.exe and powershell.exe is a file built on .Net (see Figure 2), downloads and\nloads additional malware from a particular address. The loaded malware generates and\nexecutes a BAT file which shuts down certain processes and services, in the %temp%\ndirectory.\n\n**Figure 2. Download of additional files**\n\n**Figure 3. Creation and execution of BAT file**\n\n**Figure 4. Details of BAT file**\nThe ransomware’s behavior begins by being injected into AppLaunch.exe, a normal\nWindows program. It attempts to delete a registry key on a certain path (see Figure 5), and\nexecutes the recovery deactivation command, and closes certain processes (see Figure 6).\n\n\n-----\n\nAs shown in the figures below, the closed processes are SQL programs.\n\nFigure 5. Registry deletion\n\nFigure 6. Deactivation of recovery and closing of processes\nWhen the ransomware encrypts files, files with file extensions shown in Table 1 are excluded\nfrom infection. The characteristic aspect is that it does not infect files with a file extension\nassociated with Globeimposter and this exclusion list does not only include the same type of\nextensions of .FARGO .FARGO2 and .FARGO3 but also includes .FARGO4, which is\nthought to be a future version of the ransomware.\n\n**Table 1. Extensions excluded from infection**\n\n\n-----\n\n**Table 2. Files excluded from**\n\n**infection**\n\n**Table 3. Paths excluded from infection**\nFigure 7 shows a screen capture of the ransom note and the infected file on the top right in\nthe same screen. As shown in the figure, the encrypted file gets a file name of\nOriginalFileName.FileExtension.Fargo3 and the ransom note is generated with the filename\n‘RECOVERY FILES.txt’.\n\n**Figure 7. Ransom note and infected file**\nTypical attacks that target database servers (MS-SQL, MySQL servers) include brute force\nattacks and dictionary attacks on systems where account credentials are poorly being\nmanaged. And there may be vulnerability attacks on systems that do not have a vulnerability\npatch applied.\n\nAdministrators of MS-SQL servers should use passwords that are difficult to guess for their\naccounts and change them periodically to protect the database server from brute force\nattacks and dictionary attacks, and update to the latest patch to prevent any potential\nvulnerability attacks.\n\nAhnLab’s anti-malware software, V3, detects and blocks the malware using the following\naliases:\n\n**[File Detection]**\n\n– Ransomware/Win.Ransom.C5153317(2022.06.02.01)\n\n– Dropper/Win.DotNet.C5237010(2022.09.14.03)\n\n\n-----\n\n– Downloader/Win.Agent.R519342(2022.09.15.03)\n– Trojan/BAT.Disabler (2022.09.16.00)\n\n**Behavior Detection]**\n\n– Malware/MDP.Download.M1197\n\n**[IOC]**\n\n**MD5**\n\n– b4fde4fb829dd69940a0368f44fca285\n\n– c54daefe372efa4ee4b205502141d360\n\n– 4d54af1bbf7357964db5d5be67523a7c\n\n–41bcad545aaf08d4617c7241fe36267c\n\n**Download**\n\n– hxxp://49.235.255[.]219:8080/Pruloh_Matsifkq.png\n\n**Subscribe to AhnLab’s next-generation threat intelligence platform ‘AhnLab TIP’ to**\n**check related IOC and detailed analysis information.**\n\n[Categories:Malware Information](https://asec.ahnlab.com/en/category/malware-information-en/)\n\n[Tagged as:FARGO,](https://asec.ahnlab.com/tag/fargo/) [Mallox,](https://asec.ahnlab.com/tag/mallox/) [malware,](https://asec.ahnlab.com/en/tag/malware-en/) [MS-SQL,](https://asec.ahnlab.com/tag/ms-sql/) [Ransomware](https://asec.ahnlab.com/en/tag/ransomware-en/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-09-23 - FARGO Ransomware (Mallox) Being Distributed to Unsecured MS-SQL Servers.pdf"
    ],
    "report_names": [
        "2022-09-23 - FARGO Ransomware (Mallox) Being Distributed to Unsecured MS-SQL Servers.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536109,
    "ts_updated_at": 1743041357,
    "ts_creation_date": 1672273738,
    "ts_modification_date": 1672273738,
    "files": {
        "pdf": "https://archive.orkl.eu/e939ca7f276077aa3fc7f96092dd88fff95dfb57.pdf",
        "text": "https://archive.orkl.eu/e939ca7f276077aa3fc7f96092dd88fff95dfb57.txt",
        "img": "https://archive.orkl.eu/e939ca7f276077aa3fc7f96092dd88fff95dfb57.jpg"
    }
}