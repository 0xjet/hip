{
    "id": "e0d716e7-a1a4-451b-8f98-5b6ee7e70b03",
    "created_at": "2023-01-12T15:06:52.972161Z",
    "updated_at": "2025-03-27T02:12:03.944705Z",
    "deleted_at": null,
    "sha1_hash": "a87467c7a167ed3c825e158a2c2a60905c9ec8fd",
    "title": "2022-01-11 - Threat Analysis Report- DatopLoader Exploits ProxyShell to Deliver QBOT and Cobalt Strike",
    "authors": "",
    "file_creation_date": "2022-05-28T17:59:43Z",
    "file_modification_date": "2022-05-28T17:59:43Z",
    "file_size": 1771521,
    "plain_text": "# Threat Analysis Report: DatopLoader Exploits ProxyShell to Deliver QBOT and Cobalt Strike\n\n**[cybereason.com/blog/threat-analysis-report-datoploader-exploits-proxyshell-to-deliver-qbot-and-cobalt-strike](https://www.cybereason.com/blog/threat-analysis-report-datoploader-exploits-proxyshell-to-deliver-qbot-and-cobalt-strike)**\n\nWritten By\nCybereason Nocturnus IR\n\nJanuary 11, 2022 | 10 minute read\n\n[At the beginning of 2021, security researcher Orange Tsai reported a series of vulnerabilities targeting Microsoft Exchange servers dubbed](https://twitter.com/orange_8361)\n[ProxyLogon. The Cybereason Incident Response team encountered many compromises during the year that involved these vulnerabilities.](https://www.cybereason.com/blog/hafnium-response-cybereason)\n[Additional vulnerabilities were disclosed during the year by Orange and others, including ProxyOracle and the last one in August dubbed](https://devco.re/blog/2021/08/06/a-new-attack-surface-on-MS-exchange-part-2-ProxyOracle/)\n[ProxyShell.](https://www.cybereason.com/blog/threat-alert-microsoft-exchange-proxyshell-exploits-and-lockfile-ransomware)\n\n\n-----\n\nt e ast e o t s a te t e pub cat o o o yS e o ac at, t e Cybe easo c de t espo se tea est gated se e a cases\nwhere various attackers leveraged ProxyShell vulnerability in the wild.\n\nIn this Threat Analysis Report, we are going to share our findings from the latest incident involving ProxyShell. After a successful exploitation\nof ProxyShell, the attackers used the Exchange to distribute phishing emails to internal and external user accounts with the payload of QBot\nand DatopLoader. DatopLoader is a malware loader that emerged for the first time in September 2021. It was first used to distribute the Cobalt\nStrike attack framework, but recent operations have also included QBot.\n\nQBot is a notorious financial Trojan that recently changed its focus to affiliating with other attackers. Following QBot's execution and an initial\nreconnaissance phase, QBot handed over control to the next step of the attack, Cobalt Strike, which used numerous Command and Control\nservers to pursue the attack towards lateral movement across the victim’s domains.\n\n## Key Findings\n\n**Microsoft Exchange Vulnerabilities Exploited: The attackers exploited recently disclosed vulnerabilities in Microsoft Exchange**\nServers to gain access to the targeted networks. They then proceeded to use the Exchange servers to spread phishing emails\ninternally and externally and gain foothold on the victim’s domains.\n**DatopLoader: Cybereason detected increase in activity from DatopLoader as an initial access mechanism. Attackers use it to gain**\na first foothold in the systems and network environments of their victims.\n\n**QBot: The QBot gang has recently switched its focus away from being a banking trojan toward partnering with other attackers to**\n[deliver payloads such as Cobalt Strike and Conti Ransomware.](https://www.cybereason.com/blog/cybereason-vs.-conti-ransomware)\n\n**Cobalt Strike: The attackers used Cobalt Strike's remote execution capabilities to migrate laterally across different systems in the**\nvictims' network.\n\n## Initial Access - ProxyShell\n\nBefore we go into the weeds of the attack, let's take a deeper look at the initial access vector, the Exchange vulnerability dubbed as\n[ProxyShell, and understand better the precedence of the attack.](https://www.cybereason.com/blog/threat-alert-microsoft-exchange-proxyshell-exploits-and-lockfile-ransomware)\n\n### What is ProxyShell?\n\n[ProxyShell is a set of three security vulnerabilities that allow an adversary to perform unauthenticated remote code execution (RCE) and email-](https://www.cybereason.com/blog/threat-alert-microsoft-exchange-proxyshell-exploits-and-lockfile-ransomware)\nrelated tasks on unpatched Microsoft Exchange servers, such as downloading and browsing through emails.\n\nThe three CVEs affect the on-premise Microsoft Exchange servers 2013, 2016 and 2019, and are described as follows:\n\n[ProxyShell, along with](https://devco.re/blog/2021/08/22/a-new-attack-surface-on-MS-exchange-part-3-ProxyShell/) [ProxyLogon and](https://devco.re/blog/2021/08/06/a-new-attack-surface-on-MS-exchange-part-1-ProxyLogon/) [ProxyOracle, are three notable vulnerabilities published in 2021, attacking the Client Access Services](https://devco.re/blog/2021/08/06/a-new-attack-surface-on-MS-exchange-part-2-ProxyOracle/)\n[(CAS). CAS are responsible for providing authentication and proxy services for internal and external client connections in Exchange servers.](https://docs.microsoft.com/en-us/exchange/architecture/client-access/client-access?view=exchserver-2019)\nProxyShell was reported by Orange Tsai with collaboration of The Zero Day Initiative (ZDI). It was first introduced on April 6, 2021 at the\nPwn2Own 2021 contest, whereas technical details were first disclosed on August 5th at the BlackHat 2021 conference and a more complete\n[article was published on August 16th.](https://www.zerodayinitiative.com/blog/2021/8/17/from-pwn2own-2021-a-new-attack-surface-on-microsoft-exchange-proxyshell)\n\n[CVE-2021-34473 and CVE-2021-34523 were both patched in April (KB5001779) and disclosed in July, whereas CVE-2021-31207 was](https://support.microsoft.com/en-us/topic/description-of-the-security-update-for-microsoft-exchange-server-2019-2016-and-2013-april-13-2021-kb5001779-8e08f3b3-fc7b-466c-bbb7-5d5aa16ef064)\n[patched and disclosed in May (KB5003435). To this date, approximately 8 months after the official fix,](https://support.microsoft.com/en-us/topic/description-of-the-security-update-for-microsoft-exchange-server-2019-2016-and-2013-may-11-2021-kb5003435-028bd051-b2f1-4310-8f35-c41c9ce5a2f1) [Shodan, the popular vulnerability search](https://www.shodan.io/)\n[engine, displays more than 11K Exchange servers vulnerable to ProxyShell:](https://www.shodan.io/search/report?query=http.title%3Aoutlook+exchange)\n\n_Figure 1: ProxyShell’s Shodan search query results_\n\nNow, as ProxyShell’s background is better understood, we will elaborate on a recent trend Cybereason witnessed in November, 2021,\nshowcasing a particular ProxyShell exploitation attempt.\n\n### Attackers’ Initial Access\n\n\n-----\n\nt s epo t, e d scuss a pa t cu a y te est g e gage e t, e e t e attac e s ut ed o y o e o t e u e ab t es C 0\n34473, to perform unauthenticated email related activity on an Exchange server, leveraging the vulnerable Exchange backend. This newly\ngained capability was later in use by the attackers in an attempt to infect other recipients via phishing emails as will be described later on.\n\nBased on the impacted Exchange servers’ IIS logs entries and by crossing the User-Agent and the exploitation email identifier (which is a non[valuable information but one that must be provided as part of the URI), Cybereason suspects the attackers most likely took advantage of this](https://github.com/Jumbo-WJB/Exchange_SSRF)\n[publicly available ProxyShell exploitation scripts, leveraging Exchange Web Services (EWS) to transact email related actions.](https://docs.microsoft.com/en-us/exchange/client-developer/exchange-web-services/explore-the-ews-managed-api-ews-and-web-services-in-exchange)\n\nThe following is a sample IIS log entry, showcasing an execution result example of the aforementioned scripts on a compromised Exchange\nserver:\n\n**HTTP Method** **POST**\n\nURI Query a=a@edu.edu/mapi/emsmdb/?=&Email=autodiscover/autodiscover.json?a=a@edu.edu&CorrelationID=<empty>\n\nURI Stem /autodiscover/autodiscover.json\n\nUser-Agent Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36\n\n_Figure 2: ProxyShell IIS log entry example_\n\nThis is just one of many requests witnessed with the same nature, stemming from different IP addresses originating from all over the internet.\n\nTo detect this kind of attempts, especially ProxyShell’s CVE-2021-34473 (Authentication Bypass) and CVE-2021-34523 (Elevation of\nPrivileges), we looked at the Exchange servers’ IIS logs and tracked log entries with a URI containing “/autodiscover/autodiscover.json” and\none of the following strings - ”mapi/nspi”, ”mapi/emsmdb”, ”/EWS”, “powershell” or ”X-Rps-CAT”.\n\nAnother way to detect this kind of exploitation attempts is to run a Yara rule on suspected compromised Exchange servers, such as one\n[published by Florian Roth. To detect ProxyShell’s CVE-2021-31207 activity of post-exploitation privilege escalation, we looked for suspicious](https://github.com/Neo23x0/signature-base/blob/master/yara/expl_proxyshell.yar)\nCmdletSucceeded (Event ID 1) events in the MSExchangeManagement event log, specifically for the Cmdlets:\n\nNew-ManagementRoleAssignment - with the role “Mailbox Import Export”\nNew-MailboxExportRequest - suffixed with “.aspx” in the FilePath argument\n\nIn addition, another data source that we examined looking for malicious Powershell command executions was Exchange log files located in\n“%ExchangeInstallPath%\\Logging\\CmdletInfra\\Powershell-Proxy\\Cmdlet\\*” with the following conditions:\n\nProcessName contains “w3wp”\nPowershell commands contain New-ManagementRoleAssignment”, \"New-MailboxExportRequest\" or \"New_ExchangeCertificate\"_\n\n### Spread via Phishing - DatopLoader\n\nFollowing successful exploitations of the ProxyShell vulnerability, the attackers started sending out phishing emails, across the organization\nand outside of it to external emails. These phishing emails were sent as a reply message to legitimate, hijacked email conversations the\nattackers stole from within organiziation’s Exchange server utilizing the ProxyShell vulnerability. These email replies hold a similar structure to\nthe ones being sent recently by DatopLoader’s attackers.\n\nDatopLoader is an emerging threat that compromises victims via malspam campaigns, acting as an access broker to provide attackers with an\ninitial foothold into systems and victims' network environments:\n\n\n-----\n\n_One of the phishing emails that were sent in_\n\n_response to legitimate internal email_\n\nIt's noteworthy that although replying to hijacked emails helps attackers establish more legitimacy for their phishing attempts, they go one step\nfurther and modify the typeface and language of the reply messages for each attack to increase the chances of success. We believe that this is\none of the reasons they are becoming increasingly popular and succeeding these days.\n\n[The maliciously crafted emails had the following indicative characteristics found in the Exchange message tracking logs:](https://docs.microsoft.com/en-us/exchange/mail-flow/transport-logs/message-tracking?view=exchserver-2019)\n\nSource-context field:\n\nContained “MessageClass:IPM.Blabla”\nSuffixed with “ClientType:WebServices, SubmissionAssistant:MailboxTransportSubmissionEmailAssistant”\nDirectionality field set to “Originating” meaning these emails were generated on the impacted server itself\nOriginal-client-ip field matched with the ProxyShell IIS log entry’s client-ip\n\nAfter these emails are delivered, the victims are lured to click and download a malicious payload, from different links:\n\nFirst link - to download a zip file containing a malicious DatopLoader Excel which will be elaborated further on.\n[Second link - to download a zip file, containing a newer version of DatopLoader.](https://twitter.com/1ZRR4H/status/1456558230105112588)\n\nEach one of the links direct the victims to websites hosting the malicious payloads as zip files. Once a user clicks on one of them, it\nautomatically downloads a zip file, containing an Excel file (.xls) with a common phishing related message, luring the victim to enable Macro:\n\n_Example_\n\n_of a malicious document involved in the attack_\n\nOnce it is done, an obfuscated Macro will be executed to create the C:\\Datop folder, and to download three DLL files - test.test, test1.test and\ntest2.test from malicious IP addresses.\n\nThese files are then being executed by regsvr32.exe; following successful execution, QBot takes control:\n\n\n-----\n\n_QBot execution flow from regsvr32.exeas seen in the Cybereason XDR Platform_\n\n### Initial Infection - QBOT\n\nQBot is a well-known banking Trojan (also known as Pinkslipbot, Qakbot, and Quakbot) that evolved into a modular malware that allows\nattackers to perform a variety of malicious operations such as reconnaissance, lateral movement, and the delivery of payloads such as Cobalt\nStrike, Conti Ransomware, and other malware.\n\nIn this case, after a successful test1.test execution via the regsvr32.exe executable, QBot takes charge by reflectively injecting its DLL,\n_stager_1.dll to a newly spawned explorer.exe instance. In a chain of events stemming from the new explorer.exe, QBot immediately starts with_\nestablishing persistence using scheduled tasks and initiating communication with its Command and Control servers:\n\n_Injected QBot_\n\n_stager_1.dll Explorer.exe as seen in the Cybereason XDR Platform_\n\n\n-----\n\n_QBot reconnaissance activity as seen i the_\n\n_Cybereason XDR Platform_\n\nRight after, QBot performs several activities including reconnaissance activity such as checking for information about the host’s network\nconfiguration, Active Directory and available network resources (hosts and network shared devices). Except for one freeware tool called\n_Adfind, all of the programs run by the attackers were existing components of the Windows operating system. Said programs were executed by_\nthe code-injected Explorer.exe.\n\nFollowing are the list of the programs and their use by the attackers:\n\n**Adfind.exe a publicly available tool to query Active Directory domains. The executable was stored in %PROGRAMDATA%\\Oracle,**\n%SYSTEMDRIVE%%PROFILESFOLDER%\\Public. One line of command used by the attackers to generate a list of computers on\nthe network that we observed was the following:\n\n_Adfind.exe -f objectcategory=computer -csv name cn OperatingSystem dNSHostName > [some.csv]_\n\n**Net.exe: Windows component with functionality such as gathering system and network information.**\n\nnet share, net localgroup, net view /all were the commands used by the attackers.\n**Arp.exe: Used to retrieve Address Resolution Protocol cache.**\n**Nslookup.exe: Used to query the Domain Name System to obtain domain name and IP address mappings.**\n**Ipconfig.exe: Used to obtain information about the host’s network interfaces**\n**Netstat.exe: Used to retrieve a list of active connections, listening ports:**\n\n\n-----\n\n_net.exe and nslookup.exe reconnaissance commands as seen in the Cybereason XDR Platform_\n\nThere were dozens of connections to QBot Command and Control IP addresses through the explorer.exe process. The same explorer.exe\nprocess injects code to the original legitimate explorer.exe process, which in its turn spawns legitimate dllhost.exe processes, to be injected\nusing the Process Hollowing technique. Then, the dllhost.exe processes are being used to deploy Cobalt Strike Beacons to other machines in\nthe network using the reconnaissance commands discussed earlier:\n\n_explorer.exe spawning dllhost.exe as seen in_\n\n_the Cybereason XDR Platform_\n\n### Lateral Movement - Cobalt Strike\n\nCobalt Strike is a commercial penetration testing tool that allows an attacker to perform penetration tests using a deployed agent called\n'Beacon' on a victim machine.\n\nIn this case, the attackers utilized the Jump psexec and Jump psexec_psh Cobalt Strike’s commands in order to move laterally over different\nmachines on available domains in the victims’ network. From that point, the attackers dumped the SYSTEM, SAM and SOFTWARE hives, in\norder to steal credentials.\n\nUsing Jump psexec and Jump psexec_psh commands enabled the attackers to remotely install services on victim machines and to deploy\ntheir Beacon. A unique identifier for the two types of command will bea seven randomly generated alphanumeric characters string.\n\nThe difference between the two commands resides in what is getting executed by the remote service:\n\n\n-----\n\n_ju_ _p pse ec co_ a d uses t e sa e e ote code e ecut o et od used by Sys te a s s ec too Us g t s et od a\nBeacon gets copied and executed from the ADMIN$ share:\n\n_jump psexec_psh on the other hand uses a Base64 encoded powershell command that runs a shellcode which installs the remote_\nbeacon.\n\n[A useful CyberChef recipe to extract the payload from a Cobalt Strike jump psexec_psh command line can be found here:](https://gchq.github.io/CyberChef/#recipe=Regular_expression('User%20defined','%5Ba-zA-Z0-9%2B/%3D%5D%7B32,%7D',true,true,false,false,false,false,'List%20matches')From_Base64('A-Za-z0-9%2B/%3D',true)Remove_null_bytes()Regular_expression('User%20defined','%5Ba-zA-Z0-9%2B/%3D%5D%7B32,%7D',true,true,false,false,false,false,'List%20matches')From_Base64('A-Za-z0-9%2B/%3D',true)Gunzip()Regular_expression('User%20defined','%5Ba-zA-Z0-9%2B/%3D%5D%7B32,%7D',true,true,false,false,false,false,'List%20matches')From_Base64('A-Za-z0-9%2B/%3D',true)XOR(%7B'option':'Decimal','string':'35'%7D,'Standard',false))\n\nThese two commands can be traced using the System event log while looking for service creation events (Event ID - 7045). To find Cobalt\nStrike beacons, look for the following regex patterns in the “Service File Name” field:\n\nJump psexec: \\\\\\\\(?:[0-9]{1,3}\\.){3}[0-9]{1,3}\\\\ADMIN\\$\\\\\\w{7}\\.exe\nJump psexec_psh: %COMSPEC%.*? powershell -nop -w hidden -encodedcommand JABz.+\n\n### Credential Theft\n\nOne credential theft technique the attackers were seen using is dumping the System, Security and SAM registry hives. The System hive\ncontains information about the Windows system, SAM hive contains hashes of user password and stands for the Security Account Manager,\nand the Security hive contains security information including security policy and user's permissions. With those hives the attackers can extract\n[passwords of cached users. (Read more at - https://pure.security/dumping-windows-credentials/)](https://pure.security/dumping-windows-credentials/)\n\nIn addition, the attackers could leverage ProxyShell to search and download users’ emails containing a specific keyword (the keyword\n[“password” was suggested in the original script mentioned earlier). This technique can lead to a compromise of users whose password was](https://github.com/Jumbo-WJB/Exchange_SSRF)\nshared via email.\n\n## Conclusion\n\nExchange vulnerabilities that we touched on in this article have significant implications for enterprises especially given the prevalence of\nWindows Server in business settings. As shown in this post, once attackers successfully create a foothold in a network by exploiting such\nvulnerabilities, it becomes relatively easy to move to other hosts on the network and collect information about the internals of the network, use\nthe network to send phishing emails to other organizations for further expansion of the attack and sometimes cause unrecoverable damage on\nthe networks. Aside from the vulnerabilities, the use of DatopLoader as a payload deliverer came to our attention. We believe that we will come\nacross the said deliverer in the future incidents.\n\nIn particular incidents, attacks only went up to the Cobalt Strike attack phase, however other security vendors have reported that similar\nincidents in some cases resulted in ransomware attacks. Regardless, in any phase of exploitation attackers may have been able to reach,\ncorporations that went under threat have to put serious amounts of time and effort to recover and marshal assets to mitigate and bring the\nenvironment to the latest known secure state in a short period of time under tremendous pressure.\n\nSeveral months have passed since the publication of Windows Exchange Server patches that closes the vulnerability. Yet, It is noticeable how\nnot many corporations have managed to apply security updates to reduce exploitable services. In order to combat this particular known and\nfuture unknown threats follow the recommendations below.\n\n## Cybereason Incident Response\n\nCybereason DFIR team recommends the following:\n\n\n-----\n\npp y secu ty patc es ( [500](https://support.microsoft.com/en-us/topic/description-of-the-security-update-for-microsoft-exchange-server-2019-2016-and-2013-april-13-2021-kb5001779-8e08f3b3-fc7b-466c-bbb7-5d5aa16ef064) 9 a d [5003 35 as](https://support.microsoft.com/en-us/topic/description-of-the-security-update-for-microsoft-exchange-server-2019-2016-and-2013-may-11-2021-kb5003435-028bd051-b2f1-4310-8f35-c41c9ce5a2f1) e t o ed t e at s o yS e sect o )\nMake sure your Exchange servers have Cybereason sensor installed to get protected against this threat\n[Enable the Anti-Malware feature on the Cybereason NGAV, and enable the Detect and Prevent modes of this feature.](https://nest.cybereason.com/documentation/product-documentation/190/anti-malware-settings)\n[Enable the Predictive Ransomware Protection feature and enable the Detect and Prevent modes of this feature.](https://www.cybereason.com/platform/ransomware-protection)\nEnable logging on your Exchange servers\n[Consider performing Compromise Assessment to your environment focusing on Exchange Vulnerabilities.](https://www.cybereason.com/services/compromise-assessment)\n[Consider a Cybereason IR Retainer to gain immediate containment and expert remediation assistance to prevent security events](https://www.cybereason.com/services/incident-response#retainer)\nfrom escalating.\n\nCybereason is dedicated to teaming with Defenders to end cyber attacks from endpoints to the enterprise to everywhere. Learn more about\nour [Incident Response team,](https://www.cybereason.com/services/incident-response) [Cybereason XDR powered by Google Chronicle and](https://www.cybereason.com/platform/xdr) [Extended Detection and Response (XDR) Toolkit, or](https://www.cybereason.com/get-the-xdr-toolkit)\n[schedule a demo today to learn how your organization can benefit from an operation-centric approach to security.](https://www.cybereason.com/request-a-demo)\n\n## MITRE ATT&CK BREAKDOWN\n\n\n**Initial**\n**Access**\n\nExploit\nPublicFacing\nApplication\n\n\n**Execution** **Persistence** **Privilege**\n**Escalation**\n\n\nCommand\nand\nScripting\nInterpreter\n\n\n**Discovery** **Lateral**\n**movement**\n\n\n**Collection** **Comman**\n**and**\n**Control**\n\n\nInternal\n[Spear](https://attack.mitre.org/techniques/T1534/)\nPhishing\n\nLateral Tool\nTransfer\n\nRemote\nServices\n\nSoftware\n[Deployment](https://attack.mitre.org/techniques/T1072/)\nTools\n\n\nData from\n[Local](https://attack.mitre.org/techniques/T1005/)\nSystem\n\nData\nStaged\n\nEmail\nCollection\n\n\nApplicati\nLayer\n[Protocol:](https://attack.mitre.org/techniques/T1071/001/)\nWeb\nProtocols\n\nIngress\nTool\nTransfer\n\nRemote\n[Access](https://attack.mitre.org/techniques/T1219/)\nSoftware\n\n\n**Defense Evasion** **Credential**\n**Access**\n\n[Process Injection](https://attack.mitre.org/techniques/T1055/) OS\n[Credential](https://attack.mitre.org/techniques/T1003/)\nDumping\n\n\nDeobfuscate/Decode\nFiles or Information\n\nExploitation for\nDefense Evasion\n\nReflective Code\nLoading\n\nSigned Binary Proxy\nExecution\n\n\n[Phishing](https://attack.mitre.org/techniques/T1566/) Software\n[Deployment](https://attack.mitre.org/techniques/T1072/)\nTools\n\nSystem\nServices\n\n## Researchers:\n\n\nServer\nSoftware\nComponent:\nWeb Shell\n\nCreate or\nModify\nSystem\nProcess\n\nScheduled\nTask/Job\n\nValid\nAccounts\n\n\nExploitation\nfor\nPrivilege\nEscalation\n\nValid\nAccounts\n\n\nAccount\nDiscovery\n\nDomain\n[Trust](https://attack.mitre.org/techniques/T1482/)\nDiscovery\n\nNetwork\n[Service](https://attack.mitre.org/techniques/T1046/)\nScanning\n\nNetwork\n[Share](https://attack.mitre.org/techniques/T1135/)\nDiscovery\n\nPermission\n[Groups](https://attack.mitre.org/techniques/T1069/)\nDiscovery\n\nProcess\nDiscovery\n\nSystem\n[Owner/User](https://attack.mitre.org/techniques/T1033/)\nDiscovery\n\n\nExploitation\nfor\nCredential\nAccess\n\n\n**Niv Yona**\n\nNiv, IR Practice Director, leads Cybereason's incident response practice in the EMEA region. Niv began his career a decade ago in the Israeli\nAir Force as a team leader in the security operations center, where he specialized in incident response, forensics, and malware analysis. In\nformer roles at Cybereason, he focused on threat research that directly enhances product detections and the Cybereason threat hunting\nplaybook as well as the development of new strategic services and offerings\n\n\n-----\n\n**Ofir Ozer**\n\nOfir is a Incident Response Engineer at Cybereason who has a keen interest in Windows Internals, reverse engineering, memory analysis and\nnetwork anomalies. He has years of experience in Cyber Security, focusing on Malware Research, Incident Response and Threat Hunting. Ofir\nstarted his career as a Security Researcher in the IDF and then became a malware researcher focusing on Banking Trojans.\n\n**Chen Erlich**\n\nChen has almost a decade of experience in Threat Intelligence & Research, Incident Response and Threat Hunting. Before joining\nCybereason, Chen spent three years dissecting APTs, investigating underground cybercriminal groups and discovering security vulnerabilities\nin known vendors. Previously, he served as a Security Researcher in the IDF.\n\n**Omri Refaeli**\n\nOmri is an Incident Response Specialist with over 7 years of experience in Digital Forensics & Incident Response (DFIR), Threat Hunting,\nMalware Analysis and Security Research.\n\nPrior to working with Cybereason, Omri provided comprehensive cyber security services to global companies as a senior consultant in a global\nconsulting firm, subsequently after discharging from the Israeli Navy's technological unit.\n\n**Daichi Shimabukuro**\n\nDaichi has 5+ years of experience in Digital Forensics and Incident Response. Prior to joining Cybereason, he was part of a digital forensics\nand litigation handling team at an auditing firm. He mainly focuses on network and memory forensics and tool development to help incident\nresponse.\n\n## Indicators of Compromise\n\n### Hashes - SHA1\n\n\n-----\n\nb 6 3b e3d d 5 b5 c 593 3a068 d\nE2f49a3d5bdd51a37f9763d8c5182ee1898c536a\n5f85f89aa9eb5a245486746b0d35c620a246fd6c\nE2f49a3d5bdd51a37f9763d8c5182ee1898c536a\nBce713b7e22b16970d2bee2a778e6dc92bf1d088\n2b02f0fb7c23cbb80b18911769c24e4bfe3eb964\n9fe7ea47a631eed966ab56df356a5046309a4524\nFcd81bad094458bfe9cde1723c8ca0748ad0a163\n2044362282593913c28c1db1098e484d7ec2855e\n2044362282593913c28c1db1098e484d7ec2855e\nA3e1f995aa47cdf068c770ffcdf4e2c2ec20a2aa\n26614b84a3083542734fd81a632d144904f49d36\nd7e144cf4155ef08770a696bd12d04b690c49c80\n\n### Domain Names\n\ncasaviva.com[.]pe\nsecuritybusinessbeat[.]com\nGcchinchillas[.]com\nMi-tiendita[.]store\ngeodrillingchile[.]cl\nAgrosanus[.]com[.]tr\nva.virtualacademy[.]pk\nx1.i.lencr[.]org\nebookparainvestidores]com[.]br\nApi.officialaccess[.]net\nnimixtutorials[.]ir\nimperialmm[.]com\n\n### File & Directory Paths\n\nC:\\Datop\\\nC:\\Datop\\Test.test\nC:\\Datop\\Test1.test\nC:\\Datop\\Test2.test\nC:\\Datop\\good.good\nC:\\Datop\\good1.good\nC:\\Datop\\good2.good\n\n### IP Addresses\n\n45.141.84.223\n103.142.10.177\n103.143.8.71\n81.149.119.231\n140.82.49.12\n45.46.53.140\n216.238.71.31\n201.172.31.95\n216.238.72.121\n85.226.176.123\n87.99.107.124\n176.78.108.235\n194.36.28.190\n93.102.128.205\n86.220.112.26\n41.235.72.90\n86.98.1.197\n50.194.160.233\n89.238.185.9\n86.173.96.126\n109.49.27.234\n111.250.42.217\n151.139.128.14\n118.215.113.124\n\n\n-----\n\n3 38 66 3\n50.116.92.101\n192.185.134.15\n104.251.122.39\n198.144.189.74\n37.0.10.29\n86.57.53.204\n123.231.85.8\n86.57.58.148\n86.57.32.53\n217.12.201.112\n108.171.241.25\n86.57.38.156\n86.57.14.22\n45.133.1.90\n86.57.19.57\n118.172.77.62\n\nAbout the Author\n\n**Cybereason Nocturnus IR**\n\nThe Cybereason Nocturnus IR team support our customers with decades of combined experience in Digital Forensics and Incident Response\n(DFIR), Threat Hunting, Malware Analysis, Reverse Engineering, Red Teaming, and more. We respond to intrusions and security incidents\nworldwide, helping customers discover if they have been breached, and assess how effective their defenses are through emergency IR,\nproactive Compromise Assessments and Security Validation/Red Teaming services. The Cybereason Nocturnus IR team leverage the\nadvanced functionality of the Cybereason Endpoint Protection Platform in concert with bespoke tooling designed to scale to the speed and\nimpact of modern threats and reverse the adversary advantage.\n\n[All Posts by Cybereason Nocturnus IR](https://www.cybereason.com/blog/authors/cybereason-nocturnus-ir)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-11 - Threat Analysis Report- DatopLoader Exploits ProxyShell to Deliver QBOT and Cobalt Strike.pdf"
    ],
    "report_names": [
        "2022-01-11 - Threat Analysis Report- DatopLoader Exploits ProxyShell to Deliver QBOT and Cobalt Strike.pdf"
    ],
    "threat_actors": [
        {
            "id": "529c1ae9-4579-4245-86a6-20f4563a695d",
            "created_at": "2022-10-25T16:07:23.702006Z",
            "updated_at": "2025-03-27T02:02:09.93109Z",
            "deleted_at": null,
            "main_name": "Hafnium",
            "aliases": [
                "Red Dev 13",
                "Silk Typhoon"
            ],
            "source_name": "ETDA:Hafnium",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5d2bd376-fcdc-4c6a-bc2c-17ebbb5b81a4",
            "created_at": "2022-10-25T16:07:23.667223Z",
            "updated_at": "2025-03-27T02:02:09.916086Z",
            "deleted_at": null,
            "main_name": "GCHQ",
            "aliases": [
                "Government Communications Headquarters",
                "Operation Socialist"
            ],
            "source_name": "ETDA:GCHQ",
            "tools": [
                "Prax",
                "Regin",
                "WarriorPride"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7c969685-459b-4c93-a788-74108eab6f47",
            "created_at": "2023-01-06T13:46:39.189751Z",
            "updated_at": "2025-03-27T02:00:03.017103Z",
            "deleted_at": null,
            "main_name": "HAFNIUM",
            "aliases": [
                "ATK233",
                "G0125",
                "Operation Exchange Marauder",
                "Red Dev 13",
                "Silk Typhoon"
            ],
            "source_name": "MISPGALAXY:HAFNIUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2704d770-43b4-4bc4-8a5a-05df87416848",
            "created_at": "2022-10-25T15:50:23.306305Z",
            "updated_at": "2025-03-27T02:00:55.43633Z",
            "deleted_at": null,
            "main_name": "HAFNIUM",
            "aliases": [
                "HAFNIUM",
                "Operation Exchange Marauder",
                "Silk Typhoon"
            ],
            "source_name": "MITRE:HAFNIUM",
            "tools": [
                "Tarrask",
                "ASPXSpy",
                "Impacket",
                "PsExec",
                "China Chopper"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536012,
    "ts_updated_at": 1743041523,
    "ts_creation_date": 1653760783,
    "ts_modification_date": 1653760783,
    "files": {
        "pdf": "https://archive.orkl.eu/a87467c7a167ed3c825e158a2c2a60905c9ec8fd.pdf",
        "text": "https://archive.orkl.eu/a87467c7a167ed3c825e158a2c2a60905c9ec8fd.txt",
        "img": "https://archive.orkl.eu/a87467c7a167ed3c825e158a2c2a60905c9ec8fd.jpg"
    }
}