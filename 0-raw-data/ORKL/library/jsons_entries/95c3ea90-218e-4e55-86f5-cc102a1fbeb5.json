{
    "id": "95c3ea90-218e-4e55-86f5-cc102a1fbeb5",
    "created_at": "2023-01-12T15:05:04.823271Z",
    "updated_at": "2025-03-27T02:05:37.937023Z",
    "deleted_at": null,
    "sha1_hash": "a3dbcd1e4d0ef28f16050a82d8e0210c8984ecb3",
    "title": "2021-03-05 - Sarbloh- The Ransomware With NO Demand",
    "authors": "",
    "file_creation_date": "2022-05-28T17:50:38Z",
    "file_modification_date": "2022-05-28T17:50:38Z",
    "file_size": 752449,
    "plain_text": "# Sarbloh: The Ransomware With NO Demand\n\n**labs.k7computing.com/**\n\nBy Rajesh R March 5, 2021\n\n[We came across this tweet about Sarbloh](https://twitter.com/MBThreatIntel/status/1366922640754024455) **ransomware exploiting the current political climate of the**\ncountry. We have seen malware using similar tactics in the past and enticing users with trending news\nlike COVID-19 or the US elections as their theme. However, this approach by the threat actors was quite\nintriguing considering the fact that there were no ransom demands.\n\nThe ransomware note claims that this notoriety was put together by “Khalsa Cyber Fauj”. The intended\ntargets of this ransomware is not known as yet. Usually there will be a ransom amount demanded by the\nthreat actors, but in this case there is no demand. Since there is no monetary gain for the malware\nauthors, we think this is related to hacktivism. In this blog, we will be explaining the technical aspects of\nthis ransomware.\n\n**Technical Details**\n\nSarbloh is neat and straight forward. The binaries are not packed and it mostly uses Windows native\nAPIs. The functions are in sequential order similar to any run-of-the-mill ransomware. The ransomware\nauthors have been lax in using evasion techniques making us to believe that this malware is meant for\nhit-and-run type of attacks.\n\nThe initial vector is a docm file with a really good tutorial on how to enable macros in MS Office with\npatriotic themed images.\n\n\n-----\n\n_Figure 1:_\n\n_Malicious DOCM file_\nThe docm file contains a simple macro which assigns bitsadmin a job to download the payload. Using\nbitsadmin is not new and is popular amongst malware variants. Their payload is saved as putty.exe.\nThis name is used to avoid suspicion as it looks similar to a popular application.\n\n_Figure 2: Malicious Macro_\n\n_Figure 3:_\n\n_Bitsadmin Job_\n\n\n-----\n\nNow we will be discussing the code flow of the ransomware payload. The flow is neat and starts with\ngetting the base address of ntdll from Process Environment Block (PEB). This is one of the standard\n[ways of malware loading DLL during runtime. The complete method could be found here.](https://vdalabs.com/2018/09/19/finding-dll-name-from-the-process-environment-block-peb/)\n\n_Figure 4: Search for ntdll base address using PEB_\n\n_Figure 5: Decrypting DLL names and API strings_\nEncrypted DLL and function names are embedded in encrypted format within resources and are\ndecrypted and loaded during runtime. The authors also left a message for the people reversing the\nransomware. The decryption key for the names, is a combination of a string and a unicode value. The\nstring is “FUCKINDIA”. From here on, the steps are similar to how any generic ransomware would work.\n\n_Figure 6: String used in Decryption of API and DLL names_\nThe next step is searching for the addresses of key APIs like LdrLoadDll, LdrGetProcedureAddress, etc.\nThese are the required APIs for enumerating and encrypting the files. After this, the ransomware’s public\nkeys are imported. Here, the C drive is hardcoded in the binary and only files in the C drive are\nencrypted. So, all the files in this drive are enumerated and a key pair is generated for each file using\n_CryptGenKey. Using the public key, and with the key pair generated per file, the file is encrypted and the_\nkey pair itself is encrypted using the ransomware’s public key and is appended to the end of the file.\n_CryptEncrypt API is used for encryption. Looking at the encryption code flow, we think this a DIY_\n[ransomware attempt, as we found a similar one in Microsoft forums like here.](https://social.msdn.microsoft.com/Forums/vstudio/en-US/28a78f5b-759b-42a7-9004-ccbbe469cffb/how-do-i-import-a-public-key-for-encryption-in-c?forum=vcgeneral)\n\n\n-----\n\n_Figure 7:_\n\n_Importing Ransomware’s Public Key_\n\n_Figure 8: C drive path Hardcoded_\nThe file names are changed using SetFileInformation API. A set of inclusion list for extensions and\nexclusion list for directories are also used. Finally, a thread is created which generates a window for\ndisplaying the ransomware note.\n\n_Figure 9: Ransomware Note_\nUsually ransomware authors leave contact information in the note. But in the case of Sarbloh, no email\nor a bitcoin invoice is available, leaving the victims with no hope of recovering their files.\n\nWe at K7 Computing constantly monitor for such malware and ensure that we provide proactive\nprotection against such attacks. Also our Generic Anti-Ransomware feature in our security product\nflags this before the ransomware can execute. As always, we recommend our customers to use the K7\nsecurity products to protect your data and keep it updated to stay protected from the latest threats.\n\n\n-----\n\n**Indicators Of Compromise (IoCs)**\n\n**File Name** **Hash** **K7**\n**Detection**\n**Name**\n\nprofile16146815778005vw0qb.png 8E7ED531E974D966E927E4B33CA0D98F4B269503 Trojan (\n00578ab71\n)\n\ndoc1.docm 82B36C510877CA7A59D20415FF939E0E Trojan (\n000114e01\n)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-03-05 - Sarbloh- The Ransomware With NO Demand.pdf"
    ],
    "report_names": [
        "2021-03-05 - Sarbloh- The Ransomware With NO Demand.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535904,
    "ts_updated_at": 1743041137,
    "ts_creation_date": 1653760238,
    "ts_modification_date": 1653760238,
    "files": {
        "pdf": "https://archive.orkl.eu/a3dbcd1e4d0ef28f16050a82d8e0210c8984ecb3.pdf",
        "text": "https://archive.orkl.eu/a3dbcd1e4d0ef28f16050a82d8e0210c8984ecb3.txt",
        "img": "https://archive.orkl.eu/a3dbcd1e4d0ef28f16050a82d8e0210c8984ecb3.jpg"
    }
}