{
    "id": "bfd85ab6-ed2a-4758-8143-5caba761396e",
    "created_at": "2023-01-12T15:09:38.108071Z",
    "updated_at": "2025-03-27T02:09:29.793545Z",
    "deleted_at": null,
    "sha1_hash": "9977ec1b9c001dab5252e0e89624e7a70a998143",
    "title": "2020-12-22 - SolarWinds Attacks- Stealthy Attackers Attempted To Evade Detection",
    "authors": "",
    "file_creation_date": "2022-05-28T23:07:06Z",
    "file_modification_date": "2022-05-28T23:07:06Z",
    "file_size": 934159,
    "plain_text": "# SolarWinds Attacks: Stealthy Attackers Attempted To Evade Detection\n\n**symantec-enterprise-blogs.security.com/blogs/threat-intelligence/solarwinds-attacks-stealthy-attackers-attempted-**\nevade-detection\n\nThreat Hunter TeamSymantec\n\n## In the first of a series of follow-up analysis on the SolarWinds attacks, we take a look at how the attackers disabled security software and avoided detection\n\n[As we continue our analysis on the tools used in the SolarWinds attacks, one of the most](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/sunburst-supply-chain-attack-solarwinds)\nstriking aspects we’ve noticed is how careful the attackers were to avoid drawing attention to\nthemselves. Software supply chain attacks are relatively stealthy to begin with, since signed\nsoftware from a trusted source is less likely to raise red flags. However, the attackers weren’t\ncontent to rely on the cover this provided and also took several other steps to avoid\ndetection.\n\n\n-----\n\nTo begin with, the Sunburst backdoor (Backdoor.Sunburst), which was delivered using a\nTrojanized update to SolarWinds Orion, sets a delay time of up to 14 days before execution.\nIn other words, no malicious activity will begin until this period has elapsed.\n\nThe length of time selected is most likely to increase the likelihood that the log entries of the\ninitial malicious activity have been deleted before any subsequent post-breach activity is\ninitiated, thereby making it difficult to correlate the two sets of malicious events. Many\norganizations, including even managed security services providers (MSSPs), will often purge\ntheir security logs after seven days to minimize storage costs and make searching them\neasier.\n\nSunburst will also check the current Windows domain the machine belongs to. If the domain\ncontains the string 'test' or one of 13 additional specific domains that appear related to lab\nsystems such as “swdev.local” and “apac.lab”, the threat will cease to execute. A full list is in\nAppendix A.\n\n## Avoiding Security Software and Researchers\n\nAttacks begin with a Trojanized version of SolarWinds’ Orion software. The attackers\nmodified Orion in order to deliver the Sunburst backdoor to the computer. Sunburst is first\nstage malware, designed to perform reconnaissance on the infected computer, perform\nchecks for security tools, and deliver a second stage payload, if required.\n\nThe main Sunburst code is contained in a class named\nSolarWindows.Orion.Core.BusinessLayer that, when first instantiated, calls a member\nfunction called Update. The function name is a ruse, as the code does not perform any\nupdate, but instead is designed to disable security software, avoid security researcher\nsystems, and possibly avoid running on systems not of interest to the attackers. The function\ncontains three lists – a list of process names, a list of driver filenames, and a list of\nprocesses and service name pairs. These names are all obfuscated in the code by hashing\nthem using the FNV1A algorithm and using variable names that masquerade as timestamps.\n\nThe function will:\n\nGet a list of running processes.\nCheck if the process names match items on the process list\nGet a list of all installed drivers\nCheck if the driver names match items on the drivers list\nIf a match is found, the malicious code does not perform further actions and returns\n\nThis process and driver list contains tools that commonly run on security researcher systems\nand thus, this functionality appears to be designed not to run on such systems in order to\navoid discovery. The full list of security tools can be found in Appendix A. Furthermore, the\nlists also contained names related to a variety of security software programs including:\n\n\n-----\n\nSecurity software process names\n\nAVG/AVAST\nPanda\nKaspersky\nTanium\nDriver names\n\nCyberArk - cybkerneltracker.sys\nAltiris Symantec - atrsdfw.sys (Ghost Pre-installation boot environment driver)\nRaytheon Cyber Solutions - eaw.sys\nCJSC Returnil Software - rvsavd.sys\nVerasys Digital Guardian - dgdmk.sys\nSentinel One – sentinelmonitor.sys\nHexis Cyber Solutions - hexisfsmonitor.sys\nDell SecureWorks - groundling32.sys, groundling64.sys\nSAFE-Cyberdefense - safe-agent.sys\nCybereason – crexecprev.sys\nAbsolute - psepfilter.sys, cve.sys\nBromium - brfilter.sys, brcow_x_x_x_x.sys\nLogRhythm - lragentmf.sys\nOESIS OPSwat - libwamf.sys\n\nThe security vendors on this list have most likely been chosen as the attacker has\ndetermined that their products are unlikely be installed at organizations of interest to the\nattackers. Given the indiscriminate nature of supply chain as a vector, with an estimated\n18,000 SolarWinds customers affected, the attackers probably wanted to avoid any risk of\ndetection in organizations that weren’t of interest to them.\n\nInterestingly, the process solarwindsdiagnostics is also blacklisted. Presumably this is\nincluded to avoid detection during any SolarWinds testing or troubleshooting.\n\n## Disabling security software\n\nSunburst also attempts to specifically disable some software security services via the\nregistry. This allows Sunburst to perform its malicious actions completely undetected. If the\nattackers worked quickly and restored the services afterwards, a security administrator would\npotentially have no record of the activity, nor have even noticed the temporary lack of\nprotection.\n\n\n-----\n\n_Figure 1. Example of how Sunburst disables security software. In this case it checks if the_\n_CrowdStrike processes csfalconservice or csfalconcontainer are running, and if so, it sets the_\n_csagent, csfalconservice, and csdevicecontrol services to be disabled._\n\nThis function will:\n\nGet a list of running processes\nCheck if the process names match items on the process/services name pair list\nDisable the security software by modifying its service registry entry\n\n\n-----\n\nAfter the software has been confirmed to be disabled, usually after a reboot, the\nmalicious code will then contact the command and control (C&C) server and potentially\nperform further malicious actions\n\nTo disable the security software, Sunburst will simply set the products’ service start setting to\nDisabled. In Windows, this is done by setting the registry keys:\n\nHKLM\\ SYSTEM\\CurrentControlSet\\services\\<service name>\\Start = 4\n\nThis will cause the security software not to load at the next reboot.\n\nIt should be noted that the attackers do not attempt to disable any Symantec products.\nPresumably this is because of an anti-tampering feature in Symantec software, which\nprevents its own service from being disabled.\n\nThe process and services pair list include software from the following vendors:\n\nCrowdStrike\nCarbon Black\nFireEye\nESET\nF-Secure\n\nInterestingly, the list also included Microsoft Defender, but only the service key permissions\nare changed. Currently, this has an unknown effect. In addition, some other unknown\nproducts are also included, but were effectively commented out. The attackers may have\ndiscovered this technique was ineffective for these products.\n\nFinally, Sunburst will check if api.solarwinds.com resolves to a valid address before\ncontinuing.\n\n## Low profile threat\n\nThe SolarWinds attacks are among the best-planned and adept attacks we have seen in\nrecent years. The attackers have gone to great lengths to both find an effective path into\ntheir targeted organizations and, once inside their networks, maintain a low profile. Our\nanalysis of these tools is ongoing and we plan to publish further blogs in the coming weeks.\n\n## Protection/Mitigation\n\nTools associated with these attacks will be detected and blocked on machines running\nSymantec Endpoint products.\n\n**File-based protection:**\n\nBackdoor Sunburst\n\n\n-----\n\nBackdoor.Sunburst!gen1\nBackdoor.SuperNova\nBackdoor.Teardrop\n\n**Network-based protection:**\n\nSystem Infected: Sunburst Malware Activity\n\n## Appendix A\n\n### Drivers Avoided\n\n**Driver** **FNV1A Hash** **Description**\n\nybkerneltracker.sys 17097380490166623672\n\natrsdfw.sys 15194901817027173566 Altiris Symantec (Ghost Preinstallion\nboot environment driver)\n\neaw.sys 12718416789200275332 Raytheon Cyber Solutions\n\nrvsavd.sys 18392881921099771407 CJSC Returnil Software\n\ndgdmk.sys 3626142665768487764 Verdasys\n\nsentinelmonitor.sys 12343334044036541897 Sentinel\n\nhexisfsmonitor.sys 397780960855462669 Sentinel One\n\ngroundling32.sys 6943102301517884811 Dell SecureWorks\n\ngroundling64.sys 13544031715334011032 Dell SecureWorks\n\nsafe-agent.sys 11801746708619571308 SAFE-Cyberdefense\n\ncrexecprev.sys 18159703063075866524 Absolute (Palisade Systems)\n\npsepfilter.sys 835151375515278827 Absolute\n\ncve.sys 16570804352575357627 Absolute\n\nbrfilter.sys 1614465773938842903 Bromium\n\nbrcow_x_x_x_x.sys 12679195163651834776 Bromium\n\nlragentmf.sys 2717025511528702475 LogRhythm\n\nlibwamf.sys 17984632978012874803 OESIS OPSwat\n\n\n-----\n\n### Security Tools Avoided\n\n**Tool** **FNV1A Hash**\n\napimonitor-x64 2597124982561782591\n\napimonitor-x86 2600364143812063535\n\nautopsy64 13464308873961738403\n\nautopsy 4821863173800309721\n\nautoruns64 12969190449276002545\n\nautoruns 3320026265773918739\n\nautorunsc64 12094027092655598256\n\nautorunsc 10657751674541025650\n\nbinaryninja 11913842725949116895\n\nblacklight 5449730069165757263\n\ncff explorer 292198192373389586\n\ncutter 12790084614253405985\n\nde4dot 5219431737322569038\n\ndebugview 15535773470978271326\n\ndiskmon 7810436520414958497\n\ndnsd 13316211011159594063\n\ndnspy 13825071784440082496\n\ndotpeek32 14480775929210717493\n\ndotpeek64 14482658293117931546\n\ndumpcap 8473756179280619170\n\nevidence center 3778500091710709090\n\nexeinfope 8799118153397725683\n\nfakedns 12027963942392743532\n\nfakenet 576626207276463000\n\n\n-----\n\n**Tool** **FNV1A Hash**\n\nffdec 7412338704062093516\n\nfiddler 682250828679635420\n\nfileinsight 13014156621614176974\n\nfloss 18150909006539876521\n\ngdb 10336842116636872171\n\nhiew32 13260224381505715848\n\nunknown 17956969551821596225\n\nhiew32demo 12785322942775634499\n\nidaq64 8709004393777297355\n\nidaq 14256853800858727521\n\nidr 8129411991672431889\n\nildasm 15997665423159927228\n\nilspy 10829648878147112121\n\njd-gui 9149947745824492274\n\nlordpe 3656637464651387014\n\nofficemalscanner 3575761800716667678\n\nollydbg 4501656691368064027\n\npdfstreamdumper 10296494671777307979\n\npe-bear 14630721578341374856\n\npebrowse64 4088976323439621041\n\npeid 9531326785919727076\n\npe-sieve32 6461429591783621719\n\npe-sieve64 6508141243778577344\n\npestudio 10235971842993272939\n\npeview 2478231962306073784\n\n\n-----\n\n**Tool** **FNV1A Hash**\n\npexplorer 9903758755917170407\n\nppee 14710585101020280896\n\nprocdump64 13611814135072561278\n\nprocdump 2810460305047003196\n\nprocesshacker 2032008861530788751\n\nprocexp64 27407921587843457\n\nprocexp 6491986958834001955\n\nprocmon 2128122064571842954\n\nprodiscoverbasic 10484659978517092504\n\npy2exedecompiler 8478833628889826985\n\nr2agent 10463926208560207521\n\nrabin2 7080175711202577138\n\nradare2 8697424601205169055\n\nramcapture64 7775177810774851294\n\nramcapture 16130138450758310172\n\nreflector 506634811745884560\n\nregmon 18294908219222222902\n\nresourcehacker 3588624367609827560\n\nretdec-ar-extractor 9555688264681862794\n\nretdec-bin2llvmir 5415426428750045503\n\nretdec-bin2pat 3642525650883269872\n\nretdec-config 13135068273077306806\n\nretdec-fileinfo 3769837838875367802\n\nretdec-getsig 191060519014405309\n\nretdec-idr2pat 1682585410644922036\n\n\n-----\n\n**Tool** **FNV1A Hash**\n\nretdec-llvmir2hll 7878537243757499832\n\nretdec-macho-extractor 13799353263187722717\n\nretdec-pat2yara 1367627386496056834\n\nretdec-stacofin 12574535824074203265\n\nretdec-unpacker 16990567851129491937\n\nretdec-yarac 8994091295115840290\n\nrundotnetdll 13876356431472225791\n\nsbiesvc 14968320160131875803\n\nscdbg 14868920869169964081\n\nscylla_x64 106672141413120087\n\nscylla_x86 79089792725215063\n\nshellcode_launcher 5614586596107908838\n\nsolarwindsdiagnostics 3869935012404164040\n\nsysmon64 3538022140597504361\n\nsysmon 14111374107076822891\n\ntask explorer 7982848972385914508\n\ntask explorer-x64 8760312338504300643\n\ntcpdump 17351543633914244545\n\ntcpvcon 7516148236133302073\n\ntcpview 15114163911481793350\n\nvboxservice 15457732070353984570\n\nwin32_remote 16292685861617888592\n\nwin64_remotex64 10374841591685794123\n\nwindbg 3045986759481489935\n\nwindump 17109238199226571972\n\n\n-----\n\n**Tool** **FNV1A Hash**\n\nwinhex64 6827032273910657891\n\nwinhex 5945487981219695001\n\nwinobj 8052533790968282297\n\nwireshark 17574002783607647274\n\nx32dbg 3341747963119755850\n\nx64dbg 14193859431895170587\n\nxwforensics 17683972236092287897\n\nxwforensics64 17439059603042731363\n\n### Security Software Avoided\n\n**Vendor** **Process** **FNV1A Hash**\n\nPanda psanhost 2532538262737333146\n\npsuaservice 4454255944391929578\n\npsuamain 6088115528707848728\n\nKaspersky avp 13611051401579634621\n\navpui 18147627057830191163\n\nksde 17633734304611248415\n\nksdeui 13581776705111912829\n\nTanium tanium 7175363135479931834\n\ntaniumclient 3178468437029279937\n\ntaniumdetectengine 13599785766252827703\n\ntaniumendpointindex 6180361713414290679\n\ntaniumtracecli 8612208440357175863\n\ntaniumtracewebsocketclient64 8408095252303317471\n\nAVG/AVAST aswidsagent 2934149816356927366\n\naswidsagenta 13029357933491444455\n\n\n-----\n\n**Vendor** **Process** **FNV1A Hash**\n\naswengsrv 6195833633417633900\n\navastavwrapper 2760663353550280147\n\navgsvc 3660705254426876796\n\navgui 12709986806548166638\n\navgsvca 3890794756780010537\n\navgidsagent 2797129108883749491\n\navgsvcx 3890769468012566366\n\navgwdsvcx 14095938998438966337\n\navgadminclientservice 11109294216876344399\n\nafwserv 1368907909245890092\n\navastui 11818825521849580123\n\navastsvc 8146185202538899243\n\nbccavsvc 16423314183614230717\n\n### Domains Avoided\n\n**Domain** **FNV1A Hash**\n\nswdev.local 1109067043404435916\n\nswdev.dmz 15267980678929160412\n\nlab.local 8381292265993977266\n\nlab.na 3796405623695665524\n\nemea.sales 8727477769544302060\n\ncork.lab 10734127004244879770\n\ndev.local 11073283311104541690\n\ndmz.local 4030236413975199654\n\npci.local 7701683279824397773\n\nsaas.swi 5132256620104998637\n\n\n-----\n\n**Domain** **FNV1A Hash**\n\nlab.rio 5942282052525294911\n\nlab.brno 4578480846255629462\n\napac.lab 16858955978146406642\n\n### Service Disablement List\n\n**Vendor** **Process Names** **Service Names**\n\nCarbon Black cavp carbonblack\n\ncb carbonblackk\n\ncbcomms\n\ncbstream\n\nCrowdStrike csfalconservice csagent\n\ncsfalconcontainer csdevicecontrol\n\ncsfalconservice\n\nFireEye xagt xagt\n\nxagtnotif fe_avk\n\nfekern\n\nfeelam\n\n3320767229281015341 (unknown)\n\nESET ekrn eamonm\n\neguiproxy eelam\n\negui ehdrv\n\nekrn\n\n2589926981877829912 (unknown)\n\nepfwwfp\n\nekbdflt\n\nepfw\n\n\n-----\n\n**Vendor** **Process Names** **Service Names**\n\nF-Secure fsgk32st 17624147599670377042 (unknown)\n\nfswebuid 16066651430762394116 (unknown)\n\nfsgk32 13655261125244647696 (unknown)\n\nfsma32 fsaua\n\nfssm32 fsma\n\nfnrb32 3425260965299690882 (unknown)\n\nfsaua fsbts\n\nfsorsp fsni\n\nfsav32 fsvista\n\n13783346438774742614 (unknown)\n\n2380224015317016190 (unknown)\n\nfses\n\nfsfw\n\nfsdfw\n\nfsaus\n\nfsms\n\nfsdevcon\n\n14243671177281069512 (unknown)\n\n16112751343173365533 (unknown)\n\n## About the Author\n\n### Threat Hunter Team\n\n\n-----\n\n**Symantec**\n\nThe Threat Hunter Team is a group of security experts within Symantec whose mission is to\ninvestigate targeted attacks, drive enhanced protection in Symantec products, and offer\nanalysis that helps customers respond to attacks.\n\n## Want to comment on this post?\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-12-22 - SolarWinds Attacks- Stealthy Attackers Attempted To Evade Detection.pdf"
    ],
    "report_names": [
        "2020-12-22 - SolarWinds Attacks- Stealthy Attackers Attempted To Evade Detection.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536178,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1653779226,
    "ts_modification_date": 1653779226,
    "files": {
        "pdf": "https://archive.orkl.eu/9977ec1b9c001dab5252e0e89624e7a70a998143.pdf",
        "text": "https://archive.orkl.eu/9977ec1b9c001dab5252e0e89624e7a70a998143.txt",
        "img": "https://archive.orkl.eu/9977ec1b9c001dab5252e0e89624e7a70a998143.jpg"
    }
}