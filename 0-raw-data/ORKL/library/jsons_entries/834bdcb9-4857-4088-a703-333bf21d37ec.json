{
    "id": "834bdcb9-4857-4088-a703-333bf21d37ec",
    "created_at": "2022-10-25T16:48:14.745173Z",
    "updated_at": "2025-03-27T02:16:25.751234Z",
    "deleted_at": null,
    "sha1_hash": "612116140e5b452ec1053a6017401f125a8c9375",
    "title": "",
    "authors": "",
    "file_creation_date": "2018-01-12T07:10:39Z",
    "file_modification_date": "2018-01-12T07:10:39Z",
    "file_size": 1031030,
    "plain_text": "(https://securingtomorrow.mcafee.com/)\n\n    \n\n\n#### \n\n\n# North Korean Defectors and Journalists Targeted Using Social Networks and KakaoTalk\n\n[By Jaewon Min (https://securingtomorrow.mcafee.com/author/jaewon-min/) on Jan 11, 2018](https://securingtomorrow.mcafee.com/author/jaewon-min/)\n\n(https://securingtomorrow.mcafee.com/2018/01/)\n\nRecently, South Korean media wrote about North Korean refugees (http://www.newdaily.co.kr/news/article.html?\n\n[no=362555) and journalists (http://www.dailynk.com/korean/m/read.php?cataId=nk00400&num=111620) being targeted](http://www.dailynk.com/korean/m/read.php?cataId=nk00400&num=111620)\n\nby unknown actors using KakaoTalk (a popular chat app in South Korea) and other social network services (such as\n\nFacebook) to send links to install malware on victims’ devices. This method shows that attackers are always looking for\ndi�erent ways to deliver malware.\n\nThe McAfee Mobile Research Team has acquired malicious APK �les that were used in the targeted attacks. According to\nthe articles, Google-shortened URLs were used to spread malware. We analyzed those statistics.\n\n\n-----\n\nThere are two versions of the dropper malware: “북한기도” (Pray for North Korea) and “BloodAssistant” (a health care app).\n\nIn both cases, most clicks originated in South Korea and the most common browser and operating system combination\nwas Chrome and Windows. (Android was the second most common.) The referrers diagram of BloodAssistant shows\n\nFacebook was used in 12% of cases to send the link to its targets.\n\nIn the case of the journalist who was targeted, the attacker sent a shortened link showing a thumbnail of another story\nwritten by the journalist, according to the news article. The link directs to ihoodtec[.]com/upload/newslist[.]php (now\n\no�ine), which seems to be used for redirecting to links in other domains. This shortened URL was clicked by someone with\n\nan account at mail[.]police[.]go[.]kr, suggesting the shortened URL was also sent via email to the police address.\n\nThe number of clicks might not be meaningful because it can include access from malware researchers, but what is\nmeaningful is that malware-download links were spread using di�erent platforms: Facebook, KakaoTalk, email, etc.\n\n\n-----\n\nAll the malicious APK �les (including additional variants) dropped the Trojan on the victim’s device. Although the apps look\n\ndi�erent, the dropper mechanism is identical. The following screens show the execution of the dropper �les.\n\nFigure 1: Screenshots of droppers.\n\nWhen the dropper APK executes, it �rst checks whether the device is already infected. If not infected, it phishes the victim\n\nto turn on the accessibility permission. If the victim clicks the pop-up window, the view changes to the accessibility settings\n\nmenu so the app can acquire the permission.\n\nWhen the accessibility service starts, it overlays the window (by playing a video, for example) to hide the process of turning\n\non required settings and dropping and installing the Trojan. The overlay is removed after the Trojan is installed. The\nfollowing diagram explains the �ow after executing the dropper malware.\n\nFigure 2: Execution �ow of the dropper.\n\nTrojan\n\nThe dropped Trojan uses popular cloud services Dropbox and Yandex as a control server to upload data and receive\n\ncommands. The following diagram explains the execution �ow of the Trojan. The names of broadcast receivers and\n\nservices (with some misspellings) may vary between samples but the execution is the same.\n\n\n-----\n\nFigure 3: Execution �ow of the Trojan.\n\nWhen the dropped Trojan is installed, it saves device information in a temporary folder and uploads it to the cloud. It then\n\ndownloads a �le containing commands and other data to control the infected device. (We’ll explain the format of the\n\ndownloaded �le in the next section.) Most of the malicious behaviors—such as saving SMS, contact information, etc.—are\n\nimplemented inside a separate dex �le “core,” which is downloaded from the control server. This dex �le is referenced in\n\nmany places in the malware. The malicious functionality can be extended, as we’ll explain in the following section.\n\nCommand �le structure\n\nThe command �le has its own format. The following diagram explains the types of values. O�set designators are used to\n\nretrieve each value when parsing the �le. The next table explains each value.\n\nFigure 4: Command �le format.\n\n\n-----\n\nThe handler for command code received from the cloud (CMD value) is implemented as a separate dex �le and is\n\ndownloaded either before or after the malware parses the command �le. This mechanism allows the attacker to easily\nextend its malicious functionality without needing to update the whole malware.\n\nOur analysis shows that only some of the commands are implemented now and uploaded to the cloud control server.\n\nNote Command 12 captures KakaoTalk chat logs.\n\nFigure 6: Implemented commands.\n\n### Variants\n\nWe have found variants of the APKs that news articles initially reported on Google Drive. (The APKs on Google Drive are\nmarked as malware and cannot be downloaded.) Some variants use di�erent cloud services as their control servers while\n\nothers drop the separate call-recording app “com.toh.callrecord” (assets/bbb). The following graph shows the relationships\n\namong variants and dropped �les.\n\n\n-----\n\nInitial malicious APKs we found were uploaded to Google Drive by the same account, and we found a connected social\n\nnetwork account. By following activities of this account, we conclude with high con�dence that this account was used to\n\nsend shortened URLs to victims to get them to download malicious APK �les.\n\nThe group behind this campaign is certainly familiar with South Korean culture, TV shows, drama, and the language\n\nbecause the account names associated with the cloud services are from Korean drama and TV shows, including the\n\nfollowing:\n\nFigure 8: Cloud service accounts.\n\nWe found the use of an interesting word, “피형” (“blood type”), which is not used in South Korea but is used in North Korea.\n\n(“혈액형” is the word for blood type in South Korea.) We also found a North Korean IP address in test log �les of some\nAndroid devices that are connected to accounts used to spread the malware. However, Wi-Fi was on so we cannot exclude\nthe possibility that the IP address is private.\n\nBy looking at the list of deleted folders in the cloud, we found one with the name “sun Team Folder,” possibly the name of\n\nthe actors. This group has been active since 2016, according to the cloud storage creation date.\n\nFigure 9: Deleted folder in the cloud.\n\n### Conclusion\n\nThis malware campaign is highly targeted, using social network services and KakaoTalk to directly approach targets and\n\nimplant spyware. We cannot con�rm who is behind this campaign, and the possible actor Sun Team is not related to any\npreviously known cybercrime groups. The actors are familiar with South Korea and appear to want to spy on North Korean\n\ndefectors, and on groups and individuals who help defectors.\n\nMcAfee Mobile Security detects this malware as Android/HiddenApp.BP. Always keep your mobile security application\nupdated to the latest version, and never install applications from unveri�ed sources. We recommend installing KakaoTalk\nonly from Google Play. These habits will reduce the risk of infection by malware.\n\n Previous Article (https://securingtomorrow.mcafee.com/business/trivial-software-�aws-continue-plague-networkeddevices/)\n\n[ Categories: McAfee Labs (https://securingtomorrow.mcafee.com/category/mcafee-labs/)](https://securingtomorrow.mcafee.com/category/mcafee-labs/)\n\n\n-----\n\n(https://securingtomorrow.mcafee.com/tag/malware/), mobile security\n(https://securingtomorrow.mcafee.com/tag/mobile-security1/)\n\n## Leave a reply\n\nFacebook Comments (0) Comments (0) G+ Comments\n\n## Newsletter Sign Up\n\nFirst Name\n\nLast name\n\nEmail\n\n\nSubscribe\n\n\n## McAfee on Twitter\n\n[ Follow us on Twitter (https://twitter.com/McAfee)](https://twitter.com/McAfee)\n\n[mcafee_labs (https://www.twitter.com/mcafee_labs)](https://www.twitter.com/mcafee_labs)\n\nMore than $15B in pro�ts and $13.8B in damages. Get to know the underground cybercrime market in China.…\n\n[https://t.co/KCFN80UpzC (https://t.co/KCFN80UpzC)](https://t.co/KCFN80UpzC)\n\n1 hour ago (2018/01/12 04:44:05)\n[Reply (https://twitter.com/intent/tweet?in_reply_to=951676132243464192) · Retweet (https://twitter.com/intent/retweet?](https://twitter.com/intent/tweet?in_reply_to=951676132243464192)\n[tweet_id=951676132243464192) · Favorite (https://twitter.com/intent/favorite?tweet_id=951676132243464192)](https://twitter.com/intent/favorite?tweet_id=951676132243464192)\n\n[mcafee_labs (https://www.twitter.com/mcafee_labs)](https://www.twitter.com/mcafee_labs)\n\n[More than 15% of mobile #malware (https://twitter.com/#search?q=malware) was reported in Asia. Explore the](https://twitter.com/#search?q=malware)\n\n[Threats Report infographic to learn more.… https://t.co/CeOtkvuADn (https://t.co/CeOtkvuADn)](https://t.co/CeOtkvuADn)\n\n2 hours ago (2018/01/12 04:05:06)\n[Reply (https://twitter.com/intent/tweet?in_reply_to=951666320470347776) · Retweet (https://twitter.com/intent/retweet?](https://twitter.com/intent/tweet?in_reply_to=951666320470347776)\nt t id 951666320470347776) F it (htt //t itt /i t t/f it ?t t id 951666320470347776)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2018/2018.01.11.North_Korean_Defectors_and_Journalists_Targeted/North_Korean_Defectors_and_Journalists_Targeted.pdf"
    ],
    "report_names": [
        "North_Korean_Defectors_and_Journalists_Targeted"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716494,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1515741039,
    "ts_modification_date": 1515741039,
    "files": {
        "pdf": "https://archive.orkl.eu/612116140e5b452ec1053a6017401f125a8c9375.pdf",
        "text": "https://archive.orkl.eu/612116140e5b452ec1053a6017401f125a8c9375.txt",
        "img": "https://archive.orkl.eu/612116140e5b452ec1053a6017401f125a8c9375.jpg"
    }
}