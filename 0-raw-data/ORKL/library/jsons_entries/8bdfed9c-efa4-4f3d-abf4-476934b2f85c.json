{
    "id": "8bdfed9c-efa4-4f3d-abf4-476934b2f85c",
    "created_at": "2023-01-12T15:10:32.632533Z",
    "updated_at": "2025-03-27T02:05:43.949824Z",
    "deleted_at": null,
    "sha1_hash": "620fce956985dcc7f66197af2ad89093ae6a5b46",
    "title": "2016-06-03 - Cooking Up Autumn (Herbst) Ransomware",
    "authors": "",
    "file_creation_date": "2022-05-28T03:37:47Z",
    "file_modification_date": "2022-05-28T03:37:47Z",
    "file_size": 224940,
    "plain_text": "# Cooking Up Autumn (Herbst) Ransomware\n\n**[blog.fortinet.com/2016/06/03/cooking-up-autumn-herbst-ransomware](https://blog.fortinet.com/2016/06/03/cooking-up-autumn-herbst-ransomware)**\n\nThreat Research\n\n\nJune 3, 2016\n\n\nBy [Rommel Abraham D Joven | June 03, 2016](https://blog.fortinet.com/blog/search?author=Rommel+Abraham+D+Joven)\nFortiguard’s behavior-based system designed to identify new malware has detected a\nGerman targeted ransomware. We named it Herbst, a German word which in English means\nAutumn.\n\n## Ransom Note\n\nThe Herbst ransom note appears in German in a dedicated window from its own running\nprocess. It demands that a ransom be paid in bitcoin. We have also been able to determine\nthe bitcoin address. Ransome note details are listed below:\n\n\n-----\n\nFile encryption: AES 256 bit\n\nRansom Price: 0.1 Bitcoin or approximately USD $53.80 as of today.\n\nBitcoin Address: 18uM9JA1dZgvsgAaeeW2XZK13dTbk1jzWq\n\n_Figure 01: Ransom Note_\n\n## Key Preparation\n\nThe key is prepared by concatenating two random numbers from 0 to 99999999. Next, it\nconcatenates strings in random positions from the text variable, text.length times, as seen\nbelow. This key is hashed later and used as the AES key.\n\n\n-----\n\n_Figure 02: Key Preparation Function_\n\n## Targeted Directories\n\nAfter preparing the key, Herbst proceeds to enumerate files from the StartupPath. It encrypts\nall kinds of files in this directory, as shown by “*.*”.\n\nIt encrypts file in the following special folders:\n\nDesktop, MyPictures, MyMusic, and Personal\n\nFigure 03: File Enumeration\n\n## Encrypted File\n\nThe ransomware encrypts files and appends the extension to .herbst.\n\n\n-----\n\n_Figure 04: Encrypted File Sample_\n\n## File Encryption\n\nThe encryption starts by reading the file and calling the function AES_Encrypt.\n\n_Figure 05: Encryption Function_\n\nThe malware then proceeds to hash the key generated from the previous function, and this is\nused as the AES key for encrypting the files. After the file is encrypted with AES 256 bit, the\nmalware then converts it to Base64String.\n\n_Figure 06: AES Encryption Function_\n\n\n-----\n\n_Figure 07: File Structure Before and After Encryption_\n\n## Unfinished Business\n\nThis malware, written in C#, shows it’s unfinished because it has the following functions, but\nnever calls them in the main function:\n\n_Encrypt – believed to be the function in encrypting the AES key used before sending to_\nthe Command and Control (C&C.)\n\n_Unlock – believed to be the decryption of the incoming traffic from the C&C._\n\n_Http – believed to be used to send and receive encrypted messages to the C&C._\n\n\n-----\n\n_Figure 08: Malware Functions_\n\nYes, the malware encrypts files and shows the decryption note; however,it doesn’t send the\nAES key used to its C&C, and doesn’t verify the transaction ID when used in the ransom\nwindow, making this an unfinished ransomware.\n\n## Conclusion\n\nOur analysis shows that cybercriminals could be cooking a ransomware targeting a German\naudience. From the analysis, we conclude that Herbst is a beta version which is still under\ndevelopment. The malware doesn’t provide any details on its C&Cs because it doesn’t call\nthe HTTP function. We speculate that this version could just be a test to check AV vendors’\nability to detect it without giving away their C&C.\n\nFortiguard will continue to monitor Herbst future activities and developments.\n\nFile detection: W32/Herbst.A!tr\n\nSHA256: 18605f7a5a47ac16f722e3ec8a42121035bb95f731aaad5090c5e11104fc3185\n\n-=FortiGuard Lion Team=\n## Related Posts\n\nCopyright © 2022 Fortinet, Inc. All Rights Reserved\n\n[Terms of ServicesPrivacy Policy](https://www.fortinet.com/corporate/about-us/legal.html)\n| Cookie Settings\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-06-03 - Cooking Up Autumn (Herbst) Ransomware.pdf"
    ],
    "report_names": [
        "2016-06-03 - Cooking Up Autumn (Herbst) Ransomware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536232,
    "ts_updated_at": 1743041143,
    "ts_creation_date": 1653709067,
    "ts_modification_date": 1653709067,
    "files": {
        "pdf": "https://archive.orkl.eu/620fce956985dcc7f66197af2ad89093ae6a5b46.pdf",
        "text": "https://archive.orkl.eu/620fce956985dcc7f66197af2ad89093ae6a5b46.txt",
        "img": "https://archive.orkl.eu/620fce956985dcc7f66197af2ad89093ae6a5b46.jpg"
    }
}