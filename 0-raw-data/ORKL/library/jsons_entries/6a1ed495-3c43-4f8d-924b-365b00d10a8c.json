{
    "id": "6a1ed495-3c43-4f8d-924b-365b00d10a8c",
    "created_at": "2023-01-12T15:08:22.110056Z",
    "updated_at": "2025-03-27T02:09:30.14674Z",
    "deleted_at": null,
    "sha1_hash": "6b399a2e17499548eed137409074479a81f0b6d9",
    "title": "2017-06-09 - MacRansom- Offered as Ransomware as a Service",
    "authors": "",
    "file_creation_date": "2022-05-28T03:37:50Z",
    "file_modification_date": "2022-05-28T03:37:50Z",
    "file_size": 1442420,
    "plain_text": "# MacRansom: Offered as Ransomware as a Service\n\n**[blog.fortinet.com/2017/06/09/macransom-offered-as-ransomware-as-a-service](https://blog.fortinet.com/2017/06/09/macransom-offered-as-ransomware-as-a-service)**\n\nThreat Research\n\n\nJune 9, 2017\n\n\nBy [Rommel Joven and](https://blog.fortinet.com/blog/search?author=Rommel+Joven) [Wayne Chin Yick Low | June 09, 2017](https://blog.fortinet.com/blog/search?author=Wayne+Chin+Yick+Low)\nMany Mac OS users might assume that their computer is exempt from things like\nransomware attacks and think that their system is somehow essentially “secure.” It is true\nthat it’s less likely for a Mac OS user to be attacked or infected by malware than a Windows\nuser, but this has nothing to do with the level of vulnerability in the operating system. It is\nlargely caused by the fact that over 90% of personal computers run on Microsoft Windows\nand only around 6% on Apple Mac OS.\n\n\n-----\n\n[Figure 1: Market share for desktop OS (reference: NetMarketShare)](https://www.netmarketshare.com/operating-system-market-share.aspx?qprid=10&qpcustomd=0)\n\n## MacRansom Portal\n\nJust recently, we here at FortiGuard Labs discovered a Ransomware-as-a-service (RaaS)\nthat uses a web portal hosted in a TOR network which has become a trend nowadays.\nHowever, in this case it was rather interesting to see cybercriminals attack an operating\nsystem other than Windows. And this could be the first time to see RaaS that targets Mac\nOS.\n\n\n-----\n\nFigure 2: TOR portal of MacRansom\n\nThis MacRansom variant is not readily available through the portal. It is necessary to contact\nthe author directly to build the ransomware. At first, we thought of it as a scam since there\nwas no sample but to verify this we dropped the author an email and unexpectedly\nreceived a response.\n\nFigure 3: About Us\n\n\n-----\n\nOn our first email inquiring about the ransomware, we stated our requirements outlined by\nthe author, such as the bitcoin amount for the target to pay, the date when to trigger the\nransomware, and if it was to be executable when someone plugs a USB drive.\n\nWe sent the email around 11AM (GMT+8) and received the first response was around 9PM\nthat same day.\n\n_Response 1: (9PM)_\n\nAgreeing on June 1 as the trigger date, and giving my bitcoin address, the author gladlyst\nsent the sample.\n\n_Response 2: (11AM)_\n\nSince the author replied quite promptly to us, we tried to dig deeper by asking more about\nthe ransomware:\n\n_Response 3: (12 AM)_\n\n\nObserving the time of the responses, it gave us a hint that the author might be in a different\ntime zone since the reply came back late at night (which could be morning for them). Also,\non the first response the author said “June 1 midnight on your local timest ”. They may have\nnoticed the time difference when we emailed them.\n\nTo verify the geolocation of the malware author(s) of this ransomware, we took a look at the\noriginal STMP header and found that the time zone they are in is GMT – 4.\n\n\n-----\n\nFigure 4: SMTP header\n\n## Behavioral Analysis\n\nNext, we began to examine the malware itself. Below are the features that the author\nclaimed for the ransomware. We take a look at the code to see if it conformed with these\nfeatures.\n\nFigure 5: MacRansom Features\n\nRunning the MacRansom sample, a prompt showed up stating the program is from an\nunidentified developer. So as long as users don’t open suspicious files from unknown\ndevelopers, they are safe. Clicking Open gives permission for the ransomware to run.\n\n## Anti-analysis\n\nThe first thing the ransomware does is to check if the sample is being run in a non-Mac\nenvironment or if it is being debugged. If these conditions are not met, the ransomware\nterminates.\n\nIt calls the ptrace or process trace command with the argument PT_DENY_ATTACH to\ncheck and see if the ransomware is attached to a debugger.\n\n\n-----\n\nFigure 6: Ptrace command\n\nSecond, by using the sysctl hw.model command it checks the machine model and\ncompares it to “Mac” string.\n\nFigure 7: Model check\n\nLastly, it checks if the machine has two CPU’s.\n\nFigure 8: Check for logical CPUs\n\n## Launch Point\n\nOnce it has passed its initial checks, the ransomware creates a launch point in\n```\n~/Library/LaunchAgents/com.apple.finder.plist. The filename intentionally\n\n```\nimitates a legitimate file in Mac OS to lessen suspicion of malicious activities. This launch\npoint allows MacRansom to run at every start up and ensure that it encrypts on the specified\n```\ntrigger time.\n\n```\nContents of com.apple.finder:\n\n\n-----\n\nThe original executable is then copied to ~/Library/.FS_Store. Again the filename is\nvery similar to a legitimate file. After the file is copied, the time date stamp is changed by\nusing the command touch -ct 201606071012 '%s'. The manipulation of the time date\nstamp is commonly used to confuse investigators when it comes to digital forensics.\n\nThe ransomware then uses launchctl to load the created com.apple.finder.plist.\n\n## Encryption\n\nAs mentioned, the encryption has a trigger time, which is set by the author. For our\ncase, it was at June 1 2017 at 12am. The ransomware terminates if the date is before this.st\n\nFigure 9: Trigger time check\n\nIf the trigger time is met, the ransomware starts to enumerate the targeted files by using\nthe command shown below. This is an unusual way for a ransomware to enumerate files but\nis still effective since most ransomware traverses directories and includes a list of targeted\nextensions to encrypt.\n\n%s – is the file path of the ransomware\n\n\n-----\n\nFigure 10: File enumeration\n\nThe ransomware only encrypts a maximum of 128 files, returned by the command stated\nabove.\n\nAs with other crypto-ransomware, the encryption algorithm is the core component that we\nspent most of our analysis time on. Our goal was to find any RSA-crypto routine, however\nthis piece of crypto-ransomware is not as sophisticated as other OSX crypto-ransomware\nthat have been previously disclosed. It uses a symmetric encryption with a hardcoded key to\nhijack the victim’s files. There are two sets of symmetric keys used by the ransomware:\n\nReadmeKey: 0x3127DE5F0F9BA796\nTargetFileKey: 0x39A622DDB50B49E9\n\nThe ReadmeKey is used to decrypt ._README_ file that contains the ransom notes and\ninstructions, while the TargetFileKey is used to encrypt and decrypt the victim’s files.\n\nA remarkable thing we observed when reverse-engineering the encryption/decryption\nalgorithm is that the TargetFileKey is permuted with a random generated number. In\nother words, the encrypted files can no longer be decrypted once the malware has\nterminated – the TargetFileKey will be freed from program’s memory and hence it\nbecomes more challenging to create a decryptor or recovery tool to restore the encrypted\nfiles. Moreover, it doesn’t have any function to communicate with any C&C server for the\n```\nTargetFileKey meaning there is no readily available copy of the key to decrypt the files.\n\n```\nHowever, it is still technically possible to recover the TargetFileKey. One of the known\ntechniques is to use a brute-force attack. It should not take very long for a modern CPU to\nbrute-force an 8-byte long key when the same key is used to encrypt known files with\npredictable file’s contents.\n\nNevertheless, we are still skeptical of the author’s claim to be able to decrypt the hijacked\nfiles, even assuming that the victims sent the author an unknown random file, as shown in\nFigure 12 \"Ransom Note,\" which is not entirely true.\n\nPseudo code for the encryption process is as follows:\n\n\n-----\n\nFigure 11: Encryption Routine\n\n\n-----\n\nAfter successfully encrypting the targeted files, it encrypts both com.apple.finder.plist\nand the original executable. It changes the Time Date Stamp and then deletes them. This is\ndone by the author so that even if recovery tools are used to get the ransomware artifacts,\nthe files will be next to meaningless.\n\nThe ransomware demands 0.25 bitcoin (around USD ~700) and requires the victim to\ncontact getwindows@protonmail.com for decryption.\n\nFigure 12: Ransom Note\n\n## Conclusion\n\nIt is not every day that we see new ransomware specifically targeting Mac OS platform. Even\nif it is far inferior from most current ransomware targeting Windows, it doesn’t fail to encrypt\nvictim’s files or prevent access to important files, thereby causing real damage.\n\nLast but not the least, this MacRansom variant is potentially being brewed by copycats as we\nsaw quite a lot of similar code and ideas taken from previous OSX ransomware. Even though\nit utilizes anti-analysis tricks, which differs from previous OSX ransomware, these are wellknown techniques widely deployed by many malware authors. MacRansom is yet another\nexample of the prevalence of the ransomware threat, regardless of the OS platform being\nrun. There are no perfect mitigations against ransomware. However, the impact can be\nminimized by doing regular backups of important files and being cautious when opening files\nfrom unidentified sources or developers.\n\n\n-----\n\n## -= FortiGuard Lion Team =\nAppendix\n\nSamples:\n\na729d54da58ca605411d39bf5598a60d2de0657c81df971daab5def90444bcc3 – Zip\n\nDetected as OSX/MacRansom.A!tr\n\n617f7301fd67e8b5d8ad42d4e94e02cb313fe5ad51770ef93323c6115e52fe98 – Mach-O file\n\nDropped files:\n\n~/LaunchAgent/com.apple.finder.plist\n\n~/Library/.FS_Store\n\nFAQ from the MacRansom portal:\n\n\n-----\n\n_[Sign up for weekly Fortinet FortiGuard Labs Threat Intelligence Briefs and stay on top of the](http://ftnt.net/2iT7Mcp%C2%A0)_\n_newest emerging threats._\n\n### Related Posts\n\nCopyright © 2022 Fortinet, Inc. All Rights Reserved\n\n[Terms of ServicesPrivacy Policy](https://www.fortinet.com/corporate/about-us/legal.html)\n| Cookie Settings\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-06-09 - MacRansom- Offered as Ransomware as a Service.pdf"
    ],
    "report_names": [
        "2017-06-09 - MacRansom- Offered as Ransomware as a Service.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a13b5ca4-fb52-44a9-aa5a-595eca6789ed",
            "created_at": "2022-10-25T15:50:23.4331Z",
            "updated_at": "2025-03-27T02:00:55.46701Z",
            "deleted_at": null,
            "main_name": "Sharpshooter",
            "aliases": [
                "Sharpshooter"
            ],
            "source_name": "MITRE:Sharpshooter",
            "tools": [
                "Rising Sun"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "874ada20-4ca8-4997-9f2e-e3933742d09c",
            "created_at": "2023-01-06T13:46:38.857642Z",
            "updated_at": "2025-03-27T02:00:02.936711Z",
            "deleted_at": null,
            "main_name": "Operation Sharpshooter",
            "aliases": [],
            "source_name": "MISPGALAXY:Operation Sharpshooter",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f32df445-9fb4-4234-99e0-3561f6498e4e",
            "created_at": "2022-10-25T16:07:23.756373Z",
            "updated_at": "2025-03-27T02:02:09.966155Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "APT-C-26",
                "ATK 3",
                "Appleworm",
                "Citrine Sleet",
                "DEV-0139",
                "Diamond Sleet",
                "Gleaming Pisces",
                "Gods Apostles",
                "Gods Disciples",
                "Group 77",
                "Guardians of Peace",
                "Hastati Group",
                "Hidden Cobra",
                "ITG03",
                "Jade Sleet",
                "Labyrinth Chollima",
                "Lazarus Group",
                "NewRomanic Cyber Army Team",
                "Operation 99",
                "Operation AppleJeus",
                "Operation AppleJeus sequel",
                "Operation Blockbuster: Breach of Sony Pictures Entertainment",
                "Operation CryptoCore",
                "Operation Dream Job",
                "Operation Dream Magic",
                "Operation Flame",
                "Operation GhostSecret",
                "Operation In(ter)caption",
                "Operation LolZarus",
                "Operation Marstech Mayhem",
                "Operation No Pineapple!",
                "Operation North Star",
                "Operation Phantom Circuit",
                "Operation Sharpshooter",
                "Operation Ten Days of Rain / DarkSeoul",
                "Operation Troy",
                "SectorA01",
                "Slow Pisces",
                "TA404",
                "TraderTraitor",
                "UNC2970",
                "UNC4034",
                "UNC4736",
                "UNC4899",
                "UNC577",
                "Whois Hacking Team"
            ],
            "source_name": "ETDA:Lazarus Group",
            "tools": [
                "3CX Backdoor",
                "3Rat Client",
                "3proxy",
                "AIRDRY",
                "ARTFULPIE",
                "ATMDtrack",
                "AlphaNC",
                "Alreay",
                "Andaratm",
                "AngryRebel",
                "AppleJeus",
                "Aryan",
                "AuditCred",
                "BADCALL",
                "BISTROMATH",
                "BLINDINGCAN",
                "BTC Changer",
                "BUFFETLINE",
                "BanSwift",
                "Bankshot",
                "Bitrep",
                "Bitsran",
                "BlindToad",
                "Bookcode",
                "BootWreck",
                "BottomLoader",
                "Brambul",
                "BravoNC",
                "Breut",
                "COLDCAT",
                "COPPERHEDGE",
                "CROWDEDFLOUNDER",
                "Castov",
                "CheeseTray",
                "CleanToad",
                "ClientTraficForwarder",
                "CollectionRAT",
                "Concealment Troy",
                "Contopee",
                "CookieTime",
                "Cyruslish",
                "DAVESHELL",
                "DBLL Dropper",
                "DLRAT",
                "DRATzarus",
                "DRATzarus RAT",
                "Dacls",
                "Dacls RAT",
                "DarkComet",
                "DarkKomet",
                "DeltaCharlie",
                "DeltaNC",
                "Dembr",
                "Destover",
                "DoublePulsar",
                "Dozer",
                "Dtrack",
                "Duuzer",
                "DyePack",
                "ECCENTRICBANDWAGON",
                "ELECTRICFISH",
                "Escad",
                "EternalBlue",
                "FALLCHILL",
                "FYNLOS",
                "FallChill RAT",
                "Farfli",
                "Fimlis",
                "FoggyBrass",
                "FudModule",
                "Fynloski",
                "Gh0st RAT",
                "Ghost RAT",
                "Gopuram",
                "HARDRAIN",
                "HIDDEN COBRA RAT/Worm",
                "HLOADER",
                "HOOKSHOT",
                "HOPLIGHT",
                "HOTCROISSANT",
                "HOTWAX",
                "HTTP Troy",
                "Hawup",
                "Hawup RAT",
                "Hermes",
                "HotCroissant",
                "HotelAlfa",
                "Hotwax",
                "HtDnDownLoader",
                "Http Dr0pper",
                "ICONICSTEALER",
                "Joanap",
                "Jokra",
                "KANDYKORN",
                "KEYMARBLE",
                "Kaos",
                "KillDisk",
                "KillMBR",
                "Koredos",
                "Krademok",
                "LIGHTSHIFT",
                "LIGHTSHOW",
                "LOLBAS",
                "LOLBins",
                "Lazarus",
                "LightlessCan",
                "Living off the Land",
                "MATA",
                "MBRkiller",
                "MagicRAT",
                "Manuscrypt",
                "Mimail",
                "Mimikatz",
                "Moudour",
                "Mydoom",
                "Mydoor",
                "Mytob",
                "NACHOCHEESE",
                "NachoCheese",
                "NestEgg",
                "NickelLoader",
                "NineRAT",
                "Novarg",
                "NukeSped",
                "OpBlockBuster",
                "PCRat",
                "PEBBLEDASH",
                "PLANKWALK",
                "POOLRAT",
                "PSLogger",
                "PhanDoor",
                "Plink",
                "PondRAT",
                "PowerBrace",
                "PowerRatankba",
                "PowerShell RAT",
                "PowerSpritz",
                "PowerTask",
                "Preft",
                "ProcDump",
                "Proxysvc",
                "PuTTY Link",
                "QUICKRIDE",
                "QUICKRIDE.POWER",
                "Quickcafe",
                "QuiteRAT",
                "R-C1",
                "ROptimizer",
                "Ratabanka",
                "RatabankaPOS",
                "Ratankba",
                "RatankbaPOS",
                "RawDisk",
                "RedShawl",
                "Rifdoor",
                "Rising Sun",
                "Romeo-CoreOne",
                "RomeoAlfa",
                "RomeoBravo",
                "RomeoCharlie",
                "RomeoCore",
                "RomeoDelta",
                "RomeoEcho",
                "RomeoFoxtrot",
                "RomeoGolf",
                "RomeoHotel",
                "RomeoMike",
                "RomeoNovember",
                "RomeoWhiskey",
                "Romeos",
                "RustBucket",
                "SHADYCAT",
                "SHARPKNOT",
                "SIGFLIP",
                "SIMPLESEA",
                "SLICKSHOES",
                "SORRYBRUTE",
                "SUDDENICON",
                "SUGARLOADER",
                "SheepRAT",
                "SierraAlfa",
                "SierraBravo",
                "SierraCharlie",
                "SierraJuliett-MikeOne",
                "SierraJuliett-MikeTwo",
                "SimpleTea",
                "SimplexTea",
                "SmallTiger",
                "Stunnel",
                "TAINTEDSCRIBE",
                "TAXHAUL",
                "TFlower",
                "TOUCHKEY",
                "TOUCHMOVE",
                "TOUCHSHIFT",
                "TOUCHSHOT",
                "TWOPENCE",
                "TYPEFRAME",
                "Tdrop",
                "Tdrop2",
                "ThreatNeedle",
                "Tiger RAT",
                "TigerRAT",
                "Trojan Manuscript",
                "Troy",
                "TroyRAT",
                "VEILEDSIGNAL",
                "VHD",
                "VHD Ransomware",
                "VIVACIOUSGIFT",
                "VSingle",
                "ValeforBeta",
                "Volgmer",
                "Vyveva",
                "W1_RAT",
                "Wana Decrypt0r",
                "WanaCry",
                "WanaCrypt",
                "WanaCrypt0r",
                "WannaCry",
                "WannaCrypt",
                "WannaCryptor",
                "WbBot",
                "Wcry",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "WinorDLL64",
                "Winsec",
                "WolfRAT",
                "Wormhole",
                "YamaBot",
                "Yort",
                "ZetaNile",
                "concealment_troy",
                "http_troy",
                "httpdr0pper",
                "httpdropper",
                "klovbot",
                "sRDI"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536102,
    "ts_updated_at": 1743041370,
    "ts_creation_date": 1653709070,
    "ts_modification_date": 1653709070,
    "files": {
        "pdf": "https://archive.orkl.eu/6b399a2e17499548eed137409074479a81f0b6d9.pdf",
        "text": "https://archive.orkl.eu/6b399a2e17499548eed137409074479a81f0b6d9.txt",
        "img": "https://archive.orkl.eu/6b399a2e17499548eed137409074479a81f0b6d9.jpg"
    }
}