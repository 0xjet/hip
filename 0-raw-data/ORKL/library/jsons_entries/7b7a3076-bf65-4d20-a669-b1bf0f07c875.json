{
    "id": "7b7a3076-bf65-4d20-a669-b1bf0f07c875",
    "created_at": "2023-01-12T14:59:34.776737Z",
    "updated_at": "2025-03-27T02:12:16.165796Z",
    "deleted_at": null,
    "sha1_hash": "2ab9f2ed4b55aeba5a2a3dc43682b7bd7d2f4729",
    "title": "2015-05-18 - Cmstar Downloader- Lurid and Enfal’s New Cousin",
    "authors": "",
    "file_creation_date": "2022-05-28T00:32:46Z",
    "file_modification_date": "2022-05-28T00:32:46Z",
    "file_size": 253216,
    "plain_text": "# Cmstar Downloader: Lurid and Enfal's New Cousin\n\n**[researchcenter.paloaltonetworks.com/2015/05/cmstar-downloader-lurid-and-enfals-new-cousin/](https://researchcenter.paloaltonetworks.com/2015/05/cmstar-downloader-lurid-and-enfals-new-cousin/)**\n\nRobert Falcone May 18, 2015\n\nBy [Robert Falcone](https://unit42.paloaltonetworks.com/author/robertfalcone/)\n\nMay 18, 2015 at 3:01 PM\n\n[Category: Malware,](https://unit42.paloaltonetworks.com/category/malware-2/) [Threat Prevention,](https://unit42.paloaltonetworks.com/category/threat-prevention-2/) [Unit 42](https://unit42.paloaltonetworks.com/category/unit42/)\n\nTags: [AutoFocus,](https://unit42.paloaltonetworks.com/tag/autofocus/) [cmstar,](https://unit42.paloaltonetworks.com/tag/cmstar/) [enfal,](https://unit42.paloaltonetworks.com/tag/enfal/) [lurid,](https://unit42.paloaltonetworks.com/tag/lurid/) [spearphishing](https://unit42.paloaltonetworks.com/tag/spearphishing/)\n\nIn recent weeks, Unit 42 has been analyzing delivery documents used in spear-phishing\nattacks that drop a custom downloader used in cyber espionage attacks. This specific\ndownloader, Cmstar, is associated with the Lurid downloader also known as ‘Enfal’. Cmstar\nwas named for the log message ‘CM**’ used by the downloader.\n\nUnit 42 is aware of threat actors using two toolkits - MNKit and the Tran Duy Linh toolkit - to\nproduce malicious documents that exploit CVE-2012-0158 in order to implant Cmstar. The\nCmstar downloader itself has several unique and interesting features, as well as substantial\ninfrastructure overlap with other tools worth discussing.\n\n## Manual Building of Import Address Table\n\nThe Cmstar downloader starts by manually building its import address table (IAT), much like\nshellcode would; however, it uses a rather unique technique. Instead of finding API function\nnames based on their hashed values, this malware enumerates libraries' export address\ntable (EAT) and searches for the name of the API function the payload needs to load by\nusing a character to offset array. The payload pairs several comma-separated lists of\ncharacters with comma-separated lists of numbers. Each list of characters consists of the set\nfound within the API function name the payload seeks to add to its IAT, while the\ncorresponding list of numbers specifies the offset in the function name where those\ncharacters should be placed. For example, if the payload has \"D,e,A\" paired with \"0,5,19\",\nthis results in the following mapping:\n\n\"D\" at offset 0 in API function name\n\"e\" at offset 5 in API function name\n\"A\" at offset 19 in API function name\n\nThe payload loads a specific Windows library's EAT by calling the\nImageDirectoryEntryToData API function using the IMAGE_DIRECTORY_ENTRY_EXPORT\nflag It then enumerates the library's EAT to find exported function names by checking each\n\n\n-----\n\nfunction name for the character and the specific offset. Once found, the payload adds the\naddress for the specific API function to its IAT. For instance, the payload checks the EAT of\n\"wininet.dll\" using the comparisons mentioned above to find the address to the\n\"DeleteUrlCacheEntryA\" API function. One specific Cmstar payload that we analyzed used\nthe character/offsets seen in Figure 1 to locate the API functions within three different\nWindows libraries to build its IAT.\n\n**Library** **Characters** **Offsets** **Function Name**\n\nwininet.dll D,e,A 0,5,19 DeleteUrlCacheEntryA\n\ne,O,A 3,8,12 InternetOpenA\n\ne,C,A 3,8,15 InternetConnectA\n\np,O,A 3,4,15 HttpOpenRequestA\n\np,S,A 3,4,15 HttpSendRequestA\n\np,E,A 3,4,14 HttpEndRequestA\n\np,Q,A 3,4,13 HttpQueryInfoA\n\ne,R,e 3,8,15 InternetReadFile\n\ne,C,e 3,8,18 InternetCloseHandle\n\nadvapi32.dll S,V,A 3,6,13 RegSetValueExA\n\nC,s,y 3,6,10 RegCloseKey\n\nO,K,A 3,7,12 RegOpenKeyExA\n\nD,K,A 3,9,12 RegDeleteKeyA\n\nD,V,A 3,9,14 RegDeleteValueA\n\nU,r,A 3,6,11 GetUserNameA\n\nv,t,S 3,6,12 ConvertSidToStringSidA\n\nk,A,A 3,6,17 LookupAccountNameA\n\nkernel32.dll W,E,c 0,3,6 WinExec\n\nC,M,A 0,10,17 CreateFileMappingA\n\nU,V,e 0,5,14 UnmapViewOfFile\n\nM,O,e 0,7,12 MapViewOfFile\n\n\n-----\n\n**Figure 1. Character and Offset Pairs Found in Cmstar Payload and the Resulting API**\nFunction Names\n\n## Cmstar Behavior\n\nAfter manually creating the IAT, Cmstar decrypts its configuration, several encrypted strings,\nand a piece of shellcode. The embedded configuration contains nothing more than a URL\nthat Cmstar uses as its command and control (C2) location. The encrypted strings within the\nTrojan include fields used within the HTTP requests that Cmstar will create to communicate\nwith its C2 server, as well as additional strings used to interact with the registry. The Cmstar\nsample associated with the MNKIT delivery document creates the following registry key to\nautomatically execute at system startup:\n\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\xpsfiltsvcs: \"rundll32.exe\nC:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp\\xpsfiltsvcs.dll,XpsRegisterServer\"\n\nUnit 42 found an additional encrypted registry key that would allow Cmstar to automatically\nstart up after reboots. However, the code does not decrypt, reference, or use the following\nregistry key in any way, which suggests that the malware author left this artifact in the code\nafter swapping to the run key listed above:\n\nHKCU\\Software\\Microsoft\\CTF\\LangBarAddIn\n\nCmstar also decrypts a 752-byte piece of shellcode that carries out communications with the\nC2 server, specifically by sending HTTP POST requests to the following URL:\n\nhttp://happy.launchtrue[.]com:8080/cgl-bin/update.cgi\n\nIt should be noted that the C2 URL contains the string ‘cgl-bin’, which visually resembles the\ncommon cgi-bin folder used by many webservers to run server-side scripts. Unit 42 used the\nPalo Alto Networks AutoFocus threat intelligence service to locate additional samples using\nthe ‘cgl-bin’ string within URLs of HTTP requests and found several samples of the Cmwhite\ntool associated with the LURID/Enfal downloader, as seen in Figure 2.1\n\n\n-----\n\n**Figure 2. Cmwhite Tools Using \"cgl-bin\" within HTTP Requests**\n\nCmstar’s HTTP POST requests sent to ‘happy.launchtrue[.]com’ contain data that the Trojan\ngathers from the infected machine that has the following structure:\n\n_<Windows Version number>@@<CPU Architecture (2 for x64, 1 for x86)>??<boolean for_\n_elevated privileges>]]**<boolean if antivirus processes are found>!!<static version string>==_\n\nIn one example, Unit 42 observed the following data within an analysis environment, which\nwas then encrypted using a single-byte XOR algorithm and a key of 0x45 before being sent\nto the C2 server:\n\n_510@@1??1]]**0!!150316o==_\n\nHelpfully, the malware author writes log messages to the ‘DF64159.TMP’ file, used for\ndebugging purposes throughout the execution of the Cmstar downloader. The log messages\nare abbreviated strings that describe specific activities during the execution of the code. For\ninstance, the downloader uses the CreateMutex to create a mutex named ‘{53A4988C-F91F4054-9076-220AC5EC03F3}’ to determine if another instance of the code is running. If the\ndownloader determines another instance of itself is running, the code writes the string ‘CM**’\n\n- which happens to be the basis for the name of the Trojan - to the log file. Unit 42 created a\nYara signature to detect Cmstar samples based on these debugging strings, which is\navailable in the appendix.\n\n\n-----\n\n## Hashing Process Names\n\nAs mentioned in the behavioral analysis section, the Cmstar downloader gathers systemspecific information to send to the C2 server. One such piece of information is the existence\nof specific running processes. Many malware families and tools check for the existence of\nantivirus, but the Cmstar tool does so in a clever way. Rather than including a list of strings of\nassociated processes, Cmstar enumerates the running processes and subjects these\nprocess names to a hashing algorithm. The results of this algorithm are then compared\nagainst three static values: 0x1E00AFA, 0xBEE091E8 and 0xD46FCDFA. Unit 42 reverse\nengineered the algorithm and created the function seen below to generate hashes in order to\ndetermine the processes Cmstar is trying to find:\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\ndef hashStr(st):\n\nhash = 0\n\ncount = 0\n\nwhile count < len(st):\n\nh1 = (hash<<0x13)&0xFFFFFFFF\n\nh2 = (hash>>0x0d)&0xFFFFFFFF\n\nh3 = (h1|h2)&0xFFFFFFFF\n\nhash = (h3 + (ord(st[count])^0x4a))&0xFFFFFFFF\n\ncount += 1\n\nreturn hash\n\n\nUnit 42 found that the string ‘avp’ subjected to the algorithm above results in the value\n0x1E00AFA, which suggests the Cmstar sample specifically looks for Kaspersky's Anti-virus\nproduct (avp.exe) running on the compromised system. If the Trojan finds processes whose\nhash matches the three values mentioned earlier, it sets a boolean value (the character ‘1’)\nwithin the data sent to the C2 server and continues carrying out its functionality. Rather than\naltering its activities, Cmstar only notifies the C2 server if a system is running one of these\nprocesses, suggesting that the threat actors might employ this technique as a filtering\nmechanism to ignore analysis systems and researchers.\n\n## Threat Infrastructure\n\n\n-----\n\nIn order to determine the intrusion set involved with the Cmstar, Unit 42 enumerated\ninfrastructure used by the downloader for its C2 servers. The related infrastructure chart in\nFigure 3 shows a rather large cluster of related entities with one small set of entities that do\nnot share any related entities with the larger cluster.\n\n**Figure 3. Infrastructure and Entites Related to Cmstar**\n\nAs seen in the chart above, the C2 domain ‘happy.launchtrue[.]com’ was originally registered\nusing the email address ‘WANGMINGHUA6@GMAIL[.]COM’. When Unit 42 used the Palo\nAlto Networks AutoFocus threat intelligence service to locate additional Cmstar samples, we\nfound several with C2 domains that also had the same original registrant:\n\nlinks.dogsforhelp[.]com\nthree.earewq[.]com\nquestion.eboregi[.]com\nhere.pechooin[.]com\nsarey.phdreport[.]com\nbakler.featurvoice[.]com\n\nThe only known Cmstar C2 domain not initially registered by the email address was\nhelp.ubxpi0s[.]com. Further analysis revealed that additional domains related to Cmstar C2\ndomains were also originally registered using the email address\n\n\n-----\n\nWANGMINGHUA6@GMAIL[.]COM and updated to the current information within a few\ndays. In addition, this was the original registrant for C2 domain used in our Google Code\nblog, indicating this registrant email is likely a re-seller, and/or someone who initially sets up2\ninfrastructure for particular APT threat actors.\n\nforever.cowforhelp[.]com\nquestion.shiesiido[.]com\nendline.biortherm[.]com\nright.marubir[.]com\nbaby.brabbq[.]com\nlind.kruptcy[.]com\n\nThe rest of the domains related to the Cmstar infrastructure did not use the original registrant\nnoted above, but instead kept the same information initially used to register them. The\ndifference in domain registration patterns could indicate threat actor preference, or could\nindicate there are at least two groups using this malware whose infrastructure at times\noverlaps.\n\nunder.suttgte[.]com\nhelp.ubxpi0s[.]com\nfinally.basiccompare[.]com\ncrystal.diskfunc[.]com\nqueenfansclub[.]com\nnovnitie[.]com\nflash-vip[.]com\nreplyfunt[.]com\nnatcongress[.]com\nkeep.regebky[.]com\nlove.regebky[.]com\n\nInterestingly, the updated registrant information (or original, in the cases where it wasn’t\nchanged) for all of the C2 domains in this blog has also been used to register scam sites,\nmost purporting to sell knock-off designer products like shoes, software, or cell phones. The\ncontact emails and contact names can vary, but the address is re-used. Blue Coat noted this\npattern as well in a blog published late last year, which also noted the\n‘WANGMINGHUA6@GMAIL[.]COM’ registrant email. It is not known whether the threat3\nactors conducting the malicious activity are also behind the scam sites.\n\n## Conclusion\n\nThe Cmstar tool has several interesting features, including a previously unseen method of\nmanually creating its import address table using an API function name character to offset\nmapping techniques, and a hashing algorithm used to find antivirus processes on an infected\n\n\n-----\n\nsystem. Both of these features are noteworthy and may provide the ability to correlate future\ntools to the same group and/or malware authors.\n\nThe URL used by Cmstar to communicate with its C2 server, as well as significant\ninfrastructure overlap, show a direct relationship between the Cmstar downloader,\nLurid/Enfal and Cmwhite tools. In a majority of the cases, threat actors using the Cmstar\ndownloader initially register the C2 domains using the email address\n‘WANGMINGHUA6@GMAIL[.]COM’ and later change the registration information to include\na different email address. Unit 42 cannot positively confirm that the threat actors control the\n‘WANGMINGHUA6@GMAIL[.]COM’ email address, or if the email address belongs to a\nreseller that the threat actors buy domains from to create their infrastructure; however, we do\nbelieve this is an interesting TTP worth tracking in future infrastructure enumeration.\n\n1. THE “LURID”DOWNLOADER - Nart Villeneuve and David Sancho \n[http://la.trendmicro.com/media/misc/lurid-downloader-enfal-report-en.pdf](http://la.trendmicro.com/media/misc/lurid-downloader-enfal-report-en.pdf)\n[2. Attacks on East Asia using Google Code for Command and Control – Jen Miller-](https://blog.paloaltonetworks.com/2014/08/attacks-east-asia-using-google-code-command-control/)\n\nOsborn and Rob Downs -- https://blog.paloaltonetworks.com/2014/08/attacks-eastasia-using-google-code-command-control/\n3. Linking APTs from 2011 and 2014 to an Active Scam Network – Kiel Wadner\n\n    - https://www.bluecoat.com/security-blog/2014-10-08/linking-apts-2011-and-2014active-scam-network\n\n## Appendix\n\n**Known Cmstar Downloaders**\n\nFilename: xpsfiltsvcs.tmp\n\nSHA256: 239a25ac2b38f0be9392ceeaeab0d64cb239f033af07ed56565ba9d6a7ddcf1f\n\nC2: links.dogsforhelp.com\n\nFilename: xpsfiltsvcs.tmp\n\nSHA256: 6b557c22ab12e8ea43d29e4f9f8a9483e3e75cd41338a674c9069b6dacdf7ba7\n\nC2: question.eboregi.com\n\nFilename: xpsfiltsvcs.tmp\n\nSHA256: 7ade616a8f1750cecba944a02e2bce1340b18a55697b29f721ccc4701aadba6e\n\nC2: links.dogsforhelp.com\n\nFilename: xpsfiltsvcs.tmp\n\nSHA256: 88184983733f4d4fa767ad4e7993b01c5754f868470dd78ac1bad2b02c9e5001\n\nC2: here.pechooin.com\n\nFilename: xpsfiltsvcs.tmp\n\nSHA256: b9d597aea53023727d8564e47e903b652f5e98a2c32bdc23bc4936448fb2d593\n\nC2: question eboregi com\n\n\n-----\n\nFilename: xpsfiltsvcs.tmp\nSHA256: e0b3cc07d3a9b509480b240368dee2a29713ea1e240674c0ccf610c84810a7c5\nC2: question.eboregi.com\n\nFilename: xpsfiltsvcs.txt\nSHA256: f4b8f71c0e10a345a855763e01033e2144e949c8f98c271755cc025e3f55b7da\nC2: three.earewq.com\n\nFilename: xpsfiltsvcs.tmp\nSHA256: 2e00a98212c5a2015d12612f0d26039a0c2dfee3e1b384675f613e683f276e02\nC2: bakler.featurvoice.com\n\nFilename: xpsfiltsvcs.dll\nSHA256: 42ed2edc37b957266ff7b02955a007dd82d955c09ef7be23e685d938e40ad61d\nC2: turber.xoxcobbs.com\n\nFilename: xpsfiltsvcs.dll\nSHA256: 9b9cc7e2a2481b0472721e6b87f1eba4faf2d419d1e2c115a91ab7e7e6fc7f7c\nC2: happy.launchtrue.com\n\nFilename: xpsfiltsvcs.tmp\nSHA256: a330c52b7643de9d8be51a4ae0150b7b8390dbabaea9704069694835fbd3298e\nC2: three.earewq.com\n\nFilename: xpsfiltsvcs.tmp\nSHA256: a8fa487d9f2152738bf49c8c69e8a147aae55c06f37c7e25026a28f21601ad7f\nC2: sarey.phdreport.com\n\nFilename: xpsfiltsvcs.tmp\nSHA256: c99c0b37f2fd64fa523d39c35ead6416a684ae203ae728feb5feff8490eb902c\nC2: help.ubxpi0s.com\n\nFilename: xpsfiltsvcs.tmp\nSHA256: d541280b37dd5e2101cc5cd47b0991b8320714f5627b37646330136cddef0c23\nC2: three.earewq.com\n\nFilename: coyote_load.dll\nSHA256: adb05c1eecd789582886b3354b53831df9c9a06e891bb687633ee7ce21417edc\nC2: bakler.featurvoice.com\n\n**Delivery Documents Installing Cmstar**\n\nFilename: Какая реформа армии нужна Украине.doc (What is needed reform of the army\nUkraine.doc)\n\nMD5: 76ffb9c2d8d0ae46e8ea792ffacc8018\n\nSHA256: c26c67eac20614038aaadfda19b604862926433333893d65332928b5e36796aa\n\n\n-----\n\nType: MIME entity text\nToolkit: MNKit\nAuthor: User123\nLast Saved By: User123\nCreated: 2012-05-01T14:08:00Z\nModified: 2012-05-01T14:12:00Z\n\nFilename: запуск ракеты-носителя Союз.doc (launch of the carrier rocket Soyuz.doc)\nMD5: 6fdeadacfe1dafd2293ce5c4e178b668\nSHA256: e39b0e777ef0135c1f737b67988df70c2e6303c3d2b01d3cdea3efc1d03d9ad9\nType: Microsoft Office Word 97-2003 Document\nToolkit: Tran Duy Linh\nCreated: 2012:11:23 04:35:00\nModified: 2012:11:23 04:39:00\nCompany: DLC Corporation\n\nFilename: РФ_КНР_сельское_хозяйство.doc (RF China Agriculture and Economy.doc)\nMD5: 9da10a36daf845367e0fc2f3e7e54336\nSHA256: a0aeb172a72442d2c2c02e1d32b48accb9975c4da7742df24d9350a8ccd401f2\nType: Microsoft Office Word 97-2003 Document\nToolkit: Tran Duy Linh\nCreated: 2012:11:23 04:35:00\nModified: 2012:11:23 04:39:00\nCompany: DLC Corporation\n\nFilename: Ерөнхий сайд асан Н.Алтанхуягийг шалгаж эхэлжээ.doc (Former Prime\nMinister started to check with their lethargy.doc)\nMD5: f7d47e1de4f5f4ad530bca0fc080ea53\nSHA256: 4883286b8229a2c43db17eb1e1c5bd79d1933e840cdfedff80d5b99a84c9e39f\nType: Microsoft Office Word 97-2003 Document\nToolkit: Tran Duy Linh\nCreated: 2012:11:23 04:35:00\nModified: 2012:11:23 04:39:00\nCompany: DLC Corporation\n\nFilename: запуск ракеты-носителя Союз.doc (launch of the carrier rocket Soyuz.doc)\nMD5: 6fdeadacfe1dafd2293ce5c4e178b668\nSHA256: e39b0e777ef0135c1f737b67988df70c2e6303c3d2b01d3cdea3efc1d03d9ad9\nType: Microsoft Office Word 97-2003 Document\nToolkit: Tran Duy Linh\nCreated: 2012:11:23 04:35:00\nModified: 2012:11:23 04:39:00\nCompany: DLC Corporation\n\n\n-----\n\nMD5: 5aeb8a5aa8f6e2408016cbd13b3dfaf0\nSHA256: df34aa9c8021f1f0bdf33249908efc4a9628941453ad79b281b3a46bf9a7f37f\nType: Microsoft Office Word 97-2003 Document\nToolkit: Tran Duy Linh\nCreated: 2012:11:23 04:35:00\nModified: 2012:11:23 04:39:00\nCompany: DLC Corporation\n\nFilename: Путины урилга.doc (Putin’s invitation.doc)\nSHA256: 45027d11ab783993c413f97e8e29759d04b04564f8916f005f5c632f291697bb\nType: Microsoft Office Word 97-2003 Document\nToolkit: Tran Duy Linh\nCreated: 2012:11:23 04:35:00\nModified: 2012:11:23 04:39:00\nCompany: DLC Corporation\n\nMD5: 46bf922d9ae07a9bc3667a374605bdbb\nSHA256: 7dc78caf515d1d3d2b84be7c023ccbd0b4fd670a42babcbcbd5a5ba65bbdd166\nType: Microsoft Office Word 97-2003 Document\nToolkit: Tran Duy Linh\nCreated: 2012:11:23 04:35:00\nModified: 2012:11:23 04:39:00\nCompany: DLC Corporation\n\nFilename: Армия-2015.doc (Army-2015.doc)\nMD5: 783a423f5e285269126d0d98f53c795b\nSHA256: 5b338decffe665a2141d1079c32b2d612057d1fdbfddf198cc28003dae7f0516\nType: Microsoft Office Word 97-2003 Document\nToolkit: Tran Duy Linh\nCreated: 2012:11:23 04:35:00\nModified: 2012:11:23 04:39:00\nCompany: DLC Corporation\n\nFilename: С днём 70 лет победы.doc (Happy 70 years of victory.doc)\nMD5: 510b3272342765743a202373261c08da\nSHA256: 0a10d7bb317dceccd05d18408fd6b8b12c784910e5f7e035ee22c2c5d7e4cbf5\nType: Microsoft Office Word 97-2003 Document\nToolkit: Tran Duy Linh\nCreated: 2012:11:23 04:35:00\nModified: 2012:11:23 04:39:00\nCompany: DLC Corporation\n\n\n-----\n\nFilename: new resume.doc\nMD5: c5ae7bd6aec1e01aa53edcf41962ac04\nSHA256: 87bcc6d18c6a81d92d826b232703dee84b522bd1d0cae56f74bcf58fdca0930e\nType: Microsoft Office Word 97-2003 Document\nToolkit: Tran Duy Linh\nCreated: 2012:11:23 04:35:00\nModified: 2012:11:23 04:39:00\nCompany: DLC Corporation\n\nMD5: 3d41e3c902502c8b0ea30f5947307d56\nSHA256: b65dd4da9f83c11fcb5beaec43fabd0df0f7cb61de94d874f969ca926e085515\nType: Microsoft Office Word 97-2003 Document\nToolkit: Tran Duy Linh\nCreated: 2012:11:23 04:35:00\nModified: 2012:11:23 04:39:00\nCompany: DLC Corporation\n\nFilename: Центр-2015.doc (Center-2015.doc)\nMD5: 94499ff857451ab7ef8823bf067189e7\nSHA256: 671dfc4d47a43cf0bd9205a0f654dcd5050175aef54b69388b0c5f4610896c6a\nType: Microsoft Office Word 97-2003 Document\nToolkit: Tran Duy Linh\nCreated: 2012:11:23 04:35:00\nModified: 2012:11:23 04:39:00\nCompany: DLC Corporation\nRelated Cmwhite Tools\n\nMD5: 3fff0bf6847d0d056636caef9c3056c3\nSHA256: 13c1d7eb2fd64591e224dec9534d8252f4b91e425e8f047b36605138d15cbf2d\nC2: stone.timmf.com\n\nMD5: 30a6c3c7723fe14c4b6960fa3e4e57ba\nSHA256: ab934c6177be0fdc3b6dfbf21f60ce7837a30e6599dcfb111b43008c75ceb91f\nC2: xphome.mailru-vip.com\nC2: error.yandex-pro.com\n\nMD5: e0417547ba54b58bb2c8f795bca0345c\nSHA256: 1cf44815f9eb735e095f68c929d5549e0ebc44af9988cccaf1852baeb96bb386\nC2: dns.thinkttun.com\n\nMD5: d05f012c9c1a7fb669a07070be821072\nSHA256: a37f337d0bc3cebede2039b0a3bd5afd0624e181d2dcc9614d2f7d816b5a7a6b\nC2: help.redhag.com\n\n\n-----\n\nC2: mssage.hotoicq.com\nC2: new.hoticq.com\n\n**Cmstar Yara Rule**\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n\n\nrule ce_enfal_cmstar_debug_msg\n\n{\n\nmeta:\n\nauthor = \"rfalcone\"\n\ndescription = \"Detects the static debug strings within CMSTAR\"\n\nreference =\n\"9b9cc7e2a2481b0472721e6b87f1eba4faf2d419d1e2c115a91ab7e7e6fc7f7c\"\n\ndate = \"5/10/2015\"\n\nstrings:\n\n$d1 = \"EEE\\x0d\\x0a\" fullword\n\n$d2 = \"TKE\\x0d\\x0a\" fullword\n\n$d3 = \"VPE\\x0d\\x0a\" fullword\n\n$d4 = \"VPS\\x0d\\x0a\" fullword\n\n$d5 = \"WFSE\\x0d\\x0a\" fullword\n\n$d6 = \"WFSS\\x0d\\x0a\" fullword\n\n$d7 = \"CM**\\x0d\\x0a\" fullword\n\ncondition:\n\nuint16(0) == 0x5a4d and all of ($d*)\n\n}\n\n\n**Get updates from**\n\n**Palo Alto**\n\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n\n-----\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\nStatement.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2015/2015-05-18 - Cmstar Downloader- Lurid and Enfal’s New Cousin.pdf"
    ],
    "report_names": [
        "2015-05-18 - Cmstar Downloader- Lurid and Enfal’s New Cousin.pdf"
    ],
    "threat_actors": [
        {
            "id": "7c8cf02c-623a-4793-918b-f908675a1aef",
            "created_at": "2023-01-06T13:46:38.309165Z",
            "updated_at": "2025-03-27T02:00:02.801298Z",
            "deleted_at": null,
            "main_name": "APT15",
            "aliases": [
                "BRONZE PALACE",
                "Nylon Typhoon",
                "VIXEN PANDA",
                "Playful Dragon",
                "BRONZE DAVENPORT",
                "BRONZE IDLEWOOD",
                "G0004",
                "Red Vulture",
                "Ke3Chang",
                "Metushy",
                "Lurid",
                "Social Network Team",
                "Royal APT"
            ],
            "source_name": "MISPGALAXY:APT15",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535574,
    "ts_updated_at": 1743041536,
    "ts_creation_date": 1653697966,
    "ts_modification_date": 1653697966,
    "files": {
        "pdf": "https://archive.orkl.eu/2ab9f2ed4b55aeba5a2a3dc43682b7bd7d2f4729.pdf",
        "text": "https://archive.orkl.eu/2ab9f2ed4b55aeba5a2a3dc43682b7bd7d2f4729.txt",
        "img": "https://archive.orkl.eu/2ab9f2ed4b55aeba5a2a3dc43682b7bd7d2f4729.jpg"
    }
}