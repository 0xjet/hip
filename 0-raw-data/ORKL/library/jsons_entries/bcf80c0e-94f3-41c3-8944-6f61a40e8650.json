{
    "id": "bcf80c0e-94f3-41c3-8944-6f61a40e8650",
    "created_at": "2023-01-12T15:02:16.941209Z",
    "updated_at": "2025-03-27T02:05:43.693833Z",
    "deleted_at": null,
    "sha1_hash": "e4b0bf121305cf8bcdafd76b039bf2ce3c7e6d4d",
    "title": "2019-01-05 - Emotet Research",
    "authors": "",
    "file_creation_date": "2022-05-27T23:09:31Z",
    "file_modification_date": "2022-05-27T23:09:31Z",
    "file_size": 428608,
    "plain_text": "# Emotet research\n\n**github.com/d00rt/emotet_research**\n\nd00rt\n\nIn this repository you can find documentation about the packer of Emotet and its unpacker.\nThis unpacker extracts the command and controls, and the public RSA key of Emotet (botnet\nidentifier).\n\n\n-----\n\n## General purpouse\n\nThe purpose of this repository is, to show how the packet of emotet works, provide a sample\nof emotet payload with its idc (made by me)\n\nAlso I wrote an unpacker for emotet (using TitanEngine) which extracts the final payload of\nemotet and the intermediate layers for extracting it.\n\nIn addition, the unpackers extrats to a file the static configuration of emotet, the command\nand controls and its public RSA key (botnet identifier).\n\n## Directories and files\n\n**./unpacker/src:**\n\n- Source code of the packer. main.py file is the script for running the unpacker.\n\n**./unpacker/TitanEngine.dll**\n\n- Titan Engine DLL, or you can download from reversinglabs.com. The DLL must be on\n**C:/windows/system32/ folder.**\n\n**./doc:**\n\n- Documentation of the emotet unpacker.\n\n**./unpacked_sample_id:**\n\n- In this directory you can find a sample of final payload of the Emotet next to an idc\ndocumented by me.\n\n## Requeriments\n\nBefore to use the unpacker, I recommend to read the documentation I did about this packer.\n(./doc/EN_emotet_packer_analysis_and_config_extraction_v1.pdf)\n\npyrhon2.7\nyara-python\nTitan Engine DLL. Provided in this repo, or you can download from its web page\n\n## Output\n\nIf success a folder named \"output\" will be created.\n\n**./output/unpacked/{packed_file_name}.emotet.unpacked:**\n\n- Emotet payload unpacked. (PE File)\n\n**./output/extracted_files/layer2/{packed_file_name}.layer2.bin:**\n\n- Layer2 of emotet packer. (PE File)\n\n**./output/extracted_files/broken_payload/{packed_file_name}.payload.bin:**\n\n- Emotet payload unpacked step 1, if you read the packer documentation you will realized\nthat in the first step this file doesn't work, it must be fixed up. (PE File)\n\n\n-----\n\n**./output/static_configuration/{packed_file_name}.ips.txt:**\n- List of \"ip:port\" of commands and controls.\n**./output/static_configuration/{packed_file_name}.rsa.txt:**\n- RSA key used for communicating with the command and control.\n\n## Usage\n\nAfter install all requeriments and the Titan Engine DLL...\n```\ncd unpacker/src/\n./main.py [options] {filename or folder}\n\n```\nOR\n```\ndouble click :S\n\n```\n\n-----\n\nThen select the target file in the box.\n\nPress the \"UnPack\" buttom.\n\nEnjoy =)\n\n## Final words\n\nThese documentation and unpacker were done between November and December of 2018 if\nafter these dates it doesn't work maybe the unpacker doesn't work well or Emotet developers\nchanged the packer.\n\nThis unpacker isn't perfect, it's my first dynamic unpacker using Titan Engine. I did this\nresearch on my free time, because currently I'm not working on this kind of stuff and I don't\nhave enough time.\n\nIt'd be cool keep the repository updated for new versions of the packer or for some future\nerror fixes. Therefore, feel free to send PR or open issues. I will try to keep it updated if I\nhave time.\n\nEnjoy and keep fighting against the malware =)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-01-05 - Emotet Research.pdf"
    ],
    "report_names": [
        "2019-01-05 - Emotet Research.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535736,
    "ts_updated_at": 1743041143,
    "ts_creation_date": 1653692971,
    "ts_modification_date": 1653692971,
    "files": {
        "pdf": "https://archive.orkl.eu/e4b0bf121305cf8bcdafd76b039bf2ce3c7e6d4d.pdf",
        "text": "https://archive.orkl.eu/e4b0bf121305cf8bcdafd76b039bf2ce3c7e6d4d.txt",
        "img": "https://archive.orkl.eu/e4b0bf121305cf8bcdafd76b039bf2ce3c7e6d4d.jpg"
    }
}