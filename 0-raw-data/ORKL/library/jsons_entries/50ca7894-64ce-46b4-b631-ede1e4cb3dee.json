{
    "id": "50ca7894-64ce-46b4-b631-ede1e4cb3dee",
    "created_at": "2023-01-12T15:10:14.581678Z",
    "updated_at": "2025-03-27T02:06:12.126045Z",
    "deleted_at": null,
    "sha1_hash": "1b837c1ab031913cf7393b203d583c58b3c956bc",
    "title": "2020-05-12 - Java RAT Campaign Targets Co-Operative Banks in India",
    "authors": "",
    "file_creation_date": "2022-05-27T22:32:59Z",
    "file_modification_date": "2022-05-27T22:32:59Z",
    "file_size": 701894,
    "plain_text": "# Java RAT Campaign Targets Co-Operative Banks in India\n\n**[seqrite.com/blog/java-rat-campaign-targets-co-operative-banks-in-india/](https://www.seqrite.com/blog/java-rat-campaign-targets-co-operative-banks-in-india/)**\n\nPavankumar Chaudhari May 12, 2020\n\n12 May 2020\nWritten by [Pavankumar Chaudhari](https://www.seqrite.com/blog/author/pavankumar/)\n\n[Cybersecurity,](https://www.seqrite.com/blog/category/cybersecurity/) [Malware](https://www.seqrite.com/blog/category/malware/)\n\nEstimated reading time: 8 minutes\n\n## Summary\n\nWhile the entire world is busy fighting COVID-19 pandemic, cybercriminals have latched onto\nthe opportunity and used the theme to propagate numerous cyber-attacks. The latest in line\nis a targeted attack against co-operative banks in India. In April 2020, Quick Heal Security\nLabs observed a renewed wave of Adwind Java RAT campaign, whose primary target seems\nto be co-operative banks. These banks are usually small in size & may not have a large team\nof trained cybersecurity personnel, which, potentially, has made them a target for\ncybercriminals\n\nAs with a large percentage of COVID-19 related cyber-attacks, this recent Java RAT\ncampaign also starts with a spear-phishing email. In this case, the email claims to have\noriginated from either Reserve Bank of India or a large banking organization within the\ncountry. The content of the email refers to new RBI guidelines or a transaction, with detailed\n\n\n-----\n\ninformation in an attached file, which is a zip file that contains a malicious JAR file. Use of\ndocument file extensions (e.g. xlsx, pdf, etc.) in the name of the attachment, results in it\nappearing as an excel document or a PDF file, thus luring unsuspecting users into opening it.\nThe JAR file is a remote admin trojan that can be run on any machine installed with Java\nincluding windows, Linux, and Mac.\n\nOnce the user opens the attachment, the malicious payload persists itself by modifying\nregistry key and dropping a JAR file in %appdata% location. This JAR has multi-layer\nobfuscation to make analysis hard and bypass detection from AV products. Upon execution,\nthis JAR file transforms into a Remote admin tool (JRat) which can perform various malicious\nactivities such as keylogging, capturing screenshots, downloading additional payloads, and\ngetting user information.\n\n## Infection Vector\n\nAs shown in the below figures, the attacker had sent spear-phishing emails to multiple cooperative banks using social engineering techniques. Assuming that this mail is from a\ntrusted sender, the user opened the attachment.\n\nFigure 1: Spear Phishing Email\n\n\n-----\n\nFigure 2: Spear Phishing Email\n\n\n-----\n\nFigure 3: Spear Phishing Email\nAs shown in the above emails, all attachments are zip files. After extraction of this archive,\nmalicious JAR file gets unpacked. The name of JAR is impersonated to PDF, xls or xlsx. This\nimpersonation lures the user to click on this JAR file resulting in the execution of Java RAT.\n\nBelow are some subject and attachment names found in the campaign:\n\n**Email Subject** **Attachment Name**\n\n\nUrgent – COVID measures\nmonitoring template\n\nQuery Reports for RBI\nINSPECTION\n\n\nCovid_19_measures_Monitoring_TemplateFinal_xlsx.zip\n\nNSBLAccListOnTheBasisOfKYCData_0600402020_pdf.zip\n\n\nMoratorium Gazette notification&RBI_Directives_file00000120_pdf.zip\n\nFMR returns Fmr-2_n_fmr_3_file_000002-pdf.zip\n\nAssessment Advice-MH-603 MON01803_DIC_pdf.zip\n\n\n\n[874890897] – MIS for\nNEFT/RTGS, 06-04-2020 [1]\n\n\nFIXEDCOMPNULL_xls.zip\n\n\n-----\n\nDeal confr. SHRIGOVARDHANSING0023JI001_pdf.zip\n\nDI form DI_form_HY_file_00002_pdf .zip\n\n## Analysis of the JAR\n\n**Sample analysed: D7409C0389E68B76396F9C33E48AB72B**\n\n**Attachment Name: Covid_19_measures_Monitoring_Template-Final_xlsx.jar**\n\nThis JAR is obfuscated with multi-stage obfuscation — let’s check analysis of the first stage.\n\n## Stage 1 JAR\n\nThis JAR file is obfuscated with Allatori obfuscator. As shown in below figure, all the strings\nare obfuscated.\n\nFigure 4: Stage 1 obfuscated JAR\n\nAfter deobfuscating above JAR, code looks quite readable as shown in figure 5. We can see\nthat the code is loading AES encrypted data from a file named bxcerhsdj.lsp using\ngetResourceAsStream function. AES key is hardcoded in the code. This encrypted data\nbecomes the second stage of JAR payload after decryption. This second stage JAR is\ndropped at %APPDATA% location and executed with java.exe.\n\n\n-----\n\nFigure 5: Stage 1 deobfuscated JAR\n\nFigure 6: Encrypted JAR in the resource file\nIt achieves persistence using registry run keys techniques.\n\n\n-----\n\nFigure 7: Registry persistence code\n\n## Stage 2 JAR\n\nSecond stage JAR is responsible for all the major malicious activities. This JAR is again\nobfuscated with allatori obfuscator — the package structure is as shown below in the below\nfigure –\n\nFigure 8: Stage 2 obfuscated JAR\nAfter deobfuscation of the above JAR, a new JAR is constructed as shown in fig 9:\n\n\n-----\n\nFigure 9: Stage 2 deobfuscated JAR\nWith this deobfuscated JAR, we can easily perform static analysis of malware activities.\n\n## Analysis of RAT functionalities\n\nFor the ease of understanding, we have manually renamed some parameters and functions.\n\n### Configurations\n\nBelow class stores all the required configurations like URL for connection, port number, sleep\nintervals, current JAR name, etc. –\n\nFigure 10: Malware Configurations\n\n\n-----\n\n### Connection mechanism\n\nAdwind communicates with its command and control (C2) server on non-standard ports. It\nhas hardcoded URL and port number. In this case, Port 9045 was used. It also schedules\nsleep before connecting to C2.\n\nFigure 11: main() function with C2 URL and Port number\nRAT has the functionality to terminate or restart the connection based on commands\nreceived from C2.\n\nFigure 12: “launcher” commands functionality\n\n## C2 Details\n\nDomain was active between 05-Apr-2020 to 20-Apr-2020 hosted on IP ‘151.106.30.114’.\n\nFigure 13: Domain heatmap. Reference – PassiveTotal\n\n[Figure 13: Domain heatmap. Reference – PassiveTotal](https://community.riskiq.com/)\n\n## Download Payload mechanism\n\n\n-----\n\nRequest for the payload is sent with User-Agent as:\n\n“Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)\nChrome/80.0.3987.87 Safari/537.36”\n\n“dn” command is used for download functionality and “dn.e” command is used to download\nand execute the payload.\n\nFigure 14: Code to download and execute the payload\n\n## Pause-N-Go Mechanism\n\nAdWind RAT has a pause & go mechanism which allows the RAT to schedule sleep before\ncontacting the command-n-control server. This mechanism helps it to minimize its network\nactivity when the C2 is off. The attacker can also cancel the scheduled sleep activity when\nneeded.\n\n## “main” commands Mechanism\n\nThree commands under ‘main’ that help attacker to Shut down, Reboot or log-off victim\nmachine — all commands are executed as the victim OS.\n\n\n-----\n\nFigure 15: “main”\n\ncommands functionality\n\n## Persistence Mechanism\n\nThis backdoor can create or delete its persistence by sending commands.\n\nFigure 16: Persistence commands\nPersistence is created by adding its file path to the HKCU Run registry key using the reg\ncommand:\n\n\n-----\n\nFigure 17: Registry adding code\nIn case of clean-up, persistence can be removed by a command which calls ‘REG DELETE’\nto current entry:\n\nFigure 18: Registry delete code\n\n## Remote Desktop Control\n\nAdwind RAT is capable of controlling the victim’s desktop remotely. In this variant, the\nattacker used robot class to control mouse, keyboard by sending commands from a remote\nmachine.\n\n\n-----\n\nFigure 19: Remote desktop control code snippet\n\n## Screenshots Capture\n\nBelow code is responsible to take screenshots.\n\nFigure 20: Screen capture code\n\n### Below table shows different commands that can be sent from C2\n\n\nCommands Description SubCommands\n\naut Authenticate\n\ncm Commandline\n\nln.t Launcher.terminate\n\n\nDescription\n\n\n-----\n\nln.rst Launcher.Restart\n\npng Pause-N-Go\n\ndg Dialog\n\ndn Download dn.e Download &\nExecute\n\nmain Main menu main.shd Shutdown\n\nmain.rbt Reboot\n\nmain.lgf logoff\n\nst startup st.is Add Reg\n\nst.us Delete Reg\n\nsc Screen/Scroll Capture sc.op Open\n\nsc.ck Mouse Click\n\ndblck Mouse Double Click\n\ndn Down\n\nup Up\n\nsc.mv Mouse Move\n\nsc.cap Capture\n\nsc.ky Keyboard keypress\n\nsc.mw Mouse wheel\n\nfm Filemanager fm.dv Dir view\n\nfm.get Get environment variable\n\nfm.nd mkdirs\n\nfm.e Execute\n\nfm.op Open\n\nfm.sp Spawn-Process with WMIC\n\n\n-----\n\nfm.ja Execute Java App: java -jar <fie>\n\nfm.sc Execute Script: wscript.exe //B\n<file>\n\nfm.es Execute on cmd shell\n\nfm.cp Copy\n\nfm.chm Modifies File Permissions\n\nfm.mv Move\n\nfm.del Delete\n\nfm.ren Rename\n\nfm.chmod Modifies File Permissions\n\nfm.down Download\n\nfm.up Upload\n\n## Impact of Attack\n\nWhen trying to assess the potential risk, banks should factor-in not just direct costs but many\nindirect aspects as well.\n\n## Direct Impact\n\n### Stolen Data\n\nCyberattack on banks can lead to stealing of all customer data and important financial\ninfrastructure details. This data leak helps the attacker to plan the next phase of attack\nincluding targeted attacks.\n\n### Financial Fraud\n\nBackdoors often lead to stealing of credentials for important financial infrastructure like swift\nlogins. This further leads to big financial loses to banks. We have previously seen many\nincidences where banks had to face large financial losses due to cyberattacks.\n\n### Larger Attacks\n\n\n-----\n\nDuring the last few years, there have been a few drawn-out & long duration cyber attacks on\nbanks which had a huge financial impact on the bank & its users. Such attacks usually start\nwith an initial infection that gives Cyber Criminals access to resources within the network,\nand from there the attack spreads laterally to the rest of the network till attacker gains access\nto sensitive/confidential information. The possibility of this Java RAT based being one such\nstarting point should not be discounted.\n\n## Indirect Impact\n\n### Business Downtime\n\nCyber-attack may lead to the operational shutdown of banks, which may multiple times\nhigher than direct costs like financial fraud.\n\n### Loss of Reputation\n\nThis is the most destructive type of cost a business has to pay for such cyber-attacks. A\nnews leak about an attack leaves the victim with no choice but to make it known to the public\nthat they have been breached. This can often change the potential views of investors and\nother stakeholders toward banks.\n\n### Customer Impact\n\nAttacks on the bank can lead to the disclosure of customer personal data. Failure of\ntransactions due to an operational shutdown may also lead to unhappy customers and may\nhave negative consequences on retaining clients.\n\n## Conclusion\n\nSince the last few months, Cyber Criminals are capitalizing on global coronavirus panic to\ndistribute a variety of malware and steal sensitive information. In this particular scenario,\nattackers have used Adwind Java RAT to target small banks in India, with the explicit aim of\nstealing information and remotely controlling the victim machine for financial gains. Also, the\nattackers have used multi-layered obfuscation in this attack, to make detection harder.\nSeqrite products are successfully detecting & blocking these attacks though and keeping\ncustomers protected\n\nQuick Heal advises users to exercise ample caution and avoid opening attachments &\nclicking on web links in unsolicited emails. Users should also keep their Operating Systems\nupdated and have a full-fledged security solution installed on all devices. We recommend\nSeqrite customers to ensure they have email protection configured as per their organization\n[policy — please reach out to Seqrite support using contact details mentioned here if](https://www.seqrite.com/seqrite-support-center)\nassistance is required to configure email protection.\n\n\n-----\n\nThe quick Heal research team is proactively monitoring all campaigns related to COVID-19\nand working relentlessly to ensure the safety of our customers\n\n## IOCs\n\nD7409C0389E68B76396F9C33E48AB72B\n09477F63366CF4B4A4599772012C9121\n8C5FFB7584370811AF61F81538816613\n01AB7192109411D0DEDFE265005CCDD9\n0CEACC58852ED15A5F55C435DB585B7D\n\n### MITRE ATT&CK TIDs:\n\n**Tactics** **Techniques** **ID**\n\n**Initial Access** Spearphishing Attachment T1193\n\n**Execution** Command-Line Interface T1059\n\n**Persistence** File System Permissions Weakness T1044\n\nRegistry Run Keys / Startup Folder T1060\n\n**Privilege Escalation** File System Permissions Weakness T1044\n\n**Defense Evasion** Disabling Security Tools T1089\n\nModify Registry T1112\n\nObfuscated Files or Information T1027\n\nFile Deletion T1107\n\nProcess Discovery T1057\n\nRemote System Discovery T1018\n\nSystem Information Discovery T1082\n\nData from Local System T1005\n\n**Collection** Input Capture T1056\n\nScreen Capture T1113\n\nData Compressed T1002\n\n**Exfiltration** Data Encrypted T1022\n\nUncommonly Used Port T1065\n\n\n-----\n\nRemote File Copy T1105\n\nRemote Access Tools T1219\n\nData Destruction T1485\n\n**Impact** System Shutdown/Reboot T1529\n\n## Subject matter experts:\n\n**Kalpesh Mantri**\n\n**Pavankumar Chaudhari**\n\n**Bajrang Mane**\n\nPavankumar is associated with Quick Heal Technologies as a Technical Lead (Research and\nDevelopment) and is also a part of Vulnerability Research and Analysis Team....\n\n[Articles by Pavankumar Chaudhari »](https://www.seqrite.com/blog/author/pavankumar/)\n\n### No Comments\n\nLeave a Reply.Your email address will not be published.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-05-12 - Java RAT Campaign Targets Co-Operative Banks in India.pdf"
    ],
    "report_names": [
        "2020-05-12 - Java RAT Campaign Targets Co-Operative Banks in India.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536214,
    "ts_updated_at": 1743041172,
    "ts_creation_date": 1653690779,
    "ts_modification_date": 1653690779,
    "files": {
        "pdf": "https://archive.orkl.eu/1b837c1ab031913cf7393b203d583c58b3c956bc.pdf",
        "text": "https://archive.orkl.eu/1b837c1ab031913cf7393b203d583c58b3c956bc.txt",
        "img": "https://archive.orkl.eu/1b837c1ab031913cf7393b203d583c58b3c956bc.jpg"
    }
}