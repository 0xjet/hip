{
    "id": "dea84cb3-52d7-4a3d-888d-8ae0acad8162",
    "created_at": "2023-01-12T15:04:17.199367Z",
    "updated_at": "2025-03-27T02:14:39.29283Z",
    "deleted_at": null,
    "sha1_hash": "9aa9f7671274df62c3d5dbc3e01935f2c6acc3a1",
    "title": "2017-09-28 - Money‑making machine- Monero‑mining malware",
    "authors": "",
    "file_creation_date": "2022-05-28T04:00:36Z",
    "file_modification_date": "2022-05-28T04:00:36Z",
    "file_size": 460849,
    "plain_text": "# Money‑making machine: Monero‑mining malware\n\n**[welivesecurity.com/2017/09/28/monero-money-mining-malware/](https://www.welivesecurity.com/2017/09/28/monero-money-mining-malware/)**\n\nSeptember 28, 2017\n\nWhile far behind Bitcoin in market capitalization, Monero has several features that make it a\nvery attractive cryptocurrency to be mined by malware.\n\nWhile the world is holding its breath, wondering where notorious cybercriminal groups like\nLazarus or Telebots will strike next with another destructive malware such as WannaCryptor\nor Petya, there are many other, less aggressive, much stealthier and often very profitable\noperations going on.\n\nOne such operation has been going on since at least May 2017, with attackers infecting\nunpatched Windows webservers with a malicious cryptocurrency miner. The goal: use the\nservers’ computing power to mine Monero (XMR), one of the newer cryptocurrency\nalternatives to Bitcoin.\n\nTo achieve this, attackers modified legitimate open source Monero mining software and\nexploited a known vulnerability in Microsoft IIS 6.0 to covertly install the miner on unpatched\nservers. Over the course of three months, the crooks behind the campaign have created a\nbotnet of several hundred infected servers and made over USD 63,000 worth of Monero.\n\n\n-----\n\nESET customers are protected against any attempts to exploit the CVE-2017-7269\nvulnerability, even if their machines aren’t patched against it, as was the case with\nEternalBlue, the exploit used to spread WannaCryptor.\n\n## Why mine Monero and not Bitcoin?\n\nWhile far behind Bitcoin in market capitalization, Monero has several features that make it a\nvery attractive cryptocurrency to be mined by malware – untraceable transactions and a\nproof of work algorithm called CryptoNight, which favors computer or server CPUs and\nGPUs, in contrast to specialized mining hardware needed for Bitcoin mining.\n\nWe can observe the exchange rate jumping up from 40 USD/XMR up to 150 USD/XMR\nover the past month, falling back to 100 USD/XMR.\n\n\n-----\n\nFigure1. Candlestick chart of the XMR/USD exchange rate in August, 2017\n\n## The Cryptominer\n\nFirst seen in-the-wild on 26 May, 2017, the malicious mining software is a fork of ath\n[legitimate open source Monero CPU miner called xmrig, version 0.8.2 (also released May](https://github.com/xmrig/xmrig/releases/tag/v0.8.2)\n26 2017).\n\nWhen creating the malicious mining software, the crooks did not apply any changes to the\noriginal open source codebase apart from adding hardcoded command line arguments of\nthe attacker’s wallet address and the mining pool URL, plus a few arguments to kill all\npreviously running instances of itself so as not to compete with its new instance. This\ncouldn’t have taken the cybercrooks more than just couple of minutes as suggested by the\nfact that we saw it in-the-wild on the same day the base version of xmrig was released.\n\nYou can see the attacker’s modified cryptominer and its identification with the available\nsource code in the figures below.\n\n\n-----\n\nFigure2. Code comparison between original and adapted versions\n\n## Scanning and Exploitation\n\nThe distribution of the miner to victims’ computers is the hardest part of this operation, but\neven here, the attackers went for the easiest approach. There are two IP addresses that we\n[identified as the source of brute-force scans for the CVE-2017-7269 vulnerability and both](http://www.cvedetails.com/cve/CVE-2017-7269/)\npoint to servers in the Amazon Web Services cloud.\n\nThe vulnerability exploited by the attackers was discovered in March 2017 by Zhiniang\nPeng and Chen Wu. It is a vulnerability in the WebDAV service that is part of Microsoft IIS\nversion 6.0, the webserver in Windows Server 2003 R2. A dangerous buffer overflow in the\nScStoragePathFromUrl function is triggered when the vulnerable server is processing a\nmalicious HTTP request. In particular, a specifically crafted PROPFIND request leads to a\nbuffer overflow due to a reallocation of double sized buffer when the count of Unicode\ncharacters is mistakenly provided instead of a byte-count. A very detailed analysis of the\n[mechanism by Javier M. Mellid can be found here. This vulnerability is especially](https://javiermunhoz.com/blog/2017/04/17/cve-2017-7269-iis-6.0-webdav-remote-code-execution.html)\nsusceptible to exploitation, since it’s located in a webserver service, which in most cases is\nmeant to be visible from the internet and therefore can be easily accessed and exploited by\nanyone.\n\nThe payload comes necessarily in the form of an alphanumeric string. The attackers\nreplaced the string leading to the execution of the Windows calculator from the proof-ofconcept with one leading to the download and execution of their malicious payload.\n[However, this didn’t require much sophistication either, as there are online tools like alpha3](https://github.com/SkyLined/alpha3/)\nthat help to convert any shellcode into the desired string.\n\nThe shellcode is the expected download-and-execute action (downloading dasHost.exe\nfrom hxxt://postgre[.]tk/ into the %TEMP% folder):\n\n\n-----\n\nFigure3. Shellcode delivered by the exploit\n\nBased on our data, the very first in-the-wild exploitation of this vulnerability happened just\ntwo days after its publication on 26 March 2017 and it has been actively exploited everth\nsince.\n\n\nThis particular malicious miner was first seen in-the-wild on 26 May 2017. Since then, itth\nhas been appearing in waves, on a weekly or less frequent basis, which implies that the\nattacker scans the internet for vulnerable machines.\n\n\n-----\n\nFigure4. Graph of infection waves over time\n\nScanning is always done from one IP address, which seems to be a machine hosted on an\nAmazon cloud server that the attacker had rented and deployed their scanning software,\nand continue to use it to launch their attacks.\n\n## Mitigation\n\nESET detects the malicious binaries of the miner as Win32/CoinMiner.AMW trojan and\nthe exploitation attempts at the network layer under the detection name\n**webDAV/ExplodingCan. This is a real-world example of a packet that would be blocked:**\n\nFigure5. Specifically crafted HTTP request with an encoded shellcode\n\n[Microsoft ended its regular update support for Windows Server 2003 in July 2015 and did](https://www.microsoft.com/en-us/cloud-platform/windows-server-2003)\nnot release any patch for this vulnerability until June 2017, when several critical\nvulnerabilities for its older systems were discovered and brought to the attention of malware\nauthors. The good news is that despite the end-of-life status of the system, Microsoft\ndecided to patch these critical vulnerabilities in order to avoid large-scale destructive\nattacks similar to the WannaCryptor (aka WannaCry) outbreak. However, keeping Windows\nServer 2003 up-to-date might be difficult due to the fact that automatic updates don’t always\n[work smoothly (e.g. this blog post by Clint Boessen confirms our own troubles with updating](http://clintboessen.blogspot.cz/2016/12/how-to-patch-windows-server-2003-with.html)\nthe system). Consequently, many of these systems are still vulnerable to this day. We\n[strongly advise users of Windows Server 2003 to apply KB3197835 and other critical](https://www.microsoft.com/en-us/download/details.aspx?id=55422)\npatches as soon as possible (if automatic updates fail then download and install the security\nupdate manually!).\n\n## Statistics\n\n\n-----\n\nThanks to the mining pool stats being publicly available, we were able to see the combined\nhash rate of all victims, which represents the computing power dedicated to the mining\naccount. The value seemed to consistently reach around 100 kilohashes per second (kH/s),\nwith a surge of up to 160 kH/s in late August 2017, which we attribute to campaigns\nlaunched on August 23 and 30.\n\nOverall, the infected machines were making approximately XMR5.5 daily by the end of\nAugust and have made over XMR420 in total over the course of three months. According to\nthe exchange rate of 150 USD/XMR at the time, these values were equal to USD 825 per\nday and over USD 63,000 in total, respectively.\n\nThe attackers were very active at the end of August but have gone quiet since early this\nmonth with no new infections coming in. Moreover, because the miner has no persistence\nmechanism, the attackers have slowly begun losing already compromised machines, and\nthe total hash rate has dropped all the way down to 60 kH/s at the time of writing. This is not\nthe first time the attackers took such a break and it is likely a new campaign will be\nlaunched in the near future.\n\nThe total number of victims is not known to us, but can be estimated from the total hash\n[rate produced by the attacker. According to the CPU benchmarks, a high-end consumer](http://monerobenchmarks.info/#cpu)\nIntel i7 processor has a hash rate of around 0.3-0.4 kH/s. However, considering the fact that\nthe exploit is limited to systems running Windows Server 2003, which will most likely be\nrunning on older hardware with weaker CPUs, the average hash rate per victim will be\nmuch lower and the total number of infected machines probably much higher.\n\nFigure6: Statistics of the attackers’ wallet provided by the mining pool\n\n\n-----\n\n## Conclusion\n\nWe see that minimal know-how together with very low operating costs and a low risk of\ngetting caught – in this case, misusing legitimate open-source cryptocurrency mining\nsoftware and targeting old systems likely to be left unpatched – can be sufficient for\nsecuring a relatively high outcome.\n\nSometimes it takes very little to gain a lot, and this is especially true in today’s world of\ncybersecurity, where even well-documented, long-known and warned about vulnerabilities\nare still very effective due to the lack of awareness of many users.\n\n### IoCs\n\n**Download Site:**\n\nhxxp://postgre.tk\n\nhxxp://ntpserver.tk\n\n**Source IPs:**\n\n54.197.4.10\n\n52.207.232.106\n\n18.220.190.151\n\n**Hashes:**\n\n31721AE37835F792EE792D8324E307BA423277AE\n\nA0BC6EA2BFA1D3D895FE8E706737D490D5FE3987\n\n37D4CC67351B2BD8067AB99973C4AFD7090DB1E9\n\n0902181D1B9433B5616763646A089B1BDF428262\n\n0AB00045D0D403F2D8F8865120C1089C09BA4FEE\n\n11D7694987A32A91FB766BA221F9A2DE3C06D173\n\n9FCB3943660203E99C348F17A8801BA077F7CB40\n\n52413AE19BBCDB9339D38A6F305E040FE83DEE1B\n\n**If you are interested in this topic you might also be interested in the following:**\n\n[https://www.welivesecurity.com/2017/09/14/cryptocurrency-web-mining-union-profit/](https://www.welivesecurity.com/2017/09/14/cryptocurrency-web-mining-union-profit/)\n\n[https://www.welivesecurity.com/2017/09/12/cryptocurrency-state-sponsorship/](https://www.welivesecurity.com/2017/09/12/cryptocurrency-state-sponsorship/)\n\n\n-----\n\n_[Image Credit: © Markéta Fialová](https://fialovam.wixsite.com/portfolio)_\n\n28 Sep 2017 - 02:54PM\n\n### Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n Newsletter\n\n Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-09-28 - Money‑making machine- Monero‑mining malware.pdf"
    ],
    "report_names": [
        "2017-09-28 - Money‑making machine- Monero‑mining malware.pdf"
    ],
    "threat_actors": [
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "39842197-944a-49fd-9bec-eafa1807e0ea",
            "created_at": "2022-10-25T16:07:24.310589Z",
            "updated_at": "2025-03-27T02:02:10.167471Z",
            "deleted_at": null,
            "main_name": "TeleBots",
            "aliases": [],
            "source_name": "ETDA:TeleBots",
            "tools": [
                "BadRabbit",
                "Black Energy",
                "BlackEnergy",
                "CredRaptor",
                "Diskcoder.C",
                "EternalPetya",
                "ExPetr",
                "Exaramel",
                "FakeTC",
                "Felixroot",
                "GreyEnergy",
                "GreyEnergy mini",
                "KillDisk",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "NonPetya",
                "NotPetya",
                "Nyetya",
                "Petna",
                "Petrwrap",
                "Pnyetya",
                "TeleBot",
                "TeleDoor",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "nPetya"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535857,
    "ts_updated_at": 1743041679,
    "ts_creation_date": 1653710436,
    "ts_modification_date": 1653710436,
    "files": {
        "pdf": "https://archive.orkl.eu/9aa9f7671274df62c3d5dbc3e01935f2c6acc3a1.pdf",
        "text": "https://archive.orkl.eu/9aa9f7671274df62c3d5dbc3e01935f2c6acc3a1.txt",
        "img": "https://archive.orkl.eu/9aa9f7671274df62c3d5dbc3e01935f2c6acc3a1.jpg"
    }
}