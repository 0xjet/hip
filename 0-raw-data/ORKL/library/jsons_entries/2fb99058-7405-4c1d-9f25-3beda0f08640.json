{
    "id": "2fb99058-7405-4c1d-9f25-3beda0f08640",
    "created_at": "2023-01-12T15:02:08.805844Z",
    "updated_at": "2025-03-27T02:16:16.896979Z",
    "deleted_at": null,
    "sha1_hash": "fa351c7884078c0a9dfc6af57e1a820c55e30501",
    "title": "2021-09-16 - Exploitation of the CVE-2021-40444 vulnerability in MSHTML",
    "authors": "",
    "file_creation_date": "2022-05-27T19:02:32Z",
    "file_modification_date": "2022-05-27T19:02:32Z",
    "file_size": 654731,
    "plain_text": "# Exploitation of the CVE-2021-40444 vulnerability in MSHTML\n\n**[securelist.com/exploitation-of-the-cve-2021-40444-vulnerability-in-mshtml/104218/](https://securelist.com/exploitation-of-the-cve-2021-40444-vulnerability-in-mshtml/104218/)**\n\n[Incidents](https://securelist.com/category/incidents/)\n\n[Incidents](https://securelist.com/category/incidents/)\n\n16 Sep 2021\n\nminute read\n\n\n-----\n\nAuthors\n\n## Summary\n\n\nAMR\n\n\nLast week, Microsoft reported the remote code execution vulnerability CVE-2021-40444 in\nthe MSHTML browser engine. According to the company, this vulnerability has already been\nused in targeted attacks against Microsoft Office users. In attempt to exploit this vulnerability,\nattackers create a document with a specially-crafted object. If a user opens the document,\nMS Office will download and execute a malicious script.\n\nAccording to our data, the same attacks are still happening all over the world. We are\ncurrently seeing attempts to exploit the CVE-2021-40444 vulnerability targeting companies in\nthe research and development sector, the energy sector and large industrial sectors, banking\nand medical technology development sectors, as well as telecommunications and the IT\n[sector. Due to its ease of exploitation and the few published Proof-of-Concept (PoC), we](https://encyclopedia.kaspersky.com/glossary/poc-proof-of-concept/?utm_source=securelist&utm_medium=blog&utm_campaign=termin-explanation)\nexpect to see an increase in attacks using this vulnerability.\n\n_Geography of CVE-2021-40444 exploitation attempts_\n\nKaspersky is aware of targeted attacks using CVE-2021-40444, and our products protect\nagainst attacks leveraging the vulnerability. Possible detection names are:\n\nHEUR:Exploit.MSOffice.CVE-2021-40444.a\nHEUR:Trojan.MSOffice.Agent.gen\n\n\n-----\n\nPDM:Exploit.Win32.Generic\n\n_Killchain generated by KEDR during execution of CVE-2021-40444 Proof-of-Concept_\n\nExperts at Kaspersky are monitoring the situation closely and improving mechanisms to\n[detect this vulnerability using Behavior Detection and](https://www.kaspersky.com/enterprise-security/wiki-section/products/behavior-based-protection) [Exploit Prevention components. Within](https://www.kaspersky.com/enterprise-security/wiki-section/products/exploit-prevention)\nour [Managed Detection and Response service, our SOC experts are able to detect when this](https://www.kaspersky.com/enterprise-security/managed-detection-and-response)\nvulnerability is expoited, investigate such attacks and notify customers.\n\n## Technical details\n\nThe remote code execution vulnerability CVE-2021-40444 was found in MSHTML, the\nInternet Explorer browser engine which is a component of modern Windows systems, both\nuser and server. Moreover, the engine is often used by other programs to work with web\ncontent (e.g. MS Word or MS PowerPoint).\n\nIn order to exploit the vulnerability, attackers embed a special object in a Microsoft Office\ndocument containing an URL for a malicious script. If a victim opens the document, Microsoft\nOffice will download the malicious script from the URL and run it using the MSHTML engine.\nThen the script can use ActiveX controls to perform malicious actions on the victim’s\ncomputer. For example, the original zero-day exploit which was used in targeted attacks at\n\n\n-----\n\nthe time of detection used ActiveX controls to download and execute a Cobalt Strike\npayload. We are currently seeing various types of malware, mostly backdoors, which are\ndelivered by exploiting the CVE-2021-40444 vulnerability.\n\n## Mitigations\n\nFollow [Microsoft security update guidelines.](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-40444)\nUse the latest [Threat Intelligence information to keep up to date with TTPs used by](https://www.kaspersky.com/enterprise-security/threat-intelligence)\nthreat actors.\nBusinesses should use a security solution that provides vulnerability, patch\nmanagement and exploit prevention components, such as the Automatic Exploit\nPrevention component in Kaspersky Endpoint Security for Business. The component\nmonitors suspicious actions in applications and blocks malicious file execution.\n[Use solutions like Kaspersky Endpoint Detection and Response and](https://www.kaspersky.com/enterprise-security/endpoint-detection-response-edr) Kaspersky\nManaged Detection and Response service, which help identify and stop an attack at an\nearly stage before the attackers achieve their final goal.\n\n## IoC\n\n**MD5**\n[ef32824c7388a848c263deb4c360fd64](https://opentip.kaspersky.com/ef32824c7388a848c263deb4c360fd64/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n[e58b75e1f588508de7c15a35e2553b86](https://opentip.kaspersky.com/e58b75e1f588508de7c15a35e2553b86/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n[e89dbc1097cfb8591430ff93d9952260](https://opentip.kaspersky.com/e89dbc1097cfb8591430ff93d9952260/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n**URL**\n[hidusi[.]com](https://opentip.kaspersky.com/hidusi.com/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n[103.231.14[.]134](https://opentip.kaspersky.com/103.231.14.134/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[Malware Descriptions](https://securelist.com/tag/malware-descriptions/)\n[Microsoft](https://securelist.com/tag/microsoft/)\n[Microsoft Internet Explorer](https://securelist.com/tag/microsoft-internet-explorer/)\n[Proof-of-Concept](https://securelist.com/tag/proof-of-concept/)\n[Security technology](https://securelist.com/tag/security-technology/)\n[Targeted attacks](https://securelist.com/tag/targeted-attacks/)\n[Vulnerabilities and exploits](https://securelist.com/tag/vulnerabilities-and-exploits/)\n[Zero-day vulnerabilities](https://securelist.com/tag/zero-day-vulnerabilities/)\n\nAuthors\n\nAMR\n\n\n-----\n\nExploitation of the CVE-2021-40444 vulnerability in MSHTML\n\nYour email address will not be published. Required fields are marked *\n\nTable of Contents\n\nSummary\nTechnical details\nMitigations\nIoC\n\nGReAT webinars\n\n13 May 2021, 1:00pm\n\n### GReAT Ideas. Balalaika Edition\n\n26 Feb 2021, 12:00pm\n17 Jun 2020, 1:00pm\n26 Aug 2020, 2:00pm\nSubscribe to our weekly e-mails\n\nThe hottest research right in your inbox\n\n\n-----\n\nReports\n\n### APT trends report Q1 2022\n\nThis is our latest summary of advanced persistent threat (APT) activity, focusing on events\nthat we observed during Q1 2022.\n\n### Lazarus Trojanized DeFi app for delivering malware\n\nWe recently discovered a Trojanized DeFi application that was compiled in November 2021.\nThis application contains a legitimate program called DeFi Wallet that saves and manages a\ncryptocurrency wallet, but also implants a full-featured backdoor.\n\n### MoonBounce: the dark side of UEFI firmware\n\nAt the end of 2021, we inspected UEFI firmware that was tampered with to embed a\nmalicious code we dub MoonBounce. In this report we describe how the MoonBounce\nimplant works and how it is connected to APT41.\n\n### The BlueNoroff cryptocurrency hunt is still on\n\n\n-----\n\nIt appears that BlueNoroff shifted focus from hitting banks and SWIFT-connected servers to\nsolely cryptocurrency businesses as the main source of the group’s illegal income.\n\nSubscribe to our weekly e-mails\n\nThe hottest research right in your inbox\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-09-16 - Exploitation of the CVE-2021-40444 vulnerability in MSHTML.pdf"
    ],
    "report_names": [
        "2021-09-16 - Exploitation of the CVE-2021-40444 vulnerability in MSHTML.pdf"
    ],
    "threat_actors": [
        {
            "id": "1bdb91cf-f1a6-4bed-8cfa-c7ea1b635ebd",
            "created_at": "2022-10-25T16:07:23.766784Z",
            "updated_at": "2025-03-27T02:02:09.971636Z",
            "deleted_at": null,
            "main_name": "Bluenoroff",
            "aliases": [
                "APT 38",
                "ATK 117",
                "Alluring Pisces",
                "Black Alicanto",
                "Bluenoroff",
                "CTG-6459",
                "Copernicium",
                "Nickel Gladstone",
                "Sapphire Sleet",
                "Selective Pisces",
                "Stardust Chollima",
                "T-APT-15",
                "TA444",
                "TAG-71",
                "TEMP.Hermit"
            ],
            "source_name": "ETDA:Bluenoroff",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f426f0a0-faef-4c0e-bcf8-88974116c9d0",
            "created_at": "2022-10-25T15:50:23.240383Z",
            "updated_at": "2025-03-27T02:00:55.404232Z",
            "deleted_at": null,
            "main_name": "APT38",
            "aliases": [
                "APT38",
                "NICKEL GLADSTONE",
                "BeagleBoyz",
                "Bluenoroff",
                "Stardust Chollima",
                "Sapphire Sleet",
                "COPERNICIUM"
            ],
            "source_name": "MITRE:APT38",
            "tools": [
                "ECCENTRICBANDWAGON",
                "HOPLIGHT",
                "Mimikatz",
                "KillDisk",
                "DarkComet"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "4d5f939b-aea9-4a0e-8bff-003079a261ea",
            "created_at": "2023-01-06T13:46:39.04841Z",
            "updated_at": "2025-03-27T02:00:02.985296Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "G0096",
                "Grayfly",
                "BARIUM",
                "BRONZE ATLAS",
                "BRONZE EXPORT",
                "Red Kelpie",
                "HOODOO",
                "Brass Typhoon",
                "TA415",
                "WICKED SPIDER",
                "WICKED PANDA",
                "G0044",
                "Earth Baku"
            ],
            "source_name": "MISPGALAXY:APT41",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e698860d-57e8-4780-b7c3-41e5a8314ec0",
            "created_at": "2022-10-25T15:50:23.287929Z",
            "updated_at": "2025-03-27T02:00:55.43005Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "APT41",
                "Wicked Panda",
                "Brass Typhoon",
                "BARIUM"
            ],
            "source_name": "MITRE:APT41",
            "tools": [
                "ASPXSpy",
                "BITSAdmin",
                "PlugX",
                "Impacket",
                "gh0st RAT",
                "netstat",
                "PowerSploit",
                "ZxShell",
                "KEYPLUG",
                "ipconfig",
                "sqlmap",
                "China Chopper",
                "ShadowPad",
                "MESSAGETAP",
                "Mimikatz",
                "certutil",
                "njRAT",
                "Cobalt Strike",
                "pwdump",
                "BLACKCOFFEE",
                "ROCKBOOT",
                "dsquery",
                "Winnti for Linux",
                "DUSTTRAP",
                "Derusbi",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535728,
    "ts_updated_at": 1743041776,
    "ts_creation_date": 1653678152,
    "ts_modification_date": 1653678152,
    "files": {
        "pdf": "https://archive.orkl.eu/fa351c7884078c0a9dfc6af57e1a820c55e30501.pdf",
        "text": "https://archive.orkl.eu/fa351c7884078c0a9dfc6af57e1a820c55e30501.txt",
        "img": "https://archive.orkl.eu/fa351c7884078c0a9dfc6af57e1a820c55e30501.jpg"
    }
}