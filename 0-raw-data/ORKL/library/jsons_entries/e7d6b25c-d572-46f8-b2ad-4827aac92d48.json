{
    "id": "e7d6b25c-d572-46f8-b2ad-4827aac92d48",
    "created_at": "2023-01-12T14:59:54.682964Z",
    "updated_at": "2025-03-27T02:06:03.064952Z",
    "deleted_at": null,
    "sha1_hash": "3387ec1b8066e164876ac0a31059d176a0739346",
    "title": "2022-12-08 - Trojanized OneNote Document Leads to Formbook Malware",
    "authors": "",
    "file_creation_date": "2022-12-29T00:30:55Z",
    "file_modification_date": "2022-12-29T00:30:55Z",
    "file_size": 515667,
    "plain_text": "# Trojanized OneNote Document Leads to Formbook Malware\n\n**[trustwave.com/en-us/resources/blogs/spiderlabs-blog/trojanized-onenote-document-leads-to-formbook-malware/](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/trojanized-onenote-document-leads-to-formbook-malware/)**\n\nCybercriminals have long used Microsoft documents to pass along malware and they are\nalways experimenting with new ways to deliver malicious packages. As defenders,\nTrustwave SpiderLabs’ researchers are always looking out for new or unusual file types,\nand through this ongoing research, we uncovered threat actors using a OneNote document\nto move Formbook malware, an information stealing trojan sold on an underground hacking\nforum since mid-2016 as malware-as-a-service. Formbook malware can steal data from\nvarious web browsers and from other applications. This malware also has keylogging\nfunctionality and can take screenshots.\n\nOne file type that caught our eye on December 6, 2022, was the aforementioned OneNote\nattachment, with a .one extension attached to a spam email in our telemetry system. It’s not\ntypical to email .one files, so we took a closer look at the email, which is shown below.\n\n\n-----\n\n_Figure 1: The email_\n\n_sample as viewed with the MailMarshal Console_\n\n_Translation_\n\n_Dear (client) Good Afternoon, I hope this finds you well._\n\n_My name is ___ from the Purchasing team at the ___ company._\n\n_Please provide a quote for the details below:_\n\n_I await your reply,_\n\n_Thank You Very Much!_\n\n_Regards_\n\n_Whatsapp:_\n\nOnce the OneNote attachment is opened, an image lure is displayed. When the user clicks\non the ‘View Document’ part of the image, a security warning appears.\n\n\n-----\n\n_Figure 2: The_\n\n_attached OneNote file pdf172.one_\n\nAs shown in Figure 1, MailMarshal’s engine recognized and unpacked the contents of\n_pdf172.one. One of the unpacked components is a Windows Script File (WSF), which is_\noverlaid on the ‘View Document’ part of the image. When a user clicks on the 'View\nDocument\" part of the image, this causes the WSF file to be executed, and triggers a\nstandard security alert that a file is being opened from the OneNote application.\n\nAlso, it is interesting that the filename of the WSF itself has some deception, likely an\nattempt to fool scanners. The filename contains a right-to-left override character (U+202E)\nafter 'invoice', which causes the text that follows to be displayed in reverse. So, instead of\ndisplaying 'docx.wsf' some applications may display 'fsw.xcoD'.\n\nWhen a user clicks on the 'View Document\" part of the image, this causes the WSF file to\nbe executed, and triggers a standard security alert that a file is being opened from the\nOneNote application.\n\n\n-----\n\n_Figure 3: The WSF file overlayed to the lure image_\n\nWhen the user goes against the warning and clicks ‘OK,’ the malicious behavior of the file\nwill start to manifest. The WSF embedded in the OneNote file launches ‘PowerShell’\ncommands to download and execute two files from a0745450[.]xsph[.]ru.\n\n_Figure 4: The WSF_\n\n_contained on the OneNote attachment_\n\nThe first file to be retrieved is a decoy OneNote file. This will be downloaded from\n_a0745450[.]xsph[.]ru/INVESTEMENT[.]one and saved as %temp%\\invoice.one. The decoy_\nfile will be launched first to hide the downloading of the second file, which contains the\npayload.\n\n[The second file is an executable which will be downloaded from](https://www.virustotal.com/gui/file/32398cba360318425a3f1ba57676cba07546d5419e4d5f041752273ea389da33)\n_a0745450[.]xsph[.]ru/DT6832.exe and saved as %temp%\\system32.exe. This executable is_\nthe Formbook malware, an information stealing trojan sold on an underground hacking\nforum since mid-2016 as malware-as-a-service. Formbook malware can steal data from\nvarious web browsers and from other applications. This malware also has keylogging\nfunctionality and can take screenshots.\n\nIn sum, a WSF file embedded in a OneNote document is likely to fly under the radar. It also\nmeans that OneNote can now join the list of other Office Documents that need to be\ninspected for malicious components. As mentioned earlier, it’s not typical to see .one files\n\n\n-----\n\nattached to emails. As a mitigation step, organizations should consider blocking or flagging\ninbound email attachments with a .one extension.\n\nFor Trustwave MailMarshal customers: Upon detecting this threat, the Trustwave\nSpiderLabs’ MailMarshal Team released extra heuristics for characteristics of the .one\nmalicious attachment.\n\n**IOCs**\n\n**Hashes**\n\nPdf172.one (306792 bytes)\n\n81bd8c431811f83f335735847d42fb4f64f80960 (SHA1)\n\nDT6832.exe (218925 bytes)\n\nd5ee9183be486bf153d7666ca4301e600ea06087 (SHA1)\n\nINVESTMENT.one (59472 bytes)\n\n33d8fb75f471bdc4ebaff053e87146721f32667a (SHA1)\n\n**URLs**\n\na0745450[.]xsph[.]ru/DT6832[.]exe\n\na0745450[.]xsph[.]ru/INVESTEMENT[.]one\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-12-08 - Trojanized OneNote Document Leads to Formbook Malware.pdf"
    ],
    "report_names": [
        "2022-12-08 - Trojanized OneNote Document Leads to Formbook Malware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535594,
    "ts_updated_at": 1743041163,
    "ts_creation_date": 1672273855,
    "ts_modification_date": 1672273855,
    "files": {
        "pdf": "https://archive.orkl.eu/3387ec1b8066e164876ac0a31059d176a0739346.pdf",
        "text": "https://archive.orkl.eu/3387ec1b8066e164876ac0a31059d176a0739346.txt",
        "img": "https://archive.orkl.eu/3387ec1b8066e164876ac0a31059d176a0739346.jpg"
    }
}