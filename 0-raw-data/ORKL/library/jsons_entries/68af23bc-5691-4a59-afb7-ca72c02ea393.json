{
    "id": "68af23bc-5691-4a59-afb7-ca72c02ea393",
    "created_at": "2022-10-25T16:48:22.27224Z",
    "updated_at": "2025-03-27T02:17:23.182505Z",
    "deleted_at": null,
    "sha1_hash": "6889710cb527eb5d941412a7145d68bbbfa12a10",
    "title": "HermeticWiper - New Destructive Malware Used In Cyber Attacks on Ukraine",
    "authors": "sentinelone",
    "file_creation_date": "2022-02-24T21:09:42Z",
    "file_modification_date": "2022-02-24T21:09:42Z",
    "file_size": 687185,
    "plain_text": "# HermeticWiper | New Destructive Malware Used In Cyber Attacks on Ukraine\n\n**[sentinelone.com/labs/hermetic-wiper-ukraine-under-attack](https://www.sentinelone.com/labs/hermetic-wiper-ukraine-under-attack/)**\n\nJuan Andrés Guerrero-Saade\n\n## Executive Summary\n\nOn February 23rd, the threat intelligence community began observing a new wiper\nmalware sample circulating in Ukrainian organizations.\nOur analysis shows a signed driver is being used to deploy a wiper that targets Windows\ndevices, manipulating the MBR resulting in subsequent boot failure.\nThis blog includes the technical details of the wiper, dubbed HermeticWiper, and\nincludes IOCs to allow organizations to stay protected from this attack.\nThis sample is actively being used against Ukrainian organizations, and this blog will be\nupdated as more information becomes available.\n[SentinelOne customers are protected from this threat, no action is needed.](https://youtu.be/keWfVA6F4IM)\n\n## Background\n\nOn February 23rd, our friends at Symantec and ESET research tweeted hashes associated\nwith a wiper attack in Ukraine, including one which is not publicly available as of this\nwriting.\n\n\n-----\n\nWe started analyzing this new wiper malware, calling it HermeticWiper in reference to the\ndigital certificate used to sign the sample. The digital certificate is issued under the company\nname ‘Hermetica Digital Ltd’ and valid as of April 2021. At this time, we haven’t seen any\nlegitimate files signed with this certificate. It’s possible that the attackers used a shell\ncompany or appropriated a defunct company to issue this digital certificate.\n\nHermeticWiper Digital Signature\n\nThis is an early effort to analyze the first available sample of HermeticWiper. We recognize\nthat the situation on the ground in Ukraine is evolving rapidly and hope that we can\ncontribute our small part to the collective analysis effort.\n\n## Technical Analysis\n\nAt first glance, HermeticWiper appears to be a custom-written application with very few\nstandard functions. The malware sample is 114KBs in size and roughly 70% of that is\ncomposed of resources. The developers are using a tried and tested technique of wiper\nmalware, abusing a benign partition management driver, in order to carry out the more\n[damaging components of their attacks. Both the Lazarus Group (Destover) and APT33](https://operationblockbuster.com/wp-content/uploads/2016/02/Operation-Blockbuster-Destructive-Malware-Report.pdf)\n\n\n-----\n\n[(Shamoon) took advantage of Eldos Rawdisk in order to get direct userland access to the](https://securelist.com/shamoon-the-wiper-further-details-part-ii/57784/)\nfilesystem without calling Windows APIs. HermeticWiper uses a similar technique by\nabusing a different driver, `empntdrv.sys .`\n\nHermeticWiper resources containing EaseUS Partition Manager drivers\n\nThe copies of the driver are ms-compressed resources. The malware deploys one of these\ndepending on the OS version, bitness, and SysWow64 redirection.\n\nEaseUS driver resource selection\n\nThe benign EaseUS driver is abused to do a fair share of the heavy-lifting when it comes to\naccessing Physical Drives directly as well as getting partition information. This adds to the\ndifficulty of analyzing HermeticWiper, as a lot of functionality is deferred to\n```\nDeviceIoControl calls with specific IOCTLs.\n\n## MBR and Partition Corruption\n\n```\nHermeticWiper enumerates a range of Physical Drives multiple times, from 0-100. For each\nPhysical Drive, the `\\\\.\\EPMNTDRV\\ device is called for a device number.`\n\n\n-----\n\nThe malware then focuses on corrupting the first 512 bytes, the Master Boot Record (MBR)\nfor every Physical Drive. While that should be enough for the device not to boot again,\nHermeticWiper proceeds to enumerate the partitions for all possible drives.\n\nThey then differentiate between FAT and NTFS partitions. In the case of a FAT partition, the\nmalware calls the same ‘bit fiddler’ to corrupt the partition. For NTFS, the HermeticWiper\nparses the Master File Table before calling this same bit fiddling function again.\n\nMFT parsing and bit fiddling calls\n\nWe euphemistically refer to the bit fiddling function in the interest of brevity. Looking\nthrough it, we see calls to Windows APIs to acquire a cryptographic context provider and\ngenerate random bytes. It’s likely this is being used for an inlined crypto implementation and\nbyte overwriting, but the mechanism isn’t entirely clear at this time.\n\nFurther functionality refers to interesting MFT fields ( $bitmap, `$logfile ) and NTFS`\nstreams ( $DATA, `$I30,` `$INDEX_ALLOCATION ). The malware also enumerates common`\nfolders (‘My Documents’, ‘Desktop’, ‘AppData’), makes references to the registry (‘ntuser’),\nand Windows Event Logs ( \"\\\\\\\\?\\\\C:\\\\Windows\\\\System32\\\\winevt\\\\Logs\" ). Our\nanalysis is ongoing to determine how this functionality is being used, but it is clear that\nhaving already corrupted the MBR and partitions for all drives, the victim system should be\ninoperable by this point of the execution.\n\nAlong the way, HermeticWiper’s more mundane operations provide us with further IOCs to\nmonitor for. These include the momentary creation of the abused driver as well as a system\nservice. It also modifies several registry keys, including setting the\n\n\n-----\n\n```\nSYSTEM\\CurrentControlSet\\Control\\CrashControl CrashDumpEnabled key to 0,\n\n```\neffectively disabling crash dumps before the abused driver’s execution starts.\n\nDisabling CrashDumps via the registry\n\nFinally, the malware waits on sleeping threads before initiating a system shutdown, finalizing\nthe malware’s devastating effect.\n\n## Conclusion\n\nAfter a week of defacements and increasing DDoS attacks, the proliferation of sabotage\noperations through wiper malware is an expected and regrettable escalation. At this time, we\nhave a very small sliver of aperture into the attacks in Ukraine and subsequent spillover into\nneighboring countries and allies. If there’s a silver lining to such a difficult situation, it’s\nseeing the open collaboration between threat intel research teams, independent researchers,\nand journalists looking to get the story straight. Our thanks to the researchers at Symantec,\nESET, Stairwell, and RedCanary among others who’ve contributed samples, time, and\nexpertise.\n\n## SentinelOne Customers Protected\n\nWatch Video At: https://youtu.be/keWfVA6F4IM\n\n\n-----\n\n## Indicators of Compromise\n\n**HermeticWiper** **SHA1**\n\nWin32 EXE 912342f1c840a42f6b74132f8a7c4ffe7d40fb77\n\nWin32 EXE 61b25d11392172e587d8da3045812a66c3385451\n\n**ms-compressed** **SHA1**\n\nRCDATA_DRV_X64 a952e288a1ead66490b3275a807f52e5\n\nRCDATA_DRV_X86 231b3385ac17e41c5bb1b1fcb59599c4\n\nRCDATA_DRV_XP_X64 095a1678021b034903c85dd5acb447ad\n\nRCDATA_DRV_XP_X86 eb845b7a16ed82bd248e395d9852f467\n```\nrule MAL_HERMETIC_WIPER {\n  meta:\n   desc = \"HermeticWiper - broad hunting rule\"\n   author = \"Friends @ SentinelLabs\"\n   version = \"1.0\"\n   last_modified = \"02.23.2022\"\n   hash = \"1bc44eef75779e3ca1eefb8ff5a64807dbc942b1e4a2672d77b9f6928d292591\"\n  strings:\n    $string1 = \"DRV_XP_X64\" wide ascii nocase\n    $string2 = \"EPMNTDRV\\\\%u\" wide ascii nocase\n    $string3 = \"PhysicalDrive%u\" wide ascii nocase\n    $cert1 = \"Hermetica Digital Ltd\" wide ascii nocase\n  condition:\n   uint16(0) == 0x5A4D and\n   all of them\n}\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/h298v7gvjrs3yla6djys8pir9vayv6vo"
    ],
    "report_names": [
        "Sentinelone_HermeticWiper-Ukraine(02-23-2022)"
    ],
    "threat_actors": [
        {
            "id": "32a223a8-3c79-4146-87c5-8557d38662ae",
            "created_at": "2022-10-25T15:50:23.703698Z",
            "updated_at": "2025-03-27T02:00:55.528031Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Lazarus Group",
                "Labyrinth Chollima",
                "HIDDEN COBRA",
                "Guardians of Peace",
                "NICKEL ACADEMY",
                "Diamond Sleet"
            ],
            "source_name": "MITRE:Lazarus Group",
            "tools": [
                "RawDisk",
                "Proxysvc",
                "BADCALL",
                "FALLCHILL",
                "WannaCry",
                "HOPLIGHT",
                "TYPEFRAME",
                "Dtrack",
                "HotCroissant",
                "HARDRAIN",
                "Dacls",
                "KEYMARBLE",
                "TAINTEDSCRIBE",
                "AuditCred",
                "netsh",
                "ECCENTRICBANDWAGON",
                "AppleJeus",
                "BLINDINGCAN",
                "ThreatNeedle",
                "Volgmer",
                "Cryptoistic",
                "RATANKBA",
                "Bankshot",
                "Torisma",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "b23e717c-0b27-47e0-b3c8-4defe6dd857f",
            "created_at": "2023-01-06T13:46:38.367369Z",
            "updated_at": "2025-03-27T02:00:02.815758Z",
            "deleted_at": null,
            "main_name": "APT33",
            "aliases": [
                "ATK35",
                "Peach Sandstorm",
                "TA451",
                "APT 33",
                "Elfin",
                "Refined Kitten",
                "MAGNALLIUM",
                "HOLMIUM",
                "COBALT TRINITY",
                "G0064"
            ],
            "source_name": "MISPGALAXY:APT33",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9fe49a5b-f3e6-4fbf-99a1-db15dad460c3",
            "created_at": "2024-05-01T02:03:08.045004Z",
            "updated_at": "2025-03-27T02:05:17.325038Z",
            "deleted_at": null,
            "main_name": "COBALT TRINITY",
            "aliases": [
                "Elfin ",
                "HOLMIUM ",
                "MAGNALIUM ",
                "Peach Sandstorm ",
                "Refined Kitten ",
                "TA451 ",
                "APT33 "
            ],
            "source_name": "Secureworks:COBALT TRINITY",
            "tools": [
                " Cadlotcorg",
                " Dello RAT",
                " Imminent Monitor",
                " KDALogger",
                " Koadic",
                " NanoCore",
                " NetWire",
                " POWERTON",
                " PoshC2",
                " Poylog",
                " PupyRAT",
                " Schoolbag",
                "AutoCore"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "9e767b38-12ae-4ef7-9878-5ce1701066d7",
            "created_at": "2024-05-01T02:03:08.131819Z",
            "updated_at": "2025-03-27T02:05:17.413497Z",
            "deleted_at": null,
            "main_name": "NICKEL ACADEMY",
            "aliases": [
                "COVELLITE ",
                "CTG-2460 ",
                "Diamond Sleet ",
                "Guardians of Peace",
                "HIDDEN COBRA ",
                "High Anonymous",
                "Labyrinth Chollima ",
                "NNPT Group",
                "New Romanic Cyber Army Team",
                "Temp.Hermit ",
                "The Lazarus Group ",
                "UNC577 ",
                "Who Am I?",
                "Whois Team",
                "ZINC ",
                "Black Artemis "
            ],
            "source_name": "Secureworks:NICKEL ACADEMY",
            "tools": [
                " DarkMessenger",
                " Destover",
                " Duuzer",
                " HOPLIGHT",
                " Joanap",
                " KorHigh",
                " LiveJinx",
                " Volgmer",
                "Brambul"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e5ff825b-0456-4013-b90a-971b93def74a",
            "created_at": "2022-10-25T15:50:23.824058Z",
            "updated_at": "2025-03-27T02:00:55.553346Z",
            "deleted_at": null,
            "main_name": "APT33",
            "aliases": [
                "APT33",
                "HOLMIUM",
                "Elfin",
                "Peach Sandstorm"
            ],
            "source_name": "MITRE:APT33",
            "tools": [
                "PowerSploit",
                "AutoIt backdoor",
                "PoshC2",
                "Mimikatz",
                "NanoCore",
                "DEADWOOD",
                "StoneDrill",
                "POWERTON",
                "LaZagne",
                "TURNEDUP",
                "NETWIRE",
                "Pupy",
                "ftp",
                "Shamoon"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f32df445-9fb4-4234-99e0-3561f6498e4e",
            "created_at": "2022-10-25T16:07:23.756373Z",
            "updated_at": "2025-03-27T02:02:09.966155Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "APT-C-26",
                "ATK 3",
                "Appleworm",
                "Citrine Sleet",
                "DEV-0139",
                "Diamond Sleet",
                "Gleaming Pisces",
                "Gods Apostles",
                "Gods Disciples",
                "Group 77",
                "Guardians of Peace",
                "Hastati Group",
                "Hidden Cobra",
                "ITG03",
                "Jade Sleet",
                "Labyrinth Chollima",
                "Lazarus Group",
                "NewRomanic Cyber Army Team",
                "Operation 99",
                "Operation AppleJeus",
                "Operation AppleJeus sequel",
                "Operation Blockbuster: Breach of Sony Pictures Entertainment",
                "Operation CryptoCore",
                "Operation Dream Job",
                "Operation Dream Magic",
                "Operation Flame",
                "Operation GhostSecret",
                "Operation In(ter)caption",
                "Operation LolZarus",
                "Operation Marstech Mayhem",
                "Operation No Pineapple!",
                "Operation North Star",
                "Operation Phantom Circuit",
                "Operation Sharpshooter",
                "Operation Ten Days of Rain / DarkSeoul",
                "Operation Troy",
                "SectorA01",
                "Slow Pisces",
                "TA404",
                "TraderTraitor",
                "UNC2970",
                "UNC4034",
                "UNC4736",
                "UNC4899",
                "UNC577",
                "Whois Hacking Team"
            ],
            "source_name": "ETDA:Lazarus Group",
            "tools": [
                "3CX Backdoor",
                "3Rat Client",
                "3proxy",
                "AIRDRY",
                "ARTFULPIE",
                "ATMDtrack",
                "AlphaNC",
                "Alreay",
                "Andaratm",
                "AngryRebel",
                "AppleJeus",
                "Aryan",
                "AuditCred",
                "BADCALL",
                "BISTROMATH",
                "BLINDINGCAN",
                "BTC Changer",
                "BUFFETLINE",
                "BanSwift",
                "Bankshot",
                "Bitrep",
                "Bitsran",
                "BlindToad",
                "Bookcode",
                "BootWreck",
                "BottomLoader",
                "Brambul",
                "BravoNC",
                "Breut",
                "COLDCAT",
                "COPPERHEDGE",
                "CROWDEDFLOUNDER",
                "Castov",
                "CheeseTray",
                "CleanToad",
                "ClientTraficForwarder",
                "CollectionRAT",
                "Concealment Troy",
                "Contopee",
                "CookieTime",
                "Cyruslish",
                "DAVESHELL",
                "DBLL Dropper",
                "DLRAT",
                "DRATzarus",
                "DRATzarus RAT",
                "Dacls",
                "Dacls RAT",
                "DarkComet",
                "DarkKomet",
                "DeltaCharlie",
                "DeltaNC",
                "Dembr",
                "Destover",
                "DoublePulsar",
                "Dozer",
                "Dtrack",
                "Duuzer",
                "DyePack",
                "ECCENTRICBANDWAGON",
                "ELECTRICFISH",
                "Escad",
                "EternalBlue",
                "FALLCHILL",
                "FYNLOS",
                "FallChill RAT",
                "Farfli",
                "Fimlis",
                "FoggyBrass",
                "FudModule",
                "Fynloski",
                "Gh0st RAT",
                "Ghost RAT",
                "Gopuram",
                "HARDRAIN",
                "HIDDEN COBRA RAT/Worm",
                "HLOADER",
                "HOOKSHOT",
                "HOPLIGHT",
                "HOTCROISSANT",
                "HOTWAX",
                "HTTP Troy",
                "Hawup",
                "Hawup RAT",
                "Hermes",
                "HotCroissant",
                "HotelAlfa",
                "Hotwax",
                "HtDnDownLoader",
                "Http Dr0pper",
                "ICONICSTEALER",
                "Joanap",
                "Jokra",
                "KANDYKORN",
                "KEYMARBLE",
                "Kaos",
                "KillDisk",
                "KillMBR",
                "Koredos",
                "Krademok",
                "LIGHTSHIFT",
                "LIGHTSHOW",
                "LOLBAS",
                "LOLBins",
                "Lazarus",
                "LightlessCan",
                "Living off the Land",
                "MATA",
                "MBRkiller",
                "MagicRAT",
                "Manuscrypt",
                "Mimail",
                "Mimikatz",
                "Moudour",
                "Mydoom",
                "Mydoor",
                "Mytob",
                "NACHOCHEESE",
                "NachoCheese",
                "NestEgg",
                "NickelLoader",
                "NineRAT",
                "Novarg",
                "NukeSped",
                "OpBlockBuster",
                "PCRat",
                "PEBBLEDASH",
                "PLANKWALK",
                "POOLRAT",
                "PSLogger",
                "PhanDoor",
                "Plink",
                "PondRAT",
                "PowerBrace",
                "PowerRatankba",
                "PowerShell RAT",
                "PowerSpritz",
                "PowerTask",
                "Preft",
                "ProcDump",
                "Proxysvc",
                "PuTTY Link",
                "QUICKRIDE",
                "QUICKRIDE.POWER",
                "Quickcafe",
                "QuiteRAT",
                "R-C1",
                "ROptimizer",
                "Ratabanka",
                "RatabankaPOS",
                "Ratankba",
                "RatankbaPOS",
                "RawDisk",
                "RedShawl",
                "Rifdoor",
                "Rising Sun",
                "Romeo-CoreOne",
                "RomeoAlfa",
                "RomeoBravo",
                "RomeoCharlie",
                "RomeoCore",
                "RomeoDelta",
                "RomeoEcho",
                "RomeoFoxtrot",
                "RomeoGolf",
                "RomeoHotel",
                "RomeoMike",
                "RomeoNovember",
                "RomeoWhiskey",
                "Romeos",
                "RustBucket",
                "SHADYCAT",
                "SHARPKNOT",
                "SIGFLIP",
                "SIMPLESEA",
                "SLICKSHOES",
                "SORRYBRUTE",
                "SUDDENICON",
                "SUGARLOADER",
                "SheepRAT",
                "SierraAlfa",
                "SierraBravo",
                "SierraCharlie",
                "SierraJuliett-MikeOne",
                "SierraJuliett-MikeTwo",
                "SimpleTea",
                "SimplexTea",
                "SmallTiger",
                "Stunnel",
                "TAINTEDSCRIBE",
                "TAXHAUL",
                "TFlower",
                "TOUCHKEY",
                "TOUCHMOVE",
                "TOUCHSHIFT",
                "TOUCHSHOT",
                "TWOPENCE",
                "TYPEFRAME",
                "Tdrop",
                "Tdrop2",
                "ThreatNeedle",
                "Tiger RAT",
                "TigerRAT",
                "Trojan Manuscript",
                "Troy",
                "TroyRAT",
                "VEILEDSIGNAL",
                "VHD",
                "VHD Ransomware",
                "VIVACIOUSGIFT",
                "VSingle",
                "ValeforBeta",
                "Volgmer",
                "Vyveva",
                "W1_RAT",
                "Wana Decrypt0r",
                "WanaCry",
                "WanaCrypt",
                "WanaCrypt0r",
                "WannaCry",
                "WannaCrypt",
                "WannaCryptor",
                "WbBot",
                "Wcry",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "WinorDLL64",
                "Winsec",
                "WolfRAT",
                "Wormhole",
                "YamaBot",
                "Yort",
                "ZetaNile",
                "concealment_troy",
                "http_troy",
                "httpdr0pper",
                "httpdropper",
                "klovbot",
                "sRDI"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716502,
    "ts_updated_at": 1743041843,
    "ts_creation_date": 1645736982,
    "ts_modification_date": 1645736982,
    "files": {
        "pdf": "https://archive.orkl.eu/6889710cb527eb5d941412a7145d68bbbfa12a10.pdf",
        "text": "https://archive.orkl.eu/6889710cb527eb5d941412a7145d68bbbfa12a10.txt",
        "img": "https://archive.orkl.eu/6889710cb527eb5d941412a7145d68bbbfa12a10.jpg"
    }
}