{
    "id": "3a2ebec3-541f-4bd0-8799-fbc785b1bae5",
    "created_at": "2023-01-12T15:06:09.757685Z",
    "updated_at": "2025-03-27T02:16:34.833905Z",
    "deleted_at": null,
    "sha1_hash": "87133b04cb4f43e8cefcd0f78f2c77cc866d2db8",
    "title": "2021-06-28 - New Ransomware Variant Uses Golang Packer",
    "authors": "",
    "file_creation_date": "2022-05-28T01:30:06Z",
    "file_modification_date": "2022-05-28T01:30:06Z",
    "file_size": 2035954,
    "plain_text": "# New Ransomware Variant Uses Golang Packer\n\n**[crowdstrike.com/blog/new-ransomware-variant-uses-golang-packer/](https://www.crowdstrike.com/blog/new-ransomware-variant-uses-golang-packer/)**\n\nJune 28, 2021\n\n[Alexandru Ghita](https://www.crowdstrike.com/blog/author/alexandru-ghita/) [From The Front Lines](https://www.crowdstrike.com/blog/category/from-the-front-lines/)\n\n\nJune 28, 2021\n\n\nCrowdStrike recently observed a ransomware sample borrowing implementations from previous\nHelloKitty and FiveHands variants and using a Golang packer compiled with the most recent version of\nGolang (Go1.16, released mid-February 2021).\n\nThese ransomware families have been active since late 2019 and analyzed by the research\ncommunity under different names based on various code overlaps.\n\nThe similarities of this recent sample with previous HelloKitty and FiveHands variants involve similar\nransomware functions written in C++, accepting CLI arguments, the use of four magic bytes appended\nto the encrypted files, and using an embedded public key.\n\n## Ransomware Sample Analysis\n\nSimilar to FiveHands ransomware, this variant uses a unique executable packer that requires a key\nvalue to decrypt the payload in memory using a command-line switch “-key” . This key is used to\ndecrypt the embedded payload ransomware binary directly into memory. This method of using a\n\n\n-----\n\nmemory-only dropper prevents security solutions from detecting the final payload without the unique\nkey used to execute the packer.\n\nWhat’s new about this ransomware variant is the use of a Golang packer to encrypt the C++ written\npayload. Although Golang-written malware and packers are not new, compiling it with the latest\nGolang (Go1.16) makes it challenging to debug for malware researchers. That’s because all\nnecessary libraries are statically linked and included in the compiler binary and the function name\nrecovery is difficult.\n\nFigure 1. Golang Encryptor help menu (Click to enlarge)\n\nThe sample accepts different CLI arguments, suggesting it can limit the encryption to a specified path.\nAfter executing with the right key parameter ( Command execution bin.exe -key \"[REDACTED]\" ),\nit starts decrypting the payload that is reflectively loaded into memory. The payload is the actual\nransomware written in C++.\n\nFigure 2. Executable packer and key on the command-line (Click to enlarge)\n\nThe ransomware has the capability to also clear RecycleBin and to delete each Shadow Copy by ID\n(“Win32_ShadowCopy.ID”) using WMI functions (Figure 3) similar to the other ransomware variants\nlike FiveHands and HelloKitty. We have also identified an implementation of “IoCompletionPorts” for a\nbetter threading model in the encryption process, similar to FiveHands.\n\n\n-----\n\nFigure 3. WMI functions for deleting shadow copies (Click to enlarge)\n\nA RSA public key is hard-coded in the code block. This is used to encrypt each symmetric key per file\nand append it at the end of the encrypted file along with the four bytes `D0 BA AD DE . The last four`\nbytes are used to check if the targeted file was previously encrypted. In the symmetric key generation\nprocess, we also found code implementation for the use of the Salsa20 algorithm. At the end, the final\nfiles are renamed using the `.` `locked` extension.\n\nA ransom note is placed into each folder and directory, including the root path, after the files are\nencrypted. The ransom note file is named `read_me_lock.txt` and provides instructions to the victim\non how to recover their encrypted files.\n\nFigure 4. Ransom note (Click to enlarge)\n\nThe message does not offer any bitcoin wallet in which payment should be made. Instead, it offers a\nTOR link where victims can contact the ransom operators. The message also claims to have extracted\nover 1 TB of personal and sensitive data from the victim, potentially threatening extortion.\n\n\n-----\n\nVisiting the TOR address, victims will be directed to a temporary chat session where they are\nencouraged to engage with the ransomware operators to negotiate decryption fees.\n\nFigure 5. TOR chat box for communicating with operators (Click to enlarge)\n\n## CrowdStrike Falcon Protection\n\nThe CrowdStrike Falcon® sensor has the ability to detect the execution of the Golang packer using\nmachine learning (ML), identifying it during the very early stage of execution before it can deliver the\nransomware payload.\n\nFalcon’s ML algorithm can protect customers by providing coverage against this analyzed threat, as\nillustrated below.\n\nFigure 6. Packer process blocked by ML algorithm (Click to enlarge)\n\n**Indicators of Compromise (IOCs)**\n\n**File** **SHA256**\n\n\n-----\n\nRansomware\nPayload\n\nGolang\nPacker\n\nHardcoded\nAsymmetric\npublic key\nextracted\nfrom strings\n\n\nb24dcfdda948b339637fe507cf032ec233288691b700e1585cb34b4190704858\n\neeb51dce12f243b332b51d7b1b11ecff155dd823ff8f9b79d6ad486cc49098ba\n\n—–BEGIN PUBLIC KEY—–\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAye/wtpovm5pDdZvFRrpj\n\nuob4f2bMN9/Ws3TR4MwR0Pngsvpf2b1iO0wjCZNx9wrut+7s5myMPFpE50Qw6Q7o\n\noIFNIguxDyyC3saLlUvty+eohxY0JBv1ljMads9PzjtHvYjlaiB9/HCDNQhucGt3\n\nSlCKQ0bW3Sx2t4yEXHM2T0Qz+pEM2XG2Lkm7HATW34JHyKkJcdm850vxKvDX/QIN\n\nC9obv4bvpUgBZq836aT9Uu5B7LBZuMeUNJPq5WYwQOgPhitjCpXZTP1OJrT6Fh6V\n\n0+pnupgv/NqzFCbSkqa96fXM0Lo+EMzI4sWfPhTlZ+qKynr/nw0VCw7G+T1wRC7M\n\n0wIDAQAB\n\n—–END PUBLIC KEY—–\n\n\n**Additional Resources**\n\n_[Learn more about ransomware adversaries in the CrowdStrike Adversary Universe.](https://adversary.crowdstrike.com/adversary/cozy-bear/)_\n_[Download the CrowdStrike 2021 Global Threat Report for more information about adversaries](https://www.crowdstrike.com/resources/reports/global-threat-report/)_\n_tracked by CrowdStrike Intelligence in 2020._\n_[See how the powerful, cloud-native CrowdStrike Falcon® platform protects customers from the](https://www.crowdstrike.com/endpoint-security-products/)_\n_latest variants of ransomware in these blogs: DarkSide Goes Dark: How CrowdStrike Falcon_\n_Customers Were Protected and_ _Under Attack: Protecting Against Conti, DarkSide, REvil and_\n_Other Ransomware._\n_[Get a full-featured free trial of CrowdStrike Falcon Prevent™ and learn how true next-gen AV](https://go.crowdstrike.com/try-falcon-prevent.html)_\n_performs against today’s most sophisticated threats._\n\nRelated Content\n\n\n-----\n\nCompromised Docker Honeypots Used for Pro-Ukrainian DoS Attack\n\n\n-----\n\nNavigating the Five Stages of Grief During a Breach\n\nLemonDuck Targets Docker for Cryptomining Operations\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-06-28 - New Ransomware Variant Uses Golang Packer.pdf"
    ],
    "report_names": [
        "2021-06-28 - New Ransomware Variant Uses Golang Packer.pdf"
    ],
    "threat_actors": [
        {
            "id": "5b748f86-ac32-4715-be9f-6cf25ae48a4e",
            "created_at": "2024-06-04T02:03:07.956135Z",
            "updated_at": "2025-03-27T02:05:17.407352Z",
            "deleted_at": null,
            "main_name": "IRON HEMLOCK",
            "aliases": [
                "ATK7 ",
                "Blue Kitsune ",
                "Cozy Bear ",
                "The Dukes",
                "UNC2452 ",
                "YTTRIUM ",
                "APT29 "
            ],
            "source_name": "Secureworks:IRON HEMLOCK",
            "tools": [
                " CozyCar",
                " CozyDuke",
                " DiefenDuke",
                " FatDuke",
                " HAMMERTOSS",
                " LiteDuke",
                " MiniDuke",
                " OnionDuke",
                " PolyglotDuke",
                " RegDuke",
                " RegDuke Loader",
                " SeaDuke",
                " Sliver",
                "CosmicDuke"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "20d3a08a-3b97-4b2f-90b8-92a89089a57a",
            "created_at": "2022-10-25T15:50:23.548494Z",
            "updated_at": "2025-03-27T02:00:55.49688Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "APT29",
                "IRON RITUAL",
                "IRON HEMLOCK",
                "NobleBaron",
                "Dark Halo",
                "NOBELIUM",
                "UNC2452",
                "YTTRIUM",
                "The Dukes",
                "Cozy Bear",
                "CozyDuke",
                "SolarStorm",
                "Blue Kitsune",
                "UNC3524",
                "Midnight Blizzard"
            ],
            "source_name": "MITRE:APT29",
            "tools": [
                "PinchDuke",
                "ROADTools",
                "WellMail",
                "CozyCar",
                "Mimikatz",
                "Tasklist",
                "OnionDuke",
                "FatDuke",
                "POSHSPY",
                "EnvyScout",
                "SoreFang",
                "GeminiDuke",
                "GoldMax",
                "FoggyWeb",
                "SDelete",
                "PolyglotDuke",
                "AADInternals",
                "MiniDuke",
                "SeaDuke",
                "Sibot",
                "RegDuke",
                "CloudDuke",
                "GoldFinder",
                "AdFind",
                "PsExec",
                "NativeZone",
                "Systeminfo",
                "ipconfig",
                "Impacket",
                "Cobalt Strike",
                "PowerDuke",
                "QUIETEXIT",
                "HAMMERTOSS",
                "BoomBox",
                "CosmicDuke",
                "WellMess",
                "VaporRage",
                "LiteDuke"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "46b3c0fc-fa0c-4d63-a38a-b33a524561fb",
            "created_at": "2023-01-06T13:46:38.393409Z",
            "updated_at": "2025-03-27T02:00:02.822155Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "The Dukes",
                "Minidionis",
                "Grizzly Steppe",
                "G0016",
                "Blue Kitsune",
                "BlueBravo",
                "SeaDuke",
                "Cloaked Ursa",
                "YTTRIUM",
                "ATK7",
                "Nobelium",
                "UAC-0029",
                "Group 100",
                "COZY BEAR",
                "IRON HEMLOCK",
                "TA421",
                "ITG11"
            ],
            "source_name": "MISPGALAXY:APT29",
            "tools": [
                "QUARTERRIG",
                "SNOWYAMBER",
                "HALFRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f27790ff-4ee0-40a5-9c84-2b523a9d3270",
            "created_at": "2022-10-25T16:07:23.341684Z",
            "updated_at": "2025-03-27T02:02:09.74554Z",
            "deleted_at": null,
            "main_name": "APT 29",
            "aliases": [
                "APT 29",
                "ATK 7",
                "Blue Dev 5",
                "BlueBravo",
                "Cloaked Ursa",
                "CloudLook",
                "Cozy Bear",
                "Dark Halo",
                "Earth Koshchei",
                "Grizzly Steppe",
                "Group 100",
                "ITG11",
                "Iron Hemlock",
                "Iron Ritual",
                "Midnight Blizzard",
                "Minidionis",
                "Nobelium",
                "NobleBaron",
                "Operation Ghost",
                "Operation Office monkeys",
                "Operation StellarParticle",
                "SilverFish",
                "Solar Phoenix",
                "SolarStorm",
                "StellarParticle",
                "TEMP.Monkeys",
                "The Dukes",
                "UNC2452",
                "UNC3524",
                "Yttrium"
            ],
            "source_name": "ETDA:APT 29",
            "tools": [
                "7-Zip",
                "ATI-Agent",
                "AdFind",
                "Agentemis",
                "AtNow",
                "BEATDROP",
                "BotgenStudios",
                "CEELOADER",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobalt Strike",
                "CobaltStrike",
                "CosmicDuke",
                "Cozer",
                "CozyBear",
                "CozyCar",
                "CozyDuke",
                "Danfuan",
                "EnvyScout",
                "EuroAPT",
                "FatDuke",
                "FoggyWeb",
                "GeminiDuke",
                "Geppei",
                "GoldFinder",
                "GoldMax",
                "GraphDrop",
                "GraphicalNeutrino",
                "GraphicalProton",
                "HAMMERTOSS",
                "HammerDuke",
                "LOLBAS",
                "LOLBins",
                "LiteDuke",
                "Living off the Land",
                "MagicWeb",
                "Mimikatz",
                "MiniDionis",
                "MiniDuke",
                "NemesisGemina",
                "NetDuke",
                "OnionDuke",
                "POSHSPY",
                "PinchDuke",
                "PolyglotDuke",
                "PowerDuke",
                "QUIETEXIT",
                "ROOTSAW",
                "RegDuke",
                "Rubeus",
                "SNOWYAMBER",
                "SPICYBEAT",
                "SUNSHUTTLE",
                "SeaDaddy",
                "SeaDask",
                "SeaDesk",
                "SeaDuke",
                "Sharp-SMBExec",
                "SharpView",
                "Sibot",
                "Solorigate",
                "SoreFang",
                "TinyBaron",
                "WINELOADER",
                "WellMail",
                "WellMess",
                "cobeacon",
                "elf.wellmess",
                "reGeorg",
                "tDiscoverer"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535969,
    "ts_updated_at": 1743041794,
    "ts_creation_date": 1653701406,
    "ts_modification_date": 1653701406,
    "files": {
        "pdf": "https://archive.orkl.eu/87133b04cb4f43e8cefcd0f78f2c77cc866d2db8.pdf",
        "text": "https://archive.orkl.eu/87133b04cb4f43e8cefcd0f78f2c77cc866d2db8.txt",
        "img": "https://archive.orkl.eu/87133b04cb4f43e8cefcd0f78f2c77cc866d2db8.jpg"
    }
}