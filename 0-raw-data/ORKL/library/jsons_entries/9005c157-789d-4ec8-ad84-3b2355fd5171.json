{
    "id": "9005c157-789d-4ec8-ad84-3b2355fd5171",
    "created_at": "2023-01-12T15:05:19.698946Z",
    "updated_at": "2025-03-27T02:09:29.944136Z",
    "deleted_at": null,
    "sha1_hash": "b9126c2caed219de1107b96ac493021435f0a001",
    "title": "2022-04-12 - Threat Profile- REvil",
    "authors": "",
    "file_creation_date": "2022-05-27T23:01:05Z",
    "file_modification_date": "2022-05-27T23:01:05Z",
    "file_size": 120981,
    "plain_text": "# Threat Report\n\n**connectwise.com/resources/revil-profile**\n\nIn the [2022 MSP Threat Report, the CRU identified the top 5 ransomware threats targeting](https://www.connectwise.com/resources/ebook-2022-msp-threat-report)\nMSPs in 2021 and provided a brief description of each. This page includes supplemental\nmaterial with a more detailed breakdown of the TTPs and suggested mitigation techniques.\n\n## REvil\n\nRansomware-as-a-service that first appeared in April 2019\nHighly configurable, successor to GandCrab\nUses the double extortion method of encrypting files and threatening to leak stolen data\nResponsible for large scale ransomware attacks targeting over 40 MSPs and at least\n1500 of their customers using Kaseya VSA in July 2021\nREvil servers went offline in October 2021, then in January 2022, the Russian Federal\nSecurity Service said they had dismantled REvil and charged several of its members\nafter being provided information by the US\n\n\n## MITRE ATT&CK mapping®\n\nabout\n\nREvil (S0496)\n\n2021 Top Threat Actors Targeting MSPs\n\n**Initial** **Privilege**\n\n**Execution**\n\n**Access** **Escalation**\n\nDrive-by Commandand Scripting Access Token\n\nCompromise Interpreter Manipulation\n\nToken\n\nPhishing PowerShell Impersonation/Theft\n\nSpearphishing Windows Create Process\n\nAttachment Command Shell with Token\n\nVisual Process\n\nBasic Injection\n\nNative API\n\nUser\n\nExecution\n\nMalicious\n\nFile\n\nWindows Management\n\nInstrumentation\n\n## REvil TTPs and Mitigations\n\n\n**Exfiltration**\n\n\n**Impact**\n\n\nExfiltration\n\nOver C2 Channel\n\n|Initial Access|Col2|\n|---|---|\n|Drive-by Compromise||\n|Phishing||\n||Spearphishing Attachment|\n\n|Privilege Escalation|Col2|\n|---|---|\n|Access Token Manipulation||\n||Token Impersonation/Theft|\n||Create Process with Token|\n|Process Injection||\n\n|Command and Control|Col2|\n|---|---|\n|Application Layer Protocol||\n||Web Protocols|\n|Encrypted Channel||\n||Asymmetric Cryptography|\n|Ingress Tool Transfer||\n\n|Execution|Col2|\n|---|---|\n|Command and Scripting Interpreter||\n||PowerShell|\n||Windows Command Shell|\n||Visual Basic|\n|Native API||\n|User Execution||\n||Malicious File|\n|Windows Management Instrumentation||\n\n|Discovery|Col2|\n|---|---|\n|File and Directory Discovery||\n|Permission Groups Discovery||\n||Domain Groups|\n|Query Registry||\n|System Information Discovery||\n|System Location Discovery||\n||System Language Discovery|\n|System Service Discovery||\n\n|Defense Evasion|Col2|\n|---|---|\n|Deobfuscate/Decode Files or Information||\n|Impair Defenses||\n||Disable or Modify Tools|\n||Safe Mode Boot|\n|Indicator Removal on Host||\n||File Deletion|\n|Masquerading||\n||Match Legitimate Name or Location|\n|Modify Registry||\n|Obfuscated Files or Information||\n\n\n**ATT&CK Tactic** **ATT&CK Technique** **DEFEND Mitigations**\n\n\n-----\n\nInitial Access [T1189 – Drive-by](https://attack.mitre.org/techniques/T1189/)\nCompromise:\n\nAdversaries may gain\naccess to a system through\na user visiting a website\nover the normal course of\nbrowsing. With this\ntechnique, the user's web\nbrowser is typically targeted\nfor exploitation, but\nadversaries may also use\ncompromised websites for\nnon-exploitation behavior\nsuch as acquiring\nApplication Access Token.\n\n[M1050 - Exploit Protection:](https://attack.mitre.org/mitigations/M1050)\n\nSecurity applications that look for\nbehavior used during exploitation\nsuch as Windows Defender Exploit\nGuard (WDEG) and the Enhanced\nMitigation Experience Toolkit\n(EMET) can be used to mitigate\nsome exploitation behavior. Control\nflow integrity checking is another\nway to potentially identify and stop a\nsoftware exploit from occurring.\nMany of these protections depend\non the architecture and target\napplication binary for compatibility.\n\n[M1021 - Restrict Web-Based](https://attack.mitre.org/mitigations/M1021)\nContent:\n\nFor malicious code served up\nthrough ads, adblockers can help\nprevent that code from executing in\nthe first place. Script blocking\nextensions can help prevent the\nexecution of JavaScript that may\ncommonly be used during the\nexploitation process.\n\n\n[M1048 - Application](https://attack.mitre.org/mitigations/M1048)\nIsolation and\nSandboxing:\n\nBrowser sandboxes\ncan be used to\nmitigate some of the\nimpact of exploitation,\nbut sandbox escapes\nmay still exist.Other\ntypes of virtualization\nand application\nmicrosegmentation\nmay also mitigate the\nimpact of client-side\nexploitation. The risks\nof additional exploits\nand weaknesses in\nimplementation may\nstill exist for these\ntypes of systems.\n\n\n-----\n\n[M1051 – Update Software:](https://attack.mitre.org/mitigations/M1051)\n\nEnsure all browsers and plugins kept\nupdated can help prevent the exploit\nphase of this technique. Use modern\nbrowsers with security features\nturned on.\n\n[T1566.001 – Phishing:](https://attack.mitre.org/techniques/T1566/001)\nSpearphishing Attachment:\n\nAdversaries may send\nspearphishing emails with a\nmalicious attachment in an attempt\nto gain access to victim systems.\nSpearphishing attachment is a\nspecific variant of spearphishing.\nSpearphishing attachment is\ndifferent from other forms of\nspearphishing in that it employs the\nuse of malware attached to an email.\nAll forms of spearphishing are\nelectronically delivered social\nengineering targeted at a specific\nindividual, company, or industry.\n\n[M1031 - Network Intrusion](https://attack.mitre.org/mitigations/M1031)\nPrevention:\n\nNetwork intrusion prevention\nsystems and systems designed to\nscan and remove malicious email\nattachments can be used to block\nactivity.\n\n[M1021 - Restrict Web-Based](https://attack.mitre.org/mitigations/M1021)\nContent:\n\nBlock unknown or unused\nattachments by default that should\nnot be transmitted over email as a\nbest practice to prevent some\nvectors, such as .scr, .exe, .pif, .cpl,\netc. Some email scanning devices\ncan open and analyze compressed\nand encrypted formats, such as zip\nand rar that may be used to conceal\nmalicious attachments.\n\n\n[M1049 -](https://attack.mitre.org/mitigations/M1049)\nAntivirus/Antimalware:\n\nAnti-virus can also\nautomatically quarantine\nsuspicious files.\n\n\n-----\n\n[M1054 - Software Configuration:](https://attack.mitre.org/mitigations/M1054)\n\nUse anti-spoofing and email\nauthentication mechanisms to filter\nmessages based on validity checks\nof the sender domain (using SPF)\nand integrity of messages (using\nDKIM). Enabling these mechanisms\nwithin an organization (through\npolicies such as DMARC) may\nenable recipients (intra-org and\ncross domain) to perform similar\nmessage filtering and validation.\n\n[M1017 - User Training: Users can be](https://attack.mitre.org/mitigations/M1017)\ntrained to identify social engineering\ntechniques and spearphishing\nemails.\n\nExecution [T1059.001 – Command](https://attack.mitre.org/techniques/T1059/001/)\nand Scripting Interpreter –\nPowerShell:\n\nAdversaries may abuse\nPowerShell commands and\nscripts for execution.\nPowerShell is a powerful\ninteractive command-line\ninterface and scripting\nenvironment included in the\nWindows operating system.\n\n[M1045 - Code Signing:](https://attack.mitre.org/mitigations/M1045)\n\nSet PowerShell execution policy to\nexecute only signed scripts.\n\n\n[M1049 -](https://attack.mitre.org/mitigations/M1049)\nAntivirus/Antimalware:\n\nAnti-virus can be used\nto automatically\nquarantine suspicious\nfiles.\n\n\n-----\n\n[M1042 - Disable or Remove Feature](https://attack.mitre.org/mitigations/M1042)\nor Program:\n\nIt may be possible to remove\nPowerShell from systems when not\nneeded, but a review should be\nperformed to assess the impact to\nan environment, since it could be in\nuse for many legitimate purposes\nand administrative functions.\n\nDisable/restrict the WinRM Service\nto help prevent uses of PowerShell\nfor remote execution.\n\n[M1038 - Execution Prevention:](https://attack.mitre.org/mitigations/M1038)\n\nUse application control where\nappropriate.\n\n[M1026 - Privileged Account](https://attack.mitre.org/mitigations/M1026)\nManagement:\n\nWhen PowerShell is necessary,\nrestrict PowerShell execution policy\nto administrators. Be aware that\nthere are methods of bypassing the\nPowerShell execution policy,\ndepending on environment\nconfiguration.\n\n[T1059.003 – Windows Command](https://attack.mitre.org/techniques/T1059/003/)\nShell:\n\nAdversaries may abuse the\nWindows command shell for\nexecution. The Windows command\nshell (cmd) is the primary command\nprompt on Windows systems.\n\n\n[M1038 - Execution](https://attack.mitre.org/mitigations/M1038)\nPrevention:\n\nUse application control\nwhere appropriate.\n\n\n-----\n\n[T1059.005 – Command and](https://attack.mitre.org/techniques/T1059/005/)\nScripting Interpreter: Visual Basic:\n\nAdversaries may abuse Visual Basic\n(VB) for execution. VB is a\nprogramming language created by\nMicrosoft with interoperability with\nmany Windows technologies such\nas Component Object Model and the\nNative API through the Windows\nAPI. Although tagged as legacy with\nno planned future evolutions, VB is\nintegrated and supported in the\n.NET Framework and cross-platform\n.NET Core.\n\n[M1040 - Behavior Prevention on](https://attack.mitre.org/mitigations/M1040)\nEndpoint:\n\nOn Windows 10, enable Attack\nSurface Reduction (ASR) rules to\nprevent Visual Basic scripts from\nexecuting potentially malicious\ndownloaded content.\n\n[M1042 - Disable or Remove Feature](https://attack.mitre.org/mitigations/M1042)\nor Program:\n\nTurn off or restrict access to\nunneeded VB components.\n\n[M1038 - Execution Prevention:](https://attack.mitre.org/mitigations/M1038)\n\nUse application control where\nappropriate.\n\n[M1021 - Restrict Web-Based](https://attack.mitre.org/mitigations/M1021)\nContent:\n\nScript blocking extensions can help\nprevent the execution of scripts and\nHTA files that may commonly be\nused during the exploitation process.\nFor malicious code served up\nthrough ads, adblockers can help\nprevent that code from executing in\nthe first place.\n\n\n[M1049 -](https://attack.mitre.org/mitigations/M1049)\nAntivirus/Antimalware:\n\nAnti-virus can be used to\nautomatically quarantine\nsuspicious files.\n\n\n-----\n\n[T1106 – Native Application](https://attack.mitre.org/techniques/T1106)\nProgramming Interface (API)\n\n[M1038 - Execution Prevention:](https://attack.mitre.org/mitigations/M1038)\n\nIdentify and block potentially\nmalicious software executed that\nmay be executed through this\ntechnique by using application\ncontrol tools, like Windows Defender\nApplication Control, AppLocker, or\nSoftware Restriction Policies where\nappropriate.\n\n[T1204.002 – User Execution:](https://attack.mitre.org/techniques/T1204/002/)\nMalicious File:\n\nAn adversary may rely upon a user\nopening a malicious file in order to\ngain execution. Users may be\nsubjected to social engineering to\nget them to open a file that will lead\nto code execution. This user action\nwill typically be observed as followon behavior from Spearphishing\nAttachment. Adversaries may use\nseveral types of files that require a\nuser to execute them, including .doc,\n.pdf, .xls, .rtf, .scr, .exe, .lnk, .pif, and\n.cpl.\n\n[M1038 - Execution Prevention:](https://attack.mitre.org/mitigations/M1038)\n\nApplication control may be able to\nprevent the running of executables\nmasquerading as other files.\n\n\n[M1040 - Behavior](https://attack.mitre.org/mitigations/M1040)\nPrevention on Endpoint:\n\nOn Windows 10, enable\nAttack Surface Reduction\n(ASR) rules to prevent\nOffice VBA macros from\ncalling Win32 APIs.\n\n[M1040 - Behavior](https://attack.mitre.org/mitigations/M1040)\nPrevention on Endpoint:\n\nOn Windows 10, various\nAttack Surface Reduction\n(ASR) rules can be enabled\nto prevent the execution of\npotentially malicious\nexecutable files (such as\nthose that have been\ndownloaded and executed\nby Office\napplications/scripting\ninterpreters/email clients or\nthat do not meet specific\nprevalence, age, or trusted\nlist criteria). Note: clouddelivered protection must\nbe enabled for certain\nrules.\n\n\n-----\n\n[M1017 - User Training:](https://attack.mitre.org/mitigations/M1017)\n\nUse user training as a way to bring\nawareness to common phishing and\nspearphishing techniques and how\nto raise suspicion for potentially\nmalicious events.\n\n[T1047 – Windows Management](https://attack.mitre.org/techniques/T1047/)\nInstrumentation:\n\nAdversaries may abuse Windows\nManagement Instrumentation (WMI)\nto execute malicious commands and\npayloads. WMI is an administration\nfeature that provides a uniform\nenvironment to access Windows\nsystem components.\n\n[M1038 - Execution Prevention:](https://attack.mitre.org/mitigations/M1038)\n\nUse application control configured to\nblock execution of wmic.exe if it is\nnot required for a given system or\nnetwork to prevent potential misuse\nby adversaries. For example, in\nWindows 10 and Windows Server\n2016 and above, Windows Defender\nApplication Control (WDAC) policy\nrules may be applied to block the\nwmic.exe application and to prevent\nabuse.\n\n[M1026 - Privileged Account](https://attack.mitre.org/mitigations/M1026)\nManagement:\n\nPrevent credential overlap across\nsystems of administrator and\nprivileged accounts.\n\n\n[M1040 - Behavior](https://attack.mitre.org/mitigations/M1040)\nPrevention on Endpoint:\n\nOn Windows 10, enable\nAttack Surface Reduction\n(ASR) rules to block\nprocesses created by WMI\ncommands from running.\nNote: many legitimate tools\nand applications utilize\nWMI for command\nexecution.\n\n\n-----\n\n[M1018 - User Account Management:](https://attack.mitre.org/mitigations/M1018)\n\nBy default, only administrators are\nallowed to connect remotely using\nWMI. Restrict other users who are\nallowed to connect, or disallow all\nusers to connect remotely to WMI.\n\nPrivilege Escalation [T1134.001 – Access Token](https://attack.mitre.org/techniques/T1134/001/)\nManipulation: Token\nImpersonation/Theft:\n\nAdversaries may duplicate\nthen impersonate another\nuser's token to escalate\nprivileges and bypass\naccess controls. An\nadversary can create a new\naccess token that\nduplicates an existing token\nusing DuplicateToken(Ex).\nThe token can then be\nused with\nImpersonateLoggedOnUser\nto allow the calling thread\nto impersonate a logged on\nuser's security context, or\nwith SetThreadToken to\nassign the impersonated\ntoken to a thread.\n\n\n[M1026 - Privileged](https://attack.mitre.org/mitigations/M1026)\nAccount\nManagement:\n\nLimit permissions so\nthat users and user\ngroups cannot create\ntokens. This setting\nshould be defined for\nthe local system\naccount only. GPO:\nComputer\nConfiguration >\n\n[Policies] > Windows\nSettings > Security\nSettings > Local\nPolicies > User Rights\nAssignment: Create a\ntoken object. Also\ndefine who can create\na process level token\nto only the local and\nnetwork service\nthrough GPO:\nComputer\nConfiguration >\n\n[Policies] > Windows\nSettings > Security\nSettings > Local\nPolicies > User Rights\nAssignment: Replace\na process level token.\nAdministrators should\nlog in as a standard\nuser but run their\ntools with\nadministrator\nprivileges using the\nbuilt-in access token\nmanipulation\ncommand runas.\n\n\n-----\n\n[M1018 - User Account Management:](https://attack.mitre.org/mitigations/M1018)\n\nAn adversary must already have\nadministrator level access on the\nlocal system to make full use of this\ntechnique; be sure to restrict us\n\n[T1134.002 – Access Token](https://attack.mitre.org/techniques/T1134/002/)\nManipulation: Create Process with\nToken:\n\nAdversaries may create a new\nprocess with a different token to\nescalate privileges and bypass\naccess controls. Processes can be\ncreated with the token and resulting\nsecurity context of another user\nusing features such as\nCreateProcessWithTokenW and\nrunas.\n\n[M1018 - User Account Management:](https://attack.mitre.org/mitigations/M1018)\n\nAn adversary must already have\nadministrator level access on the\nlocal system to make full use of this\ntechnique; be sure to restrict users\nand accounts to the least privileges\n\n\n[M1026 - Privileged Account](https://attack.mitre.org/mitigations/M1026)\nManagement:\n\nLimit permissions so that\nusers and user groups\ncannot create tokens. This\nsetting should be defined\nfor the local system\naccount only. GPO:\nComputer Configuration >\n\n[Policies] > Windows\nSettings > Security Settings\n\n- Local Policies > User\nRights Assignment: Create\na token object. Also define\nwho can create a process\nlevel token to only the local\nand network service\nthrough GPO: Computer\nConfiguration > [Policies] >\nWindows Settings >\nSecurity Settings > Local\nPolicies > User Rights\nAssignment: Replace a\nprocess level token.\nAdministrators should log in\nas a standard user but run\ntheir tools with\nadministrator privileges\nusing the built-in access\ntoken manipulation\ncommand runas.\n\n\n-----\n\n[T1055 – Process Injection:](https://attack.mitre.org/techniques/T1055/)\n\nAdversaries may inject code into\nprocesses in order to evade\nprocess-based defenses as well as\npossibly elevate privileges. Process\ninjection is a method of executing\narbitrary code in the address space\nof a separate live process. Running\ncode in the context of another\nprocess may allow access to the\nprocess's memory, system/network\nresources, and possibly elevated\nprivileges. Execution via process\ninjection may also evade detection\nfrom security products since the\nexecution is masked under a\nlegitimate process.\n\n[M1026 - Privileged Account](https://attack.mitre.org/mitigations/M1026)\nManagement:\n\nUtilize Yama (ex:\n/proc/sys/kernel/yama/ptrace_scope)\nto mitigate ptrace based process\ninjection by restricting the use of\nptrace to privileged users only. Other\nmitigation controls involve the\ndeployment of security kernel\nmodules that provide advanced\n\n\n[M1040 - Behavior](https://attack.mitre.org/mitigations/M1040)\nPrevention on Endpoint:\n\nSome endpoint security\nsolutions can be configured\nto block some types of\nprocess injection based on\ncommon sequences of\nbehavior that occur during\nthe injection process. For\nexample, on Windows 10,\nAttack Surface Reduction\n(ASR) rules may prevent\nOffice applications from\ncode injection.\n\n\nDefense Evasion [T1140 -](https://attack.mitre.org/techniques/T1140)\nDeobfuscate/Decode Files\nor Information:\n\nAdversaries may use\nObfuscated Files or\nInformation to hide artifacts\nof an intrusion from\nanalysis. They may require\nseparate mechanisms to\ndecode or deobfuscate that\ninformation depending on\nhow they intend to use it.\nMethods for doing that\ninclude built-in functionality\nof malware or by using\nutilities present on the\nsystem.\n\n\nThis type of attack\ntechnique cannot be\neasily mitigated with\npreventive controls\nsince it is based on\nthe abuse of system\nfeatures.\n\n\n-----\n\n[T1562.001 – Impair Defenses:](https://attack.mitre.org/techniques/T1562/001/)\nDisable or Modify Tools:\n\nAdversaries may modify and/or\ndisable security tools to avoid\npossible detection of their\nmalware/tools and activities. This\nmay take the many forms, such as\nkilling security software processes or\nservices, modifying / deleting\nRegistry keys or configuration files\nso that tools do not operate properly,\nor other methods to interfere with\nsecurity tools scanning or reporting\ninformation.\n\n[M1024 - Restrict Registry](https://attack.mitre.org/mitigations/M1024)\nPermissions:\n\nEnsure proper Registry permissions\nare in place to prevent adversaries\nfrom disabling or interfering with\nsecurity services.\n\n[M1018 - User Account Management:](https://attack.mitre.org/mitigations/M1018)\n\nEnsure proper user permissions are\nin place to prevent adversaries from\ndisabling or interfering with security\nservices.\n\n[T1562.009 – Impair Defenses: Safe](https://attack.mitre.org/techniques/T1562/009/)\nMode Boot:\n\nAdversaries may abuse Windows\nsafe mode to disable endpoint\ndefenses. Safe mode starts up the\nWindows operating system with a\nlimited set of drivers and services.\nThird-party security software such as\nendpoint detection and response\n(EDR) tools may not start after\nbooting Windows in safe mode.\nThere are two versions of safe\nmode: Safe Mode and Safe Mode\nwith Networking. It is possible to\nstart additional services after a safe\nmode boot.\n\n\n[M1022 - Restrict File and](https://attack.mitre.org/mitigations/M1022)\nDirectory Permissions:\n\nEnsure proper process and\nfile permissions are in place\nto prevent adversaries from\ndisabling or interfering with\nsecurity services.\n\n[M1026 - Privileged Account](https://attack.mitre.org/mitigations/M1026)\nManagement:\n\nRestrict administrator\naccounts to as few\nindividuals as possible,\nfollowing least privilege\nprinciples, that may be\nabused to remotely boot a\nmachine in safe mode.\n\n\n-----\n\n[M1054 - Software Configuration:](https://attack.mitre.org/mitigations/M1054)\n\nEnsure that endpoint defenses run in\nsafe mode.\n\n[T1070.004 – Indicator Removal on](https://attack.mitre.org/techniques/T1070/004/)\nHost: File Deletion:\n\nAdversaries may delete files left\nbehind by the actions of their\nintrusion activity. Malware, tools, or\nother non-native files dropped or\ncreated on a system by an\nadversary may leave traces to\nindicate to what was done within a\nnetwork and how. Removal of these\nfiles can occur during an intrusion, or\nas part of a post-intrusion process to\nminimize the adversary's footprint.\n\n[T1036.005 – Masquerading: Match](https://attack.mitre.org/techniques/T1036/005/)\nLegitimate Name or Location:\n\nAdversaries may match or\napproximate the name or location of\nlegitimate files or resources when\nnaming/placing them. This is done\nfor the sake of evading defenses\nand observation. This may be done\nby placing an executable in a\ncommonly trusted directory (ex:\nunder System32) or giving it the\nname of a legitimate, trusted\nprogram (ex: svchost.exe). In\ncontainerized environments, this\nmay also be done by creating a\nresource in a namespace that\nmatches the naming convention of a\ncontainer pod or cluster.\n\n[M1038 - Execution Prevention:](https://attack.mitre.org/mitigations/M1038)\n\nUse tools that restrict program\nexecution via application control by\nattributes other than file name for\ncommon operating system utilities\nthat are needed.\n\n\nThis type of attack\ntechnique cannot be easily\nmitigated with preventive\ncontrols since it is based on\nthe abuse of system\nfeatures.\n\n[M1045 - Code Signing:](https://attack.mitre.org/mitigations/M1045)\n\nRequire signed binaries\nand images.\n\n\n-----\n\n[M1022 - Restrict File and Directory](https://attack.mitre.org/mitigations/M1022)\nPermissions:\n\nUse file system access controls to\nprotect folders such as\nC:\\Windows\\System32.\n\n[T1112 – Modify Registry:](https://attack.mitre.org/techniques/T1112/)\n\nAdversaries may interact with the\nWindows Registry to hide\nconfiguration information within\nRegistry keys, remove information\nas part of cleaning up, or as part of\nother techniques to aid in\npersistence and execution.\n\n[T1027 - Obfuscated Files or](https://attack.mitre.org/techniques/T1027)\nInformation:\n\nAdversaries may attempt to make an\nexecutable or file difficult to discover\nor analyze by encrypting, encoding,\nor otherwise obfuscating its contents\non the system or in transit. This is\ncommon behavior that can be used\nacross different platforms and the\nnetwork to evade defenses.\n\n[M1040 - Behavior Prevention on](https://attack.mitre.org/mitigations/M1040)\nEndpoint:\n\nOn Windows 10, enable Attack\nSurface Reduction (ASR) rules to\nprevent execution of potentially\nobfuscated scripts.\n\n\n[M1024 - Restrict Registry](https://attack.mitre.org/mitigations/M1024)\nPermissions:\n\nEnsure proper permissions\nare set for Registry hives to\nprevent users from\nmodifying keys for system\ncomponents that may lead\nto privilege escalation.\n\n[M1049 -](https://attack.mitre.org/mitigations/M1049)\nAntivirus/Antimalware:\n\nConsider utilizing the\nAntimalware Scan Interface\n(AMSI) on Windows 10 to\nanalyze commands after\nbeing\nprocessed/interpreted.\n\n\n-----\n\nDiscovery [T1083 – File and Directory](https://attack.mitre.org/techniques/T1083)\nDiscovery:\n\nAdversaries may\nenumerate files and\ndirectories or may search in\nspecific locations of a host\nor network share for certain\ninformation within a file\nsystem. Adversaries may\nuse the information from\nFile and Directory\nDiscovery during\nautomated discovery to\nshape follow-on behaviors,\nincluding whether or not the\nadversary fully infects the\ntarget and/or attempts\nspecific actions.\n\n\nThis type of attack\ntechnique cannot be\neasily mitigated with\npreventive controls\nsince it is based on\nthe abuse of system\nfeatures.\n\n\n[T1069.002 – Permission Groups](https://attack.mitre.org/techniques/T1069/002/)\nDiscovery: Domain Groups:\n\nAdversaries may attempt to find\ndomain-level groups and permission\nsettings. The knowledge of domainlevel permission groups can help\nadversaries determine which groups\nexist and which users belong to a\nparticular group. Adversaries may\nuse this information to determine\nwhich users have elevated\npermissions, such as domain\nadministrators.\n\n[T1012 – Query Registry:](https://attack.mitre.org/techniques/T1012/)\n\nAdversaries may interact with the\nWindows Registry to gather\ninformation about the system,\nconfiguration, and installed software.\n\n\nThis type of attack\ntechnique cannot be easily\nmitigated with preventive\ncontrols since it is based on\nthe abuse of system\nfeatures.\n\nThis type of attack\ntechnique cannot be easily\nmitigated with preventive\ncontrols since it is based on\nthe abuse of system\nfeatures.\n\n\n-----\n\n[T1082 – System Information](https://attack.mitre.org/techniques/T1082/)\nDiscovery:\n\nAn adversary may attempt to get\ndetailed information about the\noperating system and hardware,\nincluding version, patches, hotfixes,\nservice packs, and architecture.\nAdversaries may use the information\nfrom System Information Discovery\nduring automated discovery to\nshape follow-on behaviors, including\nwhether or not the adversary fully\ninfects the target and/or attempts\nspecific actions.\n\n[T1614.001 – System Location](https://attack.mitre.org/techniques/T1614/001/)\nDiscovery: System Language\nDiscovery:\n\nAdversaries may attempt to gather\ninformation about the system\nlanguage of a victim in order to infer\nthe geographical location of that\nhost. This information may be used\nto shape follow-on behaviors,\nincluding whether the adversary\ninfects the target and/or attempts\nspecific actions. This decision may\nbe employed by malware developers\nand operators to reduce their risk of\nattracting the attention of specific\nlaw enforcement agencies or\nprosecution/scrutiny from other\nentities.\n\n\nThis type of attack\ntechnique cannot be easily\nmitigated with preventive\ncontrols since it is based on\nthe abuse of system\nfeatures.\n\nThis type of attack\ntechnique cannot be easily\nmitigated with preventive\ncontrols since it is based on\nthe abuse of system\nfeatures.\n\n\nT1007 – System Service Discovery This type of attack\ntechnique cannot be easily\nmitigated with preventive\ncontrols since it is based on\nthe abuse of system\nfeatures.\n\n\n-----\n\nCommand and Control T1071.001 – Application\nLayer Protocol: Web\nProtocols:\n\nAdversaries may\ncommunicate using\napplication layer protocols\nassociated with web traffic\nto avoid detection/network\nfiltering by blending in with\nexisting traffic. Commands\nto the remote system, and\noften the results of those\ncommands, will be\nembedded within the\nprotocol traffic between the\nclient and server.\n\nProtocols such as HTTP\nand HTTPS that carry web\ntraffic may be very common\nin environments. HTTP/S\npackets have many fields\nand headers in which data\ncan be concealed. An\nadversary may abuse these\nprotocols to communicate\nwith systems under their\ncontrol within a victim\nnetwork while also\nmimicking normal,\nexpected traffic.\n\n\n[M1031 - Network](https://attack.mitre.org/mitigations/M1031)\nIntrusion Prevention:\n\nNetwork intrusion\ndetection and\nprevention systems\nthat use network\nsignatures to identify\ntraffic for specific\nadversary malware\ncan be used to\nmitigate activity at the\nnetwork level.\n\n\n-----\n\n[T1573.002 – Encrypted Channel:](https://attack.mitre.org/techniques/T1573/002/)\nAsymmetric Cryptography:\n\nAdversaries may employ a known\nasymmetric encryption algorithm to\nconceal command and control traffic\nrather than relying on any inherent\nprotections provided by a\ncommunication protocol. Asymmetric\ncryptography, also known as public\nkey cryptography, uses a keypair per\nparty: one public that can be freely\ndistributed, and one private. Due to\nhow the keys are generated, the\nsender encrypts data with the\nreceiver’s public key and the\nreceiver decrypts the data with their\nprivate key. This ensures that only\nthe intended recipient can read the\nencrypted data.\n\n[M1020 - SSL/TLS Inspection:](https://attack.mitre.org/mitigations/M1020)\n\nSSL/TLS inspection can be used to\nsee the contents of encrypted\nsessions to look for network-based\nindicators of malware\ncommunication protocols.\n\n\n[M1031 - Network Intrusion](https://attack.mitre.org/mitigations/M1031)\nPrevention:\n\nNetwork intrusion detection\nand prevention systems\nthat use network signatures\nto identify traffic for specific\nadversary malware can be\nused to mitigate activity at\nthe network level.\n\n\n-----\n\n[T1105 – Ingress Tool Transfer:](https://attack.mitre.org/techniques/T1105/)\n\nAdversaries may transfer tools or\nother files from an external system\ninto a compromised environment.\nFiles may be copied from an\nexternal adversary controlled system\nthrough the command and control\nchannel to bring tools into the victim\nnetwork or through alternate\nprotocols with another tool such as\nFTP. Files can also be copied over\non Mac and Linux with native tools\nlike scp, rsync, and sftp.\n\n\n[M1031 - Network Intrusion](https://attack.mitre.org/mitigations/M1031)\nPrevention:\n\nNetwork intrusion detection\nand prevention systems\nthat use network signatures\nto identify traffic for specific\nadversary malware or\nunusual data transfer over\nknown tools and protocols\nlike FTP can be used to\nmitigate activity at the\nnetwork level. Signatures\nare often for unique\nindicators within protocols\nand may be based on the\nspecific obfuscation\ntechnique used by a\nparticular adversary or tool,\nand will likely be different\nacross various malware\nfamilies and versions.\nAdversaries will likely\nchange tool C2 signatures\nover time or construct\nprotocols in such a way as\nto avoid detection by\ncommon defensive tools.\n\n\nExfiltration [T1041 – Exfiltration Over](https://attack.mitre.org/techniques/T1041/)\nC2 Channel:\n\nAdversaries may steal data\nby exfiltrating it over an\nexisting command and\ncontrol channel. Stolen\ndata is encoded into the\nnormal communications\nchannel using the same\nprotocol as command and\ncontrol communications.\n\n\n[M1057 - Data Loss](https://attack.mitre.org/mitigations/M1057)\nPrevention:\n\nData loss prevention\ncan detect and block\nsensitive data being\nsent over unencrypted\nprotocols.\n\n\n-----\n\n[M1031 - Network Intrusion](https://attack.mitre.org/mitigations/M1031)\nPrevention:\n\nNetwork intrusion detection and\nprevention systems that use network\nsignatures to identify traffic for\nspecific adversary malware can be\nused to mitigate activity at the\nnetwork level. Signatures are often\nfor unique indicators within protocols\nand may be based on the specific\nobfuscation technique used by a\nparticular adversary or tool, and will\nlikely be different across various\nmalware families and versions.\nAdversaries will likely change tool\ncommand and control signatures\nover time or construct protocols in\nsuch a way to avoid detection by\ncommon defensive tools.\n\nImpact [T1485 – Data Destruction:](https://attack.mitre.org/techniques/T1485/)\n\nAdversaries may destroy\ndata and files on specific\nsystems or in large\nnumbers on a network to\ninterrupt availability to\nsystems, services, and\nnetwork resources. Data\ndestruction is likely to\nrender stored data\nirrecoverable by forensic\ntechniques through\noverwriting files or data on\nlocal and remote drives\n\n\n[M1053 - Data](https://attack.mitre.org/mitigations/M1053)\nBackup:\n\nConsider\nimplementing IT\ndisaster recovery\nplans that contain\nprocedures for taking\nregular data backups\nthat can be used to\nrestore organizational\ndata. Ensure backups\nare stored off system\nand is protected from\ncommon methods\nadversaries may use\nto gain access and\ndestroy the backups\nto prevent recovery.\n\n\n-----\n\n[T1486 - Data Encrypted for Impact:](https://attack.mitre.org/techniques/T1486/)\n\nAdversaries may encrypt data on\ntarget systems or on large numbers\nof systems in a network to interrupt\navailability to system and network\nresources. They can attempt to\nrender stored data inaccessible by\nencrypting files or data on local and\nremote drives and withholding\naccess to a decryption key.\n\n[M1053 - Data Backup: Consider](https://attack.mitre.org/mitigations/M1053)\nimplementing IT disaster recovery\nplans that contain procedures for\nregularly taking and testing data\nbackups that can be used to restore\norganizational data. Ensure backups\nare stored off system and is\nprotected from common methods\nadversaries may use to gain access\nand destroy the backups to prevent\nrecovery. Consider enabling\nversioning in cloud environments to\nmaintain backup copies of storage\nobjects.\n\n[T1490 - Inhabit System Recovery:](https://attack.mitre.org/techniques/T1490/)\n\nAdversaries may delete or remove\nbuilt-in operating system data and\nturn off services designed to aid in\nthe recovery of a corrupted system\nto prevent recovery. Operating\nsystems may contain features that\ncan help fix corrupted systems, such\nas a backup catalog, volume\nshadow copies, and automatic repair\nfeatures. Adversaries may disable or\ndelete system recovery features to\naugment the effects of Data\nDestruction and Data Encrypted for\nImpact.\n\n\n[M1040 - Behavior](https://attack.mitre.org/mitigations/M1040)\nPrevention on Endpoint: On\nWindows 10, enable clouddelivered protection and\nAttack Surface Reduction\n(ASR) rules to block the\nexecution of files that\nresemble ransomware.\n\n[M1053 - Data Backup:](https://attack.mitre.org/mitigations/M1053)\nConsider implementing IT\ndisaster recovery plans that\ncontain procedures for\ntaking regular data backups\nthat can be used to restore\norganizational data. Ensure\nbackups are stored off\nsystem and is protected\nfrom common methods\nadversaries may use to\ngain access and destroy\nthe backups to prevent\nrecovery.\n\n\n-----\n\n[M1028 - Operating System](https://attack.mitre.org/mitigations/M1028)\nConfiguration: Consider technical\ncontrols to prevent the disabling of\nservices or deletion of files involved\nin system recovery.\n\n[T1489 - Service Stop:](https://attack.mitre.org/techniques/T1489/)\n\nAdversaries may stop or disable\nservices on a system to render those\nservices unavailable to legitimate\nusers. Stopping critical services or\nprocesses can inhibit or stop\nresponse to an incident or aid in the\nadversary's overall objectives to\ncause damage to the environment.\n\n[M1022 - Restrict File and Directory](https://attack.mitre.org/mitigations/M1022)\nPermissions: Ensure proper process\nand file permissions are in place to\ninhibit adversaries from disabling or\ninterfering with critical services.\n\n[M1024 - Restrict Registry](https://attack.mitre.org/mitigations/M1024)\nPermissions: Ensure proper registry\npermissions are in place to inhibit\nadversaries from disabling or\ninterfering with critical services.\n\n[M1018 - User Account Management:](https://attack.mitre.org/mitigations/M1018)\nLimit privileges of user accounts and\ngroups so that only authorized\nadministrators can interact with\nservice changes and service\nconfigurations.\n\n\n[M1030 - Network](https://attack.mitre.org/mitigations/M1030)\nSegmentation: Operate\nintrusion detection,\nanalysis, and response\nsystems on a separate\nnetwork from the\nproduction environment to\nlessen the chances that an\nadversary can see and\ninterfere with critical\nresponse functions.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-04-12 - Threat Profile- REvil.pdf"
    ],
    "report_names": [
        "2022-04-12 - Threat Profile- REvil.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535919,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1653692465,
    "ts_modification_date": 1653692465,
    "files": {
        "pdf": "https://archive.orkl.eu/b9126c2caed219de1107b96ac493021435f0a001.pdf",
        "text": "https://archive.orkl.eu/b9126c2caed219de1107b96ac493021435f0a001.txt",
        "img": "https://archive.orkl.eu/b9126c2caed219de1107b96ac493021435f0a001.jpg"
    }
}