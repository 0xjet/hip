{
    "id": "d05f2203-ef58-4ec5-bf91-495fee06210c",
    "created_at": "2023-01-12T14:59:23.963665Z",
    "updated_at": "2025-03-27T02:05:39.711469Z",
    "deleted_at": null,
    "sha1_hash": "9cc0466466a4df2dcf0af2ca5f658e307fb3791a",
    "title": "2017-04-17 - Python script for decoding DOUBLEPULSAR",
    "authors": "",
    "file_creation_date": "2022-05-28T03:33:31Z",
    "file_modification_date": "2022-05-28T03:33:31Z",
    "file_size": 95590,
    "plain_text": "# countercept/doublepulsar-c2-traffic-decryptor: A python2 script for processing a PCAP file to decrypt C2 traffic sent to DOUBLEPULSAR implant\n\n**github.com/countercept/doublepulsar-c2-traffic-decryptor**\n\ncountercept\n\n[Author: Luke Jennings (luke.jennings@countercept.com - @jukelennings)](http://10.10.0.46/mailto:luke.jennings@countercept.com)\n\nCompany: Countercept (@countercept)\n\nWebsite: [https://countercept.com](https://countercept.com/)\n\nA python2 script for decrypting the C2 traffic used by the DOUBLEPULSAR SMB implant\nfrom a PCAP file. The encryption used is a simple 4-byte XOR, which you can often see\nbeing displayed in the command output from the FUZZBUNCH toolset. This makes use of\nthe fact that a set of four contiguous zeros are present in the SESSION_SETUP parameters\nin the first non-ping packet, which reveals the XOR key directly and this is used to decrypt all\nof the traffic.\n\nThis is an early release and relies on finding certain specific components in the network\npackets and has been tested with the DLL injection functionality. For best results, supply a\nPCAP file that has only one command within the traffic.\n\nFor testing purposes, a PCAP file is contained within this repository that was captured using\nthe DLL injection command to inject the standard windows DLL wininet.dll into a running\ncalc.exe process on the target machine. The decrypted output from running this script is also\n\n\n-----\n\npresent in the repository and contains 4885 bytes of shellcode followed by a byte-for-byte\ncopy of wininet.dll\n\nThis script has a dependency on the python-pcapng library. Example usage below:\n\nroot@kali:~# pip install python-pcapng\n\nroot@kali:~# python decrypt_doublepulsar_traffic.py --pcapng inject-dll-wininet-intocalc.pcapng --output decrypted_data.bin\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-04-17 - Python script for decoding DOUBLEPULSAR.pdf"
    ],
    "report_names": [
        "2017-04-17 - Python script for decoding DOUBLEPULSAR.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535563,
    "ts_updated_at": 1743041139,
    "ts_creation_date": 1653708811,
    "ts_modification_date": 1653708811,
    "files": {
        "pdf": "https://archive.orkl.eu/9cc0466466a4df2dcf0af2ca5f658e307fb3791a.pdf",
        "text": "https://archive.orkl.eu/9cc0466466a4df2dcf0af2ca5f658e307fb3791a.txt",
        "img": "https://archive.orkl.eu/9cc0466466a4df2dcf0af2ca5f658e307fb3791a.jpg"
    }
}