{
    "id": "e9dd4e83-4002-4b0b-9e3d-4b42f46b6e95",
    "created_at": "2023-01-12T14:59:12.658335Z",
    "updated_at": "2025-03-27T02:17:14.402256Z",
    "deleted_at": null,
    "sha1_hash": "8b15fbd0a47594ac8b0dbd33efd9130cc0062fb8",
    "title": "2019-04-23 - Operation ShadowHammer- a high-profile supply chain attack",
    "authors": "",
    "file_creation_date": "2022-05-28T02:03:57Z",
    "file_modification_date": "2022-05-28T02:03:57Z",
    "file_size": 2675177,
    "plain_text": "# Operation ShadowHammer: a high-profile supply chain attack\n\n**[securelist.com/operation-shadowhammer-a-high-profile-supply-chain-attack/90380/](https://securelist.com/operation-shadowhammer-a-high-profile-supply-chain-attack/90380/)**\n\nAuthors\n\nGReAT\n\nAMR\n\n[In late March 2019, we briefly highlighted our research on ShadowHammer attacks, a sophisticated](https://securelist.com/operation-shadowhammer/89992/)\n[supply chain attack involving ASUS Live Update Utility, which was featured in a Kim Zetter article on](https://motherboard.vice.com/en_us/article/pan9wn/hackers-hijacked-asus-software-updates-to-install-backdoors-on-thousands-of-computers)\n[Motherboard. The topic was also one of the research announcements made at the SAS conference,](https://sas.kaspersky.com/)\nwhich took place in Singapore on April 9-10, 2019. Now it is time to share more details about the\nresearch with our readers.\n\nAt the end of January 2019, Kaspersky Lab researchers discovered what appeared to be a new\nattack on a large manufacturer in Asia. Our researchers named it “Operation ShadowHammer”.\n\nSome of the executable files, which were downloaded from the official domain of a reputable and\ntrusted large manufacturer, contained apparent malware features. Careful analysis confirmed that\nthe binary had been tampered with by malicious attackers.\n\n\n-----\n\nIt is important to note that any, even tiny, tampering with executables in such a case normally breaks\nthe digital signature. However, in this case, the digital signature was intact: valid and verifiable. We\nquickly realized that we were dealing with a case of a compromised digital signature.\n\nWe believe this to be the result of a sophisticated supply chain attack, which matches or even\nsurpasses the [ShadowPad and the](https://securelist.com/shadowpad-in-corporate-networks/81432/) [CCleaner incidents in complexity and techniques. The reason](https://blog.avast.com/update-to-the-ccleaner-5.33.6162-security-incident)\nthat it stayed undetected for so long is partly the fact that the trojanized software was signed with\nlegitimate certificates (e.g. “ASUSTeK Computer Inc.”).\n\nThe goal of the attack was to surgically target an unknown pool of users, who were identified by\ntheir network adapters’ MAC addresses. To achieve this, the attackers had hardcoded a list of MAC\naddresses into the trojanized samples and the list was used to identify the intended targets of this\nmassive operation. We were able to extract more than 600 unique MAC addresses from more than\n200 samples used in the attack. There might be other samples out there with different MAC\naddresses on their lists, though.\n\n## Technical details\n\nThe research started upon the discovery of a trojanized ASUS Live Updater file (setup.exe), which\ncontained a digital signature of ASUSTeK Computer Inc. and had been backdoored using one of the\ntwo techniques explained below.\n\nIn earlier variants of ASUS Live Updater (i.e. MD5:0f49621b06f2cdaac8850c6e9581a594), the\nattackers replaced the WinMain function in the binary with their own. This function copies a\nbackdoor executable from the resource section using a hardcoded size and offset to the resource.\nOnce copied to the heap memory, another hardcoded offset, specific to the executable, is used to\nstart the backdoor. The offset points to a position-independent shellcode-style function that unwraps\nand runs the malicious code further.\n\n\n-----\n\nSome of the older samples revealed the project path via a PDB file reference:\n“D:\\C++\\AsusShellCode\\Release\\AsusShellCode.pdb“. This suggests that the attackers had\nexclusively prepared the malicious payload for their target. A similar tactic of precise targeting has\nbecome a persistent property of these attackers.\n\nA look at the resource section used for carrying the malicious payload revealed that the attackers\nhad decided not to change the file size of the ASUS Live Updater binary. They changed the\nresource contents and overwrote a tiny block of the code in the subject executable. The layout of\nthat patched file is shown below.\n\n\n-----\n\nWe managed to find the original ASUS Live Updater executable which had been patched and\nabused by the attackers. As a result, we were able to recover the overwritten data in the resource\nsection. The file we found was digitally signed and certainly had no infection present.\n\nBoth the legitimate ASUS executable and the resource-embedded updater binary contain\ntimestamps from March 2015. Considering that the operation took place in 2018, this raises the\nfollowing question: why did the attackers choose an old ASUS binary as the infection carrier?\n\n\n-----\n\nAnother injection technique was found in more recent samples. Using that technique, the attackers\npatched the code inside the C runtime (CRT) library function “___crtExitProcess”. The malicious\ncode executes a shellcode loader instead of the standard function “___crtCorExitProcess”:\n\nThis way, the execution flow is passed to another address which is located at the end of the code\nsection. The attackers used a small decryption routine that can fit into a block at the end of the code\nsection, which has a series of zero bytes in the original executable. They used the same source\nexecutable file from ASUS (compiled in March 2015) for this new type of injection.\n\n\n-----\n\nThe loader code copies another block of encrypted shellcode from the file’s resource section (of the\ntype “EXE”) to a newly allocated memory block with read-write-execute attributes and decrypts it\nusing a custom block-chaining XOR algorithm, where the first dword is the initial seed and the total\n\n\n-----\n\nsize of the shellcode is stored at an offset of +8.\n\nWe believe that the attackers changed the payload start routine in an attempt to evade detection.\nApparently, they switched to a better method of hiding their embedded shellcode at some point\nbetween the end of July and September 2018.\n\n**ShadowHammer downloader**\n\nThe compromised ASUS binaries carried a payload that was a Trojan downloader. Let us take a\ncloser look at one such ShadowHammer downloader extracted from a copy of the ASUS Live\nUpdater tool with MD5:0f49621b06f2cdaac8850c6e9581a594. It has the following properties:\n\nMD5: 63f2fe96de336b6097806b22b5ab941a\nSHA1: 6f8f43b6643fc36bae2e15025d533a1d53291b8a\nSHA256: 1bb53937fa4cba70f61dc53f85e4e25551bc811bf9821fc47d25de1be9fd286a\nDigital certificate fingerprint: 0f:f0:67:d8:01:f7:da:ee:ae:84:2e:9f:e5:f6:10:ea\nFile Size: 1’662’464 bytes\nFile Type: PE32 executable (GUI) Intel 80386, for MS Windows\nLink Time: 2018.07.10 05:58:19 (GMT)\n\nThe relatively large file size is explained by the presence of partial data from the original ASUS Live\nUpdater application appended to the end of the executable. The attackers took the original Live\nUpdater and overwrote it with their own PE executable starting from the PE header, so that the file\ncontains the actual PE image, whose size is only 40448 bytes, while the rest comes from ASUS.\nThe malicious executable was created using Microsoft Visual C++ 2010.\n\n\n-----\n\nThe core function of this executable is in a subroutine which is called from WinMain, but also\nexecuted directly via a hardcoded offset from the code injected into ASUS Live Updater.\n\nThe code uses dynamic import resolution with its own simple hashing algorithm. Once the imports\nare resolved, it collects MAC addresses of all available network adapters and calculates an MD5\nhash for each of these. After that, the hashes are compared against a table of 55 hardcoded values.\nOther variants of the downloader contained a different table of hashes, and in some cases, the\nhashes were arranged in pairs.\n\nIn other words, the malware iterates through a table of hashes and compares them to the hashes of\nlocal adapters’ MAC hashes. This way, the target system is recognized and the malware proceeds\nto the next stage, downloading a binary object from https://asushotfix[.]com/logo.jpg (or\n**https://asushotfix[.]com/logo2.jpg in newer samples). The malware also sends the first hash from**\nthe match entry as a parameter in the request to identify the victim. The server response is expected\nto be an executable shellcode, which is placed in newly allocated memory and started.\n\n\n-----\n\nOur investigation uncovered 230 unique samples with different shellcodes and different sets of MAC\naddress hashes. This leads us to believe that the campaign targeted a vast number of people or\ncompanies. In total, we were able to extract 14 unique hash tables. The smallest hash table found\ncontained eight entries and the biggest, 307 entries. Interestingly, although the subset of hash\nentries was changing, some of the entries were present in all of the tables.\n\nFor all users whose MAC did not match expected values, the code would create an INI file located\ntwo directory levels above the current executable and named “idx.ini”. Three values were written into\nthe INI file under the [IDX_FILE] section:\n\n[IDX_FILE]\nXXX_IDN=YYYY-MM-DD\nXXX IDE=YYYY-MM-DD\n\n\n-----\n\nXXX_IDX=YYYY-MM-DD\n\nwhere YYYY-MM-DD is a date one week ahead of the current system date.\n\nThe code injected by the attackers was discovered with over 57000 Kaspersky Lab users. It would\nrun but remain silent on systems that were not primary targets, making it almost impossible to\ndiscover the anomalous behavior of the trojanized executables. The exact total of the affected users\naround the world remains unknown.\n\n## Digital signature abuse\n\nA lot of computer security software deployed today relies on integrity control of trusted executables.\nDigital signature verification is one such method. In this attack, the attackers managed to get their\ncode signed with a certificate of a big vendor. How was that possible? We do not have definitive\nanswers, but let us take a look at what we observed.\n\nFirst of all, we noticed that all backdoored ASUS binaries were signed with two different certificates.\nHere are their fingerprints:\n\n0ff067d801f7daeeae842e9fe5f610ea\n05e6a0be5ac359c7ff11f4b467ab20fc\n\nThe same two certificates have been used in the past to sign at least 3000 legitimate ASUS files\n(i.e. [ASUS GPU Tweak,](https://www.asus.com/us/site/graphics-cards/gpu-tweak-ii/) [ASUS PC Link and others), which makes it very hard to revoke these](https://softfamous.com/asus-pc-link/)\ncertificates.\n\nAll of the signed binaries share certain interesting features: none of them had a signing timestamp\nset, and the digest algorithm used was SHA1. The reason for this could be an attempt at hiding the\ntime of the operation to make it harder to discover related forensic artefacts.\n\nAlthough there is no timestamp that can be relied on to understand when the attack started, there is\na mandatory field in the certificate, “Certificate Validity Period”, which can help us to understand\nroughly the timeframe of the operation. Apparently, because the certificate that the attackers relied\non expired in 2018 and therefore had to be reissued, they used two different certificates.\n\n\n-----\n\nAnother notable fact is that both abused certificates are from the DigiCert SHA2 Assured ID Code\nSigning CA.\n\nThe legitimate ASUS binaries that we have observed use a different certificate, which was issued by\n[the DigiCert EV Code Signing CA (SHA2). EV stands for “Extended Validation” and provides for](https://www.digicert.com/code-signing/ev-code-signing/)\nstricter requirements for the party that intends to use the certificate, including hardware\nrequirements. We believe that the attackers simply did not have access to a production signing\ndevice with an EV certificate.\n\nThis indicates that the attackers most likely obtained a copy of the certificates or abused a system\non the ASUS network that had the certificates installed. We do not know about all software with\nmalware injection they managed to sign, and we believe that the compromised signing certificates\nmust be removed and revoked. Unfortunately, one month after this was reported to ASUS, newly\nreleased software (i.e. md5: 1b8d2459d4441b8f4a691aec18d08751) was still being signed with a\ncompromised certificate. We have immediately notified ASUS about this and provided evidence as\nrequired.\n\n## ASUS-related attack samples\n\n\n-----\n\nUsing decrypted shellcode and through code similarity, we found a number of related samples which\nappear to have been part of a parallel attack wave. These files have the following properties:\n\nthey contain the same shellcode style as the payload from the compromised ASUS Live\nUpdater binaries, albeit unencrypted\nthey have a forgotten PDB path of “D:\\C++\\AsusShellCode\\Release\\AsusShellCode.pdb”\nthe shellcode from all of these samples connects to the same C2: asushotfix[.]com\nall samples were compiled between June and July 2018\nthe samples have been detected on computers all around the globe\n\nThe hashes of these related samples include:\n\n_322cb39bc049aa69136925137906d855_\n_36dd195269979e01a29e37c488928497_\n_7d9d29c1c03461608bcab930fef2f568_\n_807d86da63f0db1fc746d1f0b05bc357_\n_849a2b0dc80aeca3d175c139efe5221c_\n_86A4CAC227078B9C95C560C8F0370BF0_\n_98908ce6f80ecc48628c8d2bf5b2a50c_\n_a4b42c2c95d1f2ff12171a01c86cd64f_\n_b4abe604916c04fe3dd8b9cb3d501d3f_\n_eac3e3ece94bc84e922ec077efb15edd_\n_128CECC59C91C0D0574BC1075FE7CB40_\n_88777aacd5f16599547926a4c9202862_\n\nThese files are dropped by larger setup files / installers, signed by an ASUS certificate (serial\nnumber: 0ff067d801f7daeeae842e9fe5f610ea) valid from 2015-07-27 till 2018-08-01).\n\nThe hashes of the larger installers/droppers include:\n\n0f49621b06f2cdaac8850c6e9581a594\n17a36ac3e31f3a18936552aff2c80249\n\nAt this point, we do not know how they were used in these attacks and whether they were delivered\nvia a different mechanism. These files were located in a “TEMP” subfolder for ASUS Live Updater,\nso it is possible that the software downloaded these files directly. Locations where these files were\ndetected include:\n\nasus\\asus live update\\temp\\1\\Setup.exe\nasus\\asus live update\\temp\\2\\Setup.exe\nasus\\asus live update\\temp\\3\\Setup.exe\nasus\\asus live update\\temp\\5\\Setup.exe\nasus\\asus live update\\temp\\6\\Setup.exe\nasus\\asus live update\\temp\\9\\Setup.exe\n\n## Public reports of the attack\n\n\n-----\n\nWhile investigating this case, we were wondering how such a massive attack could go unnoticed on\nthe Internet. Searching for any kind of evidence related to the attack, we came by a Reddit thread\ncreated in June 2018, where user GreyWolfx posted a screenshot of a suspicious-looking ASUS\nLive Update message:\n\nThe message claims to be a “ASUS Critical Update” notification, however, the item does not have a\nname or version number.\n\nOther users commented in the thread, while some uploaded the suspicious updater to VirusTotal:\n\nThe file uploaded to VT is not one of the malicious compromised updates; we can assume the\nperson who uploaded it actually uploaded the ASUS Live Update itself, as opposed to the update it\nreceived from the Internet. Nevertheless, this could suggest that potentially compromised updates\n\n\n-----\n\nwere delivered to users as far back as June 2018.\n\nIn September 2018, another Reddit user, FabulaBerserko also posted a message about a\nsuspicious ASUS Live update:\n\n[Asus_USA replied to FabulaBerserko with the following message, suggesting he run a scan for](https://www.reddit.com/user/Asus_USA)\nviruses:\n\nIn his message, the Reddit user FabulaBerserko talks about an update listed as critical, however\nwithout a name and with a release date of March 2015. Interestingly, the related attack samples\ncontaining the PDB “AsusShellCode.pdb” have a compilation timestamp from 2015 as well, so it is\npossible that the Reddit user saw the delivery of one such file through ASUS Live Update in\nSeptember 2018.\n\n\n-----\n\n## Targets by MAC address\n\nWe managed to crack all of the 600+ MAC address hashes and analyzed distribution by\nmanufacturer, using publicly available Ethernet-to-vendor assignment lists. It turns out that the\ndistribution is uneven and certain vendors are a higher priority for the attackers. The chart below\nshows statistics we collected based on network adapter manufacturers’ names:\n\nSome of the MAC addresses included on the target list were rather popular, i.e. 00-50-56-C0-00-08\nbelongs to the VMWare virtual adapter VMNet8 and is the same for all users of a certain version of\nthe VMware software for Windows. To prevent infection by mistake, the attackers used a secondary\nMAC address from the real Ethernet card, which would make targeting more precise. However, it\ntells us that one of the targeted users used VMWare, which is rather common for software engineers\n(in testing their software).\n\nAnother popular MAC was 0C-5B-8F-27-9A-64, which belongs to the MAC address of a virtual\nEthernet adapter created by a Huawei USB 3G modem, model E3372h. It seems that all users of\nthis device shared the same MAC address.\n\n## Interaction with ASUS\n\nThe day after the ShadowHammer discovery, we created a short report for ASUS and approached\nthe company through our local colleagues in Taiwan, providing all details of what was known about\nthe attack and hoping for cooperation. The following is a timeline of the discovery of this supplychain attack, together with ASUS interaction and reporting:\n\n29-Jan-2019 – initial discovery of the compromised ASUS Live Updater\n\n\n-----\n\n30-Jan-2019 – created preliminary report to be shared with ASUS, briefed Kaspersky Lab\ncolleagues in Taipei\n31-Jan-2019 – in-person meeting with ASUS, teleconference with researchers; we notified\nASUS of the finding and shared hard copy of the preliminary attack report with indicators of\ncompromise and Yara rules. ASUS provided Kaspersky with the latest version of ASUS Live\nUpdater, which was analyzed and found to be uninfected.\n01-Feb-2019 – ASUS provides an archive of all ASUS Live Updater tools beginning from\n2018. None of them were infected, and they were signed with different certificates.\n14-Feb-2019 – second face-to-face meeting with ASUS to discuss the details of the attack\n20-Feb-2019 – update conf call with ASUS to provide newly found details about the attack\n08-Mar-2019 – provided the list of targeted MAC addresses to ASUS, answered other\nquestions related to the attack\n08-Apr-2019 – provided a comprehensive report on the current attack investigation to ASUS.\n\nWe appreciate a quick response from our ASUS colleagues just days before one of the largest\nholidays in Asia (Lunar New Year). This helped us to confirm that the attack was in a deactivated\nstage and there was no immediate risk to new infections and gave us more time to collect further\nartefacts. However, all compromised ASUS binaries had to be properly flagged as containing\nmalware and removed from Kaspersky Lab users’ computers.\n\n## Non-ASUS-related cases\n\nIn our search for similar malware, we came across other digitally signed binaries from three other\nvendors in Asia.\n\nOne of these vendors is a game development company from Thailand known as Electronics\n**[Extreme Company Limited. The company has released digitally signed binaries of a video game](https://exe.in.th/download)**\ncalled “Infestation: Survivor Stories”. It is a zombie survival game in which players endure the\nhardships of a post-apocalyptic, zombie-infested world. According to Wikipedia, “the game was\n[panned by critics and is considered one of the worst video games of all time“. The game servers](https://en.wikipedia.org/wiki/List_of_video_games_notable_for_negative_reception)\nwere taken offline on December 15, 2016.”\n\nThe history of this videogame itself contains many controversies. According to Wikipedia, it was\noriginally developed under the title of “The War Z” and released by OP Productions which put it in\nthe [Steam store in December 2012. In April 4, 2013, the game servers were compromised, and the](https://store.steampowered.com/app/226700/Infestation_Survivor_Stories_Classic/)\ngame source code was most probably stolen and released to the public.\n\n\n-----\n\nIt seems that certain videogame companies picked up this available code and started making their\nown versions of the game. One such version (md5: de721e2f055f1b203ab561dda4377bab) was\ndigitally signed by Innovative Extremist Co. LTD., a company from Thailand that currently provides\nweb & IT infrastructure services. The game also contains a logo of Electronics Extreme Company\n**Limited with a link to their website. The homepage of Innovative Extremist also listed Electronics**\nExtreme as one of their partners.\n\nNotably, the certificate from Innovative Extremist that was used to sign Infestation is currently\nrevoked. However, the story does not end here. It seems that Electronics Extreme picked up the\nvideo game where Innovative Extremist dropped it. And now the game seems to be causing trouble\nagain. We found at least three samples of Infestation signed by Electronics Extreme with a\ncertificate that must be revoked again.\n\nWe believe that a poorly maintained development environment, leaked source code, as well\nvulnerable production servers were at the core of the bad luck chasing this videogame. Ironically,\nthis game about infestation brought only trouble and a serious infection to its developers.\n\nSeveral executable files from the popular FPS videogame PointBlank contained a similar malware\ninjection. The game was developed by the South Korean company Zepetto Co, whose digital\nsignature was also abused. Although the certificate was still unrevoked as at early April, Zepetto\nseems to have stopped using the certificate at the end of February 2019.\n\n[While some details about this case were announced in March 2019 by our colleagues at ESET, we](https://www.welivesecurity.com/2019/03/11/gaming-industry-scope-attackers-asia/)\nhave been working on this in parallel with ESET and uncovered some additional facts.\n\nAll these cases involve digitally signed binaries from three vendors based in three different Asian\ncountries. They are signed with different certificates and a unique chain of trust. What is common to\nthese cases is the way the binaries were trojanized.\n\n\n-----\n\nThe code injection happened through modification of commonly used functions such as CRT (C\nruntime), which is similar to ASUS case. However, the implementation is very different in the case of\nthe videogame companies. In the ASUS case, the attackers only tampered with a compiled ASUS\nbinary from 2015 and injected additional code. In the other cases, the binaries were recent (from the\nend of 2018). The malicious code was not inserted as a resource, neither did it overwrite the unused\nzero-filled space inside the programs. Instead, it seems to have been neatly compiled into the\nprogram, and in most cases, it starts at the beginning of the code section as if it had been added\neven before the legitimate code. Even the data with the encrypted payload is stored inside this code\nsection. This indicates that the attackers either had access to the source code of the victim’s\nprojects or injected malware on the premises of the breached companies at the time of project\ncompilation.\n\n## Payload from non-ASUS-related cases\n\nThe payload included into the compromised videogames is rather simple. First of all, it checks\nwhether the process has administrative privileges.\n\n\n-----\n\nNext, it checks the registry value at HKCU\\SOFTWARE\\Microsoft\\Windows\\{0753-6681-BD59**8819}. If the value exists and is non-zero, the payload does not run further. Otherwise, it starts a**\nnew thread with a malicious intent.\n\nThe file contains a hardcoded miniconfig—an annotated example of the config is provided below.\n\nC2 URL: https://nw.infestexe[.]com/version/last.php\nSleep time: 240000\nTarget Tag: warz\nUnwanted processes:\nwireshark.exe;perfmon.exe;procmon64.exe;procmon.exe;procexp.exe;procexp64.exe;netmon.exe\n\nApparently, the backdoor was specifically created for this target, which is confirmed by an internal\ntag (the previous name of the game is “The War Z”).\n\nIf any of the unwanted processes is running, or the system language ID is Simplified Chinese or\n**Russian, the malware does not proceed. It also checks for the presence of a mutex named**\n**Windows-{0753-6681-BD59-8819}, which is also a sign to stop execution.**\n\nAfter all checks are done, the malware gathers information about the system including:\n\nNetwork adapter MAC address\nSystem username\nSystem hostname and IP address\nWindows version\nCPU architecture\nCurrent host FQDN\nDomain name\n\n\n-----\n\nCurrent executable file name\nDrive C: volume name and serial number\nScreen resolution\nSystem default language ID\n\nThis information is concatenated in one string using the following string template:\n“%s|%s|%s|%s|%s|%s|%s|%dx%d|%04x|%08X|%s|%s”.\n\nThen the malware crafts a host identifier, which is made up of the C drive serial number string XORed with the hardcoded string “*&b0i0rong2Y7un1” and encoded with the Base64 algorithm. Later\non, the C: serial number may be used by the attackers to craft unique backdoor code that runs only\non a system with identical properties.\n\nThe malware uses HTTP for communication with a C2 server and crafts HTTP headers on its own. It\nuses the following hardcoded User-Agent string: “Mozilla/5.0 (Windows NT 6.1; WOW64)\n**AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.71 Safari/537.36”**\n\nInterestingly, when the malware identifies the Windows version, it uses a long list:\n\nMicrosoft Windows NT 4.0\nMicrosoft Windows 95\nMicrosoft Windows 98\nMicrosoft Windows Me\nMicrosoft Windows 2000e\nMicrosoft Windows XP\nMicrosoft Windows XP Professional x64 Edition\nMicrosoft Windows Server 2003\nMicrosoft Windows Server 2003 R2\nMicrosoft Windows Vista\nMicrosoft Windows Server 2008\nMicrosoft Windows 7\nMicrosoft Windows Server 2008 R2\nMicrosoft Windows 8\nMicrosoft Windows Server 2012\nMicrosoft Windows 8.1\nMicrosoft Windows Server 2012 R2\nMicrosoft Windows 10\nMicrosoft Windows Server 2016\n\nThe purpose of the code is to submit system information to the C2 server with a POST request and\nthen send another GET request to receive a command to execute.\n\nThe following commands were discovered:\n\n**DownUrlFile – download URL data to file**\n**DownRunUrlFile – download URL data to file and execute it**\n**RunUrlBinInMem – download URL data and run as shellcode**\n**UnInstall – set registry flag to prevent malware start**\n\n\n-----\n\nThe UnInstall command sets the registry value HKCU\\SOFTWARE\\Microsoft\\Windows\\{0753**6681-BD59-8819} to 1, which prevents the malware from contacting the C2 again. No files are**\ndeleted from the disk, and the files should be discoverable through forensic analysis.\n\n## Similarities between the ASUS attack and the non-ASUS-related cases\n\nAlthough the ASUS case and the videogame industry cases contain certain differences, they are\nvery similar. Let us briefly mention some of the similarities. For instance, the algorithm used to\ncalculate API function hashes (in trojanized games) resembles the one used in the backdoored\nASUS Updater tool.\n\n\n1\n\n2\n\n3\n\n4\n\n5\n\n\nhash = 0\n\nfor c in string:\n\nhash = hash * 0x21\n\nhash = hash + c\n\nreturn hash\n\n\n1\n\n2\n\n3\n\n4\n\n5\n\n\nhash = 0\n\nfor c in string:\n\nhash = hash * 0x83\n\nhash = hash + c\n\nreturn hash &amp; 0x7FFFFFFF\n\n\nASUS case Other cases\n\n_Pseudocode of API hashing algorithm of ASUS vs. other cases_\n\nBesides that, our behavior engine identified that ASUS and other related samples are some of the\nonly cases where the IPHLPAPI.dll was used from within a shellcode embedded into a PE file.\n\nIn the case of ASUS, the function GetAdaptersAddresses from the IPHLPAPI.dll was used for\ncalculating the hashes of MAC addresses. In the other cases, the function GetAdaptersInfo from the\nIPHLPAPI.dll was used to retrieve information about the MAC addresses of the computer to pass to\nremote C&C servers.\n\n## ShadowPad connection\n\nWhile investigating this case, we worked with several companies that had been abused in this wave\nof supply chain attacks. Our joint investigation revealed that the attackers deployed several tools on\nan attacked network, including a trojanized linker and a powerful backdoor packed with a recent\nversion of VMProtect.\n\n\n-----\n\nOur analysis of the sophisticated backdoor (md5: 37e100dd8b2ad8b301b130c2bca3f1ea) that was\ndeployed by the attackers on the company’s internal network during the breach, revealed that it was\n[an updated version of the ShadowPad backdoor, which we reported on in 2017.](https://securelist.com/shadowpad-in-corporate-networks/81432/)\n\nThe ShadowPad backdoor used in these cases has a very high level of complexity, which makes it\nalmost impossible to reverse engineer:\n\n\n-----\n\nThe newly updated version of ShadowPad follows the same principle as before. The backdoor\nunwraps multiple stages of code before activating a system of plugins responsible for bootstrapping\nthe main malicious functionality. As with ShadowPad, the attackers used at least two stages of C2\nservers, where the first stage would provide the backdoor with an encrypted next-stage C2 domain.\n\nThe backdoor contains a hardcoded URL for C2 communication, which points to a publicly editable\nonline Google document. Such online documents, which we extracted from several backdoors, were\ncreated by the same user under a name of Tom Giardino (hrsimon59@gmail[.]com), probably a\n[reference to the spokesperson from Valve Corporation.](https://en.wikipedia.org/wiki/Valve_Corporation)\n\nThese online documents contained an ASCII block of text marked as an RSA private key during the\ntime of operation. We noticed that inside the private key, normally encoded with base64, there was\nan invalid character injection (the symbol “$”):\n\nThe message between the two “$” characters in fact contained an encrypted second-stage C2 URL.\n\nWe managed to extract the history of changes and collected the following information indicating the\ntime and C2 of ongoing operations in 2018:\n\nJul 31: UDP://103.19.3[.]17:443\nAug 13: UDP://103.19.3[.]17:443\nOct 08: UDP://103.19.3[.]17:443\nOct 09: UDP://103.19.3[.]17:443\nOct 22: UDP://117.16.142[.]9:443\nNov 20: HTTPS://23.236.77[.]177:443\nNov 21: UDP://117.16.142[.]9:443\nNov 22: UDP://117.16.142[.]9:443\nNov 23: UDP://117.16.142[.]9:443\nNov 27: UDP://117.16.142[.]9:443\nNov 27: HTTPS://103.19.3[.]44:443\n\n\n-----\n\nNov 27: TCP://103.19.3[.]44:443\nNov 27: UDP://103.19.3[.]44:1194\nNov 27: HTTPS://23.236.77[.]175:443\nNov 29: HTTPS://23.236.77[.]175:443\nNov 29: UDP://103.19.3[.]43:443\nNov 30: HTTPS://23.236.77[.]177:443\n\nThe IP address range 23.236.64.0-23.236.79.255 belongs to the Chinese hosting company\n**Aoyouhost LLC, incorporated in Los Angeles, CA.**\n\nAnother IP address (117.16.142[.]9) belongs to a range listed as the Korean Education Network and\nlikely belongs to Konkuk university (konkuk.ac.kr). This IP address range has been previously\nreported by Avast as one of those related to the ShadowPad activity linked to the CCleaner incident.\nIt seems that the ShadowPad attackers are still abusing the university’s network to host their C2\ninfrastructure.\n\nThe last one, 103.19.3[.]44, is located in Japan but seems to belong to another Chinese ISP known\nas “xTom Shanghai Limited”. Connected to via the IP address, the server displays an error page\n[from Chinese web management software called BaoTa (“宝塔” in Chinese):](https://www.bt.cn/)\n\n\n-----\n\n## PlugX connection\n\nWhile analyzing the malicious payload injected into the signed ASUS Live Updater binaries, we\ncame across a simple custom encryption algorithm used in the malware. We found that\n[ShadowHammer reused algorithms used in multiple malware samples, including many of PlugX.](https://securelist.com/all/?tag=778)\nPlugX is a backdoor quite popular among Chinese-speaking hacker groups. It had previously been\nseen in the Codoso, MenuPass and Hikit attacks. Some of the samples we found (i.e.\nmd5:5d40e86b09e6fe1dedbc87457a086d95) were created as early as 2012 if the compilation\ntimestamp is anything to trust.\n\n\n-----\n\nApparently, both pieces of code share the same constants (0x11111111, 0x22222222, 0x33333333,\n0x44444444), but also implement identical algorithms to decrypt data, summarized in the python\nfunction below.\n\n\n-----\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n13\n\n\nfrom ctypes import c_uint32\n\nfrom struct import pack,unpack\n\ndef decrypt(data):\n\np1 = p2 = p3 = p4 = unpack(\"&lt;L\", data[0:4])[0];\n\npos = 0\n\ndecdata = \"\"\n\nwhile pos &lt; len(data): p1 = c_uint32(p1 + (p1 &gt;&gt; 3) - 0x11111111).value\n\np2 = c_uint32(p2 + (p2 &gt;&gt; 5) - 0x22222222).value\n\np3 = c_uint32(p3 - (p3 &lt;&lt; 7) + 0x33333333).value\n\np4 = c_uint32(p4 - (p4 &lt;&lt; 9) + 0x44444444).value\n\ndecdata += chr( ( ord(data[pos]) ^ ( ( p1%256 + p2%256 + p3%256 + p4%256 ) % 256 ) ) )\n\npos += 1\n\nreturn decdata\n\n\n<//pre>\n\nWhile this does not indicate a strong connection to PlugX creators, the reuse of the algorithm is\nunusual and may suggest that the ShadowHammer developers had some experience with PlugX\nsource code, and possibly compiled and used PlugX in some other attacks in the past.\n\n## Compromising software developers\n\nAll of the analyzed ASUS Live Updater binaries were backdoored using the same executable file\npatched by an external malicious application, which implemented malware injection on demand.\nAfter that, the attackers signed the executable and delivered it to the victims via ASUS update\nservers, which was detected by Kaspersky Lab products.\n\nHowever, in the non-ASUS cases, the malware was seamlessly integrated into the code of recently\ncompiled legitimate applications, which suggests that a different technique was used. Our deep\nsearch revealed another malware injection mechanism, which comes from a trojanized development\nenvironment used by software coders in the organization.\n\nIn late 2018, we found a suspicious sample of the link.exe tool uploaded to a public malware\nscanning service. The tool is part of Microsoft Visual Studio, a popular integrated development\nenvironment (IDE) used for creating applications for Microsoft Windows. The same user also\nuploaded digitally signed compromised executables and some of the backdoors used in the same\ncampaign.\n\n\n-----\n\nThe attack is comprised of an infected Microsoft Incremental Linker, a malicious DLL module that\ngets loaded through the compromised linker. The malicious DLL then hooks the file open operation\nand redirects attempts to open a commonly used C++ runtime library during the process of static\nlinking. The redirect destination is a malicious .lib file, which gets linked with the target software\ninstead of the legitimate library. The code also carefully checks which executable is being linked and\napplies file redirection only if the name matches the hardcoded target file name.\n\nSo, was it a developer from a videogame company that installed the trojanized version of the\ndevelopment software, or did the attackers deploy the Trojan code after compromising the\ndeveloper’s machine? This currently remains unknown. While we could not identify how the\nattackers managed to replace key files in the integrated development environment, this should\nserve as a wakeup call to all software developers. If your company produces software, you should\nask yourself:\n\n1. Where does my development software come from?\n2. Is the delivery process (download) of IDE distributions secure?\n3. When did we last check the integrity of our development software?\n\n## Other victims\n\nDuring the analysis of samples related to the updated ShadowPad arsenal, we discovered one\nunusual backdoor executable (md5: 092ae9ce61f6575344c424967bd79437). It comes as a DLL\ninstalled as a service that indirectly listens to TCP port 80 on the target system and responds to a\nspecific URL schema, registered with Windows HTTP Service API: http://+/requested.html. The\nmalware responds to HTTP GET/POST requests using this schema and is not easy to discover,\nwhich can help it remain invisible for a long time.\n\nBased on the malware network behavior, we identified three further, previously unknown, victims, a\nvideogame company, a conglomerate holding company and a pharmaceutical company, all based in\nSouth Korea, which responded with a confirmation to the malware protocol, indicating compromised\nservers. We are in the process of notifying the victim companies via our local regional channels.\nConsidering that this type of malware is not widely used and is a custom one, we believe that the\nsame threat actor or a related group are behind these further compromises. This expands the list of\npreviously known usual targets.\n\n## Conclusions\n\nWhile attacks on supply chain companies are not new, the current incident is a big landmark in the\ncyberattack landscape. Not only does it show that even reputable vendors may suffer from\ncompromising of digital certificates, but it raises many concerns about the software development\ninfrastructure of all other software companies. ShadowPad, a powerful threat actor, previously\nconcentrated on hitting one company at a time. Current research revealed at least four companies\ncompromised in a similar manner, with three more suspected to have been breached by the same\nattacker. How many more companies are compromised out there is not known. What is known is\nthat ShadowPad succeeded in backdooring developer tools and, one way or another, injected\nmalicious code into digitally signed binaries, subverting trust in this powerful defense mechanism.\n\n\n-----\n\nDoes it mean that we should stop trusting digital signatures? No. But we definitely need to\ninvestigate all strange or anomalous behavior, even by trusted and signed applications. Software\nvendors should introduce another line in their software building conveyor that additionally checks\ntheir software for potential malware injections even after the code is digitally signed.\n\nAt this unprecedented scale of operations, it is still a mystery why attackers reduced the impact by\nlimiting payload execution to 600+ victims in the case of ASUS. We are also unsure who the\nultimate victims were or where the attackers had collected the victims MAC addresses from. If you\n[believe you are one of the victims, we recommend checking your MAC address using this free tool](https://kas.pr/shadowhammer)\nor [online check website. And if you discover that you have been targeted by this operation, please](https://shadowhammer.kaspersky.com/)\n[email us at shadowhammer@kaspersky.com.](http://10.10.0.46/mailto:shadowhammer@kaspersky.com)\n\nWe will keep tracking the ShadowPad activities and inform you about new findings!\n\n## Indicators of compromise\n\n**C2 servers:**\n\n103.19.3[.]17\n103.19.3[.]43\n103.19.3[.]44\n117.16.142[.]9\n23.236.77[.]175\n23.236.77[.]177\n\n**Malware samples and trojanized files:**\n\n02385ea5f8463a2845bfe362c6c659fa 915086d90596eb5903bcd5b02fd97e3e\n\n04fb0ccf3ef309b1cd587f609ab0e81e 943db472b4fd0c43428bfc6542d11913\n\n05eacf843b716294ea759823d8f4ab23 95b6adbcef914a4df092f4294473252f\n\n063ff7cc1778e7073eacb5083738e6a2 98908ce6f80ecc48628c8d2bf5b2a50c\n\n06c19cd73471f0db027ab9eb85edc607 9d86dff1a6b70bfdf44406417d3e068f\n\n0e1cc8693478d84e0c5e9edb2dc8555c a17cb9df43b31bd3dad620559d434e53\n\n0f49621b06f2cdaac8850c6e9581a594 a283d5dea22e061c4ab721959e8f4a24\n\n128cecc59c91c0d0574bc1075fe7cb40 a4b42c2c95d1f2ff12171a01c86cd64f\n\n17a36ac3e31f3a18936552aff2c80249 a76a1fbfd45ad562e815668972267c70\n\n1a0752f14f89891655d746c07da4de01 a96226b8c5599e3391c7b111860dd654\n\n1b95ac1443eb486924ac4d399371397c a9c750b7a3bbf975e69ef78850af0163\n\n1d05380f3425d54e4ddfc4bacc21d90e aa15eb28292321b586c27d8401703494\n\n\n-----\n\n1e091d725b72aed432a03a505b8d617e aac57bac5f849585ba265a6cd35fde67\n\n2ffc4f0e240ff62a8703e87030a96e39 aafe680feae55bb6226ece175282f068\n\n322cb39bc049aa69136925137906d855 abbb53e1b60ab7044dd379cf80042660\n\n343ad9d459f4154d0d2de577519fb2d3 abbd7c949985748c353da68de9448538\n\n36dd195269979e01a29e37c488928497 b042bc851cafd77e471fa0d90a082043\n\n3c0a0e95ccedaaafb4b3f6fd514fd087 b044cd0f6aae371acf2e349ef78ab39e\n\n496c224d10e1b39a22967a331f7de0a2 b257f366a9f5a065130d4dc99152ee10\n\n4b8d5ae0ad5750233dc1589828da130b b4abe604916c04fe3dd8b9cb3d501d3f\n\n4fb4c6da73a0a380c6797e9640d7fa00 b572925a7286355ac9ebb12a9fc0cc79\n\n5220c683de5b01a70487dac2440e0ecb b96bd0bda90d3f28d3aa5a40816695ed\n\n53886c6ebd47a251f11b44869f67163d c0116d877d048b1ba87c0de6fd7c3fb2\n\n55a7aa5f0e52ba4d78c145811c830107 c778fc8e816061420c537db2617e0297\n\n5855ce7c4a3167f0e006310eb1c76313 cdb0a09067877f30189811c7aea3f253\n\n5b6cd0a85996a7d47a8e9f8011d4ad3f d07e6abebcf1f2119622c60ad0acf4fa\n\n5eed18254d797ccea62d5b74d96b6795 d1ed421779c31df2a059fe0f91c24721\n\n6186b317c8b6a9da3ca4c166e68883ea d4c4813b21556dd478315734e1c7ae54\n\n63606c861a63a8c60edcd80923b18f96 dc15e578401ad9b8f72c4d60b79fdf0f\n\n63f2fe96de336b6097806b22b5ab941a dca86d2a9eb6dc53f549860f103486a9\n\n6ab5386b5ad294fc6ec4d5e47c9c2470 dd792f9185860e1464b4346254b2101b\n\n6b38c772b2ffd7a7818780b29f51ccb2 e7dcfa8e75b0437975ce0b2cb123dc7b\n\n6cf305a34a71b40c60722b2b47689220 e8db4206c2c12df7f61118173be22c89\n\n6e94b8882fe5865df8c4d62d6cff5620 ea3b7770018a20fc7c4541c39ea271af\n\n7d9d29c1c03461608bcab930fef2f568 eac3e3ece94bc84e922ec077efb15edd\n\n807d86da63f0db1fc746d1f0b05bc357 ecf865c95a9bec46aa9b97060c0e317d\n\n849a2b0dc80aeca3d175c139efe5221c ef43b55353a34be9e93160bb1768b1a6\n\n8505484efde6a1009f90fa02ca42f011 f0ba34be0486037913e005605301f3ce\n\n8578f0c7b0a14f129cc66ee236c58050 f2f879989d967e03b9ea0938399464ab\n\n86a4cac227078b9c95c560c8f0370bf0 f4edc757e9917243ce513f22d0ccacf2\n\n\n-----\n\n8756bafa7f0a9764311d52bc792009f9 f9d46bbffa1cbd106ab838ee0ccc5242\n\n87a8930e88e9564a30288572b54faa46 fa83ffde24f149f9f6d1d8bc05c0e023\n\n88777aacd5f16599547926a4c9202862 fa96e56e7c26515875214eec743d2db5\n\n8baa46d0e0faa2c6a3f20aeda2556b18 fb1473e5423c8b82eb0e1a40a8baa118\n\n8ef2d715f3a0a3d3ebc989b191682017 fcfab508663d9ce519b51f767e902806\n\n092ae9ce61f6575344c424967bd79437 7f05d410dc0d1b0e7a3fcc6cdda7a2ff\n\neb37c75369046fb1076450b3c34fb8ab\n\n[ASUS](https://securelist.com/tag/asus/)\n[Backdoor](https://securelist.com/tag/backdoor/)\n[BIOS](https://securelist.com/tag/bios/)\n[Digital Certificates](https://securelist.com/tag/digital-certificates/)\n[Drivers](https://securelist.com/tag/drivers/)\n[Supply-chain attack](https://securelist.com/tag/supply-chain-attack/)\n[Targeted attacks](https://securelist.com/tag/targeted-attacks/)\n[UEFI](https://securelist.com/tag/uefi/)\n[Vulnerabilities and exploits](https://securelist.com/tag/vulnerabilities-and-exploits/)\n\nAuthors\n\nGReAT\n\nAMR\n\nOperation ShadowHammer: a high-profile supply chain attack\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-04-23 - Operation ShadowHammer- a high-profile supply chain attack.pdf"
    ],
    "report_names": [
        "2019-04-23 - Operation ShadowHammer- a high-profile supply chain attack.pdf"
    ],
    "threat_actors": [
        {
            "id": "1f3cf3d1-4764-4158-a216-dd6352e671bb",
            "created_at": "2022-10-25T15:50:23.837615Z",
            "updated_at": "2025-03-27T02:00:55.556414Z",
            "deleted_at": null,
            "main_name": "APT19",
            "aliases": [
                "APT19",
                "Codoso",
                "C0d0so0",
                "Codoso Team",
                "Sunshop Group"
            ],
            "source_name": "MITRE:APT19",
            "tools": [
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1c97ccfd-1888-492c-b7b9-bb52c4c3809b",
            "created_at": "2023-01-06T13:46:38.940529Z",
            "updated_at": "2025-03-27T02:00:02.957652Z",
            "deleted_at": null,
            "main_name": "Operation ShadowHammer",
            "aliases": [],
            "source_name": "MISPGALAXY:Operation ShadowHammer",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ba3fff0c-3ba0-4855-9eeb-1af9ee18136a",
            "created_at": "2022-10-25T15:50:23.298889Z",
            "updated_at": "2025-03-27T02:00:55.433541Z",
            "deleted_at": null,
            "main_name": "menuPass",
            "aliases": [
                "menuPass",
                "POTASSIUM",
                "Stone Panda",
                "APT10",
                "Red Apollo",
                "CVNX",
                "HOGFISH",
                "BRONZE RIVERSIDE"
            ],
            "source_name": "MITRE:menuPass",
            "tools": [
                "certutil",
                "FYAnti",
                "UPPERCUT",
                "SNUGRIDE",
                "P8RAT",
                "RedLeaves",
                "SodaMaster",
                "pwdump",
                "Mimikatz",
                "PlugX",
                "PowerSploit",
                "ChChes",
                "cmd",
                "QuasarRAT",
                "AdFind",
                "Cobalt Strike",
                "PoisonIvy",
                "EvilGrab",
                "esentutl",
                "Impacket",
                "Ecipekac",
                "PsExec",
                "HUI Loader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "ba9fa308-a29a-4928-9c06-73aafec7624c",
            "created_at": "2024-05-01T02:03:07.981061Z",
            "updated_at": "2025-03-27T02:05:17.28602Z",
            "deleted_at": null,
            "main_name": "BRONZE RIVERSIDE",
            "aliases": [
                "CTG-5938 ",
                "CVNX ",
                "Hogfish ",
                "MenuPass ",
                "POTASSIUM ",
                "Red Apollo ",
                "Stone Panda ",
                "APT10 "
            ],
            "source_name": "Secureworks:BRONZE RIVERSIDE",
            "tools": [
                " ChChes",
                " Cobalt Strike",
                " PlugX",
                " PoisonIvy",
                " QuasarRAT",
                " QuasarRAT Loader",
                " RedLeaves",
                "ANEL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "46a151bd-e4c2-46f9-aee9-ee6942b01098",
            "created_at": "2023-01-06T13:46:38.288168Z",
            "updated_at": "2025-03-27T02:00:02.794118Z",
            "deleted_at": null,
            "main_name": "APT19",
            "aliases": [
                "Black Vine",
                "TEMP.Avengers",
                "PinkPanther",
                "G0073",
                "KungFu Kittens",
                "Group 13",
                "Shell Crew",
                "BRONZE FIRESTONE",
                "G0009",
                "Sunshop Group",
                "DEEP PANDA",
                "Codoso"
            ],
            "source_name": "MISPGALAXY:APT19",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c7d9878a-e691-4c6f-81ae-84fb115a1345",
            "created_at": "2022-10-25T16:07:23.359506Z",
            "updated_at": "2025-03-27T02:02:09.752427Z",
            "deleted_at": null,
            "main_name": "APT 41",
            "aliases": [
                "BrazenBamboo",
                "Bronze Atlas",
                "Double Dragon",
                "Earth Baku",
                "Grayfly",
                "Operation ColunmTK",
                "Operation CuckooBees",
                "Operation ShadowHammer",
                "Red Kelpie",
                "SparklingGoblin",
                "TA415",
                "TG-2633"
            ],
            "source_name": "ETDA:APT 41",
            "tools": [
                "9002 RAT",
                "ADORE.XSEC",
                "ASPXSpy",
                "ASPXTool",
                "AceHash",
                "Agent.dhwf",
                "Agentemis",
                "AndroidControl",
                "AngryRebel",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BLUEBEAM",
                "Barlaiy",
                "BlackCoffee",
                "Bladabindi",
                "BleDoor",
                "CCleaner Backdoor",
                "CHINACHOPPER",
                "COLDJAVA",
                "China Chopper",
                "ChyNode",
                "Cobalt Strike",
                "CobaltStrike",
                "Crackshot",
                "CrossWalk",
                "CurveLast",
                "CurveLoad",
                "DAYJOB",
                "DBoxAgent",
                "DEADEYE",
                "DEADEYE.APPEND",
                "DEADEYE.EMBED",
                "DEPLOYLOG",
                "DIRTCLEANER",
                "DUSTTRAP",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "DodgeBox",
                "DragonEgg",
                "ELFSHELF",
                "EasyNight",
                "Farfli",
                "FunnySwitch",
                "Gh0st RAT",
                "Ghost RAT",
                "HDD Rootkit",
                "HDRoot",
                "HKDOOR",
                "HOMEUNIX",
                "HUI Loader",
                "HidraQ",
                "HighNoon",
                "HighNote",
                "Homux",
                "Hydraq",
                "Jorik",
                "Jumpall",
                "KEYPLUG",
                "Kaba",
                "Korplug",
                "LATELUNCH",
                "LOLBAS",
                "LOLBins",
                "LightSpy",
                "Living off the Land",
                "Lowkey",
                "McRAT",
                "MdmBot",
                "MessageTap",
                "Meterpreter",
                "Mimikatz",
                "MoonBounce",
                "MoonWalk",
                "Motnug",
                "Moudour",
                "Mydoor",
                "NTDSDump",
                "PACMAN",
                "PCRat",
                "PINEGROVE",
                "PNGRAT",
                "POISONPLUG",
                "POISONPLUG.SHADOW",
                "POTROAST",
                "PRIVATELOG",
                "PipeMon",
                "PlugX",
                "PortReuse",
                "ProxIP",
                "ROCKBOOT",
                "RbDoor",
                "RedDelta",
                "RedXOR",
                "RibDoor",
                "Roarur",
                "RouterGod",
                "SAGEHIRE",
                "SPARKLOG",
                "SQLULDR2",
                "STASHLOG",
                "SWEETCANDLE",
                "ScrambleCross",
                "Sensocode",
                "SerialVlogger",
                "ShadowHammer",
                "ShadowPad Winnti",
                "SinoChopper",
                "Skip-2.0",
                "SneakCross",
                "Sogu",
                "Speculoos",
                "Spyder",
                "StealthReacher",
                "StealthVector",
                "TERA",
                "TIDYELF",
                "TIGERPLUG",
                "TOMMYGUN",
                "TVT",
                "Thoper",
                "Voldemort",
                "WIDETONE",
                "WINNKIT",
                "WINTERLOVE",
                "Winnti",
                "WyrmSpy",
                "X-Door",
                "XDOOR",
                "XMRig",
                "XShellGhost",
                "Xamtrav",
                "ZXShell",
                "ZoxPNG",
                "certutil",
                "certutil.exe",
                "cobeacon",
                "gresim",
                "njRAT",
                "pwdump",
                "xDll"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "0639667a-fb3f-43d9-a38c-6c123fd19c7f",
            "created_at": "2022-10-25T16:07:23.335869Z",
            "updated_at": "2025-03-27T02:02:09.743237Z",
            "deleted_at": null,
            "main_name": "APT 19",
            "aliases": [
                "APT 19",
                "Bronze Firestone",
                "C0d0so0",
                "Codoso",
                "Deep Panda",
                "Operation Kingslayer",
                "Red Pegasus",
                "Sunshop Group",
                "TG-3551"
            ],
            "source_name": "ETDA:APT 19",
            "tools": [
                "Agentemis",
                "C0d0so0",
                "Cobalt Strike",
                "CobaltStrike",
                "Derusbi",
                "EmPyre",
                "EmpireProject",
                "Fire Chili",
                "PowerShell Empire",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "04b07437-41bb-4126-bcbb-def16f19d7c6",
            "created_at": "2022-10-25T16:07:24.232628Z",
            "updated_at": "2025-03-27T02:02:10.146043Z",
            "deleted_at": null,
            "main_name": "Stone Panda",
            "aliases": [
                "APT 10",
                "ATK 41",
                "Bronze Riverside",
                "CTG-5938",
                "CVNX",
                "Cuckoo Spear",
                "Earth Kasha",
                "Granite Taurus",
                "Happyyongzi",
                "Hogfish",
                "ITG01",
                "Operation A41APT",
                "Operation Cache Panda",
                "Operation ChessMaster",
                "Operation Cloud Hopper",
                "Operation Cuckoo Spear",
                "Operation New Battle",
                "Operation Soft Cell",
                "Operation TradeSecret",
                "Potassium",
                "Red Apollo",
                "Stone Panda",
                "TA429",
                "menuPass",
                "menuPass Team"
            ],
            "source_name": "ETDA:Stone Panda",
            "tools": [
                "Agent.dhwf",
                "Agentemis",
                "Anel",
                "AngryRebel",
                "BKDR_EVILOGE",
                "BKDR_HGDER",
                "BKDR_NVICM",
                "BUGJUICE",
                "CHINACHOPPER",
                "ChChes",
                "China Chopper",
                "Chymine",
                "CinaRAT",
                "Cobalt Strike",
                "CobaltStrike",
                "DARKTOWN",
                "DESLoader",
                "DILLJUICE",
                "DILLWEED",
                "Darkmoon",
                "DelfsCake",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "Ecipekac",
                "Emdivi",
                "EvilGrab",
                "EvilGrab RAT",
                "FYAnti",
                "Farfli",
                "Gen:Trojan.Heur.PT",
                "Gh0st RAT",
                "Ghost RAT",
                "GreetCake",
                "HAYMAKER",
                "HEAVYHAND",
                "HEAVYPOT",
                "HTran",
                "HUC Packet Transmit Tool",
                "Ham Backdoor",
                "HiddenFace",
                "Impacket",
                "Invoke the Hash",
                "KABOB",
                "Kaba",
                "Korplug",
                "LODEINFO",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "MiS-Type",
                "Mimikatz",
                "Moudour",
                "Mydoor",
                "NBTscan",
                "NOOPDOOR",
                "Newsripper",
                "P8RAT",
                "PCRat",
                "PlugX",
                "Poison Ivy",
                "Poldat",
                "PowerSploit",
                "PowerView",
                "PsExec",
                "PsList",
                "Quarks PwDump",
                "Quasar RAT",
                "QuasarRAT",
                "RedDelta",
                "RedLeaves",
                "Rubeus",
                "SNUGRIDE",
                "SPIVY",
                "SharpSploit",
                "SigLoader",
                "SinoChopper",
                "SodaMaster",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Trochilus RAT",
                "UpperCut",
                "Vidgrab",
                "WinRAR",
                "WmiExec",
                "Wmonder",
                "Xamtrav",
                "Yggdrasil",
                "Zlib",
                "certutil",
                "certutil.exe",
                "cobeacon",
                "dfls",
                "lena",
                "nbtscan",
                "pivy",
                "poisonivy",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535552,
    "ts_updated_at": 1743041834,
    "ts_creation_date": 1653703437,
    "ts_modification_date": 1653703437,
    "files": {
        "pdf": "https://archive.orkl.eu/8b15fbd0a47594ac8b0dbd33efd9130cc0062fb8.pdf",
        "text": "https://archive.orkl.eu/8b15fbd0a47594ac8b0dbd33efd9130cc0062fb8.txt",
        "img": "https://archive.orkl.eu/8b15fbd0a47594ac8b0dbd33efd9130cc0062fb8.jpg"
    }
}