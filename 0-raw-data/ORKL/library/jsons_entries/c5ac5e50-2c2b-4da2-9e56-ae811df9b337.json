{
    "id": "c5ac5e50-2c2b-4da2-9e56-ae811df9b337",
    "created_at": "2023-01-12T15:08:56.648497Z",
    "updated_at": "2025-03-27T02:05:41.636894Z",
    "deleted_at": null,
    "sha1_hash": "4b7c3ce45a75c58e27e2e07131c2a3ab93b10127",
    "title": "2020-04-03 - GuLoader- Malspam Campaign Installing NetWire RAT",
    "authors": "",
    "file_creation_date": "2022-05-28T00:21:22Z",
    "file_modification_date": "2022-05-28T00:21:22Z",
    "file_size": 1801054,
    "plain_text": "# GuLoader: Malspam Campaign Installing NetWire RAT\n\n**[unit42.paloaltonetworks.com/guloader-installing-netwire-rat/](https://unit42.paloaltonetworks.com/guloader-installing-netwire-rat/)**\n\nBrad Duncan April 3, 2020\n\nBy [Brad Duncan](https://unit42.paloaltonetworks.com/author/bduncan/)\n\nApril 3, 2020 at 6:00 AM\n\n[Category: Unit 42](https://unit42.paloaltonetworks.com/category/unit-42/)\n\nTags: [Malspam,](https://unit42.paloaltonetworks.com/tag/malspam/) [NetWire,](https://unit42.paloaltonetworks.com/tag/netwire/) [NetWireRAT,](https://unit42.paloaltonetworks.com/tag/netwirerat/) [RAT](https://unit42.paloaltonetworks.com/tag/rat/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/guloader-installing-netwire-rat/)\n\n## Executive Summary\n\n[NetWire is a publicly-available RAT that has been used by criminal organizations and other](https://attack.mitre.org/software/S0198/)\nmalicious groups since 2012. NetWire is distributed through various campaigns, and we\n[usually see it sent through malicious spam (malspam). GuLoader is a file downloader that](https://www.proofpoint.com/us/threat-insight/post/guloader-popular-new-vb6-downloader-abuses-cloud-services)\nwas first discovered in December 2019, and it has been used to distribute a wide variety of\nremote administration tool (RAT) malware.\n\nThis blog reviews a recent distribution chain in March 2020 using Microsoft Word documents\nto distribute NetWire through GuLoader. We review the infection chain of events, examine\n[the associated network traffic, and cover post-infection artifacts from an infected Windows](https://www.malware-traffic-analysis.net/2020/03/25/index.html)\n\n\n-----\n\nhost. This material is primarily helpful to Security Operations Center (SOC) personnel like\nfront-line analysts and people who perform forensic investigations.\n\nThis blog covers the following areas:\n\nChain of events\nEmail lures\nMalicious Word documents\nThe initial binary\nInfection traffic\nForensics on an infected Windows host\n\n## Chain of Events\n\nThis chain of events kicks off with an email. The email contains a web link for a Microsoft\nWord document. The Word document has macro code that retrieves a Windows executable\nfor GuLoader. The executable retrieves an encrypted data file used for NetWire. Then we\nsee command and control (C2) traffic for NetWire RAT activity. See Figure 1 for a flow chart\nof this infection chain.\n\nFigure\n\n1. Chain of events for this NetWire RAT infection.\n\n### Email Lures\n\nMalspam distributing NetWire typically uses attachments or links for the malware. Figure 2\n[shows one such example from August 2019 with both an attachment and a link for the same](https://www.malware-traffic-analysis.net/2019/08/23/index.html)\n[Word document to kick off a NetWire RAT infection.](https://www.virustotal.com/gui/file/dfad11b652c183e0a911913bb05e2c72e27a302a18f0c93c3f1dd2d443fbce4f/community)\n\n\n-----\n\nFigure\n\n2. Malspam from August 2019 with both a link and an attachment for a Word document to\nkick off a NetWire RAT infection.\n[GuLoader is now widely used for RAT distribution in 2020 and we continue to see the same](https://www.proofpoint.com/us/threat-insight/post/guloader-popular-new-vb6-downloader-abuses-cloud-services)\ntype of email lures for malspam pushing NetWIre RAT.\n\n**Malicious Word Documents**\n\nFor an infection chain from March 2020, we clicked on an email link discovered through\n[AutoFocus to retrieve a malicious Word document as shown in Figure 3.](https://www.paloaltonetworks.com/cortex/autofocus)\n\n\n-----\n\nFigure\n\n3. Downloading a malicious Word document from the link in the malspam\nOur research led us to two links that generated similar infection chains:\n\nhxxp://www.artizaa[.]com/Andys_18US_Tax.doc\nhxxp://murthydigitals[.]com/PM_2019_Screen_18_Tax_File.doc\n\nBoth links returned Word documents for the same type of NetWire RAT activity. Each\ndocument used a different template. Compare Figure 4 with Figure 5 to see the difference in\neach document.\n\nFigure\n\n4. Document from one of the links to start NetWire RAT infection\n\n\n-----\n\nFigure\n\n5. Document from another one of the links to start a NetWire RAT infection\n\n**The Initial Binary**\n\nEnabling macros for each of these Word documents generated an infection on a vulnerable\nWindows host. Each vulnerable host retrieved an initial binary for GuLoader and ran it from\nthe infected users’ AppData\\Local\\Temp directory. Figure 7 and Figure 8 show examples\nfrom each Word document.\n\n\n-----\n\nFigure\n\n\n7. Binary for GuLoader after enabling macros on Andys_18US_Tax.doc\n\n\n-----\n\nFigure\n\n8. Binary for GuLoader after enabling macros on PM_2019_Screen_18_Tax_File.doc\n\n**Infection Traffic**\n\n[Pcaps of the infection traffic revealed the following:](https://www.malware-traffic-analysis.net/2020/03/25/index.html)\n\nHTTP request that returned a malicious Word document\nHTTP request that returned a malicious Windows executable file (GuLoader)\nHTTP request that returned an encoded binary\nTCP traffic for NetWire RAT\n\nSee Figure 9 and Figure 10 for images of the traffic filtered in Wireshark.\n\n\n-----\n\nFigure\n\n9. NetWire RAT infection traffic associated with PM_2019_Screen_18_Tax_File.doc and\nGuLoader filtered in Wireshark\n\nFigure\n\n10. NetWire RAT infection traffic associated with Andys_18US_Tax.doc and GuLoader\nfiltered in Wireshark\nThis March 2020 infection traffic follows the same concept for GuLoader to RAT activity\n[discussed in a previous analysis of GuLoader.](https://www.proofpoint.com/us/threat-insight/post/guloader-popular-new-vb6-downloader-abuses-cloud-services)\n\n**Forensics on an Infected Windows Host**\n\nA copy of the initial EXE for GuLoader is made persistent, then the original is deleted from\nthe infected user’s AppData\\Local\\Temp directory where it was originally saved. The\nGuLoader EXE is persistent through the Windows Registry under the following key:\n\n\n-----\n\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce\n\nTwo examples of this Registry update are shown in Figure 11 and Figure 12.\n\n11. First example of GuLoader persistent through the Windows Registry.\n\n\nFigure\n\nFigure\n\n\n12. Second example of GuLoader persistent through the Windows Registry\nBecause this is ultimately a NetWire RAT infection, we can also find a registry update at\nHKCU\\Software\\NetWire like the example shown in Figure 13.\n\nFigure\n\n13. Windows Registry update for NetWire\nWe can also find artifacts associated with a NetWire infection as shown in Figure 14 and\nFigure 15.\n\n\n-----\n\n14. First example of file indicating data exfiltrated by NetWire RAT on 2020-03-25\n\n\nFigure\n\nFigure\n\n\n15. Second example of file indicating data exfiltrated by NetWire RAT on March 25, 2020\n\n## Conclusion\n\nThese types of infections are not very effective against Windows 10 hosts using default\nsecurity settings. Versions of Microsoft Office since 2013 have Protected View enabled by\ndefault that prevents users from enabling macros in Word documents downloaded from the\nInternet. Furthermore, Real-time protection and Tamper protection settings in Windows\nDefender were remarkably effective in preventing these infections within a Windows 10 test\nenvironment. Finally, within 24 hours of discovery, URLs serving the malware associated with\nthese infections had been taken off-line.\n\nHowever, criminal distribution of RATs and other types of commodity malware are often a catand-mouse game against security vendors. After one wave of malware is distributed, the\nbinaries are updated, and another wave is quickly released into the wild. These efforts rely\non wide-scale distribution from the criminals and poor security practices among potential\nvictims. Only a small percentage infection attempts need to be successful for these efforts to\nbe cost-effective.\n\n[Palo Alto Networks customers are further protected through our threat prevention platform](https://www.paloaltonetworks.com/network-security)\n[which is designed to detect and block such threats, and AutoFocus shows these binaries as](https://www.paloaltonetworks.com/cortex/autofocus)\nmalicious. As long as this type of malware distribution remains cost-effective, criminals will\n\n\n-----\n\ncontinue to pursue such methods of attack.\n\n### Indicators of Compromise\n\n**Infection traffic - first run on 2020-03-25**\n\n116.202.210[.]82 port 80 - murthydigitals[.]com - GET\n/PM_2019_Screen_18_Tax_File.doc\n213.219.212[.]206 port 80 - ptgteft[.]com - GET /Exten/TY1920/TY30.exe\n213.219.212[.]206 port 80 - matpincscr[.]com - GET /tec_encrypted_340BD0.bin\n185.163.47[.]213 port 2121 - www.Novmintservices[.]com - NetWire RAT postinfection TCP traffic\n\n**Infection traffic - second run on 2020-03-25**\n\n104.27.138[.]31 port 80 - www.artizaa[.]com - GET /Andys_18US_Tax.doc\n213.219.212[.]206 port 80 - saidialxo[.]com - GET /lp.exe\n185.196.8[.]122 port 80 - www.rossogato[.]com - GET\n/ROSSO_encrypted_54E9BA0.bin\n185.163.47[.]168 port 2020 - www.myamystills[.]com - NetWire RAT post-infection\nTCP traffic\n\n**Malware - first run**\n\ncc554633c0b734778211a6289e1d6d383d734a3e1a8edeb13d6d0fafc8a2f162\n\nSize: 117,204 bytes\nLocation: hxxp://murthydigitals[.]com/PM_2019_Screen_18_Tax_File.doc\nDescription: Word doc with malicious macro\n\n4d373131b0d3254d72f1a06ea168267376b8cc8f805daa53963db5f051631967\n\nSize: 65,536 bytes\nLocation: hxxp://ptgteft[.]com/Exten/TY1920/TY30.exe\nDescription: GuLoader retrieved after enabling macros\n\naadc6031fed895de570214afb8b6cdc66f17d01f1df0407f4d57f1d04313ae2b\n\nSize: 130,624 bytes\nLocation: hxxp://matpincscr[.]com/tec_encrypted_340BD0.bin\nDescription: Encrypted binary retrieved by GuLoader for NetWire RAT\n\n**Malware - second run**\n\nc87e798118a539a136baa0bb9d2539a6e074b0ee640cf0a4ed1ef17936f69ebf\n\n\n-----\n\nSize: 150,534 bytes\nLocation: hxxp://www.artizaa[.]com/Andys_18US_Tax.doc\nDescription: Word doc with malicious macro\n\ne895c525a99922beedf02ca7742c49f320448522185bec8f7d2a49d6cee9f24\n\nSize: 69,632 bytes\nLocation: hxxp://saidialxo[.]com/lp.exe\nDescription: GuLoader retrieved after enabling macros\n\n661d9c0c23e9c17412eee8d72cc1bb66c1b4e5f73908c8cce48f89420f38b205\n\nSize: 130,624 bytes\nLocation: hxxp://www.rossogato[.]com/ROSSO_encrypted_54E9BA0.bin\nDescription: Encrypted binary retrieved by GuLoader for NetWire RAT\n\n**Get updates from**\n**Palo Alto**\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\nStatement.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-04-03 - GuLoader- Malspam Campaign Installing NetWire RAT.pdf"
    ],
    "report_names": [
        "2020-04-03 - GuLoader- Malspam Campaign Installing NetWire RAT.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536136,
    "ts_updated_at": 1743041141,
    "ts_creation_date": 1653697282,
    "ts_modification_date": 1653697282,
    "files": {
        "pdf": "https://archive.orkl.eu/4b7c3ce45a75c58e27e2e07131c2a3ab93b10127.pdf",
        "text": "https://archive.orkl.eu/4b7c3ce45a75c58e27e2e07131c2a3ab93b10127.txt",
        "img": "https://archive.orkl.eu/4b7c3ce45a75c58e27e2e07131c2a3ab93b10127.jpg"
    }
}