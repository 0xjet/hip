{
    "id": "209182fb-7b64-471d-ba86-dd8557a704f6",
    "created_at": "2023-01-12T15:06:30.371408Z",
    "updated_at": "2025-03-27T02:15:35.57466Z",
    "deleted_at": null,
    "sha1_hash": "2db7f375edb812398a0514e17b8e27927b7c097b",
    "title": "2020-11-05 - Babax stealer rebrands to Osno, installs rootkit",
    "authors": "",
    "file_creation_date": "2022-05-28T02:21:57Z",
    "file_modification_date": "2022-05-28T02:21:57Z",
    "file_size": 1766938,
    "plain_text": "# Babax stealer rebrands to Osno, installs rootkit\n\n**[gdatasoftware.com/blog/2020/11/36459-babax-stealer-rebrands-to-osno-installs-rootkit](https://www.gdatasoftware.com/blog/2020/11/36459-babax-stealer-rebrands-to-osno-installs-rootkit)**\n\nBabax not only changes its name but also adds a Ring 3 rootkit and lateral spreading capabilities. Furthermore it\nhas a ransomware component called OsnoLocker. Is this combination as dangerous as it sounds?\n\n## Emergence of Babax and Osno\n\nBabax stealer is at least around since June 2019. At that time a user named ForlayPy gave away the source\ncode for free after being dissatisfied with a customer they sold the source to.\n\nA colleague of mine discovered the first Osno stealer sample[1] on 5th October 2020. The sample[1] is a packed\n.NET assembly with the module name FallGuysStats. The module name indicates that it is using a statistics\ngenerator for the Steam game Fall Guys as a lure. The config shows version Osno 2.1.5 and has placeholders\nfor some of the functions, including FTP and Telegram settings.\n\n[By the end of October researcher @backsla3h noted that the stealer is sold on forums. The advertisment](https://twitter.com/backsla3h)\ncomparison of Babax and Osno shows not only an increased price but also four more features or \"Benefits\" for\nOsno: r77 and network spreading, Anti-AV and evasion of WindowsDefender via allowlist, AnarchyGrabber and\nmicrophone records. Additionally there is a ransomware module which is not advertised (yet). Most of these\nfeatures are described in the following sections.\n\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n## Rootkit r77\n\n[Although the advertisment calls this an exploit, it is actually an open source rootkit by bytecode77. The Github](https://github.com/bytecode77/r77-rootkit)\nrepo provides DLL's for this rootkit as well as an installer. Osno does the installation itself. Just like the rootkit\ninstaller, Osno registers the rootkit DLL to AppInit_DLLs and enables LoadAppInit_DLLs so it is loaded with\nevery process. Because the rookit DLLs are not signed, it sets RequireSignedAppInit_DLLs to 0.\n\nThe rootkit uses MinHook to redirect WinAPI calls, so that it hides processes and file names, e.g., from explorer\nand taskmanager. The proof-of-concept binaries for the rootkit hide files and processes that start with \"$77\".\nSince Osno uses the proof-of-concept binaries, it needs to add the prefix \"$77\" to its own files to make it work.\n\n\n-----\n\nFile hiding demonstration by r77 rootkit. Image from https://github.com/bytecode77/r77-rootkit\nThe Github README.md for r77 states that the rootkit is still work in progress. Because of that hiding files for x86\nis currently unstable and disabled in the proof-of-concept files.\n\n## Lateral movement via SharpExec\n\n[Osno collects all accessible IP adresses in the local network, then downloads SharpExec binaries from Github.](https://github.com/anthemtotheego/SharpExec)\nSharpExec is a tool with various commands for lateral movement. Osno executes the following command for\nevery collected IP and domain:\n```\n<sharpexec> -m=psexec -i=<collected-ip> -d=<collected-domain> -f=<path-in:%TEMP%/gpustats.bx> e=%TEMP%/<randomname>\n\n```\nThe file gpustats.bx contains the path to the Osno executable. This command attempts to upload Osno to the\ngiven IP into the %TEMP% folder and executes it. That way Osno is able to spread to all accessible computers\nwithin the network.\n\n## Anti-AV\n\nThe following Anti-AV features are those of the unpacked Osnoe sample[2]. The packer stub itself has also AntiAV which is beyond the scope of this article.\n\n### Windows Defender\n\nOsno adds its own path and the root of drive C: as exclusion folder for Windows Defender using the following\nPowerShell commands:\n```\nAdd-MpPreference -ExclusionPath C:\\\nAdd-MpPreference -ExclusionPath <path-to-malware>\n\n```\nThis can only be successful if the malware has already gotten foothold on the system and obtained administrator\nprivileges.\n\n### Other AVs\n\n\n-----\n\nOsno searches for Window titles and process names to kill the processes of Antivirus software. It does this for\nthe following window titles and process names:\n\nWindow title \"Malwarebytes Anti-Malware\" and process name either mbamgui or mbam\nProcess names: avgidsagent, avgfws, avgtray, avgemcx, avgwdsvc, avgnsx, avgcsrvx, avgrsx, Toolbar\nUpdater\n\nThat means only Malwarebytes Anti-Malware and AVG are affected.\n\n## Osno ransomware is a wiper\n\n[Osno ransomware, or OsnoLocker as it is called in the code, has an implementation for XXTEA. However, it is](https://en.wikipedia.org/wiki/XXTEA)\nnot used in the current sample. Instead it overwrites the original content of the files with a marker. The marker is\nthe string \"OsnoRansom\" appended by a randomly created string of length 50-200 characters consisting of\nuppercase letters A-Z and digits 0-9. Described as a regex this would be ^OsnoRansom([A-Z0-9]){50,200}$.\nThe randomly created string will be different for every affected file.\n\nOsnoLocker adds the .osnoed extension to these files.\n\nOsnoLocker puts a ransom message into a file called RecInstruct.osnoned (sic!). It proceeds to write an\nexecutable to disk named Osno Decryptor.exe[3] whose purpose is to lock the screen, display the ransom\nmessage that was placed in RecInstruct.osnoned and ask for a decryption code. This Osno Decryptor.exe has\nthe module name FakeRansomware.\n\nOsno is a wiper in its current form and payment will not help to get any files back. Recovery of files via shadow\nvolumes copies can work, though. Future versions of Osno might use the already implemented XXTEA to encrypt\nfiles.\n\n\n-----\n\n## AnarchyGrabber and other copied tools\n\n[Osno stealer implements the code of AnarchyGrabber 3. An article by Bleepingcomputer describes the additional](https://www.bleepingcomputer.com/news/security/discord-client-turned-into-a-password-stealer-by-updated-malware/)\nfeatures of the latest AnarchyGrabber version. Just like that version, Osno will force Discord to load JScript files\n**inject.js and discordmod.js. To do that it puts the JScript files into the folder %AppData%\\Discord\\**\n<version>\\modules\\discord_desktop_core\\osno. Discord will then act as a stealer.\n\nAnother tool that this Osno sample uses is Da pure C++ Clipper[4]. A native binary for clipbanking.\n\nFurthermore, [@backsla3h pointed out that the RunPE method and VM/Debugger/Sandbox detection code are](https://twitter.com/backsla3h/status/1321498443974471680)\ntaken from CSharp-RunPE and Anti-Analysis by NYAN-x-CAT.\n\n\n-----\n\nSo we have already identified six different copied sources and tools that are deployed by Osno: SharpExec,\nAnarchyGrabber, Da Pure C++ Clipper, CSharp-RunPE, Anti-Analysis, r77 rootkit. It is likely that there are more\ncopied sources in those functions I didn't look at as they are beyond the scope of this article.\n\n## Conclusion\n\nOsno is not just a stealer anymore. Although that is still the main focus, the added capabilities pose a more\nserious threat, especially RDP access, lateral movement and file destruction.\n\nHowever, none of that seems particularly scary.\n\nFirstly, most of the serious sounding features are only possible after the malware sucessfully accessed the\nsystem and gained administrator privileges. That includes the rootkit and the anti-AV. The lateral movement\nportion depends on an external tool that needs to be downloaded first. It is only successful if network\nadminstrators disregard security measures alltogether, thus, unlikely to cause serious outbreaks.\n\nSecondly, many of the stealer's features have been taken from public respositories and are known to defenders,\nmaking detection of the malware easier. Osno seems to have been worked around some of those tools. E.g., it\nuses the r77 rootkit binaries as is, although they are unfinished and only work with drawbacks. Osno renames its\nfiles to make them work for the rootkit binaries instead of implementing a rootkit that works for the Osno files.\n\nThe ransomware, which may have been self-implemented, seems not finished yet, which is confirmed by\nexistence of non-implemented XXTEA code and the fact that this feature is not advertised. Later versions will\nlikely use encryption instead of destroying files.\n\nDue to the mishmash of open-source code and tools from other malware Osno is best described as a patchwork\nFrankenstein's monster .\n\n## Indicators of compromise\n\n**Sample** **SHA256**\n\n[1] Osno/Babax stealer 3bb9f55514122071824320091030f517a2809c140d86791275037569b26f53f1\n\n[2] Unpacked Osno 4fd221c89030a1fe1c2396a957990693ec8e6330ed79c63bde24abdbc0b8b166\n\n\n\n[3] Screenlocker \"Osno\nDecryptor.exe\"\n\n\n40e4fffa431378e9f09310bba5ff4b8bcec1e11e2b9a606d15f123b696bdb697\n\n\n\n[3] Da pure C++ Clipper 1412516d5f9e43e9c797bbeb3872ef2ff0f68cf51d66288cfd257bb0b56a0e54\n\n**Description** **Indicator of compromise**\n\n\nRegex for names of\ndownloaded and\nexecuted files by Osno\nlocated in %APPDATA%\nfolder\n\nUsed as marker for\ndownload and execute,\ncontains \"0x15\" after\nsuccessful execution.\n\n\n(\\$77-|)[a-z]{7}\\.exe\nExample:\n$77-evlnnrz.exe\nevlnnrz.exe\n\n%APPDATA%\\system.infox\n\n\n-----\n\n**Description** **Indicator of compromise**\n\n\nData file that indicates if\nautorun was set,\ncontains either \"False\"\nor \"01010\"\n\nContains the path of the\nOsno executable\nbase64 encoded or after\nlateral movement the\nstring \"0x14\"\n\nDiscord JScript files\nplaced by\nAnarchyGrabber\n\nAdditional user for RDP\naccess, password\n\"5Z6aW8qRhLWEwS\"\n\nRansom message to be\ndisplayed by\nscreenlocker\n\nRegex for content of\noverwritten files with\n.osnoed extension\n\nStolen data, placed in\n\n%TEMP%\\\n<md5(username)>Osno\\\n<md5(machinename)>Logs\n\n\nC:\\ProgramData\\ar.xdg\n\n%TEMP%/gpustats.bx\n\n%AppData%\\Discord\\<version>\\modules\\discord_desktop_core\\osno\\inject.js\n%AppData%\\Discord\\<version>\\modules\\discord_desktop_core\\osno\\discordmod.js\n\nDefaultuzer\n\nRecInstruct.osnoned\n\n^OsnoRansom([A-Z0-9]){50,200}$\nExample:\nOsnoRansom6ES4BAQ7F2Z4CPMZ3TMDRCP5BLHQQU7NPOS7DKEN1F31VGITX8\n\nChromium Logins.txt\nCookies.txt\nGecko Logins.txt\nDirect Login Cookies.txt\nCreditCards.txt\nOthers.txt\nHardware & Soft.txt\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-11-05 - Babax stealer rebrands to Osno, installs rootkit.pdf"
    ],
    "report_names": [
        "2020-11-05 - Babax stealer rebrands to Osno, installs rootkit.pdf"
    ],
    "threat_actors": [
        {
            "id": "a7d4fe31-d92f-425a-ba8c-c70219f52fb8",
            "created_at": "2022-10-25T15:50:23.466009Z",
            "updated_at": "2025-03-27T02:00:55.477162Z",
            "deleted_at": null,
            "main_name": "Frankenstein",
            "aliases": [
                "Frankenstein"
            ],
            "source_name": "MITRE:Frankenstein",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7ea1e0de-53b9-4059-802f-485884180701",
            "created_at": "2022-10-25T16:07:24.04846Z",
            "updated_at": "2025-03-27T02:02:10.090459Z",
            "deleted_at": null,
            "main_name": "Patchwork",
            "aliases": [
                "APT-C-09",
                "ATK 11",
                "Capricorn Organisation",
                "Chinastrats",
                "Dropping Elephant",
                "Maha Grass",
                "Quilted Tiger",
                "TG-4410",
                "Thirsty Gemini",
                "Zinc Emerson"
            ],
            "source_name": "ETDA:Patchwork",
            "tools": [
                "AndroRAT",
                "Artra Downloader",
                "ArtraDownloader",
                "AutoIt backdoor",
                "BADNEWS",
                "BIRDDOG",
                "Bahamut",
                "Bozok",
                "Bozok RAT",
                "Brute Ratel",
                "Brute Ratel C4",
                "CinaRAT",
                "Crypta",
                "ForeIT",
                "JakyllHyde",
                "Loki",
                "Loki.Rat",
                "LokiBot",
                "LokiPWS",
                "NDiskMonitor",
                "Nadrac",
                "PGoShell",
                "PowerSploit",
                "PubFantacy",
                "Quasar RAT",
                "QuasarRAT",
                "Ragnatela",
                "Ragnatela RAT",
                "SocksBot",
                "TINYTYPHON",
                "Unknown Logger",
                "WSCSPL",
                "Yggdrasil"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9c884c88-2c9f-49c5-856a-2383ad1d8ef8",
            "created_at": "2024-05-01T02:03:08.152Z",
            "updated_at": "2025-03-27T02:05:17.422887Z",
            "deleted_at": null,
            "main_name": "ZINC EMERSON",
            "aliases": [
                "Dropping Elephant ",
                "EHDevel ",
                "Manul ",
                "Monsoon ",
                "Operation Hangover ",
                "Patchwork ",
                "TG-4410 ",
                "Viceroy Tiger ",
                "Confucius "
            ],
            "source_name": "Secureworks:ZINC EMERSON",
            "tools": [
                " Hanove",
                " Mac OS X KitM Spyware",
                " Proyecto2",
                " YTY Backdoor",
                "Enlighten Infostealer"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "56b3eb1d-6baf-4ee4-a098-ec0081280315",
            "created_at": "2024-09-28T02:05:36.599884Z",
            "updated_at": "2025-03-27T02:05:17.250078Z",
            "deleted_at": null,
            "main_name": "ALUMINUM THORN",
            "aliases": [
                "WIRTE ",
                "Frankenstein "
            ],
            "source_name": "Secureworks:ALUMINUM THORN",
            "tools": [
                " Powershell Empire",
                "FruityC2"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c81067e0-9dcb-4e3f-abb0-80126519c5b6",
            "created_at": "2022-10-25T15:50:23.285448Z",
            "updated_at": "2025-03-27T02:00:55.42906Z",
            "deleted_at": null,
            "main_name": "Patchwork",
            "aliases": [
                "Hangover Group",
                "Dropping Elephant",
                "Chinastrats",
                "Operation Hangover"
            ],
            "source_name": "MITRE:Patchwork",
            "tools": [
                "NDiskMonitor",
                "QuasarRAT",
                "BackConfig",
                "TINYTYPHON",
                "AutoIt backdoor",
                "PowerSploit",
                "BADNEWS",
                "Unknown Logger",
                "Socksbot"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d53593c3-2819-4af3-bf16-0c39edc64920",
            "created_at": "2022-10-27T08:27:13.212301Z",
            "updated_at": "2025-03-27T02:00:55.529662Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Earth Lusca",
                "TAG-22",
                "Charcoal Typhoon",
                "CHROMIUM",
                "ControlX"
            ],
            "source_name": "MITRE:Earth Lusca",
            "tools": [
                "Mimikatz",
                "PowerSploit",
                "Tasklist",
                "certutil",
                "Cobalt Strike",
                "Winnti for Linux",
                "Nltest",
                "NBTscan",
                "ShadowPad"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535990,
    "ts_updated_at": 1743041735,
    "ts_creation_date": 1653704517,
    "ts_modification_date": 1653704517,
    "files": {
        "pdf": "https://archive.orkl.eu/2db7f375edb812398a0514e17b8e27927b7c097b.pdf",
        "text": "https://archive.orkl.eu/2db7f375edb812398a0514e17b8e27927b7c097b.txt",
        "img": "https://archive.orkl.eu/2db7f375edb812398a0514e17b8e27927b7c097b.jpg"
    }
}