{
    "id": "80b0101d-b638-4f42-89dd-e056e0a9939d",
    "created_at": "2023-01-12T15:03:48.278216Z",
    "updated_at": "2025-03-27T02:05:35.6623Z",
    "deleted_at": null,
    "sha1_hash": "750fb3a2245833c6c91a80f07a113d4dfbb7bf77",
    "title": "2018-12-06 - DanaBot evolves beyond banking Trojan with new spam‑sending capability",
    "authors": "",
    "file_creation_date": "2022-05-28T18:06:42Z",
    "file_modification_date": "2022-05-28T18:06:42Z",
    "file_size": 403724,
    "plain_text": "# DanaBot evolves beyond banking Trojan with new spam‑sending capability\n\n**[welivesecurity.com/2018/12/06/danabot-evolves-beyond-banking-trojan-new-spam/](https://www.welivesecurity.com/2018/12/06/danabot-evolves-beyond-banking-trojan-new-spam/)**\n\nDecember 6, 2018\n\nESET research shows that DanaBot operators have been expanding the malware’s scope\nand possibly cooperating with another criminal group\n\n[ESET Research](https://www.welivesecurity.com/author/esetresearch/)\n6 Dec 2018 - 02:56PM\n\n\n-----\n\nESET research shows that DanaBot operators have been expanding the malware’s scope\nand possibly cooperating with another criminal group\n\nDanaBot appears to have outgrown the banking Trojan category. According to our research,\nits operators have recently been experimenting with cunning email-address-harvesting and\nspam-sending features, capable of misusing webmail accounts of existing victims for further\nmalware distribution.\n\nBesides the new features, we found indicators that DanaBot operators have been\ncooperating with the criminals behind GootKit, another advanced Trojan – behavior atypical\nof the otherwise independently operating groups.\n\n## Sending spam from victims’ mailboxes\n\nThe previously unreported features caught our attention when analyzing the webinjects\nused to target users of several Italian webmail services as part of DanaBot’s expansion in\nEurope in September 2018.\n\nAccording to our research, the JavaScript injected into the targeted webmail services’\npages can be broken down into two main features:\n\n1. DanaBot harvests email addresses from existing victims’ mailboxes. This is achieved\n\nby injecting a malicious script into each of the targeted webmail service’s webpages\nonce a victim logs in, processing the victim’s emails and sending all email addresses it\nfinds to a C&C server.\n\nFigure 1 – DanaBot harvesting email addresses\n\n1. If the targeted webmail service is based on the Open-Xchange suite – for example,\n\nthe popular Italian webmail service libero.it – DanaBot also injects a script that has the\nability to use the victim’s mailbox to covertly send spam to the harvested email\naddresses.\n\nThe malicious emails are sent as replies to actual emails found in the compromised\nmailboxes, making it seem as if the mailbox owners themselves are sending them. Further,\nmalicious emails sent from accounts configured to send signed messages will have valid\ndigital signatures.\n\n\n-----\n\nInterestingly, it seems that attackers are particularly interested in email addresses\n[containing the substring “pec”, which is found in Italy-specific “certified electronic mail”](http://www.registroimprese.it/en/indirizzo-pec)\naddresses. This may indicate that DanaBot authors are focused on targeting corporate and\npublic administration emails that are the most likely to use this certification service.\n\nThe emails include ZIP attachments, pre-downloaded from the attacker’s server, containing\na decoy PDF file and a malicious VBS file. Executing the VBS file leads to downloading\nfurther malware using a PowerShell command.\n\nFigure 2 – Code downloading malicious ZIP from C&C server\n\nFigure 3 – Code creating an email and adding a malicious ZIP attachment\n\nFigure 4 – Example of a spam email with a malicious ZIP attachment from a recent Italy-targeted\n\ncampaign (Sample source: VirusTotal)\n\n\n-----\n\nFigure 5 – Example of the ZIP attachment’s contents\n\nAt the time of writing, the malicious features described above are still limited to targeting\nItaly; the targeted services are listed at the end of this blog post.\n\n## Links between DanaBot and GootKit\n\nHaving analyzed the malicious VBS file available on DanaBot’s C&C server, we found that it\npoints to a downloader module for GootKit, an advanced and stealthy Trojan primarily used\nin banking fraud attacks. The malicious VBS file seems to be generated automatically, and\nis different on each access.\n\nThis is the first time we have seen indicators of DanaBot distributing other malware. Until\nnow, DanaBot has been believed to be operated by a single, closed group. The behavior is\n[also new for GootKit, which has been described as a privately held tool, not sold on](https://securityintelligence.com/gootkit-bobbing-and-weaving-to-avoid-prying-eyes/)\nunderground forums, and also operated by a closed group. Interestingly, we’ve recently\nseen another instance of GootKit being distributed by other malware – namely by the\nnotorious Emotet Trojan in its latest [campaigns around Black Friday and Cyber Monday.](https://www.welivesecurity.com/2018/11/23/black-friday-special-emotet-filling-inboxes-infected-xml-macros/)\n\nApart from the presence of GootKit on servers used by DanaBot, we have found further\nlinks suggesting a cooperation between the operators of DanaBot and GootKit.\n\nFirst, ESET’s telemetry was able to link GootKit activity to a C&C server subnet and toplevel domain (TLD) also used by DanaBot. DanaBot uses many IP addresses in the\n176.119.1.0/24 subnet for C&C and redirects (see IoCs). While DanaBot domain names\nchange every few days, .co is their most common TLD (for example\negnacios[.]co, kimshome[.]co, etc.). The GootKit samples downloaded by the malicious\npayload on DanaBot’s C&C had funetax[.]co and reltinks[.]co as their C&Cs. Both resolved\nto 176.119.1.175 for some time.\n\nSecond, both DanaBot and GootKit domains usually share the same domain registrar for\ntheir .co domains, namely Todaynic.com, Inc, and mostly share the same name server,\ndnspod.com.\n\n\n-----\n\nFinally, in the week starting Oct 29, 2018, ESET s telemetry showed a significant decrease\nin the distribution of DanaBot in Poland; in the same week, there was a spike of activity of\nGootKit in Poland. During the spike, GootKit was spread using the same distribution method\nas DanaBot in its recent Polish campaigns.\n\nFigure 6 – DanaBot and GootKit activity in Poland between October 8 and November 8, 2018\n\n## Similarity with other malware families\n\nWhile analyzing DanaBot, we also noticed that part of DanaBot’s configuration has a\nstructure we have previously seen in other malware families, for example Tinba or Zeus.\nThis allows its developers to use similar webinject scripts or even reuse third-party scripts.\n\nInterestingly, some scripts are almost exactly the same as the scripts we have seen used by\nthe [BackSwap trojan, including naming conventions and the location of the script on a](https://www.welivesecurity.com/2018/05/25/backswap-malware-empty-bank-accounts/)\nserver.\n\n\n-----\n\nFigure 7 – Comparison of scripts used by BackSwap (left) and DanaBot (right). Differences are\n\nmarked in orange\n\n## Conclusion\n\nOur research shows that DanaBot has a much broader scope than a typical banking Trojan,\nwith its operators regularly adding new features, testing new distribution vectors, and\npossibly cooperating with other cybercriminal gangs.\n\nESET systems detect and block both DanaBot and GootKit.\n\nHashes and ESET detection names of DanaBot components and plug-ins can be found in\nour [previous blogpost on DanaBot. Domains, IP addresses and hashes connected with the](https://www.welivesecurity.com/2018/09/21/danabot-targeting-europe-adds-new-features/)\nItaly-targeted campaign described in this blogpost can be found in the IoCs section.\n\n**_This research was carried out by Kaspars Osis, Tomáš Procházka and Michal Kolář._**\n\n### Webmail services targeted by email-address-harvesting feature\n\n[Any service based on Roundcube](https://roundcube.net/)\n[Any service based on Horde](https://www.horde.org/apps/webmail)\n[Any service based on Open-Xchange](https://www.open-xchange.com/)\naruba.it\nbluewin.ch\nemail.it\ngmx.net\nlibero.it\nmail.yahoo.com\nmail.google.com\nmail.one.com\noutlook.live.com\ntecnocasa.it\ntim.it\n\n\n-----\n\ntiscali.it\nvianova.it\n\n### Webmail services targeted by spam-sending feature\n\nAny service based on Open-Xchange\n\n## Indicators of Compromise (IoCs)\n\n### Domains used by the VBS file to download malware (GootKit at the time of writing)\n\njob.hitjob[.]it\nvps.hitjob[.]it\npph.picchio-intl[.]com\ndcc.fllimorettinilegnaegiardini[.]it\nicon.fllimorettinilegnaegiardini[.]it\nteam.hitweb[.]it\nlatest.hitweb[.]it\namd.cibariefoodconsulting[.]it\n\n### Example domains used by the GootKit downloader module\n\nvps.cibariefoodconsulting[.]it\nricci.bikescout24[.]fr\ndrk.fm604[.]com\ngtdspr[.]space\nit.sunballast[.]de\n\n### Active DanaBot C&C servers (as of December 6, 2018)\n\n5.8.55[.]205\n31.214.157[.]12\n47.74.130[.]165\n149.154.157[.]106\n176.119.1[.]99\n176.119.1[.]100\n176.119.1[.]120\n176.119.1[.]176\n176.223.133[.]15\n185.254.121[.]44\n188.68.208[.]77\n192.71.249[.]50\n\n\n-----\n\n### Example VBS file from a spam email\n\n**SHA-1** **ESET detection name**\n\nA05A71F11D84B75E8D33B06E9E1EBFE84FAE0C76 VBS/Kryptik.KY\n\n### Example of downloaded GootKit\n\n**SHA-1** **ESET detection name**\n\n0C2389B3E0A489C8E101FFD0E3E2F00E0C461B31 Win32/Kryptik.GNNS\n\n6 Dec 2018 - 02:56PM\n\n### Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n Newsletter\n\n Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-12-06 - DanaBot evolves beyond banking Trojan with new spam‑sending capability.pdf"
    ],
    "report_names": [
        "2018-12-06 - DanaBot evolves beyond banking Trojan with new spam‑sending capability.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535828,
    "ts_updated_at": 1743041135,
    "ts_creation_date": 1653761202,
    "ts_modification_date": 1653761202,
    "files": {
        "pdf": "https://archive.orkl.eu/750fb3a2245833c6c91a80f07a113d4dfbb7bf77.pdf",
        "text": "https://archive.orkl.eu/750fb3a2245833c6c91a80f07a113d4dfbb7bf77.txt",
        "img": "https://archive.orkl.eu/750fb3a2245833c6c91a80f07a113d4dfbb7bf77.jpg"
    }
}