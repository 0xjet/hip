{
    "id": "3db8d2cb-9fe5-470e-a25e-3adbe47827b4",
    "created_at": "2023-01-12T15:03:57.020813Z",
    "updated_at": "2025-03-27T02:16:25.710741Z",
    "deleted_at": null,
    "sha1_hash": "298dfb1be60ced9e68981e86c422bf84eb8aa5ae",
    "title": "2021-06-17 - Teabot - Android Banking Trojan Targets Banks in Europe",
    "authors": "",
    "file_creation_date": "2022-05-28T18:59:34Z",
    "file_modification_date": "2022-05-28T18:59:34Z",
    "file_size": 1989024,
    "plain_text": "# Teabot : Android Banking Trojan Targets Banks in Europe\n\n**labs.k7computing.com/**\n\nBy Baran S June 17, 2021\n\nThe Teabot (aka ‘Anatsa’) is a new Android Banking Trojan with an array of malicious\nfeatures that aid in the tracking of a victim’s financial activities and spreading to more\nvictims. It is reported to have been first noticed at the beginning of this year, purportedly\ntargeting a handful of European banks and few languages. Some of the malicious features\ninclude Key logging, Disabling Google Play Protect, Overlay attack and controlling the\nSMS.\n\nThe main infection vector of Teabot, used by the threat actors is Smishing campaigns,\nwhere the victims are persuaded to download and install the distributed malicious\napplication. Teabot masquerades as media, postal and logistics service apps like\nBookReader, PlutoTV, TeaTV, VLC Media Player, Correos, DHL and UPS.\n\nFigure 1: Masquerades as media, postal and logistic apps\nIn this blog, we will be analyzing a sample “Snake.Sound.Mouse” which masquerades as a\nVLC media player as shown in Figure 2.\n\n\n-----\n\nFigure 2: Malicious APK\n\nmasquerade as VLC media player\nOnce Teabot malware is installed on the device, it frequently brings up the Accessibility\n_Service setting option on the device, as shown in Figure 3, until the user allows this app to_\nhave the Accessibility Service enabled. This app stays stealth by hiding its icon from the\napplication drawer after its first launch. Also, threat actors here use\nMediaProjectionManager API to obtain a live streaming of the device screen on-demand\nand also interact with it via Accessibility Services.\n\n\n-----\n\nFigure 3: Request for accessibility service\n\n### Analyzing the Payload\n\nOnce the permissions are granted, this malicious apk decrypts the malicious payload file\ncalled kbu.json from the app’s assets folder to an executable dex format named\n‘kbu.odex’ and loads the decrypted file as shown in Figure 4.\n\nFigure 4: The logcat image shows the kbu.odex file execution at runtime\nTeabot is currently targeting 6 different languages “Spanish, English, German, Italian,\nDutch and French” as shown in Figure 5.\n\nFigure 5: Targeted Languages\n\n\n-----\n\nThe Trojan attempts to intercept SMS messages and aborts the new SMSReceived\nbroadcast to the victim; as per the bot command “logged_sms” as shown in Figure 6.\n\nFigure 6: Intercept SMS Messages\nAbusing the Android Accessibility Service, this Trojan acts as a keylogger to steal all the\nvictim’s information on the device.\n\nFigure 7: Keyloggers Function\n\n### C2 Communication\n\nTeabot enumerates all the installed applications on the victim’s device and then sends the\nlist of installed apps from the victim’s device to the C2 server during its first\ncommunication. All the communications between C2 and the malware remain encrypted\nusing an XOR key  as shown in Figure 8. When one or more targeted apps are found, the\nmalware C2 sends the specific payload(s) to the victim device to perform an overlay attack\nand track all the activity related to the identified targeted application(s).\n\n\n-----\n\nFigure 8: List of installed apps sent encrypted by the malware and the decrypted data\nThe following are the targeted applications expected to be installed in the victim’s device:\n\n\n-----\n\nFigure 9: Targeted Banks\n\n\n-----\n\nThis malware also terminates the predefined list of apps process(es), as shown in Figure\n10 and Figure 11. Interestingly, that list includes a few popular security products as\nhighlighted below, in order to remain undetected.\n\nFigure 10: Terminates the predefined apps process\n\n\n-----\n\nFigure 11: Apps list terminated\n\n\n-----\n\nFigure 12: Security related Apps List\n\n### List of few bot commands observed\n\nFigure 13: List of\n\nbot commands\nAt K7, we protect all our customers from such threats. Do ensure that you protect your\nmobile devices with a reputable security product like K7 Mobile Security and also regularly\nupdate and scan your devices with it. Keep your security product and devices updated and\npatched for the latest vulnerabilities.\n\n## Indicators of Compromise (IoCs)\n\n**Package Name** **Hash** **K7 Detection Name**\n\n\n-----\n\nfoot.seminar.when 8e82d870605d97db3a7e348cb6ca61c4 Trojan ( 0055efb31 )\n\nsteak.into.fine 332d407d2f690fb54546ff7f15ce7755 Trojan ( 0055efb31 )\n\nsafe.enable.tooth 112fc4be91ef529db595c9cdc40fdc82 Trojan ( 0055efb31 )\n\nsnake.sound.mouse a8ded94ee515bf0d8dbdead6d25f9ec0 Trojan ( 00573cb31 )\n\nquestion.cancel.cradle c20c6cd13bd8b5ccaca9e212635f7057 Trojan ( 0055e0a41 )\n\ntrust.royal.vibrant 4642c7a56039a82d8268282802c2fee9 Trojan ( 0055e0a41 )\n\n### C2\n\nhxxp://185.215.113[.31:80/api/\n\nhxxp://178.32.130[.170:80/api/\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-06-17 - Teabot - Android Banking Trojan Targets Banks in Europe.pdf"
    ],
    "report_names": [
        "2021-06-17 - Teabot - Android Banking Trojan Targets Banks in Europe.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535837,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1653764374,
    "ts_modification_date": 1653764374,
    "files": {
        "pdf": "https://archive.orkl.eu/298dfb1be60ced9e68981e86c422bf84eb8aa5ae.pdf",
        "text": "https://archive.orkl.eu/298dfb1be60ced9e68981e86c422bf84eb8aa5ae.txt",
        "img": "https://archive.orkl.eu/298dfb1be60ced9e68981e86c422bf84eb8aa5ae.jpg"
    }
}