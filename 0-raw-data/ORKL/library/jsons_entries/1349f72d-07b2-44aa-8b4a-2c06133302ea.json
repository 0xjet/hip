{
    "id": "1349f72d-07b2-44aa-8b4a-2c06133302ea",
    "created_at": "2023-01-12T15:10:01.397794Z",
    "updated_at": "2025-03-27T02:09:30.1412Z",
    "deleted_at": null,
    "sha1_hash": "f85a2f59f122977b11f7993c12c7c444ca15e73f",
    "title": "2011-03-11 - Trojan.Koredos Comes with an Unwelcomed Surprise",
    "authors": "",
    "file_creation_date": "2022-05-28T03:11:17Z",
    "file_modification_date": "2022-05-28T03:11:17Z",
    "file_size": 75583,
    "plain_text": "# Endpoint Protection\n\n**[symantec.com/connect/blogs/trojankoredos-comes-unwelcomed-surprise](https://www.symantec.com/connect/blogs/trojankoredos-comes-unwelcomed-surprise)**\n\nBack to Library\n\n## Trojan.Koredos Comes with an Unwelcomed Surprise\n\n1 Recommend\n\nMar 11, 2011 07:13 AM\n\n\n[Shunichi Imano](https://community.broadcom.com/symantecenterprise/network/members/profile?UserKey=1847dbd5-662f-4bef-a59b-d3a3d923a515)\n\nRecent Distributed Denial of Service (DDoS) attacks on a number South Korean websites\nhave been in news for the past week. The threat responsible for carrying out these attacks\n[is Trojan.Koredos.](http://www.symantec.com/security_response/writeup.jsp?docid=2011-030417-4602-99)\n\nThis attack is [reminiscent of another attack, launched on July 4th, 2009 against the U.S.](https://community.broadcom.com/symantecenterprise/viewdocument?DocumentKey=d5fc6afb-02e8-423f-8feb-f77c68ec7c8a&CommunityKey=1ecf5f55-9545-44d6-b0f4-4e4a7f5f5e68&tab=librarydocuments)\nand South Korean governments, as well as financial and media websites. For now, the\nattack has subsided and the affected sites can be accessed without any issues. However,\nthe computers have not been cleaned for the Trojan.Koredos infection will be greeted with\na surprise well after the initial infection, which we will detail in this blog.\n\nAttacks such as this usually involve a command and control (C&C) server that sends\ncommands to the compromised computers, resulting in systematic and coordinated\nattacks. In this case, the commands do not come from a C&C—they are hidden inside the\nthreat.\n\nThere are many components involved in the attack, and that alone indicates some level of\nsophistication. Of those files, the destructive behavior is carried out by the s[RANDOM\nLETTERS]svc.dll file. While we have seen several variants of this .dll, the end result is the\nsame—the master boot record (MBR) of the compromised computer is destroyed.\n\n\n-----\n\nSome variants scan the fixed drives of compromised computers for files with various\nextensions, which are used by software predominantly used in Korea (i.e. .alz, .gul, and\n.hwp). This strongly suggests the threat targets computers located in Korea.\n\n_[Figure 1 – Heatmap showing Trojan.Koredos infections.]_\n\n_[Figure 2 – The threat searching for file extensions.]_\n\nThe threat overwrites the files with all zeros. Additionally, if the file size is larger than or\nequal to 10,485,760 bytes, the threat simply deletes the files. If a file does not meet the\nprevious condition, the threat creates a .cab file using the original file name, and deletes\nthe original file. In other cases deleted files can be restored using various methods, but\nsince the threat overwrites the files with zeros, the original file cannot be restored.\n\nThe threat destroys the MBR of all drives if one of the following conditions is met:\n\nThe %System%\\noise03.dat file is missing. The noise3.dat file is a part of\nTrojan.Koredos that contains a number 7 within it. This is the number of days the\ndestruction functionality gets triggered. One interesting part is that the number can\nbe overwritten, though the threat can only distinguish up to 10. (Any number over 10\nwill be interpreted as 7.) This means the maximum life of the compromised computer\nis 10 days.\n\n_[Figure 3 – Creating the noise03.dat file with the date and time of infection and days]_\n_to attack._\n\nA %System%\\dnsec.dat file exists, and its first four bytes are all zero. The dnsec.dat\nfile is also a component of W32.Koredos that works with other threat components.\n\n_[Figure 4 – Overwriting files with zeros and checking that the file size is greater than]_\n_10,485,760 bytes._\n\nThe current date and time is later than 7 days, or equal to the number in\n%SYSTEM%\\noise03.dat at the time of first infection.\n\nThe current date and time is equal to or longer than 7 to 10 days after first infection.\nAs explained previously, the number can manually overwritten in the\n%System%\\noise03.dat file, but the operating system will be destroyed.\n\n_[Figure 5 – Checking that 7 to 10 days have passed.]_\n\nIn short, the infected computers can live up to 10 days if they are not cleaned. Symantec\nprovides protection against the threat. Please make sure you keep virus definitions up-todate to keep your valuable data safe from the destructive threat.\n\n\n-----\n\n_Thanks to Masaki Suenaga for his contributions to this blog._\n\nStatistics\n\n0 Favorited\n\n0 Views\n\n0 Files\n\n0 Shares\n\n0 Downloads\n\n## Tags and Keywords\n\n Related Entries and Links\n\nNo Related Resource entered.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2011/2011-03-11 - Trojan.Koredos Comes with an Unwelcomed Surprise.pdf"
    ],
    "report_names": [
        "2011-03-11 - Trojan.Koredos Comes with an Unwelcomed Surprise.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536201,
    "ts_updated_at": 1743041370,
    "ts_creation_date": 1653707477,
    "ts_modification_date": 1653707477,
    "files": {
        "pdf": "https://archive.orkl.eu/f85a2f59f122977b11f7993c12c7c444ca15e73f.pdf",
        "text": "https://archive.orkl.eu/f85a2f59f122977b11f7993c12c7c444ca15e73f.txt",
        "img": "https://archive.orkl.eu/f85a2f59f122977b11f7993c12c7c444ca15e73f.jpg"
    }
}