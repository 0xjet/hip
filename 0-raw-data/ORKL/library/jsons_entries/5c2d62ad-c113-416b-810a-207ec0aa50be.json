{
    "id": "5c2d62ad-c113-416b-810a-207ec0aa50be",
    "created_at": "2023-01-12T14:59:54.517032Z",
    "updated_at": "2025-03-27T02:05:53.160599Z",
    "deleted_at": null,
    "sha1_hash": "143e385db372ace17503b1c7c6fc6ad1b15e1c7b",
    "title": "2018-06-07 - New KillDisk Variant Hits Latin American Financial Organizations Again",
    "authors": "",
    "file_creation_date": "2022-05-28T15:56:48Z",
    "file_modification_date": "2022-05-28T15:56:48Z",
    "file_size": 159217,
    "plain_text": "# KillDisk Variant Hits Latin American Finance Industry\n\n**blog.trendmicro.com/trendlabs-security-intelligence/new-killdisk-variant-hits-latin-american-financial-organizations-**\nagain/\n\nJune 7, 2018\n\nIn January, we saw a [variant of the disk-wiping KillDisk malware hitting several financial](https://blog.trendmicro.com/en_us/research/18/a/new-killdisk-variant-hits-financial-organizations-in-latin-america.html)\n[institutions in Latin America. One of these attacks was related to a foiled heist on the](https://www.bloomberg.com/news/articles/2018-05-29/mexico-foiled-a-110-million-bank-heist-then-kept-it-a-secret)\norganization’s system connected to the Society for Worldwide Interbank Financial\nTelecommunication’s (SWIFT) network.\n\nLast May, we uncovered a master boot record (MBR)-wiping malware in the same region.\nOne of the affected organizations was a bank whose systems were rendered inoperable for\nseveral days, thereby disrupting operations for almost a week and limiting services to\ncustomers. Our analysis indicates that the attack was used only as a distraction — the end\ngoal was to access the systems connected to the bank’s local SWIFT network.\n\nThe telltale sign was a problem related to the affected machine’s boot sector. Based on the\nerror message it displayed after our tests, we were able to ascertain that this was another —\npossibly new — variant of KillDisk. This kind of notification is common in systems affected by\n[MBR-wiping threats and not in other malware types such as ransomware, which some](https://www.trendmicro.com/vinfo/tmr/?/us/security/definition/ransomware)\npeople initially believed to be the culprit. Trend Micro products detect this threat as\n[TROJ_KILLMBR.EE and](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/TROJ_KILLMBR.EE) [TROJ_KILLDISK.IUE.](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/TROJ_KILLDISK.IUE)\n\n\n-----\n\nThe nature of this payload alone makes it difficult to determine if the attack was motivated by\nan opportunistic cybercriminal campaign or part of a coordinated attack like the previous\nattacks we observed last January.\n\n_Figure 1. Error screen after the boot sector is overwritten_\n\n**Initial analysis**\n\nWe were able to source a sample that may be the malware involved in the May 2018 attacks.\nWe ran it, and it broke the boot sector as expected (see Figure 1). An initial analysis of the\n[file revealed it was created using Nullsoft Scriptable Install System (NSIS), an open-source](http://nsis.sourceforge.net/License)\napplication used to create setup programs. The actor behind this threat used the application\n[and purposely named it “MBR Killer.” Although the sample was protected by VMProtect (a](http://vmpsoft.com/)\nvirtualization protector used to defend against reverse engineering), we were still able to\nverify that it has a routine that wipes the first sector of the machine’s physical disk, as shown\nin Figure 2. We haven’t found any other new or notable routines in the sample we have.\nThere is no evident command-and-control (C&C) infrastructure or communication, or\nransomware-like routines coded into the sample. There are no indications of network-related\nbehavior in this malware.\n\n_Figure 2. The malware named “MBR Killer” (highlighted, top) and a code snippet showing_\n_its routine of wiping the disk’s first sector (bottom)_\n\n_Figure 3. How the malware carries out its MBR-wiping routine_\n\n**How the malware wipes the affected machine’s disk**\n\nThe malware was designed to wipe all the physical hard disks it can find in the infected\nsystem. Here’s a summary of how it performs its MBR-wiping routine:\n\n1. It uses the application programming interface (API) CreateFileA to\n\n_\\\\.\\PHYSICALDRIVE0 to retrieve the handle of the hard disk._\n2. It overwrites the first sector of the disk (512 bytes) with \"0x00\". The first sector is the\n\ndisk’s MBR.\n3. It will try to perform the routines above (steps 1-2) on \\\\.\\PHYSICALDRIVE1,\n\n_\\\\.\\PHYSICALDRIVE2, \\\\.\\PHYSICALDRIVE3, and so on, as long as a hard disk is_\navailable.\n4. It will then force the machine to shut down via the API ExitWindows.\n\nWhen calling the APIs, the main executable will drop the component file %User Temp%/ns{5\n_random characters}.tmp/System.dll. The main executable will then load the dynamic-link_\nlibrary (DLL) file, which has the export function “Call” used to call for the APIs.\n\n**Mitigation and best practices**\n\n\n-----\n\nThe destructive capabilities of this malware, which can render the affected machine\ninoperable, underscore the significance of defense in depth: arraying security to cover each\nlayer of the organization’s IT infrastructure, from [gateways and](https://blog.trendmicro.com/en_us/business/products/user-protection/sps.html) [endpoints to](https://blog.trendmicro.com/en_us/business/products/user-protection/sps/endpoint.html) [networks and](https://blog.trendmicro.com/en_us/business/products/network.html)\n[servers. Here are some best practices that organizations can adopt to defend against this](https://blog.trendmicro.com/en_us/business/products/hybrid-cloud/deep-security-data-center.html)\nkind of threat:\n\n**_Identify and address security gaps. Regularly patch and update networks, systems,_**\nand programs/applications to remove exploitable vulnerabilities. Create strict patch\n[management policies and consider virtual patching, especially for legacy systems.](https://blog.trendmicro.com/en_us/business/capabilities/intrusion-prevention.html?cm_re=10_19_17-_-2d_Capabilities-_-IntrusionPrevention)\n[Regularly back up data and safeguard its integrity.](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/virtualization-and-cloud/best-practices-backing-up-data)\n**_Secure mission-critical infrastructure. Secure the infrastructure used to store and_**\nmanage personal and corporate data. For financial institutions, SWIFT has a Customer\n[Security Programme that provides mandatory and advisory controls for their local](https://www.swift.com/myswift/customer-security-programme-csp/security-controls)\n[SWIFT infrastructure. Some of these include virtual patching, vulnerability scanning,](https://blog.trendmicro.com/en_us/business/capabilities/intrusion-prevention.html?cm_re=10_19_17-_-2d_Capabilities-_-IntrusionPrevention)\n[application control, and](https://blog.trendmicro.com/en_us/business/capabilities/application-control-capability.html) [integrity monitoring of SWIFT-related applications.](https://blog.trendmicro.com/en_us/business/capabilities/integrity-monitoring.html)\n**_Enforce the principle of least privilege. Restrict access to mission-critical data._**\n[Network segmentation limits user or program access to the network; data](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cyber-attacks/protecting-data-through-network-segmentation)\ncategorization organizes data by importance to minimize further exposure to threats or\nbreaches. [Restrict access to and use of tools reserved for system administrators (for](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cybercrime-and-digital-threats/best-practices-securing-sysadmin-tools)\nexample, [PowerShell,](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/security-technology/security-101-the-rise-of-fileless-threats-that-abuse-powershell) [command-line tools) to prevent them from being abused. Disable](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/security-technology/2017-notably-abused-system-administration-tools-and-protocols)\noutdated and unneeded system or application components.\n**_Proactively monitor online premises. Deploy additional security mechanisms to_**\nfurther hinder attackers. [Firewalls and](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/security-technology/best-practices-deploying-an-effective-firewall) [intrusion detection and prevention systems help](https://blog.trendmicro.com/en_us/business/products/network/intrusion-prevention.html)\nagainst network-based attacks, while application control and behavior monitoring\nprevent the execution of suspicious and unwanted files or malicious routines. URL\ncategorization also helps prevent access to malware-hosting sites.\n**_Foster a culture of cybersecurity. Many threats rely on social engineering to_**\nsucceed. Awareness of the telltale signs of spam and phishing emails, for instance,\n[significantly helps thwart email-based threats.](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cybercrime-and-digital-threats/infosec-guide-email-threats)\n**_Create a proactive incident response strategy. Complement defensive measures_**\nwith [incident response strategies that provide actionable threat intelligence and insights](https://www.trendmicro.com/vinfo/tmr/?/us/security/definition/managed-detection-and-response)\nto help IT and information security teams actively hunt for, detect, analyze, correlate,\nand respond to threats.\n\n**Trend Micro Solutions**\n\n[Trend Micro™ XGen™ security provides a cross-generational blend of threat defense](https://blog.trendmicro.com/en_us/business/products/all-solutions.html)\n[techniques against a full range of threats for data centers,](https://blog.trendmicro.com/en_us/business/products/hybrid-cloud/deep-security.html) [cloud environments,](https://blog.trendmicro.com/en_us/business/products/hybrid-cloud.html) [networks,](https://blog.trendmicro.com/en_us/business/products/network.html)\n[and endpoints. It features high-fidelity machine learning to secure](https://blog.trendmicro.com/en_us/business/products/user-protection.html)\nthe [gateway and](https://blog.trendmicro.com/en_us/business/products/user-protection/sps.html) [endpoint data and applications and protects physical, virtual, and cloud](https://blog.trendmicro.com/en_us/business/products/user-protection/sps/endpoint.html)\nworkloads. With capabilities like web/URL filtering, behavioral analysis, and custom\nsandboxing, XGen protects against today’s purpose-built threats that bypass traditional\n\n\n-----\n\n[controls and exploit known, unknown, or undisclosed vulnerabilities. Smart, optimized, and](https://blog.trendmicro.com/en_us/business/products/user-protection/sps.html)\nconnected, XGen powers Trend Micro’s suite of security solutions: Hybrid Cloud Security,\nUser Protection, and Network Defense.\n\n**Indicators of Compromise (IOCs)**\n\n**_Related Hashes (SHA-256):_**\n\na3f2c60aa5af9d903a31ec3c1d02eeeb895c02fcf3094a049a3bdf3aa3d714c8 —\n[TROJ_KILLMBR.EE](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/TROJ_KILLMBR.EE)\n1a09b182c63207aa6988b064ec0ee811c173724c33cf6dfe36437427a5c23446 —\n[TROJ_KILLDISK.IUE](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/TROJ_KILLDISK.IUE)\n\nMalware\n\nIn January, we saw a variant of the disk-wiping KillDisk malware hitting several financial\ninstitutions in Latin America. Last May, we uncovered a master boot record (MBR)-wiping\nmalware in the same region.\n\nBy: Fernando Merces, Byron Gelera, Martin Co June 07, 2018 Read time: ( words)\n\nContent added to Folio\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-06-07 - New KillDisk Variant Hits Latin American Financial Organizations Again.pdf"
    ],
    "report_names": [
        "2018-06-07 - New KillDisk Variant Hits Latin American Financial Organizations Again.pdf"
    ],
    "threat_actors": [
        {
            "id": "5a0483f5-09b3-4673-bb5a-56d41eaf91ed",
            "created_at": "2023-01-06T13:46:38.814104Z",
            "updated_at": "2025-03-27T02:00:02.925972Z",
            "deleted_at": null,
            "main_name": "MageCart",
            "aliases": [],
            "source_name": "MISPGALAXY:MageCart",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ee3363a4-e807-4f95-97d8-b603c31b9de1",
            "created_at": "2023-01-06T13:46:38.485884Z",
            "updated_at": "2025-03-27T02:00:02.845851Z",
            "deleted_at": null,
            "main_name": "FIN6",
            "aliases": [
                "Camouflage Tempest",
                "MageCart Group 6",
                "G0037",
                "TA4557",
                "SKELETON SPIDER",
                "ITG08",
                "White Giant",
                "GOLD FRANKLIN",
                "ATK88"
            ],
            "source_name": "MISPGALAXY:FIN6",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "12517c87-040a-4627-a3df-86ca95e5c13f",
            "created_at": "2022-10-25T16:07:23.61665Z",
            "updated_at": "2025-03-27T02:02:09.889471Z",
            "deleted_at": null,
            "main_name": "FIN6",
            "aliases": [
                "ATK 88",
                "Camouflage Tempest",
                "FIN6",
                "Gold Franklin",
                "ITG08",
                "Skeleton Spider",
                "TAAL",
                "TAG-CR2",
                "White Giant"
            ],
            "source_name": "ETDA:FIN6",
            "tools": [
                "AbaddonPOS",
                "Agentemis",
                "AmmyyRAT",
                "Anchor_DNS",
                "BlackPOS",
                "CmdSQL",
                "Cobalt Strike",
                "CobaltStrike",
                "FlawedAmmyy",
                "FrameworkPOS",
                "Grateful POS",
                "JSPSPY",
                "Kaptoxa",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LockerGoga",
                "MMon",
                "Magecart",
                "Meterpreter",
                "Mimikatz",
                "More_eggs",
                "NeverQuest",
                "POSWDS",
                "Reedum",
                "Ryuk",
                "SCRAPMINT",
                "SONE",
                "SpicyOmelette",
                "StealerOne",
                "Taurus Loader Stealer Module",
                "Terra Loader",
                "TerraStealer",
                "Vawtrak",
                "WCE",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "cobeacon",
                "grabnew"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "ea7bfe06-7c23-481d-b8ba-eafa6cda3bc9",
            "created_at": "2022-10-25T15:50:23.317961Z",
            "updated_at": "2025-03-27T02:00:55.440858Z",
            "deleted_at": null,
            "main_name": "FIN6",
            "aliases": [
                "FIN6",
                "Magecart Group 6",
                "ITG08",
                "Skeleton Spider",
                "TAAL",
                "Camouflage Tempest"
            ],
            "source_name": "MITRE:FIN6",
            "tools": [
                "FlawedAmmyy",
                "GrimAgent",
                "FrameworkPOS",
                "More_eggs",
                "Cobalt Strike",
                "Windows Credential Editor",
                "AdFind",
                "PsExec",
                "LockerGoga",
                "Ryuk",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535594,
    "ts_updated_at": 1743041153,
    "ts_creation_date": 1653753408,
    "ts_modification_date": 1653753408,
    "files": {
        "pdf": "https://archive.orkl.eu/143e385db372ace17503b1c7c6fc6ad1b15e1c7b.pdf",
        "text": "https://archive.orkl.eu/143e385db372ace17503b1c7c6fc6ad1b15e1c7b.txt",
        "img": "https://archive.orkl.eu/143e385db372ace17503b1c7c6fc6ad1b15e1c7b.jpg"
    }
}