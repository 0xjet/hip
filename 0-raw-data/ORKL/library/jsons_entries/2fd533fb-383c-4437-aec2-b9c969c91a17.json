{
    "id": "2fd533fb-383c-4437-aec2-b9c969c91a17",
    "created_at": "2023-01-12T15:09:23.597798Z",
    "updated_at": "2025-03-27T02:17:01.058154Z",
    "deleted_at": null,
    "sha1_hash": "5d5f2ab93acbd96631e9a6762effdcacbf94272c",
    "title": "2021-12-21 - The Continued Evolution of Abcbot",
    "authors": "",
    "file_creation_date": "2022-05-28T16:16:14Z",
    "file_modification_date": "2022-05-28T16:16:14Z",
    "file_size": 1950642,
    "plain_text": "# The Continued Evolution of Abcbot\n\n**cadosecurity.com/the-continued-evolution-of-abcbot/**\n\nBlog\n\nDecember 21, 2021\n\n\nDecember 21, 2021\n\n\nA new version of a malicious shell script targeting insecure cloud instances running under\nCloud Service Providers such as Tencent, Baidu and Alibaba Cloud has recently been\ndiscovered. The shell script prepares the target host for additional compromise over SSH,\nkills off processes from competing threat actors and persists itself, before downloading an\nadditional ELF executable used to connect to a botnet as part of a campaign dubbed by\n[360Netlab as “Abcbot”.](https://blog.netlab.360.com/abcbot_an_evolving_botnet_en/)\n\nAbcot analysed in Cado Response\n\nBased on function names and other similarities within the code, we believe this shell script is\nan updated version of an installer used in the Abcbot campaign. An earlier version was\n[originally discovered by Trend Micro and this sample is similar to the one analysed in their](https://www.trendmicro.com/zh_hk/research/21/j/actors-target-huawei-cloud-using-upgraded-linux-malware-.html)\nreport, with some notable differences.\n\n**Malware Analysis**\n\nUpon execution the shell script calls a number of functions sequentially, the first of which is\nnamed nameservercheck. This function disables SELinux protections, weakening the host\nmachine. It also ensures network connectivity by inserting IPs for Google’s public DNS\n\n\n-----\n\nservers (8.8.8.8 & 8.8.4.4) into the /etc/resolv.conf file (if they don t exist). Perhaps more\ninterestingly, data transfer utilities such as curl and wget are renamed. This includes two with\nthe paths /usr/bin/wgettnt and /usr/bin/curltnt.\n\nGiven the prevalence of the TeamTNT threat actor, it seems reasonable that the naming\nconvention here is a reference to them. As we’ll discuss later, it’s clear from this shell script\nthat whoever is behind Abcbot has an awareness of other threat actors working in this area.\n\nIn contrast to earlier variants of this sample, the Tor proxy service is no longer installed on\nthe host machine. The code for the installation remains but is commented-out, as can be\nseen below.\n\nTrend Micro mention that Tor is used by additional payloads to anonymise malicious network\nconnections made by the malware. Updates to the payloads themselves could mean they no\nlonger require this.\n\n**Killing Competitors**\n\nWhat’s evident from analysis of this shell script is that the threat actor behind Abcbot is\nheavily invested in keeping their knowledge of the cloud security threat landscape current. A\nfunction named kill_miner_proc, which consists of several hundred lines, is dedicated to\nremoving artifacts of crypto mining and cloud-focused malware from the host machine. In it\nwe can see evidence of searching for processes belonging to prominent Linux malware,\nsuch as WatchDog and Kinsing, along with generic mining software often used in cryptojacking campaigns.\n\n\n-----\n\nSimilarly, the malware searches for Docker images and instances used for crypto mining and\nremoves/kills them as appropriate.\n\nOther notable functionality within kill_miner_proc includes the ability to disable and uninstall\ncloud monitoring solutions found in smaller CSPs, such as the Aliyun Alibaba Cloud\nAssistant and Tencent’s monitoring service. This is likely used to avoid detection by such\nproducts during the malware’s execution and suggests targeting of specific CSPs by the\nthreat actor.\n\n\n-----\n\n**Maintaining Access**\n\nAfter initial configuration the malware establishes persistence via rc.local and cron, methods\ncommon to UNIX and UNIX-like systems. A command to download a copy of the shell script\nis added to the /etc/rc.d/rc.local file, which ensures that the file is downloaded and executed\nin the background on each boot.\n\n\n-----\n\nA similar approach is used to establish persistence via cron. The script cycles through\ncommands, attempting to download and execute the copy of itself via curl, cdt, wget and wdt\nat a frequency of 31, 32, 33 and 35 minutes respectively.\n\nAfter both methods of persistence are established, the sample proceeds to configure the\nLinux iptables firewall via the iptables command. We can observe the iteration of this sample\nin the function responsible for the iptables setup, as the author has again left some code\ncommented-out.\n\n**Network Access**\n\nPreviously, it appears that those behind abcbot attempted to configure the iptables firewall to\naccept ingress traffic from the IP address 64[.]225[.]46[.]44/32. They also appear to have, at\none point, added a rule to drop ingress traffic from ports associated with the Docker API\n(2375/2376). These rules are no longer added to iptables if they are not already present.\nInstead, the malware adds a more generic rule, to allow all ingress traffic on TCP port 26800.\nThis differs from the sample analysed by Trend Micro and likely facilitates communication\nwith a C2 server, as the IP addresses hosting additional payloads also use this port.\n\n\n-----\n\nAside from this, the shell script exhibits similar functionality seen in previous versions, with\nthe threat actor removing SSH keys left by similar attacks and inserting their own to\nguarantee access to the host. The sample also downloads one of the additional ELF binary\npayloads observed by Trend Micro and saves it as “abchello”. However, the code used to\ndownload the third payload appears to be commented-out.\n\nFinally, if a SSH known_hosts file and corresponding public key exists in the root user’s .ssh\ndirectory, the script iterates through the known hosts, connecting to each one in turn and\ninstalling a copy of itself using the data transfer tools mentioned previously. This allows\npropagation of the malware in a worm-like fashion and ensures rapid compromise of related\nhosts.\n\n\n-----\n\n**Detections**\n\nCado Response detects this threat as abcbot_installer.\n\n**Indicators of Compromise**\n\n**Filename** **SHA256**\n\nff.sh 56d677ed192b5010aa780d09c23b8ee8fdff94d39b20a07c7de76705e5f8c51f\n\n\n-----\n\nnewabchello 22b521f8d605635e1082f3f33a993979c37470fe2980956064aa4917ea1b28d5\n\n**IP Addresses/URLs**\n\nhttp://103[.]209[.]103[.]16:26800/ff.sh\n\nhttp://103[.]209[.]103[.]16:26800/xlinux\n\n**References**\n\nhttps://www.trendmicro.com/zh_hk/research/21/j/actors-target-huawei-cloud-using-upgradedlinux-malware-.html\n\n[https://blog.netlab.360.com/abcbot_an_evolving_botnet_en/](https://blog.netlab.360.com/abcbot_an_evolving_botnet_en/)\n\nFor guidance on performing cloud IR, check out our playbooks: The Ultimate Guide to\nRansomware Incident Response & Forensics and The Ultimate Guide to Docker &\nKubernetes Forensics & Incident Response\n\nAbout The Author\n\nMatt Muir\n\nMatt is a security researcher with a passion for UNIX and UNIX-like operating systems. He\npreviously worked as a macOS malware analyst and his background includes experience in\nthe areas of digital forensics, DevOps, and operational cyber security. Matt enjoys technical\nwriting and has published research including pieces on TOR browser forensics, an emerging\ncloud-focused botnet, and the exploitation of the Log4Shell vulnerability.\n\n**About Cado Security**\n\nCado Security provides the cloud investigation platform that empowers security teams to\nrespond to threats at cloud speed. By automating data capture and processing across cloud\nand container environments, Cado Response effortlessly delivers forensic-level detail and\nunprecedented context to simplify cloud investigation and response. Backed by Blossom\n\n\n-----\n\nCapital and Ten Eleven Ventures, Cado Security has offices in the United States and United\n[Kingdom. For more information, please visit https://www.cadosecurity.com/ or follow us on](https://www.cadosecurity.com/)\nTwitter [@cadosecurity.](https://twitter.com/CadoSecurity)\n\n[Prev Post](https://www.cadosecurity.com/analysis-of-novel-khonsari-ransomware-deployed-by-the-log4shell-vulnerability/) [Next Post](https://www.cadosecurity.com/our-take-four-cloud-security-predictions-for-2022/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-12-21 - The Continued Evolution of Abcbot.pdf"
    ],
    "report_names": [
        "2021-12-21 - The Continued Evolution of Abcbot.pdf"
    ],
    "threat_actors": [
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f809bfcb-b200-4988-80a8-be78ef6a52ef",
            "created_at": "2023-01-06T13:46:39.186988Z",
            "updated_at": "2025-03-27T02:00:03.016358Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "Adept Libra"
            ],
            "source_name": "MISPGALAXY:TeamTNT",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c3ca592f-0669-49bd-ab5c-310007ab2fb4",
            "created_at": "2022-10-25T15:50:23.334495Z",
            "updated_at": "2025-03-27T02:00:55.445098Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "TeamTNT"
            ],
            "source_name": "MITRE:TeamTNT",
            "tools": [
                "Peirates",
                "MimiPenguin",
                "LaZagne",
                "Hildegard"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3fff98c9-ad02-401d-9d4b-f78b5b634f31",
            "created_at": "2023-01-06T13:46:38.376868Z",
            "updated_at": "2025-03-27T02:00:02.818071Z",
            "deleted_at": null,
            "main_name": "Cleaver",
            "aliases": [
                "Cobalt Gypsy",
                "G0003",
                "Operation Cleaver",
                "Op Cleaver",
                "Tarh Andishan",
                "Alibaba",
                "TG-2889"
            ],
            "source_name": "MISPGALAXY:Cleaver",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a6c351ea-01f1-4c9b-af75-cfbb3b269ed3",
            "created_at": "2023-01-06T13:46:39.390649Z",
            "updated_at": "2025-03-27T02:00:03.072899Z",
            "deleted_at": null,
            "main_name": "Kinsing",
            "aliases": [
                "Money Libra"
            ],
            "source_name": "MISPGALAXY:Kinsing",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f9806b99-e392-46f1-9c13-885e376b239f",
            "created_at": "2023-01-06T13:46:39.431871Z",
            "updated_at": "2025-03-27T02:00:03.08926Z",
            "deleted_at": null,
            "main_name": "Watchdog",
            "aliases": [
                "Thief Libra"
            ],
            "source_name": "MISPGALAXY:Watchdog",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536163,
    "ts_updated_at": 1743041821,
    "ts_creation_date": 1653754574,
    "ts_modification_date": 1653754574,
    "files": {
        "pdf": "https://archive.orkl.eu/5d5f2ab93acbd96631e9a6762effdcacbf94272c.pdf",
        "text": "https://archive.orkl.eu/5d5f2ab93acbd96631e9a6762effdcacbf94272c.txt",
        "img": "https://archive.orkl.eu/5d5f2ab93acbd96631e9a6762effdcacbf94272c.jpg"
    }
}