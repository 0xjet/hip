{
    "id": "82d15061-d4ab-47b3-81ce-468ab7a22b5c",
    "created_at": "2023-01-12T15:08:15.667176Z",
    "updated_at": "2025-03-27T02:05:57.347243Z",
    "deleted_at": null,
    "sha1_hash": "b2199c59223071e069e4d8f61facdda6047d0fa0",
    "title": "2020-05-31 - Ransomware Avaddon- principales características",
    "authors": "",
    "file_creation_date": "2022-05-28T16:47:04Z",
    "file_modification_date": "2022-05-28T16:47:04Z",
    "file_size": 609056,
    "plain_text": "# Ransomware Avaddon: principales características\n\n**[welivesecurity.com/la-es/2021/05/31/ransomware-avaddon-principales-caracteristicas/](https://www.welivesecurity.com/la-es/2021/05/31/ransomware-avaddon-principales-caracteristicas/)**\n\nMay 31, 2021\n\nAnalizamos cuáles son las principales características del ransomware Avaddon a partir de\nalguna de las muestras de este malware analizadas durante el segundo trimestre de 2021.\n\n[Facundo Muñoz](https://www.welivesecurity.com/la-es/author/facundo-munoz/)\n31 May 2021 - 10:00AM\n\nAnalizamos cuáles son las principales características del ransomware Avaddon a partir de\nalguna de las muestras de este malware analizadas durante el segundo trimestre de 2021.\n\n\n-----\n\n**_Actualizado el 14 de junio de 2021_**\n_El ransomware Avaddon cerró sus operaciones el 11 de junio y compartió las claves de_\n_descifrado para que las víctimas que no pagaron puedan recuperar sus archivos del cifrado_\n_de manera gratuita. El grupo detrás de Avaddon envió las claves al portal_\n_BleepingComputer, el cual a su vez compartió las claves con investigadores de seguridad_\n_de Emsisoft y Coverware que confirmaron su legitimidad y crearon un descifrador que está_\n_[disponible para su descarga aquí. En total, los atacantes enviaron 2.934 claves de](https://www.emsisoft.com/ransomware-decryption-tools/avaddon)_\n_descifrado. Cada una de estas claves corresponde a una víctima en particular._\n\n## Qué es Avaddon\n\n[Avaddon es un ransomware cuyos primeros ataques fueron detectados a finales del año](https://www.welivesecurity.com/la-es/2021/05/21/que-es-ransomware/)\n2019 y que a mediados del 2020 comenzó a reclutar afiliados en foros de hacking para su\nprograma de Ransomware-as-a-Service (RaaS), ofreciendo múltiples opciones y amplia\ncapacidad para ser configurado para el servicio. Los ataques de Avaddon han afectado a\nempresas y organizaciones de todo el mundo, incluidos varios países de América Latina.\n\n_[Lectura relacionada: Crecen las víctimas del ransomware Avaddon en América Latina](https://www.welivesecurity.com/la-es/2021/03/16/crecen-victimas-ransomware-avaddon-america-latina/)_\n\n[Muchos grupos de ransomware adoptaron la modalidad extorsiva del doxing; es decir, el](https://www.welivesecurity.com/la-es/2020/05/29/ransomware-filtracion-informacion-tendencia-consolido-2020/)\nrobo de información de los sistemas comprometidos previo al cifrado para luego amenazar\na las víctimas con publicar la información en caso de no querer llegar a un acuerdo para el\npago del rescate. En el caso de Avaddon, si bien de acuerdo con las muestras analizadas y\nlos hashes públicos que observamos no detectamos la capacidad de robar información\ndesde el equipo infectado, los operadores detrás de este ransomware cuentan con un sitio\n[en la red TOR creado principalmente para este fin en el que publicaron supuesta](https://www.welivesecurity.com/la-es/2020/07/23/como-configurar-tor-navegar-deep-web-forma-segura/)\ninformación de las víctimas.\n\nAdemás del doxing, otra estrategia extorsiva que el grupo dice llevar adelante son los\nataques de DDoS sobre los sitios de las víctimas para de esta manera interrumpir el\nfuncionamiento y que los usuarios no puedan acceder.\n\nPor último, una vez que Avaddon logra acceso a una red realiza primero tareas de\nreconocimiento para identificar principalmente bases de datos, backup y copias shadow, y\ntambién buscando la forma escalar privilegios dentro de la red.\n\nSegún [publicó el Centro de Ciberseguridad de Australia en mayo de 2021, el monto](https://www.cyber.gov.au/acsc/view-all-content/advisories/2021-003-ongoing-campaign-using-avaddon-ransomware/)\npromedio que solicitan los atacantes para recuperar los archivos es de 0.73 bitcoins, que\nequivale aproximadamente 40.000 dólares.\n\n**_Tabla de contenidos en este artículo:_**\n\n## Principales características del ransomware Avaddon\n\n\n-----\n\nEstas son algunas de sus principales características:\n\nComo vector de propagación suele utilizar correos de phishing que buscan engañar al\nusuario haciéndole creer que hay una imagen comprometedora de ellos en el adjunto,\naunque también se ha visto utilizar en sus comienzos archivos Excel con macros\nmaliciosas, y más adelante hacer uso de credenciales de acceso débiles en servicios\n[de acceso remoto, como RDP y redes VPN.](https://agileblue.com/wp-content/uploads/2021/05/flash_avaddon_ransomware.pdf)\nDesarrollado en C++ y no utiliza herramientas de empaquetado ni ofuscación.\nUtiliza técnicas para dificultar el análisis: anti-VM, anti-debugging, utilización de tablas\nde strings cifradas encapsuladas en objetos.\nBusca archivos en discos locales y discos de red, teniendo como prioridad el cifrado\nde bases de datos.\nDoble cifrado con combinación de algoritmos AES-256 y RSA-2048.\nLos archivos cifrados en la muestras analizadas quedan con una extensión\ngeneralmente de 10 caracteres como .BeCecbaDBB, aunque se han visto que en las\n[primeras los archivos quedaban con otras extensiones como .avdn.](https://www.bleepingcomputer.com/forums/t/724607/avaddon-ransomware-avdn;-id-readmehtml-support-topic/page-2#entry5061940)\nTermina procesos que puedan impedir el cifrado de archivos.\nUtiliza comandos de Windows para eliminar copias de seguridad del sistema, y\n[copias shadow.](https://www.welivesecurity.com/la-es/2017/09/26/shadow-copies-backup-windows-ransomware/)\n\n## Cómo se distribuye Avaddon\n\nEl método de distribución qué más se ha visto en el caso de Avaddon es a través de\ncorreos de phishing que incluyen un archivo JScript malicioso adjunto que utiliza una\nsegunda extensión “.ZIP” para hacerle creer a la potencial víctima que se trata de un\narchivo comprimido que contiene una foto comprometedora que ha sido descubierta en la\nweb. El código JScript a su vez ejecuta comandos de Powershell para descargar el\nransomware de un servidor web y guardarlo en el directorio %TEMP% del equipo de la\nvíctima para luego ejecutar el malware.\n\n\n-----\n\nImagen 1. Ejemplo de correo de phishing que contiene adjunto malicioso.\n\nCabe destacar que una vez ejecutado el ransomware, este no llevara a cabo sus funciones\nen el equipo comprometido si este posee una configuración de lenguaje del teclado o si el\nidentificador del lenguaje del sistema es de alguno de los países que conforman la\nComunidad de Estados Independientes, principalmente el ruso.\n\n## Mecanismos para lograr establecer persistencia\n\nAntes de establecer persistencia en el sistema, Avaddon intenta elevar sus privilegios a\ntravés de un bypass en el User Account Control (UAC), que es bien conocido y ha sido\nutilizado por varias familias de malware. Si tiene éxito, se copia así mismo en la carpeta\nAppData\\Roaming del usuario actual.\n\nUtiliza dos tipos de métodos para ser ejecutado en el próximo inicio del sistema, o cuando\nla víctima inicia sesión en el sistema:\n\nRegistrando una Tarea Programada (Scheduled Task)\nRegistrandose en {HKLM|HKU}\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n\n## Cifrado de archivos de este ransomware\n\nUna vez concluido el proceso de persistencia, Avaddon prepara el sistema terminando los\nprocesos que puedan interferir con el acceso a los archivos. Para esto descifra dos listas\nde nombres asociados a software tales como: Microsoft SQL, Microsoft Word, QuickBooks,\n\n\n-----\n\nRemotely Anywhere, VMWare, y Java entre otros, así como también tres soluciones de\nseguridad: Symantec, 360 Secure Browser, G Data Security Software. Los nombres de\nestos procesos son:\n\nDefWatch, ccEvtMgr, ccSetMgr, SavRoam, dbsrv12, sqlservr, sqlagent,\nIntuit.QuickBooks.FCS, dbeng8, sqladhlp, QBIDPService, Culserver, RTVscan,\nvmware-usbarbitator64, vmware-converter, VMAuthdService, VMnetDHCP,\nVMUSBArbService, VMwareHostd, sqlbrowser, SQLADHLP, sqlwriter, msmdsrv,\ntomcat6, QBCFMonitorService\nexe, sqlmangr.exe, RAgui.exe, QBCFMonitorService.exe, supervise.exe, fdhost.exe,\nCulture.exe, wxServerView.exe, winword.exe, GDscan.exe, QBW32.exe,\nQBDBMgr.exe, qbupdate.exe, axlbridge.exe, 360se.exe, 360doctor.exe,\nQBIDPService.exe, wxServer.exe, httpd.exe, fdlauncher.exe, MsDtSrvr.exe,\ntomcat6.exe, java.exe, wdswfsafe.exe\n\nLuego utiliza varias herramientas de Windows para ejecutar comandos con el fin de borrar\nlos backups de seguridad, y copias shadow:\n\nImagen 2. Comandos ejecutados por Avaddon.\n\nFinalmente, utiliza la API SHEmptyRecycleBinW para eliminar los contenidos de la\npapelera de reciclaje para evitar que el usuario pueda recuperar algún archivo o versión\nprevia de algún archivo que la víctima haya eliminado con anterioridad.\n\nAvaddon comienza el proceso de cifrado de archivos en el disco local y discos de red,\nevitando los siguientes directorios:\n\n\n-----\n\nC:\\PERFLOGS\nC:\\PROGRAM FILES (X86), C:\\PROGRAM FILES, C:\\PROGRAMDATA\nC:\\USERS\\{Nombre de usuario}\\APPDATA\nC:\\USERS\\{Nombre de usuario}\\APPDATA\\LOCAL\\TEMP\nC:\\USERS\\PUBLIC\nC:\\WINDOWS\n\nLos archivos que encuentra son descartados por su extensión, a fin de evitar cifrar archivos\nque puedan causar fallos en el sistema:\n\n.exe, .bin, .sys, .ini, .dll, .lnk, .dat, .drv, .rdp, .prf, .swp\n\nTambién tiene un listado de extensiones las cual son de alta prioridad, estas pertenecen\narchivos relacionados con base de datos SQL:\n\n.mdf, .mds, .sql\n\nLos datos son cifrados utilizando una combinación de AES-256 y RSA-2048. Los datos\ncifrados se reescriben en el archivo original y se añade al final un marcador de cifrado que\nle permite a Avaddon evitar archivos que ya han sido cifrados previamente, así como\ntambién identificar los archivos cifrados y descifrarlos si la victima paga para obtener el\ndescifrador que ofrecen los criminales.\n\nImagen 3. Función de cifrado en Avaddon.\n\n\n-----\n\nEn las muestras que analizamos, los archivos que son cifrados correctamente son\nrenombrados con la extensión .BeCecbaDBB. Como podemos observar en la Imagen 4, el\ntipo de archivos que comúnmente cifra son documentos, imágenes, archivos de audio y\narchivos de video.\n\nImagen 4. Vista de una carpeta con varios tipos de archivos que fueron cifrados por Avaddon.\n\nFinalmente, el ransomware crea un archivo .TXT que contiene la nota de rescate\n{aleatorio}_readme_.txt como podemos observar en la Imagen 5.\n\n\n-----\n\nImagen 5. Nota de rescate de Avaddon en texto plano que es utilizada por varias configuraciones.\n\nHay otros casos donde la nota es un archivo .HTML con una estética muy similar a la que\nutilizan en el sitio web de Avaddon.\n\n[Imagen 6. Nota de rescate de otras versiones de Avaddon. (Fuente: @GrujaRS)](https://twitter.com/GrujaRS/status/1268818715262550017)\n\n## Consejos para prevenir un incidente\n\nConsiderando que la idea de pagar no debería ser la primera opción, ya que no solo es\nimposible saber si efectivamente los criminales proporcionarán el descifrador o no y que\ncomo ya se ha mencionado en reiteradas oportunidades pagando estimulamos la actividad\n\n\n-----\n\ncriminal al hacer que sea rentable para los atacantes, la primera opción tanto para\nempresas como usuarios debería ser la prevención.\n\n_[Lectura recomendada: 11 formas de protegerte del ransomware](https://www.welivesecurity.com/la-es/2015/07/08/11-formas-protegerte-del-ransomware-cryptolocker/)_\n\nTeniendo esto en cuenta, algunas recomendaciones son.\n\nHacer backup de la información de manera periódica\nInstalar una solución de seguridad confiable\nUtilizar una solución de cifrado de archivos\nCapacitar al personal sobre los riesgos que existen en Internet y cómo evitarlos\nMostrar las extensiones ocultas de los archivos por defecto\nAnalizar los adjuntos de correos electrónicos\nDeshabilitar los archivos que se ejecutan desde las carpetas AppData y\nLocalAppData\nDeshabilitar RDP cuando no sea necesario\nActualizar el software de dispositivos de escritorio, móviles y de red\nCrear políticas de seguridad y comunicarlas a los empleados\n\n31 May 2021 - 10:00AM\n\n### Suscríbase aquí para recibir actualizaciones sobre cualquier artículo nuevo en la sección crisis en Ucrania.\n\n Newsletter\n\n Discusión\n\n\n-----",
    "language": "ES",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-05-31 - Ransomware Avaddon- principales características.pdf"
    ],
    "report_names": [
        "2020-05-31 - Ransomware Avaddon- principales características.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536095,
    "ts_updated_at": 1743041157,
    "ts_creation_date": 1653756424,
    "ts_modification_date": 1653756424,
    "files": {
        "pdf": "https://archive.orkl.eu/b2199c59223071e069e4d8f61facdda6047d0fa0.pdf",
        "text": "https://archive.orkl.eu/b2199c59223071e069e4d8f61facdda6047d0fa0.txt",
        "img": "https://archive.orkl.eu/b2199c59223071e069e4d8f61facdda6047d0fa0.jpg"
    }
}