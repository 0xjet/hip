{
    "id": "96b5ab23-cb72-49e1-ac01-37f2e956796f",
    "created_at": "2023-01-12T15:01:19.217647Z",
    "updated_at": "2025-03-27T02:16:57.945521Z",
    "deleted_at": null,
    "sha1_hash": "ae3c675344b1fce1024af5af4390c5a11e42abcb",
    "title": "2019-12-26 - Introducing BIOLOAD- FIN7 BOOSTWRITE’s Lost Twin",
    "authors": "",
    "file_creation_date": "2022-05-28T16:09:19Z",
    "file_modification_date": "2022-05-28T16:09:19Z",
    "file_size": 229968,
    "plain_text": "# Introducing BIOLOAD: FIN7 BOOSTWRITE’s Lost Twin\n\n**[fortinet.com/blog/threat-research/bioload-fin7-boostwrite-lost-twin.html](https://www.fortinet.com/blog/threat-research/bioload-fin7-boostwrite-lost-twin.html)**\n\nDecember 26, 2019\n\n[A couple of months ago, enSilo’s endpoint protection platform blocked malicious payloads](https://www.fortinet.com/blog/business-and-technology/fortinet-acquires-endpoint-security-innovator-ensilo-.html)\nrunning in legitimate Microsoft Windows processes. A deeper look uncovered that the\nattacker abused the DLL search order to load their own malicious DLL. Some of the samples\nin the environment matched ones described in a recent publication by FireEye about FIN7’s\nnew tools and techniques, specifically BOOSTWRITE. Comparing the rest of the samples to\nBOOSTWRITE revealed they have a common codebase and carry the Carbanak backdoor.\n\n## The Abused Target\n\n[Windows OS uses a common method to look for required DLLs to load into a program.](https://docs.microsoft.com/en-us/windows/win32/dlls/dynamic-link-library-search-order)\nAdversaries may use this behavior to cause the program to load a malicious DLL, a\n[technique known as DLL search order hijacking (or binary planting).](https://attack.mitre.org/techniques/T1038)\n\nThe abused application in this case is FaceFodUninstaller.exe. It exists on a clean OS\ninstallation starting from Windows 10 RS4 (1803) at the\n“%WINDR%\\System32\\WinBioPlugIns” folder. The executable is dependent on winbio.dll,\nwhich is usually found in the parent directory (“%WINDR%\\System32”).\n\nFigure 1: FaceFodUninstaller.exe import table\n\nWhat makes this executable even more attractive in the eyes of an attacker is the fact that it\nis started from a built-in scheduled task named FODCleanupTask, thereby minimizing the\nfootprint on the machine and reducing the chances of detection even further. This\ndemonstrates the group’s ongoing technological research efforts.\n\nFigure 2: The built-in task view in Windows Task Scheduler\n\n\n-----\n\n## BIOLOAD\n\nThe loader file name is WinBio.dll (note the uppercase characters) and is placed by the\nattacker alongside the executable in the same folder (“WinBioPlugIns\"), thus leveraging the\ndefault DLL search order. Because the file path is under %WINDIR%, it means that in order\nto plant it the attacker needed to have elevated privileges on the victim’s machine such as\nadministrator or a SYSTEM account.\n\nFigure 3: WinBioPlugIns folder of an infected machine\n\nLike BOOSTWRITE, this loader was also developed in C++. It exports only a single function\nwhich is the one FaceFodUninstaller.exe imports.\n\nThe samples target a 64-bit OS and were compiled in March and July of 2019.\nBOOSTWRITE targets 32-bit machines and was compiled (and signed) in May 2019.\nAccording to previous reports on the group, they do not falsify compilation timestamps of the\nbinaries.\n\nWhen the DLL is started it checks the number of command line arguments of the process to\ndecide how to act. When the executable is started by the task scheduler it doesn’t have\ncommand line arguments and the malware works as follows:\n\n1. Creates a log file at %TEMP%\\~bio<epoch_time>. Logs are textual and aren’t\n\nencrypted.\n2. Starts itself again as a child process with one command line argument comprised of 32\n\nrandom upper-case letters.\n3. Establishes persistency by using COM objects to access the task scheduler. The\n\nmalware makes sure the task is enabled, adds a trigger to start it 30 seconds after\nWindows boots and does not wait for idle state.\n\nWhen WinBioGetEnrolledFactors is called, the malware loads the original winbio.dll and\ninvokes the original function.\n\nThe worker process loads and executes the payload DLL in-memory. It starts by creating a\nlog file at %TEMP%\\~wrk<epoch_time>. It then makes sure only a single instance is\ncurrently running by creating a named mutex based on environments variables in this\nfashion:\n\nBIOLOAD also has the encrypted payload DLL embedded in it. In contrast to BOOSTWRITE,\nit does not support multiple payloads. Furthermore, to decrypt the payload it uses a simple\nXOR decryption rather than a ChaCha cipher, nor does it access a remote server to fetch the\nkey. Instead, BIOLOAD is tailor-made for every machine it infects as it relies on the machine\nname to properly derive the decryption key.\n\n\n-----\n\nThe length of the key is 16 bytes and is also embedded in the loader. A portion of the key is\n[overwritten with the result of MurmurHash3 on the key using a CRC32 checksum of the](https://github.com/aappleby/smhasher/blob/master/src/MurmurHash3.cpp#L255)\ncomputer name as the seed. This hinders detection by sandboxes and obstruct researchers\nfrom analyzing the payload when the relevant context is missing.\n\nFigure 4: Start of the MurmurHash3 function disassembly\n\nThe PE loader implementation is the same as the one in BOOSTWRITE. The format of the\nlog file name is similar as well.\n\n## The Carbanak Backdoor\n\nAs mentioned, the payload this loader carries is the Carbanak backdoor. The samples we\nextracted from BIOLOAD are newer builds of the backdoor, dated January and April of 2019,\naccording to their timestamps.\n\nOne notable addition is that it checks to see if another Anti-Virus (AV) is running on the\nmachine, besides Kaspersky, AVG and TrendMicro. The result, however, has no effect on the\noperations of the backdoor, unlike with previously detected AVs.\n\n## Final Thoughts\n\nThis is the first public case of FaceFodUninstaller.exe being abused as host process by a\nthreat actor.\n\nThe shared codebase with recent tools attributed to FIN7, together with the same techniques\nand backdoor, allows to attribute this new loader to the cybercrime group. The timestamps,\ntogether with simpler functionality, suggest BIOLOAD is a preceding iteration of\nBOOSTWRITE.\n\nSince the loader is specifically built for each targeted machine and requires administrative\npermissions to deploy, it suggests the group gathers information about its targets’ networks.\n\n## Solutions\n\nThis malware uses a common, yet stealthy and effective, method to execute its payload in\nthe context of legitimate processes.\n\nCountermeasures should be in place to detect this malicious behavior. The recently acquired\n[FortiEDR – an Endpoint Detection and Response solution integrated into FortiGate firewalls,](https://www.fortinet.com/resources/cyberglossary/firewall?utm_source=blog&utm_campaign=2021-q1-firewall)\nFortiSIEM and FortiSandbox - detects and blocks such behavior post-infection to help\nincident responders quickly mitigate and respond to such threats.\n\nFortiClient detects and blocks the IOCs listed below as W64/Inject.B!tr.spy and\n**W64/Carbanak.A2EB!tr.**\n\n\n-----\n\n[In addition, as part of our membership in the Cyber Threat Alliance, details of this threat were](https://www.cyberthreatalliance.org/)\nshared in real time with other Alliance members to help create better protections for\ncustomers.\n\n## IOCs\n\n**WinBio.dll (scrubbed key and payload) SHA256**\n\n7bdae0dfc37cb5561a89a0b337b180ac6a139250bd5247292f470830bd96dda7\n\nc1c68454e82d79e75fefad33e5acbb496bbc3f5056dfa26aaf1f142cee1af372\n\n**Carbanak SHA256**\n\n77a6fbd4799a8468004f49f5929352336f131ad83c92484b052a2eb120ebaf9a\n\n42d3cf75497a724e9a9323855e0051971816915fc7eb9f0426b5a23115a3bdcb\n\n_[Learn more about FortiGuard Labs and the FortiGuard Security Services portfolio.](https://www.fortinet.com/fortiguard/threat-intelligence/threat-research.html?utm_source=nreleaseblog&utm_campaign=2018-q2-fortiguardlabs-cta)_ _Sign_\n_up for our weekly FortiGuard Threat Brief._\n\n_[Read about the FortiGuard Security Rating Service, which provides security audits and best](https://www.fortinet.com/support-and-training/support-services/fortiguard-security-subscriptions/security-rating.html?utm_source=blog&utm_campaign=2018-blog-security-rating-service)_\n_practices._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-12-26 - Introducing BIOLOAD- FIN7 BOOSTWRITE’s Lost Twin.pdf"
    ],
    "report_names": [
        "2019-12-26 - Introducing BIOLOAD- FIN7 BOOSTWRITE’s Lost Twin.pdf"
    ],
    "threat_actors": [
        {
            "id": "c9617bb6-45c8-495e-9759-2177e61a8e91",
            "created_at": "2022-10-25T15:50:23.405039Z",
            "updated_at": "2025-03-27T02:00:55.462193Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Carbanak",
                "Anunak"
            ],
            "source_name": "MITRE:Carbanak",
            "tools": [
                "Carbanak",
                "Mimikatz",
                "PsExec",
                "netsh"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "bfded1cf-be73-44f9-a391-0751c9996f9a",
            "created_at": "2022-10-25T15:50:23.337107Z",
            "updated_at": "2025-03-27T02:00:55.445946Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "FIN7",
                "GOLD NIAGARA",
                "ITG14",
                "Carbon Spider",
                "ELBRUS",
                "Sangria Tempest"
            ],
            "source_name": "MITRE:FIN7",
            "tools": [
                "Mimikatz",
                "AdFind",
                "JSS Loader",
                "HALFBAKED",
                "REvil",
                "PowerSploit",
                "CrackMapExec",
                "Carbanak",
                "Pillowmint",
                "Cobalt Strike",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRat",
                "Lizar",
                "TEXTMATE",
                "BOOSTWRITE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f4f16213-7a22-4527-aecb-b964c64c2c46",
            "created_at": "2024-06-19T02:03:08.090932Z",
            "updated_at": "2025-03-27T02:05:17.387119Z",
            "deleted_at": null,
            "main_name": "GOLD NIAGARA",
            "aliases": [
                "Carbanak",
                "Carbon Spider ",
                "FIN7 ",
                "Navigator ",
                "Sangria Tempest ",
                "TelePort Crew ",
                "Calcium "
            ],
            "source_name": "Secureworks:GOLD NIAGARA",
            "tools": [
                " Carbanak",
                " Cobalt Strike",
                " DICELOADER",
                " DRIFTPIN",
                " GGLDR",
                " GRIFFON",
                " JSSLoader",
                " Meterpreter",
                " OFFTRACK",
                " PILLOWMINT",
                " POWERTRASH",
                " SUPERSOFT",
                " TAKEOUT",
                " TinyMet",
                "Bateleur"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "bb8702c5-52ac-4359-8409-998a7cc3eeaf",
            "created_at": "2023-01-06T13:46:38.405479Z",
            "updated_at": "2025-03-27T02:00:02.82533Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "JokerStash",
                "ATK32",
                "G0046",
                "Coreid",
                "Carbanak",
                "Sangria Tempest",
                "CARBON SPIDER",
                "GOLD NIAGARA",
                "G0008",
                "ELBRUS",
                "Carbon Spider"
            ],
            "source_name": "MISPGALAXY:FIN7",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d85adfe3-e1c3-40b0-b8bb-d1bacadc4d82",
            "created_at": "2022-10-25T16:07:23.619566Z",
            "updated_at": "2025-03-27T02:02:09.890982Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "APT-C-11",
                "ATK 32",
                "Gold Niagara",
                "ITG14",
                "TAG-CR1"
            ],
            "source_name": "ETDA:FIN7",
            "tools": [
                "7Logger",
                "Agentemis",
                "Anunak",
                "Astra",
                "BIOLOAD",
                "BIRDWATCH",
                "Bateleur",
                "Boostwrite",
                "CROWVIEW",
                "Carbanak",
                "Cobalt Strike",
                "CobaltStrike",
                "DICELOADER",
                "DNSMessenger",
                "FOWLGAZE",
                "HALFBAKED",
                "JSSLoader",
                "KillACK",
                "LOADOUT",
                "Lizar",
                "Meterpreter",
                "Mimikatz",
                "POWERPLANT",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "TEXTMATE",
                "Tirion",
                "VB Flash",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "ed3810b7-141a-4ed0-8a01-6a972b80458d",
            "created_at": "2022-10-25T16:07:23.443259Z",
            "updated_at": "2025-03-27T02:02:09.801771Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Anunak",
                "Carbanak",
                "Carbon Spider",
                "ELBRUS",
                "Gold Waterfall",
                "Sangria Tempest"
            ],
            "source_name": "ETDA:Carbanak",
            "tools": [
                "AVE_MARIA",
                "Agentemis",
                "AmmyyRAT",
                "Antak",
                "Anunak",
                "Ave Maria",
                "AveMariaRAT",
                "BABYMETAL",
                "BIRDDOG",
                "Backdoor Batel",
                "Batel",
                "Bateleur",
                "BlackMatter",
                "Boostwrite",
                "Cain & Abel",
                "Carbanak",
                "Cl0p",
                "Cobalt Strike",
                "CobaltStrike",
                "DNSMessenger",
                "DNSRat",
                "DNSbot",
                "DRIFTPIN",
                "DarkSide",
                "FOXGRABBER",
                "FlawedAmmyy",
                "HALFBAKED",
                "JS Flash",
                "KLRD",
                "MBR Eraser",
                "Mimikatz",
                "Nadrac",
                "Odinaff",
                "POWERPIPE",
                "POWERSOURCE",
                "PsExec",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "SocksBot",
                "SoftPerfect Network Scanner",
                "Spy.Agent.ORM",
                "TEXTMATE",
                "TeamViewer",
                "TiniMet",
                "TinyMet",
                "Toshliph",
                "VB Flash",
                "WARPRISM",
                "avemaria",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535679,
    "ts_updated_at": 1743041817,
    "ts_creation_date": 1653754159,
    "ts_modification_date": 1653754159,
    "files": {
        "pdf": "https://archive.orkl.eu/ae3c675344b1fce1024af5af4390c5a11e42abcb.pdf",
        "text": "https://archive.orkl.eu/ae3c675344b1fce1024af5af4390c5a11e42abcb.txt",
        "img": "https://archive.orkl.eu/ae3c675344b1fce1024af5af4390c5a11e42abcb.jpg"
    }
}