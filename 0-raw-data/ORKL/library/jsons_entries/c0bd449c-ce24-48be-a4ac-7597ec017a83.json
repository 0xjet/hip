{
    "id": "c0bd449c-ce24-48be-a4ac-7597ec017a83",
    "created_at": "2024-02-03T02:06:52.38578Z",
    "updated_at": "2025-03-27T02:16:14.486162Z",
    "deleted_at": null,
    "sha1_hash": "58fc13f649bea13d627496f46994ec6cd4248b75",
    "title": "",
    "authors": "",
    "file_creation_date": "2024-02-02T08:58:51Z",
    "file_modification_date": "2024-02-02T08:58:51Z",
    "file_size": 1883868,
    "plain_text": "# Volt Typhoon targets US critical infrastructure with living-off-the-land techniques\n\n**microsoft.com/en-us/security/blog/2023/05/24/volt-typhoon-targets-us-critical-infrastructure-with-living-off-the-land-**\ntechniques\n\nMay 24, 2023\n\n[By Microsoft Threat Intelligence](https://www.microsoft.com/en-us/security/blog/author/microsoft-security-threat-intelligence/)\n\nMicrosoft has uncovered stealthy and targeted malicious activity focused on postcompromise credential access and network system discovery aimed at critical\ninfrastructure organizations in the United States. The attack is carried out by Volt\nTyphoon, a state-sponsored actor based in China that typically focuses on espionage and\ninformation gathering. Microsoft assesses with moderate confidence that this Volt\nTyphoon campaign is pursuing development of capabilities that could disrupt critical\ncommunications infrastructure between the United States and Asia region during future\ncrises.\n\nVolt Typhoon has been active since mid-2021 and has targeted critical infrastructure\norganizations in Guam and elsewhere in the United States. In this campaign, the affected\norganizations span the communications, manufacturing, utility, transportation,\nconstruction, maritime, government, information technology, and education sectors.\nObserved behavior suggests that the threat actor intends to perform espionage and\n\n\n-----\n\nmaintain access without being detected for as long as possible. Microsoft is choosing to\nhighlight this Volt Typhoon activity at this time because of our significant concern around\nthe potential for further impact to our customers. Although our visibility into these threats\nhas given us the ability to deploy detections to our customers, the lack of visibility into\nother parts of the actor’s activity compelled us to drive broader community awareness\nand further investigations and protections across the security ecosystem.\n\nTo achieve their objective, the threat actor puts strong emphasis on stealth in this\n[campaign, relying almost exclusively on living-off-the-land techniques and hands-on-](https://www.microsoft.com/en-us/security/blog/2018/09/27/out-of-sight-but-not-invisible-defeating-fileless-malware-with-behavior-monitoring-amsi-and-next-gen-av/)\nkeyboard activity. They issue commands via the command line to (1) collect data,\nincluding credentials from local and network systems, (2) put the data into an archive file\nto stage it for exfiltration, and then (3) use the stolen valid credentials to maintain\npersistence. In addition, Volt Typhoon tries to blend into normal network activity by routing\ntraffic through compromised small office and home office (SOHO) network equipment,\nincluding routers, firewalls, and VPN hardware. They have also been observed using\ncustom versions of open-source tools to establish a command and control (C2) channel\nover proxy to further stay under the radar.\n\nIn this blog post, we share information on Volt Typhoon, their campaign targeting critical\ninfrastructure providers, and their tactics for achieving and maintaining unauthorized\naccess to target networks. Because this activity relies on valid accounts and living-off-theland binaries (LOLBins), detecting and mitigating this attack could be challenging.\nCompromised accounts must be closed or changed. At the end of this blog post, we\nshare more mitigation steps and best practices, as well as provide details on how\nMicrosoft 365 Defender detects malicious and suspicious activity to protect organizations\nfrom such stealthy attacks. The National Security Agency (NSA) has also published a\n[Cybersecurity Advisory [PDF] which contains a hunting guide for the tactics, techniques,](https://media.defense.gov/2023/May/24/2003229517/-1/-1/0/CSA_Living_off_the_Land.PDF)\nand procedures (TTPs) discussed in this blog.\n\nAs with any observed nation-state actor activity, Microsoft has directly notified targeted or\ncompromised customers, providing them with important information needed to secure\ntheir environments. To learn about Microsoft’s approach to threat actor tracking, read\n[Microsoft shifts to a new threat actor naming taxonomy.](https://www.microsoft.com/en-us/security/blog/2023/04/18/microsoft-shifts-to-a-new-threat-actor-naming-taxonomy/)\n\n\n-----\n\nFigure 1. Volt Typhoon attack diagram\n\n## Initial access\n\nVolt Typhoon achieves initial access to targeted organizations through internet-facing\nFortinet FortiGuard devices. Microsoft continues to investigate Volt Typhoon’s methods\nfor gaining access to these devices.\n\nThe threat actor attempts to leverage any privileges afforded by the Fortinet device,\nextracts credentials to an Active Directory account used by the device, and then attempts\nto authenticate to other devices on the network with those credentials.\n\nVolt Typhoon proxies all its network traffic to its targets through compromised SOHO\nnetwork edge devices (including routers). Microsoft has confirmed that many of the\ndevices, which include those manufactured by ASUS, Cisco, D-Link, NETGEAR, and\nZyxel, allow the owner to expose HTTP or SSH management interfaces to the internet.\nOwners of network edge devices should ensure that management interfaces are not\nexposed to the public internet in order to reduce their attack surface. By proxying through\nthese devices, Volt Typhoon enhances the stealth of their operations and lowers\noverhead costs for acquiring infrastructure.\n\n## Post-compromise activity\n\nOnce Volt Typhoon gains access to a target environment, they begin conducting handson-keyboard activity via the command line. Some of these commands appear to be\nexploratory or experimental, as the operators adjust and repeat them multiple times.\n\nVolt Typhoon rarely uses malware in their post-compromise activity. Instead, they rely on\nliving-off-the-land commands to find information on the system, discover additional\ndevices on the network, and exfiltrate data. We describe their activities in the following\nsections, including the most impactful actions that relate to credential access.\n\n\n-----\n\n### Credential access\n\nIf the account that Volt Typhoon compromises from the Fortinet device has privileged\naccess, they use that account to perform the following credential access activities.\n\n[Microsoft has observed Volt Typhoon attempting to dump credentials through the Local](https://attack.mitre.org/techniques/T1003/001/)\n[Security Authority Subsystem Service (LSASS). The LSASS process memory space](https://attack.mitre.org/techniques/T1003/001/)\n[contains hashes for the current user’s operating system (OS) credentials.](https://www.microsoft.com/security/blog/2022/10/05/detecting-and-preventing-lsass-credential-dumping-attacks/)\n\nFigure 2. Volt Typhoon command to dump LSASS process memory, encoded in Base64\n\nFigure 3. Decoded Base64 of Volt Typhoon command to dump LSASS process memory\n\nVolt Typhoon also frequently attempts to use the command-line tool Ntdsutil.exe to create\ninstallation media from domain controllers, either remotely or locally. These media are\n[intended to be used in the installation of new domain controllers. The files in the](https://social.technet.microsoft.com/wiki/contents/articles/8630.active-directory-step-by-step-guide-to-install-an-additional-domain-controller-using-ifm.aspx)\ninstallation media contain usernames and password hashes that the threat actors can\ncrack offline, giving them valid domain account credentials that they could use to regain\naccess to a compromised organization if they lose access.\n\nFigure 4. Volt Typhoon command to remotely create domain controller installation media\n\nFigure 5. Volt Typhoon command to locally create domain controller installation media\n\n### Discovery\n\nMicrosoft has observed Volt Typhoon discovering system information, including file\nsystem types; drive names, size, and free space; running processes; and open networks.\nThey also attempt to discover other systems on the compromised network using\nPowerShell, Windows Management Instrumentation Command-line (WMIC), and the ping\ncommand. In a small number of cases, the threat actors run system checks to determine\nif they are operating within a virtualized environment.\n\n\n-----\n\n### Collection\n\nIn addition to operating system and domain credentials, Volt Typhoon dumps information\nfrom local web browser applications. Microsoft has also observed the threat actors\nstaging collected data in password-protected archives.\n\n### Command and control\n\nIn most cases, Volt Typhoon accesses compromised systems by signing in with valid\ncredentials, the same way authorized users do. However, in a small number of cases,\nMicrosoft has observed Volt Typhoon operators creating proxies on compromised\n[systems to facilitate access. They accomplish this with the built-in netsh portproxy](https://learn.microsoft.com/windows-server/networking/technologies/netsh/netsh-interface-portproxy)\ncommand.\n\nFigure 6. Volt Typhoon commands creating and later deleting a port proxy on a compromised system\n\nIn rare cases, they also use custom versions of open-source tools Impacket and Fast\nReverse Proxy (FRP) to establish a C2 channel over proxy.\n\nCompromised organizations will observe C2 access in the form of successful sign-ins\nfrom unusual IP addresses. The same user account used for these sign-ins may be linked\nto command-line activity conducting further credential access. Microsoft will continue to\nmonitor Volt Typhoon and track changes in their activity and tooling.\n\n## Mitigation and protection guidance\n\nMitigating risk from adversaries like Volt Typhoon that rely on valid accounts and livingoff-the-land binaries (LOLBins) is particularly challenging. Detecting activity that uses\nnormal sign-in channels and system binaries requires behavioral monitoring. Remediation\nrequires closing or changing credentials for compromised accounts. Suspected\ncompromised accounts or affected systems should be investigated:\n\nIdentify LSASS dumping and domain controller installation media creation to identify\naffected accounts.\nExamine the activity of compromised accounts for any malicious actions or exposed\ndata.\nClose or change credentials for all compromised accounts. Depending on the level\nof collection activity, many accounts may be affected.\n\n\n-----\n\n### Defending against this campaign\n\nMitigate the risk of compromised valid accounts by enforcing strong multi-factor\nauthentication (MFA) policies using hardware security keys or Microsoft\nAuthenticator. Passwordless sign-in, password expiration rules, and deactivating\nunused accounts can also help mitigate risk from this access method.\n[Reduce the attack surface. Microsoft customers can turn on the following attack](https://learn.microsoft.com/microsoft-365/security/defender-endpoint/overview-attack-surface-reduction)\n[surface reduction rules to block or audit some observed activity associated with this](https://learn.microsoft.com/microsoft-365/security/defender-endpoint/overview-attack-surface-reduction)\nthreat:\n\n[Block credential stealing from the Windows local security authority subsystem](https://learn.microsoft.com/microsoft-365/security/defender-endpoint/attack-surface-reduction-rules-reference?#block-credential-stealing-from-the-windows-local-security-authority-subsystem)\n[(lsass.exe).Block process creations originating from PSExec and WMI](https://learn.microsoft.com/microsoft-365/security/defender-endpoint/attack-surface-reduction-rules-reference?#block-process-creations-originating-from-psexec-and-wmi-commands)\ncommands. Some organizations may experience compatibility issues with this\nrule on certain server systems but should deploy it to other systems to prevent\nlateral movement originating from PsExec and WMI.\n[Block execution of potentially obfuscated scripts.](https://learn.microsoft.com/microsoft-365/security/defender-endpoint/attack-surface-reduction-rules-reference?#block-execution-of-potentially-obfuscated-scripts)\n[Harden the LSASS process by enabling Protective Process Light (PPL) for LSASS](https://learn.microsoft.com/windows-server/security/credentials-protection-and-management/configuring-additional-lsa-protection#BKMK_HowToConfigure)\non Windows 11 devices. New, enterprise-joined Windows 11 (22H2 update) installs\n[have this feature enabled by default. In addition, enable Windows Defender](https://learn.microsoft.com/windows/security/identity-protection/credential-guard/credential-guard-manage#enable-windows-defender-credential-guard)\n[Credential Guard, which is also turned on by default for organizations using the](https://learn.microsoft.com/windows/security/identity-protection/credential-guard/credential-guard-manage#enable-windows-defender-credential-guard)\nEnterprise edition of Windows 11.\n[Turn on cloud-delivered protection in Microsoft Defender Antivirus to cover rapidly](https://learn.microsoft.com/microsoft-365/security/defender-endpoint/configure-block-at-first-sight-microsoft-defender-antivirus?ocid=magicti_ta_learndoc)\nevolving attacker tools, techniques, and behaviors such as those exhibited by Volt\nTyphoon.\n[Run endpoint detection and response (EDR) in block mode so that Microsoft](https://learn.microsoft.com/microsoft-365/security/defender-endpoint/edr-in-block-mode?ocid=magicti_ta_learndoc)\nDefender for Endpoint can block malicious artifacts, even when your non-Microsoft\nantivirus does not detect the threat, or when Microsoft Defender Antivirus is running\nin passive mode. EDR in block mode works behind the scenes to remediate\nmalicious artifacts that are detected post-compromise.\n\n## Detection details and hunting queries\n\n### Microsoft Defender Antivirus\n\nMicrosoft Defender Antivirus detects attempted post-compromise activity. Note, however,\nthat these alerts can also be triggered by threat activity unrelated to Volt Typhoon. Turn\non cloud-delivered protection to cover rapidly evolving attacker tools and techniques.\nCloud-based machine learning protections block most new and unknown threats.\n\nBehavior:Win32/SuspNtdsUtilUsage.A\nBehavior:Win32/SuspPowershellExec.E\nBehavior:Win32/SuspRemoteCmdCommandParent.A\nBehavior:Win32/UNCFilePathOperation\nBehavior:Win32/VSSAmsiCaller.A\nBehavior:Win32/WinrsCommand.A\nBehavior:Win32/WmiSuspProcExec J!se\n\n\n-----\n\nBehavior:Win32/WmicRemote.A\nBehavior:Win32/WmiprvseRemoteProc.B\n\n### Microsoft Defender for Endpoint\n\nMicrosoft Defender for Endpoint alerts with the following titles can indicate possible\npresence of Volt Typhoon activity.\n\nVolt Typhoon threat actor detected\n\nThe following alerts may also be associated with Volt Typhoon activity. Note, however,\nthat these alerts can also be triggered by threat activity unrelated to Volt Typhoon.\n\nA machine was configured to forward traffic to a non-local address\nNtdsutil collecting Active Directory information\nPassword hashes dumped from LSASS memory\nSuspicious use of wmic.exe to execute code\nImpacket toolkit\n\n### Hunting queries\n\n**Microsoft 365 Defender**\n\nVolt Typhoon’s post-compromise activity usually includes distinctive commands.\nSearching for these can help to determine the scope and impact of an incident.\n\n**Find commands creating domain controller installation media**\n\nThis query can identify domain controller installation media creation commands similar to\nthose used by Volt Typhoon.\n```\n DeviceProcessEvents\n | where ProcessCommandLine has_all (\"ntdsutil\", \"create full\", \"pro\")\n\n```\n**Find commands establishing internal proxies**\n\nThis query can identify commands that establish internal proxies similar to those used by\nVolt Typhoon.\n```\n DeviceProcessEvents\n | where ProcessCommandLine has_all (\"portproxy\", \"netsh\", \"wmic\",\n \"process call create\", \"v4tov4\")\n\n```\n\n-----\n\n**Find detections of custom FRP executables**\n\nThis query can identify alerts on files that match the SHA-256 hashes of known Volt\nTyphoon custom FRP binaries.\n```\n AlertEvidence\n | where SHA256 in\n ('baeffeb5fdef2f42a752c65c2d2a52e84fb57efc906d981f89dd518c314e231c',\n 'b4f7c5e3f14fb57be8b5f020377b993618b6e3532a4e1eb1eae9976d4130cc74',\n '4b0c4170601d6e922cf23b1caf096bba2fade3dfcf92f0ab895a5f0b9a310349',\n 'c0fc29a52ec3202f71f6378d9f7f9a8a3a10eb19acb8765152d758aded98c76d',\n 'd6ab36cb58c6c8c3527e788fc9239d8dcc97468b6999cf9ccd8a815c8b4a80af',\n '9dd101caee49c692e5df193b236f8d52a07a2030eed9bd858ed3aaccb406401a',\n '450437d49a7e5530c6fb04df2e56c3ab1553ada3712fab02bd1eeb1f1adbc267',\n '93ce3b6d2a18829c0212542751b309dacbdc8c1d950611efe2319aa715f3a066',\n '7939f67375e6b14dfa45ec70356e91823d12f28bbd84278992b99e0d2c12ace5',\n '389a497f27e1dd7484325e8e02bbdf656d53d5cf2601514e9b8d8974befddf61',\n 'c4b185dbca490a7f93bc96eefb9a597684fdf532d5a04aa4d9b4d4b1552c283b',\n 'e453e6efc5a002709057d8648dbe9998a49b9a12291dee390bb61c98a58b6e95',\n '6036390a2c81301a23c9452288e39cb34e577483d121711b6ba6230b29a3c9ff',\n 'cd69e8a25a07318b153e01bba74a1ae60f8fc28eb3d56078f448461400baa984',\n '17506c2246551d401c43726bdaec800f8d41595d01311cf38a19140ad32da2f4',\n '8fa3e8fdbaa6ab5a9c44720de4514f19182adc0c9c6001c19cf159b79c0ae9c2',\n 'd17317e1d5716b09cee904b8463a203dc6900d78ee2053276cc948e4f41c8295',\n '472ccfb865c81704562ea95870f60c08ef00bcd2ca1d7f09352398c05be5d05d',\n '3e9fc13fab3f8d8120bd01604ee50ff65a40121955a4150a6d2c007d34807642')\n\n```\n**Microsoft Sentinel**\n\n\n-----\n\nBelow are some suggested queries to assist Microsoft Sentinel customers in identifying\nVolt Typhoon activity in their environment:\n\nMicrosoft customers can use the TI Mapping analytics (a series of analytics all prefixed\nwith ‘TI map’) to automatically match the malicious hash indicators (related to the custom\nFast Reverse Proxy binaries) mentioned in this blog post. These analytics are part of the\nThreat Intelligence solution and can be installed from the Microsoft Sentinel Content Hub\nif not currently deployed. More details on the Content Hub can be found\n[here: https://learn.microsoft.com/azure/sentinel/sentinel-solutions-deploy.](https://learn.microsoft.com/azure/sentinel/sentinel-solutions-deploy)\n\n## Indicators of compromise (IOCs)\n\nThe below list provides IOCs observed during our investigation. We encourage our\ncustomers to investigate these indicators in their environments and implement detections\nand protection to identify past related activity and prevent future attacks against their\nsystems.\n\nVolt Typhoon custom FRP executable (SHA-256):\n\nbaeffeb5fdef2f42a752c65c2d2a52e84fb57efc906d981f89dd518c314e231c\nb4f7c5e3f14fb57be8b5f020377b993618b6e3532a4e1eb1eae9976d4130cc74\n4b0c4170601d6e922cf23b1caf096bba2fade3dfcf92f0ab895a5f0b9a310349\nc0fc29a52ec3202f71f6378d9f7f9a8a3a10eb19acb8765152d758aded98c76d\nd6ab36cb58c6c8c3527e788fc9239d8dcc97468b6999cf9ccd8a815c8b4a80af\n9dd101caee49c692e5df193b236f8d52a07a2030eed9bd858ed3aaccb406401a\n450437d49a7e5530c6fb04df2e56c3ab1553ada3712fab02bd1eeb1f1adbc267\n93ce3b6d2a18829c0212542751b309dacbdc8c1d950611efe2319aa715f3a066\n7939f67375e6b14dfa45ec70356e91823d12f28bbd84278992b99e0d2c12ace5\n389a497f27e1dd7484325e8e02bbdf656d53d5cf2601514e9b8d8974befddf61\nc4b185dbca490a7f93bc96eefb9a597684fdf532d5a04aa4d9b4d4b1552c283b\ne453e6efc5a002709057d8648dbe9998a49b9a12291dee390bb61c98a58b6e95\n6036390a2c81301a23c9452288e39cb34e577483d121711b6ba6230b29a3c9ff\ncd69e8a25a07318b153e01bba74a1ae60f8fc28eb3d56078f448461400baa984\n17506c2246551d401c43726bdaec800f8d41595d01311cf38a19140ad32da2f4\n8fa3e8fdbaa6ab5a9c44720de4514f19182adc0c9c6001c19cf159b79c0ae9c2\nd17317e1d5716b09cee904b8463a203dc6900d78ee2053276cc948e4f41c8295\n472ccfb865c81704562ea95870f60c08ef00bcd2ca1d7f09352398c05be5d05d\n3e9fc13fab3f8d8120bd01604ee50ff65a40121955a4150a6d2c007d34807642\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2023/2023.05.24.Volt_Typhoon/Volt%20Typhoon%20targets%20US%20critical%20infrastructure%20with%20living-off-the-land%20techniques%20_%20Microsoft%20Security%20Blog.pdf"
    ],
    "report_names": [
        "Volt Typhoon targets US critical infrastructure with living-off-the-land techniques _ Microsoft Security Blog"
    ],
    "threat_actors": [
        {
            "id": "846522d7-29cb-4a0c-8ebe-ffba7429e2d7",
            "created_at": "2023-06-23T02:04:34.793629Z",
            "updated_at": "2025-03-27T02:02:10.204744Z",
            "deleted_at": null,
            "main_name": "Volt Typhoon",
            "aliases": [
                "Bronze Silhouette",
                "Dev-0391",
                "Insidious Taurus",
                "Redfly",
                "Storm-0391",
                "UNC3236",
                "VOLTZITE",
                "Vanguard Panda"
            ],
            "source_name": "ETDA:Volt Typhoon",
            "tools": [
                "FRP",
                "Fast Reverse Proxy",
                "Impacket",
                "LOLBAS",
                "LOLBins",
                "Living off the Land"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "382f2519-30b3-4943-b494-2d675bc2b38f",
            "created_at": "2024-06-19T02:03:07.951514Z",
            "updated_at": "2025-03-27T02:05:17.287489Z",
            "deleted_at": null,
            "main_name": "BRONZE SILHOUETTE",
            "aliases": [
                "Volt Typhoon "
            ],
            "source_name": "Secureworks:BRONZE SILHOUETTE",
            "tools": [
                " Web shells",
                "Living-off-the-land binaries"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "4ed2b20c-7523-4852-833b-cebee8029f55",
            "created_at": "2023-05-26T02:02:03.524749Z",
            "updated_at": "2025-03-27T02:00:03.132087Z",
            "deleted_at": null,
            "main_name": "Volt Typhoon",
            "aliases": [
                "VANGUARD PANDA",
                "UNC3236",
                "Insidious Taurus",
                "VOLTZITE",
                "Dev-0391",
                "Storm-0391",
                "BRONZE SILHOUETTE"
            ],
            "source_name": "MISPGALAXY:Volt Typhoon",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a88747e2-ffed-45d8-b847-8464361b2254",
            "created_at": "2023-11-01T02:01:06.605663Z",
            "updated_at": "2025-03-27T02:00:55.42808Z",
            "deleted_at": null,
            "main_name": "Volt Typhoon",
            "aliases": [
                "Volt Typhoon",
                "BRONZE SILHOUETTE",
                "Vanguard Panda",
                "DEV-0391",
                "UNC3236",
                "Voltzite",
                "Insidious Taurus"
            ],
            "source_name": "MITRE:Volt Typhoon",
            "tools": [
                "netsh",
                "PsExec",
                "ipconfig",
                "Wevtutil",
                "VersaMem",
                "Tasklist",
                "Mimikatz",
                "Impacket",
                "Systeminfo",
                "netstat",
                "Nltest",
                "certutil",
                "FRP",
                "cmd"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1706926012,
    "ts_updated_at": 1743041774,
    "ts_creation_date": 1706864331,
    "ts_modification_date": 1706864331,
    "files": {
        "pdf": "https://archive.orkl.eu/58fc13f649bea13d627496f46994ec6cd4248b75.pdf",
        "text": "https://archive.orkl.eu/58fc13f649bea13d627496f46994ec6cd4248b75.txt",
        "img": "https://archive.orkl.eu/58fc13f649bea13d627496f46994ec6cd4248b75.jpg"
    }
}