{
    "id": "34a6dab8-84dc-4af2-8f7e-f73c46955b03",
    "created_at": "2023-01-12T14:59:15.2077Z",
    "updated_at": "2025-03-27T02:06:02.119443Z",
    "deleted_at": null,
    "sha1_hash": "4ff46ff62367c9fd09f49a6300a5495eb408ecc4",
    "title": "2021-08-12 - Netskope Threat Coverage- LockBit",
    "authors": "",
    "file_creation_date": "2022-05-28T17:12:47Z",
    "file_modification_date": "2022-05-28T17:12:47Z",
    "file_size": 1905107,
    "plain_text": "# Netskope Threat Coverage: LockBit\n\n**netskope.com/blog/netskope-threat-coverage-lockbit**\n\nGustavo Palazolo August 12, 2021\n\n## Summary\n\n[LockBit Ransomware (a.k.a. ABCD) is yet another ransomware group operating in the RaaS](https://malpedia.caad.fkie.fraunhofer.de/details/win.lockbit)\n(Ransomware-as-a-Service) model, following the same architecture as other major threat\n[groups, like REvil. This threat emerged in September 2019 and is still being improved by its](https://www.netskope.com/blog/netskope-threat-coverage-revil)\n[creators. In June 2021, the LockBit group announced the release of LockBit 2.0, which](https://twitter.com/Intel_by_KELA/status/1406905385580118017/photo/1)\nincluded a new website hosted on the deep web, as well as a new feature to encrypt\nWindows domains using group policy.\n\nOn August 11, 2021, the LockBit ransomware group announced in their deep web forum that\nthey have infected the global IT consultancy company Accenture.\n\n\n-----\n\n_LockBit official website, hosted on the deep web, showing the Accenture information._\n[According to the company Cyble, the attackers have allegedly stolen about 6TB of data, and](https://twitter.com/AuCyble/status/1425422006690881541)\nare demanding $50M (USD) as ransom. Also, Cyble mentioned that this attack was\nsupposedly carried out by an insider, however, that has not been verified yet. The IT giant\nAccenture has [confirmed the attack and also affirmed that the breach had no impact on their](https://www.bleepingcomputer.com/news/security/accenture-confirms-hack-after-lockbit-ransomware-data-leak-threats/)\noperations or systems.\n\nThe period established for Accenture to pay the ransom was August 11, 2021, which has\nnow passed.\n\n_The original deadline for the ransom’s payment has passed, according to LockBit’s website._\n\n\n-----\n\nHowever, as I am writing this blog post, the period to pay the ransom was changed to August\n12, 2021, at the end of the day.\n\n_New deadline established by the attackers for Accenture’s ransom_\nAt this point, it’s unclear how the attack was carried out, or if LockBit really stole sensitive\ndata from the company. In this threat coverage report, we will briefly show how LockBit\nworks, describing some features used for anti-analysis.\n\n## Threat\n\nLockBit ransomware is developed in both C and Assembly and uses AES + ECC to encrypt\nthe files. The group operates in the RaaS model, and on their official website hosted on the\ndeep web, we can find an advertisement trying to attract more affiliates into the scheme.\n\n\n-----\n\n_LockBit “advertisement” posted on their website._\nAccording to the page, the group is using a custom stealer named “StealBIT” to exfiltrate\ndata from companies. They have even included a comparison between their service and\nother services, like MEGA and pCloud.\n\n_LockBit “advertisement” showing how fast they are when it comes to data exfiltration._\nThe website also includes an encryption speed comparative between LockBit and other\nransomware families, such as Ragnar, REvil, Conti, and others.\n\n\n-----\n\n_LockBit “advertisement” showing an encryption speed comparison between ransomware_\n_families._\nOnce the sample is executed, the code implements a very simple technique to detect if the\nprocess is being debugged, by checking the NtGlobalFlag value in the Process Environment\nBlock (PEB) structure. This is usually done to avoid direct calls to the function\n\n`CheckRemoteDebuggerPresent` or `IsDebuggerPresent .`\n\n\n-----\n\n_Basic anti-debug_\n\n_technique._\nAlso, LockBit verifies if the process is running with Administrator privileges by checking the\nreturn of the API `OpenSCManagerA . If it’s not a privileged process, the function will fail,`\nconsequently reaching the `ExitProcess call.`\n\n_LockBit checking if the_\n\n_process is privileged._\nThe sample also uses a Mutex to verify if there is another instance of LockBit running at the\nsame time.\n\n_LockBit creating a Mutex object._\n\n\n-----\n\nLooking at the PE .rdata section, we can see that LockBit attempts to protect some relevant\ninformation by encrypting the strings, which is just a basic protection against detection or\nquick analyses.\n\nFurthermore, we can observe that LockBit is using Intel 128-bit XMM registers in the\noperations, probably to increase the performance of the code.\n\n_LockBit encrypted strings._\nThe algorithm is straightforward — it decrypts the string by doing a single byte XOR\noperation, using the first byte of the string as a key.\n\n_LockBit string decryption algorithm._\nIt should be possible to decrypt LockBit strings applying the same logic.\n\n\n-----\n\n_Decrypting LockBit’s strings using Python._\nIn addition, LockBit also executes a series of commands using the API `ShellExecuteA to`\navoid any restoration of the files in the machine by disabling the system’s recovery mode and\nthe Windows Shadow Copies.\n\n_Some of the_\n\n_commands executed by LockBit._\nAfter the files are encrypted, LockBit creates the ransom note in every single directory where\nthere are encrypted files.\n\n_LockBit ransom note_\nLastly, the computer’s wallpaper is also changed by the malware, in case encrypting the files\nwasn’t enough to catch the victim’s attention.\n\n\n-----\n\n_LockBit wallpaper._\n\n## Protection\n\nNetskope Threat Labs is actively monitoring this campaign and has ensured coverage for all\nknown threat indicators and payloads.\n\n**Netskope Threat Protection**\n\nGeneric.Ransom.LockBit.19F98D1F\n**Netskope Advanced Threat Protection provides proactive coverage against this**\nthreat.\n\nGen.Malware.Detect.By.StHeur indicates a sample that was detected using static\nanalysis\nGen.Malware.Detect.By.Sandbox indicates a sample that was detected by our\ncloud sandbox\n\n## IOCs\n\n**SHA256**\n\n6292c2294ad1e84cd0925c31ee6deb7afd300f935004a9e8a7a43bf80034abae\n\n[A full list of IOCs and a Yara rule are available in our Git repo.](https://github.com/netskopeoss/NetskopeThreatLabsIOCs/tree/main/LockBit)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-08-12 - Netskope Threat Coverage- LockBit.pdf"
    ],
    "report_names": [
        "2021-08-12 - Netskope Threat Coverage- LockBit.pdf"
    ],
    "threat_actors": [
        {
            "id": "6e23ce43-e1ab-46e3-9f80-76fccf77682b",
            "created_at": "2022-10-25T16:07:23.303713Z",
            "updated_at": "2025-03-27T02:02:09.727245Z",
            "deleted_at": null,
            "main_name": "ALPHV",
            "aliases": [
                "ALPHV",
                "ALPHVM",
                "BlackCat Gang",
                "UNC4466"
            ],
            "source_name": "ETDA:ALPHV",
            "tools": [
                "ALPHV",
                "ALPHVM",
                "BlackCat",
                "GO Simple Tunnel",
                "GOST",
                "Impacket",
                "LaZagne",
                "MEGAsync",
                "Mimikatz",
                "Munchkin",
                "Noberus",
                "PsExec",
                "Remcom",
                "RemoteCommandExecution",
                "WebBrowserPassView"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535555,
    "ts_updated_at": 1743041162,
    "ts_creation_date": 1653757967,
    "ts_modification_date": 1653757967,
    "files": {
        "pdf": "https://archive.orkl.eu/4ff46ff62367c9fd09f49a6300a5495eb408ecc4.pdf",
        "text": "https://archive.orkl.eu/4ff46ff62367c9fd09f49a6300a5495eb408ecc4.txt",
        "img": "https://archive.orkl.eu/4ff46ff62367c9fd09f49a6300a5495eb408ecc4.jpg"
    }
}