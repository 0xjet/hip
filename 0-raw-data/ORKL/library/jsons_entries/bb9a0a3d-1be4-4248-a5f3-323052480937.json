{
    "id": "bb9a0a3d-1be4-4248-a5f3-323052480937",
    "created_at": "2022-10-25T16:48:19.38533Z",
    "updated_at": "2025-03-27T02:16:50.830264Z",
    "deleted_at": null,
    "sha1_hash": "b2960938fa9e99613d211c440e2ee48c55c5648f",
    "title": "",
    "authors": "",
    "file_creation_date": "2020-05-22T04:44:02Z",
    "file_modification_date": "2020-05-22T04:44:02Z",
    "file_size": 1595305,
    "plain_text": "# The Evolution of APT15’s Codebase 2020\n\n**intezer.com/blog/research/the-evolution-of-apt15s-codebase-2020**\n\nMay 21, 2020\n\nThe Ke3chang group, also known as APT15, is an alleged Chinese government-backed cluster of teams known to target\n[various high-profile entities spanning multiple continents. Examples include attacks on European ministries, Indian](https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/wp-operation-ke3chang.pdf)\n[embassies, and British military contractors. The group’s activities have been traced back to 2010 and it is known to boast a](https://www.nccgroup.trust/uk/about-us/newsroom-and-events/blogs/2018/march/apt15-is-alive-and-strong-an-analysis-of-royalcli-and-royaldns/)\nlarge number of custom tools, most often tailored to their specific target.\n\nIn mid May, we identified three recently uploaded samples from VirusTotal that share code with older APT15 implants. We\nnamed this new family of samples, “Ketrum”, due to the merger of features in the documented backdoor families “Ketrican”\nand “Okrum”.\n\nWe believe the operation was conducted very recently. Below we present a technical analysis of these samples and explain\nthe evolution of APT15’s codebase over the last year.\n\n**OVERVIEW**\n\nThe three samples we discovered seem to be a mix of the Ketrican and Okrum backdoors documented by researchers at\n[ESET in 2019. Features have been merged from these two malware families to create a different RAT class for the group.](https://www.welivesecurity.com/wp-content/uploads/2019/07/ESET_Okrum_and_Ketrican.pdf)\nWe’ve decided to call this umbrella of malware “Ketrum.”\n\nThe new samples we found continue the Ke3chang group’s strategy of using a basic backdoor to gain control over the\nvictim’s device, so that an operator can then connect to it and run commands manually to conduct further operations.\n\n[Before beginning our technical analysis, we were able to connect these binaries to Ke3chang using Intezer Analyze:](http://analyze.intezer.com/)\n\n\n-----\n\n[Genetic Analysis](https://analyze.intezer.com/#/files/271384a078f2a2f58e14d7703febae8a28c6e2d7ddb00a3c8d3eead4ea87a0c0)\n\nAll three samples contacted the same C2 server and appear to have been used in two different time periods, judging by the\nPE timestamps and VirusTotal upload date:\n\n## SHA256s Name VirusTotal Date PE Timestamp C2 Family\n\n\n## a142625512e 5372a172859 5be19dbee23 eea50524b48 27cb64ed5aa eaaa0270b\n\n 271384a078f 2a2f58e14d77 03febae8a28c 6e2d7ddb00a3 c8d3eead 4ea87a0c0\n\n aacaf0d4729 dd6fda2e452 be763d209f9 2d107ecf24d 8a341947c54 5de9b7311\n\n\n## RavAudio64.exe 2019-12-03 7 Jan 2010 menu.thehuguardian[.]com Ketrum1\n\n – 2020-05-16 13 May 2020 www.thehuguardian[.]com Ketrum2\n\n – 2020-05-17 13 May 2020 www.thehuguardian[.]com Ketrum2\n\n\nThe C2 was registered towards the end of 2019, which makes us believe the first PE timestamp was tampered with, and the\nlatter two timestamps are at least close to the real compilation date.\n\nIt’s also important to note the C2 was registered in China and ceased operating in mid May.\n\n**THE BEST OF TWO WORLDS**\n\nWe documented several interesting differences between the backdoors:\n\n\n## Ket‐ ri‐ can\n\n\n## Okrum Ketrum 1\n\n\n## Ketrum 2\n\n\n-----\n\n## Identify installed proxy servers and use them for HTTP requests ❌ ✅ ✅ ✅\n\n Special folder retrieval using registry key [HKEY_CURRENT_USER\\Software\\Mi‐ ✅ ❌ ✅ ✅ crosoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders]\n\n The response from the server is an HTTP page with backdoor commands and argu‐ ✅ ❌ ❌ ✅ ments included in the HTML fields\n\n Backdoor commands are determined by a hashing value received from C2 ❌ ✅ ❌ ❌\n\n Communication with the C&C server is hidden in the Cookie and Set-Cookie headers ❌ ✅ ✅ ❌ of HTTP requests\n\n Impersonate a logged in user’s security context ❌ ✅ ✅ ❌\n\n Create a copy of cmd.exe in their working directory and use it to interpret backdoor ✅ ❌ ✅ ❌ commands\n\n Usual Ke3chang backdoor functionalities – download, upload, execute files/shell com‐ ✅ ✅ ✅ ✅ mands and configure sleep time\n\n Screenshot-grabbing functionality ❌ ❌ ✅ ❌\n\n**Table 1**\n\n**KETRUM 1**\n\nThe Ketrum 1 sample was uploaded to VirusTotal in December 2019. This version registers itself as a “WMI Provider Host”\nservice if it is able to obtain SeDebugPrivilege; otherwise it creates an entry in the startup directory.\n\nThis sample incorporates many features from Okrum as can be seen in the table above, however, it abandons more\nadvanced Okrum features such as offering a reflective injection via an export and the use of hashes to receive command\nIDs.\n\n[In the past, APT15 has used the IWebBrowser2 COM interface to manage its network communications. This time, the](https://bohops.com/2018/03/17/abusing-exported-functions-and-exposed-dcom-interfaces-for-pass-thru-command-execution-and-lateral-movement/)\nKetrum developer abandoned this technique and used simple HTTP APIs:\n\nInterestingly, this sample also incorporates a screenshot-grabbing\ncommand.\n\n**KETRUM 2**\n\nKetrum 2 seems to have been built for minimalism. As can be seen\nin Table 1, many functionalities have been dropped.\n\nUnlike the Ketrican variant, Ketrum implants no longer try to weaken\nthe system’s security configurations. In previous implants,\nPowershell was used for this end. Interestingly, a string still remains\nin Ketrum 2, which refers to this deleted feature—perhaps an\nunintentional left-over from copy-pasting:\n\nSeveral other interesting unused file names are included in the binary such as “%s\\adult.sft” and “%s\\Message”.\n\nThe malware first collects basic system information to track the infected endpoint and then sends it to the C2 server together\nwith a hash of the system info:\n\n\n-----\n\nAll incoming and outcoming payloads are fed through an RC4 encryption and base64 encoding. The RC4 encryption uses an\nunusual key:\n\nThese are actually constants used in the MD5 and SHA1 algorithms. The Ketrum developer most likely intended to confuse\nresearchers reversing this function.\n\nA command is then extracted from the HTML in the response:\n\nThis backdoor only supports a limited number of commands, which is typical of Okrum and Ketrican backdoors. Unlike\nKetrum 1, Ketrum 2 does not support screenshot grabbing. This is the list of possible backdoor commands:\n\n\n-----\n\n## Command ID Description\n\n 1 Adjust sleep time\n\n 2 Execute a shell command\n\n 3 Upload a file\n\n 4 Download a file\n\n 5 Execute a file\n\n 7 (there is no 6) Execute a shell command with adjusted sleep time\n\n 8 Adjust execute shell sleep time\n\n 9 Download “Notice” file to working directory – * it is unclear how this is used\n\n**CODE REUSE**\n\nBoth Ketrum samples resemble a similar layout to previous Ke3chang tools, apart from low level implementation and use of\nsystem APIs. Even in the two Ketrum samples, there are differences between the low-level APIs used to achieve the same\nfunctionality. For example, the file upload feature is implemented using different APIs throughout the families; mostly using a\nconstant value of 0x20000 when reading files:\n\n**Ketrum 1** **Ketrum 2**\n\n\n-----\n\n**Ketrican 2018**\n\n**Okrum**\n\nAs reported by FireEye and ESET, it’s likely the Ke3chang cluster of malware is developed by multiple teams and the\ndevelopers of Ketrican/Okrum belong to a different team than the developers of Ketrum, albeit related. This could explain the\nhigh-level and flow similarities but also the low-level differences.\n\n**CONCLUSION**\n\nKe3chang’s numerous tools such as Okrum, Ketrican, TidePool, Mirage, Ketrum, and others all serve the same purpose,\ngive or take a few techniques or functionalities tailored for specific targets. We can regard these tools under the same\numbrella of BS2005 malware, distributed as different versions per operation. However, the distinction created by naming\nthem differently is useful for tracking the group’s operations and different development cycles.\n\nThe Ke3chang’s group tools have not deviated much from the same tools reported in FireEye’s first Ke3chang report. The\ngroup continues to morph its code and switch basic functionalities in their various backdoors. This strategy has been working\nfor the group for years and there is no indication yet that it will deviate from this modus operandi.\n\nThe information security field has seen many improvements since the group’s inception, however, surprisingly, this is not\nreflected in the group’s persistence to use the same old TTPs in their tools.\n\n**IOCs**\n\n271384a078f2a2f58e14d7703febae8a28c6e2d7ddb00a3c8d3eead4ea87a0c0\naacaf0d4729dd6fda2e452be763d209f92d107ecf24d8a341947c545de9b7311\na142625512e5372a1728595be19dbee23eea50524b4827cb64ed5aaeaaa0270b\nthehuguardian[.]com\n45.56.84[.]25\n\n**Paul Litvak**\nPaul is a malware analyst and reverse engineer at Intezer. He previously served as a developer in the Israel Defense Force\n(IDF) Intelligence Corps for three years\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2020/2020.05.21.APT15_Codebase_2020/Intezer%20-%20The%20Evolution%20of%20APT15%27s%20Codebase%202020.pdf"
    ],
    "report_names": [
        "Intezer - The Evolution of APT15's Codebase 2020"
    ],
    "threat_actors": [
        {
            "id": "77b28afd-8187-4917-a453-1d5a279cb5e4",
            "created_at": "2022-10-25T15:50:23.768278Z",
            "updated_at": "2025-03-27T02:00:55.5423Z",
            "deleted_at": null,
            "main_name": "Inception",
            "aliases": [
                "Inception Framework",
                "Cloud Atlas"
            ],
            "source_name": "MITRE:Inception",
            "tools": [
                "PowerShower",
                "VBShower",
                "LaZagne"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "0a03e7f0-2f75-4153-9c4f-c46d12d3962e",
            "created_at": "2022-10-25T15:50:23.453824Z",
            "updated_at": "2025-03-27T02:00:55.473216Z",
            "deleted_at": null,
            "main_name": "Ke3chang",
            "aliases": [
                "Ke3chang",
                "APT15",
                "Vixen Panda",
                "GREF",
                "Playful Dragon",
                "RoyalAPT",
                "Nylon Typhoon"
            ],
            "source_name": "MITRE:Ke3chang",
            "tools": [
                "Okrum",
                "Systeminfo",
                "netstat",
                "spwebmember",
                "Mimikatz",
                "Tasklist",
                "MirageFox",
                "Neoichor",
                "ipconfig"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "7c8cf02c-623a-4793-918b-f908675a1aef",
            "created_at": "2023-01-06T13:46:38.309165Z",
            "updated_at": "2025-03-27T02:00:02.801298Z",
            "deleted_at": null,
            "main_name": "APT15",
            "aliases": [
                "BRONZE PALACE",
                "Nylon Typhoon",
                "VIXEN PANDA",
                "Playful Dragon",
                "BRONZE DAVENPORT",
                "BRONZE IDLEWOOD",
                "G0004",
                "Red Vulture",
                "Ke3Chang",
                "Metushy",
                "Lurid",
                "Social Network Team",
                "Royal APT"
            ],
            "source_name": "MISPGALAXY:APT15",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7d5531e2-0ad1-4237-beed-af009035576f",
            "created_at": "2024-05-01T02:03:07.977868Z",
            "updated_at": "2025-03-27T02:05:17.283109Z",
            "deleted_at": null,
            "main_name": "BRONZE PALACE",
            "aliases": [
                "BRONZE DAVENPORT ",
                "BRONZE IDLEWOOD ",
                "CTG-9246 ",
                "Ke3chang ",
                "Playful Dragon",
                "Vixen Panda ",
                "APT15 "
            ],
            "source_name": "Secureworks:BRONZE PALACE",
            "tools": [
                " BS2005",
                " Enfal",
                " Mirage",
                " RoyalCLI",
                " RoyalDNS",
                "BMW"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "17b1b76b-16da-4c4f-8b32-f6fede3eda8c",
            "created_at": "2022-10-25T16:07:23.750796Z",
            "updated_at": "2025-03-27T02:02:09.961401Z",
            "deleted_at": null,
            "main_name": "Ke3chang",
            "aliases": [
                "APT 15",
                "BackdoorDiplomacy",
                "Bronze Davenport",
                "Bronze Idlewood",
                "Bronze Palace",
                "CTG-9246",
                "GREF",
                "Ke3chang",
                "Metushy",
                "Nylon Typhoon",
                "Operation Ke3chang",
                "Operation MirageFox",
                "Playful Dragon",
                "Playful Taurus",
                "Red Vulture",
                "Royal APT",
                "Social Network Team",
                "Vixen Panda"
            ],
            "source_name": "ETDA:Ke3chang",
            "tools": [
                "Agentemis",
                "Anserin",
                "BS2005",
                "BleDoor",
                "CarbonSteal",
                "Cobalt Strike",
                "CobaltStrike",
                "DarthPusher",
                "DoubleAgent",
                "EternalBlue",
                "GoldenEagle",
                "Graphican",
                "HenBox",
                "HighNoon",
                "IRAFAU",
                "Ketrican",
                "Ketrum",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "MS Exchange Tool",
                "Mebroot",
                "Mimikatz",
                "MirageFox",
                "NBTscan",
                "Okrum",
                "PluginPhantom",
                "PortQry",
                "ProcDump",
                "PsList",
                "Quarian",
                "RbDoor",
                "RibDoor",
                "Royal DNS",
                "RoyalCli",
                "RoyalDNS",
                "SAMRID",
                "SMBTouch",
                "SilkBean",
                "Sinowal",
                "SpyWaller",
                "Theola",
                "TidePool",
                "Torpig",
                "Turian",
                "Winnti",
                "XSLCmd",
                "cobeacon",
                "nbtscan",
                "netcat",
                "spwebmember"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716499,
    "ts_updated_at": 1743041810,
    "ts_creation_date": 1590122642,
    "ts_modification_date": 1590122642,
    "files": {
        "pdf": "https://archive.orkl.eu/b2960938fa9e99613d211c440e2ee48c55c5648f.pdf",
        "text": "https://archive.orkl.eu/b2960938fa9e99613d211c440e2ee48c55c5648f.txt",
        "img": "https://archive.orkl.eu/b2960938fa9e99613d211c440e2ee48c55c5648f.jpg"
    }
}