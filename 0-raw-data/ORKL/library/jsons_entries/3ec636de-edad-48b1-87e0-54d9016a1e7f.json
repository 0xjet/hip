{
    "id": "3ec636de-edad-48b1-87e0-54d9016a1e7f",
    "created_at": "2023-01-12T14:59:50.227274Z",
    "updated_at": "2025-03-27T02:16:57.964425Z",
    "deleted_at": null,
    "sha1_hash": "b739a0449f8708bfa457175dd6ad7a75d63c8b90",
    "title": "2021-04-20 - Carbanak and FIN7 Attack Techniques",
    "authors": "",
    "file_creation_date": "2022-05-28T16:01:30Z",
    "file_modification_date": "2022-05-28T16:01:30Z",
    "file_size": 213102,
    "plain_text": "# Carbanak and FIN7 Attack Techniques\n\n**[trendmicro.com/en_us/research/21/d/carbanak-and-fin7-attack-techniques.html](https://www.trendmicro.com/en_us/research/21/d/carbanak-and-fin7-attack-techniques.html)**\n\nAPT & Targeted Attacks\n\n\nApril 20, 2021\n\n\nWhat happens in Carbanak and FIN7 attacks? Here are some techniques used by these\nfinancially motivated threat groups that target banks, retail stores, and other establishments.\n\nBy: Trend Micro April 20, 2021 Read time: ( words)\n\n[Constant monitoring of threat groups is one of the ways that security researchers and law](https://www.trendmicro.com/en_us/research.html?category=trend-micro-blogs:threats/apt-and-targeted-attacks)\nenforcement agencies are able defend systems against cybercrime. Among these\n[cybercriminals are financially motivated threat groups Carbanak and](https://attack.mitre.org/groups/G0008/) [FIN7. Although both](https://attack.mitre.org/groups/G0046/)\n[names have at times been used to refer to the same group, organizations such as MITRE](https://attackevals.mitre-engenuity.org/enterprise/carbanak_fin7/)\n[identifies them as two separate entities that wield the Carbanak backdoor in their attacks.](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cybercrime-and-digital-threats/carbanak-backdoor-s-source-code-leaked-what-this-means-for-enterprises)\nHowever, the groups use not just the Carbanak backdoor but also other types of malware\nsuch as [Pillowmint, a point-of-sale malware, and Tirion, which is said to be geared to replace](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/pillowmint-fin7s-monkey-thief/)\nCarbanak.\n\nMITRE also identifies different main targets for each group: While Carbanak focuses on\nbanking institutions, FIN7 targets food, hospitality, and retail establishments.\n\n\n-----\n\nThis week, the results of this year s round of the [MITRE Engenuity ATT&CK Evaluations](https://attackevals.mitre-engenuity.org/enterprise/participants/?rounds=carbanak_fin7)\nwere released, which focused on Carbanak+FIN7. We also separately discussed how Trend\nMicro solutions deal with these threats.\n\nFor more background on what happens in attacks launched by Carbanak and FIN7, we\npieced together information from our studies of these groups as well as information from\n[ATT&CK tactics and techniques (a total of 65 techniques across 11 tactics) identified by](https://attackevals.mitre-engenuity.org/enterprise/carbanak_fin7/#technique-scope)\nMITRE to be related to these threat groups.\n\n## What happens in Carbanak and FIN7 attacks?\n\nIn our analysis of a [related past campaign, we observed that attackers enter the system](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cybercrime-and-digital-threats/carbanak-backdoor-s-source-code-leaked-what-this-means-for-enterprises)\nthrough [spear phishing. After gaining a foothold in the system, the dynamic data exchange](https://www.trendmicro.com/vinfo/tmr/?/us/security/definition/spear-phishing/)\n(DDE) feature in Windows and legitimate cloud-based services will then be abused to deliver\n[the malware or to establish command-and-control (C&C) communication.](https://www.trendmicro.com/vinfo/tmr/?/us/security/definition/command-and-control-server)\n\nAfter this, the Carbanak backdoor can then be used to log keystrokes and capture\nscreenshots, steal and delete cookies, inject malicious code on sites, and monitor various\ntraffic. For lateral movement, the malware abuses remote and system administration tools.\n\nTo be more specific in terms of ATT&CK® techniques, Carbanak and FIN7 share a notable\nnumber of similarities. However, some techniques are only used by one of them, as we\ndiscuss in the subsequent sections.\n\n\n-----\n\nFigure 1. ATT&CK® tactics shared between Carbanak and FIN7\nThe following are the tactics and techniques that are employed by Carbanak and FIN7, as\n[shared by MITRE.](https://attackevals.mitre-engenuity.org/enterprise/carbanak_fin7/#technique-scope)\n\n**Initial Access**\n\nBoth groups use spear-phishing campaigns with attachments that are embedded with\nexploits as an entry point to the target system.\n\n**Execution**\n\n\n-----\n\nSuccessfully entering the system leads to the next step: executing the attack. For code and\n[behavior execution, both groups use a variety of techniques through native API,](https://attack.mitre.org/techniques/T1106/) [PowerShell,](https://attack.mitre.org/techniques/T1059/001/)\n[service execution,](https://attack.mitre.org/techniques/T1569/002/) [user execution,](https://attack.mitre.org/techniques/T1204/) Windows Component Object Model (COM) and\nDistributed COM, and [Windows Management Instrumentation (WMI).](https://attack.mitre.org/techniques/T1047/)\n\n[Carbanak also abuses command-line interface and](https://attack.mitre.org/techniques/T1059/) [DDE client-server protocol.](https://attack.mitre.org/techniques/T1559/002/)\n\n[On the other hand, FIN7 takes advantage of Mshta, a utility that can execute VBScript, and](https://attack.mitre.org/techniques/T1218/005/)\n[scheduled tasks to run malicious code on user systems.](https://attack.mitre.org/techniques/T1053/)\n\n**Persistence**\n\nOnce the malicious behavior is executed, the attackers will attempt to keep their presence in\n[a system. To maintain persistence, the groups create new services. They also add programs](https://attack.mitre.org/techniques/T1543/003/)\nto a startup folder that can be referenced with a registry run key. We detected a variant of the\nCarbanak malware that adds registry entries and keys as an autostart technique. Credentials\n[of existing valid accounts were also abused.](https://attack.mitre.org/techniques/T1078/)\n\nIn the case of FIN7, the use of [application shimming databases (which can allow developers](https://attack.mitre.org/techniques/T1546/011/)\nto apply fixes to applications without rewriting code) and hooking processes that allow the\nmodification of program behaviors are some of the techniques that can be applied. The\n[former has been utilized in a campaign involving the Pillowmint malware.](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/pillowmint-fin7s-monkey-thief/)\n\n**Privilege Escalation**\n\nSome functions that are needed for the attack require admin privileges. To elevate privileges,\n[the groups bypass Windows User Account Control (UAC) mechanisms,](https://attack.mitre.org/techniques/T1548/002/) [new services, and](https://attack.mitre.org/techniques/T1543/)\n[valid accounts to elevate process privileges.](https://attack.mitre.org/techniques/T1078/)\n\n[For the same purpose, on Linux systems, Carbanak attacks can use sudo, a program that](https://attack.mitre.org/techniques/T1548/003/)\npermits users to execute the programs of a superuser.\n\nFIN7 attacks can and [inject code into processes and hijack the search order used to load](https://attack.mitre.org/techniques/T1055/)\n[DLL files.](https://attack.mitre.org/techniques/T1574/001/)\n\n**Defense Evasion**\n\nAfter a series of malicious behavior, attackers need to remain stealthy and undetected by\nusing security solutions that can remove threats out of the system. For defense evasion, both\n[groups create or acquire tools for code signing the malware, or deobfuscate or decode files](https://attack.mitre.org/techniques/T1553/002/)\nor information by using malware functions or utilities in the system. Both groups also employ\n[masquerading to make features appear benign to security solutions, files or information](https://attack.mitre.org/techniques/T1036/)\nobfuscation to make these files and information difficult to discover, [software packing to](https://attack.mitre.org/techniques/T1027/002/)\n[conceal code, and process injection to evade process-based defense.](https://attack.mitre.org/techniques/T1055/)\n\n\n-----\n\n[Carbanak also performs techniques for disabling security tools,](https://attack.mitre.org/techniques/T1562/001/) [deleting files that are left in](https://attack.mitre.org/techniques/T1070/004/)\nmalicious activity, and [modifying registry to hide configuration information.](https://attack.mitre.org/techniques/T1112/)\n\n[FIN7 utilizes guardrails to restrict execution and abused utilities that allow indirect command](https://attack.mitre.org/techniques/T1480/)\nexecution that can go past security restrictions. The group also evades virtualization and\n[sandboxes and injects malicious code into hollowed processes to dodge process-based](https://attack.mitre.org/techniques/T1055/012/)\ndefenses.\n\n**Credential Access**\n\nSome portions of the system are protected by credentials. To steal these, both groups\n[employed credential dumping and](https://www.youtube.com/watch?v=QqobtIQSP9s) [input capture. The](https://attack.mitre.org/techniques/T1056/) [former involves credentials that are](https://attack.mitre.org/techniques/T1003/)\nusually in the form of hash or clear text, while the latter involves API or web portals.\n\n[Carbanak also performs brute force tactics or takes advantage of credentials that are saved](https://attack.mitre.org/techniques/T1110/)\nin [web browsers.](https://attack.mitre.org/techniques/T1555/003/)\n\nOn the other hand, FIN7 performs hooking.\n\n**Discovery**\n\nFor the discovery phase, the Carbanak and FIN7 campaigns gain more knowledge about the\n[system by gathering listings of various information: open application windows, running](https://attack.mitre.org/techniques/T1010/)\n[processes, IP addresses and other network identifiers in remote systems, detailed hardware](https://attack.mitre.org/techniques/T1057/)\n[and system information,](https://attack.mitre.org/techniques/T1082/) [system network configuration and settings, and](https://attack.mitre.org/techniques/T1016/) system owners and\nusers.\n\n[Carbanak also collects information on accounts,](https://attack.mitre.org/techniques/T1087/) [files and directories,](https://attack.mitre.org/techniques/T1083/) [group permissions, and](https://attack.mitre.org/techniques/T1069/)\n[registries.](https://attack.mitre.org/techniques/T1012/)\n\n[FIN7 gathers information on network shares.](https://attack.mitre.org/techniques/T1135/)\n\nThe gathered information can aid in the next step: lateral movement.\n\n**Lateral Movement**\n\nThe groups move through the network and identify key assets and data by logging in via\n[RDP, copying files to upload adversary tools through remote file copy, and abusing Window](https://attack.mitre.org/techniques/T1021/001/)\nadmin shares.\n\nIn Carbanak attacks, the groups’ attacks can involve logging into services that accept remote\n[connections and using stolen password hashes through the “pass the hash” method.](https://attack.mitre.org/techniques/T1550/002/)\n\n**Collection**\n\n\n-----\n\nAfter moving through the network and identifying assets to target, the next step would be to\ngather key data. At the collection phase, Carbanak and FIN7 campaigns harvest data from\n[local system sources and through input and](https://attack.mitre.org/techniques/T1005/) [screen capture (as performed in a related](https://attack.mitre.org/techniques/T1113/)\n[campaign using the Tirion malware).](https://threatintel.blog/OPBlueRaven-Part1/)\n\nFIN7 attacks can [stage collected data in a particular location in preparation for exfiltration.](https://attack.mitre.org/techniques/T1074/)\n\n**Command and Control**\n\nIn both Carbanak and FIN7 attacks, communication with users’ compromised systems is\n[done through bypassing firewalls or network detection systems via commonly used ports,](https://attack.mitre.org/techniques/T1436/)\nusing [connection proxies to avoid direct connections to the threat group’s infrastructure,](https://attack.mitre.org/techniques/T1090/)\n[employing the command-and-control channel to remotely copy files from an external system,](https://attack.mitre.org/techniques/T1544/)\n[blending in with existing network traffic by using standard application layer protocol, and](https://attack.mitre.org/techniques/T1071/)\n[taking advantage of standard cryptographic protocol to disguise command-and-control traffic.](https://attack.mitre.org/techniques/T1521/)\n\n[Carbanak campaigns can also use legitimate programs and remote access software for](https://attack.mitre.org/techniques/T1219/)\n[command and control. They also employ standard non-application layer protocols for](https://attack.mitre.org/techniques/T1095/)\ncommunication.\n\n**Exfiltration**\n\nIn the final phase of the attack, the groups exfiltrate the stolen data into the normal\n[communications channel via command-and-control channels.](https://attack.mitre.org/techniques/T1041/)\n\n[For FIN7 attack routines, data can be compressed and/or encrypted before being exfiltrated.](https://attack.mitre.org/techniques/T1532/)\n\n[ATT&CK® tactics and techniques for Linux were also shared by MITRE.](https://attackevals.mitre-engenuity.org/enterprise/carbanak_fin7/#technique-scope)\n\nContinuous vigilance against threat groups is an important aspect of keeping up with — if not\n[being one step ahead of — threats. Solutions such as Trend Micro Vision One™ provide](https://www.trendmicro.com/en_us/business/products/detection-response.html)\nvisibility, correlated detection, and behavior monitoring across multiple layers: email,\nendpoints, servers, cloud workloads.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-04-20 - Carbanak and FIN7 Attack Techniques.pdf"
    ],
    "report_names": [
        "2021-04-20 - Carbanak and FIN7 Attack Techniques.pdf"
    ],
    "threat_actors": [
        {
            "id": "c9617bb6-45c8-495e-9759-2177e61a8e91",
            "created_at": "2022-10-25T15:50:23.405039Z",
            "updated_at": "2025-03-27T02:00:55.462193Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Carbanak",
                "Anunak"
            ],
            "source_name": "MITRE:Carbanak",
            "tools": [
                "Carbanak",
                "Mimikatz",
                "PsExec",
                "netsh"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "bfded1cf-be73-44f9-a391-0751c9996f9a",
            "created_at": "2022-10-25T15:50:23.337107Z",
            "updated_at": "2025-03-27T02:00:55.445946Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "FIN7",
                "GOLD NIAGARA",
                "ITG14",
                "Carbon Spider",
                "ELBRUS",
                "Sangria Tempest"
            ],
            "source_name": "MITRE:FIN7",
            "tools": [
                "Mimikatz",
                "AdFind",
                "JSS Loader",
                "HALFBAKED",
                "REvil",
                "PowerSploit",
                "CrackMapExec",
                "Carbanak",
                "Pillowmint",
                "Cobalt Strike",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRat",
                "Lizar",
                "TEXTMATE",
                "BOOSTWRITE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f4f16213-7a22-4527-aecb-b964c64c2c46",
            "created_at": "2024-06-19T02:03:08.090932Z",
            "updated_at": "2025-03-27T02:05:17.387119Z",
            "deleted_at": null,
            "main_name": "GOLD NIAGARA",
            "aliases": [
                "Carbanak",
                "Carbon Spider ",
                "FIN7 ",
                "Navigator ",
                "Sangria Tempest ",
                "TelePort Crew ",
                "Calcium "
            ],
            "source_name": "Secureworks:GOLD NIAGARA",
            "tools": [
                " Carbanak",
                " Cobalt Strike",
                " DICELOADER",
                " DRIFTPIN",
                " GGLDR",
                " GRIFFON",
                " JSSLoader",
                " Meterpreter",
                " OFFTRACK",
                " PILLOWMINT",
                " POWERTRASH",
                " SUPERSOFT",
                " TAKEOUT",
                " TinyMet",
                "Bateleur"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "bb8702c5-52ac-4359-8409-998a7cc3eeaf",
            "created_at": "2023-01-06T13:46:38.405479Z",
            "updated_at": "2025-03-27T02:00:02.82533Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "JokerStash",
                "ATK32",
                "G0046",
                "Coreid",
                "Carbanak",
                "Sangria Tempest",
                "CARBON SPIDER",
                "GOLD NIAGARA",
                "G0008",
                "ELBRUS",
                "Carbon Spider"
            ],
            "source_name": "MISPGALAXY:FIN7",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d85adfe3-e1c3-40b0-b8bb-d1bacadc4d82",
            "created_at": "2022-10-25T16:07:23.619566Z",
            "updated_at": "2025-03-27T02:02:09.890982Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "APT-C-11",
                "ATK 32",
                "Gold Niagara",
                "ITG14",
                "TAG-CR1"
            ],
            "source_name": "ETDA:FIN7",
            "tools": [
                "7Logger",
                "Agentemis",
                "Anunak",
                "Astra",
                "BIOLOAD",
                "BIRDWATCH",
                "Bateleur",
                "Boostwrite",
                "CROWVIEW",
                "Carbanak",
                "Cobalt Strike",
                "CobaltStrike",
                "DICELOADER",
                "DNSMessenger",
                "FOWLGAZE",
                "HALFBAKED",
                "JSSLoader",
                "KillACK",
                "LOADOUT",
                "Lizar",
                "Meterpreter",
                "Mimikatz",
                "POWERPLANT",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "TEXTMATE",
                "Tirion",
                "VB Flash",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "ed3810b7-141a-4ed0-8a01-6a972b80458d",
            "created_at": "2022-10-25T16:07:23.443259Z",
            "updated_at": "2025-03-27T02:02:09.801771Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Anunak",
                "Carbanak",
                "Carbon Spider",
                "ELBRUS",
                "Gold Waterfall",
                "Sangria Tempest"
            ],
            "source_name": "ETDA:Carbanak",
            "tools": [
                "AVE_MARIA",
                "Agentemis",
                "AmmyyRAT",
                "Antak",
                "Anunak",
                "Ave Maria",
                "AveMariaRAT",
                "BABYMETAL",
                "BIRDDOG",
                "Backdoor Batel",
                "Batel",
                "Bateleur",
                "BlackMatter",
                "Boostwrite",
                "Cain & Abel",
                "Carbanak",
                "Cl0p",
                "Cobalt Strike",
                "CobaltStrike",
                "DNSMessenger",
                "DNSRat",
                "DNSbot",
                "DRIFTPIN",
                "DarkSide",
                "FOXGRABBER",
                "FlawedAmmyy",
                "HALFBAKED",
                "JS Flash",
                "KLRD",
                "MBR Eraser",
                "Mimikatz",
                "Nadrac",
                "Odinaff",
                "POWERPIPE",
                "POWERSOURCE",
                "PsExec",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "SocksBot",
                "SoftPerfect Network Scanner",
                "Spy.Agent.ORM",
                "TEXTMATE",
                "TeamViewer",
                "TiniMet",
                "TinyMet",
                "Toshliph",
                "VB Flash",
                "WARPRISM",
                "avemaria",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535590,
    "ts_updated_at": 1743041817,
    "ts_creation_date": 1653753690,
    "ts_modification_date": 1653753690,
    "files": {
        "pdf": "https://archive.orkl.eu/b739a0449f8708bfa457175dd6ad7a75d63c8b90.pdf",
        "text": "https://archive.orkl.eu/b739a0449f8708bfa457175dd6ad7a75d63c8b90.txt",
        "img": "https://archive.orkl.eu/b739a0449f8708bfa457175dd6ad7a75d63c8b90.jpg"
    }
}