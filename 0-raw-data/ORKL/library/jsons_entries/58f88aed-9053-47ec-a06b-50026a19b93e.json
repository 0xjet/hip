{
    "id": "58f88aed-9053-47ec-a06b-50026a19b93e",
    "created_at": "2023-01-12T15:06:59.110968Z",
    "updated_at": "2025-03-27T02:05:33.621212Z",
    "deleted_at": null,
    "sha1_hash": "c5330b32f91dc13173cd86187c5e767c170c7387",
    "title": "2017-06-19 - Erebus Resurfaces as Linux Ransomware",
    "authors": "",
    "file_creation_date": "2022-05-27T22:32:07Z",
    "file_modification_date": "2022-05-27T22:32:07Z",
    "file_size": 158612,
    "plain_text": "# Erebus Resurfaces as Linux Ransomware\n\n**[blog.trendmicro.com/trendlabs-security-intelligence/erebus-resurfaces-as-linux-ransomware/](https://blog.trendmicro.com/trendlabs-security-intelligence/erebus-resurfaces-as-linux-ransomware/)**\n\nRansomware\n\n\nJune 19, 2017\n\n\nOn June 10, South Korean web hosting company NAYANA was hit by Erebus ransomware\n(detected by Trend Micro as RANSOM_ELFEREBUS.A), infecting 153 Linux servers and\nover 3,400 business websites the company hosts.\n\nBy: Ziv Chang, Gilbert Sison, Jeanne Jocson June 19, 2017 Read time: ( words)\n\n_[Updated on June 20, 2017, 12:10 AM PDT to add solution for Deep Security™.](https://blog.trendmicro.com/en_us/business/products/hybrid-cloud/deep-security.html)_\n\n[On June 10, South Korean web hosting company NAYANA was hit by Erebus ransomware](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cyber-attacks/erebus-linux-ransomware-impact-to-servers-and-countermeasures)\n[(detected by Trend Micro as RANSOM_ELFEREBUS.A), infecting 153 Linux servers and](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/RANSOM_ELFEREBUS.A)\nover 3,400 business websites the company hosts.\n\nIn a [notice posted on NAYANA’s website last June 12, the company shared that the attackers](https://www.cnet.com/news/largest-ransomware-ever-demand-south-korea-web-host/)\ndemanded an unprecedented ransom of 550 Bitcoins (BTC), or US$1.62 million, in order to\ndecrypt the affected files from all its servers. In an update on June 14, NAYANA negotiated a\npayment of 397.6 BTC (around $1.01 million as of June 19, 2017) to be paid in installments.\nIn a statement posted on NAYANA’s website on June 17, the second of three payments was\nalready made. On June 18, NAYANA started the process of recovering the servers in\n\n\n-----\n\nbatches. Some of the servers in the second batch are currently experiencing database (DB)\nerrors. A third payment installment is also expected to be paid after the first and second\nbatches of servers have been successfully recovered.\n\nWhile not comparable in terms of the ransom amount, this is reminiscent of what happened\nto [Kansas Hospital, which didn’t get full access to the encrypted files after paying the](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cybercrime-and-digital-threats/kansas-hospital-hit-by-ransomware-extorted-twice)\nransom, but was instead extorted a second time.\n\nErebus was [first seen on September 2016 via malvertisements and reemerged on February](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cybercrime-and-digital-threats/ransomware-recap-sept-23-2016)\n[2017 and used a method that bypasses Windows’ User Account Control. Here are some of](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cybercrime-and-digital-threats/ransomware-recap-january-30-february-15-2017)\nthe notable technical details we’ve uncovered so far about Erebus’ Linux version:\n\n_Figure 1: Erebus has a multilingual ransom note (English shown above)_\n\n_Figure 2: Screenshot of a demo video from the attackers showing how to decrypt the_\n_encrypted files_\n\n**Possible Arrival Vector**\n\nAs for how this Linux ransomware arrives, we can only infer that Erebus may have possibly\nleveraged vulnerabilities or a local Linux exploit. For instance, based on open-source\nintelligence, NAYANA’s website runs on Linux kernel 2.6.24.2, which was compiled back in\n[2008. Security flaws like DIRTY COW that can provide attackers root access to vulnerable](http://blog.trendmicro.com/trendlabs-security-intelligence/new-flavor-dirty-cow-attack-discovered-patched/)\nLinux systems are just some of the threats it may have been exposed to.\n\nAdditionally, NAYANA’s website uses Apache version 1.3.36 and PHP version 5.1.4, both of\n[which were released back in 2006. Apache vulnerabilities and](http://blog.trendmicro.com/trendlabs-security-intelligence/cve-2017-5638-apache-struts-vulnerability-remote-code-execution/) [PHP exploits are well-known;](http://blog.trendmicro.com/trendlabs-security-intelligence/plesk-zero-day-exploit-results-in-compromised-webserver/)\nin fact, there was even a tool sold in the Chinese underground expressly for exploiting\nApache Struts. The version of Apache NAYANA used is run as a user of nobody(uid=99),\nwhich indicates that a local exploit may have also been used in the attack.\n\n_Figure 3: VirusTotal submissions of the Erebus Linux ransomware_\n\nIt’s worth noting that this ransomware is limited in terms of coverage, and is, in fact, heavily\nconcentrated in South Korea. While this may indicate that this ransomware attack is\ntargeted, VirusTotal showed otherwise—several samples were also submitted from Ukraine\nand Romania. These submissions can also indicate they were from other security\nresearchers.\n\n**Encryption Routine**\n\nSome ransomware families are known to scramble files in layers of encryption algorithms,\nsuch as [UIWIX,](http://blog.trendmicro.com/trendlabs-security-intelligence/wannacry-uiwix-ransomware-monero-mining-malware-follow-suit/) [later versions of Cerber, and](http://blog.trendmicro.com/trendlabs-security-intelligence/cerber-ransomware-evolution/) [DMA Locker. Erebus takes this up a notch;](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cybercrime-and-digital-threats/new-ransomware-badblock-and-dma-locker-4-0)\neach file encrypted by Erebus will have this format:\n\n\n-----\n\nHeader (0x438 bytes)\n\nRSA-2048-encrypted original filename\n\nRSA-2048-encrypted AES key\n\nRSA-2048-encrypted RC4 key\n\nRC4-encrypted data\n\nThe file is first scrambled with RC4 encryption in 500kB blocks with randomly generated\nkeys. The RC4 key is then encoded with AES encryption algorithm, which is stored in the file.\nThe AES key is again encrypted using RSA-2048 algorithm that is also stored in the file.\n\nWhile each encrypted file has its RC4 and AES keys, the RSA-2048 public key is shared.\nThese RSA-2048 keys are generated locally, but the private key is encrypted using AES\nencryption and another randomly generated key. Ongoing analysis indicates that decryption\nis not possible without getting hold of the RSA keys.\n\n**Targeted File Types**\n\nOffice documents, databases, archives, and multimedia files are the usual file types targeted\nby ransomware. It’s the same for this version of Erebus, which encrypts 433 file types.\nHowever, the ransomware appears to be coded mainly for targeting and encrypting web\nservers and data stored in them.\n\nHere is a table that shows the directories and system tablespaces that Erebus searches.\nNote that var/www/ is where the files/data of websites are stored, while the ibdata files are\nused in MySQL:\n\n**Included directories:** **Excluded directories:**\n\nvar/www/ $/bin/\n\n**Included files:** $/boot/\n\nibdata0 $/dev/\n\nibdata1 $/etc/\n\nibdata2 $/lib/\n\nibdata3 $/lib64/\n\nibdata4 $/proc/\n\nibdata5 $/run/\n\n\n-----\n\nibdata6 $/sbin/\n\nibdata7 $/srv/\n\nibdata8 $/sys/\n\nibdata9 $/tmp/\n\nib_logfile0 $/usr/\n\nib_logfile1 $/var/\n\nib_logfile2 /.gem/\n\nib_logfile3 /.bundle/\n\nib_logfile4 /.nvm/\n\nib_logfile5 /.npm/\n\n_Figure 4: System tablespaces Erebus searches_\n\n**Adopt Best Practices**\n\n[Despite their market share, Unix and Unix-like operating systems such as Linux are poised](http://blog.trendmicro.com/trendlabs-security-intelligence/unix-a-game-changer-in-the-ransomware-landscape/)\nto be lucrative for bad guys as ransomware continues to diversify and mature in the threat\nlandscape. Why? They are a ubiquitous part of the infrastructures that power many\nenterprises, used by workstations and servers, web and application development\nframeworks, databases, and mobile devices, among others.\n\n[And as we’ve seen in other families like WannaCry,](https://blog.trendmicro.com/en_us/research/17/e/massive-wannacrywcry-ransomware-attack-hits-various-countries.html) [SAMSAM,](http://blog.trendmicro.com/trendlabs-security-intelligence/lesson-patching-rise-samsam-crypto-ransomware/) [Petya, or](http://blog.trendmicro.com/trendlabs-security-intelligence/petya-crypto-ransomware-overwrites-mbr-lock-users-computers/) [HDDCryptor, the](http://blog.trendmicro.com/trendlabs-security-intelligence/bksod-by-ransomware-hddcryptor-uses-commercial-tools-to-encrypt-network-shares-and-lock-hdds/)\ncapability to affect servers and network shares amplifies the impact. A single, vulnerable\nmachine on a network is sometimes all it takes to infect connected systems and servers.\n\nGiven the risks to business operations, reputation, and bottom line, enterprises need to be\nproactive in keeping threats like ransomware at bay. There is no silver bullet to ransomware\nlike Erebus, which is why IT/system administrators should have a defense-in-depth approach\nto security. [Best practices for mitigating ransomware include:](http://blog.trendmicro.com/trendlabs-security-intelligence/ransomware-past-present-future/)\n\n[Backing up critical files](http://blog.trendmicro.com/trendlabs-security-intelligence/world-backup-day-the-3-2-1-rule/)\nDisabling or minimizing third-party or unverified repositories\nApplying the principle of least privilege\n[Ensuring servers and endpoints are updated (or deploying virtual patching)](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/virtualization-and-cloud/virtual-patching-in-mixed-environments-how-it-protects-you/)\n[Regularly monitoring the network](http://blog.trendmicro.com/trendlabs-security-intelligence/network-solutions-ransomware-stopping-containing-spread/)\nInspecting event logs to check for signs of intrusions or infection\n\nSome of the security mechanisms that can be considered are:\n\n\n-----\n\nIP filtering as well as intrusion prevention and detection systems\nSecurity extensions in Linux that manage and limit access to files or system/network\nresources\n[Network segmentation and](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cyber-attacks/protecting-data-through-network-segmentation) [data categorization to curtail and mitigate infection and](http://blog.trendmicro.com/trendlabs-security-intelligence/identifying-and-dividing-networks-and-users/)\nfurther damage to data\nEnabling privilege separation in Linux\n\n_We will update this post as more information from our analysis of this Linux ransomware_\n_become available._\n\n**Trend Micro Solutions**\n\n[Trend Micro™ Deep Security™ stops ransomware from compromising enterprise servers](https://blog.trendmicro.com/en_us/business/products/hybrid-cloud/deep-security.html)\nand workloads–regardless if they’re physical, virtual, in the cloud, or in containers. Deep\nSecurity™ defends against network threats with intrusion prevention (IPS) and host firewall,\nshielding vulnerable servers from attack with a virtual patch until a software patch can be\napplied. Deep Security™ keeps malware, including ransomware, off of servers with\nsophisticated anti-malware and behavioral analysis, ensuring that malicious actions are\nstopped immediately. Deep Security™ also has system security, including application control\nto lock down servers, and integrity monitoring that can detect potential indicators of\ncompromise (IOCs), including ransomware.\n\n[Trend Micro Deep Discovery Inspector™ protects customers from this threat via this DDI](https://blog.trendmicro.com/en_us/business/products/network/advanced-threat-protection/deep-discovery-threat-intelligence-network-analytics.html)\nrule:\n\nDDI Rule ID 2434 – EREBUS - Ransomware - HTTP (Request)\n\n[TippingPoint customers are protected from this threat via this ThreatDV filter:](https://blog.trendmicro.com/en_us/business/products/network/intrusion-prevention/tipping-point-threat-protection-system.html)\n\nThreatDV: 28725: HTTP: Erebus Ransomware Check-in\n\nTrend Micro Deep Security™ protects customers from this threat via this DPI rule:\n\n1008457 - Ransomware Erebus\n\n**Indicators of Compromise**\n\n[SHA256 detected as RANSOM_ELFEREBUS.A:](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/RANSOM_ELFEREBUS.A)\n\n0b7996bca486575be15e68dba7cbd802b1e5f90436ba23f802da66292c8a055f\nd889734783273b7158deeae6cf804a6be99c3a5353d94225a4dbe92caf3a3d48\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-06-19 - Erebus Resurfaces as Linux Ransomware.pdf"
    ],
    "report_names": [
        "2017-06-19 - Erebus Resurfaces as Linux Ransomware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536019,
    "ts_updated_at": 1743041133,
    "ts_creation_date": 1653690727,
    "ts_modification_date": 1653690727,
    "files": {
        "pdf": "https://archive.orkl.eu/c5330b32f91dc13173cd86187c5e767c170c7387.pdf",
        "text": "https://archive.orkl.eu/c5330b32f91dc13173cd86187c5e767c170c7387.txt",
        "img": "https://archive.orkl.eu/c5330b32f91dc13173cd86187c5e767c170c7387.jpg"
    }
}