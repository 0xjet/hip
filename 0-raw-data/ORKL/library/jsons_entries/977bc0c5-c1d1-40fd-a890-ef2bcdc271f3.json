{
    "id": "977bc0c5-c1d1-40fd-a890-ef2bcdc271f3",
    "created_at": "2023-01-12T15:10:56.395813Z",
    "updated_at": "2025-03-27T02:09:29.550894Z",
    "deleted_at": null,
    "sha1_hash": "344104789b8807c01dd792234254b4d191784ed3",
    "title": "2021-09-09 - Mēris botnet, climbing to the record",
    "authors": "",
    "file_creation_date": "2022-05-28T17:47:56Z",
    "file_modification_date": "2022-05-28T17:47:56Z",
    "file_size": 1896243,
    "plain_text": "# Blog — Mēris botnet, climbing to the record\n\n**[blog.qrator.net/en/meris-botnet-climbing-to-the-record_142/](https://blog.qrator.net/en/meris-botnet-climbing-to-the-record_142/)**\n\n_calendar_today Sept. 9, 2021, 9:13 a.m._\n\n[Mēris botnet, climbing to the record](https://blog.qrator.net/en/meris-botnet-climbing-to-the-record_142/)\n[Qrator](https://blog.qrator.net/en/qrator/)\n\n**Introduction**\n\nFor the last five years, there have virtually been almost no global-scale application-layer\nattacks.\n\nDuring this period, the industry has learned how to cope with the high bandwidth network\nlayer attacks, including amplification-based ones. It does not mean that botnets are now\nharmless.\n\nEnd of June 2021, Qrator Labs started to see signs of a new assaulting force on the Internet\n– a botnet of a new kind. That is a joint research we conducted together with Yandex to\nelaborate on the specifics of the DDoS attacks enabler emerging in almost real-time.\n\n**Discovery**\n\nWe see here a pretty substantial attacking force – dozens of thousands of host devices,\ngrowing. Separately, Qrator Labs saw the 30 000 host devices in actual numbers through\nseveral attacks, and Yandex collected the data about 56 000 attacking hosts.\n\n\n-----\n\nHowever, we suppose the number to be higher – probably more than 200 000 devices, due\nto the rotation and absence of will to show the \"full force\" attacking at once. Moreover, all\nthose being highly capable devices, not your typical IoT blinker connected to WiFi – here we\nspeak of a botnet consisting of, with the highest probability, devices connected through the\nEthernet connection – network devices, primarily.\n\nSome people and organizations already called the botnet \"a return of Mirai\", which we do not\nthink to be accurate. Mirai possessed a higher number of compromised devices united under\nC2C, and it attacked mainly with volumetric traffic.\n\nWe have not seen the malicious code, and we are not ready to tell yet if it is somehow\nrelated to the Mirai family or not. We tend to think that it is not, since the devices it unites\nunder one umbrella seems to be related to only one manufacturer – Mikrotik.\n\nAnother reason we wanted to name this particular botnet, operating under elusive C2C, with\na different name – Mēris, which means \"Plague\" in the Latvian language. It seems\nappropriate and relatively close to Mirai in terms of pronunciation.\n\n**Specific features of Mēris botnet:**\n\nSocks4 proxy at the affected device (unconfirmed, although Mikrotik devices use\nsocks4)\n\nUse of [HTTP pipelining (http/1.1) technique for DDoS attacks (confirmed)](https://en.wikipedia.org/wiki/HTTP_pipelining)\n\nMaking the DDoS attacks themselves RPS-based (confirmed)\n\nOpen port 5678 (confirmed)\n\nWe do not know precisely what particular vulnerabilities lead to the situation where Mikrotik\ndevices are being compromised on such a large scale. Several records at the Mikrotik forum\nindicate that its customers experienced hacking attempts on older versions of RouterOS,\nparticularly 6.40.1 from 2017. If this is correct and we see that old vulnerability still being\nactive on thousands of devices being unpatched and unupgraded, this is horrible news.\nHowever, our data with Yandex indicates that this is not true – because the spectrum of\nRouterOS versions we see across this botnet varies from years old to recent. The largest\nshare belongs to the version of firmware previous to the current Stable one.\n\n\n-----\n\nVersion of RouterOS involved in DDoS attacks. 6.48.4 is the current “Stable” version\nIt is also clear that this particular botnet is still growing. There is a suggestion that the botnet\ncould grow in force through password brute-forcing, although we tend to neglect that as a\nslight possibility. That looks like some vulnerability that was either kept secret before the\nmassive campaign's start or sold on the black market.\n\nIt is not our job to investigate the origins, so we must move on with our observations.\n\n[In the last couple of weeks, we have seen devastating attacks towards New Zealand,](https://www.theregister.com/2021/09/03/nz_outage/) United\nStates and [Russia, which we all attribute to this botnet species. Now it can overwhelm](https://tass.com/economy/1333083)\nalmost any infrastructure, including some highly robust networks. All this is due to the\nenormous RPS power that it brings along.\n\nIt's been in the news lately about \"largest DDoS attack on Russian internet and Yandex\", but\nwe at Yandex saw a picture much bigger than that. Cloudflare recorded the first attacks of\nthis type. Their blog post of August 19, 2021, mentioned the attack reaching 17M requests\nper second. We observed similar durations and distributions across countries and reported\nthis information to Cloudflare.\n\n\n-----\n\nRPS graph of a DDoS attack on Yandex, September 5, 2021\nHere is the history of attacks from the same botnet we recorded at Yandex:\n\n2021-08-07 - 5.2 M rps\n\n2021-08-09 - 6.5 M rps\n\n2021-08-29 - 9.6 M rps\n\n2021-08-31 - 10.9 M rps\n\n2021-09-05 - 21.8 M rps\n\nYandex' security team members managed to establish a clear view of the botnet's internal\nstructure. L2TP tunnels are used for internetwork communications. The number of infected\ndevices, according to the botnet internals we’ve seen, reaches 250 000.\n\nHow exactly did Yandex withstand such an enormous amount of requests per second?\n\nAt Yandex, incoming user traffic passes through several infrastructure components,\noperating at different ISO/OSI layers. The first component protects Yandex from SYN flood\nattacks. The following layers analyze incoming traffic in real-time. Based on the technical and\nnetwork statistics, the system evaluates each request for a level of suspicion. Thanks to\nrobust and well-maintained infrastructure, we quickly scaled our components horizontally\nafter the first attack. We were able to cope with the most significant RPS attack in Internet\nhistory without switching to an IP banning mode.\n\n\n-----\n\nThe attacking sources (IP addresses), which are not spoofed, seem to predominantly have\nthe same trait – open ports 2000 and 5678. Of course, many vendors put their services onto\nthose particular ports. However, the specific combination of port 2000 \"Bandwidth test\nserver\" and port 5678 \"Mikrotik Neighbor Discovery Protocol\" makes it almost impossible to\nignore. Although Mikrotik uses UDP for its standard service on port 5678, an open TCP port\nis detected on compromised devices. This kind of disguise might be one of the reasons\ndevices got hacked unnoticed by their owners.\n\nBased on this intel, we decided to probe the TCP port 5678 with the help of Qrator.Radar.\nThe results we have gathered were surprising and frightening at the same time.\n\nDistribution of open ports 5678. The darker the color is - the more there are devices\nIt turns out that there are 328 723 active hosts on the Internet replying to the TCP probe on\nport 5678. Of course, not necessarily each of those is a vulnerable Mikrotik – there is\nevidence that Linksys devices also use TCP service on port 5678. There may be more, but\nat the same time, we have to assume that this number might represent the entire active\nbotnet.\n\n**Country** **Hosts** **% of global**\n\nUnited States of America 139930 42.6%\n\nChina 61994 18.9%\n\nBrazil 9244 2.8%\n\n\n-----\n\nIndonesia 7359 2.2%\n\nIndia 6767 2.1%\n\nHong Kong 5225 1.6%\n\nJapan 4928 1.5%\n\nSweden 4750 1.4%\n\nSouth Africa 4729 1.4%\n\nWhat is important, that an open port 2000 replies to the incoming connection with a\n\\x01\\x00\\x00\\x00 signature, which belongs to the RouterOS protocol. So it is not some\nrandom Bandwidth test server but an identifiable one.\n\nCiting [https://github.com/samm-git/btest-opensource:](https://github.com/samm-git/btest-opensource)\n\n“There is no official protocol description, so everything was obtained using WireShark tool\nand RouterOS 6 running in the virtualbox, which was connecting to the real device.\n\nServer always starts with \"hello\" (01:00:00:00) command after establishing TCP connection\nto port 2000. If UDP protocol is specified in the client TCP connection is still established.”\n\nBased on our observation, 60% of attackers have socks4 open on port 5678, and 90-95%\nhave Bandwidth Test on port 2000.\n\n\n-----\n\nTop countries with Mēris botnet hosts from the record attack on Yandex\nThe exploit of HTTP pipelining (in HTTP 1.1, in HTTP 2.0 it is “multiplexing”) makes\nmitigating such attacks a task that has been long forgotten. Because, first of all, network\ndevices usually stand for legitimate users – one could not be sure if the endpoint is entirely\ncompromised into a “bot zombie”, or there is a part of the bandwidth used in the attack traffic,\nwith the rest being legitimate user traffic. Users that could be registered on a resource they\nare trying to reach.\n\n\n-----\n\nHTTP pipelining, Wikipedia\n\n\nHTTP pipelining, Wikipedia\nIt means that front-end optimization could hurt even more by answering every particular\nnetwork request, as the pipelining is basically about sending requests in batches to the\naimed server, making him answer those trash batches of requests. Furthermore, we are\nspeaking of HTTP requests, which already constitute the most computing power of a server,\nmore so if we are talking about a secured connection, bearing the cryptographic load on top\nof usual requests.\n\nRequests pipelining (in HTTP 1.1) is the primary source of trouble for anyone who meets that\nparticular botnet. Although browsers do not usually use pipelining (except Pale Moon web\nbrowser, [which does that), bots do that. Moreover, it is easy to recognize and mitigate since](https://en.wikipedia.org/wiki/HTTP_pipelining#Implementation_in_web_browsers)\nthe universally accepted TCP sequence is request-response and not the request-requestrequest-response.\n\n\n-----\n\nWhat we see here is a quality vs quantity scenario. Because of the request pipelining\ntechnique, attackers could squeeze much more RPS than botnets usually do. It happened\nbecause traditional mitigation measures would, of course, block the source IP. However,\nsome requests (about 10-20) left in the buffers are processed even after the IP is blocked.\n\n**What to do in such a situation?**\n\nBlacklists are still a thing. Since those attacks are not spoofed, every victim sees the attack\norigin as it is. Blocking it for a while should be enough to thwart the attack and not disturb the\npossible end-user.\n\nAlthough it is, of course, unclear how the C2C owners for the Mēris botnet would act in the\nfuture – they could be taking advantage of the compromised devices, making 100% of its\ncapacity (both bandwidth and processor wise) into their hands.\n\nIn this case, there is no other way other than blocking every consecutive request after the\nfirst one, preventing answering the pipelined requests.\n\nIf there is no DDoS attack mitigation at the targeted server whatsoever, (not only) request\npipelining could turn into a disaster, as the attacker needs much less workforce to fill the\nRPS threshold for the victim. And it turns out that many were not ready for such a scenario.\n\nWe have contacted Mikrotik with the data we have gathered, trying to find a solution, or notify\nthem of our observations, minimally, which we were able to do yesterday.\n\nLast but not least – please, keep your network devices updated with the latest firmware\npossible all the time. It is about each router and modem, every internet-connected device\nand the future of the Internet as a whole. And change your passwords. Nobody knows yet if\nthat’s not the brute force against administration passwords – better be safe, than sorry.\n\n**UPDATE:**\n\n[Mikrotik made an official statement on Mēris botnet, advising a local fix.](https://forum.mikrotik.com/viewtopic.php?f=21&t=178417)\n\nAlso, [Qrator.Radar team made an individual checker, allowing to see if a particular IP](https://radar.qrator.net/)\naddress was involved in the attacks.\n\nGoogle+\n\nTwitter\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-09-09 - Mēris botnet, climbing to the record.pdf"
    ],
    "report_names": [
        "2021-09-09 - Mēris botnet, climbing to the record.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536256,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1653760076,
    "ts_modification_date": 1653760076,
    "files": {
        "pdf": "https://archive.orkl.eu/344104789b8807c01dd792234254b4d191784ed3.pdf",
        "text": "https://archive.orkl.eu/344104789b8807c01dd792234254b4d191784ed3.txt",
        "img": "https://archive.orkl.eu/344104789b8807c01dd792234254b4d191784ed3.jpg"
    }
}