{
    "id": "96bb1f18-1eb4-473e-975d-34e2bad075a6",
    "created_at": "2023-01-12T15:02:59.552537Z",
    "updated_at": "2025-03-27T02:16:16.7992Z",
    "deleted_at": null,
    "sha1_hash": "07b7b0f94e8dfc1f53066d92ab110e2ec7b7c309",
    "title": "2019-03-25 - Operation ShadowHammer",
    "authors": "",
    "file_creation_date": "2022-05-28T02:03:46Z",
    "file_modification_date": "2022-05-28T02:03:46Z",
    "file_size": 275533,
    "plain_text": "# Operation ShadowHammer\n\n**securelist.com/operation-shadowhammer/89992/**\n\nAuthors\n\nGReAT\n\nAMR\n\n[Earlier today, Motherboard published a story by Kim Zetter on Operation ShadowHammer, a newly](https://motherboard.vice.com/en_us/article/pan9wn/hackers-hijacked-asus-software-updates-to-install-backdoors-on-thousands-of-computers)\ndiscovered supply chain attack that leveraged ASUS Live Update software.\n\nWhile the investigation is still in progress and full results and technical paper will be published during SAS\n2019 conference in Singapore, we would like to share some important details about the attack.\n\nIn January 2019, we discovered a sophisticated supply chain attack involving the ASUS Live Update\n**Utility. The attack took place between June and November 2018 and according to our telemetry, it affected**\na large number of users.\n\nASUS Live Update is an utility that is pre-installed on most ASUS computers and is used to automatically\nupdate certain components such as BIOS, UEFI, drivers and applications. According to Gartner, ASUS is\nthe [world’s 5th-largest PC vendor by 2017 unit sales. This makes it an extremely attractive target for APT](https://en.wikipedia.org/wiki/Market_share_of_leading_PC_vendors)\ngroups that might want to take advantage of their userbase.\n\n\n-----\n\nBased on our statistics, over 57,000 Kaspersky users have downloaded and installed the backdoored\n**version of ASUS Live Update at some point in time. We are not able to calculate the total count of affected**\nusers based only on our data; however, we estimate that the real scale of the problem is much bigger and is\npossibly affecting over a million users worldwide.\n\nThe goal of the attack was to surgically target an unknown pool of users, which were identified by\n**their network adapters’ MAC addresses. To achieve this, the attackers had hardcoded a list of MAC**\naddresses in the trojanized samples and this list was used to identify the actual intended targets of this\nmassive operation. We were able to extract more than 600 unique MAC addresses from over 200 samples\nused in this attack. Of course, there might be other samples out there with different MAC addresses in their\nlist.\n\nWe believe this to be a very sophisticated supply chain attack, which matches or even surpasses the\nShadowpad and the [CCleaner incidents in complexity and techniques. The reason that it stayed undetected](https://blog.avast.com/update-to-the-ccleaner-5.33.6162-security-incident)\nfor so long is partly due to the fact that the trojanized updaters were signed with legitimate certificates (eg:\n“ASUSTeK Computer Inc.”). The malicious updaters were hosted on the official liveupdate01s.asus[.]com\nand liveupdate01.asus[.]com ASUS update servers.\n\nDigital signature on a trojanized ASUS Live Update setup installer\n\nCertificate serial number: 05e6a0be5ac359c7ff11f4b467ab20fc\n\nWe have contacted ASUS and informed them about the attack on Jan 31, 2019, supporting their\ninvestigation with IOCs and descriptions of the malware.\n\nAlthough precise attribution is not available at the moment, certain evidence we have collected allows us to\nlink this attack to the ShadowPad incident from 2017. The actor behind the ShadowPad incident has been\n[publicly identified by Microsoft in court documents as BARIUM. BARIUM is an APT actor known to be using](https://www.courthousenews.com/wp-content/uploads/2017/11/barium.pdf)\n\n\n-----\n\n[the Winnti backdoor. Recently, our colleagues from ESET wrote about another supply chain attack in which](https://www.welivesecurity.com/2019/03/11/gaming-industry-scope-attackers-asia/)\nBARIUM was also involved, that we believe is connected to this case as well.\n\nA victim distribution by country for the compromised ASUS Live Updater looks as follows:\n\nIt should be noted that the numbers are also highly influenced by the distribution of Kaspersky users around\nthe world. In principle, the distribution of victims should match the distribution of ASUS users around the\nworld.\n\nWe’ve also created a tool which can be run to determine if your computer has been one of the surgically\nselected targets of this attack. To check this, it compares MAC addresses of all adapters to a list of\npredefined values hardcoded in the malware and alerts if a match was found.\n\n[Download an archive with the tool (.exe)](https://kas.pr/shadowhammer)\n\nAlso, you may [check MAC addresses online. If you discover that you have been targeted by this operation,](https://shadowhammer.kaspersky.com/)\n[please e-mail us at: shadowhammer@kaspersky.com](http://10.10.0.46/mailto:shadowhammer@kaspersky.com)\n\n**IOCs**\n\nKaspersky Lab verdicts for the malware used in this and related attacks:\n\nHEUR:Trojan.Win32.ShadowHammer.gen\n\nDomains and IPs:\n\nasushotfix[.]com\n141.105.71[.]116\n\nSome of the URLs used to distribute the compromised packages:\n\n\n-----\n\nhxxp://liveupdate01.asus[.]com/pub/ASUS/nb/Apps_for_Win8/LiveUpdate/Liveupdate_Test_VER365.zip\nhxxps://liveupdate01s.asus[.]com/pub/ASUS/nb/Apps_for_Win8/LiveUpdate/Liveupdate_Test_VER362.zip\nhxxps://liveupdate01s.asus[.]com/pub/ASUS/nb/Apps_for_Win8/LiveUpdate/Liveupdate_Test_VER360.zip\nhxxps://liveupdate01s.asus[.]com/pub/ASUS/nb/Apps_for_Win8/LiveUpdate/Liveupdate_Test_VER359.zip\n\nHashes (Liveupdate_Test_VER365.zip):\n\naa15eb28292321b586c27d8401703494\nbebb16193e4b80f4bc053e4fa818aa4e2832885392469cd5b8ace5cec7e4ca19\n\nA full set of IOCs and Yara rules is available to customers of Kaspersky Intelligence Reporting service –\ncontact [intelreports@kaspersky.com](http://10.10.0.46/mailto:intelreports@kaspersky.com)\n\nOperation ShadowHammer\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-03-25 - Operation ShadowHammer.pdf"
    ],
    "report_names": [
        "2019-03-25 - Operation ShadowHammer.pdf"
    ],
    "threat_actors": [
        {
            "id": "1c97ccfd-1888-492c-b7b9-bb52c4c3809b",
            "created_at": "2023-01-06T13:46:38.940529Z",
            "updated_at": "2025-03-27T02:00:02.957652Z",
            "deleted_at": null,
            "main_name": "Operation ShadowHammer",
            "aliases": [],
            "source_name": "MISPGALAXY:Operation ShadowHammer",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "49822165-5541-423d-8808-1c0a9448d588",
            "created_at": "2022-10-25T16:07:23.384093Z",
            "updated_at": "2025-03-27T02:02:09.772829Z",
            "deleted_at": null,
            "main_name": "Barium",
            "aliases": [
                "Brass Typhoon",
                "Pigfish"
            ],
            "source_name": "ETDA:Barium",
            "tools": [
                "Agent.dhwf",
                "Agentemis",
                "Barlaiy",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Destroy RAT",
                "DestroyRAT",
                "Kaba",
                "Korplug",
                "POISONPLUG",
                "PlugX",
                "RbDoor",
                "RedDelta",
                "RibDoor",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Winnti",
                "Xamtrav",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c7d9878a-e691-4c6f-81ae-84fb115a1345",
            "created_at": "2022-10-25T16:07:23.359506Z",
            "updated_at": "2025-03-27T02:02:09.752427Z",
            "deleted_at": null,
            "main_name": "APT 41",
            "aliases": [
                "BrazenBamboo",
                "Bronze Atlas",
                "Double Dragon",
                "Earth Baku",
                "Grayfly",
                "Operation ColunmTK",
                "Operation CuckooBees",
                "Operation ShadowHammer",
                "Red Kelpie",
                "SparklingGoblin",
                "TA415",
                "TG-2633"
            ],
            "source_name": "ETDA:APT 41",
            "tools": [
                "9002 RAT",
                "ADORE.XSEC",
                "ASPXSpy",
                "ASPXTool",
                "AceHash",
                "Agent.dhwf",
                "Agentemis",
                "AndroidControl",
                "AngryRebel",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BLUEBEAM",
                "Barlaiy",
                "BlackCoffee",
                "Bladabindi",
                "BleDoor",
                "CCleaner Backdoor",
                "CHINACHOPPER",
                "COLDJAVA",
                "China Chopper",
                "ChyNode",
                "Cobalt Strike",
                "CobaltStrike",
                "Crackshot",
                "CrossWalk",
                "CurveLast",
                "CurveLoad",
                "DAYJOB",
                "DBoxAgent",
                "DEADEYE",
                "DEADEYE.APPEND",
                "DEADEYE.EMBED",
                "DEPLOYLOG",
                "DIRTCLEANER",
                "DUSTTRAP",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "DodgeBox",
                "DragonEgg",
                "ELFSHELF",
                "EasyNight",
                "Farfli",
                "FunnySwitch",
                "Gh0st RAT",
                "Ghost RAT",
                "HDD Rootkit",
                "HDRoot",
                "HKDOOR",
                "HOMEUNIX",
                "HUI Loader",
                "HidraQ",
                "HighNoon",
                "HighNote",
                "Homux",
                "Hydraq",
                "Jorik",
                "Jumpall",
                "KEYPLUG",
                "Kaba",
                "Korplug",
                "LATELUNCH",
                "LOLBAS",
                "LOLBins",
                "LightSpy",
                "Living off the Land",
                "Lowkey",
                "McRAT",
                "MdmBot",
                "MessageTap",
                "Meterpreter",
                "Mimikatz",
                "MoonBounce",
                "MoonWalk",
                "Motnug",
                "Moudour",
                "Mydoor",
                "NTDSDump",
                "PACMAN",
                "PCRat",
                "PINEGROVE",
                "PNGRAT",
                "POISONPLUG",
                "POISONPLUG.SHADOW",
                "POTROAST",
                "PRIVATELOG",
                "PipeMon",
                "PlugX",
                "PortReuse",
                "ProxIP",
                "ROCKBOOT",
                "RbDoor",
                "RedDelta",
                "RedXOR",
                "RibDoor",
                "Roarur",
                "RouterGod",
                "SAGEHIRE",
                "SPARKLOG",
                "SQLULDR2",
                "STASHLOG",
                "SWEETCANDLE",
                "ScrambleCross",
                "Sensocode",
                "SerialVlogger",
                "ShadowHammer",
                "ShadowPad Winnti",
                "SinoChopper",
                "Skip-2.0",
                "SneakCross",
                "Sogu",
                "Speculoos",
                "Spyder",
                "StealthReacher",
                "StealthVector",
                "TERA",
                "TIDYELF",
                "TIGERPLUG",
                "TOMMYGUN",
                "TVT",
                "Thoper",
                "Voldemort",
                "WIDETONE",
                "WINNKIT",
                "WINTERLOVE",
                "Winnti",
                "WyrmSpy",
                "X-Door",
                "XDOOR",
                "XMRig",
                "XShellGhost",
                "Xamtrav",
                "ZXShell",
                "ZoxPNG",
                "certutil",
                "certutil.exe",
                "cobeacon",
                "gresim",
                "njRAT",
                "pwdump",
                "xDll"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4d5f939b-aea9-4a0e-8bff-003079a261ea",
            "created_at": "2023-01-06T13:46:39.04841Z",
            "updated_at": "2025-03-27T02:00:02.985296Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "G0096",
                "Grayfly",
                "BARIUM",
                "BRONZE ATLAS",
                "BRONZE EXPORT",
                "Red Kelpie",
                "HOODOO",
                "Brass Typhoon",
                "TA415",
                "WICKED SPIDER",
                "WICKED PANDA",
                "G0044",
                "Earth Baku"
            ],
            "source_name": "MISPGALAXY:APT41",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e698860d-57e8-4780-b7c3-41e5a8314ec0",
            "created_at": "2022-10-25T15:50:23.287929Z",
            "updated_at": "2025-03-27T02:00:55.43005Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "APT41",
                "Wicked Panda",
                "Brass Typhoon",
                "BARIUM"
            ],
            "source_name": "MITRE:APT41",
            "tools": [
                "ASPXSpy",
                "BITSAdmin",
                "PlugX",
                "Impacket",
                "gh0st RAT",
                "netstat",
                "PowerSploit",
                "ZxShell",
                "KEYPLUG",
                "ipconfig",
                "sqlmap",
                "China Chopper",
                "ShadowPad",
                "MESSAGETAP",
                "Mimikatz",
                "certutil",
                "njRAT",
                "Cobalt Strike",
                "pwdump",
                "BLACKCOFFEE",
                "ROCKBOOT",
                "dsquery",
                "Winnti for Linux",
                "DUSTTRAP",
                "Derusbi",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535779,
    "ts_updated_at": 1743041776,
    "ts_creation_date": 1653703426,
    "ts_modification_date": 1653703426,
    "files": {
        "pdf": "https://archive.orkl.eu/07b7b0f94e8dfc1f53066d92ab110e2ec7b7c309.pdf",
        "text": "https://archive.orkl.eu/07b7b0f94e8dfc1f53066d92ab110e2ec7b7c309.txt",
        "img": "https://archive.orkl.eu/07b7b0f94e8dfc1f53066d92ab110e2ec7b7c309.jpg"
    }
}