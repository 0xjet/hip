{
    "id": "fecd2588-4de5-469e-aa85-bcb418808c33",
    "created_at": "2023-01-12T15:04:20.015439Z",
    "updated_at": "2025-03-27T02:09:30.034865Z",
    "deleted_at": null,
    "sha1_hash": "98df633673044db558e29d3d0af77b300b11790e",
    "title": "2021-06-30 - What to expect when you’ve been hit with REvil ransomware",
    "authors": "",
    "file_creation_date": "2022-05-28T23:50:34Z",
    "file_modification_date": "2022-05-28T23:50:34Z",
    "file_size": 1000716,
    "plain_text": "# What to expect when you’ve been hit with REvil ransomware\n\n**[news.sophos.com/en-us/2021/06/30/what-to-expect-when-youve-been-hit-with-revil-ransomware/](https://news.sophos.com/en-us/2021/06/30/what-to-expect-when-youve-been-hit-with-revil-ransomware/)**\n\nTilly Travers June 30, 2021\n\n[REvil, also known as Sodinokibi, is a widely used, conventional ransomware-as-a-service](https://news.sophos.com/en-us/2021/06/11/relentless-revil-revealed/)\n(RaaS) offering that has been around since 2019. Criminal customers can lease the REvil\nransomware from its developers, adding their own tools and resources for targeting and\nimplementation. As a result, the approach and impact of an attack involving REvil\nransomware is highly variable. This can make it hard for defenders to know what to expect\nand look out for.\n\nThe following information may help IT admins facing or proactively concerned with the\nimpact of a REvil ransomware attack. The findings are based on insights from the Sophos\nRapid Response team, which has investigated multiple cyberattacks involving REvil.\n\n**_Editor’s note: This article is part of a series of “What to expect” guides featuring prevalent_**\n_[ransomware families. Other guides cover Conti ransomware and](https://news.sophos.com/en-us/2021/02/16/what-to-expect-when-youve-been-hit-with-conti-ransomware/)_ _[Avaddon ransomware.](https://news.sophos.com/en-us/2021/05/24/what-to-expect-when-youve-been-hit-with-avaddon-ransomware/)_\n\n## What to do immediately: contain and neutralize\n\n**The first thing you need to do is determine whether the attack is still underway. If you**\nsuspect it is, and you don’t have the tools in place to stop it, determine which devices have\nbeen impacted and isolate them immediately. The easiest option is to simply disconnect from\n\n\n-----\n\nall networks. If the damage is more widespread than a few devices, consider doing this at the\nswitch level and taking entire network segments offline instead of individual devices. Only\nshut down devices if you can’t disconnect the network.\n\n**Second, you need to assess the damage. Which endpoints, servers and operating**\nsystems were affected, what has been lost? Are your backups still intact or has the attacker\ndeleted them? If they are intact, make an offline copy immediately. Also, which machines\nwere protected? They’ll be critical in getting you back on your feet.\n\n**Third, do you have a comprehensive incident response plan in place? If not, you need**\nto identify who should be involved in dealing with this incident. IT admins and senior\nmanagement will be required, but you may also need to bring in outside security experts and\nconsult with cyber insurance and legal counsel. Should you report the incident to law\nenforcement and/or inform data protection authorities? There is also the question of what\ninformation you should give to employees, many of whom are likely to find a similar ransom\nnote on their desktop.\n\n**Last, but definitely not least: you’ll need to contact these and other key people, such**\n**as customers, to let them know what’s happening, but the attackers may be**\n**eavesdropping so don’t use your normal channels of communication. If the intruders**\nhave been in your network for a while, they’ll probably have access to email, for instance.\n\n## What to do next: investigate\n\nOnce you have managed to contain and neutralize the attack, take time to investigate what\nhappened so you can reduce the likelihood of it happening again. If you don’t feel confident\nabout doing this yourself, there is specialist incident response and threat hunting help\n[available 24/7 from security vendors, including Sophos.](https://www.sophos.com/en-us/products/managed-threat-response/rapid-response.aspx)\n\nAccording to the [Sophos Rapid Response team, this is what you can expect from](https://www.sophos.com/en-us/products/managed-threat-response/rapid-response.aspx)\nREvil/Sodinokibi ransomware activity on your network:\n\n1. The attackers have most likely been on your network for a few days or even\n\n**weeks.**\n\nREvil ransomware is operated by human adversaries who have leased the malware from the\ndevelopers, adding their own tools and targets. They take time to prepare attacks that cause\nmaximum disruption, which enables them to charge the multi-million-dollar ransoms REvil is\nknown for.\n\n_Note: Malicious activity can begin before ransomware attackers arrive. Sophos experts_\n_investigating a recent REvil attack found a direct link between an inbound phishing email and_\n_a multi-million-dollar ransom attack two months later. The phishing email, which succeeded_\n_in capturing an employee’s access credentials, probably came from an Initial Access Broker,_\n\n\n-----\n\n_who, a few weeks later, appears to have used PowerSploit and Bloodhound to move through_\n_the breached network to locate high value domain admin credentials. The broker later sold_\n_these credentials to the REvil adversaries so they could breach the target’s network._\n\n1. The attackers may use a variety of different methods to break in your network.\n\nPossible initial access methods for REvil ransomware include, but are not limited to, exploits\nagainst a known vulnerability, for example in a firewall, phishing for user credentials via spam\nemails as mentioned above, brute-force attacks against internet-facing services like Virtual\nPrivate Networks (VPNs), exposed remote desktop protocol (RDP), and desktop remote\nmanagement tools like Virtual Network Computing (VNC), and even some cloud-based\nmanagement systems.\n\n[Sites like Shodan.io provide insight into what an attacker could find out about your network;](https://www.shodan.io/)\ntry using it to search your external IP addresses.\n\n1. They will have secured access to domain admin accounts as well as other user\n\n**accounts.**\n\nAttackers typically compromise multiple accounts during an attack. Their main goal is to get\naccess to domain admin accounts that can be used to launch the ransomware. However,\nthey also target specific admin accounts that have access to sensitive data, backup systems\nand security management consoles.\n\nREvil attackers often use tools like Mimikatz, which can capture information from a running\nMicrosoft LSASS.exe process that contains usernames/password hashes of currently logged\non users. Sometimes attackers will leave this running and then deliberately break something\non the machine that they’ve targeted, provoking an admin to log in to fix it. Attackers can\nthen capture this admin’s credentials.\n\nIf Mimikatz is blocked by security software, the attackers may instead use something like\nMicrosoft Process Monitor to do a memory dump of LSASS.exe and take that dump file back\nto their machine to extract the information with Mimikatz. With Mimikatz, it doesn’t matter\nhow long or complex the passwords are because it is takes them straight out of memory.\n\n1. They will have scanned your network. They know how many servers and\n\n**endpoints you have and where you keep your backups, business-critical data**\n**and applications.**\n\nOne of the first things attackers will do when they get onto a network is identify what access\nthey have on the local machine. The next step is to find out what remote machines exist and\nif they can access them.\n\n\n-----\n\nAttackers use legitimate network scanners like Advanced Port Scanner and Angry IP\nScanner” due to their effectiveness and the fact that they are unlikely to be blocked. These\nscanners will generate a list of IPs and machine names. This makes it easy for attackers to\nfocus on critical infrastructure as most organizations helpfully give their servers descriptive\nnames, for example NY-DC1 for the New York Domain Controller, or maybe even simpler\nnames like “FileServer01,” “Backup_Server,” etc.\n\n1. The attackers are likely to have downloaded and installed backdoors that allow\n\n**them to come and go on your network and install additional tools.**\n\nThey’ll have set up folders and directories to collect and store stolen information and\nchannels for communicating with the attackers and for moving information out of your\nnetwork.\n\nThe backdoors come in a variety of forms. Some just communicate back to the attackers’ IP\naddress, allowing them to send and receive commands to the machine.\n\nMany backdoors are classified as legitimate applications. For example, the attackers might\nuse Remote Administration tools such as RDP to maintain access. Even if RDP is disabled\nby default, it is very easy for an attacker with admin access to the machine to re-enable it.\n\nOther common legitimate tools used are Screen Connect, AnyDesk, TightVNC and PC\nAnywhere. This offers attackers direct control of the machine, including control over the\nmouse/keyboard and the ability to see the screen.\n\n_Note: In one REvil attack that Sophos investigated, the adversaries had installed the Screen_\n_Connect remote access tool onto 130 devices, roughly a third of the network, in order to_\n_maintain access if they were removed or blocked elsewhere._\n\nSome attackers use more advanced tools such as Cobalt Strike, a post-exploitation pentesting tool. Attackers will often try and establish a Cobalt Strike “beacon.” This allows\nregular communication back to the Cobalt Strike server and gives attackers complete control\nof the machine. It can also be used to easily deploy further beacons on other machines\ninside the network.\n\n1. In addition to the encryption of data and disruption to software and operations,\n\n**some REvil operators will try to exfiltrate hundreds of gigabytes of corporate**\n**data prior to the main ransomware event.**\n\nSophos experts have only seen this multi-mode extortion in around half of the\nREvil/Sodinokibi attacks they investigated, but it is still worth being aware of the risk. The\nattackers will generally threaten to publish stolen sensitive data on a so-called “leak site” for\nanybody to download, unless they pay the ransom.\n\n\n-----\n\nOnce a file server is identified, attackers often use a tool called Everything that enables\nvery fast file searching for keywords, such as “account,” “confidential,” “Social Security\nnumber.” After they identify the data, there are numerous methods the attackers can use to\nsteal it.\n\nFor example, they could simply login to an online email service and email it somewhere or\nuse a cloud storage provider like DropBox. Alternatively, they could install an FTP Client like\nFileZilla or Total Commander FTP and upload the data to their server.\n\nAttacker often automate exfiltrating larger amounts of data. For example, they might use a\ntool like RClone. This is a command line tool that connects to a wide variety of cloud storage\nproviders.\n\nIn approximately 75% of the Sophos-investigated REvil ransomware attacks that included\ndata exfiltration used Mega.nz to temporarily store the stolen information. Mega is popular\nwith attackers because it offers extra levels of anonymity. A few simple commands to RClone\nare all attackers need to exfiltrate entire directories to Mega.\n\nSome REvil attackers use other methods, such as installing a portable copy of the FTP client\nFileZilla that they used to upload data to a staging server outside of the target’s network\nperimeter.\n\n1. They will have tried to encrypt, delete, reset, or uninstall your backups.\n\nUnless your backups are stored offline, they are within reach of the attackers. A “backup”\nthat is online and available all the time is just a second copy of the files waiting to be\nencrypted.\n\n1. The attackers will have tried to identify what security solution is used on the\n\n**network and whether they can disable it.**\n\nIt doesn’t matter how good your protection is if the attacker can turn it off or modify its policy.\nREvil attackers have used GMER to try to disable security software. GMER is an anti-rootkit\ntool that is not inherently malicious, although some security technologies will flag it as a\nPotentially Unwanted Application (PUA).\n\nSophos experts have also seen REvil ransomware attackers rebooting the computer into\nSafe Mode before data encryption in order to bypass endpoint protection tools.\n\nAnyone with admin rights can instantly disable free default tools, such as Windows Defender.\nMost modern ransomware attempts to do this by default.\n\nAttackers also try to find and gain access to the management consoles of more advanced\nsecurity solutions in order to disable all protection just before they launch the ransomware.\n\n\n-----\n\nSecurity management consoles hosted locally are especially at risk as attackers could\naccess them with the accounts they have already compromised.\n\n1. The most visible part of the attack – the deployment of ransomware – probably\n\n**took place when no IT admins or security professionals were online to notice**\n**and prevent the lengthy process of file encryption, possibly during the middle of**\n**the night or during the weekend.**\n\n_Note: The encryption process can take hours. An encrypted Windows endpoint will have tens_\n_or hundreds of thousands of encrypted files by the time the ransomware is done. For large_\n_fileservers this could run into the millions. This is why most targeted ransomware attacks are_\n_launched in the middle of the night, over a weekend or on a holiday, when fewer people are_\n_watching._\n\nUp to this point, the attackers have been trying to stay hidden, but here their tactics change.\nThey want you to know they are there and what they have done. They want you to see how\nmuch data has been lost and to understand that someone has done this maliciously and now\nthey want a payment to decrypt the data.\n\nThis is why, in almost all ransomware attacks, encrypted files will have had a new extension\nname appended to the end of the file. For example, “MyReport.docx” might become\n“MyReport.docx.encrypted.” The ransom notes are often displayed prominently in multiple\nplaces, adding to the chaos and stress.\n\n1. The ransomware will have been deployed to all your endpoints and any servers\n\n**that were online at the time of attack – providing that is what the attacker wanted.**\n\nRansomware is “deployed” like a normal application; in most attacks it doesn’t spread\nrandomly in all directions. If your servers were encrypted, but not your endpoints, that is\nbecause the attacker chose to only target your servers.\n\nAttackers deploy ransomware in a variety of ways. One of the most common ways that\nSophos experts have seen is through a combination of batch scripts and the Microsoft\nPsExec tool, a great tool for executing commands on remote machines. An attacker might\ncreate a batch script that loops through a list of your IP addresses, using PsExec to copy the\nransomware to each machine and then execute it.\n\nWhile most security solutions (including Sophos) block PsExec by default, admins often\nauthorize its use on their network because they find it useful too – and unfortunately the\nattackers know this.\n\nAttackers could also create or edit an existing Group Policy Object (GPO) logon script. If you\nfail to spot this, the attack could relaunch every time a machine boots up and connects to the\ndomain. This makes it seem like the ransomware is “spreading” when it is just caused by the\nGPO.\n\n\n-----\n\n1. The launch of the ransomware is not the end.\n\nUsing the various access mechanisms they set up during the preparation stage, the\nattackers will often continue to monitor the situation and even your email communications to\nsee how you respond. An email to the CEO stating you will be OK because they didn’t\nencrypt the backups on Server X, could be a disaster if the attacker read it and still had\naccess to that server.\n\nThe attacker may also wait until you recover to then launch a second attack to really\nemphasize that they can keep doing this until you pay.\n\n1. If the attackers are looking for an additional means of extortion, the time spent in\n\n**your network will likely have allowed the attackers to steal business critical,**\n**sensitive and confidential information that they now threaten to publicly expose.**\n\nSome attackers also apply emotional pressures, with direct employee or business affiliate\nappeals and threats over email and phone.\n\nMost attackers will start publishing stolen data anywhere from a few days to a week after the\nmain attack if no contact from the target is received or negotiations breakdown. However, it\ncould be several weeks or even longer before anything gets published.\n\nFurther, while the attackers may promise to delete your information if you pay, you have no\nguarantees that they will.\n\n## What defenders can do\n\nThere are some proactive steps you can take to enhance your IT security for the future,\nincluding:\n\nMonitor your network security 24/7 and be aware of the five early indicators an attacker\nis present to stop ransomware attacks before they launch\nShut down internet-facing remote desktop protocol (RDP) to deny cybercriminals\naccess to networks. If you need access to RDP, put it behind a VPN or zero-trust\nnetwork access connection and enforce the use of Multi-Factor Authentication (MFA)\nEducate employees on what to look out for in terms of phishing and malicious spam\nand introduce robust security policies\nKeep regular backups of your most important and current data on an offline storage\ndevice. The standard recommendation for backups is to follow the 3-2-1 method: 3\ncopies of the data, using 2 different systems, 1 of which is offline. Also test your ability\nto perform a restore\nPrevent attackers from getting access to and disabling your security: choose a solution\nwith a cloud-hosted management console with multi-factor authentication enabled and\nRole Based Administration to limit access rights\n\n\n-----\n\nRemember, there is no single silver bullet for protection, and a layered, defense-indepth security model is essential – extend it to all endpoints and servers and ensure\nthey can share security-related data\nHave an effective incident response plan in place and update it as needed. If you don’t\nfeel confident you have the skills or resources in place to do this, to monitor threats or\n[to respond to emergency incidents, consider turning to external experts for help](https://www.sophos.com/en-us/products/managed-threat-response/rapid-response.aspx)\n\n_Further advice and technical information related to REvil ransomware can be found in MTR_\n_[in Real Time: Hand-to-Hand Combat with REvil Ransomware Chasing a $2.5 Million Pay](https://news.sophos.com/en-us/2021/06/30/mtr-in-real-time-hand-to-hand-combat-with-revil-ransomware-chasing-a-2-5-million-pay-day/)_\n_[Day,and Relentless REvil, Revealed: RaaS as Variable as the Criminals Who Use It.](https://news.sophos.com/en-us/mtr-in-real-time-hand-to-hand-combat-with-revil-ransomware-chasing-a-2-5-million-pay-day)_\n\n## Conclusion\n\nDealing with a cyberattack is a stressful experience. It can be tempting to clear the\nimmediate threat and close the book on the incident, but the truth is that in doing so you are\nunlikely to have eliminated all traces of the attack. It is important that you take time to identify\nhow the attackers got in, learn from any mistakes and make improvements to your security. If\nyou don’t, you run the risk that the same adversary or another one might attack again in the\nfuture.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-06-30 - What to expect when you’ve been hit with REvil ransomware.pdf"
    ],
    "report_names": [
        "2021-06-30 - What to expect when you’ve been hit with REvil ransomware.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535860,
    "ts_updated_at": 1743041370,
    "ts_creation_date": 1653781834,
    "ts_modification_date": 1653781834,
    "files": {
        "pdf": "https://archive.orkl.eu/98df633673044db558e29d3d0af77b300b11790e.pdf",
        "text": "https://archive.orkl.eu/98df633673044db558e29d3d0af77b300b11790e.txt",
        "img": "https://archive.orkl.eu/98df633673044db558e29d3d0af77b300b11790e.jpg"
    }
}