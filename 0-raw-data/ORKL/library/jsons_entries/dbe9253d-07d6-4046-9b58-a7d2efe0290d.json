{
    "id": "dbe9253d-07d6-4046-9b58-a7d2efe0290d",
    "created_at": "2023-01-12T15:06:40.098943Z",
    "updated_at": "2025-03-27T02:09:29.179576Z",
    "deleted_at": null,
    "sha1_hash": "38baf0099aefa56f75b133b078e46ad8e73c0165",
    "title": "2021-03-19 - REvil ransomware has a new ‘Windows Safe Mode’ encryption mode",
    "authors": "",
    "file_creation_date": "2022-05-27T02:08:17Z",
    "file_modification_date": "2022-05-27T02:08:17Z",
    "file_size": 781136,
    "plain_text": "# REvil ransomware has a new ‘Windows Safe Mode’ encryption mode\n\n**[bleepingcomputer.com/news/security/revil-ransomware-has-a-new-windows-safe-mode-encryption-mode/](https://www.bleepingcomputer.com/news/security/revil-ransomware-has-a-new-windows-safe-mode-encryption-mode/)**\n\nLawrence Abrams\n\nBy\n[Lawrence Abrams](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nMarch 19, 2021\n07:15 AM\n0\n\nThe REvil ransomware operation has added a new ability to encrypt files in Windows Safe\nMode, likely to evade detection by security software and for greater success when\nencrypting files.\n\nWindows Safe Mode is a special startup mode that allows users to run administrative and\ndiagnostic tasks on the operating system. This mode only loads the bare minimum of\nsoftware and drivers required for the operating system to work.\n\nFurthermore, any programs installed in Windows that are configured to start automatically\nwill not start in Safe Mode unless their autorun is configured a certain way.\n\nOne of the ways to create an [autorun in Windows is to create entries under the following](https://www.bleepingcomputer.com/tutorials/windows-program-automatic-startup-locations/)\nRegistry keys:\n\n**HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run**\n\n**HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run**\n\n**HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce**\n\n**HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce**\n\n\n-----\n\nThe Run keys will launch a program every time you log in, while the RunOnce key will\nlaunch a program only once and then remove the entry from the Registry.\n\nFor example, the following Registry key will automatically start the C:\\Users\\test\\test.exe\nprogram when you log in to Windows.\n\n[HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run]\n\"Startup\"=\"C:\\Users\\test\\test.exe\"\n\nHowever, the above autorun will not launch in Safe Mode unless you add an asterisk (*) to\nthe beginning of the value name like the following:\n\n[HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run]\n\"*Startup\"=\"C:\\Users\\test\\test.exe\"\n\n## REvil now includes a 'Safe Mode' mode\n\n[In a new sample of the REvil ransomware discovered by MalwareHunterTeam, a new -](https://twitter.com/malwrhunterteam/status/1372536434125512712)\nsmode command-line argument was added that forces the computer to reboot into Safe\nMode before encrypting a device.\n\nTo do this, REvil will execute the following commands to force the computer to boot into\nSafe Mode with Networking when Windows next restarts.\n```\nbootcfg /raw /a /safeboot:network /id 1\nbcdedit /set {current} safeboot network\n\n```\nIt then creates a 'RunOnce' autorun called '*franceisshit' that executes ' bcdedit\n```\n/deletevalue {current} safeboot ' after the users logs into Safe Mode.\n\n```\n\n-----\n\n**RunOnce entry to delete the**\nFinally, the ransomware performs a forced restart of Windows that cannot be interrupted by\nthe user.\n\nRight before the process exits, it will create an additional RunOnce autorun named\n'AstraZeneca,' possibly about France's recent deliberations about using the vaccine.\n\nThis autorun will relaunch the REvil ransomware without the -smode argument when the\nnext user logs in after the device is rebooted.\n\n\n-----\n\n**AstraZeneca autorun entry**\nIt is important to remember that both of these 'RunOnce' entries will be executed after\nlogging into Safe Mode and will automatically be deleted by Windows.\n\nOn reboot, the device will start up in Safe Mode With Networking, and the user will be\nprompted to log into Windows. Once they login, the REvil ransomware will be executed\nwithout the -smode argument so that it begins to encrypt the files on the device.\n\nWindows will also run the ' bcdedit /deletevalue {current} safeboot ' command\nconfigured by the '*AstraZeneca' Registry key so that the machine can reboot into normal\nmode when the ransomware is finished.\n\nWhile REvil is encrypting files, the Safe Mode screen will be blank, but it is still possible to\nuse Ctrl+Alt+Delete to launch the Windows Task Manager. From there, you can see the\nexecutable running, which in our test is named 'smode.exe,' as shown below.\n\n\n-----\n\n**REvil ransomware running in Safe Mode**\nWhile running, the ransomware will prevent users from launching any programs through\nTask Manager until it finishes encrypting the device.\n\nOnce the device is encrypted, it will allow the rest of the bootup sequence to proceed, and\nthe desktop will be shown with a ransom note and encrypted files.\n\n\n-----\n\n**Device encrypted in Safe Mode**\n\n## Unusual approach\n\nREvil's new Safe Mode operation is a bit strange as it requires users to log in to the device\nafter they restart into Safe Mode.\n\nFurthermore, once they log into Safe Mode, they will be presented with a blank screen, and\nheavy thrashing of drives as the ransomware encrypts the device.\n\nThis behavior could cause users to become instantly suspicious and hibernate or shut down\ntheir computers to be safe.\n\nFor this reason, it is possible that the attackers are manually running the new Safe Mode\ncommand against specific computers, such as virtual machines or servers, that they want to\nencrypt without issues.\n\nRegardless of the reasons, this is another new attack method that security professionals\nand Windows admins need to watch out for as ransomware gangs constantly evolve their\ntactics.\n\nREvil is not the only operation to utilize Safe Mode for encrypting devices.\n\n\n-----\n\n[In 2019, another ransomware known as Snatch also added the ability to encrypt a device](https://www.bleepingcomputer.com/news/security/snatch-ransomware-reboots-to-windows-safe-mode-to-bypass-av-tools/)\nin Safe Mode using a Windows service.\n\n### Related Articles:\n\n[Conti, REvil, LockBit ransomware bugs exploited to block encryption](https://www.bleepingcomputer.com/news/security/conti-revil-lockbit-ransomware-bugs-exploited-to-block-encryption/)\n\n[The Week in Ransomware - May 6th 2022 - An evolving landscape](https://www.bleepingcomputer.com/news/security/the-week-in-ransomware-may-6th-2022-an-evolving-landscape/)\n\n[REvil ransomware returns: New malware sample confirms gang is back](https://www.bleepingcomputer.com/news/security/revil-ransomware-returns-new-malware-sample-confirms-gang-is-back/)\n\n[New Black Basta ransomware springs into action with a dozen breaches](https://www.bleepingcomputer.com/news/security/new-black-basta-ransomware-springs-into-action-with-a-dozen-breaches/)\n\n[REvil's TOR sites come alive to redirect to new ransomware operation](https://www.bleepingcomputer.com/news/security/revils-tor-sites-come-alive-to-redirect-to-new-ransomware-operation/)\n\n[Encryption](https://www.bleepingcomputer.com/tag/encryption/)\n[Ransomware](https://www.bleepingcomputer.com/tag/ransomware/)\n[REvil](https://www.bleepingcomputer.com/tag/revil/)\n[Safe Mode](https://www.bleepingcomputer.com/tag/safe-mode/)\n[Sodinokibi](https://www.bleepingcomputer.com/tag/sodinokibi/)\n[Windows](https://www.bleepingcomputer.com/tag/windows/)\n\n[Lawrence Abrams](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nLawrence Abrams is the owner and Editor in Chief of BleepingComputer.com. Lawrence's\narea of expertise includes Windows, malware removal, and computer forensics. Lawrence\nAbrams is a co-author of the Winternals Defragmentation, Recovery, and Administration\nField Guide and the technical editor for Rootkits for Dummies.\n\n[Previous Article](https://www.bleepingcomputer.com/news/microsoft/mysterious-bug-is-deleting-microsoft-teams-sharepoint-files/)\n[Next Article](https://www.bleepingcomputer.com/news/security/microsoft-defender-adds-automatic-exchange-proxylogon-mitigation/)\n\nPost a Comment [Community Rules](https://www.bleepingcomputer.com/posting-guidelines/)\n\nYou need to login in order to post a comment\n\n[Not a member yet? Register Now](https://www.bleepingcomputer.com/forums/index.php?app=core&module=global&section=register)\n\n### You may also like:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-03-19 - REvil ransomware has a new ‘Windows Safe Mode’ encryption mode.pdf"
    ],
    "report_names": [
        "2021-03-19 - REvil ransomware has a new ‘Windows Safe Mode’ encryption mode.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536000,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1653617297,
    "ts_modification_date": 1653617297,
    "files": {
        "pdf": "https://archive.orkl.eu/38baf0099aefa56f75b133b078e46ad8e73c0165.pdf",
        "text": "https://archive.orkl.eu/38baf0099aefa56f75b133b078e46ad8e73c0165.txt",
        "img": "https://archive.orkl.eu/38baf0099aefa56f75b133b078e46ad8e73c0165.jpg"
    }
}