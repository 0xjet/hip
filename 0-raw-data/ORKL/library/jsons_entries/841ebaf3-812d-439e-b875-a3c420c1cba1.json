{
    "id": "841ebaf3-812d-439e-b875-a3c420c1cba1",
    "created_at": "2023-01-12T15:03:36.766695Z",
    "updated_at": "2025-03-27T02:14:34.226734Z",
    "deleted_at": null,
    "sha1_hash": "c6d3710a0931de503afd4fb4c52f84ae313292eb",
    "title": "2021-06-04 - TeamTNT Actively Enumerating Cloud Environments to Infiltrate Organizations",
    "authors": "",
    "file_creation_date": "2022-05-28T17:48:53Z",
    "file_modification_date": "2022-05-28T17:48:53Z",
    "file_size": 820296,
    "plain_text": "# TeamTNT Actively Enumerating Cloud Environments to Infiltrate Organizations\n\n**unit42.paloaltonetworks.com/teamtnt-operations-cloud-environments/**\n\nNathaniel Quist June 4, 2021\n\nBy [Nathaniel Quist](https://unit42.paloaltonetworks.com/author/nathaniel-quist/)\n\nJune 4, 2021 at 6:00 AM\n\n[Category: Cloud,](https://unit42.paloaltonetworks.com/category/cloud/) [Unit 42](https://unit42.paloaltonetworks.com/category/unit-42/)\n\nTags: [AWS,](https://unit42.paloaltonetworks.com/tag/aws/) [Credential Harvesting,](https://unit42.paloaltonetworks.com/tag/credential-harvesting/) [cryptojacking,](https://unit42.paloaltonetworks.com/tag/cryptojacking/) [Google Cloud,](https://unit42.paloaltonetworks.com/tag/google-cloud/) [IAM,](https://unit42.paloaltonetworks.com/tag/iam/) [scraping,](https://unit42.paloaltonetworks.com/tag/scraping/) [TeamTnT](https://unit42.paloaltonetworks.com/tag/teamtnt/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/teamtnt-operations-cloud-environments/)\n\n## Executive Summary\n\nTeamTNT has been evolving their cloud-focused cryptojacking operations for some time now. TeamTNT operations have targeted\nand, after compromise, [exfiltrated AWS credentials, targeted](https://www.cadosecurity.com/post/team-tnt-the-first-crypto-mining-worm-to-steal-aws-credentials) [Kubernetes clusters and created new malware called Black-T that](https://unit42.paloaltonetworks.com/hildegard-malware-teamtnt/)\n[integrates open source cloud native tools to assist in their cryptojacking operations. TeamTNT operations are now using compromised](https://unit42.paloaltonetworks.com/black-t-cryptojacking-variant/)\nAWS credentials to enumerate AWS cloud environments, via the AWS platform’s API. These actions attempt to identify all Identity\nand Access Management (IAM) permissions, [Elastic Compute Cloud (EC2) instances,](https://docs.aws.amazon.com/cli/latest/reference/ec2/index.html) [Simple Storage Service (S3) buckets,](https://docs.aws.amazon.com/cli/latest/reference/s3/index.html)\n[CloudTrail configurations and CloudFormation operations granted to the compromised AWS credential. TeamTNT operations are now](https://docs.aws.amazon.com/cli/latest/reference/cloudtrail/index.html)\nalso targeting the credentials of 16 additional applications, including those of AWS and Google Cloud credentials, which may be\nstored on the compromised cloud instance, if installed.\n\nThe presence of Google Cloud credentials being targeted for collections represents the first known instance of an attacker group\ntargeting IAM credentials on compromised cloud instances outside of AWS. While it is still possible that Microsoft Azure, Alibaba\nCloud, Oracle Cloud or IBM Cloud IAM credentials could be targeted using similar methods, Unit 42 researchers have yet to find\nevidence of credentials from these cloud service providers (CSPs) being targeted. TeamTNT first started collecting AWS credentials\n[on cloud instances they had compromised as early as August 2020.](https://www.cadosecurity.com/post/team-tnt-the-first-crypto-mining-worm-to-steal-aws-credentials)\n\nIn addition to the targeting of 16 application credentials from cloud applications and platforms, TeamTNT has added the usage of the\n[open-source Kubernetes and cloud penetration toolset Peirates to their reconnaissance operations. With these techniques available,](https://github.com/inguardians/peirates)\nTeamTNT actors are increasingly more capable of gathering enough information in target AWS and Google Cloud environments to\nperform additional post-exploitation operations. This could lead to more cases of lateral movement and potential privilege escalation\nattacks that could ultimately allow TeamTNT actors to acquire administrative access to an organization’s entire cloud environment.\n\nThat said, TeamTNT operations are still focused on cryptojacking. The TeamTNT cryptojacking operations represented within this\nwriting have collected 6.52012192 Monero coins, which at the time of this writing equaled $1,788 USD. The mining operation was\nfound to be operating at an average speed of 77.7KH/s across eight mining workers. Operations using this Monero wallet address\nhave continued for 114 days as of the time of this writing.\n\n[Palo Alto Networks Prisma Cloud customers are protected from these threats through the Runtime Protection feature, Cryptominer](https://www.paloaltonetworks.com/prisma/cloud)\nDetection feature and the Prisma Cloud Compute Kubernetes Compliance Protection, which alerts on an insufficient Kubernetes\nconfiguration and provides secure alternatives. Additionally, Palo Alto Networks [VM-Series and](https://www.paloaltonetworks.com/prisma/vm-series) [CN-Series products offer cloud](https://www.paloaltonetworks.com/network-security/cn-series)\nprotections that can prevent network connections from cloud instances toward known malicious IP addresses and URLs\n\n\n-----\n\n## Enumeration Techniques\n\nUnit 42 researchers identified one of TeamTNT’s malware repositories, hxxp://45.9.148[.]35/chimaera/sh/, which contained several\nbash scripts designed to perform cryptojacking operations, exploitation, lateral movement and credential scraping operations, as\nshown in Figure 1. This malware repository, referred to as the Chimaera Repository, highlights the expanding scope of TeamTNT\noperations within cloud environments as well as a target set for current and future operations.\n\nFigure 1. TeamTNT’s Chimaera Repository.\n\nWithin the Chimaera repository, there were three scripts that specifically highlight TeamTNT’s expanding cloud targeting capabilities\nand intent. The first script is grab_aws-data.sh, (SHA256:\na1e9cd08073e4af3256b31e4b42f3aa69be40862b3988f964e96228f91236593), which focuses on enumerating AWS cloud\nenvironments using known AWS IAM credentials. The second script, bd_aws.sh, (SHA256:\nde3747a880c4b69ecaa92810f4aac20fe5f6d414d9ced29f1f7ebb82cd0f3945) scrapes all known Secure Shell Protocol (SSH) keys\nfrom an AWS instance and identifies all executable programs currently running on that instance. Finally, the script search.sh\n(SHA256: ed40bce040778e2227c869dac59f54c320944e19f77543954f40019e2f2b0c35) performs a search for configuration files\ncontaining application credentials stored on a given host. These scripts are newly discovered and directly highlight the targeting of\ncloud native applications within both AWS and Google Cloud environments.\n\n**Enumerating AWS Environments**\n\n[The bash script, grab_aws-data.sh, contains 70 unique AWS CommandLine Interface (AWS CLI) commands designed to enumerate](https://aws.amazon.com/cli/)\nseven AWS services, [IAM configurations,](https://docs.aws.amazon.com/cli/latest/reference/iam/index.html) [EC2 instances,](https://docs.aws.amazon.com/cli/latest/reference/ec2/index.html) [S3 buckets,](https://docs.aws.amazon.com/cli/latest/reference/s3/index.html) [support cases and](https://docs.aws.amazon.com/cli/latest/reference/support/index.html) [direct connections, in addition to any](https://docs.aws.amazon.com/cli/latest/reference/directconnect/index.html)\n[CloudTrail and](https://docs.aws.amazon.com/cli/latest/reference/cloudtrail/index.html) [CloudFormation operations available to a given AWS IAM credential. As seen in Figure 2, all enumerated values](https://docs.aws.amazon.com/cli/latest/reference/cloudformation/index.html)\nobtained through the AWS enumeration process will be stored within the local directory /var/tmp/.../...TnT.../aws-account-data/ on the\ncompromised system.\n\n\n-----\n\nFigure 2. TeamTNT’s grab_aws.sh\n\nscript.\nNavigate to the Appendix for a list of all 70 unique AWS CLI commands present within the TeamTNT script grab_aws-data.sh. As a\nsummary, the TeamTNT script contained commands for the following seven AWS services:\n\n44 EC2 instance commands.\n14 IAM commands.\n4 Direct Connect commands.\n4 CloudFormation commands.\n2 CloudTrail commands.\n1 S3 command.\n1 Support command.\n\n**Credential Scraping**\n\nTeamTNT actors have also expanded their credential scraping capabilities to include the identification and collection of 16 unique\napplications, which may be present on the compromised cloud endpoint and for any of the known user accounts on the cloud\n[instance, including the root account. There has been additional research involving this particular script. These applications were listed](https://www.trendmicro.com/en_us/research/21/e/teamtnt-extended-credential-harvester-targets-cloud-services-other-software.html)\nwithin the script search.sh:\n\nSSH keys.\nAWS keys.\nDocker.\nGitHub.\nShodan.\nNgrok.\n[Pidgin.](https://developer.pidgin.im/wiki/ConfigurationFiles)\n[Filezilla.](https://filezilla-project.org/)\n[Hexchat.](https://hexchat.github.io/)\nGoogle Cloud.\n[Project Jupyter.](https://jupyter.org/)\nServer Message Block (SMB) clients.\n\nSeveral of these applications are noteworthy. The presence of Google Cloud credentials tops the list as this is the first known instance\nof an attacker group targeting IAM credentials outside of AWS (see Figure 3). It is possible that Microsoft Azure, Alibaba Cloud,\nOracle Cloud or IBM Cloud environments could be targeted using similar techniques, but Unit 42 researchers have yet to find\nevidence of these CSPs being targeted. Researchers believe that it is only a matter of time before TeamTNT will develop functionality\nsimilar to that of grab_aws-data.sh described above, but targeting Google Cloud environments.\n\n\n-----\n\nFigure\n\n3. TeamTNT’s search.sh script searching for Google Cloud credentials.\n\n## Lateral Movement Operations\n\nIn addition to the 16 applications listed above, the following applications are specifically targeted for lateral movement operations.\n\n**Weaveworks**\n\nWithin the search.sh script, there are several applications identified which display evolving attack patterns for TeamTNT operations.\nWithin the Chimaera repository, Unit 42 researchers identified several scripts that single out specific applications. One of those\n[applications is Weaveworks (see Figure 4). Weave is a microservice network mesh application developed for container infrastructures](https://www.weave.works/docs/net/latest/overview/)\nsuch as Docker and Kubernetes, and allows for microservices to be running on one or multiple hosts while simultaneously\nmaintaining network connectivity. By targeting Weave installations, TeamTNT operations have the potential to move laterally within a\ncontainer infrastructure using the Weave network mesh application. As can be seen within the base64 encoded code in the script\nsetup_scope.sh, (SHA256: 584c6efed8bbce5f2c52a52099aafb723268df799f4d464bf5582a9ee83165c1), TeamTNT is targeting\nDocker user accounts that contain Weave container information.\n\nFigure 4.\n\nTeamTNT script setup_scope.sh base64 decode code.\n\nFigure 5. Local\n\nDocker image creation for Monero mining.\n\n**Project Jupyter**\n\n\n-----\n\nAdditionally, the Project Jupyter application is listed as a target of TeamTNT operations through two sources within the Chimaera\nrepository, first within the search.sh script as the target for credential scraping, and as a beta lateral movement script,\nspread_jupyter_tmp.sh (SHA256: 0d7912e62bc663c9ba6bff21ae809e458b227e3ceec0abac105d20d5dc533a22).\n\nUnit 42 researchers also found reference to Project Jupyter within a known TeamTNT actor’s Twitter account. The Twitter account,\n@HildeTnT, posted the following image (Figure 6) on their Twitter feed, replying to a potentially compromised Jupyter endpoint. The\nGerman-language text translates to “Hahaha we take that as a compliment ^^ btw blocking the shell alone brings 0% security …” The\npresence of this Twitter exchange highlights the fact that TeamTNT is actively using the scripts listed within the Chimaera repository\nand targeting these additional cloud applications.\n\nFigure 6. TeamTNT actor replying to a message\n\nfrom a potentially compromised Jupyter endpoint.\n\n## Peirates\n\n[Unit 42 researchers have identified that TeamTNT actors are using the open source container and cloud penetration tool Peirates. As](https://github.com/inguardians/peirates)\nseen in Figure 7, Peirates allows actors to perform several attack functions against AWS and Kubernetes instances. This tool could\nenable TeamTNT actors to investigate and identify misconfigurations or potential vulnerabilities within Kubernetes and Cloud\nenvironments and could allow TeamTNT to perform additional compromising actions against cloud infrastructure.\n\n\n-----\n\nFigure 7. Peirates\n\npenetration testing options.\n\n## Monero Mining Operations\n\nTeamTNT operations are still focused on cryptojacking. The previous sections presented the findings of new techniques used by\nTeamTNT actors to expand their cryptojacking infrastructure. The following section will focus on the findings related to the processes\nof mining applications TeamTNT uses to perform their cryptojacking operations.\n\n**Local Docker Image**\n\nOf interest is the script file docker.container.local.spread.txt, which lists the name of a local Docker image, as shown in Figure 8. The\nDocker image is a local Docker image, meaning it is not hosted and downloaded from an external docker repository such as Docker\nHub. Researchers did search Docker Hub for the presence of this Docker image and none were found.\n\nFigure 8. Contents of the\n\ndocker.container.local.spread.txt.\nThe Docker container is created to provide a host for TeamTNT’s Monero (XMR) mining operation. Shown in Figure 5, a Docker\nimage is created with the name mangletmpuser/fcminer. This image is then started and directed to navigate to the Chimaera\nrepository file setup_xmr.sh, (SHA256: 5ddd226d400cc0b49d0175ba06a7e55cb2f5e9586111464bcf7b3bd709417904), which will\n[initiate the Docker cryptomining process, using the open source XMRig application within a Docker container.](https://github.com/xmrig/xmrig)\n\n**New Monero Wallet**\n\nUnit 42 researchers identified a new Monero wallet address that has never before been witnessed in relation to TeamTNT operations,\n46EPFzvnX5GH61ejkPpNcRNm8kVjs8oHS9VwCkKRCrJX27XEW2y1NPLfSa54DGHxqnKfzDUVW1jzBfekk3hrCVCmAUrFd3H. This\nMonero wallet address was associated with the Monero public mining pool pool.supportxmr[.]com:3333, as shown in Figure 9.\n\nFigure\n\n9. SupportXMR public mining pool configuration.In Figure 10, this mining pool address displays that the TeamTNT mining operation\nhas collected 6.52012192 Monero coins, which at the time of this writing equaled $1,788 USD. The mining operation was found to be\noperating at 77.7KH/s, across eight mining workers at the time of this writing, and operations using this Monero wallet address have\ncontinued for 114 days. At an operating speed of 77.7KH/s, this operation is considered to be a small mining operation for a group like\nTeamTNT.\n\n\n-----\n\nFigure\n\n10. SupportXMR mining pool dashboard.\n\n## Conclusion\n\nGiven TeamTNT’s integration of tools such as Peirates, their targeting of cloud native network mesh applications such as Weave, their\noperations around Kubernetes and Black-T, and their targeting and subsequent taunting of organizations using Project Jupyter,\nTeamTNT actors are suspected to be employing all tools listed within this blog on a regular basis. TeamTNT actors are specifically\ntargeting cloud platforms in an attempt to circumvent future security detection tools and embed themselves into the organization’s\ncloud environment.\n\nWe recommend that organizations operating with cloud environments monitor for and block all network connections associated with\nTeamTNT’s Chimaera repository, as well as historic Command and Control (C2) endpoints. Using a cloud native security platform will\nsignificantly reduce the cloud infrastructure’s attack surface and allow organizations to monitor for risks.\n\nThe following tips are highly recommended by Unit 42 researchers to assist in the protection of cloud infrastructure.\n\nEnforce least-privilege IAM access policies to all cloud IAM roles and permissions. Where applicable, use short-lived or onetime-use IAM credentials for service accounts.\nMonitor and block network traffic to known malicious endpoints.\nOnly deploy vetted container images within production environments.\nImplement and use Infrastructure as Code (IaC) scanning platforms to prevent insecure cloud instances from being deployed\ninto production environments.\nUse cloud infrastructure configuration scanning tools that enable governance, risk management and compliance (GRC) to\nidentify potentially threatening misconfigurations.\nUse cloud endpoint agents to monitor and prevent the running of known malicious applications within cloud infrastructure.\n\n[Palo Alto Networks Prisma Cloud customers are protected from these threats through the Runtime Protection feature, Cryptominer](https://www.paloaltonetworks.com/prisma/cloud)\nDetection feature and the Prisma Cloud Compute Kubernetes Compliance Protection, which alerts on an insufficient Kubernetes\nconfiguration and provides secure alternatives. Additionally, Palo Alto Networks [VM-Series and](https://www.paloaltonetworks.com/prisma/vm-series) [CN-Series products offer cloud](https://www.paloaltonetworks.com/network-security/cn-series)\nprotections that can prevent network connections from cloud instances toward known malicious IP addresses and URLs.\n\n**Indicators of Compromise**\n\nChimaera Repository Files\n\n**SHA256** **File**\n\na698562d56715c138750163c84727a1f2edb9d92f231994abf7ae82ef62006bf chimaera/bin/1.0.4.tar.gz\n\nbcd43d4046c64d15da4e87984306dd14dc80daa904a6477ad2b921c49c2f414d chimaera/bin/64bit/aws_zig\n\n3aae4a2bf41aedaa3b12a2a97398fa89a9818b4bec433c20b4e724505277af83 chimaera/bin/64bit/bob\n\n37ba40494303ff2c671d6806977f655bdc6ae45ad09357214b164fd5328efb31 chimaera/bin/64bit/curl\n\n134e9ab62a8efe80a27e2869bd6e98d0afe635e0e0750eb117ff833dc9447c28 chimaera/bin/64bit/docker-escape\n\n45aabbda369956ff04ba4e6bf345cbaa072d49dd4b90c35c7be8c0c96a115733 chimaera/bin/64bit/hawkeye\n\ne673ef9910a9d6319be598be72430f1b04c299b48e5cd95ce7ccafac273072f3 chimaera/bin/64bit/index html\n\n\n-----\n\naf986793a515d500ab2d35f8d2aecd656e764504b789b66d7e1a0b727a124c44 chimaera/bin/64bit/jq\n\n456041c34e7a992e76320121b7a6b5a47f12b1ed069e1de735543f5b2a1f1a68 chimaera/bin/64bit/pei\n\nbcd43d4046c64d15da4e87984306dd14dc80daa904a6477ad2b921c49c2f414d chimaera/bin/64bit/TNT_AWS\n\nd5063df016a6af531ed4e6dd222ff4dbbb5b3b0c9075ad642e94adde8e481cbe chimaera/bin/64bit/TNT_Kubernetes_e_u\n\n9504b74906cf2c4aba515de463f20c02107a00575658e4637ac838278440d1ae chimaera/bin/64bit/TNT_MassPwn\n\n229d6e173f22a647c8db9c8e7d0b21c8f86dd4e270abb96548aa40d84457c99a chimaera/bin/64bit/wget.rpm\n\n15f8cf9c0ed9891f20be37130c1d0e30946e4e14e00a1b2824da22c6c94b8fe3 chimaera/bin/64bit/wget.rpm.tar.gz\n\nefdf041abcb93f97a3b46624d18d1c8153711f939298c46a4a48388e7ec1bd1e chimaera/bin/64bit/xmr\n\nee7799a42c2f487df7405d0aac06496c9a5bb58daecfb135f6f58e3b3aeedf69 chimaera/bin/64bit/xmr.xz\n\n900b17ae0081052fb63a7d74232048cfbc2716cdedbe0ab14cf64b7d387d4329 chimaera/bin/64bit/xmrig\n\n84078b10ad532834eb771231a068862182efb93ce1e4a8614dfca5ae3229ed94 chimaera/bin/64bit/xmrig_ps_e\n\n825c60dd1bb32cd6b7e6686f425c461532093b1e9f6ca662c1ea9b07ec7e470b chimaera/bin/64bit/xmrig-6.8.1-linux-static-x64.tar.gz\n\n99211429717c686167c1bcda6c5e55dc0e45f46bfdfe34f3bb272ce1378a47a3 chimaera/bin/64bit/zgrab\n\n8373c0e8abdd962f46d3808fb10589e4961e38cd96d68a4464d1811788a4f2b7 chimaera/bin/64bit/zmap\n\n73a4e43a50c533dffdce6575a630be808780d1b408a6dda335106de0c48926ac chimaera/bin/aarch64/bob\n\n24c75a2f86d3c0f13f77b453d476787607a87c1033dca501351846524a4e8ff6 chimaera/bin/aarch64/index.html\n\ne842c810b6ecb9c7634f1cfbf81b6245094528ac5584179eb8e6932eaa34f421 chimaera/bin/aarch64/traitor\n\n1e565e0672c4cd60b7db32c0ecc1abace6dfd8b6c2e0623c949d31536940fd62 chimaera/bin/aarch64/zgrab\n\n12466d33f1d0e9114b4c20e14d51ca3e7e374b866c57adb6ba5dfef3ee34ee5b chimaera/bin/irc_bot.c\n\n2287e71c5707ebb2885cd6afd0bff401e4465ca59c8c2498439859e6c8ec5175 chimaera/bin/mass.tar\n\nb6ddd29b0f74c8cfbe429320e7f83427f8db67e829164b67b73ebbdcd75d162d chimaera/bin/p.tar\n\n2f4ffa0e687b4e18e45770812a14ad4fc1ae3f735b4f8280f0dd241e045838fe chimaera/bin/pnscan_1.12+git20180612.orig.tar.gz\n\nbf9b11b764f63c32fd333cc3916c97490fb06f4dbcff8ae87dfee098eca1e854 chimaera/bin/rpm_deb_apk/i368-coreutils.deb\n\n5f1c9e8dc98ff3e7cf32096225cbae96dacead6af82986d69bbc0032d0e8da84 chimaera/bin/rpm_deb_apk/i386-curl\n\n3d2481edc5fe122bae2fe316d803e131837606e38a7a3158f7cddc7b436dc6c2 chimaera/bin/rpm_deb_apk/setup_apps.sh\n\nf26f805c3a1c01ab4717cc3b4c91581249482b00bd29712ab0c36ba7ce74147c chimaera/bin/x86_64/bob\n\n0cdad862a1a695fe9cbf35592f92111e31ac848881fcd1deaa3c6ecd7c241ad7 chimaera/bin/x86_64/bot\n\n456041c34e7a992e76320121b7a6b5a47f12b1ed069e1de735543f5b2a1f1a68 chimaera/bin/x86_64/pei\n\nd2fff992e40ce18ff81b9a92fa1cb93a56fb5a82c1cc428204552d8dfa1bc04f chimaera/bin/x86_64/tmate\n\n3cb401fdba1a0e74389ac9998005805f1d3e8ed70018d282f5885410d48725e1 chimaera/bin/x86_64/traitor\n\n84078b10ad532834eb771231a068862182efb93ce1e4a8614dfca5ae3229ed94 chimaera/bin/x86_64/xmrig\n\n4e4e01830dc64466683735d32778d17cfbffc7be75d647322240ecf9e2f9d700 chimaera/bin/x86_64/zgrab\n\n900b17ae0081052fb63a7d74232048cfbc2716cdedbe0ab14cf64b7d387d4329 chimaera/bin/xmr/xmrig_u\n\n11b45924f96844764c7ae56ce0b6ac3c43d3a732bc7101d7ce85ea52d0455afd chimaera/bin/xmrig\n\n825c60dd1bb32cd6b7e6686f425c461532093b1e9f6ca662c1ea9b07ec7e470b chimaera/bin/xmrig-6.8.1-linux-static-x64.tar.gz\n\nacea877b5e4eb9a4f89c0607872bd718e818775dd70044ba6bcede26b481d079 chimaera/data/docker.container.local.spread.txt\n\nd4084c84b21a24ec7a75b1700c65835edea55ac146e86f874941f9ea4bc30ecd chimaera/init.sh\n\n\n-----\n\n43545f6cd370e6f200347bd9bbafdc3d94240775d816cd5e24dc8072d0f1c9b5 chimaera/pl/scan.pl\n\n55a53f325a46f0da8a15ce001595b9d27eeb03262a62c40f169a3c855c5e8319 chimaera/py/punk.base64.txt\n\nc2491f9b1f6eb9b1b31e84b0dd5505c5959947c47230af97dce18a49aab90e6b chimaera/py/punk.py\n\nde3747a880c4b69ecaa92810f4aac20fe5f6d414d9ced29f1f7ebb82cd0f3945 chimaera/sh/bd_aws.sh\n\n5265a344fd3d3c91d1e9169678e9dadf6296331ccf91132b99c728761bffb011 chimaera/sh/clean_aegis.sh\n\n0a8499cebddd96af4634e85be50e4f64c9d2c7c616677de171df99691239526b chimaera/sh/clean_crontab.sh\n\n881530fb9634cbf5cf12080f5d13e69cb9497c7ea223a4ac29e0d3c81de3053a chimaera/sh/clean_docker.sh\n\n5f845e765947c4568e1c201fdfeb016c19c940ca2f1636d1393a65a9ee367e8c chimaera/sh/clean_quartz.sh\n\n44cbddf5092818092439734cd478a0fd80f93949e4fec32553b78064029266af chimaera/sh/clean_tmp.sh\n\nd708b28231ef70edc707d3cfc1f9ed72aa06a6db15b7903a22b2cdba435e41f7 chimaera/sh/clean_v2.sh\n\n1946ddf0ade98a69650cdf5c6951d26abbb2ddb5224ea95279e1372a772a0f9c chimaera/sh/clean.sh\n\nb1f38b8648351bb7c743eed838658ea38975db40358c2af62d4e36905555a332 chimaera/sh/first_touch.sh\n\na1e9cd08073e4af3256b31e4b42f3aa69be40862b3988f964e96228f91236593 chimaera/sh/grab_aws-data.sh\n\n4e059d74e599757226f93ea8ddcfb794d4bcda605f0e553fbbef47b8b7c82d2b chimaera/sh/init.sh\n\n484d09b34cb7fb075647402b52f174b2645c6b2c7e8b271e648421893aacdfb4 chimaera/sh/kube.lateral.sh\n\n49b185d1a03124fd5f664fe908fe833d932124344216535b822a044e9d115234 chimaera/sh/lateral/_sort.sh\n\ned40bce040778e2227c869dac59f54c320944e19f77543954f40019e2f2b0c35 chimaera/sh/search.sh\n\n4a6a31b867ce9033691a6638997b0e46d89462d677e9a1f7d757e9f2efbd4c79 chimaera/sh/setup_bot.sh\n\ne9a58f006e5335d806da5fc772fb2b5dedcd977d6484f462169f7a64a636fb44 chimaera/sh/setup_crontab.sh\n\n61e94f41187a3ce31fd8ac0ae3798aaa0e8984e8ff76debe623e41fecf8d7a12 chimaera/sh/setup_hide.sh\n\n7270416ff49d679f123f560f135b25afe1754a370b0a4bf99368f1ebbc86cbb1 chimaera/sh/setup_mo.sh\n\n584c6efed8bbce5f2c52a52099aafb723268df799f4d464bf5582a9ee83165c1 chimaera/sh/setup_scope.sh\n\nec92f9a98e2c5449693792aa7fd77d0c7a5a98af13b0595ad3c46da739c44c80 chimaera/sh/setup_tmate.sh\n\n642551b7f4e088797cd37b19280261668c8b381dcf667ea7d0dafed1ec94e460 chimaera/sh/setup_unhide.sh\n\n5ddd226d400cc0b49d0175ba06a7e55cb2f5e9586111464bcf7b3bd709417904 chimaera/sh/setup_xmr.sh\n\n57689b87b6830411046d7bda19936707a0797bec9dffe03874d1a364c4f29c35 chimaera/sh/setup_xmr2.sh\n\nf9b5bd4372daf78346e4bb34677633a7795876a3c89c5965eb76f137a0fba448 chimaera/sh/setup_zmap_zgrab_jq_masscan.sh\n\nf194d5901d64811c72a2cf3a035b7c36ea36d444ea6291f64138d1e88929349d chimaera/sh/setup.sh\n\n30e35e225f23495f92c417337d205056c4fd2f8dd9e958365e84b522c3adc851 chimaera/sh/spread_docker_local.sh\n\n2e34f88bacc50e0ec06681d6857163b99046fec775a75297f774edd1f6b452c1 chimaera/sh/spread_docker_loop.sh\n\n0d7912e62bc663c9ba6bff21ae809e458b227e3ceec0abac105d20d5dc533a22 chimaera/sh/spread_jupyter_tmp.sh\n\n5ac76e1edfda445548c35364ba0c3dbb0bcb8a0236c303d2a4e2a94a7073a716 chimaera/sh/spread_kube_local.sh\n\n3ae9e772a025d192a689358e263445a8d953e090b1bbe62f83567034938e75b5 chimaera/sh/spread_kube_loop.sh\n\n9c7f2644e02cb48ab5ff17d541c07f11fd85e5e13cdc210faf34994771a4ca29 chimaera/sh/spread_ssh.sh\n\nfece70a9f33c2ed77a5833dba5b7188d5ec00a30fb00e43983e6939cac87fb99 chimaera/sh/xmr.sh.sh\n\n5bb45f372fb4df6a9c6a5460fa1845f5e96af53aa41939eb251cbe989a5cac6c chimaera/so/systemd.so\n\ne8cd937239d6bf43cb34c7947321a197b0d1067f05c3b21508bffa35a953a3c3 chimaera/so/tmate.so\n\n\n-----\n\n0af1b8cd042b6e2972c8ef43d98c0a0642047ec89493d315909629bcf185dffd chimaera/so/xmrig.so\n\n3b14c84525f2e56fe3ae7dec09163a4a9c03f11e6a8d65b021c792ad13ed2701 chimaera/spread/redis/b.sh\n\ndc8e4e45a46a65e70e3d67315ca76127b20ef4dcda2fd012a826b73ee26ab941 chimaera/up/aws_in.php\n\n6175648ebbe658e3d5984d5c45d5221bf8f8875599d9ce2d62d279b7bba5eeea chimaera/up/grabbed_data.php\n\ne6e1656ac258318e8226db00dbacdf6914f2dac2d174b1470903b096b7fbecff chimaera/up/tmate_in.php\n\n9cd9549e8b80ee3230bdb1130676ac2396de5e99428b45f14d93b705b157465a chimaera/up/working_tmp_dir/results_kubernetes.txt\n\n79c7a022d2c807dea005fb5c0433eb984eea053d07123754acd864bede03be00 chimaera/working.txt\n\nMonero Wallet\n\n46EPFzvnX5GH61ejkPpNcRNm8kVjs8oHS9VwCkKRCrJX27XEW2y1NPLfSa54DGHxqnKfzDUVW1jzBfekk3hrCVCmAUrFd3H\n\nURL Address\n\n45.9.148[.]35/chimaera/bin/\n\n45.9.148[.]35/chimaera/data/\n\n45.9.148[.]35/chimaera/init/\n\n45.9.148[.]35/chimaera/pl/\n\n45.9.148[.]35/chimaera/py/\n\n45.9.148[.]35/chimaera/sh/\n\n45.9.148[.]35/chimaera/spread/\n\n45.9.148[.]35/chimaera/up/\n\npool.supportxmr[.]com\n\nAppendix\n\n**IAM command** **AWS Link** **Function Description**\n\n\naws iam get-accountauthorization-details\n\naws iam get-accountpassword-policy\n\naws iam get-accountsummary\n\naws iam list-accountaliases\n\n\nget-account[authorization-](https://docs.aws.amazon.com/cli/latest/reference/iam/get-account-authorization-details.html)\ndetails\n\nget-accountpassword-policy\n\nget-accountsummary\n\nlist-accountaliases\n\n\nRetrieves information about all IAM users, groups, roles and policies in your AWS\naccount, including their relationships to one another.\n\nRetrieves the password policy for the AWS account.\n\nRetrieves information about IAM entity usage and IAM quotas in the AWS account.\n\nLists the account alias associated with the AWS account. (Note: You can have only\none.)\n\n\naws iam list-groups [list-groups](https://docs.aws.amazon.com/cli/latest/reference/iam/list-groups.html) Lists the IAM groups that have the specified path prefix.\n\n\naws iam list-instanceprofiles\n\naws iam list-open-idconnect-providers\n\n\nlist-instanceprofiles\n\nlist-open-id[connect-](https://docs.aws.amazon.com/cli/latest/reference/iam/list-open-id-connect-providers.html)\nproviders\n\n\nLists the instance profiles that have the specified path prefix.\n\nLists information about the IAM OpenID Connect (OIDC) provider resource objects\ndefined in the AWS account.\n\n\naws iam list-policies [list-policies](https://docs.aws.amazon.com/cli/latest/reference/iam/list-policies.html) Lists all the managed policies that are available in your AWS account, including your\nown customer-defined managed policies and all AWS managed policies.\n\naws iam list-roles [list-roles](https://docs.aws.amazon.com/cli/latest/reference/iam/list-roles.html) Lists the IAM roles that have the specified path prefix.\n\n\naws iam list-samlproviders\n\n\nlist-samlproviders\n\n\nLists the SAML provider resource objects defined in IAM in the account.\n\n\n-----\n\naws iam list-servercertificates\n\n\nlist-servercertificates\n\n\nLists the server certificates stored in IAM that have the specified path prefix.\n\n\naws iam list-users [list-users](https://docs.aws.amazon.com/cli/latest/reference/iam/list-users.html) Lists the IAM users that have the specified path prefix.\n\n\naws iam list-virtualmfa-devices\n\naws iam getcredential-report\n\n\nlist-virtual-mfadevices\n\nget-credentialreport\n\n\nLists the virtual MFA devices defined in the AWS account by assignment status.\n\nRetrieves a credential report for the AWS account.\n\n\n_Table 1. Enumerating AWS IAM configurations._\n\n**IAM command** **AWS Link** **Function Description**\n\n\naws ec2 describe-accountattributes\n\naws ec2 describeaddresses\n\naws ec2 describe-bundletasks\n\naws ec2 describe-classiclink-instances\n\naws ec2 describeconversion-tasks\n\naws ec2 describecustomer-gateways\n\naws ec2 describe-dhcpoptions\n\naws ec2 describe-exporttasks\n\n\ndescribe-accountattributes\n\n\n[describe-dhcp-options](https://docs.aws.amazon.com/cli/latest/reference/ec2/describe-dhcp-options.html) Describes one or more of your DHCP options sets.\n\n[describe-export-tasks](https://docs.aws.amazon.com/cli/latest/reference/ec2/describe-export-tasks.html) Describes the specified export instance tasks or all of your export instance\ntasks.\n\n\nDescribes attributes of your AWS account.\n\n\n[describe-addresses](https://docs.aws.amazon.com/cli/latest/reference/ec2/describe-addresses.html) Describes the specified Elastic IP addresses or all of your Elastic IP\naddresses.\n\n[describe-bundle-tasks](https://docs.aws.amazon.com/cli/latest/reference/ec2/describe-bundle-tasks.html) Describes the specified bundle tasks or all of your bundle tasks.\n\n\ndescribe-classic-linkinstances\n\ndescribe-conversiontasks\n\ndescribe-customergateways\n\n\nDescribes one or more of your linked EC2-Classic instances.\n\nDescribes the specified conversion tasks or all your conversion tasks.\n\nDescribes one or more of your VPN customer gateways.\n\n\naws ec2 describe-flow-logs [describe-flow-logs](https://docs.aws.amazon.com/cli/latest/reference/ec2/describe-flow-logs.html) Describes one or more flow logs.\n\n\naws ec2 describe-hostreservations\n\n\ndescribe-hostreservations\n\n\nDescribes reservations that are associated with Dedicated Hosts in your\naccount.\n\n\naws ec2 describe-hosts [describe-hosts](https://docs.aws.amazon.com/cli/latest/reference/ec2/describe-hosts.html) Describes the specified Dedicated Hosts or all your Dedicated Hosts.\n\naws ec2 describe-images [describe-images](https://docs.aws.amazon.com/cli/latest/reference/ec2/describe-images.html) Describes the specified images (AMIs, AKIs and ARIs) available to you or all\nof the images available to you.\n\n\naws ec2 describe-importimage-tasks\n\naws ec2 describe-importsnapshot-tasks\n\naws ec2 describe-instancestatus\n\naws ec2 describeinstances\n\naws ec2 describe-internetgateways\n\n\ndescribe-importimage-tasks\n\ndescribe-importsnapshot-tasks\n\ndescribe-instancestatus\n\n\ndescribe-internetgateways\n\n\nDescribes an import image task.\n\nDescribes your import snapshot tasks.\n\nDescribes the status of the specified instances or all of your instances.\n\n\n[describe-instances](https://docs.aws.amazon.com/cli/latest/reference/ec2/describe-instances.html) Describes the specified instances or all instances.\n\n\nDescribes one or more of your internet gateways.\n\n\naws ec2 describe-key-pairs [describe-key-pairs](https://docs.aws.amazon.com/cli/latest/reference/ec2/describe-key-pairs.html) Describes the specified key pairs or all of your key pairs.\n\n\naws ec2 describe-movingaddresses\n\naws ec2 describe-natgateways\n\naws ec2 describe-networkacls\n\n\ndescribe-movingaddresses\n\ndescribe-natgateways\n\n\nDescribes your Elastic IP addresses that are being moved to the EC2-VPC\nplatform, or that are being restored to the EC2-Classic platform.\n\nDescribes one or more of your NAT gateways.\n\n\n[describe-network-acls](https://docs.aws.amazon.com/cli/latest/reference/ec2/describe-network-acls.html) Describes one or more of your network ACLs.\n\n\n-----\n\naws ec2 describe-networkinterfaces\n\naws ec2 describeplacement-groups\n\naws ec2 describereserved-instances\n\naws ec2 describereserved-instances-listings\n\naws ec2 describereserved-instancesmodifications\n\naws ec2 describe-routetables\n\naws ec2 describescheduled-instances\n\naws ec2 describe-securitygroups\n\naws ec2 describesnapshots\n\naws ec2 describe-spotdatafeed-subscription\n\naws ec2 describe-spotfleet-requests\n\naws ec2 describe-spotinstance-requests\n\n\ndescribe-networkinterfaces\n\ndescribe-placementgroups\n\ndescribe-reservedinstances\n\ndescribe-reservedinstances-listings\n\ndescribe-reserved[instances-](https://docs.aws.amazon.com/cli/latest/reference/ec2/describe-reserved-instances-modifications.html)\nmodifications\n\n\ndescribe-spotdatafeed-subscription\n\ndescribe-spot-fleetrequests\n\ndescribe-spotinstance-requests\n\n\nDescribes one or more of your network interfaces.\n\nDescribes the specified placement groups or all of your placement groups.\n\nDescribes one or more of the Reserved Instances that you purchased.\n\nDescribes your account's Reserved Instance listings in the Reserved\nInstance Marketplace.\n\nDescribes the modifications made to your Reserved Instances.\n\n\n[describe-route-tables](https://docs.aws.amazon.com/cli/latest/reference/ec2/describe-route-tables.html) Describes one or more of your route tables.\n\n\ndescribe-scheduledinstances\n\ndescribe-securitygroups\n\n\nDescribes the specified Scheduled Instances or all your Scheduled\nInstances.\n\nDescribes the specified security groups or all of your security groups.\n\n\n[describe-snapshots](https://docs.aws.amazon.com/cli/latest/reference/ec2/describe-snapshots.html) Describes the specified EBS snapshots available to you or all of the EBS\nsnapshots available to you.\n\n\nDescribes the data feed for Spot Instances.\n\nDescribes your Spot Fleet requests.\n\nDescribes the specified Spot Instance requests.\n\n\naws ec2 describe-subnets [describe-subnets](https://docs.aws.amazon.com/cli/latest/reference/ec2/describe-subnets.html) Describes one or more of your subnets.\n\naws ec2 describe-tags [describe-tags](https://docs.aws.amazon.com/cli/latest/reference/ec2/describe-tags.html) Describes the specified tags for your EC2 resources.\n\n\naws ec2 describe-volumestatus\n\n\ndescribe-volumestatus\n\n\nDescribes the status of the specified volumes.\n\n\naws ec2 describe-volumes [describe-volumes](https://docs.aws.amazon.com/cli/latest/reference/ec2/describe-volumes.html) Describes the specified EBS volumes or all of your EBS volumes.\n\n\naws ec2 describe-vpcclassic-link\n\naws ec2 describe-vpcclassic-link-dns-support\n\naws ec2 describe-vpcendpoints\n\naws ec2 describe-vpcpeering-connections\n\n\ndescribe-vpc-classiclink\n\ndescribe-vpc-classiclink-dns-support\n\ndescribe-vpcendpoints\n\ndescribe-vpc-peeringconnections\n\n\nDescribes the ClassicLink status of one or more VPCs.\n\nDescribes the ClassicLink DNS support status of one or more VPCs.\n\nDescribes one or more of your VPC endpoints.\n\nDescribes one or more of your VPC peering connections.\n\n\naws ec2 describe-vpcs [describe-vpcs](https://docs.aws.amazon.com/cli/latest/reference/ec2/describe-vpcs.html) Describes one or more of your VPCs.\n\n\naws ec2 describe-vpnconnections\n\naws ec2 describe-vpngateways\n\n\ndescribe-vpnconnections\n\ndescribe-vpngateways\n\n\nDescribes one or more of your VPN connections.\n\nDescribes one or more of your virtual private gateways.\n\n\n_Table 2. Enumeration Amazon EC2 instances._\n\n**IAM command** **AWS Link** **Function Description**\n\naws s3 ls [ls](https://docs.aws.amazon.com/cli/latest/reference/s3/ls.html) List S3 objects and common prefixes under a prefix or all S3 buckets.\n\n_Table 3. Enumerating available Amazon S3 buckets_\n\n\n-----\n\n**IAM command** **AWS Link** **Function Description**\n\n\naws support describe-cases --includeresolved-cases\n\n_Table 4. Enumerating open AWS support cases._\n\n\ndescribecases\n\n\nLists the interconnects owned by the AWS account or only the\nspecified interconnect.\n\n\n**IAM command** **AWS Link** **Function Description**\n\n\naws directconnect describeconnections\n\naws directconnect describeinterconnects\n\naws directconnect describe-virtualgateways\n\naws directconnect describe-virtualinterfaces\n\n\ndescribeconnections\n\ndescribeinterconnects\n\ndescribe-virtualgateways\n\ndescribe-virtualinterfaces\n\n\nDisplays the specified connection or all connections in this Region.\n\nLists the interconnects owned by the AWS account or only the\nspecified interconnect.\n\nLists the virtual private gateways owned by the AWS account.\n\nDisplays all virtual interfaces for an AWS account.\n\n\n_Table 5. Enumerating available AWS network connections._\n\n**IAM command** **AWS Link** **Function Description**\n\n\naws cloudtrail describetrails\n\naws cloudtrail listpublic-keys\n\n\ndescribetrails\n\nlist-publickeys\n\n\nRetrieves settings for one or more trails associated with the current region for your\naccount.\n\nReturns all public keys whose private keys were used to sign the digest files within the\nspecified time range.\n\n\n_Table 6. Enumerating AWS CloudTrail operations._\n\n**IAM command** **AWS Link** **Function Description**\n\n\naws cloudformation\ndescribe-account-limits\n\naws cloudformation\ndescribe-stacks\n\naws cloudformation listexports\n\naws cloudformation liststacks\n\n\ndescribeaccount-limits\n\ndescribestacks\n\n\n[list-exports](https://docs.aws.amazon.com/cli/latest/reference/cloudformation/list-exports.html) Lists all exported output values in the account and Region in which you call this\naction.\n\n[list-stacks](https://docs.aws.amazon.com/cli/latest/reference/cloudformation/list-stacks.html) Returns the summary information for stacks whose status matches the specified\nStackStatusFilter.\n\n\nRetrieves your account's AWS CloudFormation limits, such as the maximum number\nof stacks that you can create in your account.\n\nReturns the description for the specified stack. If no stack name was specified, then it\nreturns the description for all the stacks created.\n\n\n_Table 7. Enumerating AWS CloudFormation operations._\n\n**Get updates from**\n\n**Palo Alto**\n\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy Statement.](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-06-04 - TeamTNT Actively Enumerating Cloud Environments to Infiltrate Organizations.pdf"
    ],
    "report_names": [
        "2021-06-04 - TeamTNT Actively Enumerating Cloud Environments to Infiltrate Organizations.pdf"
    ],
    "threat_actors": [
        {
            "id": "81dde5cc-c29f-430d-8c6e-e5e92d5015e7",
            "created_at": "2022-10-25T16:07:23.704358Z",
            "updated_at": "2025-03-27T02:02:09.932453Z",
            "deleted_at": null,
            "main_name": "Harvester",
            "aliases": [],
            "source_name": "ETDA:Harvester",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "Graphon",
                "Metasploit",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f809bfcb-b200-4988-80a8-be78ef6a52ef",
            "created_at": "2023-01-06T13:46:39.186988Z",
            "updated_at": "2025-03-27T02:00:03.016358Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "Adept Libra"
            ],
            "source_name": "MISPGALAXY:TeamTNT",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c3ca592f-0669-49bd-ab5c-310007ab2fb4",
            "created_at": "2022-10-25T15:50:23.334495Z",
            "updated_at": "2025-03-27T02:00:55.445098Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "TeamTNT"
            ],
            "source_name": "MITRE:TeamTNT",
            "tools": [
                "Peirates",
                "MimiPenguin",
                "LaZagne",
                "Hildegard"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3fff98c9-ad02-401d-9d4b-f78b5b634f31",
            "created_at": "2023-01-06T13:46:38.376868Z",
            "updated_at": "2025-03-27T02:00:02.818071Z",
            "deleted_at": null,
            "main_name": "Cleaver",
            "aliases": [
                "Cobalt Gypsy",
                "G0003",
                "Operation Cleaver",
                "Op Cleaver",
                "Tarh Andishan",
                "Alibaba",
                "TG-2889"
            ],
            "source_name": "MISPGALAXY:Cleaver",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535816,
    "ts_updated_at": 1743041674,
    "ts_creation_date": 1653760133,
    "ts_modification_date": 1653760133,
    "files": {
        "pdf": "https://archive.orkl.eu/c6d3710a0931de503afd4fb4c52f84ae313292eb.pdf",
        "text": "https://archive.orkl.eu/c6d3710a0931de503afd4fb4c52f84ae313292eb.txt",
        "img": "https://archive.orkl.eu/c6d3710a0931de503afd4fb4c52f84ae313292eb.jpg"
    }
}