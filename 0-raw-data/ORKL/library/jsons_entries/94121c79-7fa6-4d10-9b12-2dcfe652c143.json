{
    "id": "94121c79-7fa6-4d10-9b12-2dcfe652c143",
    "created_at": "2023-01-12T15:10:16.502604Z",
    "updated_at": "2025-03-27T02:15:38.185087Z",
    "deleted_at": null,
    "sha1_hash": "b869f313bb3900846eeaa2f4551fbf4f6c7ae7eb",
    "title": "2019-05-16 - The Stealthy Email Stealer in the TA505 Arsenal",
    "authors": "",
    "file_creation_date": "2022-05-28T15:43:22Z",
    "file_modification_date": "2022-05-28T15:43:22Z",
    "file_size": 322048,
    "plain_text": "# The Stealthy Email Stealer in the TA505 Arsenal\n\n**[blog.yoroi.company/research/the-stealthy-email-stealer-in-the-ta505-arsenal/](https://blog.yoroi.company/research/the-stealthy-email-stealer-in-the-ta505-arsenal/)**\n\n05/16/2019\n\n## Introduction\n\n\nMay 16, 2019\n\n\nDuring the last month our Threat Intelligence surveillance team spotted increasing evidence\nof an operation intensification against the Banking sector. In fact, many independent\nresearchers pointed to a particular email attack wave probably related to the known TA505\nhacking group, active since 2014 and focusing on Retail and Banking companies. The group\nis also known for some evasive techniques they put in place over time to avoid the security\ncontrols and penetrate corporate perimeters with several kinds of malware, for instance\nabusing the so called LOLBins (Living Off The Land Binaries), legit programs regularly used\nby victim, or also the abuse of valid cryptographically signed payloads.\n\n\n-----\n\nFigure 1. Attack campaign spotted in the wild.\n\nInvestigating and tracking their operations during April and May we detected an interesting\ntool was delivered through the victim machine. Just after the opening of malicious documents\nand the installation of FlawedAmmy RAT implants, the group used to deploy a particular\ncredential stealing software, part of their arsenal, revealing details of their recent operation.\n\nFigure 2. Attack campaign spotted in the wild.\n\n## Technical Analysis\n\nThe piece of malware under analysis were downloaded from “bullettruth[.com/out[.exe”, it\nwas executed into the victim machines after the establishment of the infection.\n\n**Sha256** f3e8f68c31c86d431adea1633c875c32434a42aee5ed70af74af5c5e5aa58883\n\n**Threat** Custom Email Stealer\n\n\n**Brief**\n**Description**\n\n\nExecutable of the email stealer\n\n\n**Ssdeep** 12288:tlICpzmDFPJ+d7SQX5PsTrKjL43vNa77pu:XI+mDFx+d7vcrKv43X\n\n\n-----\n\nFigure 3: Malware Signature by SLON LTD\n\nFirstly, we noticed this secondary component was well protected against antivirus detection,\nin fact the PE file was signed by Sectigo in the first half of May, one of the major Russian\nCertification Authority. Analyzing the trust chain we found the attackers were relying on\ncryptographic keys released to a UK company named SLON LTD. At this time, we have no\nevidence to hypothesize it could be victim of previous hacks or not.\n\nAnyway, a static inspection of the binary revealed that the malware has a quite high entropy\nlevel, suggesting it may be packed.\n\nFigure 4: Malware suspicious entropy level\nDynamically executing the malware, more information about its behaviour is revealed. The\nmalicious executable is substantially an email stealer, in fact, the only purpose is to retrieve\nall the emails and passwords accounts present inside the victim machine. After executing the\ninformation gathering routine, the malware sends to its C2 all the retrieved emails and\npasswords:\n\nFigure 5: HTTP POST communication\nThe interesting thing about the communication with the C2 is the fact that there is no\nencryption: the data harvested are sent to the C2 in JSON format. Investigating the attacker\ninfrastructure we noticed interesting information such as the information of the stolen emails\nthrough our Digital Surveillance systems.\n\nIn order to retrieve more details about this Email Stealer, the analysis has moved into\ndebugging and disassembling. As previously mentioned, the malware sample is heavily\nobfuscated and packed. However, by letting the malware execute itself within a debugger, we\nwere able to extract the unpacked payload of the malware.\n\nFigure 6: Static information about the packed sample (on the left) and the unpacked one (on\nthe right)\n\n\n-----\n\nAs shown by the above figure, we notice a peculiarity of these two components: while the\npacked sample is compiled in Microsoft Visual C++ version 6.0, the unpacked one is\ncompiled in Microsoft Visual C++ version 8. At this point, we deepen the analysis on the\nextracted payload. However, we are not able to execute it, because it always references\nmany memory addresses of the original one. So, we carry on static analysis on the extracted\nsample.\n\nAs previously described, the malware’s principal purpose is to iterate through the filesystem\nlooking for email accounts.. The first step is to check whether the “outlook.exe” process is\nrunning and, in this case it kills the process.The malware iterate through user processes with\n_Process32FirstW API and then kill it with TerminateProcess:_\n\nFigure 7: Outlook process search routine\nThe extracted payload does not present any type of code obfuscation of other types. In fact\nthe C2 server and the path is not encoded:\n\nFigure 8: C2 connection routine\nThe last routine being analyzed is the credential harvesting inside the entire filesystem.\n\nApart from the routine that searches for the email account registered in Outlook and\nThunderbird clients (as shown in Figure 7), there is another one which scans the filesystem\nlooking for hardcoded extensions, then, if one of them is found, a reference to the found file\nis conserved inside the %TEMP% directory. At this point, all the gathered email accounts are\nsent to the server and then erasing all traces of itself from the infected machine, in fact, the\nmalware creates a simple batch script which delete itself and all the tracks of infection.\n\nFigure 9: Autodeletion batch script\n\n### Analysis of Exposed Emails\n\nIn this paragraph are shown some statistics about the harvested emails in the attack\ncampaign, recovered during surveillance and hunting operations. So we decided to create a\ngraph in which sort the most frequent TLD occurrences of all the stolen data.\n\nFigure 10: Distribution of TLD\n\nAs seen in the graph above, the most frequent TLD is .com with 193.194 occurrences,\nfollowing .kr with 102.025 occurrences, .cn with 26.160 occurrences, it with 6.317\noccurrences and so on. To better visualize the macro-locations involved in this exposure we\nbuilt a heatmap showing the geographical distribution of the TOP 100 countries referenced in\nthe TLDs.\n\n\n-----\n\nFigure 11: Geolocation of emails TLD exposure\nThe heatmap shows the less-affected countries with a greenish color, on the contrary, the\nmost-affected ones tend to an orange or red-tinged color. The first thing that emerges from\nthese 2 distributions is that this specific threat seems not to be targeted, in fact, the diffusion\nis almost global with some red or orange zones in UK, Italy, Republic of Korea, China,\nGermany, Hungary, Taiwan, Japan, India and Mexico. All these countries exceeded the\nthousand occurrences.\n\n## Conclusion\n\nNowadays, the email accounts are an effective source of revenue for the cyber criminals. In\nfact all these information can be used to spread other malware through phishing campaigns,\nto perform BEC attacks (Business Email Compromise) and also to try credential stuffing\nattacks.\n\nEvan a simple Info-Stealer malware like this one could be a dangerous threat, especially if\nused by organized groups in conjunction with other malware implants. In fact, as reported by\n[the independent researcher Germán Fernández Bacian too, this Email Stealer has been](https://medium.com/@1ZRR4H/ta505-intensifica-ciberataques-a-chile-y-latinoam%C3%A9rica-con-flawedammy-9fb92c2f0552)\nrecently used by the infamous TA505 hacking group. This link means, with good confidence,\nthe exposed data, full email accounts in some cases and email contacts in general, are now\navailable to a cyber-criminal group who launched targeted attacks against Banks and Retail\nindustries in the near past.\n\n## Indicators of Compromise\n\nDropurl:\n\nbullettruth[.com/out[.exe\n\n\n-----\n\nC2:\n\nnettubex[.top/es/es[.php\n178.48.154.38\n5.253.53.236\n87.241.136.1\n197.255.225.249\n95.140.195.178\n186.74.208.84\n86.61.75.99\n86.101.230.109\n89.47.94.113\n130.204.181.90\n78.90.243.124\nHash:\n\n104dae7457c10b7fe6c42a335f2a57ff708ff20d70597fbaa5fe0083c1c628c7\ne4b40cba02dc1de1a1c2ed2001d39a87c476c11ca08f09a80fd3f1fbaae0daeb\nf3e8f68c31c86d431adea1633c875c32434a42aee5ed70af74af5c5e5aa58883\n899bfac53c3439a7ea68f9a5bbff2733ebf7b9158f18ef5d03360a09b18b5e0d\n\n### Yara Rules\n```\nimport \"pe\"\nrule EmailStealer_201905 {\nmeta:\n     description = \"Yara rule for EmailStealer\"\n     author = \"Cybaze - Yoroi ZLab\"\n     last_updated = \"2019-05-14\"\n     tlp = \"white\"\n     category = \"informational\"\nstrings:\n     $a1 = { 80 F2 F3 00 56 53 A7 }\n     $a2 = { 4D 26 9A 00 56 4B AC 55 } \n     $a3 = { 1C 4A 77 00 00 89 B4 B7 }\ncondition:\n     uint16(0) == 0x5A4D and pe.number_of_sections == 3 and all of them\n}\n\n Searched Extensions\n\n```\n\n-----\n\n```\n.msf; .dat; .pst; .ost; .asp; .cdd; .cpp; .doc; .docm; .docx; .dot; .dotm; .dotx;\n.epub; .fb2; .gpx; .ibooks; .indd; .kdc; .key; .kml; .mdb; .mdf; .mobi; .mso; .ods;\n.odt; .one; .oxps; .pages; .pdf; .pkg; .pl; .pot; .potm; .potx; .pps; .ppsm; .ppsx;\n.ppt; .pptm; .pptx; .ps; .pub; .rtf; .sdf; .sgml; .sldm; .snb; .wpd; .wps; .xar;\n.xlr; .xls; .xlsb; .xlsm; .xlsx; .xlt; .xltm; .xltx; .xps; .3dm; .aspx; .cer; .cfm;\n.chm; .crdownload; .csr; .css; .download; .eml; .flv; .htaccess; .htm; .html; .jnlp;\n.js; .jsp; .magnet; .mht; .mhtm; .mhtml; .msg; .php; .prf; .rss; .srt; .stl; .swf;\n.torrent; .url; .vcf; .webarchive; .webloc; .xhtml; .xul; .asf; .asm; .cgi; .class;\n.cs; .dtd; .fla; .ged; .gv; .icl; .java; .jse; .json; .lua; .mb; .mod; .msp; .obj;\n.po; .ps1; .py; .sh; .sln; .so; .sql; .ts; .vbe; .vbs; .vc4; .vcproj; .vcxproj; .wsc;\n.xcodeproj; .xsd; .apt; .err; .log; .pwi; .sub; .ttf; .tex; .text; .txt; .accdb; .b2;\n.crypt; .crypt5; .crypt6; .crypt7; .crypt8; .crypt12; .db; .dbf; .dbx; .sis; .awb;\n.bin; .cdi; .cdr; .csv; .eap; .efx; .gam; .gbr; .gtp; .mpp; .msc; .mts; .otf; .nbk;\n.nbp; .ndb; .prj; .rtp; .sav; .scppy; .tax2010; .tbl; .tmp; .vcd; .xml; .xsl; .xslt;\n.bak; .dmp; .gho; .ghs; .v2i; .zip; .asx; .iff; .inf; .temp; .ai; .aif; .amr; .apk;\n.bp1; .ccd; .cdw; .dds; .dmg; .dxf; .ext; .ics; .ini; .m4p; .max; .md0; .mng; .mp3;\n.mpa; .msu; .nrg; .pak; .part; .pkpass; .psd; .rnd; .rom; .spl; .swb; .svg; .xla;\n.application; .appref; .cfg; .conf; .config; .cpl; .cue; .deskthemepack; .diagcfg;\n.ds_store; .iso; .pdi; .plist; .reg; .scr; .theme; .themepack; .thm\n\n```\n_This blog post was authored by Luigi Martire, Davide Testa, Antonio Pirozzi and Luca Mella_\n_of Cybaze-Yoroi Z-LAB_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-05-16 - The Stealthy Email Stealer in the TA505 Arsenal.pdf"
    ],
    "report_names": [
        "2019-05-16 - The Stealthy Email Stealer in the TA505 Arsenal.pdf"
    ],
    "threat_actors": [
        {
            "id": "99cb4e5b-8071-4f9e-aa1d-45bfbb6197e3",
            "created_at": "2023-01-06T13:46:38.860754Z",
            "updated_at": "2025-03-27T02:00:02.937438Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "SectorJ04 Group",
                "Dudear",
                "G0092",
                "ATK103",
                "Hive0065",
                "Spandex Tempest",
                "GRACEFUL SPIDER",
                "GOLD TAHOE",
                "CHIMBORAZO",
                "SectorJ04"
            ],
            "source_name": "MISPGALAXY:TA505",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5e6b31a6-80e3-4e7d-8b0a-d94897ce9b59",
            "created_at": "2024-06-19T02:03:08.128175Z",
            "updated_at": "2025-03-27T02:05:17.400394Z",
            "deleted_at": null,
            "main_name": "GOLD TAHOE",
            "aliases": [
                "SectorJ04 ",
                "Spandex Tempest ",
                "TA505 ",
                "FIN11 "
            ],
            "source_name": "Secureworks:GOLD TAHOE",
            "tools": [
                " Cobalt Strike",
                " FlawedAmmy",
                " Get2",
                " GraceWire",
                " Malichus",
                " SDBbot",
                " ServHelper",
                " TrueBot",
                "Clop"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75d4d6a9-b5d1-4087-a7a0-e4a9587c45f4",
            "created_at": "2022-10-25T15:50:23.5188Z",
            "updated_at": "2025-03-27T02:00:55.489882Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "TA505",
                "Hive0065",
                "Spandex Tempest",
                "CHIMBORAZO"
            ],
            "source_name": "MITRE:TA505",
            "tools": [
                "AdFind",
                "Azorult",
                "FlawedAmmyy",
                "Mimikatz",
                "Dridex",
                "TrickBot",
                "Get2",
                "FlawedGrace",
                "Cobalt Strike",
                "ServHelper",
                "Amadey",
                "SDBbot",
                "PowerSploit"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e447d393-c259-46e2-9932-19be2ba67149",
            "created_at": "2022-10-25T16:07:24.28282Z",
            "updated_at": "2025-03-27T02:02:10.159466Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "ATK 103",
                "Chimborazo",
                "Gold Evergreen",
                "Gold Tahoe",
                "Graceful Spider",
                "Hive0065",
                "Operation Tovar",
                "Operation Trident Breach",
                "SectorJ04",
                "Spandex Tempest",
                "TA505",
                "TEMP.Warlock"
            ],
            "source_name": "ETDA:TA505",
            "tools": [
                "Amadey",
                "AmmyyRAT",
                "AndroMut",
                "Azer",
                "Bart",
                "Bugat v5",
                "CryptFile2",
                "CryptoLocker",
                "CryptoMix",
                "CryptoShield",
                "Dridex",
                "Dudear",
                "EmailStealer",
                "FRIENDSPEAK",
                "Fake Globe",
                "Fareit",
                "FlawedAmmyy",
                "FlawedGrace",
                "FlowerPippi",
                "GOZ",
                "GameOver Zeus",
                "GazGolder",
                "Gelup",
                "Get2",
                "GetandGo",
                "GlobeImposter",
                "Gorhax",
                "GraceWire",
                "Gussdoor",
                "Jaff",
                "Kasidet",
                "Kegotip",
                "Kneber",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Locky",
                "MINEBRIDGE",
                "MINEBRIDGE RAT",
                "MirrorBlast",
                "Neutrino Bot",
                "Neutrino Exploit Kit",
                "P2P Zeus",
                "Peer-to-Peer Zeus",
                "Philadelphia",
                "Philadephia Ransom",
                "Pony Loader",
                "Rakhni",
                "ReflectiveGnome",
                "Remote Manipulator System",
                "RockLoader",
                "RuRAT",
                "SDBbot",
                "ServHelper",
                "Shifu",
                "Siplog",
                "TeslaGun",
                "TiniMet",
                "TinyMet",
                "Trojan.Zbot",
                "Wsnpoem",
                "Zbot",
                "Zeta",
                "ZeuS",
                "Zeus"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536216,
    "ts_updated_at": 1743041738,
    "ts_creation_date": 1653752602,
    "ts_modification_date": 1653752602,
    "files": {
        "pdf": "https://archive.orkl.eu/b869f313bb3900846eeaa2f4551fbf4f6c7ae7eb.pdf",
        "text": "https://archive.orkl.eu/b869f313bb3900846eeaa2f4551fbf4f6c7ae7eb.txt",
        "img": "https://archive.orkl.eu/b869f313bb3900846eeaa2f4551fbf4f6c7ae7eb.jpg"
    }
}