{
    "id": "b333bf3a-f10f-496f-934f-3c20c7687bfe",
    "created_at": "2023-01-12T15:09:17.989412Z",
    "updated_at": "2025-03-27T02:09:38.769074Z",
    "deleted_at": null,
    "sha1_hash": "0180cdeebfa399c7ae5fdfd9d798ece82736195c",
    "title": "2016-06-21 - The Curious Case of an Unknown Trojan Targeting German-Speaking Users",
    "authors": "",
    "file_creation_date": "0001-01-01T00:00:00Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 314818,
    "plain_text": "Search\n\n\n[MAIN INDEX](http://www.f-secure.com/weblog/)\n[ARCHIVES](http://www.f-secure.com/weblog/archives/)\n[ABOUT US](http://www.f-secure.com/weblog/archives/aboutus.htm)\n\n[F-SECURE LABS](http://www.f-secure.com/en/web/labs_global/)\n[SUBMIT SAMPLES](https://analysis.f-secure.com/portal/login.html)\n\n[SAFE AND SAVVY](http://safeandsavvy.f-secure.com/)\n[TWITTER/F-](http://www.twitter.com/FSecure)\nSECURE\n[@FSLABS](http://twitter.com/5ean5ullivan/labs)\n[@5EAN5ULLIVAN](http://twitter.com/5ean5ullivan)\n[@MIKKO](http://twitter.com/mikko)\n[FACEBOOK](http://www.facebook.com/FSecure)\n[YOUTUBE/FSLABS](http://www.youtube.com/fslabs)\n[YOUTUBE/FSNEWS](http://www.youtube.com/fsecurenews)\n\n[TRY F-SECURE](http://www.f-secure.com/en/web/home_global/internet-security)\n\n\n[<<<](http://www.f-secure.com/weblog/archives/00002717.html) Monday, June 23, 2014 [>>>](http://www.f-secure.com/weblog/archives/00002719.html)\n\n**[Havex Hunts For ICS/SCADA Systems](http://www.f-secure.com/weblog/archives/00002718.html)** Posted by Daavid @ 14:46 GMT\n\nDuring the past year, we've been keeping a close eye on the Havex malware family and the group behind it. Havex is\n[known to be used in targeted attacks against different industry sectors, and it was earlier reported to have specific interest in](http://www.crowdstrike.com/sites/all/themes/crowdstrike2/css/imgs/platform/CrowdStrike_Global_Threat_Report_2013.pdf)\nthe energy sector.\n\nThe main components of Havex are a general purpose Remote Access Trojan (RAT) and a server written in PHP. The\nname \"Havex\" is clearly visible in the server source code:\n\nDuring the spring of 2014, we noticed that Havex took a specific interest in Industrial Control Systems (ICS) and the group\nbehind it uses an innovative trojan horse approach to compromise victims. The attackers have trojanized software available\nfor download from ICS/SCADA manufacturer websites in an attempt to infect the computers where the software is installed\nto.\n\nWe gathered and analyzed 88 variants of the Havex RAT used to gain access to, and harvest data from, networks and\nmachines of interest. This analysis included investigation of 146 command and control (C&C) servers contacted by the\nvariants, which in turn involved tracing around 1500 IP addresses in an attempt to identify victims.\n\nThe attackers use compromised websites, mainly blogs, as C&C servers. Here are some examples of command and control\nservers used:\n\nWe also identified an additional component used by the attackers that includes code to harvest data from infected machines\nused in ICS/SCADA systems. This indicates that the attackers are not just interested in compromising the networks of\ncompanies they are interested in, but are also motivated in having control of the ICS/SCADA systems in those\norganizations. The source of this motivation is unclear to us.\n\n**Trojanized Software as an Infection Vector**\n\nThe Havex RAT is distributed at least through following channels:\n\nSpam email\nExploit kits\nTrojanized installers planted on compromised vendor sites\n\n\nGo\n\n\n-----\n\nOf more interest is the third channel, which could be considered a form of \"watering-hole attack\", as the attackers chose to\ncompromise an intermediary target - the ICS vendor site - in order to gain access to the actual targets.\n\nIt appears the attackers abuse vulnerabilities in the software used to run the websites to break in and replace legitimate\nsoftware installers available for download to customers.\n\nOur research uncovered three software vendor sites that were compromised in this manner. The software installers available\non the sites were trojanized to include the Havex RAT. We suspect more similar cases exist but have not been identified yet.\n\nBased on the content of their websites, all three companies are involved in development of applications and appliances for\nuse in industrial applications. These organizations are based in Germany, Switzerland and Belgium. Two of them are\nsuppliers of remote management software for ICS systems and the third develops high-precision industrial cameras and\nrelated software.\n\nAs an example, we can see the partial results of dynamic analysis for one of the trojanized installers:\n\nThe normal, clean installer does not include a file called \"mbcheck.dll\". This file is actually the Havex malware. The\ntrojanized software installer will drop and execute this file as a part of the normal installation. The user is left with a working\nsystem, but the attacker now has a backdoor to access and control the computer.\n\n**Target Organizations**\n\nWe were able to locate some of the infected systems and identify the organization affected by the samples analyzed in this\nreport by tracing the IP addresses communicating to the C&C servers used by the Havex RAT.\n\nAll of these entities are associated in some way with the development or use of industrial applications or machines. The\nmajority of the victims are located in Europe, though at the time of writing at least one company in California was also\nobserved sending data to the C&C servers. Of the European-based organizations, two are major educational institutions in\nFrance that are known for technology-related research; two are German industrial application or machine producers; one is a\nFrench industrial machine producer; and one is a Russian construction company that appears to specialize in structural\nengineering.\n\n**ICS/SCADA Sniffer**\n\nOur analysis of Havex sample codes also uncovered its \"ICS/SCADA sniffing\" behavior. The C&C server will instruct\ninfected computers to download and execute further components, and one of these components appeared very interesting.\nWhile analyzing this component, we noticed that it enumerates the local area network and looks for connected resources\nand servers:\n\nWe then noticed that it uses Microsoft Component Object Model (COM) interfaces (CoInitializeEx, CoCreateInstanceEx) to\nconnect to specific services:\n\n\n-----\n\nTo identify which services the sample is interested in, we can simply search for the identifiers seen above, which tell us\nwhat kind of interfaces are being used. A bit of googling gives us these names:\n\n**9DD0B56C-AD9E-43EE-8305-487F3188BF7A = IID_IOPCServerList2**\n**13486D51-4821-11D2-A494-3CB306C10000 = CLSID_OPCServerList**\n\nNote the mention of \"OPCServer\" in the names. There are more hints pointing in the same direction -- the strings found in\nthe executable also make several references to “OPC”:\n\nIt turns out that OPC stands for [OLE for Process Control, and it's a standard way for Windows applications to interact with](http://en.wikipedia.org/wiki/OLE_for_Process_Control)\nprocess control hardware. Using OPC, the malware component gathers any details about connected devices and sends them\nback to the C&C for the attackers to analyze. It appears that this component is used as a tool for intelligence gathering. So\nfar, we have not seen any payloads that attempt to control the connected hardware.\n\n**Summary**\n\nThe attackers behind Havex are conducting industrial espionage using a clever method. Trojanizing ICS/SCADA software\ninstallers is an effective method in gaining access to target systems, potentially even including critical infrastructure.\n\nThe method of using compromised servers as C&C's is typical for this group. The group doesn't always manage the C&C's\nin a professional manner, revealing lack of experience in operations. We managed to monitor infected computers connecting\nto the servers and identify victims from several industry sectors.\n\nThe additional payload used to gather details about ICS/SCADA hardware connected to infected devices shows the\nattackers have direct interest in controlling such environments. This is a pattern that is not commonly observed today.\n\nSHA-1 hashes of the samples discussed:\n\n7f249736efc0c31c44e96fb72c1efcc028857ac7\n1c90ecf995a70af8f1d15e9c355b075b4800b4de\ndb8ed2922ba5f81a4d25edb7331ea8c0f0f349ae\nefe9462bfa3564fe031b5ff0f2e4f8db8ef22882\n\nF-Secure detects this threat as Backdoor:W32/Havex.A.\n\n[Post by — Daavid and Antti](https://twitter.com/daavidhentunen)\n\n\n-----\n\n[<<< Necurs - Rootkit For Hire](http://www.f-secure.com/weblog/archives/00002717.html) | [You Are Responsible For Your Security And Privacy >>>](http://www.f-secure.com/weblog/archives/00002719.html)\n\n\n**[Contact Us](http://www.f-secure.com/en/web/corporation_global/contact/offices/europe)** |\n[Copyright & Privacy |](http://www.f-secure.com/en/web/home_global/privacy)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/ICS SCADA/Havex/Havex Hunts for ICS_SCADA Systems.pdf"
    ],
    "report_names": [
        "Havex Hunts for ICS_SCADA Systems.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5cbf6c32-482d-4cd2-9d11-0d9311acdc28",
            "created_at": "2023-01-06T13:46:38.39927Z",
            "updated_at": "2025-03-27T02:00:02.823829Z",
            "deleted_at": null,
            "main_name": "ENERGETIC BEAR",
            "aliases": [
                "DYMALLOY",
                "TG-4192",
                "Crouching Yeti",
                "Group 24",
                "Havex",
                "IRON LIBERTY",
                "Blue Kraken",
                "ALLANITE",
                "Koala Team",
                "G0035",
                "ATK6",
                "ITG15",
                "Ghost Blizzard",
                "BERSERK BEAR"
            ],
            "source_name": "MISPGALAXY:ENERGETIC BEAR",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536157,
    "ts_updated_at": 1743041378,
    "ts_creation_date": 0,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/0180cdeebfa399c7ae5fdfd9d798ece82736195c.pdf",
        "text": "https://archive.orkl.eu/0180cdeebfa399c7ae5fdfd9d798ece82736195c.txt",
        "img": "https://archive.orkl.eu/0180cdeebfa399c7ae5fdfd9d798ece82736195c.jpg"
    }
}