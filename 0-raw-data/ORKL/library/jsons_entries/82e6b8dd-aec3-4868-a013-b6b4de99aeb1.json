{
    "id": "82e6b8dd-aec3-4868-a013-b6b4de99aeb1",
    "created_at": "2022-10-25T16:48:22.896296Z",
    "updated_at": "2025-03-27T02:17:11.525554Z",
    "deleted_at": null,
    "sha1_hash": "31b0c92ff842596ed58185bb84c7dc4542059e85",
    "title": "PROMETHIUM and NEODYMIUM: Parallel zero-day attacks targeting individuals in Europe",
    "authors": "Microsoft",
    "file_creation_date": "2016-12-20T13:56:11Z",
    "file_modification_date": "2016-12-20T13:56:11Z",
    "file_size": 1843504,
    "plain_text": "# Microsoft Security Intelligence Report\n\n###### Volume 21 | January through June, 2016\n\n## PROMETHIUM and NEODYMIUM: Parallel zero-day attacks targeting individuals in Europe\n\n\n-----\n\n-----\n\nThis document is for informational purposes only. MICROSOFT MAKES NO\nWARRANTIES, EXPRESS, IMPLIED, OR STATUTORY, AS TO THE INFORMATION\nIN THIS DOCUMENT.\n\nThis document is provided “as-is.” Information and views expressed in this\ndocument, including URL and other Internet Web site references, may change\nwithout notice. You bear the risk of using it.\n\nCopyright © 2016 Microsoft Corporation. All rights reserved.\n\nThe names of actual companies and products mentioned herein may be the\ntrademarks of their respective owners.\n\n\n-----\n\n**Authors**\n\nCharlie Anthe\n_Cloud and Enterprise Security_\n\nEvan Argyle\n_Windows Defender Labs_\n\nEric Douglas\n_Windows Defender Labs_\n\nSarah Fender\n_Azure Security_\n\nElia Florio\n_Windows Defender Labs_\n\nChad Foster\n_Bing_\n\nRam Gowrishankar\n_Windows Defender Labs_\n\nVolv Grebennikov\n_Bing_\n\nPaul Henry\n_Wadeware LLC_\n\nAaron Hulett\n_Windows Defender Labs_\n\nIvo Ivanov\n_Windows Defender Labs_\n\n**Contributors**\n\nEric Avena\n_Windows Defender Labs_\n\nIaan D'Souza- Wiltshire\n_Windows Defender Labs_\n\nDustin Duran\n_Windows Defender Labs_\n\nTanmay Ganacharya\n_Windows Defender Labs_\n\nChris Hallum\n_Windows and Devices Group_\n\n\nMichael Johnson\n_Windows Defender Labs_\n\nJeff Jones\n_Corporate Communications_\n\nTim Kerk\n_Windows Defender Labs_\n\nMathieu Letourneau\n_Windows Defender Labs_\n\nMarianne Mallen\n_Windows Defender Labs_\n\nMatt Miller\n_Microsoft Security Response_\n_Center_\n\nChad Mills\n_Safety Platform_\n\nNam Ng\n_Enterprise Cybersecurity_\n_Group_\n\nHamish O'Dea\n_Windows Defender Labs_\n\nJames Patrick Dee\n_Windows Defender Labs_\n\nSatomi Hayakawa\n_CSS Japan Security Response_\n_Team_\n\nSue Hotelling\n_Windows and Devices Group_\n\nYurika Kakiuchi\n_CSS Japan Security Response_\n_Team_\n\nLouie Mayor\n_Windows Defender Labs_\n\nDolcita Montemayor\n_Windows Defender Labs_\n\n\nSiddharth Pavithran\n_Windows Defender Labs_\n\nDaryl Pecelj\n_Microsoft IT Information_\n_Security and Risk_\n_Management_\n\nFerdinand Plazo\n_Windows Defender Labs_\n\nTim Rains\n_Commercial Communications_\n\nPaul Rebriy\n_Bing_\n\nKarthik Selvaraj\n_Windows Defender Labs_\n\nTom Shinder\n_Azure Security_\n\nNitin Sood\n_Windows Defender Labs_\n\nTomer Teller\n_Azure Security_\n\nVikram Thakur\n_Windows Defender Labs_\n\nHeike Ritter\n_Windows and Devices Group_\n\nNorie Tamura\n_CSS Japan Security Response_\n_Team_\n\nSteve Wacker\n_Wadeware LLC_\n\nDavid Weston\n_Windows Defender Labs_\n\n\n-----\n\n### Table of contents\n\n**About this report ......................................................................................................................... iv**\n\n**How to use this report ................................................................................................................ v**\n\n###### Featured intelligence 19\n\n**PROMETHIUM and NEODYMIUM: Parallel zero-day attacks targeting individuals**\n**in Europe ....................................................................................................................................... 21**\n\nActivity Group Profile: PROMETHIUM ....................................................................................... 22\n\nActivity Group Profile: NEODYMIUM ......................................................................................... 23\n\nMitigation .......................................................................................................................................... 29\n\nSummary ............................................................................................................................................ 32\n\nIndicators ........................................................................................................................................... 32\n\n\n-----\n\n### About this report\n\nThe Microsoft Security Intelligence Report (SIR) focuses on software\nvulnerabilities, software vulnerability exploits, malware, and unwanted software.\nPast reports and related resources are available for download at\n[www.microsoft.com/sir. We hope that readers find the data, insights, and](http://www.microsoft.com/sir)\nguidance provided in this report useful in helping them protect their\norganizations, software, and users.\n\n**Reporting period**\n\nThis volume of the Microsoft Security Intelligence Report focuses on the first and\nsecond quarters of 2016, with trend data for the last several quarters presented\non a quarterly basis. Because vulnerability disclosures can be highly inconsistent\nfrom quarter to quarter and often occur disproportionately at certain times of\nthe year, statistics about vulnerability disclosures are presented on a half-yearly\nbasis.\n\nThroughout the report, half-yearly and quarterly time periods are referenced\nusing the nHyy or nQyy formats, in which yy indicates the calendar year and n\nindicates the half or quarter. For example, 1H16 represents the first half of 2016\n(January 1 through June 30), and 4Q15 represents the fourth quarter of 2015\n(October 1 through December 31). To avoid confusion, please note the reporting\nperiod or periods being referenced when considering the statistics in this report.\n\n**Conventions**\n\n[This report uses the Microsoft Malware Protection Center (MMPC) naming](http://www.microsoft.com/mmpc)\nstandard for families and variants of malware. For information about this\nstandard, see “Appendix A: Threat naming conventions” on page 135 of the full\nreport. In this report, any threat or group of threats that share a common unique\nbase name is considered a family for the sake of presentation. This consideration\nincludes threats that may not otherwise be considered families according to\ncommon industry practices, such as generic and cloud-based detections. For\nthe purposes of this report, a threat is defined as a malicious or unwanted\nsoftware family or variant that is detected by the Microsoft Malware Protection\nEngine.\n\n\n-----\n\n### How to use this report\n\nThe Microsoft Security Intelligence Report has been released twice a year since\n2006. Each volume is based upon data collected from millions of computers all\nover the world, which not only provides valuable insights on the worldwide\nthreat landscape, both at home and at work, but also provides detailed\ninformation about threat profiles faced by computer users in more than a\nhundred individual countries and regions.\n\nTo get the most out of each volume, Microsoft recommends the following:\n\n**Read**\n\nEach volume of the report consists of several parts. The primary report typically\nconsists of a worldwide threat assessment, one or more feature articles,\nguidance for mitigating risk, and some supplemental information. A summary of\nthe key findings in the report can be downloaded and reviewed separately from\nthe full report; it highlights a number of facts and subjects that are likely to be of\nparticular interest to readers. The regional threat assessment, available for\n[download and in interactive form at www.microsoft.com/security/sir/threat,](https://www.microsoft.com/security/sir/threat/)\nprovides individual summaries of threat statistics and security trends for more\nthan 100 countries and regions worldwide.\n\nReading the volume in its entirety will provide readers with the most benefit and\ncontext, but the report is designed to provide value in small doses as well. Take\na few minutes to review the summary information to find the information that\nwill be of most interest to you and your organization. Consult the table of\ncontents and the index to learn more about particular topics of interest.\n\n**Share**\n\nMicrosoft also encourages readers to share each released volume, or its\ndownload link, with co-workers, peers, and friends with similar interests. The\n_Microsoft Security Intelligence Report is written to be useful and accessible to a_\nwide range of audiences. Each volume contains thousands of hours of research\ndisseminated in easy to understand language, with advanced technical jargon\nkept to a minimum. Each section and article is written and reviewed to provide\nthe most value for the time it takes to read.\n\n\n-----\n\n**Assess your own risk**\n\nReading about the threats and risks that affect different types of environments\npresents a good opportunity to assess your own risks. Not every computer and\nentity faces the same risk from all threats. Assess your own risks and determine\nwhich topics and information can help you to best defend against the most\nsignificant risks.\n\nThe volume and scope of threats facing the typical organization make it\nimportant to prioritize. The greatest risk to any computer or organization is\nposed by currently and recently active threats. Pay attention to the threats that\nhave most commonly affected your region or industry, focusing particularly on\nthe most common successful attacks in the wild that cause the most problems.\nGive less consideration to very rare or theoretical-only attacks, unless your\ncomputers are at particular risk for such threats.\n\n**Educate**\n\nMicrosoft strives to make this report one of the most valuable sources of threat\nand mitigation information that you can read and share. We encourage you to\nuse the Microsoft Security Intelligence Report as a guide to educate your\nemployees, friends, and families about security-related topics.\n\nAnyone, including a business, may link, point to, or re-use articles in the\n_Microsoft Security Intelligence Report for informational purposes, provided the_\nmaterial is not used for publication or sale outside of your company and you\ncomply with the following terms: You must not alter the materials in any way.\nYou must provide a reference to the URL at which the materials were originally\nfound. You must include the Microsoft copyright notice followed by “Used with\n[permission from Microsoft Corporation.” Please see Use of Microsoft](https://www.microsoft.com/en-us/legal/intellectualproperty/Permissions/default.aspx)\n[Copyrighted Content for further information.](https://www.microsoft.com/en-us/legal/intellectualproperty/Permissions/default.aspx)\n\n**Ask questions**\n\nContact your local Microsoft representative with any questions you have about\nthe topics and facts presented in this report. We hope that each volume\nprovides a good educational summary and helps promote dialog between\npeople trying to best secure their computing devices. Thank you for trusting\nMicrosoft to be your partner in the fight against malware, hackers, and other\nsecurity threats.\n\n\n-----\n\n#### Featured intelligence\n\n**PROMETHIUM and NEODYMIUM: Parallel zero-**\n**day attacks targeting individuals in Europe ........ 21**\n\n\n-----\n\n-----\n\n### PROMETHIUM and NEODYMIUM: Parallel zero- day attacks targeting individuals in Europe\n\n_Windows Defender ATP_\n\nMicrosoft proactively monitors the threat landscape for emerging threats. Part\nof this job involves observing the activities of targeted activity groups, which are\noften the first ones to introduce new exploits and techniques that are later used\nby other attackers. The previous two volumes of the Microsoft Security\n_Intelligence Report explored the activities of two such groups, code-named_\nSTRONTIUM and PLATINUM, which used previously unknown vulnerabilities and\naggressive, persistent techniques to target specific individuals and institutions—\noften including military installations, intelligence agencies, and other\ngovernment bodies.\n\nThis volume chronicles two activity groups, code-named PROMETHIUM and\nNEODYMIUM, both of which target individuals in a specific area of Europe.\nAlthough most malware today either seeks monetary gain or conducts\nespionage for economic advantage, both of these activity groups appear to\nseek information about specific individuals.\n\nIn May 2016, both PROMETHIUM and NEODYMIUM were observed to launch\nattack campaigns. These campaigns used completely distinct infrastructure and\nprimary malware, which indicated a lack of association at the operational level.\nHowever, the similarity in the campaigns’ victim locale, timing, and use of the\nsame zero-day exploit prior to public disclosure strongly indicates that the\nactivity groups may be related at a higher organizational tier.\n\nMicrosoft is sharing information about these groups to raise awareness of their\nactivities, and to help individuals and organizations implement existing\nmitigation options that significantly reduce risk from these attack groups and\nother similar groups.\n\n\n-----\n\n**Activity Group Profile: PROMETHIUM**\n\nCampaign summary: PROMETHIUM is an activity group that has been active\nsince at least 2012. In 2016, an attack campaign by this group was recorded in\n[early May that made use of an exploit for CVE-2016-4117, a vulnerability in](https://helpx.adobe.com/security/products/flash-player/apsb16-15.html)\nAdobe Flash Player, which at the time was both unknown and unpatched.\nAdobe promptly and publicly acknowledged the zero-day vulnerability and\npushed a security update.\n\n\n##### PROMETHIUM and NEODYMIUM both\n target individuals in a specific area of\n\n\nThe attack itself began with certain individuals receiving links in\ninstant messenger clients. These links led to malicious\ndocuments that invoked exploit code and eventually executed a\npiece of malware called Truvasys on unsuspecting victims’\ncomputers.\n\n\nAdministrators and users wondering whether they were\n\n##### Europe.\n\ntargeted by PROMETHIUM can scan their network by using the\nindicators listed in the appendix, by using Windows Defender to\nexamine their logs for “Truvasys,” or by searching for PROMETHIUM in their\n[Windows Defender Advanced Threat Protection product console alerts.](https://blogs.windows.com/windowsexperience/2016/03/01/announcing-windows-defender-advanced-threat-protection/)\n\n[Attack details: Truvasys has been previously documented by peer organizations](https://securelist.com/blog/research/76147/on-the-strongpity-waterhole-attacks-targeting-italian-and-belgian-encryption-users/)\nin the security industry. The malware and its developers have been active for a\nfew years and have conducted multiple attack campaigns by masquerading as\ncommon computer utilities such as WinUtils, TrueCrypt, WinRAR, and SanDisk.\nIn each of the campaigns, the Truvasys malware was updated to include\nadditional features, showing close collaboration between the activity groups\nbehind the campaigns and the developers of the malware.\n\nTruvasys is a collection of modules written in the Delphi programming language,\na variant of Pascal. It runs on 32-bit and 64-bit editions of multiple versions of\nWindows, including Windows Vista, Windows 7, Windows 8, and Windows 10, in\nboth standard user and administrator modes. It includes a number of features\ndesigned to evade detection, including virtual environment detection and\ntampering with security software.\n\nTruvasys connects to a remote command and control (C&C) server to retrieve\ninstructions from an attacker, who can use the malware to execute arbitrary\nfunctionality on the compromised computer.\n\n\n-----\n\nThis malware family has targeted individuals through the combined use of spear\nphishing and watering hole techniques for a number of years. In most cases,\nTruvasys is embedded with legitimate installers of applications, compromising\nindividual computers by tricking users into running the installers. One campaign\ninvolved a fake Adobe Flash Player installer, with a social engineering lure in\nTurkish.\n\nFigure 1. In one campaign, Truvasys was distributed via social engineering lures in the Turkish language\n\nThe language used in this example is consistent with the geography of Truvasys\nvictims, as observed over the years. Most Truvasys activities have been observed\nacross western Europe with a large majority of computers using the Turkish\nlocale setting, which suggests that most of them are Turkish citizens or\nexpatriates.\n\nWhile studying Truvasys, Microsoft uncovered a previously undocumented\npiece of malware known as Myntor that is a completely separate malware family.\nMyntor is pushed onto victims’ computers that are selected by an unknown logic\ndevised by PROMETHIUM.\n\n**Activity Group Profile: NEODYMIUM**\n\nCampaign summary: NEODYMIUM is an activity group that, like PROMETHIUM,\nconducted an attack campaign in early May 2016. NEODYMIUM also used the\nexact same CVE-2016-4117 exploit code that PROMETHIUM used, prior to public\nknowledge of the vulnerability’s existence.\n\n\n-----\n\nNEODYMIUM used a backdoor detected by Windows Defender as Wingbird,\n[whose characteristics closely match FinFisher, a government-grade commercial](https://www.symantec.com/security_response/writeup.jsp?docid=2012-072615-4146-99&tabid=2)\nsurveillance package. Data about Wingbird activity indicates that it is typically\nused to attack individuals and individual computers instead of networks.\n\nAdministrators and users wondering whether they were targeted by\nNEODYMIUM can scan their networks by using the indicators listed in the\nappendix, by using Windows Defender to examine their logs for “Wingbird,” or\n[by searching for NEODYMIUM in their Windows Defender Advanced Threat](https://blogs.windows.com/windowsexperience/2016/03/01/announcing-windows-defender-advanced-threat-protection/)\n[Protection product console alerts.](https://blogs.windows.com/windowsexperience/2016/03/01/announcing-windows-defender-advanced-threat-protection/)\n\nAttack details: Target individuals were sent customized spear phishing emails.\nAn image of one such customized email from this campaign is shown in the\nfollowing figure.\n\nFigure 2. The spear phishing campaign that NEODYMIUM launched in May 2016 is highly customized to target individuals; a large\nportion of the email has been redacted to protect the privacy of the targeted individual, which shows the extent of personalization of\nthe malicious email\n\nWhen the user opened the attachment, a blank document displayed. In the\nbackground, a series of events, including the use of the CVE-2016-4117 zero-day\nexploit, ultimately led to the download and execution of a backdoor. The exploit\n[code executes only if the Microsoft Office Protected View setting is turned off.](https://support.office.com/en-us/article/What-is-Protected-View-d6f09ac7-e6b9-4495-8e43-2bbcdbcb6653)\nBy default, documents opened from the Internet (using web browsers or email\nclients) are opened in protected view mode, which prevents execution of\nembedded objects and potentially malicious code.\n\n\n-----\n\nFigure 3. The NEODYMIUM attack chain shows how the exploit CVE-2016-4117 was used to infect target individuals’ computers\n\nThe backdoor payload showed behavior that matched publicly documented\ntraits of a program called FinFisher, a government-grade commercial\nsurveillance package marketed to law enforcement and intelligence agencies.\n[The publisher, FinFisher GmbH, claims that it sells the software exclusively to](http://www.finfisher.com/FinFisher/)\ngovernment agencies for use in targeted and lawful criminal investigations. It is\nlikely that the backdoor payload is a relatively new version of the commercial\nspyware.\n\nThe apparent use of a version of FinFisher suggests that the exploit and the\nspear fishing campaign that delivered it were the work of an attack group\nprobably connected in some way to a state actor.\n\nWindows Defender detects the backdoor payload as Wingbird. Visibility into the\nusage of Wingbird shows it has been used only against individuals, not against\ncomputers that are part of an organization’s network.\n\nResearch into Wingbird from May through November 2016 showed only tens of\nvictims, predominantly in Turkey.\n\n\n-----\n\nFigure 4. NEODYMIUM victim breakdown, by country for May through November 2016\n\nGermany UK\n\n5% 5%\n\nUS\n6%\n\nTurkey\n\n84%\n\nLike Truvasys, Wingbird is designed to run on both 32-bit and 64-bit Windows\nplatforms. The malware is a native 32-bit PE executable that installs a number of\nadditional executables and files. These components are all embedded within the\ndropper itself, which allows the malware to avoid downloading components and\nconsequently attracting attention.\n\nAfter the backdoor executes, the malware checks the underlying operating\nsystem version and, depending on what platform it is running on, drops several\nfiles to %ProgramData%\\RpcSrv (on 32-bit computers) or\n%ProgramData%\\AuditService (on 64-bit computers).\n\nIn addition, on 64-bit computers the dropper creates a secondary native 64-bit\npayload executable, referred to in the following diagram as [Payload64].exe. The\n32-bit processes are isolated from 64-bit processes and restricted in the actions\nthey can perform. By providing a separate 64-bit payload, Wingbird attempts to\ninject code into 64-bit processes as well as 32-bit processes.\n\n\n-----\n\nFigure 5. Wingbird behaves differently on 32-bit computers and 64-bit computers\n\nThe main goal of the original dropper is to indirectly deliver executables by\ninjecting malicious code and data into two Windows system processes,\nServices.exe and Winlogon.exe. The primary Wingbird payload uses anti-VM,\nanti-debugging, and anti-AV mechanisms to evade discovery and analysis.\n\nOn 32-bit computers, the original dropper creates three files, as shown in Figure\n5. Of the three files, the only true binary is rpcsrv.dat, a kernel rootkit that\nenables the attacker to load and run privileged unsigned code. The other two\nfiles, installer.cab and the randomly named [xxxxx].cab, are encrypted data files.\n\nWingbird attempts to detect and evade security products. For example, some of\nthe strings found in running processes, such as avcuf32.dll and <un-wnd%.08x>, indicate that the malware checks for the presence of one of several\nversions of Bitdefender security software.\n\nThrough a series of actions and code injections, the original malware installs the\nrootkit driver, rpcsrv.dat, a non-standard kernel driver. The attackers know that\n64-bit computers are much more secure because they prevent loading of\nunsigned drivers, so they do not even attempt this technique on 64-bit systems.\n[The malware searches for a file called ico_ty23.ico, which is publicly documented](https://www.symantec.com/security_response/writeup.jsp?docid=2012-072615-4146-99&tabid=2%20)\nas the filename one of the key user mode DLL components of FinFisher.\n\n\n-----\n\nOn 64-bit computers, the installation of Wingbird is a lot more complicated. The\n64-bit version of the original payload creates a new folder,\n%ProgramData%\\AuditService, and copies the Windows system file lsass.exe\nfrom %SystemFolder% into the new folder. At the same time, the payload drops\na malicious file known as sspisrv.dll alongside the copy of lsass.exe. This\nsspisrv.dll file shares its name with a code library that implements several APIs\nthat lsass.exe is designed to import.\n\nFigure 6. Wingbird payload’s behavior on 64-bit computers\n\n[Payload64.exe]\n\n                                             - Drops SSPISRV.dll\n\n[Payload32].exe detects it                     - Copies a clean LSASS.exe The infected services.exe\nexecutes on 64-bit platform and                   - Injects code into winlogon.exe registers a new service using the\n\n[Payload32].exe starts drops [Payload64].exe and services.exe copy of the clean LSASS.exe\n\nup\n\n\\AuditService\\LSASS.exe\n\n[Payload64] Services.exe\n\n\\AuditService\\LSASS.exe\n\nstarts up and loads\n\nSSPISRV.dll\n\n**Vulnerable Digitally** Infected SvcHost.exe\n**Signed Kernel Driver**\n\nSSPISRV.dll\n\nThe implant in the infected SSPISRV.dll injects code into\nSvcHost.exe exploits a vulnerable svchost.exe\n\nkernel driver\n\nThe original 32-bit dropper continues monitoring until the folder and file are\ncreated. After the 64-bit payload is done copying files, its parent process (the\n32-bit dropper) deletes it. The parent process then deletes itself as an attempt to\nhide its tracks and prevent analysis by security professionals.\n\nThe 64-bit malware then injects code into services.exe, the Service Control\nManager, to register a service using a clean lsass.exe that would load the\nmalicious sspisrv.dll, which would then inject malicious code into svchost.exe.\nThe constant delegation of malicious code control from one process to the next\nis a way to hide execution of unwanted code and make it extremely difficult to\ndetect the presence of Wingbird.\n\nThis version of Wingbird has also been observed with the ability to execute\nhighly privileged kernel code by injecting code through vulnerable signed\n\n\n\n[Payload64.exe]\n\n - Drops SSPISRV.dll\n\n - Copies a clean LSASS.exe\n\n - Injects code into winlogon.exe\nand services.exe\n\n\nThe implant in the infected\nSvcHost.exe exploits a vulnerable\n\nkernel driver\n\n\nThe infected services.exe\nregisters a new service using the\n\ncopy of the clean LSASS.exe\n\n\nSSPISRV.dll injects code into\n\nsvchost.exe\n\n\n-----\n\ndrivers. It maintains a list of legitimate yet vulnerable drivers that can be\nexploited to inject and execute kernel code.\n\nIt appears that Wingbird obfuscates its code at source level, rather than binary\nlevel, to evade analysis tools and security solutions.\n\nSimilar to the 32-bit version, this version of Wingbird performs a check for a file\nnamed ico_sf46.ico, which is a known component of FinFisher.\n\n**Mitigation**\n\nStopping zero-day exploits in Windows 10\n\nPROMETHIUM and NEODYMIUM both used a zero-day\n\n##### Control Flow\n\nexploit that executed code to download a malicious payload.\n[Protected view, a security feature that was introduced in](https://support.office.com/en-us/article/What-is-Protected-View-d6f09ac7-e6b9-4495-8e43-2bbcdbcb6653) Guard makes it\nMicrosoft Office 2010, prevents the malicious Flash code more difficult to\n[from loading when the document is opened. Control Flow](https://msdn.microsoft.com/en-us/library/windows/desktop/mt637065(v=vs.85).aspx)\n[Guard, a security feature that is turned on by default in](https://msdn.microsoft.com/en-us/library/windows/desktop/mt637065(v=vs.85).aspx) exploit memory\nWindows 10 and Microsoft Office 365 64-bit version, can corruption\nhelp by making it more difficult to exploit memory corruption\n\n##### vulnerabilities.\n\nvulnerabilities. The Flash vulnerability CVE-2016-4117 is a type\nconfusion vulnerability in the DeleteRangeTimelineOperation\nclass. The referenced exploit only reliably works on specific Windows platforms\nbecause of a ByteArray mitigation in Flash Player, which causes Microsoft to\nbelieve that the exploit was authored with pre-knowledge of the victim’s\ncomputer information. The exploit uses the Adobe Flash Player’s Function object\nvftable corruption method to achieve code execution.\n\n\nBecause 64-bit versions of Windows 10 enforce driver signing, malicious code\nthat attempts to load a locally made, untrusted driver will be stopped in its\ntracks.\n\nIn addition, the technique of using lsass.exe to load a malicious DLL files can be\n[mitigated by an optional feature introduced in Windows 10 called Credential](https://technet.microsoft.com/en-us/itpro/windows/keep-secure/credential-guard)\n[Guard. Microsoft highly recommends that network administrators test and](https://technet.microsoft.com/en-us/itpro/windows/keep-secure/credential-guard)\nenable this feature. In Wingbird’s case, the malicious sspisrv.dll will not load\nbecause it wasn’t signed by a trusted certificate.\n\n[The Hypervisor Code Integrity (HVCI) service enables the Device Guard feature](https://blogs.technet.microsoft.com/datacentersecurity/2016/09/20/overview-of-device-guard-in-windows-server-2016/)\nin Windows 10 to help protect kernel mode processes and drivers from\n\n\n-----\n\nvulnerability exploits and zero-day exploits. HVCI uses the processor’s\nfunctionality to force all software running in kernel mode to safely allocate\nmemory, which means that after memory has been allocated, its state must be\nchanged from writable to read-only or execute-only. By forcing memory into\nthese states, HVCI helps ensure that attacks are unable to inject malicious code\ninto kernel mode processes and drivers through techniques such as buffer\noverflows and heap spraying.\n\nDetecting malicious behavior with Windows Defender Advanced Threat\nProtection\n\n[Windows Defender Advanced Threat Protection (ATP) is a new built-in detection](http://aka.ms/wdatp)\nservice that ships natively with Windows 10 and helps enterprises to detect\ntargeted and advanced attacks. When activated, it captures behavioral signals\nfrom the endpoint and then uses cloud-based security machine learning\nanalytics and threat intelligence to flag suspicious attack-related activities.\n\nThe NEODYMIUM attack campaign executed the following five malicious\n[behaviors, all of whichare detected by Windows Defender ATP:](https://blogs.windows.com/windowsexperience/2016/03/01/announcing-windows-defender-advanced-threat-protection/)\n\n1. Zero-day exploit code causes a Microsoft Office file to generate and open\n\nan executable file.\n\nFigure 7. Windows Defender ATP shows an alert for an exploit resulting in a malicious file executing on an endpoint\n\n2. Zero-day exploit code allows an executable file to gain higher privileges.\n\n3. A suspicious file self-deletes, a behavior associated with malware that erases\n\ntraces of infection as a way to evade forensic analysis.\n\n\n-----\n\nFigure 8. Windows Defender ATP shows an alert for processes that attempt self-deletion\n\n4. Malware executes DLL-side loading, a technique in which attackers replace\n\nlegitimate DLL files in non-standard folders with malicious ones so that the\n\nmalicious file is loaded when the application or operating system starts.\n\nFigure 9. Windows Defender ATP shows an alert for DLL-side loading\n\n5. Malware injects code into legitimate processes, which is usually done to load\n\nthe malware when system processes run.\n\nFigure 10. Windows Defender ATP shows an alert for suspicious code injections\n\n[Windows Defender Advanced Threat Protection alerts enterprise security teams](https://blogs.windows.com/windowsexperience/2016/03/01/announcing-windows-defender-advanced-threat-protection/)\nof detections and allows them to investigate and respond to each security\nincident in a timely and effective manner. The service complements and works\n\n\n-----\n\nalong with Windows Defender or third-party antivirus security solutions.\n[Additional information about the service is available here.](https://www.microsoft.com/en-us/WindowsForBusiness/Windows-ATP)\n\n**Summary**\n\nIn May 2016, two apparently unrelated activity groups, PROMETHIUM and\nNEODYMIUM, conducted attack campaigns in Europe that used the same zeroday exploit while the vulnerability was publicly unknown. Although the use of the\nsame exploit code could be attributed to a number of coincidences, the timing\nof the campaigns and victim demographics lend credence to the theory that the\ncampaigns were associated.\n\nOne threat family, Wingbird, appears to be a version of a commercially available\ntool sold to organizations conducting lawful interception. Wingbird is a fairly\nadvanced threat family that must have required the authors several months’\nworth of man-hours to generate. Even so, Wingbird as-is does not execute in\nWindows 10.\n\nEach activity group uses a unique set of tools and methods to perform actions\nlike lateral movement and data exfiltration. One of the purposes of tracking\nactivity groups is to research unique attacker techniques and to develop\n[mitigations for the native operating system. Microsoft has built](https://blogs.windows.com/business/2016/06/29/advancing-security-for-consumers-and-enterprises-at-every-layer-of-the-windows-10-stack/) [proactive](https://technet.microsoft.com/en-us/itpro/windows/keep-secure/windows-10-security-guide)\n[security mitigations into its products, which increases the investment barrier for](https://technet.microsoft.com/en-us/itpro/windows/keep-secure/windows-10-security-guide)\nattackers who try to victimize users of the latest versions of Windows.\n\n[The Windows security service Windows Defender ATP provides an additional](http://aka.ms/wdapt)\npost-breach layer of security to enterprises organizations. As this article shows,\nproactive mitigation in Windows 10 and Office on 64-bit systems does not allow\nthe exploit vector for these two attack campaigns or the exploitation of kernel\ndrivers to succeed. In addition, Windows Defender ATP detects suspicious\nevents on endpoints, alerts security operators about undesired activities, and\nprovides the required tool to respond.\n\n**Indicators**\n\nThe following table includes a sampling of indicators on the malware used by\nPROMETHIUM and NEODYMIUM. This is just a snippet of the information\ncollected while studying these malware and the corresponding attack\ncampaigns.\n\n\n-----\n\nFigure 11. PROMETHIUM and NEODYMIUM indicators\n\n|SHA1 or other indicator|Association|\n|---|---|\n|21a3862dfe21d6b216359c6baa3d3c2beb50c7a3|Malicious document|\n|0b16135d008f6952df0caca104449c33d736e5fc|Malicious document|\n|21a3862dfe21d6b216359c6baa3d3c2beb50c7a3|Malicious document|\n|0852aa6b8df78069d75fa2f09b53d4476cdd252b|Malicious document|\n|05dbe59a7690e28ca295e0f939a0c1213cb42eb0|Wingbird|\n|3c2c7ac8fddbc3ee25ce0f73f01e668855ccdb80|Wingbird|\n|211a111586cb5914876adb929ccae736928d8363|Wingbird|\n|c972bf5751438c99fe3e02ecacf6fa759388c40e|Wingbird|\n|72722073f0adba1919dc31ffa26638555ad5867f|Wingbird|\n|2fb49455d65ad8baf18e3c604cd1b992b7ebbefa|Wingbird|\n|f41b999f41312f2a0fe4eaf08e90824f73e0e186|Wingbird|\n|d8d54574a082162220c3c2f3d3f4c1b1bd4d6255|Wingbird|\n|86580603f5e1d817af87e8bf3ba4dc4ea9e3069d|Wingbird|\n|cb5d0d1d557a1266f77357a951358c78196e97ff|Wingbird|\n|d75d12d250e7a36f9ef1173d630a0059b8ea5349|Wingbird|\n|a77db6e89d604eabf29a6114a30345a705b05107|Wingbird|\n|b32b0d52fff7c09c60bb64bc396dc7522a457399|Wingbird|\n|ade19bde9716770bef84ce4414a45c0462c2eba2|Wingbird|\n|e4d82ab117b86fd44c02ff3289976d15a9d9ced4|Wingbird|\n|88cb78d99fa0275db8123c17a2bd3b3d58f541da|Wingbird|\n|a248f9ad5d757d589a06a253dc46637f4128eea9|Wingbird|\n|532b0d52fff7c09c60bb64bc396dc7522a457399|Wingbird|\n|srv601[.]ddns[.]net|Wingbird|\n|srv602[.]ddns[.]net|Wingbird|\n|980d96d83f0bae8132fd13eb7d0e799999141492|Truvasys|\n|7ab2d32b2603c2b12e814264230572584e157d42|Truvasys|\n|a4f72ee3d337e5a0db78f33fd31958b41e9e9d4f|Truvasys|\n|6de50cf42cd3ff8429a405e9c62d38c11fb2edd6|Truvasys|\n|8d847ea0ffa06b8d48bbd9c943c50b05b23d310b|Truvasys|\n|7047ed9ae510377f4625db256e52af02694ef153|Truvasys|\n|bb66c7d655021234ede01bc59e808c6b8f3fa91b|Truvasys|\n\n\n-----\n\n|SHA1 or other indicator|Association|\n|---|---|\n|www[.]updatesync[.]com|Truvasys|\n|www[.]svnservices[.]com|Truvasys|\n|ftp[.]mynetenergy[.]com|Truvasys|\n|www[.]windriversupport[.]com|Truvasys|\n|www[.]truecrypte[.]org|Truvasys|\n|www[.]edicupd002[.]com|Truvasys|\n\n\n-----\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/12f9s3qxwk4oyr1vwfpaxco9p50xc2v8"
    ],
    "report_names": [
        "Microsoft_SIR-Vol21-PROMETHIUM-NEODYMIUM-Updated(12-14-2016)"
    ],
    "threat_actors": [
        {
            "id": "33f527a5-a5da-496a-a48c-7807cc858c3e",
            "created_at": "2022-10-25T15:50:23.803657Z",
            "updated_at": "2025-03-27T02:00:55.550132Z",
            "deleted_at": null,
            "main_name": "PLATINUM",
            "aliases": [
                "PLATINUM"
            ],
            "source_name": "MITRE:PLATINUM",
            "tools": [
                "JPIN",
                "Dipsind",
                "adbupd"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "27485543-d2e7-4053-a660-157489732cbb",
            "created_at": "2022-10-25T16:07:23.895403Z",
            "updated_at": "2025-03-27T02:02:10.018168Z",
            "deleted_at": null,
            "main_name": "Neodymium",
            "aliases": [],
            "source_name": "ETDA:Neodymium",
            "tools": [
                "Wingbird"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "67fbc7d7-ba8e-4258-b53c-9a5d755e1960",
            "created_at": "2022-10-25T16:07:24.077859Z",
            "updated_at": "2025-03-27T02:02:10.101173Z",
            "deleted_at": null,
            "main_name": "Promethium",
            "aliases": [
                "APT-C-41",
                "Promethium",
                "StrongPity"
            ],
            "source_name": "ETDA:Promethium",
            "tools": [
                "StrongPity",
                "StrongPity2",
                "StrongPity3",
                "Truvasys"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "400a3efc-44a1-4d83-a724-cd16818328f9",
            "created_at": "2023-01-06T13:46:38.516115Z",
            "updated_at": "2025-03-27T02:00:02.853085Z",
            "deleted_at": null,
            "main_name": "NEODYMIUM",
            "aliases": [
                "G0055"
            ],
            "source_name": "MISPGALAXY:NEODYMIUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "cbede712-4cc3-47c6-bf78-92fd9f1beac6",
            "created_at": "2022-10-25T15:50:23.777222Z",
            "updated_at": "2025-03-27T02:00:55.544919Z",
            "deleted_at": null,
            "main_name": "PROMETHIUM",
            "aliases": [
                "PROMETHIUM",
                "StrongPity"
            ],
            "source_name": "MITRE:PROMETHIUM",
            "tools": [
                "Truvasys",
                "StrongPity"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c11cbeb5-461f-4bd8-a86b-f57e471a664d",
            "created_at": "2022-10-25T15:50:23.257383Z",
            "updated_at": "2025-03-27T02:00:55.409898Z",
            "deleted_at": null,
            "main_name": "NEODYMIUM",
            "aliases": [
                "NEODYMIUM"
            ],
            "source_name": "MITRE:NEODYMIUM",
            "tools": [
                "Wingbird"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "7d8ef10e-1d7b-49a0-ab6e-f1dae465a1a4",
            "created_at": "2023-01-06T13:46:38.595679Z",
            "updated_at": "2025-03-27T02:00:02.869216Z",
            "deleted_at": null,
            "main_name": "PLATINUM",
            "aliases": [
                "TwoForOne",
                "G0068",
                "ATK33"
            ],
            "source_name": "MISPGALAXY:PLATINUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e61c46f7-88a1-421a-9fed-0cfe2eeb820a",
            "created_at": "2022-10-25T16:07:24.061767Z",
            "updated_at": "2025-03-27T02:02:10.094583Z",
            "deleted_at": null,
            "main_name": "Platinum",
            "aliases": [
                "ATK 33",
                "Operation EasternRoppels",
                "TwoForOne"
            ],
            "source_name": "ETDA:Platinum",
            "tools": [
                "AMTsol",
                "Adupib",
                "Adupihan",
                "Dipsind",
                "DvDupdate.dll",
                "JPIN",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "RedPepper",
                "RedSalt",
                "Titanium",
                "adbupd",
                "psinstrc.ps1"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "4660477f-333f-4a18-b49b-0b4d7c66d482",
            "created_at": "2023-01-06T13:46:38.511962Z",
            "updated_at": "2025-03-27T02:00:02.852307Z",
            "deleted_at": null,
            "main_name": "PROMETHIUM",
            "aliases": [
                "StrongPity",
                "G0056"
            ],
            "source_name": "MISPGALAXY:PROMETHIUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716502,
    "ts_updated_at": 1743041831,
    "ts_creation_date": 1482242171,
    "ts_modification_date": 1482242171,
    "files": {
        "pdf": "https://archive.orkl.eu/31b0c92ff842596ed58185bb84c7dc4542059e85.pdf",
        "text": "https://archive.orkl.eu/31b0c92ff842596ed58185bb84c7dc4542059e85.txt",
        "img": "https://archive.orkl.eu/31b0c92ff842596ed58185bb84c7dc4542059e85.jpg"
    }
}