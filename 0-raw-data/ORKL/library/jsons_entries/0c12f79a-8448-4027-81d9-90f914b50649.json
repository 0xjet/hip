{
    "id": "0c12f79a-8448-4027-81d9-90f914b50649",
    "created_at": "2022-10-25T16:48:20.307091Z",
    "updated_at": "2025-03-27T02:17:23.223585Z",
    "deleted_at": null,
    "sha1_hash": "ff76a59ab85b581b5cc23114fd2b7c09c7b582c5",
    "title": "VB2018-Kalnai-Poslusny-branded-REFS-AT-END-updatedref29.indd",
    "authors": "",
    "file_creation_date": "2019-09-11T12:24:08Z",
    "file_modification_date": "2019-09-11T12:24:08Z",
    "file_size": 1199618,
    "plain_text": "### WWW.VIRUSBULLETIN.COM/CONFERENCE\n\n\n# LAZARUS GROUP: A MAHJONG GAME PLAYED WITH DIFFERENT SETS OF TILES\n### Peter Kálnai & Michal Poslušný ESET, Czech Republic\n\n {peter.kalnai, michal.poslusny}@eset.cz\n\n ABSTRACT\n\nThe number of incidents attributed to the Lazarus Group, a.k.a.\nHidden Cobra, has grown rapidly since its estimated\nestablishment in 2009. This notorious group intensifi ed its\nefforts in 2017 (e.g. the attacks on Polish and Mexican banks,\nthe WannaCryptor outbreak, the spear-phishing campaign\nagainst US contractors), and kept up the pace at the turn of the\nyear (the Android-ported payloads, the bitcoin-oriented attacks,\nthe Turkish campaign, and more). Attribution of these newer\ncases was determined by observing similarities with previously\nresolved cases: specifi c chunks of code, unique data, and\nnetwork infrastructure. In this paper we summarize the crucial\nlinks that played a role in these major cases.\n\nThe source code of the group’s toolset appears to be modifi ed\nwith every attack. There are several static features that vary\nbetween the instances: dynamic Windows API resolution and the\nobfuscation of procedure and library names, the form of selfdeleting batch fi les, the list of domains leveraged for fake TLS\ncommunication, the format strings included in TCP backdoors,\nthe use of commercial packers, etc. The variety is so huge that it\nsuggests that the Lazarus group may be split into multiple,\nindependent, code-sharing cells. Our research investigates this\nidea further by exploring the undocumented PE Rich Header\nmetadata, which once again indicates that there are various\ndevelopment environments producing the malicious binaries.\n\nThere are also several binaries from the Lazarus toolset that have\nnot been publicly reported. Our study of these samples adds some\ninteresting fi ndings to the Lazarus puzzle: the very fi rst iteration\nof WannaCryptor from 2016, in-the-wild experimentation with\nthe malicious Java downloaders targeting multiple platforms, the\nuse of a custom malware packer, and the presence of strange\nartifacts like Chinese language or South Korean cultural\nreferences. This paper will present previously unpublished details\nabout the cyber-sabotage attack against an online casino in\nCentral America from late 2017, and we will reveal the modus\noperandi of the Lazarus cell that was behind that attack.\n\n### INTRODUCTION\n\nThe activity of Lazarus toolset components can be traced back\nas far as 2009. Several typical Lazarus backdoors were uploaded\nto VirusTotal that year, e.g. netprov.dll and dvcmgmt.exe\n\n[1]. However, the fi rst published identifi cation of the so-called\nLazarus Group and its toolkit was not until many years later in\n_Novetta’s extensive papers [2] in February 2016. The fi rst_\nmention of Lazarus at a Virus Bulletin conference was also in\n2016, when Bartholomew and Guerrero-Saade of Kaspersky\n\n\n_Lab described the pseudo-hacktivism tendencies of two famous_\nLazarus attacks [3]. Since 2017, especially after the\nWannaCryptor outbreak, the number of Lazarus-related reports\nhas proliferated. In this paper, we summarize the crucial\nfi ngerprints that led malware researchers to attribute the famous\ncases to the group, and discuss the main characteristics that have\nhelped us to ascribe further samples to the group. Finally, we\nshow six suspected Lazarus-related cases that we believe are not\nwidely known.\n\n_ESET detects known Lazarus malware mostly as_\nWin32/NukeSped, Win64/NukeSped, Android/NukeSped or\nPowerShell/NukeSped. USCERT and the FBI call the group\nHidden Cobra [4].\n\n### REPORTED CASES\n\n Operation Troy and DarkSeoul\n\nLazarus Group fi rst came into the spotlight in 2013, when reports\nabout two of their campaigns in South Korea were published for\nthe fi rst time. The long-term campaign called Operation Troy was\na cyber espionage operation against South Korean armed forces\nand government targets, and ran between the years 2009 and\n2012. The second of these campaigns, called DarkSeoul, occurred\nin 2013 and mainly targeted the South Korean fi nancial sector.\nBinaries involved in these operations often preserved symbol\npaths[1] – details can be found in [5, 6]. ESET detects most of the\nmalware known to have been used in these campaigns or similar\nas Win32/Spy.Keydoor or Win64/Spy.Keydoor.\n\n### Operation Blockbuster – the saga, the sequel and going mobile\n\n_Sony Pictures Entertainment went through a very tough period_\nin 2014, when the company was the victim of one of the most\ndestructive cyber attacks against a commercial entity to date.\nThe attack caused major damage to the company, and many of\nits internal fi les and documents were stolen, leaked or deleted.\nThe binaries involved in the attack, as well as legions of\nstatically similar fi les were later extensively described by\n_Novetta [2][2], which named the attack ‘Operation Blockbuster’._\nRegarding the many common overlapping characteristics of\nbinaries, this epic report was preceded by Symantec’s report [7]\nby several months and, a year later, was followed by Palo Alto\n_Networks’ series of blog posts: The Blockbuster Sequel [8], The_\n_Blockbuster Saga Continues [9] and Operation Blockbuster_\n_Goes Mobile [10]. The new attacks were tied to Lazarus by the_\nre-use of self-deleting batch fi les, format strings in the TCP\nbackdoors, dynamic API loading routines, obfuscation of\nfunction names, and the use of fake TLS communications.\n\n1 For example, Z:\\1Mission\\Team_Project\\[2012.6 ~]\\HTTP Troy\\\nHttpDr0pper\\Win32\\Release\\3PayloadDll.pdb or D:\\Work\\Op\\Mission\\\nTeamProject\\[2012.11~12]\\TDrop\\Payloadll32\\Release\\Payloadll32.\npdb. We have found only two NukeSped samples with paths:\nE:\\ConstructSystem\\widebot\\bot_dll\\Debug\\bot_dll.pdb\nD:\\Source\\Source_C\\Work_Source\\T(3.1_Unicode)\\Server_\\x64\\\nRelease\\ServerDll.pdb\n2 We used a very similar hunting method to the one described in Section\n2.1 of [2] to fi nd newly linked Lazarus executables.\n\n\n-----\n\n### WWW.VIRUSBULLETIN.COM/CONFERENCE\n\n\n### SWIFT attack in Bangladesh\n\nA story that is perhaps more fi tting to a Hollywood movie\nunfolded in February 2016, when the SWIFT payment system\nwas abused to steal more than $80m from Bangladesh’s central\nbank [11]. Claims of similarity between this and Operation\nBlockbuster were based on many relatively weak details, with\nthe characteristics of self-deleting batch fi les and shared code\nchunks being the most relevant [12].\n\n### Polish and Mexican banks\n\nHot news about successful attacks against Polish banks\nappeared in February 2017 on the Polish security portal\n_ZaufanaTrzeciaStrona.pl [13]. The impact of the attacks was_\ndescribed dramatically as ‘we are dealing with the most serious\ndisclosed attack on critical infrastructure and the banking sector\nin the history of our country’. Blog posts from Symantec [14]\nand BAE Systems [15] immediately supported the initial report.\nThe link to the Lazarus Group was made through a part of the\nself-deleting batch fi les, through the encrypted strings involved\nin the dynamic API loading routines (Table 1), which were all\nshared with earlier Lazarus spreading tools, and through the fact\nthat a victim reported the presence of an already Lazarusattributed fi le. Kaspersky Lab covered two incidents in [16]: this\none and one follow-up of the previously mentioned SWIFT\nattack.\n\n_2FAcHI224$A_q8gS0dK NetShareEnum\n\n!VWBeBxYx1nzrCkBLGQO NetShareDel\n\n!uRa9t1tCDeS197CPt7I NetShareAdd\n\n!emCFgv7Xc8ItaVGN0bMf netapi32.dll\n\n_Table 1: Strings decrypted by the key ‘#iamsorry!@1234567’._\n\nThe threat was distributed via a watering hole attack, wherein a\ntrusted but compromised website redirected to a landing page\nbooby-trapped with a (non-zero-day) exploit. In the case of the\nPolish attacks, the starting point was the offi cial website of\nKomisja Nadzoru Finansowego (the Polish Financial Supervision\nAuthority), while in the Mexican case it was the website of the\nMexican equivalent, Comisión Nacional Bancaria y de Valores\n(National Banking and Securities Commission). We presented\nour fi ndings relating to the technical details of the until-then\nminimally documented malware on WeLiveSecurity [17].\n\nAnother interesting discovery in this case was a backdoor with\nan unusual feature in how it parsed commands from operators.\nThe operators were using commands in Russian, presented in a\ntranslit – a method of encoding Cyrillic letters into Latin ones.\nThis language choice is considered a false fl ag for various\nreasons. One is that malware authors usually implement\ncommands via numbers or English shortcuts. For example,\ninstead of having a one- or two-digit, or natural, seven-letter\nEnglish word command, ‘install’ was implemented as the\nimpractical 12-letter command ‘ustanavlyvat’, which\ntransliterates ‘устанавлыват’ (unsurprisingly, Russian for\n‘install’). Moreover, Kaspersky Lab’s researchers said ‘the\nRussian words in the backdoor looked like a very cheap\nimitation’ [16, p.17].\n\n\n### WannaCryptor outbreak\n\nOn 12 May 2017 much of the world was shaken when the\nLazarus Group launched its large-scale ransomware cyber attack,\nWannaCryptor.D (a.k.a. WannaCry, WCrypt). The malware was\nspread using an exploit called EternalBlue that had been made\npublic a month prior to the attack. While Microsoft had released a\npatch for the exploit nearly two months before the attack, many\nsystems remained unpatched, and that, essentially, was the reason\nthe outbreak was so huge. The damages caused by the attack were\nenormous and had real-life consequences all around the world,\ndisrupting many crucial systems and services including many\nhospitals in the United Kingdom. The incident has been covered\ncountless times, e.g. [18, 19], and a screenshot showing the\nransom message became widely recognizable.\n\nThe ransomware’s GUI, u.wnry, was contained in a passwordprotected dropper called taskshe.exe. The window caption\ncontained ‘Wana Decrypt0r 2.0’ and the compilation time in the\nPE header was altered to 13 July 2010 – the timestamp of\nLODCTR.EXE, the original Microsoft fi le from which this fi le’s\nversion information was copied.\n\nWannaCryptor had a longer evolution than originally thought.\nJust a few weeks before the outbreak, an almost identical\nransomware executable was spread via SMB brute-forcing, but\nit had minimal impact and therefore stayed under the radar. The\nin-the-wild name of a dropper encapsulating that earlier variant\nwas usually taskhcst.exe and it contained the embedded\npayload u.wry. The payload had the same design as its\ninfamous successor, with just some slight differences such as\nthe window caption ‘Wana Decrypt0r 1.0’ and the original PE\ntimestamp of 9 March 2017.\n\nEven earlier that year, on 10 February, a dropper called\ntaskschs.exe was uploaded to VirusTotal, with a compilation\ntime of just a day previously. It contained a ransom payload\nnamed taskmsgr.exe, which shared many static similarities\nwith the two previously described payloads, in particular the\ncharacter strings and the structure of resources. However, the\ndesign of this ‘beta’ version was a bit different [20].\n\nThe earliest attribution of WannaCryptor to Lazarus was a\ncryptic Tweet by Neel Mehta [21]. It highlighted similarities in\ntwo fi les: the beta version of WannaCryptor and an older\nLazarus backdoor from 2015, the two sharing unique\nhexadecimal strings in their code sections.\n\n### Bitcoin-oriented attacks\n\nIn late 2017, the Lazarus Group launched various\ncryptocurrency attacks that stole bitcoin from many South\nKorean users and also eventually hacked and bankrupted a\nSouth Korean cryptocurrency exchange [22]. The overall picture\nof the Lazarus modus operandi remained the same: decoy\ndocuments in Korean and the payload being executed in a\ncascade with multiple stages, the fi nal one being a backdoor\nsupporting several commands. However, there was a shift in the\nattack style: where portable executables had previously been\nused to download or execute the attacker’s commands, now\nPowerShell scripts served that purpose. Note that the attribution\nof these attacks was made through unique links (HTTP\n\n|_2FAcHI224$A_q8gS0dK|NetShareEnum|\n|---|---|\n|!VWBeBxYx1nzrCkBLGQO|NetShareDel|\n|!uRa9t1tCDeS197CPt7I|NetShareAdd|\n|!emCFgv7Xc8ItaVGN0bMf|netapi32.dll|\n\n\n-----\n\n### WWW.VIRUSBULLETIN.COM/CONFERENCE\n\n\nresponses from the C&C, such as killkill or success) with\nthe Polish and Mexican banks case. Interestingly, some of the\nstages were based on code available from open-source\nrepositories [23].\n\nIn early 2018, another bitcoin-stealing campaign called HaoBao\nwas disclosed [24]. The attribution in this case was based on\nmalicious documents which had the same metadata and\nfi lenames of dropped implants as those in Palo Alto Networks’\nreports [8, 9]. However, there were no obvious static links\npresent in the implants and they were compiled with Visual\n_Studio 2015. From our point of view, that places this campaign_\noff-centre from the usual modus operandi.\n\n### The Turkish Bankshot\n\nIn March 2018, McAfee reported the reappearance of the\nBankshot implant, a spear-phishing campaign against Turkish\nfi nancial institutions [25]. The malware was an HTTP backdoor\nsupporting 27 commands. The attribution of this toolkit was\nimmediate, based on its overall functionality. More details about\nrelated attacks can be found in [26, 27, 28].\n\n### TOOLSET CHARACTERISTICS\n\nWe have collected a list of the main characteristics that can be\nused to identify a sample from the Lazarus toolset. Besides the\ncharacteristics described in the following subsections, the\nsamples were double-checked for additional signs that could\nlink them to the Lazarus toolset, e.g. the connection\ninfrastructure or the metadata of the documents that dropped\nthem. Figure 1 shows a typical initial stage of a multi-staged\n\n\nLazarus malware attack (the property of being multi-staged is\nthe invisible (1)): a console application accepting several\nparameters (2) that has its Windows APIs resolved at the start\n(3) and drops the additional stages from the resources (4) using\nan RC4-like stream cipher (Spritz).\n\n### Dynamic resolution of Windows APIs\n\nA disassembly of Lazarus’ dynamic resolution of Windows APIs\nis seen in Figure 1. The technique is very typical and has\nalready been described [2, p.59]. Appendix A shows various\nalternatives of the eight particular Windows APIs. The table is\nnot complete, e.g. the clusters with APIs resolved on the stack,\ncharacter-by-character or by double-words, are omitted. In those\ncases, the variation of the decryption keys led to many different\ntypes that would make the table unreadable.\n\n### TCP backdoors\n\nA relatively simple TCP backdoor supporting tens of commands\nis another of the chord-striking traits of Lazarus malware. The\ncommands are usually indexed by consecutive integers. One of\nthem is an execution in the command line (see Figure 2), where\nthe action is basically the execution of the console command\ncmd.exe /c %Source% > %LogFile% 2>&1, where\n%Source% is a malicious executable and %LogFile% is its\noutput. We have found a number of methods the Lazarus Group\nuses to format the string; these are shown in Appendix B.\n\nOccasionally, the formatting of the console command cmd.exe\n/c netsh fi rewall add portopening TCP\n%PortNumber% \"%PortName%\" varied as well.\n\n\n_Figure 1: Decompiled pseudo-code of the dropper from the Polish bank attacks._\n\n\n-----\n\n### WWW.VIRUSBULLETIN.COM/CONFERENCE\n\nof a fake TLS packet that mimics the TLS protocol and seemingly\ninitiates a legitimate connection (see Figure 3). There were\nmultiple distinct sets maintaining the low profi le, as shown in\nAppendix C. The presence of naver.com in the sets indicates\nthat traffi c from the #3-ranked[3] site in South Korea is expected to\nbe found on compromised systems. Next, can we infer that the\nattackers have not excluded victims from China or Russia, as\nbaidu.com is ranked #1 in China and vk.com is ranked #1 in\nRussia?\n\n### Self-deleting batch fi les\n\nSelf-deleting batch fi les are deployed to sweep away evidence\nof the presence of the initial malware stages after a successful\ninfi ltration. Many components of the Lazarus toolkit have such\na capability, and self-deleting batch fi les are very commonly\nused to provide this functionality. As for the previous\ncharacteristics, there is a huge variability in the precise form of\nthe batch fi les; see Appendix D.\n\n### PE Rich Header metadata\n\n\n_Figure 2: The commands of a backdoor indexed by integers._\n\n### Fake TLS protocol\n\nTLS protocol spoofi ng has been observed several times as a way\nto increase the stealthiness of malicious network communication.\nThis is achieved by sending the bot’s client-server traffi c as a part\n\n\nA PE Rich Header is a part of a Windows executable generated\nby the Microsoft linker when compiling a PE using Visual\n_Studio. It contains information about objects used during the_\ncompilation. Despite the fact that information stored in the PE\nRich header is not offi cially documented, there are several solid\nresearch articles that attempt to describe what is stored inside\nthe header, e.g. [29, 30]. We analysed the PE Rich header data\n\n3 Ranking by Alexa.com, June 2018.\n\n\n_Figure 3: Creating the buffer for the fake TLS on the stack._\n\n\n-----\n\n### WWW.VIRUSBULLETIN.COM/CONFERENCE\n\n\nof samples from our Lazarus sample sets and found some\ninteresting information.\n\nFirst, we had to clean the data sets – in order to gain an accurate\npicture of the timeline, only the samples that had an untampered\nPE timestamp were considered.[4] We ended up with ~600\nunique, strongly linked 32-bit samples and tried to discover\nwhich build environment(s) their authors had used. Around 80%\nof the fi les were built in Visual Studio 98 – from the oldest\nbackdoors up to samples compiled in September 2017, which\nwas actually the very last involvement of that ‘ancient’ IDE we\n\n4 In [31], we showed several cases when the PE timestamp modifi cation\ncould be detected.\n\n\nregistered. About 15% of samples in this collection were\ncompiled in Visual Studio 2010. The very fi rst of these from our\ndataset were compiled in March 2015 and were included in\n_Symantec’s report [7]. We have seen this IDE being used even_\nfor samples from 2018, including the tools involved in an\noperation against a Central American casino, which we describe\nlater in this paper. The remaining 5% was divided among the\nmost recent editions of Visual Studio, i.e. 2012, 2013, 2015. The\nbinaries reported by Proofpoint [22] had PE timestamps from\nJuly and December 2017 and were built with a mixture of VS\n_2010 and VS 2015 products, with the latter one being used for_\nthe fi rst time in a Lazarus case. Finally, the Turkish and HaoBao\ncampaigns reported by McAfee [24, 25] involved executables\n\n\n_Figure 4: Timeline of the Visual Studios by the Rich header, 32-bit._\n\n_Figure 5: Timeline of the Visual Studios by the Rich header, 64-bit._\n\n\n-----\n\n### WWW.VIRUSBULLETIN.COM/CONFERENCE\n\nwith compilation timestamps in 2018 and were produced with\nthe VS 2015 environment. No in-the-wild signs of Lazarus using\n_VS 2017 have been observed yet. It is very important to note_\nthat the use of observed build environments overlapped, with\nmany Visual Studio versions used, which surprised us, as we\nexpected the environments to be upgraded and change over time\nin a single continuous timeline.\n\nFor the 64-bit counterpart, the situation was far more\nhomogeneous. The dataset contained ~140 unique samples and\na convincing 95% of the samples from the set were generated in\n_VS 2010[5], which is in agreement with the fraction of two most_\nprevalent IDEs in the 32-bit dataset. The remaining 5% of\nanomalies corresponded to the 32-bit case as well. The PEs by\n_VS 2012 seemed like predecessors of tools from the Turkish_\ncampaign and the executables built with VS 2015 were 64-bit\nvariants of the binaries in the HaoBao attacks.\n\n\nThe biggest takeaway from exploring the PE Rich Header data\nis the fact that there are samples built in multiple different IDEs\nsimultaneously. We conclude that the group is not a single entity\nand that there are at least two main development units, labs or\ncells. Moreover, the anomalies might suggest that the closed\nsource is from time to time available for an unknown entity –\ncould it have been shared with a unit tasked with jobs not\ndominantly responsible for Windows development? Was it\noutsourced externally for code review/testing? Or had the code\njust leaked to an unauthorized person?\n\n### CAUGHT SAMPLES\n\nThis part is the main contribution of this paper. We tried to\nassociate the samples described below with the Lazarus toolset\nin a similar fashion to that in which it was done in the famous\ncases described earlier. For the most part, our confi dence in the\nlink is strong.\n\n### WannaCryptor from 2016\n\nThis brings us to the project that seemed to be at the very\nbeginning of the WannaCryptor’s development, an early alpha.\nOn 2 September 2016, a fi le called hpmessage.exe, compiled\njust a few days earlier, was uploaded to VirusTotal. It had almost\nthe same design as the ‘beta’ version, in which the ‘Start\nDecrypt’ button replaced the alpha’s triple ‘Price List’,\n‘Download Key’ and ‘Run Decryptor’. ESET LiveGrid® spotted\nthis sample under the %STARTUP% location, which suggests it\nmight have been tested in the wild.\n\n### Multi-platform Java downloaders\n\nIn February 2017, we discovered suspicious activity on\nhxxp://vip95.ddns.net:7310. Two Java downloaders,\ncalled myBT.jar and mytd.jar, were hosted there and\nattempted to deliver additional fi les to the system they ran on.\nThe payload seemed to be prepared for multiple platforms,\nnamely Windows and Linux (see Figure 7). However, the Linux\nbranch was obviously in a testing phase, because there are a lot\n\n5 VS 2010 was one of the fi rst versions to support compilation of 64-bit\nbinaries by default, so there could not be any such samples compiled in\n_VS 98._\n\n\n_Figure 6: The ransom screen of the alpha WannaCryptor, 2016._\n\n_Figure 7: Windows or Linux branch in one of the Java_\n_downloaders._\n\nof architectures that Linux can run on but the downloader did\nnot check them. Moreover, the fi le jre_1_5_0_linux.bin\nwas not hosted on the expected path.\n\nThere were several payloads for Windows. The executable fi les\ndi86.dat and di64.dat were referred to as ‘installers’ in the\ncode, while the encrypted fi les dp86.dat and dp64.dat were\n‘packages’. The param.dat fi le contains the parameter and the\nRC4 key for the installers to decrypt them and load as Windows\nservices (-il ndylpqtvabadplaf). Two additional stages\nwere dropped by the packages: a basic keylogger and a variant\n\n\n-----\n\n### WWW.VIRUSBULLETIN.COM/CONFERENCE\n\n\nof the backdoor for which the 32-bit instance was already\ndescribed as RomeoDelta in [2]. This, together with weak signs\nlike dynamic Windows API resolution and data decryption with\nRC4, helped us to conclude that all of the hosted fi les are\nsignifi cantly linked to Lazarus.\n\n### Custom malware packer\n\nSometimes malware distributors decide to use a packer in order\nto increase the chance of avoiding detection by a security\nsolution and to harden the binary against analysis. They tend to\nuse commercial packers like VMProtect, Enigma Protector or\n_Themida, but we recorded few instances where they also used a_\ncrypter – a custom malware packer. In this case, the crypter is a\nmodifi ed version of a public project commonly known as\nDXPack that has been released as a series of ‘Developing a PE\nfi le packer’ tutorials on its author’s personal blog [32]. DXPack\nis an example of a low-hanging fruit on the Internet that\nprovides the attackers UPX-like features to encapsulate their\nmalware, with the difference that there is no existing, public\nstatic unpacker.\n\nThe crypter can be identifi ed by certain specifi c properties of\nthe PE header. The most notable characteristic is the order of the\nsections. Files packed with DXPack always starts with a ‘.rsrc’\nresource section, which contains imported functions and\nencrypted data; it is followed by the ‘.text’ code section, unlike\nin most ordinary executables, where the ‘.text’ section is almost\nalways at the beginning of the fi le.\n\nAnother notable feature is that the NT header starts inside the\nDOS header, and partially overwrites it. This is achieved by\npreserving the lfa_new offset from the DOS header that points\n\n\ninside itself, where the NT header starts (in the case of DXPack)\nat offset 0x10 (see Figure 8).\n\nDXPack also has a specifi c entry point that can easily be\nrecognized. Compared to the commercial protectors, unpacking\nDXPack does not pose much of a challenge.\n\nThe attribution to the Lazarus toolset was made by the presence\nof two unique strings, ‘E:\\OpenSSL32_x86\\certs’ and\n‘E:\\OpenSSL32_x86\\cert.pem’, found in the unpacked code\nin memory. These strings can be strongly linked to Lazarus\nbecause they are found in the dropped implants mentioned in\n_Palo Alto Networks’ report [9]._\n\n### South Korean TV series\n\nWe have found a server-side component from the Lazarus\ntoolset that has been deployed on an infected endpoint. The\ncomponent contains a list of South Korean TV series (Table 2)\ninside the binary as well as a list of big corporations (Table 3),\nwhich served as the attribution link because the samples from\nthe WannaCryptor outbreak had the same list. The names of TV\nseries in Mandarin Chinese are encoded in the form of Pinyin\nromanization, which means they are spelled in Latin characters\nwithout tone marks. The component is a server-side application\nthat is most likely deployed on compromised machines that are\nthen used as C&C servers. It is large and written in objectoriented programming style, which is a big contrast compared\nto the group’s client-side tools that tend to be minimalistic and\nas straightforward as possible. This server-side element\nmanages client connections by utilizing I/O completion ports,\nwhich are usually used in high-performance server applications\nas an elegant solution to manage many clients at once. It accepts\n\n\n_Figure 8: The start of the NT header and the missing DOS stub._\n\n\n-----\n\n### WWW.VIRUSBULLETIN.COM/CONFERENCE\n\nmamashishenme.avi yunaweinizhaixinglanyue.avi\n\nyinweishinicaixihuan.avi kenengaiguoni.avi\n\nyiranshini.avi gongwodeyemanwangfei.avi\n\nrenshengnizhuan.avi erzimen.avi\n\ngeiniyiqianwan.avi anquanwubaozhang.avi\n\nheiyingjiazu.avi niuyaoliangriqing.avi\n\nduxiamahuali.avi mingyuanwangzu.avi\n\nbabudemama.avi zaowangzhe.avi\n\nhuidaosanguo.avi feimaozhengchuan.avi\n\nxingqiudazhan.avi zuigaojilu.avi\n\ngansidui2.avi banamacaifeng.avi\n\nwokoudezongji.avi nuhuojietou2.avi\n\njufengyingqiu.avi nanquanwang.avi\n\n_Table 2: Arrays of strings in the server: South Korean TV series._\n\nGoogle Yahoo Adobe Mozilla Intel NVIDIA\n\nTencent Rising 360Safe Skype Amazon\n\n_Table 3: Arrays of strings in the server: corporations._\n\n|meiyounihuobuxiaqu.avi|mamashishenme.avi|yunaweinizhaixinglanyue.avi|disanyiyuan.avi|\n|---|---|---|---|\n|zuijiaaiqing.avi|yinweishinicaixihuan.avi|kenengaiguoni.avi|shanliangdenanren.avi|\n|dafengshui.avi|yiranshini.avi|gongwodeyemanwangfei.avi|bizuijiazu.avi|\n|wulalafufu.avi|renshengnizhuan.avi|erzimen.avi|MayQueen.avi|\n|dawangdemeng.avi|geiniyiqianwan.avi|anquanwubaozhang.avi|meinanji.avi|\n|anquanwubaozhang.avi|heiyingjiazu.avi|niuyaoliangriqing.avi|molimaike.avi|\n|yaogunshidai.avi|duxiamahuali.avi|mingyuanwangzu.avi|kalawuqi.avi|\n|tiandiyinqing.avi|babudemama.avi|zaowangzhe.avi|dataijian.avi|\n|feihu.avi|huidaosanguo.avi|feimaozhengchuan.avi|huhuaweiqing.avi|\n|meilijiuba.avi|xingqiudazhan.avi|zuigaojilu.avi|jisu60miao.avi|\n|liukezidan.avi|gansidui2.avi|banamacaifeng.avi|yibenwuyan.avi|\n|shenhaiqianlong.avi|wokoudezongji.avi|nuhuojietou2.avi|leitingsaodu.avi|\n|tianti.avi|jufengyingqiu.avi|nanquanwang.avi||\n\n|Google|Yahoo|Adobe|Mozilla|Intel|NVIDIA|\n|---|---|---|---|---|---|\n|Tencent|Rising|360Safe|Skype|Amazon||\n\n\na port number as an optional command-line argument which is\nused for listening, otherwise it checks the hard-coded port\nnumbers like 443, 22, 1433, 3306, etc. The confi guration of the\napplication is stored in the INI fi le data\\package_con_x86.\ncat with names like the port number and a bot identifi er, all\nstored in a single section called Fuwuqi – the romanized\nChinese word ‘ ’ for ‘server’.\n\nWe have found a few similar server binaries that were compiled\nbetween 2016 and early 2017, but we are not sure in which\ncampaigns were they used, or what exact purpose they served in\nthose campaigns.\n\n### Online casino KillDisk-ed\n\nLazarus gained notoriety as a relentless cyber-sabotage group\nfollowing its attack against Sony Pictures Entertainment in\n2014. That reputation remains untarnished if we fast-forward to\nlate 2017 on the Lazarus timeline, when the group, or operators\nclosely related to it, chose a Central American online casino as a\ntarget. After obtaining access to remote control tools used by the\ncompany’s administrators, such as Radmin 3 and LogMeIn, they\ndeployed various malicious tools, including disk-wiping\nmalware from the KillDisk family.\n\nKillDisk is a generic detection name that ESET uses for\nmalware with destructive capabilities such as damaging boot\nsectors or overwriting and deleting (system) fi les, followed by a\nreboot to render the machine unusable. Although all KillDisk\nmalware has similar functionality, as a generic detection,\nindividual samples do not necessarily have strong code\nsimilarities or relationships. For example, the cyber attacks\nagainst high-value targets in Ukraine in December 2015 [33]\nalso employed KillDisk malware, but those samples were from\ndifferent KillDisk sub-families, and therefore are almost\ncertainly unrelated to the Central American casino attack.\n\n\nWe reported on this case in [34], with details of the attackers’\ntools – namely the KillDisk variants, the TCP backdoor, the\nsession hijacker, Browser Password Dump and Mimikatz – and\nattribution to the Lazarus Group.\n\nWith a high level of confi dence, we made the attribution based\non two crucial factors. First, the TCP backdoor used in this\nattack strongly reminds us of other known Lazarus backdoors\nin terms of static properties – this kind of attribution has been\nmade in many major cases related to Lazarus. Second, the\nsession hijacker was a Themida-protected version of one used\nin the attacks against Polish and Mexican banks [16, p.33].\nThe scenario that some unrelated hacking group wanted to\nimpersonate Lazarus can’t be ruled out completely, but we\nthink it is very unlikely in this case. The attackers would have\nto reverse engineer and re-implement too many closed-source\ntools and mimic the modus operandi very persuasively.\nMoreover, the session hijacker was strongly protected, which\nmakes no sense if they wanted to use it as a false fl ag. The\nattackers chose a rather cynical C&C domain for the victim\n– lovebet.publicvm.com. This example supports the\nconjecture that every attack is customized for its targets.\n\n### Strange CoinMiner\n\nThe following case is an example where our confi dence of the\nlink with Lazarus is just low-to-medium. The initial\ncompromises were restricted exclusively to Zoho systems\nrunning the ManageEngine ServiceDesk software, very\nlikely through vulnerabilities that were disclosed in February\n2018 [35]. The revenue for the attackers was very low, mining\nonly ~2.31 XMR in several weeks. The next campaign,\nhowever – in May 2018 and targeting medium-sized corporate\nnetworks – was at least 10 times as successful in just a few\ndays.\n\n\n-----\n\n### WWW.VIRUSBULLETIN.COM/CONFERENCE\n\n**Feature** **Value**\n\n**di64.dat** **WinSock2-64**\n\nprodidUtc1600_C = Visual Studio 2010 (10.00) build 30319 Count = 106 109\n\nprodidUtc1600_CPP = Visual Studio 2010 (10.00) build 30319 29 34\n\nprodidMasm1000 = Visual Studio 2010 (10.00) build 30319 10 9\n\nRC4 classic custom\n\n*.sdb fi lenames application edb\n\nsystem secpol\n\nsecurity\n\nService name Bluetooth support WinSock2Svc\n\n_Table 4: Comparison between a Lazarus bot and the coin miner._\n\nThe components responsible for coin mining are stored in an\nencrypted form on the fi le system: edb.sdb and secpol.sdb\nin %WINDOWS%\\security\\. The fi lenames rang bells with us,\nbecause the installers from the vip95.ddns.com storage, that\nwe have attributed to Lazarus strongly, also used this folder to\ninstall their malicious Windows services.\n\nIn Table 4, the similarities of 64-bit variants germane to the\nsource code are sketched. Obviously all projects were compiled\nwith the same edition of Visual Studio 2010.\n\nThe service maintaining the coin-mining components used a\nmodifi ed version of the RC4 algorithm – one of the indices of\nthe swapped entries was doubly incremented each iteration\nwhilst the original RC4 increments it only once. This easily\noverlooked change is in the pseudo-ransom generation part of\nthe cipher.\n\n### CONCLUSION\n\nConsidering the scale of the Lazarus operations, together with\noften severe impacts on their victims, even on a global scale, the\ngroup is clearly well organized. We see that the group continues\nto be a threat all around the globe, even more than a decade\nsince its fi rst recorded appearance. The group tends to achieve\nhigh outcome with minimum effort, and usually reuses already\ninvented proofs of concepts and tools, only very rarely creating\nanything from scratch. The group doesn’t seem to have a single\ngoal, and while sometimes they steal in order to obtain funds,\nthe next time they strike may be cyber espionage with\ndestructive malware.\n\nThe attribution was not straightforward in most of the cases\ndiscussed in this paper, and it often depends on fi ne details. The\ndiversity of the tools involved and approaches taken is so wide\nthat it is really hard to believe that they all come from a single\nenvironment. This, together with the results of the PE Rich\nHeader analysis, leads us to believe that there are multiple code\ndevelopment units. These units may, or may not, be pulling in\nthe same, one-way direction.\n\n|Feature|Value|Col3|\n|---|---|---|\n||di64.dat|WinSock2-64|\n|prodidUtc1600_C = Visual Studio 2010 (10.00) build 30319|Count = 106|109|\n|prodidUtc1600_CPP = Visual Studio 2010 (10.00) build 30319|29|34|\n|prodidMasm1000 = Visual Studio 2010 (10.00) build 30319|10|9|\n|RC4|classic|custom|\n|*.sdb fi lenames|application system security|edb secpol|\n|Service name|Bluetooth support|WinSock2Svc|\n\n\n-----\n\n### WWW.VIRUSBULLETIN.COM/CONFERENCE\n\n APPENDIX A\n\nLoadLibraryW, WinExec, OpenProcess, Sleep, GetLogicalDrives, connect, ChangeServiceConfi g2W, GetAdaptersInfo\n(The attacks against Polish and Mexican banks)\n\n-, -, -,-, -, S^connect, S^ChangeServiceConfi g2A, (Op. Troy, but with many S^-prepended functions from wininet.dll)\n\nLo.adL_ibr.ar_yW, ..W_.in..Ex...ec, Op.enPr..oce_ss, Sl._._eep, ..Get.__Logi...calD__.rives, con_._nect,\nCha._.ngeSer....vice_.Con.fi g2W., GetA_._dap...ters___In_.fo\n(Op. Blockbuster)\n\nLo.adL_ibr.ar_yA, -, Ope.n_P.ro._cess, S..l.ee.p, Ge.tL.ogi.ca_lDr..ives, c_..onn..ect, Cha.nge.Ser.vi_.ceCo.\nnfi g2A, G.etAd.apte.rsI..nfo\n(Op. Blockbuster)\n\nSB2uSeCV2VDt, teb3MAc, raAbWVBcAOO, K4AAa, yAYSBiec24EVenAO, cBbbAcY, pz2biAKAVnecApBbxeift, yAY6u2aYAVOJbxB\n\nWyrarbiLdaoL, cexEniW, ssecorPnepO, peelS, sevirDlacigoLteG, tcennoc, W2gifnoCecivreSegnahC, ofnIsretpadAteG\n\nWdaoWtbgagyA, LtnPmpc, DepnEgdcphh, Hwppe, RpiWdrtcawOgtkph, cdnnpci, CsanrpHpgktcpCdnqtr2A, RpiAoaeipghTnqd\n\nLxadLrbiaipA, WrwEoec, OyewPixcejj, Sueey, GekLxgrcauDirmej, cxwweck, ChawgeSeimrceCxwfrg2A, GekAdaykeijIwfx\n\n-, WrmEcvx,OkvmPilxvhh, Sovvk, GvgLltrxaoDirevh, xlmmvxg, CsamtvSvierxvClmurt2W, GvgAwakgvihImul\n(Op. Blockbuster The Sequel)\n\ns7gOsvowgwTx, cvZR8YC, 9bYZ3w7CYii, zDYYb, 2Yqs7avCgDFwvQYi, C7ZZYCq, regZaYzYwQvCYr7Z6vamx, 2YqxOgbqYwiKZ67\n\n-,-, 3VHJd7mxyuJGZrA=, wU3JfJk=, 1UTYVYakzOJCeYdXb+H60g==, 8U7Cd4yg0Q==, -, 1UTYWI2i1fVGZ7BsaPHw\n\nLoadLxbrarjA, WxnEitc, OptnProctss, Slttp, GteLovxcalDrxgts, conntce, CwanvtStrgxctConuxv2A, GteAdapetrsInuo\n(Op. Blockbuster)\n\n{9F 66 0A CB 85 C2 09 2E 29 AD 4B 6C F4}, {8E 78 A8 98 88 2B 37 97}, {CF 56 90 79 70 51 00 90 9D BE 82 91}, {0B\n14 D1 59 41 06 D9 F5}, {F9 C4 08 10 40 4D F9 04 86 1F A6 62 5A 4A 68 27 05 76 5B D0 9A DE}, {E7 D2 9D 4C 45 4E\nE2 B6 06 62 24 EA 69 CD 57 67}, {54 AE 43 F9 DD C8 4F 43 4A DA D5 70 11 13 A5 90 4F}\n\n-, -, {0C 02 84 EA CC BA 34 1C 74 49 87 78 C6}, {06 1E 98 EA C7 9A 46}, {08 2E 9B E1 CC 8F 25 07 17}, {16 0E 9C\nEE CC 8D 23 20 72 5E 82 62 A5 01 38 0D 3E 37 D3 C3 DC F0 F7}, {10 0A 91 FB E3 8E 27 03 63 49 86 78 8F 0A 1D 0D\n50}, {11 0A 91 FB EE 85 21 1A 74 4D 98 4F B4 0D 0D 07 23 51}\n(Turkish Bankshot)\n\n-,-, {8F C1 D3 E0 88 51 E1 90},6C 00 23 46 F8 5F DB ED FD 03 62 96}, {9E DD C4 4D B7 AC}, {1B 56 3E 10 4D 43\n61 56}, {48 16 0C 2B F5 FB 5B 16 84 19 8C 96 C2 07 19 A7 91 8B 2E 60 31 3B}, {50 C1 05 67 6C 69 54 C1 4E 03 8C\n3D 16 B1 CC 50}, {4D 4B 1B CA B1 B5 2C 6D C0 5F 2A 32 69 75 F3 A8 E5}\n\nMmbxMszjbjcX, XsnFdwy, PlwnQjmywii, Tpwwl, HwhMmusybpEjsfwi, ymnnwyh, DtbnuwTwjfsywDmnvsu3X, HwhBxblhwjiJnvm\n\n_‘-’ indicates that the API was not resolved at all._\n\n\n-----\n\n### WWW.VIRUSBULLETIN.COM/CONFERENCE\n\n\n### APPENDIX B\n\ncmd.exe /c \"%s 2>> %s\"\ncmd.exe /c \"%s >> %s 2>&1\"\n\nc%s.e%sc \"%s > %s 2>&1\"\n\n%s%s%s \"%s > %s 2>&1\"\n\ncmd.exe /c \"%s\" > %s 2>&1\n\n%s /c \"%s\" >%s 2>&1\n(Op. Blockbuster)\n\n%sd.e%sc \"%s >> \"%s\" 2>&1\"\n\n%smd.e%sc \"%s > %s 2>&1\"\n\n%sd.e%sc %s >%s 2>&1\n(Op. Blockbuster)\n\n%smd.e%sc \"%s > %s\"\n\ncmd.exe /c \"\" > 2>&1\n(Turkish Bankshot)\n\n### APPENDIX C\n\n|APPENDIX B|Col2|\n|---|---|\n|cmd.exe /c \"%s 2>> %s\" cmd.exe /c \"%s >> %s 2>&1\" (Online casino in Central America)|cm%sx%s\"%s %s %s\" 2>%s (Operation Blockbuster) (WannaCryptor outbreak)|\n|c%s.e%sc \"%s > %s 2>&1\" (Operation Blockbuster - The Sequel)|%sd.e%sc \"%s > %s 2>&1\" (Operation Blockbuster - The Sequel)|\n|%s%s%s \"%s > %s 2>&1\" (Operation Blockbuster - The Saga)|%sd.e%sc \"%s > %s\" 2>&1 %sd.e%sc n%ssh%srewa%s ad%s po%sop%sing %sd.e%sc \"%s > %s\" (Op. Blockbuster)|\n|cmd.exe /c \"%s\" > %s 2>&1 (The Polish and Mexican case)|c%sd.e%sc %s > \"%s\" 2>&1 (Op. Blockbuster - Goes Mobile)|\n|%s /c \"%s\" >%s 2>&1 (Op. Blockbuster)|%sm%se%sc \"%s > %s %s&1\"|\n|%sd.e%sc \"%s >> \"%s\" 2>&1\"|%smd.ex%sc \"%s > %s\" 2>&1|\n|%smd.e%sc \"%s > %s 2>&1\" (Op. Blockbuster - The Sequel)|%sd.e%sc \"%s >> %s\" 2>&1 %sd.e%sc \"%s%s %s > %s\" 2>&1 (Symantec’s report on Duuzer)|\n|%sd.e%sc %s >%s 2>&1 (Op. Blockbuster)|%s %s > \"%s\" 2>&1|\n|%smd.e%sc \"%s > %s\"|c%sd%sxe%sc %s >> %s 2>&1|\n|cmd.exe /c \"\" > 2>&1 (on stack) (Turkish Bankshot)|cmd.exe /c %s >> %s 2>&1|\n\n\n-----\n\n### WWW.VIRUSBULLETIN.COM/CONFERENCE\n\n\n### APPENDIX D\n\n|APPENDIX D|Col2|Col3|\n|---|---|---|\n|:start if not exist \"%s\" goto done del \"%s\" del /AH \"%s\" goto start :done del %%0 (Op. Troy)|@echo off :D1 del /a %1 if exist %1 goto D1 del /a %0 (Op. Blockbuster)|@echo off :del1 del /a %1 if exist %1 goto del1 del /a %0 (PL & MX banks)|\n|:L1 DEL \"%s\" PING 0.0.0.0 > nul IF EXIST \"%s\" GOTO L1 DEL \"%%0\" (SWIFT attacks) (Op. Blockbuster)|@echo off :Rpt del \"%s\">nul ping 0.0.0.0>nul ping 0.0.0.0>nul if exist \"%s\" goto Rpt del \"%%0\" (WannaCryptor outbreak)|:L21024 del /a \"%s\" ping -n 2 127.0.0.1 if exist \"%s\" goto L21024 del /a \"%s\" (Op.Blockbuster The Sequel) (Turkish Bankshot)|\n|@echo off :P del %%1 ping 0.0.0.0>nul if exist %%1 goto P del %%0|:L DEL \"%s\" IF EXIST \"%s\" GOTO L DEL \"%%0\"|:E2 del \"%s\" if exist \"%s\" goto E2 del \"%%0\"|\n|:G1928 del /a \"%s\" ping -n 1 127.0.0.1 if exist \"%s\" goto G1928 del /a \"%s\"|@echo off :R1 del /a \"%s\" if exist \"%s\" goto R1 del /a \"%s\" (Op. Blockbuster)|@echo off :Loop del /a H \"%s\" if exist \"\" goto Loop del \"%s\" (Op. Blockbuster)|\n|:timeout timeout /t 5 del /a \"%s\" if exist \"%s\" goto timeout del /a \"%s\" del /a \"%s\"|:Repeat del %s if exist %s goto Repeat del %s\"|:O @echo off del \"%s\" if exist \"%s\" goto O del \"%s\" (Op. Blockbuster The Saga)|\n\n\n-----\n\n### WWW.VIRUSBULLETIN.COM/CONFERENCE\n\n\n### REFERENCES\n\n[1] ESET GitHub. SHA256 hashes of mentioned fi les.\nhttps://github.com/eset/malware-ioc/tree/master/\nnukesped_lazarus\n\n[2] Novetta. Operation Blockbuster. February 2016.\nhttps://www.operationblockbuster.com/wp-content/\nuploads/2016/02/Operation-Blockbuster-Report.pdf.\nhttps://www.operationblockbuster.com/resources/.\n\n[3] Bartholomew, B.; Guerrero-Saade, J.A. Wave your false\nfl ags! Deception tactics muddying attribution in targeted\nattacks. Virus Bulletin International Conference 2016\nDenver. https://www.virusbulletin.com/uploads/pdf/\nmagazine/2016/VB2016-Bartholomew-GuerreroSaade.\npdf.\n\n[4] US-CERT. HIDDEN COBRA – North Korean\nMalicious. Cyber Activity https://www.us-cert.gov/\nHIDDEN-COBRA-North-Korean-Malicious-CyberActivity.\n\n[5] Yang, K. Z:\\MAKE TROY\\NOT WAR: Case Study of\nthe Wiper APT in Korea, and Beyond. Black Hat 2014\nSingapore. https://www.blackhat.com/docs/asia-14/\nmaterials/Yang/Asia-14-Yang-Z-Make-Troy-Not-WarCase-Study-Of-The-Wiper-APT-In-Korea-AndBeyond.pdf.\n\n[6] Sherstobitoff, R.; Liba, I.; Walter, J. Dissecting\nOperation Troy: Cyberespionage in South Korea.\nMcAfee. July 2013. https://www.mcafee.com/\nenterprise/en-us/assets/white-papers/wp-dissectingoperation-troy.pdf.\n\n[7] Symantec. Duuzer back door Trojan targets South\nKorea to take over computers, October 2015.\nhttps://www.symantec.com/connect/blogs/duuzer-backdoor-trojan-targets-south-korea-take-over-computers.\n\n[8] Kasza, A.; Yates, M. The Blockbuster Sequel. Palo Alto\nNetworks. April 2017.\nhttps://researchcenter.paloaltonetworks.com/2017/04/\nunit42-the-blockbuster-sequel/.\n\n[9] Kasza, A. The Blockbuster Saga Continues. Palo Alto\nNetworks. August 2017.\nhttps://researchcenter.paloaltonetworks.com/2017/08/\nunit42-blockbuster-saga-continues/.\n\n[10] Kasza, A.; Cortes, J.; Yates, M. Operation Blockbuster\nGoes Mobile. Palo Alto Networks. November 2017.\nhttps://researchcenter.paloaltonetworks.com/2017/11/\nunit42-operation-blockbuster-goes-mobile/.\n\n[11] Nish, A.; Thatcher, B. (BAE Systems; SWIFT)\nCyber-Heist: Two Bytes to $951m, RSAC 2017 San\nFrancisco, https://www.rsaconference.com/writable/\npresentations/fi le_upload/2ht-t11-cyber-heist-twobyte-_to-951m-collaborat-_to-defend.pdf.\n\n[12] Shevchenko, S.; Nish, A. CYBER HEIST\nATTRIBUTION. BAE Systems. May 2016.\nhttp://baesystemsai.blogspot.com/2016/05/cyber-heistattribution.html.\n\n\n\n[13] Haertle, A. Włamania do kilku banków skutkiem\npoważnego ataku na polski sektor fi nansowy, February\n2017, https://zaufanatrzeciastrona.pl/post/wlamania-dokilku-bankow-skutkiem-powaznego-ataku-na-polskisektor-fi nansowy/.\n\n[14] Symantec. Attackers target dozens of global banks with\nnew malware. February 2017.\nhttps://www.symantec.com/connect/blogs/attackerstarget-dozens-global-banks-new-malware-0.\n\n[15] BAE Systems Applied Intelligence. LAZARUS &\nWATERING-HOLE ATTACKS. February 2017.\nhttp://baesystemsai.blogspot.cz/2017/02/lazaruswatering-hole-attacks.html.\n\n[16] Kaspersky Lab. Lazarus under the Hood. April 2017.\nhttps://securelist.com/fi les/2017/04/Lazarus_Under_\nThe_Hood_PDF_fi nal.pdf. https://www.youtube.com/\nwatch?v=9Vh2n6nC0t4.\n\n[17] Kálnai, P. Demystifying targeted malware used against\nPolish banks. WeLiveSecurity. February 2018.\nhttps://www.welivesecurity.com/2017/02/16/\ndemystifying-targeted-malware-used-polish-banks/.\n\n[18] MalwareTechBlog. How to Accidentally Stop a Global\nCyber Attacks. May 2017. https://www.malwaretech.\ncom/2017/05/how-to-accidentally-stop-a-global-cyberattacks.html.\n\n[19] Gavrila, R. Lessons learned from the WannaCry\noutbreak. Virus Bulletin International Conference\n2017 Madrid. https://www.virusbulletin.com/\nconference/vb2017/abstracts/lessons-learnedwannacry-outbreak.\n\n[20] Yang, K. WannaCry: Evolving History from Beta to\n2.0. Fortinet. May 2017. https://www.fortinet.com/\nblog/threat-research/wannacry-evolving-history-frombeta-to-2-0.html.\n\n[21] Neel, M. #WannaCryptAttribution. May 2017.\nhttps://twitter.com/neelmehta/\nstatus/864164081116225536.\n\n[22] Huss, D. North Korea bitten by the bitcoin bug.\nProofpoint. December 2017. https://www.proofpoint.\ncom/sites/default/fi les/pfpt-us-wp-north-korea-bittenby-bitcoin-bug.pdf.\n\n[23] https://github.com/PowerShellMafi a/PowerSploit/blob/\nmaster/CodeExecution/Invoke-Refl ectivePEInjection.\nps1.\n\n[24] Sherstobitoff, R. Lazarus Resurfaces, Targets Global\nBanks and Bitcoin Users. McAfee. February 2018.\nhttps://securingtomorrow.mcafee.com/mcafee-labs/\nlazarus-resurfaces-targets-global-banks-bitcoin-users/.\n\n[25] Sherstobitoff, R. Hidden Cobra Targets Turkish\nFinancial Sector With New Bankshot Implant. McAfee.\nMarch 2018. https://securingtomorrow.mcafee.com/\nmcafee-labs/hidden-cobra-targets-turkish-fi nancialsector-new-bankshot-implant/.\n\n\n-----\n\n### WWW.VIRUSBULLETIN.COM/CONFERENCE\n\n[26] Shen, C.E.; Jang, M.-C.; Kwak, K.-j. Nation-State\nMoneymule’s Hunting Season, Black Hat EU 2017.\nhttps://www.blackhat.com/docs/eu-17/materials/\neu-17-Shen-Nation-State%20Moneymules-HuntingSeason-APT-Attacks-Targeting-Financial-Institutions.\npdf.\n\n[27] Seoungsu, P. Anatomy Of Financial Attacks By The\nLazarus Group. Area 41 2018. https://www.slideshare.\nnet/SeongsuPark8/area41-anatomy-of-attacks-aimedat-fi nancial-sector-by-the-lazarus-group-104315358/.\nhttps://www.youtube.com/watch?v=NEjVJsKeV5k.\n\n[28] Doman Ch. Malicious Documents from Lazarus Group\nTargeting South Korea, June 2018. https://www.\nalienvault.com/blogs/labs-research/maliciousdocuments-from-lazarus-group-targeting-south-korea.\n\n[29] Webster, G.D.; Kolosnjaji, B.; von Pentz, Ch.; Kirsch,\nJ.; Hanif, Z.D.; Zarras, A.; Eckert, C. Finding the\nNeedle: A Study of the PE32 Rich Header and\nRespective Malware Triage. In: Proceedings of the\nInternational Conference on Detection of Intrusions\nand Malware, and Vulnerability Assessment. Springer,\npp. 119--138, 2017.\n\n[30] Pistelli, D. Microsoft’s Rich Signature (undocumented)\n2008. http://www.ntcore.com/fi les/richsign.htm.\n\n[31] Kálnai, P.; Poslušný, M. Lazarus toolset: restoring the\nold painting in a new frame. AVAR 2017, Beijing.\nhttp://avar.skdlabs.com/index.php/speakers/lazarustoolset-restoring-the-old-painting-in-a-new-frame/.\n\n[32] Developing PE fi le packer step-by-step. Step 11.\nCommand line interface. Final version https://coder.\npub/2014/10/pe-packer-step-by-step-step-11-commandline-interface/.\n\n[33] Cherepanov, A.; Lipovsky, R. BlackEnergy – what we\nreally know about the notorious cyber attacks, Virus\nBulletin International Conference 2016, Denver.\nhttps://www.virusbulletin.com/uploads/pdf/\nmagazine/2016/VB2016-Cherepanov-Lipovsky.pdf.\n\n[34] Kálnai, P.; Cherepanov, A. Lazarus KillDisks Central\nAmerican casino. WeLiveSecurity. April 2018.\nhttps://www.welivesecurity.com/2018/04/03/lazaruskilldisk-central-american-casino/.\n\n[35] ManageEngine patches zero-day vulnerabilities.\nManageEngine. February 2018.\nhttps://blogs.manageengine.com/corporate/\nmanageengine/2018/02/01/manageengine-patcheszero-day-vulnerabilities.html.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.virusbulletin.com/uploads/pdf/magazine/2018/VB2018-Kalnai-Poslusny.pdf"
    ],
    "report_names": [
        "VB2018-Kalnai-Poslusny.pdf"
    ],
    "threat_actors": [
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "110e7160-a8cc-4a66-8550-f19f7d418117",
            "created_at": "2023-01-06T13:46:38.427592Z",
            "updated_at": "2025-03-27T02:00:02.830659Z",
            "deleted_at": null,
            "main_name": "Silent Chollima",
            "aliases": [
                "Subgroup: Andariel",
                "Onyx Sleet",
                "PLUTONIUM",
                "OperationTroy",
                "Guardian of Peace",
                "GOP",
                "WHOis Team",
                "Andariel"
            ],
            "source_name": "MISPGALAXY:Silent Chollima",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "32a223a8-3c79-4146-87c5-8557d38662ae",
            "created_at": "2022-10-25T15:50:23.703698Z",
            "updated_at": "2025-03-27T02:00:55.528031Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Lazarus Group",
                "Labyrinth Chollima",
                "HIDDEN COBRA",
                "Guardians of Peace",
                "NICKEL ACADEMY",
                "Diamond Sleet"
            ],
            "source_name": "MITRE:Lazarus Group",
            "tools": [
                "RawDisk",
                "Proxysvc",
                "BADCALL",
                "FALLCHILL",
                "WannaCry",
                "HOPLIGHT",
                "TYPEFRAME",
                "Dtrack",
                "HotCroissant",
                "HARDRAIN",
                "Dacls",
                "KEYMARBLE",
                "TAINTEDSCRIBE",
                "AuditCred",
                "netsh",
                "ECCENTRICBANDWAGON",
                "AppleJeus",
                "BLINDINGCAN",
                "ThreatNeedle",
                "Volgmer",
                "Cryptoistic",
                "RATANKBA",
                "Bankshot",
                "Torisma",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "9e767b38-12ae-4ef7-9878-5ce1701066d7",
            "created_at": "2024-05-01T02:03:08.131819Z",
            "updated_at": "2025-03-27T02:05:17.413497Z",
            "deleted_at": null,
            "main_name": "NICKEL ACADEMY",
            "aliases": [
                "COVELLITE ",
                "CTG-2460 ",
                "Diamond Sleet ",
                "Guardians of Peace",
                "HIDDEN COBRA ",
                "High Anonymous",
                "Labyrinth Chollima ",
                "NNPT Group",
                "New Romanic Cyber Army Team",
                "Temp.Hermit ",
                "The Lazarus Group ",
                "UNC577 ",
                "Who Am I?",
                "Whois Team",
                "ZINC ",
                "Black Artemis "
            ],
            "source_name": "Secureworks:NICKEL ACADEMY",
            "tools": [
                " DarkMessenger",
                " Destover",
                " Duuzer",
                " HOPLIGHT",
                " Joanap",
                " KorHigh",
                " LiveJinx",
                " Volgmer",
                "Brambul"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "68cc6e37-f16d-4995-a75b-5e8e2a6cbb3d",
            "created_at": "2024-05-01T02:03:07.943593Z",
            "updated_at": "2025-03-27T02:05:17.259709Z",
            "deleted_at": null,
            "main_name": "BRONZE EDISON",
            "aliases": [
                "DarkSeoul",
                "Maverick Panda ",
                "Sykipot ",
                "TG-0623 ",
                "getkys",
                "APT4 "
            ],
            "source_name": "Secureworks:BRONZE EDISON",
            "tools": [
                " Wkysol",
                " ZxPortMap",
                "Gh0st RAT"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f32df445-9fb4-4234-99e0-3561f6498e4e",
            "created_at": "2022-10-25T16:07:23.756373Z",
            "updated_at": "2025-03-27T02:02:09.966155Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "APT-C-26",
                "ATK 3",
                "Appleworm",
                "Citrine Sleet",
                "DEV-0139",
                "Diamond Sleet",
                "Gleaming Pisces",
                "Gods Apostles",
                "Gods Disciples",
                "Group 77",
                "Guardians of Peace",
                "Hastati Group",
                "Hidden Cobra",
                "ITG03",
                "Jade Sleet",
                "Labyrinth Chollima",
                "Lazarus Group",
                "NewRomanic Cyber Army Team",
                "Operation 99",
                "Operation AppleJeus",
                "Operation AppleJeus sequel",
                "Operation Blockbuster: Breach of Sony Pictures Entertainment",
                "Operation CryptoCore",
                "Operation Dream Job",
                "Operation Dream Magic",
                "Operation Flame",
                "Operation GhostSecret",
                "Operation In(ter)caption",
                "Operation LolZarus",
                "Operation Marstech Mayhem",
                "Operation No Pineapple!",
                "Operation North Star",
                "Operation Phantom Circuit",
                "Operation Sharpshooter",
                "Operation Ten Days of Rain / DarkSeoul",
                "Operation Troy",
                "SectorA01",
                "Slow Pisces",
                "TA404",
                "TraderTraitor",
                "UNC2970",
                "UNC4034",
                "UNC4736",
                "UNC4899",
                "UNC577",
                "Whois Hacking Team"
            ],
            "source_name": "ETDA:Lazarus Group",
            "tools": [
                "3CX Backdoor",
                "3Rat Client",
                "3proxy",
                "AIRDRY",
                "ARTFULPIE",
                "ATMDtrack",
                "AlphaNC",
                "Alreay",
                "Andaratm",
                "AngryRebel",
                "AppleJeus",
                "Aryan",
                "AuditCred",
                "BADCALL",
                "BISTROMATH",
                "BLINDINGCAN",
                "BTC Changer",
                "BUFFETLINE",
                "BanSwift",
                "Bankshot",
                "Bitrep",
                "Bitsran",
                "BlindToad",
                "Bookcode",
                "BootWreck",
                "BottomLoader",
                "Brambul",
                "BravoNC",
                "Breut",
                "COLDCAT",
                "COPPERHEDGE",
                "CROWDEDFLOUNDER",
                "Castov",
                "CheeseTray",
                "CleanToad",
                "ClientTraficForwarder",
                "CollectionRAT",
                "Concealment Troy",
                "Contopee",
                "CookieTime",
                "Cyruslish",
                "DAVESHELL",
                "DBLL Dropper",
                "DLRAT",
                "DRATzarus",
                "DRATzarus RAT",
                "Dacls",
                "Dacls RAT",
                "DarkComet",
                "DarkKomet",
                "DeltaCharlie",
                "DeltaNC",
                "Dembr",
                "Destover",
                "DoublePulsar",
                "Dozer",
                "Dtrack",
                "Duuzer",
                "DyePack",
                "ECCENTRICBANDWAGON",
                "ELECTRICFISH",
                "Escad",
                "EternalBlue",
                "FALLCHILL",
                "FYNLOS",
                "FallChill RAT",
                "Farfli",
                "Fimlis",
                "FoggyBrass",
                "FudModule",
                "Fynloski",
                "Gh0st RAT",
                "Ghost RAT",
                "Gopuram",
                "HARDRAIN",
                "HIDDEN COBRA RAT/Worm",
                "HLOADER",
                "HOOKSHOT",
                "HOPLIGHT",
                "HOTCROISSANT",
                "HOTWAX",
                "HTTP Troy",
                "Hawup",
                "Hawup RAT",
                "Hermes",
                "HotCroissant",
                "HotelAlfa",
                "Hotwax",
                "HtDnDownLoader",
                "Http Dr0pper",
                "ICONICSTEALER",
                "Joanap",
                "Jokra",
                "KANDYKORN",
                "KEYMARBLE",
                "Kaos",
                "KillDisk",
                "KillMBR",
                "Koredos",
                "Krademok",
                "LIGHTSHIFT",
                "LIGHTSHOW",
                "LOLBAS",
                "LOLBins",
                "Lazarus",
                "LightlessCan",
                "Living off the Land",
                "MATA",
                "MBRkiller",
                "MagicRAT",
                "Manuscrypt",
                "Mimail",
                "Mimikatz",
                "Moudour",
                "Mydoom",
                "Mydoor",
                "Mytob",
                "NACHOCHEESE",
                "NachoCheese",
                "NestEgg",
                "NickelLoader",
                "NineRAT",
                "Novarg",
                "NukeSped",
                "OpBlockBuster",
                "PCRat",
                "PEBBLEDASH",
                "PLANKWALK",
                "POOLRAT",
                "PSLogger",
                "PhanDoor",
                "Plink",
                "PondRAT",
                "PowerBrace",
                "PowerRatankba",
                "PowerShell RAT",
                "PowerSpritz",
                "PowerTask",
                "Preft",
                "ProcDump",
                "Proxysvc",
                "PuTTY Link",
                "QUICKRIDE",
                "QUICKRIDE.POWER",
                "Quickcafe",
                "QuiteRAT",
                "R-C1",
                "ROptimizer",
                "Ratabanka",
                "RatabankaPOS",
                "Ratankba",
                "RatankbaPOS",
                "RawDisk",
                "RedShawl",
                "Rifdoor",
                "Rising Sun",
                "Romeo-CoreOne",
                "RomeoAlfa",
                "RomeoBravo",
                "RomeoCharlie",
                "RomeoCore",
                "RomeoDelta",
                "RomeoEcho",
                "RomeoFoxtrot",
                "RomeoGolf",
                "RomeoHotel",
                "RomeoMike",
                "RomeoNovember",
                "RomeoWhiskey",
                "Romeos",
                "RustBucket",
                "SHADYCAT",
                "SHARPKNOT",
                "SIGFLIP",
                "SIMPLESEA",
                "SLICKSHOES",
                "SORRYBRUTE",
                "SUDDENICON",
                "SUGARLOADER",
                "SheepRAT",
                "SierraAlfa",
                "SierraBravo",
                "SierraCharlie",
                "SierraJuliett-MikeOne",
                "SierraJuliett-MikeTwo",
                "SimpleTea",
                "SimplexTea",
                "SmallTiger",
                "Stunnel",
                "TAINTEDSCRIBE",
                "TAXHAUL",
                "TFlower",
                "TOUCHKEY",
                "TOUCHMOVE",
                "TOUCHSHIFT",
                "TOUCHSHOT",
                "TWOPENCE",
                "TYPEFRAME",
                "Tdrop",
                "Tdrop2",
                "ThreatNeedle",
                "Tiger RAT",
                "TigerRAT",
                "Trojan Manuscript",
                "Troy",
                "TroyRAT",
                "VEILEDSIGNAL",
                "VHD",
                "VHD Ransomware",
                "VIVACIOUSGIFT",
                "VSingle",
                "ValeforBeta",
                "Volgmer",
                "Vyveva",
                "W1_RAT",
                "Wana Decrypt0r",
                "WanaCry",
                "WanaCrypt",
                "WanaCrypt0r",
                "WannaCry",
                "WannaCrypt",
                "WannaCryptor",
                "WbBot",
                "Wcry",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "WinorDLL64",
                "Winsec",
                "WolfRAT",
                "Wormhole",
                "YamaBot",
                "Yort",
                "ZetaNile",
                "concealment_troy",
                "http_troy",
                "httpdr0pper",
                "httpdropper",
                "klovbot",
                "sRDI"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716500,
    "ts_updated_at": 1743041843,
    "ts_creation_date": 1568204648,
    "ts_modification_date": 1568204648,
    "files": {
        "pdf": "https://archive.orkl.eu/ff76a59ab85b581b5cc23114fd2b7c09c7b582c5.pdf",
        "text": "https://archive.orkl.eu/ff76a59ab85b581b5cc23114fd2b7c09c7b582c5.txt",
        "img": "https://archive.orkl.eu/ff76a59ab85b581b5cc23114fd2b7c09c7b582c5.jpg"
    }
}