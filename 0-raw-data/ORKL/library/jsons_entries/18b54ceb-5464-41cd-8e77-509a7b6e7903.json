{
    "id": "18b54ceb-5464-41cd-8e77-509a7b6e7903",
    "created_at": "2023-01-12T15:08:00.946761Z",
    "updated_at": "2025-03-27T02:11:33.886739Z",
    "deleted_at": null,
    "sha1_hash": "ae843e2e6b9b1e254a6b68932c66fc851def0412",
    "title": "2018-08-22 - BackSwap Malware Now Targets Six Banks in Spain",
    "authors": "",
    "file_creation_date": "2022-05-28T03:52:27Z",
    "file_modification_date": "2022-05-28T03:52:27Z",
    "file_size": 920130,
    "plain_text": "# BackSwap Malware Now Targets Six Banks in Spain\n\n**[securityintelligence.com/backswap-malware-now-targets-six-banks-in-spain/](https://securityintelligence.com/backswap-malware-now-targets-six-banks-in-spain/)**\n\nAugust 22, 2018\n\n[Banking & Finance August 22, 2018](https://securityintelligence.com/category/topics/banking-financial-services-industry/)\nBy [Limor Kessem co-authored by Tomer Agayev 3 min read](https://securityintelligence.com/author/limor-kessem/)\nIBM X-Force researchers analyzed the activity of a relatively new banking Trojan known as\n[BackSwap. BackSwap emerged in March 2018 and, until recently, had only targeted Polish](https://www.cert.pl/en/news/single/backswap-malware-analysis/)\nbanks The malware’s target list now features six major banks in Spain\n\n\n-----\n\nAccording to X-Force analysis, BackSwap is its own malware project, but it is based on\n[features that existed within the Tinba Trojan. The malware’s operators keep the code as their](https://securityintelligence.com/where-are-they-today-cybercrime-trojans-that-no-one-misses-shifu-malware/)\nown project; in that sense, it is considered gang-owned and not commercial malware.\n\n## A Twist in the Tale\n\nOverall, BackSwap is no more sophisticated than any other active banking Trojan. Its\nhighlight is its webinjection mechanism. Instead of using the more common method of\nhooking browser functions, then creating different versions for each architecture, BackSwap\ninjects JavaScript into the address bar.\n\nBy simulating user input to access the browser’s address bar and inserting the malicious\nscript directly there, BackSwap can execute the script using JavaScript protocol URLs and\nbypass protections of both the browser and the bank’s third-party security controls.\n\nIn terms of what BackSwap does with the injections, this is where the novelty ends. Just as\n[malware such as Zeus has been doing for over a decade, BackSwap uses malicious scripts](https://securityintelligence.com/around-the-world-with-zeus-sphinx-from-canada-to-australia-and-back/)\nto modify what victims see on their bank’s website in classic man-in-the-browser (MitB) style:\n\nScripts wait for a minimum amount of data to be transferred before replacing the\ndestination account number.\n[Scripts inject mule account numbers on the fly via MitB.](https://securityintelligence.com/how-cybercriminals-use-money-mule-accounts-to-profit-from-online-fraud/)\nScripts hide the mule account number that the money will go to and instead present the\noriginal destination account the victim entered.\n\n## BackSwap’s Fraud Method\n\nThe likely [fraud scenario based on BackSwap’s capabilities is in-session fraud automated by](https://www.ibm.com/security/fraud-protection)\nMitB malware scripts. The malware’s scripts wait for the user to go to a page where a\ntransaction is to take place. When the victim initiates activity that’s interesting to the attacker,\nsuch as adding a payee or starting a money transfer, the malware replaces the destination\naccount with a mule account number.\n\n\n-----\n\n_Figure 1: The BackSwap function responsible for account number replacement_\n\nUsing MitB scripts to alter transaction details sent to the bank is not a new method. What’s\nnew here is the way BackSwap implements it to circumvent third-party security on the bank’s\nwebsite. This method can be more successful with banks that don’t require two-factor\nauthentication (2FA) or out-of-band transaction authorization (OOBA) from customers\nmoving money to other accounts.\n\n## Malware Spam and Then Some\n\n[BackSwap is most often delivered to users via malware spam, concealed in an attachment of](https://securityintelligence.com/analyzing-pdf-and-office-documents-delivered-via-malspam/)\na productivity file like Microsoft Word or bundled inside other programs. BackSwap favors\npopular freeware or open source programs and plants its code in the initialization phase of\nthe program. When run during an early stage of the program’s execution, the code replaces\nthe installation routine with malicious instructions that execute BackSwap instead. One\ninteresting choice was Ollydbg.exe, which is a program often used by malware researchers.\n\n## Testing Attack Turfs\n\nThe malware’s attack scope has thus far been limited to a few banks in Poland and some\nbanks in Spain, specifically targeting personal banking.\n\n\n-----\n\nThe limited number of banks in each country so far may suggest that BackSwap is still in\ntesting. Our research team expects to see more testing in other geographies in the coming\nweeks, and possibly a wider scope of attack for this Trojan in the fourth quarter of 2018.\n\nWill we see BackSwap on the top 10 list of financial malware in 2019? IBM X-Force will keep\n[updating its information on BackSwap via the X-Force Exchange.](https://exchange.xforce.ibmcloud.com/collection/BackSwap-Trojan-Now-Targets-Spanish-Banks-435a673752c58e360dbabbb9b9c88a07)\n\n_Figure 2: Top most prevalent financial malware families (2018 YTD)_\n\n## Indicators of Compromise (IoCs)\n\nCommand-and-control (C&C) server IPs:\n\nhxxps://5[.]61[.]47[.]74/batya/give.php\nhxxps://103[.]242[.]117[.]248/batya/give.php\nhxxps://mta116[.]megaonline[.]in\nhxxps://czcmail[.]com (IP: 119[.]23[.]128[.]176)\n\nRecent sample MD5s:\n\n180721A8551FBBCD763C320E7034E36C (WinGraph32.exe)\nF44D28F852A99821B681C3EAF044C8D3 (OllyDbg.exe)\n\n[Interested in emerging security threats? Read the latest IBM X-Force Research](https://www.ibm.com/security/resources/xforce/research.html)\n\n[Limor Kessem](https://securityintelligence.com/author/limor-kessem/)\nExecutive Security Advisor, IBM\n\nLimor Kessem is an Executive Security Advisor at IBM Security. She is a widely sought-after\nsecurity expert, speaker and author and a strong advocate for wom...\n\n\n-----\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-08-22 - BackSwap Malware Now Targets Six Banks in Spain.pdf"
    ],
    "report_names": [
        "2018-08-22 - BackSwap Malware Now Targets Six Banks in Spain.pdf"
    ],
    "threat_actors": [
        {
            "id": "e90ec9cb-9959-455d-b558-4bafef64d645",
            "created_at": "2022-10-25T16:07:24.222081Z",
            "updated_at": "2025-03-27T02:02:10.14365Z",
            "deleted_at": null,
            "main_name": "Sphinx",
            "aliases": [
                "APT-C-15"
            ],
            "source_name": "ETDA:Sphinx",
            "tools": [
                "AnubisSpy",
                "Backdoor.Oldrea",
                "Bladabindi",
                "Fertger",
                "Havex",
                "Havex RAT",
                "Jorik",
                "Oldrea",
                "PEACEPIPE",
                "njRAT",
                "yellowalbatross"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b23e717c-0b27-47e0-b3c8-4defe6dd857f",
            "created_at": "2023-01-06T13:46:38.367369Z",
            "updated_at": "2025-03-27T02:00:02.815758Z",
            "deleted_at": null,
            "main_name": "APT33",
            "aliases": [
                "ATK35",
                "Peach Sandstorm",
                "TA451",
                "APT 33",
                "Elfin",
                "Refined Kitten",
                "MAGNALLIUM",
                "HOLMIUM",
                "COBALT TRINITY",
                "G0064"
            ],
            "source_name": "MISPGALAXY:APT33",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e5ff825b-0456-4013-b90a-971b93def74a",
            "created_at": "2022-10-25T15:50:23.824058Z",
            "updated_at": "2025-03-27T02:00:55.553346Z",
            "deleted_at": null,
            "main_name": "APT33",
            "aliases": [
                "APT33",
                "HOLMIUM",
                "Elfin",
                "Peach Sandstorm"
            ],
            "source_name": "MITRE:APT33",
            "tools": [
                "PowerSploit",
                "AutoIt backdoor",
                "PoshC2",
                "Mimikatz",
                "NanoCore",
                "DEADWOOD",
                "StoneDrill",
                "POWERTON",
                "LaZagne",
                "TURNEDUP",
                "NETWIRE",
                "Pupy",
                "ftp",
                "Shamoon"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536080,
    "ts_updated_at": 1743041493,
    "ts_creation_date": 1653709947,
    "ts_modification_date": 1653709947,
    "files": {
        "pdf": "https://archive.orkl.eu/ae843e2e6b9b1e254a6b68932c66fc851def0412.pdf",
        "text": "https://archive.orkl.eu/ae843e2e6b9b1e254a6b68932c66fc851def0412.txt",
        "img": "https://archive.orkl.eu/ae843e2e6b9b1e254a6b68932c66fc851def0412.jpg"
    }
}